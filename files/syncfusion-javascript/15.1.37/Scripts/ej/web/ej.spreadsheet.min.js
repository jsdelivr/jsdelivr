/*!
*  filename: ej.spreadsheet.min.js
*  version : 15.1.0.37
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n){typeof define=="function"&&define.amd?define(["jsrender","jquery-validation","jquery-validation-unobtrusive","./../common/ej.core.min","./../common/ej.data.min","./ej.grid.min","./../common/ej.scroller.min","./../common/ej.globalize.min","./ej.calculate.min","./ej.waitingpopup.min","./../datavisualization/ej.chart.min","./ej.dialog.min","./ej.tab.min","./ej.button.min","./ej.splitbutton.min","./ej.togglebutton.min","./ej.checkbox.min","./ej.radiobutton.min","./ej.autocomplete.min","./ej.datepicker.min","./ej.dropdownlist.min","./ej.listbox.min","./ej.editor.min","./ej.pager.min","./ej.menu.min","./ej.treeview.min","./ej.uploadbox.min","./ej.colorpicker.min","./ej.excelfilter.min","./ej.ribbon.min","./ej.pivotschemadesigner.min","./ej.pivotgrid.min"],n):n()})(function(){(function(n,t,r){t.widget("ejSpreadsheet","ej.Spreadsheet",{_rootCSS:"e-spreadsheet",element:null,_excelFilter:null,validTags:["div"],model:null,_requiresID:!0,defaults:{allowFreezing:!0,enableContextMenu:!0,allowEditing:!0,allowResizing:!0,allowMerging:!0,allowWrap:!0,allowUndoRedo:!0,allowClipboard:!0,allowDataValidation:!0,allowConditionalFormats:!0,allowSearching:!0,allowKeyboardNavigation:!0,allowAutoFill:!0,allowSelection:!0,allowSorting:!0,allowDragAndDrop:!0,allowCellType:!0,allowAutoCellType:!1,allowCharts:!0,enablePersistence:!1,allowCellFormatting:!0,allowFormulaBar:!0,showRibbon:!0,showPager:!0,allowComments:!0,allowFiltering:!0,allowInsert:!0,allowDelete:!0,allowFormatPainter:!0,allowHyperlink:!0,allowImport:!0,allowFormatAsTable:!0,allowAutoSum:!0,enablePivotTable:!1,allowLockCell:!0,enableTouch:!0,allowOverflow:!0,allowClear:!0,isReadOnly:!1,columnCount:21,rowCount:20,rowHeight:20,columnWidth:64,sheetCount:1,undoRedoStep:20,activeSheetIndex:1,apWidth:300,activationPanelWidth:300,_isActPanelVisible:!1,cssClass:"",userName:"",locale:"en-US",pageSize:"A4",sheets:[],nameManager:[],customFormulas:[],currentViewData:null,query:null,create:null,actionBegin:null,actionComplete:null,beforeCellFormat:null,cellFormatting:null,beforeOpen:null,beforeDrop:null,drop:null,cellEdit:null,pagerClick:null,cellClick:null,_pivotPrint:null,tabClick:null,tabSelect:null,_createPivotTable:null,beforePanelOpen:null,load:null,loadComplete:null,beforePrint:null,editRangeBegin:null,editRangeComplete:null,cellHover:null,menuClick:null,contextMenuClick:null,ribbonClick:null,dragStart:null,drag:null,cellSave:null,beforeCellSelect:null,cellSelected:null,autoFillBegin:null,autoFillComplete:null,seriesRendering:null,openFailure:null,onImport:null,onExport:null,beforeBatchSave:null,keyUp:null,keyDown:null,dragShape:null,resizeStart:null,resizeEnd:null,refresh:null,beforeEditComment:null,beforeTabClick:null,scrollStop:null,scrollSettings:{width:"100%",height:"100%",allowScrolling:!0,scrollMode:"infinite",isResponsive:!0,allowVirtualScrolling:!0,allowSheetOnDemand:!1},pageSettings:{pageCount:10,currentPage:1,pagerHeight:26},exportSettings:{allowExporting:!0,excelUrl:null,csvUrl:null,pdfUrl:null,password:null},pictureSettings:{allowPictures:!0,height:220,width:440},selectionSettings:{selectionType:"default",selectionUnit:"multirange",enableAnimation:!1,animationType:"linear",animationTime:.001,activeCell:""},chartSettings:{height:220,width:440},formatSettings:{allowFontFamily:!0,allowDecimalPlaces:!0,allowCellBorder:!0},autoFillSettings:{fillType:"fillseries",showFillOptions:!0},importSettings:{importMapper:"",importUrl:"",password:"",allowSheetOnDemand:!1,importOnLoad:!1},printSettings:{allowPageSetup:!0,allowPageSize:!1,allowPrinting:!0},ribbonSettings:{enableOnDemand:!1,applicationTab:{type:t.Ribbon.ApplicationTabType.Backstage,menuSettings:{isAppend:!1,dataSource:[]}}}},dataTypes:{pageSize:"enum",sheets:"array",nameManager:"array",scrollSettings:{scrollMode:"enum"},selectionSettings:{selectionType:"enum",selectionUnit:"enum",animationType:"enum"},autoFillSettings:{fillType:"enum"}},_dataSource:function(n){return this.getSheet(n).dataSource},getSheet:function(n){return this.model.sheets[this._getSheetIndex(n)]},getSheets:function(){return this.model.sheets},getSheetElement:function(n){return this.element.find("#"+this._id+"_"+this.getSheet(n).sheetInfo.value)},getDataSettings:function(n){var i,r=[],t=this.getSheet(n),u=t.rangeSettings.length;if(u)while(u--)i=t.rangeSettings[u],i.dataSource&&r.push(i);return r.length?r:t.dataSource?[t]:null},_getJSSheetHeader:function(n){return this._sheets[n]._sheetHeader},_setJSSheetHeader:function(n,t){this._sheets[t]._sheetHeader=n},_getInputBox:function(){return this._inputBox},_setInputBox:function(n){this._inputBox=n},_getIndexBox:function(){return this._indexBox},_setIndexBox:function(n){this._indexBox=n},_getJSSheetRowHeader:function(n){return this._sheets[n]._sheetRowHeader},_setJSSheetRowHeader:function(n,t){this._sheets[t]._sheetRowHeader=n},_getJSSheetRowHeaderContent:function(n){return this._sheets[n]._sheetRowHeaderContent},_setJSSheetRowHeaderContent:function(n,t){this._sheets[t]._sheetRowHeaderContent=n},_getJSSheetContent:function(n){return this._sheets[n]._sheetContent},_setJSSheetContent:function(n,t){this._sheets[t]._sheetContent=n},_getContent:function(n){return this._sheets[n]._content},_setContent:function(n,t){this._sheets[t]._content=n},getPager:function(){return this._spreadSheetPager},setPager:function(n){this._spreadSheetPager=n},getFooter:function(){return this._footer},setFooter:function(n){this._footer=n},getMainPanel:function(){return this._mainPanel},setMainPanel:function(n){this._mainPanel=n},getGroupPanel:function(){return this._groupPanel},setGroupPanel:function(n){this._groupPanel=n},getActivationPanel:function(){return this._activationPanel},setActivationPanel:function(n){this._activationPanel=n},getActiveSheetIndex:function(){return this.model.activeSheetIndex},setActiveSheetIndex:function(n){this.model.activeSheetIndex=n},getRows:function(n){return this._sheets[n]._Rows},setRows:function(n,t){this._sheets[t]._Rows=n},getFrozenRows:function(n){return this.getSheet(this._getSheetIndex(n)).frozenRows},setFrozenRows:function(n,t){this.model.isReadOnly||(this.getSheet(this._getSheetIndex(t)).frozenRows=n)},getFrozenColumns:function(n){return this.getSheet(n).frozenColumns},setFrozenColumns:function(n,t){this.model.isReadOnly||(this.getSheet(t).frozenColumns=n)},setFocusTopElem:function(n){this._focusTopElem=n},getFocusTopElem:function(){return this._focusTopElem},setFocusRightElem:function(n){this._focusRightElem=n},getFocusRightElem:function(){return this._focusRightElem},setFocusBottomElem:function(n){this._focusBottomElem=n},getFocusBottomElem:function(){return this._focusBottomElem},setFocusLeftElem:function(n){this._focusLeftElem=n},getFocusLeftElem:function(){return this._focusLeftElem},setAutoFillElem:function(n){this._autoFillElem=n},getAutoFillElem:function(){return this._autoFillElem},_setAutoFillOptElem:function(n){this._autoFillOptElem=n},_getAutoFillOptElem:function(){return this._autoFillOptElem},_getColWidth:function(n,t){return this.getSheet(t).columnsWidthCollection[n]},_getRowHeight:function(n,t){return this.getSheet(t).rowsHeightCollection[n]},setActiveCell:function(n,i,r){var f=this.getSheet(r?r:this.getActiveSheetIndex()),u;typeof n=="string"&&(u=this.getRangeIndices(n),n=u[0],i=u[1]);f._activeCell=t.isNullOrUndefined(n)&&t.isNullOrUndefined(i)?f._startCell:{rowIndex:n,colIndex:i}},getActiveCell:function(n){return this.getSheet(this._getSheetIndex(n))._activeCell},_setFormulaSuggElem:function(n){this._formulaSuggElem=n},_getFormulaSuggElem:function(){return this._formulaSuggElem},_setRowHdrTBody:function(n,t){this._sheets[t]._rowHdrTBody=n},_getRowHdrTBody:function(n){return this._sheets[n]._rowHdrTBody},_setContTBody:function(n,t){this._sheets[t]._contTBody=n},_getContTBody:function(n){return this._sheets[n]._contTBody},_init:function(){var n=this.model.importSettings;this._initBegin();this.model.allowImport&&(n.importUrl.length||n.importOnLoad)?this["import"]({url:n.importUrl,password:this._encrypt(n.password),allowSheetOnDemand:n.allowSheetOnDemand}):(this.showWaitingPopUp(),this._initBase(),this._initComplete())},_initBegin:function(){var r="touch-action",i=this.model.scrollSettings,f=i.width,e=i.height,u;t.support.stableSort=!1;this._isInitLoad=!0;this._isAutoWHMode=!i.allowScrolling;this._isAutoWHMode&&(i.isResponsive=!1,i.scrollMode="normal",i.allowVirtualScrolling=!1,this.addClass(this.element,"e-ss-auto"));this._minWidth=280;this._minHeight=200;this._isAutoWHMode||this.element.css({"min-height":this._minHeight,"min-width":this._minWidth,height:i.height,width:i.width});this._updateResponsiveSettings();this._isAutoWHMode||i.isResponsive||(i.width.toString().indexOf("%")>-1&&(i.width=this._responsiveWidth),i.height.toString().indexOf("%")>-1&&(i.height=this._responsiveHeight),this.element.css({height:i.height,width:i.width}));this._browserDetails=t.browserInfo();this.localizedLabels=t.getLocalizedConstants(this.sfType,this.model.locale);this.element.attr("tabindex",0);this._browserDetails.name==="msie"&&(r="-ms-"+r);this.element.css(r,"double-tap-zoom pinch-zoom");u=t.buildTag("div#"+this._id+"_wait","",{position:"absolute"});n(document.body).append(u);u.ejWaitingPopup({showOnInit:!1,target:this.element})},_initBase:function(){this._refreshModel(this.isImport?this._impData.model:null);this._initProps();this._initCSSTag();this._initLayout();this._wireEvents("_on");this._isInitLoad=!1;this.XLRibbon._renderNameManagerDlg()},_initProps:function(){var r=this.model,i=t.spreadsheetFeatures;this.XLClipboard=new i.clipboard(this);this.XLEdit=new i.editing(this);this.XLPrint=new i.print(this);this.XLRibbon=new i.ribbon(this);this.XLScroll=new i.scroller(this);r.allowDragAndDrop&&(this.XLDragDrop=new i.dragAndDrop(this));r.allowKeyboardNavigation&&(this.XLCellNav=new i.cellNavigation(this));r.allowFiltering&&(this.XLFilter=new i.filter(this));r.allowAutoFill&&(this.XLDragFill=new i.dragFill(this));(r.allowCellFormatting||r.allowFormatAsTable||r.allowFormatPainter)&&(this.XLFormat=new i.cellFormatting(this));r.allowCellFormatting&&(this.XLCellFrmtDlg=new i.formatCellDialog(this));r.allowConditionalFormats&&(this.XLCFormat=new i.cFormat(this));r.allowSearching&&(this.XLSearch=new i.findnreplace(this));r.allowCharts&&(this.XLChart=new i.chart(this));r.exportSettings.allowExporting&&(this.XLExport=new i.exporting(this));r.allowSorting&&(this.XLSort=new i.sorting(this));r.allowFreezing&&(this.XLFreeze=new i.freezepane(this));r.allowComments&&(this.XLComment=new i.comments(this));r.allowSelection&&(this.XLSelection=new i.selection(this));(r.allowCharts||r.pictureSettings.allowPictures)&&(this.XLShape=new i.shape(this));r.allowResizing&&(this.XLResize=new i.resizing(this));r.enableContextMenu&&(this.XLCMenu=new i.contextmenu(this));r.allowDataValidation&&(this.XLValidate=new i.validation(this));r.allowCellType&&(this.XLCellType=new i.cellType(this));r.enablePivotTable&&(this.XLPivot=new i.pivot(this));i.math&&n.extend(t.Spreadsheet.prototype,i.math);this._initPvtProps();this._initFATProps();this.model.customFormulas.length&&this._updateCustomFormulas(this.model.customFormulas,"add");this.model.nameManager.length&&this._refreshNameMngr(this.model.nameManager)},_initPvtProps:function(){var u=1,i={rowIndex:0,colIndex:0},r=this._getLocStr("AutoFillOptions").split("/"),e=this.getActiveSheetIndex(),f=t.preferredCulture(this.model.locale).numberFormat;for(this._dataContainer=this.isImport?n.extend(!0,{},this._impData.dataContainer):{sheets:{},sheetCellType:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this._newSIndex=1,this.isImport=this.isImport||!1,this.mergeCenter=!1,this.isDirty=!1,this._calcID=CalcEngine.createSheetFamilyID(),this._calcEngine=new CalcEngine(this,this._calcID),this._calcEngine.setUseDependencies(!0),this._calcEngine.setExcelLikeComputations(!0),this._calcEngine.setUseDatesInCalculations(!0),this._calcEngine.setEnableFormulaErrorValidation(!0),this._calcEngine.setCalculatingSuspended(n("#"+this._id+"_CalcManual").find("span").hasClass("e-ss-calcauto")),this._sheets=[],this._cellProp=["value","value2","type","cFormatRule","range","thousandSeparator","rule","format","border","picture","chart","calcValue","align","hyperlink","formats","borders","tformats","tborders","isFilterHeader","filterState","tableName","comment","formatStr","decimalPlaces","cellType","isFilterHighlight","pivot"],this.isImport||(this.model.sheets.splice(0,0,{}),this._updateCellType());u<=this.model.sheetCount;)this.isImport||(this._dataContainer.sheets[u]={}),this._sheetSettings(u),this._newSIndex++,u++;this._detachTable=null;this._isPrint=!1;this._isSheetInsert=!1;this._isSheetRename=!1;this._isTableRename=!1;this._tableClassName=null;this._isSheetNavigate=!1;this._sheetCopy={isSheetCopy:!1,sheetContent:null};this._alertDialog={element:null,action:null};this._dataManager=null;this._isUndo=!1;this._undoCollection=[];this._redoCollection=[];this._ctrlKeyCount=0;this._formulaRange=[];this._formulaHeight=36;this._isSort=!1;this._isPaste=!1;this._isFATResize=!1;this._isDisplayHeader=!1;this._currencySymbol=f.currency.symbol||"$";this._percentSymbol=f.percent.symbol||"%";this._decimalSeparator=f["."]||".";this.operators={"<":function(n,t){return n<t},">":function(n,t){return n>t},">=":function(n,t){return n>=t},"<=":function(n,t){return n<=t},"==":function(n,t){return n===t},"!=":function(n,t){return n!==t},"!":function(n){return!n},"=":function(n){return n}};this.parse={parseInt:function(n){return parseInt(n)},parseFloat:function(n){return parseFloat(n)},parseDate:function(n){return new Date(n).getTime()},parseTime:function(n){return new Date("01/01/1990 "+n).getTime()},length:function(n){return n.charAt(0)==="^"?parseInt(n.split("^")[1]):n.length}};this._selMergeCells=[];this._mergeType="merge-cells";this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._insData={};this._deletedDimension=[];this._insDelStatus="";this._isUndoRedo=!1;this._indexBox=null;this._inputBox=null;this._focusTopElem=null;this._focusRightElem=null;this._focusBottomElem=null;this._focusLeftElem=null;this._dStartCell=i;this._dEndCell=i;this._pStartCell=i;this._pEndCell=i;this._pFillCell=i;this._borderFocus=["e-focusright","e-focusbottom"];this._cutFocus=["e-cutright","e-cutbottom"];this._autoFillFocus=["e-autofillright","e-autofillbottom"];this._formulaBorder=[["e-bborderright","e-bborderbottom"],["e-rborderright","e-rborderbottom"],["e-vborderright","e-vborderbottom"],["e-gborderright","e-gborderbottom"],["e-pborderright","e-pborderbottom"],["e-oborderright","e-oborderbottom"]];this._ctrlFormulaBorder=[["e-bctrlborderright","e-bctrlborderbottom"],["e-rctrlborderright","e-rctrlborderbottom"],["e-vctrlborderright","e-vctrlborderbottom"],["e-gctrlborderright","e-gctrlborderbottom"],["e-pctrlborderright","e-pctrlborderbottom"],["e-octrlborderright","e-octrlborderbottom"]];this._borderTypes=[{id:"bottomborder",text:this._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottomborder"},{id:"topborder",text:this._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-topborder"},{id:"leftborder",text:this._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-leftborder"},{id:"rightborder",text:this._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-rightborder"},{id:"noborder",text:this._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:this._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"}];this._datePattern=["year","month","day","hours","minutes","seconds"];this._styleColl={};this._borderStyle="solid";this._borderColor="#000000";this._borderStyles=["solid","dashed","dotted"];this._ddlCell=null;this._cOpt={};this._shapeChange=!1;this._dupDetails=!1;this._paste=!1;this._autoFillElem=null;this._autoFillOptElem=null;this._fillOptionMenuData=[{id:"copycells",text:r[0],parentId:null,sprite:"e-icon e-ss-fillselect"},{id:"fillseries",text:r[1],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillformattingonly",text:r[2],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"fillwithoutformatting",text:r[3],parentId:null,sprite:"e-icon e-ss-filloption"},{id:"flashfill",text:r[4],parentId:null,sprite:"e-icon e-ss-filloption"}];this._formulaSuggElem=null;this._isFormulaSuggestion=!1;this._shiftKeyEnabled=!1;this._preventctrlkey=!1;this._rAlign="e-ralign";this._cAlign="e-calign";this._chartBorder=[["e-rcbright","e-rcbbottom"],["e-vcbright","e-vcbbottom"],["e-bcbright","e-bcbbottom"]];this._selectionBorder=["e-selecttop","e-selectright","e-selectbottom","e-selectleft"];this._autofillBorder=["e-autofilltop","e-autofillright","e-autofillbottom","e-autofillleft"];this._thinBorder=["e-thinright","e-thinbottom"];this._rcRegx=new RegExp("\\be-rc.*\\b","g");this._formatRegx=new RegExp("\\be-format.*?\\b","g");this._borderRegx=new RegExp("\\be-border.*?\\b","g");this._formulaChanged=[];this._ref=[];this._prevText="";this._prevVal="";this._dlgHLClick=!1;this._selectDataval={};this._undoInputobj={};this._cureditedCell="";this._colHeaderHeight=22;this._rowHeaderWidth=30;this._scrollerHeight=18;this._scrollerWidth=18;this._bufferCnt=5;this._maxRowCnt=1048576;this._maxColCnt=16384;this._impData=this._impData||null;this._isNew=!1;this._isSheetReq=!1;this._intrnlReq=!1;this._isFilterApplied=!1;this._commentCount=0;this._tableCnt=1;this._uploadImage=!1;this._responsiveWidth=0;this._responsiveHeight=0;this._celltypes=[];this._reqCnt=0;this._resCnt=0;this._pageClickArgs=null;this._gotoPageArgs=null;this._updateFormulaCollection();this._isRibbonClick=!1;this._intrnlUpdate=!1;this._isPvtNameEdit=!1;this._hlColor="#428bca";this._isFilter=!1;this._isShowHide=!1;this._insRows={};this._isTotalRow=!1;this._scrollReverse=!1;this._phoneMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth<420;this._tabMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth>419&&document.documentElement.clientWidth<617;this._dlgHeight=this._responsiveHeight-2;this._dlgWidth=this._responsiveWidth-2;this._isTouchEvt=!1;this._isTouchMoveSel=!1;this._isTouchScroll=!1;this._startXY=null;this._touchArgs=null;this._isResized=!1;this._isRibbonDestroyed=!1;this._resizeColl=[];this._delWrapColl={};this._fRowHtColl={};this._isFDlgChanged=!1;this._isChartDlgChanged=!1;this._isFRDlgChanged=!1;this._isGoDlgChanged=!1;this._isValDlgChanged=!1;this._isNMDlgChanged=!1;this._isFltrDlgChanged=!1;this._isPasswordDlg=!1;this._isInsdel=!1;this._canOverflow=!0;this.preventFilterPopup=!1;this._FATStyles={};this._isFiltered=!1;this._dautoFillCell={rowIndex:0,colIndex:0};this._isPublic=!1;this.isPasteValuesOnly=!1;this._isMaterial=!1;this._fRow={rowAdj:!0,fRowCnt:0};this._fCol={colAdj:!0,fColCnt:0};this._isSaveAsJSON=!1},_initFATProps:function(){var o,g,t="w:bold",i="c:#FFFFFF",n="c:#000000",l="c:#2F75B5",a="c:#ED7D31",v="c:#FFC000",r="1px solid #000000",u="1px solid #2f75b5",f="1px solid #ED7D31",e="1px solid #FFC000",y="b:#D9D9D9",s="b:#DDEBF7",p="b:#FCE4D6",w="b:#FFF2CC",nt="b:#000000",tt="b:#FFE2C6",it="b:#FFF1BF",h="b:#000000",rt="b:#D7D7D7",b="b:#FFC000",k="b:#5B9BD5",ut="b:#Ed7D31",d="hl?"+t+";"+n+";bo:tb-"+r+"&cl?"+y+";"+n+","+n+"&cb?b-"+r+"/hl?"+t+";bo:tb-"+u+";"+l+"&cl?"+s+";"+l+","+l+"&cb?b-"+u+"/hl?"+t+";bo:tb-"+f+";"+a+"&cl?"+p+";"+a+","+a+"&cb?b-"+f+"/hl?"+t+";bo:tb-"+e+";"+v+"&cl?"+w+";"+v+","+v+"&cb?b-"+e+"/hl?"+t+";"+nt+";"+i+";bo:o-"+r+"&cl?bo:t-"+r+";"+n+"&cb?o-"+r+"/hl?bo:o-"+u+";"+t+";"+k+";"+i+"&cl?bo:t-"+u+";"+n+"&cb?o-"+u+"/hl?"+t+";b:#EB7E2F;"+i+";bo:o-"+f+"&cl?bo:t-"+f+";"+n+"&cb?o-"+f+"/hl?"+t+";"+b+";"+i+";bo:o-"+e+"&cl?bo:t-"+e+";"+n+"&cb?o-"+e+"/hl?"+t+";bo:gb-"+r+";"+n+"&cl?"+y+";"+n+","+n+"&cb?gb-"+r+"/hl?"+t+";bo:gb-"+u+";"+n+"&cl?"+s+";"+n+","+n+"&cb?gb-"+u+"/hl?"+t+";bo:gb-"+f+";"+n+"&cl?"+p+";"+n+","+n+"&cb?gb-"+f+"/hl?"+t+";bo:gb-"+e+";"+n+"&cl?"+w+";"+n+","+n+"&cb?gb-"+e+"/hl?"+t+";"+nt+";"+i+"&cl?b:#A6A6A6;"+n+","+y+";"+n+"/hl?"+t+";"+k+";"+i+"&cl?b:#BDD7EE;"+n+","+s+";"+n+"/hl?"+t+";"+ut+";"+i+"&cl?b:#F8CBAD;"+n+","+p+";"+n+"/hl?"+t+";"+b+";"+i+"&cl?b:#FFE699;"+n+","+w+";"+n+"/hl?"+t+";"+rt+";"+n+";bo:gb-"+r+"&cl?b:#A7A7A7;"+n+","+rt+";"+n+"&cb?gb-"+r+"/hl?"+t+";b:#DBECF6;"+n+";bo:gb-"+u+"&cl?b:#BED8F1;"+n+","+s+";"+n+"&cb?gb-"+u+"/hl?"+t+";"+tt+";"+n+";bo:gb-"+f+"&cl?b:#F6CAAD;"+n+","+tt+";"+n+"&cb?gb-"+f+"/hl?"+t+";"+it+";"+n+";bo:gb-"+e+"&cl?b:#FDE18D;"+n+","+it+";"+n+"&cb?gb-"+e+"/hl?"+t+";"+h+";"+i+"&cl?b:#404040;"+i+",b:#737373;"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#2F75B5;"+i+","+k+";"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#C65911;"+i+","+ut+";"+i+"/hl?"+t+";"+h+";"+i+"&cl?b:#BF8F00;"+i+","+b+";"+i,c=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"];for(d=d.split("/"),o=0,g=c.length;o<g;)this._FATStyles["TableStyle"+c[o]]={format:this.XLRibbon._getFormatAsTableInput(d[o]),formatName:"TableStyle"+c[o]},o++;this.XLFormat._formatAsTableStyle=this._FATStyles["TableStyle"+c[0]]},_updateResponsiveSettings:function(){var i=t.browserInfo().name==="msie"&&t.browserInfo().version==="8.0",n=this.element[0].getClientRects()[0];this._responsiveHeight=Math.floor(i?this.element[0].offsetHeight:n?n.height:0);this._responsiveWidth=Math.floor(i?this.element[0].offsetWidth:n?n.width:0)},_sheetSettings:function(n){var e,u,r,o,h,i,f,c,s;if(this._isSheetReq?u=this.getSheet(n):(i=this.getSheet(n),h=this._generateSheetName(this._newSIndex),u=this.model.sheets[n]={colCount:i&&i.colCount||this.model.columnCount,rowCount:i&&i.rowCount||this.model.rowCount,_formulaCollection:{},columnsWidthCollection:[],_colWidthCollection:[],_ofColWidthColl:[],rowsHeightCollection:[],_rowHeightCollection:[],_rowIdxColl:[],_spreadSheetPager:null,showHeadings:i&&!this.isUndefined(i.showHeadings)?i.showHeadings:!0,showGridlines:i&&!this.isUndefined(i.showGridlines)?i.showGridlines:!0,dataSource:i&&i.dataSource||null,_jsonData:i?i.dataSource instanceof t.DataManager?null:i.dataSource:null,_dataManager:i&&i.dataSource instanceof t.DataManager?i.dataSource:null,query:i&&i.query||null,primaryKey:i&&i.primaryKey||"",startCell:i&&i.startCell||"A1",topLeftCell:i&&i.topLeftCell||"A1",fieldAsColumnHeader:i&&i.fieldAsColumnHeader||!1,showHeader:i&&i.showHeader===!1?!1:!0,headerStyles:i&&i.headerStyles||null,batchChanges:{added:[],changed:[],deleted:[]},range:[0,0,0,0],fields:[],_isDataManager:!1,_isOffline:!1,_hasDataSrc:!1,columns:i&&i.columns||[],_columnStyles:{},_rowStyles:{},cellTypes:i&&i.cellTypes||[],rows:i&&i.rows||null,_excelFilter:null,filterSettings:{filteredColumns:[],maxFilterChoices:1e3,filteredRange:[],range:"",tableRange:[]},frozenRows:i&&i.frozenRows||0,frozenColumns:i&&i.frozenColumns||0,_frozenRows:i&&i.frozenRows&&i.frozenRows+1||1,_frozenColumns:i&&i.frozenColumns&&i.frozenColumns+1||1,paneTopLeftCell:i&&i.paneTopLeftCell||"A1",_selectedRange:{},_selectedCellColors:[],columnWidth:i&&i.columnWidth||this.model.columnWidth,rowHeight:this.model.rowHeight,_frozenHeight:0,_frozenWidth:0,_firstRow:{idx:0,value:0},_firstCol:{idx:0,value:0},_topRow:{idx:0,value:0},_bottomRow:{idx:0,value:0},_leftCol:{idx:0,value:0},_rightCol:{idx:0,value:0},_filterColl:{},_commentColl:{},_mergeColl:{},_unmergeColl:{},_hideMergeColl:{},_clrMergeColl:[],_clrWrapColl:[],_selectedCells:[],selectedRange:[0,0,0,0],tableManager:{},_header:{},_selectedCellIndexes:[],_startCell:{rowIndex:0,colIndex:0},_endCell:{rowIndex:0,colIndex:0},_activeCell:{rowIndex:0,colIndex:0},_autoFillCell:{rowIndex:0,colIndex:0},rangeSettings:i&&i.rangeSettings||[],sheetInfo:{text:h,value:this._getLocStr("Sheet")+this._newSIndex,isVisible:!0},_multipleFiltering:!1,_multifilterIdx:[],_filteredByColor:"",staticWidth:0,_fRow:0,_fCol:0,hideColsCollection:{},hideRowsCollection:i&&i.hideRowsCollection||[],_hiddenFreezeRows:[],_hiddenFreezeCols:[],_filterHRowsColl:[],_restrictedHeightRows:[],filteredRowsCollection:[],_rHeightCollection:[],_frHiddenHeight:0,_fpHiddenHeight:0,_fpHiddenWidth:0,_pTarget:{},_cSpan:1,_rSpan:1,usedRange:{rowIndex:0,colIndex:0},mergedCells:[],shapeMngr:{picture:{},chart:{},sharedPics:[]},pivotMngr:{pivot:{}},_nmValue:{},_nmEdit:!1,_wrapHtCollection:{},_isChartBorderDrawn:!1,_virtualBlockCnt:0,_virtualBlockRowCnt:0,_virtualContBlockIdx:1,_virtualTopTBodyHgt:0,_virtualBottomTBodyHgt:0,_virtualTBodyHgt:0,_scrollTop:0,_scrollLeft:0,_virtualRowIdx:[],_virtualTopTBodyOffset:{top:0,bottom:0},_virtualContTBodyOffset:{top:0,bottom:0},_virtualBottomTBodyOffset:{top:0,bottom:0},_virtualDataLoadedBlks:[],_virtualDataMngrLoadedBlks:[1,2],_isVirtualTopReached:!0,_isVirtualEndReached:!1,_isLoaded:!1,_isImpSLoad:!1,_isRowSelected:!1,_isColSelected:!1,_isSheetSelected:!1,isSheetProtected:!1,_contWidth:0,_isRangeSelected:!1,_isEmptyActiveCell:!1,_isMultiSelect:!1,_isImported:this.isImport,_isRequested:!1,_goToCollection:{multiple:!1,selected:[]},_showLockCellAlert:!1,_reqCnt:0,_resCnt:0,_templateColCount:0,_isTemplate:!1,_cFormatFormula:{},_isVPRendered:!1,_isDataMoved:!1,_vPortHgt:0,_vPortWth:0,cFormatRule:i&&i.cFormatRule||[],mergeCells:i&&i.mergeCells||[],hideRows:i&&i.hideRows||[],hideColumns:i&&i.hideColumns||[],border:i&&i.border||[],isResized:!1,_isOpened:!1,_wrapColl:{},_isFreezed:!1,_ftopRowIdx:0,_fleftColIdx:0,_contScrollTop:0,_contScrollLeft:0,_fDivTop:0,_fDivLeft:0},this._initRangeSettings(n),o=u.sheetInfo.value,psheet=this._sheets[n]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null,_contTBody:null,_rowHdrTBody:null},this._calcEngine.registerGridAsSheet(o,o,this._calcID)),this.isImport&&(r=this._impData.model.sheets[n],e=this.getRangeIndices(r.topLeftCell||"A1"),u.sheetInfo.text=r.sheetInfo.text,u.sheetInfo.isVisible=this.isUndefined(r.sheetInfo.isVisible)?!0:r.sheetInfo.isVisible,this.model.importSettings.allowSheetOnDemand&&n!==this.getActiveSheetIndex()||(u._isRequested=!0),u._isRequested)){if(r.usedRange&&(r.usedRange.rowIndex&&(u.usedRange.rowIndex=r.usedRange.rowIndex),r.usedRange.colIndex&&(u.usedRange.colIndex=r.usedRange.colIndex)),r._startCell&&(r._startCell.rowIndex&&(u._startCell.rowIndex=r._startCell.rowIndex),r._startCell.colIndex&&(u._startCell.colIndex=r._startCell.colIndex)),r._endCell&&(r._endCell.rowIndex&&(u._endCell.rowIndex=r._endCell.rowIndex),r._endCell.colIndex&&(u._endCell.colIndex=r._endCell.colIndex)),r._activeCell&&(r._activeCell.rowIndex&&(u._activeCell.rowIndex=r._activeCell.rowIndex),r._activeCell.colIndex&&(u._activeCell.colIndex=r._activeCell.colIndex)),r.columnsWidthCollection&&(u.columnsWidthCollection=r.columnsWidthCollection),r.rowsHeightCollection){for(s=r.hideRowsCollection||[],f=0,c=s.length;f<c;f++)r.rowsHeightCollection[parseInt(s[f])]=0;u.rowsHeightCollection=r.rowsHeightCollection}t.isNullOrUndefined(r.showGridlines)||(u.showGridlines=r.showGridlines);r.hideRowsCollection&&(u.hideRowsCollection=r.hideRowsCollection||[]);r.shapeMngr.picture.length&&(u.shapeMngr.sharedPics=r.shapeMngr.sharedPics);r.isSheetProtected&&(u.isSheetProtected=r.isSheetProtected);r._restrictedHeightRows&&(u._restrictedHeightRows=r._restrictedHeightRows||[]);r._isColSelected&&(u._isColSelected=r._isColSelected);r._isRowSelected&&(u._isRowSelected=r._isRowSelected);r.showHeadings===!1&&(u.showHeadings=!1);r.frozenRows&&(u.frozenRows=u._frozenRows=e[0]+r.frozenRows,u._frozenRows=u.frozenRows+1);r.frozenColumns&&(u.frozenColumns=u._frozenColumns=e[1]+r.frozenColumns,u._frozenColumns=u.frozenColumns+1)}},_generateSheetName:function(n){var t,f,r,o=1,u=this.model.sheets,e=this._getLocStr("Sheet"),i=u[n];for(r=i&&i.sheetName||e+n,t=1,f=u.length;t<f;t++)u[t].sheetInfo&&r===u[t].sheetInfo.text&&(t=0,r=i&&i.sheetName?i.sheetName+o++:e+ ++n);return r},_initRangeSettings:function(n){var i,u=this.getSheet(n),r=u.rangeSettings.length;if(r)while(r--)i=u.rangeSettings[r],i.dataSource&&(i._jsonData=i._dataManager=null,i.dataSource instanceof t.DataManager?i._dataManager=i.dataSource:i._jsonData=i.dataSource,i.showHeader!=!1&&(i.showHeader=!0))},_initCSSTag:function(){if(!document.getElementById(this._id+"_sscustomformat")){this.isImport&&(this._dataContainer.hashCode=[]);var n,r,i=0,t;if(t=this._renderStyleTag("custom"),this.isImport)this._refreshImpStyles(this._impData.dataContainer.hashCode);else if(this.XLFormat)for(n="s:11pt/b:#FFC7CE;c:#82012A;f:calibri;s:11pt/b:#C6EED2;c:#0A7043;f:calibri;s:11pt/b:#FEEC9B;c:#826717;f:calibri;s:11pt/f:Calibri;w:bold;v:top;s:11pt/f:calibri;s:18pt/b:#DDE5F6;f:calibri;s:11pt/b:#FDE0D2;f:calibri;s:11pt/b:#EEEEEC;f:calibri;s:11pt/b:#FEF4CD;f:calibri;s:11pt/b:#9CC0E7;f:calibri;s:11pt/b:#F9AD7B;f:calibri;s:11pt/b:#C9C9C9;f:calibri;s:11pt/b:#FED965;f:calibri;s:11pt/b:#559AD9;c:#FFFFFF;f:calibri;s:11pt/b:#EB7E2F;c:#FFFFFF;f:calibri;s:11pt/b:#A5A5A5;c:#FFFFFF;f:calibri;s:11pt/b:#FDBF01;c:#FFFFFF;f:calibri;s:11pt".split("/"),r=n.length;i<r;)this.XLFormat._createFormatClass(this._getStyleAsJSON(n[i]),null,!0),i++;n=".e-spreadsheet .e-hide, .e-spreadsheet .e-mc-hide, .e-spreadsheet .e-fr-hide, .e-spreadsheet .e-fc-hide, .e-spreadsheet .e-c-hide, .e-spreadsheet .e-r-hide, .e-spreadsheet .e-col-hide{ display: none}";n+=".e-spreadsheet .e-rowcell.e-redft { background-color: #FFC7CE; color: #9C0055;} .e-spreadsheet .e-rowcell.e-yellowft { background-color: #FFEB9C; color: #9C6500;}";n+=".e-spreadsheet .e-rowcell.e-greenft { background-color: #C6EFCE;   color: #006100;} .e-spreadsheet .e-rowcell.e-redf { background-color: #FFC7CE;} .e-spreadsheet .e-rowcell.e-redt { color: #9C0055;}";n+=".e-spreadsheet .e-rowcell.e-hlcell { background-color: #FFFF00; color: #FF0000;} .e-spreadsheet .e-rowcell.e-goto-blank { background-color: #C6C6C6;}";t.styleSheet?t.styleSheet.cssText+=n:t.appendChild(document.createTextNode(n))}this._renderStyleTag("showhide")},_initEditForm:function(){var n,i,r;n=t.buildTag("input","",{display:"none"},{id:this._id+"_AutoComplete"});n.addClass("e-hide");this.element.append(n);this.XLEdit._renderAutoComplete(n,"",null,!0);n.data("ejAutocomplete")._setListPosition=function(){};i=t.buildTag("form","",{width:1,height:1,display:"none"},{id:this._id+"EditForm"});r=t.buildTag("input","",{width:1,height:1,overflow:"hidden",opacity:0},{id:this._id+"_ValElem"});i.append(r);r.data("id",this._id);this.element.append(i)},_getStyleAsJSON:function(n){var t,i=0,r={},u={b:"background-color",c:"color",f:"font-family",s:"font-size",w:"font-weight",v:"vetical-align",bo:"border"};for(n=n.split(";"),len=n.length;i<len;)t=n[i].split(":"),r[u[t[0]]]=t[0]==="bo"?this.XLRibbon._getBorderObj(t[1].split("-")[0],t[1].split("-")[1]):t[1],i++;return r},_initLayout:function(){this.model.showRibbon&&(this.XLRibbon._renderRibbon(),this._tabMode&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"));this.model.allowFormulaBar&&this._renderFormulaBar();this._renderFUpload();this._renderLayout();this._isAutoWHMode&&this._autoSSWidthHeight()},_renderLayout:function(){var n,t;for(this._renderPanel(),this._initTags(),this._initDependencies(),this._renderFooter(),this._refreshSheetLayout(),this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand?n=t=this.getActiveSheetIndex():(n=1,t=this.model.sheetCount);n<=t;)this._initSheet(n),n++},_renderPanel:function(){var i,n,r=this.model.scrollSettings;i=t.buildTag("div.e-spreadsheetgrppanel","",{},{id:this._id+"GroupPanel"});this.setGroupPanel(i);n=t.buildTag("div.e-spreadsheetmainpanel",this._renderDIV("e-spreadsheet-list",""),{},{id:this._id+"MainPanel"});i.append(n);this.setMainPanel(n);n=t.buildTag("div.e-spreadsheetactpanel","",{height:r.height,width:this.model.activationPanelWidth-1,display:"none"},{id:this._id+"ActivationPanel"});i.append(n);this.setActivationPanel(n);this.element.append(i)},_refreshSheetLayout:function(){var t,i=-1,r=this.model.pageSettings.pagerHeight+1;this._updateResponsiveSettings();this.XLRibbon._ribbonState&&(i=n("#"+this._id+"_Ribbon").find(".e-content:eq(1)").height());t=this._phoneMode?n("#"+this._id+"_Ribbon").height():n("#"+this._id+"_Ribbon").find(".e-header").height()+i+2;formulaHeight=this.model.allowFormulaBar?this._formulaHeight:0;ribbonHeight=t&&this.model.showRibbon&&n("#"+this._id+"_Ribbon").is(":visible")?t:0;this.model.showPager&&this.element.find(".e-spreadsheetfooter").is(":visible")||(r=1);contentHt=this._responsiveHeight-(ribbonHeight+formulaHeight+2);this._browserDetails.name=="msie"||this._isAutoWHMode||this.element.find(".e-spreadsheet-list").height(contentHt-r)},_initTags:function(){var n=t.buildTag("span#"+this._id+"_emptySpan"),i=t.buildTag("div#"+this._id+"_emptyDiv");this.element.find(".e-spreadsheetmainpanel")[0].insertBefore(n[0],this.element.find(".e-spreadsheetmainpanel").find(".e-spreadsheet-list")[0]);this.element.find(".e-spreadsheetmainpanel")[0].insertBefore(i[0],this.element.find(".e-spreadsheetmainpanel").find(".e-spreadsheet-list")[0]);this._refreshGlobalSpan()},_refreshGlobalSpan:function(t,i){t=t||document.getElementById(this._id+(i?"_emptyDiv":"_emptySpan"));t.textContent=t.className="";this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0"?n(t).removeAttr("style").text(""):t.style=""},_initSheet:function(n){var u,t=0,i=this.getSheet(n),r=this.getDataSettings(n);if(this._updateResponsiveSettings(),this._initViewPort(n),r&&!this._sheetCopy.isSheetCopy)for(u=r.length;t<u;)this._initDataSrc(n,i,r[t]),t++;i._reqCnt===i._resCnt&&this._renderSheet(n)},_initViewPort:function(t){var r=-1,u=ribbonHgt=scrollerHgt=scrollerWth=colHdrHgt=rowHdrWth=formulaHgt=0,f=this.model.scrollSettings,i=this.getSheet(t);f.allowScrolling&&(scrollerHgt=this._scrollerHeight,scrollerWth=this._scrollerWidth);i.showHeadings&&(colHdrHgt=this._colHeaderHeight,rowHdrWth=this._rowHeaderWidth);this.model.showRibbon&&(ribbonHgt=n("#"+this._id+"_Ribbon").height(),ribbonHgt=ribbonHgt<189?ribbonHgt:188);this.model.allowFormulaBar&&(formulaHgt=this._formulaHeight);this.model.showPager&&this.element.find(".e-spreadsheetfooter").is(":visible")&&(r=this.model.pageSettings.pagerHeight);this.getActivationPanel().is(":visible")&&(u=this.getActivationPanel().width());i._vPortHgt=this._responsiveHeight-(ribbonHgt+formulaHgt+colHdrHgt+r+scrollerHgt);i._vPortWth=this._responsiveWidth-(u+scrollerWth+rowHdrWth);f.allowVirtualScrolling&&(i._virtualBlockRowCnt=Math.ceil(i._vPortHgt/i.rowHeight)+this._bufferCnt)},_initDataSrc:function(n,i,r){if(r._dataManager){if(r._dataManager instanceof t.DataManager)if(r._dataManager.ready){var u=this;i._reqCnt++;this._reqCnt++;r._dataManager.ready.done(function(){u._initDataMngr(n,i,r)})}else this._initDataMngr(n,i,r)}else r._jsonData&&(r.count=r._jsonData.length)},_initDataMngr:function(n,i,r){var u,f,h,s,c,e,o=0,l=this;if(r._isDataManager=!0,r._isOffline=r._dataManager.dataSource.offline,r.query||(r.query=new t.Query),r.query.requiresCount(),this.model.scrollSettings.allowVirtualScrolling){if(s=r.query.queries,u=s.length,u)while(u--)f=s[u],f.fn==="onTake"?(o=f.e.nos,s.splice(u,1)):f.fn==="onSkip"&&(r._skip=f.e.nos);e=i._virtualBlockRowCnt*2;r.startCell&&(h=this.getRangeIndices(r.startCell),h[0]&&(e-=h[0]-0));o&&o<e&&(e=o);r.query.take(e)}c=r._dataManager.executeQuery(r.query);c.done(function(t){u=t.count||t.result.length;u&&(r._jsonData=t.result,r.count=o||u);l._respHandler(n)});c.fail(function(){l._respHandler(n)});r._dataManager.isDataAvailable||(i._reqCnt++,this._reqCnt++)},_respHandler:function(n){var t=this.getSheet(n);t._resCnt++;this._resCnt++;t._reqCnt===t._resCnt&&this._renderSheet(n);this._initComplete()},_renderSheet:function(i){var u,e,c,o,f=this.getActiveSheetIndex(),r=this.getSheet(i),l=r.sheetInfo.value,s={},h=this.element.find("#"+this._id+"_"+l);this._resizeColl[i-1]=!1;this._isInitLoad&&this._trigger("load",{sheetIndex:i});this._initTmplColumns(i);u=h.length===1?h:t.buildTag("div.e-sheet e-hide ","",{},{id:this._id+"_"+l});u.append(this._renderContent(i));h.length||(this.model.allowFreezing&&(o=this.XLFreeze._getHFreeze()),o?o.before(u):this.element.find(".e-spreadsheet-list").append(u));r.showGridlines===!1&&n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox({checked:r.showGridlines});this.model.enableContextMenu&&(this.XLCMenu._initContextMenu(),this.XLCMenu._initColorDialog(),this.XLCMenu._initCMenuFooter());this._updateResponsiveSettings();this._removeClass(u,"e-hide");s.width=this._responsiveWidth;s.height=this._responsiveHeight;this.model.showRibbon&&(this._tabMode||this._responsiveHeight<280)&&n("#"+this._id+"_Ribbon").ejRibbon("collapse");this._setSheetWidthHeight(i,s,null,"refresh","initial");this._refreshCellBinding(i);this._refreshImpResRowHght(i);this.refreshContent(i);i===f&&this._updateHiddenRows(f);this._initializePicture(i);this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&this._celltypes.length&&this._processCellTypes(this._celltypes,i);this.model.allowCellType&&!this.model.scrollSettings.allowVirtualScrolling&&this.XLCellType._rangeCellTypes(r.cellTypes,i);r._isImported&&!this._sheetCopy.isSheetCopy&&(this.setActiveSheetIndex(i),this._refreshImpSheets(i),this.setActiveSheetIndex(f));i!==f?u.hide():this._initSelection();this._initSheetModel(i);this.isImport&&r._isFreezed&&(c=this._impData.model.sheets[i],e=this.getRangeIndices(c.paneTopLeftCell),this._isFrozen(r.frozenRows)&&this.XLScroll._vScroller(i).scroll(this._getRowOffsetTop(r,e[0])-r._frozenHeight),this._isFrozen(r.frozenColumns)&&this.XLScroll._hScroller(i).scroll(this._getColOffsetLeft(r,e[1])-r._frozenWidth));r._isLoaded=!0;!this._isSheetInsert&&(this._pageClickArgs||this._gotoPageArgs)&&this._pageLoadComplete(i);this.getSheet(f)._isOpened=!0;this.model.showRibbon&&n("#"+this._id+"_Ribbon")[0].style.overflow==="hidden"&&(n("#"+this._id+"_Ribbon")[0].style.overflow="",this.model.showRibbon&&this.XLRibbon._refreshBackstageHeight())},_initSheetModel:function(n){var u,f,e,o,r=this.getSheet(n),t=this.getFrozenRows(n),i=this.getFrozenColumns(n);r.showHeadings===!1&&this.showHeadings(r.showHeadings);this.isImport&&(o=this._impData.model.sheets[n],u=this.getRangeIndices(o.topLeftCell||"A1"));f=this.isImport?u[0]:this._isFrozen(t)&&r._bottomRow.idx<=t?t-1:0;e=this.isImport?u[1]:this._isFrozen(i)&&r._rightCol.idx<=i?i-1:0;this.model.scrollSettings.allowScrolling&&(f>0&&this.XLScroll._vScroller(n).scroll(this._getRowOffsetTop(r,f)),e>0&&this.XLScroll._hScroller(n).scroll(this._getColOffsetLeft(r,e)));this.model.allowFreezing&&(this._isFrozen(t)&&this._isFrozen(i)?this.XLFreeze.freezePanes(t,i):this._isFrozen(t)?this.XLFreeze._freeze(t):this._isFrozen(i)&&this.XLFreeze._freeze(null,i))},_initTmplColumns:function(n){var u,f,i,r,t=this.getSheet(n);if(!this._sheetCopy.isSheetCopy&&!t.rangeSettings.length&&t.dataSource&&t._jsonData&&t.fieldAsColumnHeader&&(r=t._jsonData[0],range=this.getRangeIndices(t.startCell),u=range[1]+1,r)){for(i in r)r.hasOwnProperty(i)&&(f=r[i],typeof r[i]=="object"&&(i=this._iterateComplxObj(r[i],i).prop),t.columns[u-1]={field:this._generateHeaderText(u),text:i,type:f!=null?f.getDay?"date":typeof f:null},u++);t.colCount=t._templateColCount=t.columns.length;t._isTemplate=!0}},_refreshCellBinding:function(n){var t,r,f,l=this.getSheet(n),e=l.mergeCells,o=l.hideRows,u,i,s,h,c;if(e.length)for(u=0,f=e.length;u<f;u++)for(i=this.getRangeIndices(e[u]),s=i[2]-i[0]+1,h=i[3]-i[1]+1,c,t=0;t<s;t++)for(r=0;r<h;r++)c=t==0&&r==0?{merge:{isMerge:!0,mRange:e[u],isCenterAlign:!1,mSpan:{colSpan:h,rowSpan:s}}}:{isMHide:!0,mergeIdx:{rowIndex:i[0],colIndex:i[1]}},this.XLEdit._updateDataContainer({rowIndex:i[0]+t,colIndex:i[1]+r},{dataObj:c,sheetIdx:n,skipCell:!0});if(o.length&&this.model.scrollSettings.allowVirtualScrolling)for(t=0,f=o.length;t<f;t++)this._cellBindHiddenRows(o[t],o,n)},_cellBindHiddenRows:function(n,t,i){var r,u,e=this.getSheet(i),f=this.XLEdit;e.hideRowsCollection.push(n);this.XLScroll._getRowHeights(i,t.sort()[0]);u=n===0?{rowIndex:n,colIndex:0}:{rowIndex:n-1,colIndex:0};r={rowIndex:n,colIndex:0};f._updateDataContainer(u,{dataObj:{hRow:!0},sheetIdx:i,skipCell:!0});f._updateDataContainer(r,{dataObj:{isRHide:!0},sheetIdx:i,skipCell:!0})},_updateHiddenRows:function(n){var i,r,h,u=this.getSheet(n),s=u.hideRows,f,l=u.cFormatRule,e,o=u.hideColumns,c=u.border;if(s.length&&!this.model.scrollSettings.allowVirtualScrolling)for(i=0,r=s.length;i<r;i++)f=s[i],h=this.getRows(n),rows=h[1],hdrRows=h[0],this.addClass(rows[f],"e-r-hide"),this.addClass(hdrRows[f],"e-r-hide"),f>0&&this.addClass(hdrRows.eq(f-1).find("td")[0],"e-hrow"),this._cellBindHiddenRows(f,s,n);if(o.length&&!this.model.scrollSettings.allowVirtualScrolling){for(i=0,r=o.length;i<r;i++)u.hideColsCollection[o[i]]||this._updateHiddenColumns({rowIndex:0,colIndex:o[i]},n);this.XLScroll._getColWidths(n,o.sort()[0])}if(!t.isNullOrUndefined(l)&&l.length)for(i=0,r=u.cFormatRule.length;i<r;i++)e=u.cFormatRule[i],this.XLCFormat._cFormat(e.action,e.inputs[0],e.inputs[1],e.color,e.range,n);if(c.length&&!this.model.scrollSettings.allowVirtualScrolling)for(i=0,r=c.length;i<r;i++)this._updateCellBorder(c[i],n)},_updateHiddenColumns:function(n,t){var h=n.rowIndex,i=n.colIndex,u=this.getSheet(t),f={isCHide:!0},r=this._getJSSheetHeader(t),e=r.find("th"),o=r.find("col"),s=this._getContent(t).find("col");u.hideColsCollection[i]=u.columnWidth;u.columnsWidthCollection[i]=0;i===0&&(f.hCol=!0);this._writeRule(i,t);this.addClass(e[i],"e-hide");this.addClass(o[i],"e-hide");this.addClass(s[i],"e-hide");r.find("th:eq("+(i-1)+")").hasClass("e-hide")||this.addClass(r.find("th:eq("+(i-1)+")")[0],"e-hcol");this.XLEdit._updateDataContainer({rowIndex:0,colIndex:i},{dataObj:f,sheetIdx:t,skipCell:!0});i>0&&this.isUndefined(this.XLEdit.getPropertyValue(0,i-1,"isCHide"))&&this.XLEdit._updateDataContainer({rowIndex:0,colIndex:i-1},{dataObj:{hCol:!0},sheetIdx:t,skipCell:!0})},_renderContent:function(n){var r=[],i=t.buildTag("div.e-spreadsheetheader"),o=t.buildTag("div.e-headercontent"),h=t.buildTag("div.e-spreadsheetcolumnheader e-icon e-ss-selectall  e-ss-cursor","",{},{}),u=t.buildTag("div.e-spreadsheetcontentcontainer","",{"-webkit-tap-highlight-color":"rgba(0,0,0,0)"}),s=t.buildTag("div.e-content e-ss-cursor"),f=t.buildTag("div.e-spreadsheetrowheader","",{float:"left",width:"30px"},{}),e=t.buildTag("div.e-rowheadercontent");return this._isAutoWHMode&&(s.addClass("e-rmvbtmbdr"),o.addClass("e-rmvrghtbdr"),e.addClass("e-rmvbtmbdr")),this._setJSSheetHeader(i,n),i.append(h),i.append(o),r.push(i),i=t.buildTag("div.e-spreadsheetcontent"),this._setJSSheetContent(i,n),this._setContent(u,n),this._setJSSheetRowHeader(f,n),this._setJSSheetRowHeaderContent(e,n),f.append(e),u.append(s),i.append(f),i.append(u),r.push(i),r},refreshContent:function(n){n=n||this.getActiveSheetIndex();var t,i,e=this.getSheet(n),u=this.model.scrollSettings,f=u.allowVirtualScrolling,r=this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content");this._initDataRange(n);this._refreshRowColCnt(n);this._getJSSheetHeader(n).find(".e-headercontent").html(this._renderHeaderColumns(n));this._refreshTemplates(n);this._getJSSheetRowHeaderContent(n).html(this._renderHdrRows(n));r.find(".e-table").remove();r.prepend(this._renderContTable(n));this._initViewPortCont(n);this._isAutoWHMode?this._isInitLoad||this._autoSSWidthHeight(n):this.XLScroll._refreshScroller(n,"refresh","all");f||(this.XLScroll._getFirstRow(n),this.XLScroll._getFirstColumn(n));t=this._getContTBody(n).find("tr");i=this._getRowHdrTBody(n).find("tr");this.setRows([i,t],n)},_autoSSWidthHeight:function(t,i){var r={},f=this.model.scrollSettings,u=n("#"+this._id+"_Ribbon").data("ejRibbon");t=t||this._getSheetIndex();this._responsiveWidth=this._dlgWidth=r.width=this._getContTBody(t).width()+this._getJSSheetRowHeader(t).width();this._responsiveHeight=this._dlgHeight=r.height=this.element.height();this.model.showRibbon&&r.width<=480?(r.width=480,this._getContent(t).find(".e-content").removeClass("e-rmvrghtbdr")):i||this._getContent(t).find(".e-content").addClass("e-rmvrghtbdr");i||this._setSheetWidthHeight(t,r,null,"refresh");this.model.showRibbon&&(this.XLRibbon._refreshBackstageHeight(),u.setModel({width:r.width}))},_initDataRange:function(n){var c,r,t,e,o,u,f,s=0,i=this.getSheet(n),h=this.getDataSettings(n);if(h)for(c=h.length;s<c;)t=h[s],t._jsonData&&(t.batchChanges={added:[],changed:[],deleted:[]},t.fields=this.getObjectKeys(t._jsonData[0]),r=t.startCell?this._toIntrnlRange(t.startCell,n):[0,0,0,0],r[2]=r[0]+(!t.fieldAsColumnHeader&&t.showHeader?t.count:t.count-1),r[3]=r[1]+this.getObjectLength(t._jsonData[0])-1,t.range=r,u=r[2],f=r[3],(this._isAutoWHMode||i.usedRange.rowIndex<u)&&(i.usedRange.rowIndex=u),(this._isAutoWHMode||i.usedRange.colIndex<f)&&(i.usedRange.colIndex=f),e=u+1,o=f+1,(this._isAutoWHMode||i.rowCount<e)&&(i.rowCount=e),(this._isAutoWHMode||i.colCount<=o)&&(i.colCount=o),i._hasDataSrc=!0),s++},_renderStyleTag:function(n){var i,t;return i=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0],t=document.createElement("style"),t.type="text/css",n=="custom"?(t.setAttribute("id",this._id+"_sscustomformat"),i.appendChild(t)):n!=="showhide"||document.getElementById(this._id+"_sshide")||(t.setAttribute("id",this._id+"_sshide"),i.appendChild(t)),t},_renderHeaderColumns:function(n){var u,i,f,r,e=document.createElement("thead");return r=this._renderHeaderCol(n,0,this.getSheet(n).colCount),i=t.buildTag("table.e-table","",this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?{width:this._getEntireColWidth(n)}:{},{cellspacing:"0.25px"})[0],f=r[1],u=r[0],e.appendChild(u),i.appendChild(f),i.appendChild(e),i},_renderHeaderCol:function(n,i,r){var e,h,c,b,l,a,v,y,o,s=0,p=[],f=i,u=this.getSheet(n),w=document.createElement("tr"),k=document.createElement("colgroup");for(w.className="e-columnheader",this.isImport||(u._colWidthCollection.length=0,u._ofColWidthColl.length=0),u._colWidthCollection.push(s),u._ofColWidthColl.push(s);f<r;)e="e-headercell",l="col",o=u.columnsWidthCollection[f],this.isUndefined(o)&&(o=u.columnsWidthCollection[f]=u.columnWidth),f!=r-1&&(s=u._colWidthCollection[u._colWidthCollection.length-1]+o,u._colWidthCollection.push(s),u._ofColWidthColl.push(s)),this.model.allowSelection&&this._inColumn(u.selectedRange,f)&&(e+=" e-colhighlight",u._isColSelected&&(e+=" e-colselected")),o<1?(l+=".e-hide",e+=" e-hide"):u._hiddenFreezeCols.indexOf(f)>-1&&(l+=".e-fcol-hide",e+=" e-fcol-hide"),h=document.createElement("th"),h.className=e,a=v=this._generateHeaderText(f+1),u.fieldAsColumnHeader&&u.columns[f]&&(a=u.columns[f].text),c=document.createElement("div"),c.className="e-headercelldiv",c.innerHTML=a,h.appendChild(c),b=t.buildTag(l,"",{width:o},{}),w.appendChild(h),k.appendChild(b[0]),this._sheetCopy.isSheetCopy||u.columns[f]||(u.columns[f]={field:v,text:v,type:y!=null?y.getDay?"date":typeof y:null}),f++;return p.push(w),p.push(k),p},_getWidth:function(n,t,i){for(var r=0,u=this.getSheet(i);n<=t;n++)r+=u.columnsWidthCollection[n];return r},_getEntireColWidth:function(n){var t=this.getSheet(n),i=this._getIdxWithOffset(null,this._getLastColIdx(t)).xOffset;return i+t.columnsWidthCollection[t.columnsWidthCollection.length-1]},_getLastColIdx:function(n){for(var t=n.colCount-1;t>-1;){if(!(t in n.hideColsCollection)&&n._hiddenFreezeCols.indexOf(t)===-1)break;t--}return t},_getIdxWithOffset:function(n,i,r,u,f){u=u||[];var s,h,a,e=idx=pos=offset=0,l={},c=t.Spreadsheet.HideTypes,o=this.getSheet(f);if(!t.isNullOrUndefined(n)){if(r)for(a=o.rowsHeightCollection.length;e<a;){if(s=h=!1,u.indexOf(c.Default)===-1&&o.hideRowsCollection.indexOf(e)>-1&&(s=!0),u.indexOf(c.Freeze)===-1&&o._hiddenFreezeRows.indexOf(e)>-1&&(h=!0),!s&&!h){if(pos+=o.rowsHeightCollection[e],pos>n){idx=e;break}offset=pos}e++}else{while(e<n)s=h=!1,u.indexOf(c.Default)===-1&&o.hideRowsCollection.indexOf(e)>-1&&(s=!0),u.indexOf(c.Freeze)===-1&&o._hiddenFreezeRows.indexOf(e)>-1&&(h=!0),s||h||(offset+=o.rowsHeightCollection[e]),e++;idx=n}l.rowIdx=idx;l.yOffset=offset}if(!t.isNullOrUndefined(i)){if(r)for(e=idx=pos=offset=0,a=o.columnsWidthCollection.length;e<a;){if(s=h=!1,u.indexOf(c.Default)===-1&&e in o.hideColsCollection&&(s=!0),u.indexOf(c.Freeze)===-1&&o._hiddenFreezeCols.indexOf(e)>-1&&(h=!0),!s&&!h){if(pos+=o.columnsWidthCollection[e],pos>i){idx=e;break}offset=pos}e++}else{while(e<i)s=h=!1,u.indexOf(c.Default)===-1&&e in o.hideColsCollection&&(s=!0),u.indexOf(c.Freeze)===-1&&o._hiddenFreezeCols.indexOf(e)>-1&&(h=!0),s||h||(offset+=o.columnsWidthCollection[e]),e++;idx=i}l.colIdx=idx;l.xOffset=offset}return l},_renderHdrRows:function(n){var r,a,v,b,k,p,d,u,o,s,h,g,c,l,f,e,y,i=this.getSheet(n),w=this.model.scrollSettings.allowVirtualScrolling;if(c=t.buildTag("table.e-table","<colgroup><col style='width: 30px;'><\/colgroup>",{},{cellspacing:"0"}),!this._sheetCopy.isSheetCopy){for(u=f=0,y=i.rows,r=0,p=i.rowCount,i._rowHeightCollection=[],i._rowIdxColl=[],i._rowHeightCollection.push(u);r<p;)l=i.rowsHeightCollection[r],l||(l=i.rowsHeightCollection[r]=i.rowHeight),w&&(i.hideRowsCollection.indexOf(r)!==-1||i._hiddenFreezeRows.indexOf(r)!==-1)?l=0:i._rowIdxColl.push(r),r!=p-1&&i._rowHeightCollection.push(i._rowHeightCollection[i._rowHeightCollection.length-1]+l),r++;if(y){for(e=-1,k=y.length,g=this._browserDetails.name==="mozilla"?2:1,a=0;a<k;a++){for(o=y[a],b=o.cells.length,this.isUndefined(o.index)||(f=o.index),u=o.height||i.rowHeight,i.rowHeight<u&&(i.rowsHeightCollection[f]=u,e===-1&&(e=f)),v=0;v<b;v++)s=o.cells[v],s.style&&s.style["font-size"]&&(h=document.getElementById(this._id+"_emptySpan"),d=this.XLFormat._createFormatClass(s.style),this.addClass(h,d),h.textContent=s.value,u=h.offsetHeight+g,u>i.rowsHeightCollection[f]&&(i.rowsHeightCollection[f]=u,e===-1&&(e=f)),this._refreshGlobalSpan(h)),this.isUndefined(s.value)||(i._hasDataSrc=!0);f++}e!==-1&&this.XLScroll._getRowHeights(n,e,!0)}}return w?c.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottom'><\/tbody>"):c.append("<tbody>"+this._renderRowHdr(i._rowIdxColl,n)+"<\/tbody>"),this._setRowHdrTBody(c.find("tbody").eq(w?1:0),n),c},_renderRowHdr:function(i,r){for(var u,f,o=0,h=[],e=this.getSheet(r),s=i?i.length:e.rowCount;o<s;)u=i?i[o]:o,(t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isFilterHide",r))||t.isNullOrUndefined(this.XLEdit.getPropertyValue(u,0,"isRHide",r)))&&(f={height:e.rowsHeightCollection[u]<this.model.rowHeight?this.model.rowHeight:e.rowsHeightCollection[u],rowidx:u},f.className=this.XLEdit.getPropertyValue(u,0,"hRow",r)?"e-rowheader e-hrow ":"e-rowheader",this.XLEdit.getPropertyValue(u,0,"isFilterHighlight",r)&&(f.className+=" e-filterhiglight"),f.wrap=this.XLEdit.getPropertyValue(u,0,"wrapRow",r)?" e-sswraprow":"",this.model.allowSelection&&this._inRow(e.selectedRange,u)&&(f.className+=" e-rowhighlight",e._isRowSelected&&(f.className+=" e-rowselected")),h.push(f)),o++;return n.render[this._id+"JSONRowHdrTemplate"+r](h)},_refreshDataSrc:function(n,t){var r,e,f,o,h,u,i,p,l,s,a,c=isSheetData=!1,v=0,w=this.getSheet(t),y=this.getDataSettings(t);if(!w.rangeSettings.length&&w.dataSource&&(isSheetData=!0),y)for(p=y.length;v<p;){if(i=y[v],i.range)if(s=i.range,c=isSheetData?!i.fieldAsColumnHeader&&i.showHeader:i.showHeader,this.getObjectLength(i.headerStyles)&&this.model.allowCellFormatting&&(l=this.XLFormat._createFormatClass(i.headerStyles)),n)for(r=n[0],e=n[2],o=n[3];r<=e;){if(this._inRow(s,r))for(f=n[1];f<=o;)this._inColumn(s,f)&&(a=i.fields[f-i.range[1]],c&&r===s[0]?(u=i._jsonData[r-i.range[0]],u&&this._refreshCell(r,f,t,i,u,a,!1,l)):(u=i._jsonData[r-(i.range[0]+(c?1:0))],u&&this._refreshCell(r,f,t,i,u,a,!0))),f++;r++}else{if(r=0,e=s[0],o=s[1],f=s[2],c){u=i._jsonData[r];for(h in u)this._refreshCell(e,o,t,i,u,h,!1,l),o++;e++}while(e<=f){u=i._jsonData[r];o=s[1];for(h in u)this._refreshCell(e,o,t,i,u,h,!0),o++;r++;e++}}v++}},_refreshCell:function(n,t,i,r,u,f,e,o){var s,h=this._iterateComplxObj(u[f],f);s=this.XLEdit._parseValue(e?h.value:h.prop,{rowIndex:n,colIndex:t});s.sheetIdx=i;r.rangeName&&(s.rangeName=r.rangeName);e?r.primaryKey===f&&(s.isReadOnly=!0):(o&&(s.format=o,s.formats=r.headerStyles),isSheetData&&(s.isReadOnly=!0));this.XLEdit._updateDataContainer({rowIndex:n,colIndex:t},{dataObj:s,sheetIdx:i,skipCell:!0})},_iterateComplxObj:function(n,t,i){var r,u,e,o=i||t,f={prop:o,value:n};if(this._isObject(n)){e=".";for(r in n){if(u=n[r],this.isUndefined(u))return f;if(n.hasOwnProperty(r)&&this._isObject(u)&&!this._isDateTime(u))o+=e+r,f=this._iterateComplxObj(u,r,o);else return f.prop+=e+r,f.value=u,f}}return f},_refreshCellData:function(t,i){var f,c,w,u,a,e,r,k,v,y,o=0,s=this.getSheet(i),p=s.rows,h=s.hideColumns,b=s.border;if(p){for(f=0,len=p.length;f<len;f++){if(e=0,w=p[f],a=p[f].cells,w.index&&(o=w.index),(!t||this._inRow(t,o))&&a)for(c=0,l=a.length;c<l;c++)u=a[c],u.index&&(e=u.index),(!t||this._inColumn(t,e))&&(r=this.isUndefined(u.value)?{}:this.XLEdit._parseValue(u.value,{rowIndex:o,colIndex:e}),r.value=this.isUndefined(r.value)?this.isUndefined(this.XLEdit.getPropertyValue(o,e))?"":this.XLEdit.getPropertyValue(o,e):r.value,v=this.isFormula(r.value),v&&(this.XLEdit._refreshCalcEngine(o,e,!0,r.value,i),this._applyFormula(i,o,e)),u.format&&(y=this.XLFormat._getFormatObj(u.format),r.type=u.format.type,r.formatStr=y.format.formatStr,r.decimalPlaces=y.format.decimalPlaces,r.thousandSeparator=y.format.thousandSeparator?!0:!1),r.value2=this.XLFormat._format(v?this.XLEdit.getPropertyValue(o,e,"value2"):r.value,{formatStr:r.formatStr,type:r.type,thousandSeparator:r.thousandSeparator,decimalPlaces:r.decimalPlaces,cellObj:r}),u.hyperlink&&(r.hyperlink=u.hyperlink.webAddr?u.hyperlink.webAddr.indexOf("http")===-1?{webAddr:"http://"+u.hyperlink.webAddr}:{webAddr:u.hyperlink.webAddr}:{cellAddr:u.hyperlink.cellAddr+"_"+u.hyperlink.sheetIndex||i},r.formats={color:this._hlColor}),u.comment&&(k=(this.model.userName.length?this.model.userName:this._getLocStr("UserName"))+":\n",r.comment={value:k+(u.comment.value||""),isVisible:u.comment.isVisible||!1}),u.isLocked&&(r.isLocked=!0,this.protectSheet(!0)),u.style&&(r.formats=n.extend(u.style,r.formats)),r.formats&&(r.format=this.XLFormat._createFormatClass(r.formats)),this.XLEdit._updateDataContainer({rowIndex:o,colIndex:e},{dataObj:r,sheetIdx:i,skipCell:!0}),this.XLEdit._refreshCellAlignment({cellIdx:{rowIndex:o,colIndex:e},value:r.value,type:r.type}),v||this.XLEdit._refreshCalcEngine(o,e,!1,null,i)),e++;o++}this.model.scrollSettings.allowVirtualScrolling&&(s._virtualTBodyHgt=s._rowHeightCollection[s._rowHeightCollection.length-1]+s.rowsHeightCollection[s.rowsHeightCollection.length-1])}if(h.length&&this.model.scrollSettings.allowVirtualScrolling){for(f=0,len=h.length;f<len;f++)s.hideColsCollection[h[f]]||this._updateHiddenColumns({rowIndex:0,colIndex:h[f]},i);this.XLScroll._getColWidths(i,h.sort()[0])}if(b.length&&this.model.scrollSettings.allowVirtualScrolling)for(f=0,len=b.length;f<len;f++)this._updateCellBorder(b[f],i)},_updateCellBorder:function(n,t){var r,u,f,i,e=this.getRangeIndices(n.range);if(f={top:{top:"1px solid"},right:{right:"1px solid"},bottom:{bottom:"1px solid"},left:{left:"1px solid"},outside:{top:"1px solid",right:"1px solid",bottom:"1px solid",left:"1px solid"},allborder:{top:"1px solid",right:"1px solid",bottom:"1px solid",left:"1px solid"},thickbox:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottom:{bottom:"2px solid"},topandbottom:{top:"1px solid",bottom:"1px solid"},topandthickbottom:{top:"1px solid",bottom:"2px solid"}},i=f[n.type],borderColl=this.getObjectKeys(i),borderColl.length)for(r=0,u=borderColl.length;r<u;r++)i[borderColl[r]]=i[borderColl[r]].concat(" "+n.color);i.skipCell=!0;i.sheetIdx=t;n.type==="allborder"?this.XLFormat._applyAllBorderCss(i,e):this.XLFormat._applyBorderCss(i,e)},_renderContTable:function(i){var r;return this._sheetCopy.isSheetCopy?r=n(this._sheetCopy.sheetContent):(r=t.buildTag("table.e-table",this._sheets[i]._contentColGroup.outerHTML,this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?{width:this._getEntireColWidth(i)}:{},{cellspacing:"0"}),this.model.scrollSettings.allowVirtualScrolling?r.append("<tbody class='e-ss-virtualtop'><\/tbody><tbody><\/tbody><tbody class='e-ss-virtualbottom'><\/tbody>"):r.append("<tbody><\/tbody>")),this._setContTBody(r.find("tbody").eq(this.model.scrollSettings.allowVirtualScrolling?1:0),i),r},_initViewPortCont:function(n){var i,t=this.getSheet(n);this.model.scrollSettings.allowVirtualScrolling?this._refreshViewport(this._initLoad?0:this._isFrozen(this.getFrozenRows())?t._contScrollTop:t._scrollTop,n):(i=this.getRangeData({property:["value","value2","comment","hyperlink","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","picture","cFormatRule","isOfBrdr"],sheetIdx:n,rowIdxs:t._rowIdxColl,withRowIdx:!0}),this._getContTBody(n).html(this._renderData(i,n)),this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,n));t._isVPRendered=!0},_processCellTypes:function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)n[i].cellType.type==="DatePicker"?r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,value:n[i].value}}):r.push({range:this._getAlphaRange(t,n[i].rowIndex,n[i].colIndex,n[i].rowIndex,n[i].colIndex),settings:{type:n[i].cellType.type,isChecked:n[i].cellType.isChecked}});this.XLCellType._rangeCellTypes(r,t);this._celltypes=[]},_initDependencies:function(){var t=this.model;this._renderAlertdlg();this._renderAlertDlgContent(n("#"+this._id+"_alertdlg"),"Alert","");n("#"+this._id+"_alertdlg_title").outerHeight()===37&&(this._isMaterial=!0);this._initEditForm();t.allowClipboard&&this.XLClipboard._initCopyPaste();t.allowEditing&&(this.XLEdit._processEditing(),this.getMainPanel().append(this.XLEdit._editElem),this.XLEdit._editElem.hide());this._renderDDownList();this.clearUndoRedo();t.showRibbon&&this.XLRibbon._disableButtons(["clearfilter"],"ejButton");t.allowDataValidation&&this.XLValidate._addDVMethod();t.enableContextMenu&&this.XLCMenu._initCMenuFooter();t.allowFiltering&&this.XLFilter._renderExcelFilter();t.allowFreezing&&this.XLFreeze._initFreeze()},_initComplete:function(){this._reqCnt===this._resCnt&&(this._trigger("loadComplete",{}),this.isDirty=!1,this.clearUndoRedo(),this.hideWaitingPopUp(),this.XLRibbon.updateRibbonIcons())},_showDialog:function(t,i){var e,u="e-dialog",f=this.model,r;switch(t){case this._id+"_Ribbon_Home_Styles_ConditionalFormatting":r=n("#"+this._id+"_CFDialog");!r.length&&f.allowConditionalFormats&&(r=this.XLRibbon._initCFDialog());r.ejDialog("open");break;case this._id+"_chartname":r=n("#"+this._id+"_chartnamedlg");r.length||this.XLRibbon._renderChartNameDlg();break;case this._id+"_Ribbon_ChartDesign_Type_ChangeChartType":r=n("#"+this._id+"_charttypedlg");r.length||(r=this.XLRibbon._renderChartTypeDialog());break;case this._id+"_ImportPasswordDialog":r=n("#"+this._id+"_ImportPasswordDialog");r.length||(r=this._importPasswordDlg());r.ejDialog("open");break;case this._id+"_Ribbon_Insert_Links_Hyperlink":this.model.isReadOnly||(f.allowHyperlink&&!this._hasClass(document.getElementById(this._id+"_HLDialog"),u)&&this.XLRibbon._initHLDialog(),this._hlDlgOpen());break;case this._id+"_Ribbon_Others_Cells_InsertCellOptions":f.allowInsert&&(this._hasClass(document.getElementById(this._id+"_insertdeletedlg"),u)||this._renderInsertDeleteDialog(),this._refreshInsDelDialog("Insert"));break;case this._id+"_Ribbon_Others_Cells_DeleteCellOptions":f.allowDelete&&(this._hasClass(document.getElementById(this._id+"_insertdeletedlg"),u)||this._renderInsertDeleteDialog("delete"),this._refreshInsDelDialog("Delete"));break;case this._id+"_FormatCells":f.allowCellFormatting&&!this._hasClass(document.getElementById(this._id+"_formatdlg"),u)&&this.XLCellFrmtDlg._renderCellFrmtDlg();this.XLCellFrmtDlg._initFormatCellDlg();break;case this._id+"_MoveorCopy":this._hasClass(document.getElementById(this._id+"_moveCopyDlg",u))||this._initMoveCopyDlg();this._renderMoveCopyDlg();break;case this._id+"_UnhideSheet":this._hasClass(document.getElementById(this._id+"_UnhideDlg",u))||this._initUnhideDlg();this._renderUnhideDlg();break;case this._id+"_Ribbon_Data_DataTools_DataValidation":case this._id+"_Ribbon_Data_DataTools_DataValidationOptions":this.model.allowDataValidation&&!this._hasClass(document.getElementById(this._id+"_ValDialog"),u)&&(e=this.XLRibbon._initValDialog(),this.XLRibbon._renderValDialog(e));break;case this._id+"_Filter":document.getElementById(this._id+i+"_excelDlg")||document.getElementById(this._id+"_filter_custom_"+i)||this.XLFilter._renderFilterDialogs(i);break;case this._id+"_Ribbon_Review_Changes_ProtectWorkbook":this._hasClass(document.getElementById(this._id+"_PasswordDialog"),u)||this._passwordDlg();break;case this._id+"_Ribbon_Insert_Tables_Table":f.allowFormatAsTable&&!this._hasClass(document.getElementById(this._id+"_fatnamedlg"),u)&&this.XLRibbon._renderFATNameDlg();break;case this._id+"_Ribbon_Insert_Tables_PivotTable":f.enablePivotTable&&!this._hasClass(document.getElementById(this._id+"_PvtDialog"),u)&&(this.XLRibbon._initPvtDialog(),this.XLRibbon._renderPvtDialog());break;case this._id+"_Ribbon_Others_Editing_FindSelect":f.allowSearching&&!this._hasClass(document.getElementById(this._id+"_FRDialog"),u)&&(this.XLRibbon._initFRDialog(),this.XLRibbon._renderFRDialog(),this.model.isReadOnly||(e=this.XLRibbon._initGoToDialog(),this.XLRibbon._renderGoToDialog(e)));this.model.isReadOnly?n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option",{disabledItemIndex:[1,2]}):n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option",{enabledItemIndex:[1,2]});break;case this._id+"_Ribbon_ChartDesign_Data_SelectData":f.allowCharts&&!this._hasClass(document.getElementById(this._id+"_chartrangedlg",u))&&this.XLChart._renderChartRangeDialog();break;case this._id+"_Ribbon_Others_NameManager":document.getElementById(this._id+"_nmdlg")||this.XLRibbon._renderNameManagerDlg();break;case this._id+"_Ribbon_Design_Tools_ResizeTable":document.getElementById(this._id+"_fatresizetabledlg")||this.XLRibbon._renderFATResizeTableDlg()}},_generateHeaderText:function(n){var t="Z";return n/26>1?this._generateHeaderText(n%26==0?n/26-1:Math.floor(n/26))+String.fromCharCode(n%26==0?t.charCodeAt(t):64+n%26):String.fromCharCode(64+n)},_generateColCount:function(n){var i=0,t;for(n=n.split("").reverse().join(""),t=n.length-1;t>=0;t--)i+=(n[t].charCodeAt(n[t])-64)*Math.pow(26,t);return i},_getSheetIndex:function(n){return n||this.getActiveSheetIndex()},_getSheetIdxFromSheetValue:function(n){for(var t=1,i=this.model.sheets,r=i.length-1;t<=r;){if(i[t].sheetInfo.value.toLowerCase()===n.toLowerCase())return t;t++}return-1},getAlphaRange:function(n,t,i,r){return this.isUndefined(i)&&this.isUndefined(r)&&(i=n,r=t),this._getAlphaRange(null,n,t,i,r)},_getAlphaRange:function(n,t,i,r,u){return t=t+1,i=i+1,r=r+1,u=u+1,t===r&&i===u?this._generateHeaderText(i)+t:this._generateHeaderText(i)+t+":"+this._generateHeaderText(u)+r},_getProperAlphaRange:function(n,t,i,r,u){var f=this._getAlphaRange(n,t,i,r,u);return f.indexOf(":")===-1?f+":"+f:f},_getDollarAlphaRange:function(n,t){var u=this.getActiveSheetIndex(),i=this.getSheet(u).sheetInfo.text,r=i.match(/\s/g)?"'"+i+"'":i;return t&&!this.isRange(n)?r+"!$"+this._generateHeaderText(n[1]+1)+"$"+(n[0]+1):r+"!$"+this._generateHeaderText(n[1]+1)+"$"+(n[0]+1)+":$"+this._generateHeaderText(n[3]+1)+"$"+(n[2]+1)},_toIntrnlRange:function(n,t){return n?this._isString(n)&&(n=this.getRangeIndices(n)):n=this.getSheet(t).selectedRange,n},_getMaxRowColCnt:function(n,t,i){for(var u,f,r,e=0,o=0,n=n?n:this.model.sheets,s=i?i:1,h=i?i+1:n.length;s<h;)r=n[s],t&&r.usedRange?(u=r.usedRange.rowIndex,f=r.usedRange.colIndex):(u=r.rowCount,f=r.colCount),e<u&&(e=u),o<f&&(o=f),s++;return{rowCount:e,colCount:o}},_generateEJMenu:function(n,i,r){return{menuType:n==="normal"?t.MenuType.NormalMenu:t.MenuType.ContextMenu,orientation:i==="vertical"?t.Orientation.Vertical:t.orientation.Horizontal,cssClass:r}},_generateEJDD:function(t,i,r,u,f,e){return{dataSource:t,fields:i,selectedItemIndex:r,width:u,height:f,cssClass:"e-"+this._id+"-ddl",change:n.proxy(this.XLRibbon._frTypeChange,this,e)}},_heightWidthCalculation:function(t,i){var r,u=this.getActivationPanel(),f=u.is(":visible");this._isDisplayHeader?(r=n("#"+this._id+"_Ribbon").height(),this._isDisplayHeader=!1):r=this.XLRibbon._ribbonState?this.element.find(".e-ribbon").height()-1:this.element.find(".e-ribbon .e-header").height();this._refreshSheetWithScreen(t);this._updateResponsiveSettings();this._initViewPort(t);this._setSheetWidthHeight(t,{width:f?this._responsiveWidth-this.model.activationPanelWidth:this._responsiveWidth,height:this._responsiveHeight},r,"resize",i.action);f&&u.height(this.getMainPanel().height()-1);this.refreshContent(t)},_refreshSheetWithScreen:function(t){n("#"+this._id+"GroupPanel")[0].style.height="0px";n("#"+this._id+"MainPanel")[0].style.height="0px";this.model.allowFormulaBar&&(this.element.find(".e-formulabar")[0].style.width="0px");this.getSheetElement(t).find(".e-spreadsheetcontentcontainer")[0].style.height="0px";this.getSheetElement(t).find(".e-spreadsheetrowheader")[0].style.height="0px"},_refreshWidthHeight:function(i,r,u,f){var s,y=1,p=0,e=this._getContent(i),h,c,w=this.model.pageSettings.pagerHeight+1,b,l=this.getSheet(i),a=this._getJSSheetRowHeader(i),v,k,d=-1,g=n("#"+this._id+"_Ribbon").ejRibbon("instance"),o,nt;return b=this.model.showRibbon?g.model.selectedItemIndex<1?1:g.model.selectedItemIndex:0,this.XLRibbon._ribbonState&&(d=n("#"+this._id+"_Ribbon").find(".e-content:eq("+b+")").height()),v=this._phoneMode?n("#"+this._id+"_Ribbon").height():n("#"+this._id+"_Ribbon").find(".e-header").height()+d+2,c=this.model.allowFormulaBar?this._formulaHeight:0,u=v&&this.model.showRibbon&&n("#"+this._id+"_Ribbon").is(":visible")?v:0,l.showHeadings&&(y=22,p=a.width()),this._isAutoWHMode||(h=r.height-(u+c+1),this.getGroupPanel().height(h-1),this.getMainPanel().height(h-1),this.model.showPager&&(f==="initial"||this.element.find(".e-spreadsheetfooter").is(":visible"))||(w=1),k=this._browserDetails.name==="chrome"?1:2,r.height=r.height-(y+w+c+u+k),this.element.find(".e-spreadsheet-list")[0].style.height=""),this.model._isActPanelVisible?r.width=r.width-(this.model.activationPanelWidth+2):t.isNullOrUndefined(r.isActPanel)||r.isActPanel||(r.width=r.width+this.model.activationPanelWidth+2),o=this.model.scrollSettings,this.getMainPanel().width(!this.model._isActPanelVisible&&o.isResponsive?"100%":r.width),e.find("#hscrollBar").length>0&&(e.find("#hscrollBar").remove(),a.removeClass("e-scrollrowcss"),this._getJSSheetRowHeaderContent(i).height(r.height),this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").height(r.height-1)),e.find("#vscrollBar").length>0&&(nt=l._scrollTop,e.find("#vscrollBar").data("ejScrollBar").scroll(0),l._scrollTop=nt,e.find("#vscrollBar").remove(),this._getJSSheetHeader(i).removeClass("e-scrollcss"),this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").width(o.isResponsive?r.width-2:r.width)),this._isAutoWHMode||(e.height(r.height),a.height(r.height)),this._getJSSheetContent(i).width(o.isResponsive?"100%":r.width),s=this.getFooter(),s&&s.width(o.isResponsive?"100%":r.width),this._alignFormulaBar(this._responsiveWidth),this._initViewPort(i),this.model.allowFreezing&&this.XLFreeze._refreshFreeze(),r.width=r.width-p,r.height=r.height,r},_setSheetWidthHeight:function(t,i,r,u,f){var e=this.getSheet(t),b=n(document),o=this._getContent(t),s,h,a,v,c,l=this._getJSSheetRowHeader(t),y,p=this.model.scrollSettings.isResponsive,k=e.showHeadings?l.width():0,w;p?(f!="initial"&&u!="resize"&&(this._refreshSheetWithScreen(t),this._updateResponsiveSettings(),i={width:this._responsiveWidth,height:this._responsiveHeight}),this._resizeColl[t-1]=this._isResized,u!=="resize"||this.model.allowResizing&&(!this.model.allowResizing||this.XLResize._resizeStart)||f=="toggleBtn"||(this.model.activationPanelWidth=Math.floor(i.width/3)),u==="refresh"&&(w=this._browserDetails,w.name.indexOf("msie")>-1&&(b=this.model.showRibbon?n(document):n("body"))),y=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f,u),this._updateResponsiveSettings(),u!=="resize"||this.model.allowResizing&&(!this.model.allowResizing||this.XLResize._resizeStart)||f=="toggleBtn"||(this.model.activationPanelWidth=Math.floor(i.width/3)),i=y):(this._isAutoWHMode||(i.width=i.width-2),i=this._refreshWidthHeight(t,n.extend(!0,{},i),r,f,u));this.getMainPanel().width(!this.model._isActPanelVisible&&p?"100%":i.width+k);this.model.scrollSettings.allowScrolling&&(this.model._isActPanelVisible&&(i.width+=2),this._renderScroller(t,n.extend(!0,{},i),f),h=o.find("#vscrollBar"),s=o.find("#hscrollBar"),h.length>0&&this._getJSSheetHeader(t).addClass("e-scrollcss"),s.length>0&&(c=o.height(),l.height(c-18),this._getJSSheetRowHeaderContent(t).height(c-(s[0].style.display==="none"?0:18)),l.addClass("e-scrollrowcss")),f!="initial"&&(v=h.data("ejScrollBar"),a=s.data("ejScrollBar"),v.scroll(e._scrollTop),a.scroll(e._scrollLeft)));e.showHeadings||o.find(".e-content")[this.model.allowFormulaBar?"addClass":"removeClass"]("e-viewbrdr");this._isAutoWHMode||(this._dlgWidth=this._phoneMode||this._tabMode||this._responsiveWidth<350?this._responsiveWidth-2:this._responsiveWidth/2,this._dlgHeight=this._phoneMode||this._tabMode||this._responsiveHeight<350?this._responsiveHeight-2:this._responsiveHeight/1.5)},setWidthToColumns:function(n,t){var f=t||this.getActiveSheetIndex(),i=this.getSheet(f),c,l,a=0,u,r,s=!1,h,e,v,o;if(!this.isUndefined(i)){for(typeof n[0]=="object"&&(s=!0),i._isLoaded&&(c=this._getContent(f).find("col"),l=this._getJSSheetHeader(f).find("col")),e=0,v=n.length;e<v;e++)for(u=s?n[e].width:n[e],r=s?n[e].colIndex:e,h=this.XLEdit._getPropWithCellIdx([0,r,i.rowCount-1,r],"isOfBrdr",f),u===0&&(u=64),i._isLoaded&&(l[r].style.width=u+"px",c[r].style.width=u+"px"),a+=u,this.XLEdit.getPropertyValue(0,r,"isCHide",f)?(i.hideColsCollection[r]=u,i.columnsWidthCollection[r]=0):i.columnsWidthCollection[r]=u,this.XLScroll._getColWidths(f,r),o=0;o<h.length;o++)cellIdx=h[o],this._textClip(cellIdx.rowIdx,cellIdx.colIdx,"delete","",!0),this._textClip(cellIdx.rowIdx,cellIdx.colIdx,"add","",!0);i.staticWidth=a;i._isLoaded&&this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(f,"refresh","horizontal");(!i._isImported||i._isLoaded)&&(this.model.allowSelection&&this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this._isAutoWHMode&&this._autoSSWidthHeight())}},setHeightToRows:function(n){var r,i=this.getActiveSheetIndex(),s=0,u=this.getSheet(i),f=!1,e=this.getRows(i),h=e[1],c=e[0],t,o;for(typeof n[0]=="object"&&(f=!0),t=0,o=n.length;t<o;t++)height=f?n[t].height:n[t],rowIdx=f?n[t].rowIndex:t,height===0&&(height=22),this._isRowViewable(i,rowIdx)&&rowIdx!=-1&&(r=this._getRowIdx(rowIdx,i),h[r].style.height=height+"px",c[r].style.height=height+"px"),s+=height,u.rowsHeightCollection[rowIdx]=height;this.model.scrollSettings.allowScrolling&&(this.XLScroll._getRowHeights(i,1),this.XLScroll._refreshScroller(i,"refresh","vertical"));this.model.allowSelection&&(!u._isImported||u._isLoaded)&&(this.XLSelection._refreshBorder(),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_refreshRowColCnt:function(n){var f,o,r,e,u=buffHgt=buffWth=actPnlWidth=ribbonHgt=formulaHgt=0,h=this.model.scrollSettings,c=scrollerHgt=scrollerWth=colHdrHgt=rowHdrWth=0,s=h.scrollMode===t.Spreadsheet.scrollMode.Infinite,i=this.getSheet(n),l=this._responsiveHeight,a=this._responsiveWidth;i.rowCount>this._maxRowCnt&&(i.rowCount=this._maxRowCnt);f=this._getMaxHgt(n,this.isImport);s&&(buffHgt=i._vPortHgt+this._bufferCnt*i.rowHeight,f<buffHgt&&(r=buffHgt-f,u=Math.ceil(r/i.rowHeight),i.rowCount+=u,f+=u*i.rowHeight));h.allowVirtualScrolling&&(e=i.rowCount-(i.hideRowsCollection.length+(this.isImport?i._hiddenFreezeRows.length:0)),s&&(r=e%i._virtualBlockRowCnt,r&&(u=i._virtualBlockRowCnt-r,i.rowCount+=u,e+=u,f+=u*i.rowHeight)),i._virtualBlockCnt=Math.ceil(e/i._virtualBlockRowCnt),i._virtualTBodyHgt=f);i.colCount>this._maxColCnt?i.colCount=this._maxColCnt:s&&(buffWth=i._vPortWth+this._bufferCnt*i.columnWidth,o=this.isImport?this._getMaxWth(n):i.colCount*i.columnWidth,o<buffWth&&(r=buffWth-o,i.colCount+=Math.ceil(r/i.columnWidth)))},_getMaxHgt:function(n,t,i){var f,u=val=0,r=this.getSheet(n);if(t)for(f=r.rowsHeightCollection.length;u<f;)i&&r.hideRowsCollection.indexOf(u)!==-1||(val+=r.rowsHeightCollection[u]),u++;else val=(r.rowCount-(r.hideRowsCollection.length+r._hiddenFreezeRows.length))*r.rowHeight;return val},_getMaxWth:function(n){for(var i=0,t=0,r=this.getSheet(n),u=r.columnsWidthCollection.length;t<u;)i+=r.columnsWidthCollection[t],t++;return i},_refreshTemplates:function(i,r,u,f){for(var h,e,o,s=t.isNullOrUndefined(u)?0:u,l={},a=this.getSheet(i),v=t.buildTag("colgroup"),y=this.model.scrollSettings.allowVirtualScrolling,p=t.isNullOrUndefined(f)?a.colCount:f,c=y?"<tr style = 'height: {{:height}}px' idx = '{{:rowidx}}'>":"<tr style = 'height: {{:height}}px'>";s<p;)h=a.columnsWidthCollection[s],o=this._generateHeaderText(s+1),e=document.createElement("col"),h<1?e.setAttribute("class","e-hide"):a._hiddenFreezeCols.indexOf(s)>-1&&e.setAttribute("class","e-fcol-hide"),e.style.width=h+"px",c+="<td class='{{:"+o+"_className}}' rowspan=' {{:"+o+"_rspan}}' colspan=' {{:"+o+"_cspan}}'>{{:"+o+"_value}}<\/td>",v.append(e),s++;l[this._id+"JSONTemplate"+i]=c+"<\/tr>";r||(l[this._id+"JSONRowHdrTemplate"+i]=y?"<tr class='{{:wrap}}' style='height:{{:height}}px' idx='{{:rowidx}}'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>":"<tr class='{{:wrap}}' style='height:{{:height}}px'><td class='{{:className}}'>{{:rowidx + 1}}<\/td><\/tr>");n.templates(l);this._sheets[i]._contentColGroup=v.get(0)},_renderData:function(i,r,u,f,e){var y,h,p,s,o,g,ft,ht,ct,et,it,l,a,k,lt,w,ot,rt,at,v,vt,d=eCol=0,b=" ",nt=[],c=this.getSheet(r),st=e?f:c.colCount,tt=c._goToCollection,yt=tt.selected.length,ut,pt;if(i)for(ft=i.data,it=ft.length/st;d<it;){for(s={},y=eCol,l=i.rowIdx[d],a=e?u:0;y<eCol+st;){if(o=ft[y],o){if(k=this._generateHeaderText(a+1),h=k+"_className",p=k+"_value",s[h]="e-rowcell e-wrapword ",c.showGridlines||(s[h]+=" e-hborder"),!tt.multiple&&yt&&tt.selected.indexOf(l+":"+a)>-1&&(s[h]+=" e-selected"),a in c.hideColsCollection&&(s[h]+=" e-soverflow"),c._hiddenFreezeCols.indexOf(a)>-1&&(s[h]+=" e-fcol-hide"),this.model.allowSelection&&this.inRange(c.selectedRange,l,a)&&(rt=!0,tt.multiple&&(rt=!1,yt&&tt.selected.indexOf(l+":"+a)>-1&&(rt=!0)),rt&&(s[h]+=" e-selected"),c._activeCell.rowIndex===l&&c._activeCell.colIndex===a&&(s[h]+=" e-activecell")),this.isImport&&this.model.allowCellType&&this.model.allowAutoCellType&&((o.type=="shortdate"||o.type=="longdate")&&this._celltypes.push({rowIndex:l,colIndex:a,sheetIndex:r,cellType:{type:"DatePicker"},value:o.value2}),o.value2&&["true","yes","false","no"].indexOf(o.value2.toLowerCase())>-1&&this._celltypes.push({rowIndex:l,colIndex:a,sheetIndex:r,cellType:{type:"CheckBox",isChecked:["yes","true"].indexOf(o.value2.toLowerCase())>-1?!0:!1}})),this.isImport&&o.type=="date"&&this.XLFormat.addCustomFormatSpecifier(null,o.formatStr.replace(/^\{0\:|\}$/g,""),o.type),o.format&&(s[h]+=b+o.format,this._isClassHasProperty(o.format,"text-align","right")&&(s[h]+=" e-rightalign")),o.border&&(s[h]+=b+o.border),o.align?o.align===t.Spreadsheet.Align.Center?s[h]+=b+this._cAlign:o.align===t.Spreadsheet.Align.Right&&(s[h]+=b+this._rAlign):this._isGeneral(o.type)&&(typeof o.value=="object"&&this._isDateTime(o.value)||this.isNumber(o.value))&&(s[h]+=b+this._rAlign),o.isMHide&&(s[h]+=" e-mc-hide",s[h]+=" e-moverflow"),o.isOfBrdr&&(s[h]+=" e-ofbrdr"),o.isOverflow===!1&&(s[h]+=" e-overflow"),o.merge&&(ht=k+"_rspan",ct=k+"_cspan",et=o.merge.mSpan,s[ht]=et.rowSpan,s[ct]=et.colSpan,s[h]+=" e-moverflow",o.merge.isCenterAlign&&(s[h]+=b+this._cAlign)),o.cFormatRule)for(ut=0,pt=o.cFormatRule.length;ut<pt;ut++)ot=o.cFormatRule[ut].split("_"),ot[7]==="true"&&(s[h]+=" e-"+ot[4]);o.wrap&&(c._isImported&&!this.isFormula(o.value)||!c._isImported)&&(s[h]+=" e-sswraptext",v=this._dataContainer.sheets[r],this.isUndefined(v[l])&&(v[l]={}),this.isUndefined(v[l][0])&&(v[l][0]={}),v[l][0].wrapRow=!0,this.isUndefined(v[0])&&(v[0]={}),this.isUndefined(v[0][a])&&(v[0][a]={wrapCol:!0,wrapWidth:c.columnsWidthCollection[a]}),this._wrapCollection(l,a,this._detailsFromGlobalSpan(l,a,"height",this.XLEdit.getPropertyValue(l,a,"value"),c.columnsWidthCollection[a]),r));g=o.value2||"";o.hyperlink?e?(s[h]+=" e-hyperlinks",s[p]=g):s[p]=o.hyperlink.webAddr?String.format("<a href={0} class='e-hyperlinks' targrt='_blank'>{1}<\/a>",o.hyperlink.webAddr,g):String.format("<a href={0} class='e-hyperlinks'>{1}<\/a>","#",g):s[p]=g;o.comment&&(s[h]+=" e-commentcell",vt=o.comment.isVisible?"visible":"none",s[p]=String.format("<span class='e-comment'><span class='e-celltoparrow'><\/span><textarea class='e-comment-txtarea' style='display:{0};z-index:9'>{1}<\/textarea><\/span>",vt,o.comment.value)+s[p]);o.rule&&o.rule.isApply&&(s[h]+=" e-hlcell");!o.isFilterHeader||this.isUndefined(c._filterColl[l])||this.isUndefined(c._filterColl[l][a])||(lt="e-icon e-spanfilter e-filterspan "+c._filterColl[l][a].status,at=o.isFilterVisible?"display: visible":"display: none",s[p]=String.format('<span class="{0}" style="{1}"><\/span>',lt,at)+s[p],s[h]=s[h].replace("e-ralign",""),b=b.replace("e-ralign",""));o.altTxt&&!o.wrap&&(s[h]+=" e-alt-unwrap")}a++;y++}s.rowidx=l;w=c.rowsHeightCollection[l];s.height=this.isUndefined(w)||w<this.model.rowHeight?this.model.rowHeight:w;nt.push(s);eCol=y;d++}else if(it=this.model.scrollSettings.allowVirtualScrolling?c._virtualBlockRowCnt:c.rowCount,c._dummyData)nt=c._dummyData;else while(d<it){for(s={},y=0;y<st;)k=this._generateHeaderText(y+1),h=k+"_className",s[h]="e-rowcell e-wrapword ",y++;w=c.rowsHeightCollection[d];s.height=this.isUndefined(w)||w<this.model.rowHeight?this.model.rowHeight:w;s.rowidx=l;nt.push(s);d++}return c._dummyData=nt,n.render[this._id+"JSONTemplate"+r](nt)},_isGeneral:function(n){return this.isUndefined(n)&&(n=t.Spreadsheet.CellType.General),n===t.Spreadsheet.CellType.General},_isFormulaError:function(n){var t,i=["#NA","#DIV/0!","#NAME?","circular reference","TypeError","wrong"];for(t=0,len=i.length;t<len;t++)if(n.indexOf(i[t])>-1)return!0;return!1},_refreshViewport:function(n,t){var e,f,o,a,c,s,l,r,h,u,i=this.getSheet(t),v=this.XLShape._getCellIndexFromOffset(n,0);i._virtualContBlockIdx=this._getVirtualBlockIdx(t,v.rowIndex).idx;o=(i._virtualContBlockIdx-1)*i._virtualBlockRowCnt;a=this._getRowIdx(o,t,!0);s=i._virtualContBlockIdx*i._virtualBlockRowCnt;l=this._getRowIdx(s,t,!0);i._virtualContTBodyOffset.top=this._getRowOffsetTop(i,a);i._virtualBlockCnt===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(i._rowIdxColl[i._rowIdxColl.length-1],t),f=i._rowIdxColl,i._isVirtualTopReached=i._isVirtualEndReached=!0):i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=i._virtualTopTBodyOffset.bottom=i._virtualTopTBodyHgt=0,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,l),r=this._getRowIdx(s+(i._virtualBlockRowCnt-1),t,!0),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(r,t),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top)),f=i._rowIdxColl.slice(0,i._rowIdxColl.indexOf(r)+1),i._isVirtualTopReached=!0,i._isVirtualEndReached=!1):i._virtualContBlockIdx===i._virtualBlockCnt?(h=(i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=i._virtualBottomTBodyHgt=0,c=this._getRowIdx(o+(i._virtualBlockRowCnt-1),t,!0),i._virtualContTBodyOffset.bottom=this._getRowOffsetBottom(c,t),u=this._getRowIdx(h,t,!0),i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualContTBodyOffset.bottom-i._virtualContTBodyOffset.top+(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top)),f=i._rowIdxColl.slice(i._rowIdxColl.indexOf(u),i._rowIdxColl.indexOf(c)+1),i._isVirtualEndReached=!0,i._isVirtualTopReached=!1):(h=o-i._virtualBlockRowCnt,u=this._getRowIdx(h,t,!0),i._virtualTopTBodyOffset.top=this._getRowOffsetTop(i,u),i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.top=this._getRowOffsetTop(i,l),r=this._getRowIdx(s+(i._virtualBlockRowCnt-1),t,!0),i._virtualBottomTBodyOffset.bottom=this._getRowOffsetBottom(r,t),i._virtualTopTBodyHgt=n-(i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top+(n-i._virtualContTBodyOffset.top)),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-i._virtualBottomTBodyOffset.bottom,f=i._rowIdxColl.slice(i._rowIdxColl.indexOf(u),i._rowIdxColl.indexOf(r)+1),i._isVirtualTopReached=i._isVirtualEndReached=!1);e=this.getRangeData({property:["value","value2","comment","hyperlink","rule","cFormatRule","format","border","type","isFilterHide","isRHide","isFHide","isFilterHeader","isFilterVisible","filterState","isMHide","merge","hRow","isLocked","wrap","isOverflow","align","isOfBrdr","altTxt","formatStr"],sheetIdx:t,rowIdxs:f,withRowIdx:!0});this._getRowHdrTBody(t).html(this._renderRowHdr(e.rowIdx,t));this._getContTBody(t).html(this._renderData(e,t));this._refreshRows(t);this._refreshTBodiesHgt(t);this.model.allowComments&&this.XLComment._updateCmntArrowPos(null,t);i._virtualRowIdx=e.rowIdx;this.model.allowCellType&&this.XLCellType._rangeCellTypes(i.cellTypes,t);this._refreshViewVar(n,i._isLoaded?null:0,t)},refreshOverflow:function(n,t){this._refreshOverflow(n,t)},_refreshOverflow:function(n,t){t=this._getSheetIndex(t);var r,e,i,u,f,o=this.getSheet(t);for(n=n||[0,0,o.usedRange.rowIndex,o.usedRange.colIndex],f=this.XLEdit._getPropWithCellIdx(n,"value2"),r=f.length-1;r>-1;r--)i=f[r].rowIdx,u=f[r].colIdx,this.model.allowOverflow?this._textClip(i,u,"add","",!0):(this._isRowViewable(t,i)&&(e=this.getCell(i,u)[0]),this._removeClass(e,"e-overflow"),this._textClip(i,u,"delete","",!0),this.addClass(e,"e-overflow"),this.XLEdit._updateDataContainer({rowIndex:i,colIndex:u},{dataObj:{isOverflow:!1},skipCell:!0}))},_getVirtualBlockIdx:function(n,t,i){for(var r=1,u={},f=this.getSheet(n),e=this._getRowIdx(t,n,!1,!0);r<=f._virtualBlockCnt;){if(e<r*f._virtualBlockRowCnt){u.idx=r;break}r++}if(i)for(r=0;++r;)if(t<r*f._virtualBlockRowCnt){u.orgIdx=r;break}return u},_getBlockInfo:function(n,t,i){var r,f=this.getSheet(t),u=[0,0,0,f.colCount-1];return r=this._getVirtualBlockIdx(t,n,i),u[0]=f._virtualBlockRowCnt*(r.idx-1),u[2]=f._virtualBlockRowCnt*r.idx-1,r.range=u,i&&(u=[0,0,0,f.colCount-1],u[0]=f._virtualBlockRowCnt*(r.orgIdx-1),u[2]=f._virtualBlockRowCnt*r.orgIdx-1,r.orgRange=u),r},_getRowOffsetTop:function(n,t){return n._rowHeightCollection[t]},_getRowOffsetBottom:function(n,t){return this.getSheet(t)._rowHeightCollection[n]+this.getSheet(t).rowsHeightCollection[n]},_getColOffsetLeft:function(n,t){return n._colWidthCollection[t]},_getCellIdx:function(n){return{rowIndex:this.model.scrollSettings.allowVirtualScrolling?Number(n.parentNode.attributes.getNamedItem("idx").value):n.parentNode.rowIndex,colIndex:n.cellIndex}},_getMidCell:function(){var t,i={},n=this.getSheet();return t=n._bottomRow.idx-n._topRow.idx+1,i.rowIdx=n._topRow.idx+Math.floor(t/2),t=n._rightCol.idx-n._leftCol.idx+1,i.colIdx=n._leftCol.idx+Math.floor(t/2),i},_removeRange:function(t,i){var r=this.getActiveSheetIndex(),e=this._getRowHdrTBody(r),u=n(this._getRowHdrTBody(r)[0].rows),o=this._getContTBody(r),f=n(this._getContTBody(r)[0].rows);u.splice(t,i);f.splice(t,i);this.setRows([u,f],r);o.html(f);e.html(u)},_refreshTBodiesHgt:function(n){var t="px",n=this._getSheetIndex(n),i=this.getSheet(n),r=this._getJSSheetRowHeaderContent(n)[0].getElementsByTagName("tbody"),u=this._getContent(n)[0].getElementsByTagName("tbody");r[0].style.height=u[0].style.height=i._virtualTopTBodyHgt+t;r[2].style.height=u[2].style.height=i._virtualBottomTBodyHgt+t},_renderTD:function(n,t,i){return String.format("<td class='{0}' style='{1}' >{2}<\/td>",n,t,i)},_renderDIV:function(n,t,i){return i?String.format("<div class='{0}' title='{2}'>{1}<\/div>",n,t,i):String.format("<div class='{0}'>{1}<\/div>",n,t)},_renderTR:function(n,t,i){var r=this._sheetCopy.isSheetCopy?this.getSheet(i).rowsHeightCollection[t]:this.model.rowHeight,u="height:"+r+"px";return String.format("<tr style='{0}'>"+n+"<\/tr>",u)},_renderFooter:function(){var h=this.model.scrollSettings,i,r=t.buildTag("div.e-spreadsheetfooter","",{display:this.model.showPager?"block":"none"}),e=t.buildTag("table.e-table","",{},{}),o=n(document.createElement("tbody")),s=n(document.createElement("tr")),f=n(document.createElement("td")),c=this.model.scrollSettings,u;this._updateResponsiveSettings();i=h.isResponsive?"100%":this._responsiveWidth-2;f.append(this._renderSpreadSheetPager());f.find(".e-pagercontainer").append(t.buildTag("div#"+this._id+"_AddSheet.e-new e-icon e-default","",null,{title:this._getLocStr("NewSheet")}));s.append(f);o.append(s);e.append(o);r.append(e);this.getMainPanel().append(r);this.model.scrollSettings.isResponsive||this._isAutoWHMode||(i=i);this._refreshSpreadSheetPager();u=this.element.find(".e-spreadsheetfooter").outerHeight();this.model.showPager&&u>this.model.pageSettings.pagerHeight&&(this.model.pageSettings.pagerHeight=u<37?u:36);r.width(i).height(this.model.showPager?this.model.pageSettings.pagerHeight:0);this.element.find(".e-spreadsheetfooter .e-table").height(this.model.pageSettings.pagerHeight);this.setFooter(r)},gotoPage:function(t,i){if((i||!(t>this.model.sheetCount))&&!(t<1)){var u,r,f=this.model.sheets,v=this.getPager(),e={},o=this._impData,s,h,a={reqType:"gotoSheet",gotoIndex:t,newSheet:i,prevSheetIdx:this.getActiveSheetIndex()},c,l;(this._gotoPageArgs=n.extend(!0,{},a),this._isSheetNavigate=i?!1:!0,this._trigActionBegin(a))||(this.isImport||this.hideActivationPanel(),this.setActiveSheetIndex(t),r=f[t],i||r._isRequested||!r._isImported?(this.element.find(".e-sheet").hide(),i&&(this._addSheet(t),r=f[t]),this._isSheetInsert&&(u=v.ejPager("option","currentPage"),this._swapSheetDtCntr(f.length-1,u),this.model.activeSheetIndex=t=u,this._isSheetInsert=!1),this._isNew||(this.model.scrollSettings.allowVirtualScrolling||this.model.scrollSettings.allowSheetOnDemand)&&!r._isLoaded?(this.showWaitingPopUp(),this._initSheet(t)):(this.element.find("#"+this._id+"_"+r.sheetInfo.value).show(),i||this._initSelection(),this._isAutoWHMode&&this._autoSSWidthHeight(),this._gotoPageArgs&&this._pageLoadComplete(t)),r._isResized&&(this._refreshSheetWithScreen(t),this._updateResponsiveSettings(),e.width=this._responsiveWidth,e.height=this._responsiveHeight,this._setSheetWidthHeight(t,e,null,"refresh"),r._isResized=!1),this.model.scrollSettings.allowVirtualScrolling||r._isOpened||this._updateHiddenRows(t),this.model.allowFreezing&&this.XLFreeze._refreshFreeze(),this._isSheetNavigate=!1):this._importSheet(t),r._isOpened=!0,o&&!this._isExport&&!r._isImpSLoad&&r._isImported&&(s=o.model.sheets[t]._scrollTop,h=o.model.sheets[t]._scrollLeft,s>0&&this.XLScroll._vScroller(t).scroll(s),h>0&&this.XLScroll._hScroller(t).scroll(h),r._isImpSLoad=!0),c=this.getActiveCell(t),l=this.XLEdit.getPropertyValue(c.rowIndex,c.colIndex,"rule",t),l&&l.type==="list"&&this._setddlCell())}},insertSheet:function(){if(this.model.allowInsert&&!this.model.isReadOnly){var n=this.getPager(),t=n.ejPager("option","totalRecordsCount")+1;n.ejPager("option",{totalRecordsCount:t});this._isSheetInsert=!0;this.gotoPage(t,!0);this.setSheetFocus()}},_renameSheet:function(i){var r=this.element.find(".e-currentitem"),u=t.buildTag("input#"+this._id+"_Sheet_RenamePanel","",{width:r.width()+5+"px",padding:0},{type:"input",value:i||r.text(),maxlength:"31"});r.hide();u.insertAfter(r).select().focus();this._isSheetRename=!0;this.model.showRibbon&&this.XLRibbon._disableRibbonIcons();this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_off")},deleteSheet:function(n){if(this.model.allowDelete&&!this.model.isReadOnly){var t=this.getActiveSheetIndex(),i=this._getSheetNames(!0).length;n=n||t;i>1?(n!==t&&this.gotoPage(n,!1),this.getObjectLength(this._dataContainer.sheets[n])?this._showAlertDlg("","SheetDeleteAlert","sheetDeleteActn",470):this._removeSheet(n)):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",430)}},hideSheet:function(t){if(!this.model.isReadOnly){var i=this._getSheetNames(!0),u=this._getSheetNames(),r=n.isNumeric(t)?t:this._getSheetIndexByName(t)||this.getActiveSheetIndex();i.length>1?(u[r-1].isVisible=!1,this.gotoPage(this._getNxtVisibleSheet(r,null,i))):this._showAlertDlg("Alert","SheetDeleteErrorAlert","",377)}},unhideSheet:function(t){if(!this.model.isReadOnly){var r=this._getSheetNames(),i=n.isNumeric(t)?t:this._getSheetIndexByName(t);r[i-1].isVisible||(r[i-1].isVisible=!0,this.gotoPage(i));this.hideWaitingPopUp()}},_getNxtVisibleSheet:function(n,t,i){var r=this._getSheetNames(),u=r.length,f="<=",e=1,o=this._getSheetNames(!0),s=r[n-1].value===(i&&i[i.length-1].value||o[o.length-1].value);for((t||s)&&(u=0,f=">=",e=-1);this.operators[f](n,u);){if(r[n-1].isVisible)return n;n=n+e}},_renderSpreadSheetPager:function(){var r,i={},t=n(document.createElement("div"));return this.model.pageSettings.click=n.proxy(this._spreadSheetPagerClickHandler,this),this.model.pageSettings.totalRecordsCount=this.model.sheetCount,this.model.pageSettings.locale=this.model.locale,n.extend(i,this.model.pageSettings),i.currentPage=this.getActiveSheetIndex(),i.pageSize=1,i.showGotoPage=!1,this.setPager(t),t.ejPager(i),inst=t.data("ejPager"),inst._$first[0].title=this._getLocStr("Firstsheet"),inst._$last[0].title=this._getLocStr("Lastsheet"),inst._$next[0].title=this._getLocStr("Nextsheet"),inst._$prev[0].title=this._getLocStr("Prevsheet"),t.find(".e-parentmsgbar").remove(),r=t.find(".e-pagercontainer")[0],r.appendChild(t.find("a.e-PP")[0]),r.appendChild(t.find(".e-numericcontainer")[0]),r.appendChild(t.find("a.e-NP")[0]),t},_getPageCount:function(){var y=this.model.scrollSettings.isResponsive,p=this.model.pageSettings.pageCount;if(y){var r=0,h,i,u,c=this.getPager(),l,f,e=c.find(".e-currentitem"),w=c.find(".e-numericcontainer"),o=this._getSheetNames(),a=c.width(),s=250,b=w.children(":visible"),t=this.getActiveSheetIndex(),k=n(b[0]).data("index"),v=!0;for(i=this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0",i?(u=n("#"+this._id+"_emptySpan"),u.css({"font-size":e.css("font-size"),"font-family":e.css("font-family")})):(l=document.createElement("canvas"),f=l.getContext("2d"),f.font=e.css("font-size")+" "+e.css("font-family"));t>k-1;){if(s+=i?u.text(o[t-1].text).width()+19:f.measureText(o[t-1].text).width+19,a<=s)return r||1;t--;r++}for(t=this.getActiveSheetIndex();v;){if(h=this.isUndefined(o[t])?this._getLocStr("Sheet")+t:o[t].text,s+=i?u.text(h).width()+19:f.measureText(h).width+19,a<=s){v=!1;break}t++;r++}return i&&this._refreshGlobalSpan(),r||1}return p},_spreadSheetPagerClickHandler:function(i){var o,e,s=!1,r=this,f,u=n(i.event.target),h=r.getPager().data("ejPager");if(r._filterClose(u),!r._hasClass(u[0],"e-disable")&&(!u.hasClass("e-new")||!r.model.exportSettings.password))return(r.model.allowComments&&r.XLComment._isCommentEdit||r.XLEdit._isEdit||!r.model.allowInsert||r.model.isReadOnly)&&(i.event&&(u.hasClass("e-pager")||u.hasClass("e-new"))||r.element.find(".e-field-validation-error").length)?void 0:(r.model.allowComments&&r.XLComment._isCommentEdit&&r.XLComment._updateCurCmntVal(),r.XLEdit._isEdit&&r.XLEdit.saveCell(),!t.isNullOrUndefined(i.event)&&(u.hasClass("e-prevpage")||u.hasClass("e-nextpage")||u.hasClass("e-firstpage")||u.hasClass("e-lastpage"))&&(i.currentPage=r._getNxtVisibleSheet(i.currentPage,u.hasClass("e-prevpage")||u.hasClass("e-lastpage"))),f={activeSheet:r.getActiveSheetIndex(),gotoSheet:i.currentPage,newSheet:i.event&&u.hasClass("e-new")},f.newSheet?(o=r.getPager(),e=o.ejPager("option","totalRecordsCount")+1,f.gotoSheet=e):f.gotoSheet=i.currentPage,i.currentPage=f.gotoSheet,!t.isNullOrUndefined(i.event)&&i.event.target.id.indexOf("_Sheet_RenamePanel")>-1||r._isSheetRename&&!r._updateSheetNames(null,!1)||h._prevPageNo===i.currentPage)?void 0:(f.newSheet&&(o.ejPager("option",{totalRecordsCount:e,currentPage:e}),i.currentPage=e,s=!0),r._pageClickArgs=n.extend(!0,{},f),r.gotoPage(i.currentPage,s),n(i.event.target).hasClass("e-pager")||r._completeAction({reqType:"paging",sheetIndex:f.activeSheet,nSheetIndex:i.currentPage}),!1)},_pageLoadComplete:function(t){var r,i=this.getSheet(t),f="option",e="checked",u=this._gotoPageArgs,o=this.model.allowSelection;if(o&&t!==u.prevSheetIdx&&(this.XLSelection._isGridBordering||this.XLSelection._isOutsideBordering)&&(this._getContent(u.prevSheetIdx).find("div:first-child").removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor"),this.XLSelection._isGridBordering=this.XLSelection._isOutsideBordering=!1),(!i._isImported||i._isLoaded)&&this.model.enableContextMenu&&this.XLCMenu.hideCMenu(),this._refreshSpreadSheetPager(u.newSheet),o&&this.getSheetElement(t).find(".e-ss-activeimg").length&&this.XLSelection._cleanUp(!0),this.model.showRibbon&&(this._updateRibbonTab(i._activeCell),this.isImport||(this.model.allowLockCell&&(i.isSheetProtected?this.XLRibbon._disableRibbonIcons():this.XLRibbon._enableRibbonIcons(),this.XLRibbon._updateRibbonIcons()),this.model.allowComments&&this.XLComment._updateCmntRibIcons()),n("#"+this._id+"_Ribbon_PageLayout_Show_Headings").ejCheckBox(f,e,i.showHeadings),n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox(f,e,i.showGridlines)),this.model.allowCellFormatting&&(r=this.getSheetElement(t).find(".e-content")[0],this.XLFormat._formatEnable?(this._removeClass(r,"e-ss-cursor"),this.addClass(r,"e-ss-fpcursor")):(this.addClass(r,"e-ss-cursor"),this._removeClass(r,"e-ss-fpcursor"))),this._pageClickArgs){if(this._pageClickArgs.activeSheet=this.getActiveSheetIndex(),this._trigger("pagerClick",this._pageClickArgs))return;this.model.scrollSettings.isResponsive&&this._isResized&&!this._resizeColl[t-1]&&(this._refreshSheetonResize(),this._resizeColl.toString().indexOf("f")<0&&(this._isResized=!1,this._resizeColl.fill(!1)))}this.hideWaitingPopUp();this._pageClickArgs=this._gotoPageArgs=null;this._trigActionComplete(u)},_createTemplateElement:function(t,i){var r=document.createElement("script");return r.id=(this._id+t+i.field+n.inArray(i,this.getSheet(t).columns)+"_Template").split(" ").join(""),r.type="text/x-jsrender",r.text=i.templateContent?i.templateContent:n(i.templateID).html(),n("body").append(r),n(i.templateID).hide(),r},_refreshSpreadSheetPager:function(n){var t=this.getPager(),i={currentPage:this.getActiveSheetIndex()},u=t.height(),r;(this.isImport||this._isNew||t===null)&&(i.totalRecordsCount=this.model.sheetCount);(n||this._isInitLoad||this._isSheetInsert||this._isNew)&&(i.pageCount=this._getPageCount());t.ejPager("option",i).ejPager("refreshPager");this._updatePageContainer(t,i.currentPage);r=t.height();u!==r&&(i.pageCount=this._getPageCount(),t.ejPager("option",i).ejPager("refreshPager"),this._updatePageContainer(t,i.currentPage));this.model.allowInsert||this.addClass(document.getElementById(this._id+"_AddSheet"),"e-disable")},_updatePageContainer:function(t,i){var l,w,s,f,e,h,r=0,o=0,u=t.data("ejPager"),et=this.model.sheets,b=t.find(".e-numericcontainer").children(":visible"),k=u.model.pageCount,d=[u._$first[0],u._$prev[0]],g=["e-firstpagedisabled e-disable","e-firstpage e-default","e-prevpagedisabled e-disable","e-prevpage e-default"],nt=[u._$last[0],u._$next[0]],tt=["e-lastpagedisabled e-disable","e-lastpage e-default","e-nextpagedisabled e-disable","e-nextpage e-default"],it=b.length,ot=r+1===it;for(u._$next[0].className=u._$next[0].className.replace("-2x",""),u._$prev[0].className=u._$prev[0].className.replace("-2x","");r<it;){if(f=n(b[r]),s=f.data("index"),h=et[s].sheetInfo,e=h.text,ot){for(var v,st=t.outerWidth(),y,rt,p,ut=!0,c=e,ft=3,a=this._browserDetails.name==="msie"&&this._browserDetails.version==="8.0";ut;){if(a?(v=n("#"+this._id+"_emptySpan"),v.css({"font-size":f.css("font-size"),"font-family":f.css("font-family")}),y=248+(v.text(c).width()+19)):(rt=document.createElement("canvas"),p=rt.getContext("2d"),p.font=f.css("font-size")+" "+f.css("font-family"),y=248+(p.measureText(c).width+19)),st<=y&&e.length>=ft){c=e.slice(0,e.length-ft++)+"...";continue}ut=!1;e=c}a&&this._refreshGlobalSpan()}f.text(e);h.isVisible?w=s%k:f.hide();!l&&h.isVisible&&(l=s%k);r++}if(l===i)for(r=0;r<2;r++)this.addClass(d[r],g[o]),this._removeClass(d[r],g[o+1]),o+=2;if(o=0,w===i)for(r=0;r<2;r++)this.addClass(nt[r],tt[o]),this._removeClass(nt[r],tt[o+1]),o+=2},_updateSheetNames:function(i,r){var l,a,d,s,ht=this.getPager(),rt,v=ht.find(".e-currentitem"),y=this.model.sheets,g=n("#"+this._id+"_Sheet_RenamePanel"),ut=!0,b=[],nt,h,c,f,ft,et,ot,p,tt,u,o,e,w,st=[],k,it;if(t.isNullOrUndefined(i)&&(i=g.val().trim()),a=y[v.data("index")].sheetInfo.text,l={reqType:"renameSheet",prevName:a,newName:i},this._trigActionBegin(l)&&(r=!0),i=l.newName,r)return g.remove(),v.show(),this.model.showRibbon&&this.XLRibbon._enableRibbonIcons(),this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_on"),this._isSheetRename=!1,!1;if(i.match(new RegExp(".*[\\[\\]\\*\\\\/\\?].*"))&&(i=!1),!i)return this._showAlertDlg("Alert","SheetRenameEmptyAlert","sheetRenameActn",500),!1;for(u=1,rt=y.length;u<rt;u++)v.text()!==y[u].sheetInfo.text&&i.toLowerCase()===y[u].sheetInfo.text.toLowerCase()&&(ut=!1);if(ut){if(this.model.enablePivotTable&&this.XLPivot._updateSheetName(i),y[v.data("index")].sheetInfo.text=i){g.remove();v.show();calcObj=this._calcEngine;k=calcObj.getDependentCells().items;for(it in k)k.hasOwnProperty(it)&&st.push(it);for(nt=st,h=this._getSheetNames(),u=0;u<nt.length;u++)for(c=k[nt[u]],o=0;o<c.length;o++){if(f=calcObj.getFormulaInfoTable().items[c[o]],f)for(f=f.getFormulaText(),e=0;e<h.length;e++)h[e].text!==h[e].value&&(p=new RegExp(h[e].value+'(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi"),f.match(p)&&(f=f.replace(p,e+"/"),b.push(e),tt=!0));if(tt){for(w=0;w<b.length;)p=new RegExp(b[w]+'/(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi"),f=f.replace(p,h[b[w]].text),w++;ft=calcObj.rowIndex(c[o])-1;et=calcObj.colIndex(c[o])-1;ot=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+(parseInt(c[o].split("!")[1])+1));this.XLEdit._updateDataContainer({rowIndex:ft,colIndex:et},{dataObj:{value:f},sheetIdx:ot});tt=!1}}this._isSheetRename=!1}this._refreshSpreadSheetPager(!0);this.model.allowFormulaBar&&this.updateFormulaBar();nMngr=this.model.nameManager;for(u in nMngr)s=nMngr[u].refersto,s&&s.indexOf(a)>-1&&(s=s.replace(/[\']/g,""),nMngr[u].refersto=s.replace(a,i.match(/\s/g)?"'"+i+"'":i));return this.model.showRibbon&&(this.XLRibbon._enableRibbonIcons(),d=n("#"+this._id+"_nmgrid").data("ejGrid"),d&&(d.refreshContent(),n("#"+this._id+"_nmrange").val(""))),this.model.enableContextMenu&&n("#"+this._id+"_contextMenuFooter").data("ejMenu")._contextMenuEvents("_on"),l={reqType:"renameSheet",prevName:a,newName:i},this._trigActionComplete(l),!0}this._showAlertDlg("Alert","SheetRenameAlert","sheetRenameActn",325)},_getSheetIndexByName:function(n){var i=this._getSheetNames(),t,r;for(n&&(n=n.toLowerCase()),t=0,r=i.length;t<r;t++)if(i[t].text.toLowerCase()===n)return t+1;return!1},_removeSheet:function(t){var r=this.model.sheetCount,k=this._dataContainer.sheets,i,a=this.model.sheets,d,u,e,s,o,v=[],y,p,g,c,h,nt,w=[],f,b,l;if(r>1){if(c=a[t].sheetInfo.value,this._getAutoFillOptElem().appendTo(this.element),this.element.find("#"+this._id+"_"+c).remove(),r===this.getActiveSheetIndex()){for(i=1;i<r;i++)if(a[t-i].sheetInfo.isVisible){this.setActiveSheetIndex(t-i);break}}else this.setActiveSheetIndex(t);this._swapSheetDtCntr(t,r);r in k&&delete k[r];this._sheets.splice(r,1);a.splice(r,1);r=--this.model.sheetCount;this.getPager().ejPager("option",{totalRecordsCount:r,pageCount:this._getPageCount()});this.gotoPage(this.getActiveSheetIndex(),!1);this._getAutoFillOptElem().appendTo(this._getJSSheetContent(this.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content"));this._rebindScrollEvnt();h=this.model.nameManager;for(i in h)nt=h[i].refersto,nt.indexOf(c)>-1&&(w.push(h[i].name),h[i].refersto="#REF!");f=this._calcEngine;l=f.getDependentCells().items;for(i in l)l.hasOwnProperty(i)&&v.push(i);for(i=0;i<v.length;i++)for(e=l[v[i]],u=0;u<e.length;u++)if(s=f.getFormulaInfoTable().items[e[u]],p=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+(parseInt(e[u].split("!")[1])+1)),s&&p>-1){o=s.getFormulaText();y=new RegExp(c+'(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)',"gi");o.match(y)&&(o=o.replace(y,"#REF"),this.XLEdit._updateDataContainer({rowIndex:f.rowIndex(e[u])-1,colIndex:f.colIndex(e[u])-1},{dataObj:{value:o},sheetIdx:p}),f.refresh(s.getParsedFormula()));for(g in w)o.indexOf(w[g])>-1&&f.refresh(s.getParsedFormula())}if(this.model.showRibbon&&(b=n("#"+this._id+"_nmgrid").data("ejGrid"),b&&(b.refreshContent(),n("#"+this._id+"_nmrange").val(""))),d={sheetIndex:t,reqType:"remove-sheet"},this.clearUndoRedo(),this._trigActionComplete(d))return}},_rebindScrollEvnt:function(){for(var n=1;n<=this.model.sheetCount;n++)this.getSheet(n)._isLoaded&&(this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content").off("scroll"),this.element.find("#"+this._id+"_"+this.model.sheets[n].sheetInfo.value).find(".e-headercontent").off("scroll"),this._refreshScrollerEvent(n))},_getSheetNames:function(n){for(var u=[],i=this.model.sheets,t=1,r=i.length;t<r;t++)(this.isUndefined(n)||(!n||i[t].sheetInfo.isVisible)&&(n||!i[t].sheetInfo.isVisible))&&u.push(i[t].sheetInfo);return u},_initMoveCopyDlg:function(){var n=this._id+"_moveCopyDlg",i,r,f,e,o,s,u,c,l,h=280;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("Beforesheet")));c=t.buildTag("div.e-dlg-fields");s=t.buildTag("ul#"+n+"_list");r.append(c.append(s));u=t.buildTag("input#"+n+"_createcopy");r.append(u);u.ejCheckBox({cssClass:"e-dlg-fields"});u.parent().append(t.buildTag("label",this._getLocStr("CreateaCopy"),{"margin-left":6}));i.append(r);o=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");l=t.buildTag("div.e-dlg-btnctnr");f=t.buildTag("input#"+n+"_okbtn","",{"min-width":"25%"});e=t.buildTag("input#"+n+"_cnlbtn");f.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,click:t.proxy(this._moveCopyBtnClick,this,"ok")});e.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._moveCopyBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});o.append(l.append(f,e));i.append(o);this.element.append(i);this._isMaterial&&(h=h+18);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("MoveorCopy"),width:h,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg"});s.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderMoveCopyDlg:function(){var r=n("#"+this._id+"_moveCopyDlg"),t=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),i=this._getSheetNames();i.push({text:this._getLocStr("MoveToEnd"),value:this._getLocStr("MoveToEnd")});r.ejDialog("open");t.model.dataSource=i;t.option("fields",{dataSource:i});t.unSelectAll();t.selectItemByIndex(0)},_initUnhideDlg:function(){var n=this._id+"_UnhideDlg",i,r,u,f,e,o,s;i=t.buildTag("div#"+n,"",{display:"none"});r=t.buildTag("div#"+n+"_sheetContent.e-dlgctndiv e-dlg-fields",t.buildTag("label.e-dlg-fields",this._getLocStr("UnhideDlgText")));o=t.buildTag("ul#"+n+"_list");r.append(o);i.append(r);e=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");s=t.buildTag("div.e-dlg-btnctnr");u=t.buildTag("input#"+n+"_okbtn");f=t.buildTag("input#"+n+"_cnlbtn");u.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._unhideBtnClick,this,"ok")});f.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._unhideBtnClick,this,"cancel"),showRoundedCorner:!0,width:"25%"});e.append(s.append(u,f));i.append(e);this.element.append(i);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("UnhideSheet"),width:280,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg"});o.ejListBox({dataSource:this._getSheetNames(),height:"197px",width:"250px",fields:{text:"text",value:"value"}})},_renderUnhideDlg:function(){var r=n("#"+this._id+"_UnhideDlg"),t=n("#"+this._id+"_UnhideDlg_list").data("ejListBox"),i=this._getSheetNames(!1);i.length>0&&(r.ejDialog("open"),t.model.dataSource=i,t.option("fields",{dataSource:i}),t.unselectAll(),t.selectItemByIndex(0))},_moveCopyBtnClick:function(i){switch(i){case"ok":var c,r,u,y,e,p=!1,l=2,f,o=n(this.element).find(".e-currentitem"),w=n("#"+this._id+"_moveCopyDlg_list").data("ejListBox"),h=n("#"+this._id+"_moveCopyDlg_createcopy").data("ejCheckBox"),v=w.getSelectedItems()[0].text,s=w.getIndexByText(v),a=this.model.sheets;if(!h.isChecked()&&v===o.text()){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();return}for(u=1;u<a.length;u++)v===a[u].sheetInfo.text&&(r=u),o.text()===a[u].sheetInfo.text&&(f=u);if(c={reqType:"moveSheet",toSheetIndex:s,fromSheetIndex:f,isCopy:h.isChecked()},this._trigActionBegin(c))return n("#"+this._id+"_moveCopyDlg").ejDialog("close"),!1;if(s=c.toSheetIndex,f=c.fromSheetIndex,h.isChecked()){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+l+")":o.text().lastIndexOf(" ")!==-1&&(l=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+l+")");!p;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+l+")",u=1,y=a.length;u<y;u++)e===a[u].sheetInfo.text&&l++;l===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(p=!0)}this._copySheetProcess(f,e);f=this.model.sheetCount;t.isNullOrUndefined(r)&&(r=f)}else!t.isNullOrUndefined(r)&&r>f&&(r=r-1);if(t.isNullOrUndefined(r)&&(r=s),!h.isChecked()&&r===f){n("#"+this._id+"_moveCopyDlg").ejDialog("close");this.setSheetFocus();break}this._swapSheetDtCntr(f,r);n("#"+this._id+"_moveCopyDlg").ejDialog("close");r<=f&&(s=s+1);this.getPager().ejPager("option",{currentPage:s});this.gotoPage(s,!1);this._rebindScrollEvnt();c={reqType:"moveSheet",toSheetIndex:s,fromSheetIndex:f,isCopy:h.isChecked()};this._trigActionComplete(c);h._unChecked();h._isChecked=!1;this.setSheetFocus();break;case"cancel":n("#"+this._id+"_moveCopyDlg").ejDialog("close")}},_unhideBtnClick:function(t){if(t==="ok"){var i=n("#"+this._id+"_UnhideDlg_list").data("ejListBox");this.unhideSheet(i.getSelectedItems()[0].text)}n("#"+this._id+"_UnhideDlg").ejDialog("close")},_swapSheetDtCntr:function(n,t){var f=this._dataContainer.sheets,i=this.model.sheets,e=this._sheets,o=this._getLocStr("Sheet"),s=[{}],h,l=this._getSheetNames(),u,r,c;for(u in f)f.hasOwnProperty(u)&&(s[parseInt(i[u].sheetInfo.value.replace(o,""))]=f[u]);for(i.splice(t,0,i.splice(n,1)[0]),e.splice(t,0,e.splice(n,1)[0]),r=1,c=i.length;r<c;r++)h=parseInt(i[r].sheetInfo.value.replace(o,"")),this._dataContainer.sheets[r]=s[h];this.clearUndoRedo()},_copySheetProcess:function(t,i){var u,h=this.getPager(),c=h.ejPager("option","totalRecordsCount")+1,f=this.model.sheets,r,o,v,s,l,e,a;if(this._impData&&this.XLExport._renderAll(),h.ejPager("option",{totalRecordsCount:c,currentPage:c}),f.push(jQuery.extend(!0,{},f[t])),this._sheetCopy={isSheetCopy:!0,sheetContent:this._getContent(t).find(".e-table").clone(!0).get(0)},r=this.model.sheetCount+1,f[r].sheetInfo.text=i,o=f[r].sheetInfo.value=this._getLocStr("Sheet")+this._newSIndex,this._newSIndex++,this.setActiveSheetIndex(r),this._dataContainer.sheets[r]=n.extend(!0,{},this._dataContainer.sheets[t]),v=this._sheets[r]={_contentColGroup:null,_content:null,_sheetRowHeaderContent:null,_sheetHeader:null,_sheetRowHeader:null,_sheetContent:null,_Rows:null},this._initSheet(r),this.model.sheetCount++,this._sheetCopy={isSheetCopy:!1,sheetContent:null},this._calcEngine.registerGridAsSheet(o,o,this._calcID),!this.model.scrollSettings.allowVirtualScrolling)for(s=this._getContent(r).find(".e-commentcell"),e=0,a=s.length;e<a;e++)l=n(s[e]),u=this._getCellIdx(n(".e-commentcell")[0]),l.removeClass("e-commentcell")&&this.XLComment.setComment([u.rowIndex,u.colIndex,u.rowIndex,u.colIndex],null,!1);this.model.allowComments&&this.XLComment._updateCmntArrowPos()},showActivationPanel:function(n){var i,t=this.getActiveSheetIndex(),r=this.getActivationPanel(),u=this.model.scrollSettings;if(!this.model.enablePivotTable||this._phoneMode)return!1;if(this.isUndefined(n))this._getContent(t).find(".e-ss-activepivot").length&&this.XLPivot._displayActPanel&&(this.model._isActPanelVisible=!0,this._setSheetWidthHeight(t,{width:this._responsiveWidth,height:this._responsiveHeight,isActPanel:!0},null,"refresh"),this._refreshActivationPanel());else if(i=this.getSheet(t).rangeSettings[n],i.showPanel){if(this._trigger("beforePanelOpen",{activationPanel:r,range:i,sheetIndex:t}))return;this.model._isActPanelVisible=!0;this._setSheetWidthHeight(t,{width:this._responsiveWidth,height:this._responsiveHeight,isActPanel:!0},null,"refresh");this._refreshActivationPanel()}},_refreshActivationPanel:function(){var n=this.getActivationPanel(),i=this.getMainPanel().height(),t=n.data("ejScroller"),r;n.width(this.model.activationPanelWidth-1).height(i);n.find(".e-ss-pivotfield").hide();n.find("#"+this._id+"_PivotTableSchema_"+this._getContent(this.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).show();n.find(".e-ss-pivotfield").width(this.model.activationPanelWidth-20);n.show();r=this.getActivationPanel().find("#"+this._id+"_PivotTableSchema_"+this._getContent(this.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner");r._reSizeHandler();t&&(t.option({width:this.model.activationPanelWidth-1,height:i}),t.refresh())},hideActivationPanel:function(){var n=this.getActivationPanel(),t=this.model.scrollSettings;n.is(":visible")&&(n.find(".e-ss-pivotfield").hide(),this.model._isActPanelVisible=!1,n.hide(),this._isNew||this._setSheetWidthHeight(this.getActiveSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight},null,"refresh"))},_addSheet:function(n){this._sheetSettings(n);this._dataContainer.sheets[n]={};this._initSheet(n);this._newSIndex++;this.model.sheetCount++},addNewSheet:function(){this.model.allowInsert&&!this.model.isReadOnly&&this.element.find(".e-pager .e-new").click()},_createFocusElement:function(){this.setFocusTopElem(n("<div class='e-focustop e-hide' ><\/div>"));this.setFocusRightElem(n("<div class='e-focusright e-hide' ><\/div>"));this.setFocusBottomElem(n("<div class='e-focusbottom e-hide' ><\/div>"));this.setFocusLeftElem(n("<div class='e-focusleft e-hide' ><\/div>"))},_createAutoFillElement:function(){var i,r=this._getJSSheetContent(this.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content");this.model.allowAutoFill&&(i=n("<div class='e-autofill e-hide'><\/div>"),r.append(i),this.setAutoFillElem(i));this.element.append(t.buildTag("ul.e-spreadsheet","",{width:"auto"},{id:this._id+"_ctxtmenu"}));i=n("<div class='e-splitspan e-hide' title="+this._getLocStr("AutoFillTitle")+"><button id="+this._id+"_dragfilloptionbtn type='button'><\/button><\/div>");r.append(i);this._setAutoFillOptElem(i);this._initializeSplitButton()},_initializeSplitButton:function(){this._getAutoFillOptElem().find("button").ejSplitButton({size:"normal",contentType:"imageonly",targetID:this._id+"_ctxtmenu",prefixIcon:"e-icon e-ss-autofill",isSeparator:!1,buttonMode:t.ButtonMode.Dropdown,imagePosition:t.ImagePosition.ImageLeft,arrowPosition:t.ArrowPosition.Right,fields:{dataSource:this._fillOptionMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},beforeOpen:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillClick,this),itemSelected:n.proxy(this.model.allowAutoFill&&this.XLDragFill._autoFillOptionClick,this),width:"42px",height:"24px",cssClass:"e-spreadsheet e-autofillbtn"})},_renderFormulaBar:function(t){var i,r="<div id="+this._id+"_formulabar class='e-formulabar' ><div id="+this._id+"_indexbox class='e-indexbox' title='"+this._getLocStr("NameBox")+"'><\/div><div class='e-inputbox' ><input id="+this._id+"_inputbox type='text' title='"+this._getLocStr("FormulaBar")+"'/><\/div><\/div>",u;t?this.model.showRibbon?n("#"+this._id+"_Ribbon").after(r):this.element.prepend(r):this.element.append(r);this._setIndexBox(n("#"+this._id+"_indexbox"));i=n("#"+this._id+"_inputbox");this._setInputBox(i);this.XLEdit._renderAutoComplete(i,"",26);this._alignFormulaBar();u=this.element.find(".e-formulabar").height();u>36&&(this._formulaHeight=u);this.model.isReadOnly&&(this.element.find(".e-formulabar")[0].disabled=!0)},_alignFormulaBar:function(n){var u=this.model.scrollSettings,i,r,t;n=n||this._responsiveWidth;this.element.find(".e-formulabar").width(u.isResponsive?n-2:n);n=parseInt(n);i=n/10;r=n-(i+24);t=this.element.find(".e-inputbox");t.hide();t.width(Math.floor(r));this.element.find(".e-indexbox").width(Math.floor(i));t.show()},hideFormulaBar:function(){n("#"+this._id+"_formulabar").hide()},showFormulaBar:function(){this.model.allowFormulaBar&&(n("#"+this._id+"_formulabar").show(),this.updateFormulaBar())},_getlocaleNumVal:function(n,i){if(n=typeof n!="object"&&Number(n)?Number(n):!t.isNullOrUndefined(n)&&typeof n!="object"?t.parseFloat(n+"",this.model.locale):null,n&&i){var r=t.preferredCulture(this.model.locale).numberFormat,u=n.toString();r["."]!="."&&u.indexOf(r["."])<0&&(n=u.replace(".",r["."]))}return n},updateFormulaBar:function(){if(!this.model.isReadOnly){var r,u,o,e=this.getActiveSheetIndex(),i=this.getSheet(e)._activeCell,f=this._getContent(e).find(".e-ss-activeimg")[0];u=this.getRangeData({range:[i.rowIndex,i.colIndex,i.rowIndex,i.colIndex],property:["value","value2","isLocked"]})[0];r=t.isNullOrUndefined(u)?"":t.isNullOrUndefined(u.value)?"":u.value;this._isDateTime(r)&&(r=u.value2);this.isNumber(r)&&(r=this._getlocaleNumVal(r,!0));this._getInputBox().val(r);this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"isReadOnly")||this.model.allowLockCell&&this.getSheet(e).isSheetProtected&&u.isLocked?this._getInputBox().attr("readonly","readonly"):this._getInputBox().prop("readonly",!1);o=f&&(f.id.indexOf(this._id+"_picture")>-1||f.id.indexOf(this._id+"_chart")>-1)?f.id.replace(n(f).data("parentID")+"_",""):this._generateHeaderText(i.colIndex+1)+(i.rowIndex+1);this._getIndexBox().html(o)}},_initSelection:function(){var r,i=this.model,f=this.getActiveSheetIndex(),n=this.getSheet(f),u=this._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),e=i.selectionSettings.selectionType,o=t.Spreadsheet.SelectionType,s=i.selectionSettings.activeCell;i.allowSelection&&(this.getFocusTopElem()||this._createFocusElement(),u.append(this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem()),s&&(r=this.getRangeIndices(s),!this.isRange(r)&&r[0]<n.rowCount&&r[1]<n.colCount&&(n._startCell=n._endCell=n._activeCell={rowIndex:r[0],colIndex:r[1]})),(!n._isImported||n._isLoaded)&&n._selectedCells.length?(this.XLSelection.selectRange(n._selectedCells[0],n._selectedCells[n._selectedCells.length-1]),this.XLSelection._refreshBorder()):(this.XLSelection._processBoundary(),e===o.Row||n._isRowSelected?this.XLSelection.selectRows(n._startCell.rowIndex,n._endCell.rowIndex):e===o.Column||n._isColSelected?this.XLSelection.selectColumns(n._startCell.colIndex,n._endCell.colIndex):this.XLSelection.selectRange(n._startCell,n._endCell)));i.allowAutoFill&&(this.getAutoFillElem()||this._createAutoFillElement(),this.getAutoFillElem().appendTo(u),this.XLDragFill.positionAutoFillElement(),i.autoFillSettings.showFillOptions&&i.allowAutoFill&&(this._getAutoFillOptElem().appendTo(u),this.XLDragFill.hideAutoFillOptions()));i.allowSelection&&n._isFreezed&&this.XLFreeze._refreshSelection()},_updateRibbonTab:function(t){var i,u,r=this.getActiveSheetIndex(),o=n("#"+this._id+"_Ribbon").data("ejRibbon"),f=this.XLRibbon,s=this.element.find(".e-ribbon .e-contextual a:visible"),e=s.length,h=o.element.find("#"+this._id+"_Ribbon_togglebutton");if(t&&(u=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName",r)),e)while(e--)o.hideTab(s[e].text);f._toggleAnalyzeTab();h.is(":visible")&&h.hasClass("e-ribbonpin")&&this._refreshSheetonResize();i=this._getContent(r).find(".e-ss-activeimg");i.length?i[0].id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(i):this.XLRibbon._formatTabUpdate():u?f._designTabUpdate(this._getTableID(u),t):this._getContent(r).find(".e-ss-activepivot").length&&(f._analyzeTabUpdate(),this.XLSelection._cleanUp(!0),this.getActivationPanel().find("#"+this._id+"_PivotTableSchema_"+this._getContent(r).find(".e-ss-activepivot")[0].id).show(),this.showActivationPanel())},_updateCellType:function(){var n,i=t.Spreadsheet.CellType;for(n in i)this._dataContainer.cellType.push(i[n])},_updateFormulaCollection:function(){var n,i=this._calcEngine.getLibraryFunctions(),t=[];for(n in i.items)t.push({text:"="+n,display:n});this._formulaCollection=t},_renderScroller:function(n,t,i){this.XLScroll._createScroller(n,t,i);this._refreshScrollerEvent(n)},_refreshScrollerEvent:function(i){this._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").scroll(t.proxy(function(t){var i=this.getActiveSheetIndex(),r=this.getSheet(i),u=this._isFrozen(this.getFrozenColumns(i))?n(t.target).scrollLeft():r._scrollLeft;this._getJSSheetHeader(i).find(".e-headercontent").scrollLeft(u);this._getJSSheetRowHeaderContent(i).scrollTop(n(t.currentTarget).scrollTop())},this));this.element.find("#"+this._id+"_"+this.model.sheets[i].sheetInfo.value).find(".e-headercontent").scroll(t.proxy(function(t){var i=this.getActiveSheetIndex(),r=this._isFrozen(this.getFrozenColumns(i))?n(t.target).scrollLeft():this.getSheet(i)._scrollLeft;this._getContent(i).find(".e-content").scrollLeft(r);this.getSheet(i)._scrollLeft=this._getContent(i).find(".e-content").scrollLeft()},this))},_clickHandler:function(i){if(this.XLEdit._isFEdit=!1,this._hasClass(i.target,"e-ssfilter"))this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")?this._excelFilter.closeXFDialog():this.XLFilter._filterClickHandler(i);else{if(this._isExport||!this.model.cellClick)return!1;var o,r=i.target,s=this.getActiveSheetIndex(),u,f,e;if(i.target.tagName==="TD"&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&i.target.className.indexOf("e-rowcell")>-1&&n(i.target).find(".e-chk-image").length<1){if(u=r.cellIndex,f=n.inArray(n(r).closest("tr").get(0),this.getRows(s)[1]),e=this.getSheet(s).columns[u],o={columnName:e.field,value:this.XLEdit.getPropertyValue(f,u),columnIndex:u,rowIndex:f,columnObject:e,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",o))return}else if(!t.isNullOrUndefined(n(i.target).parents("div"))&&n(i.target).parents("div")[0].className.indexOf("e-content")>-1&&i.target.className.indexOf("e-rowcell")>-1&&n(i.target).find(".e-chk-image").length<1&&(r=n(i.target).parents("td").get(0),!t.isNullOrUndefined(r)&&(u=r.cellIndex,f=n.inArray(n(r).closest("tr").get(0),this.getRows(s)[1]),e=this.getSheet(s).columns[u],o={columnName:e.field,value:this.XLEdit.getPropertyValue(f,u),columnIndex:u,rowIndex:f,columnObject:e,cell:r,eventArgs:i,event:i,target:i.target},this._trigger("cellClick",o))))return}},_wireEvents:function(t){var i=this.element,r=this._id;this.model.enableTouch&&parseInt(this._browserDetails.version)>8&&this._wireTouchEvts(t);this[t](i,"mousedown",".e-spreadsheetcontentcontainer .e-content, .e-spreadsheetrowheader, .e-spreadsheetheader, .e-spreadsheetactpanel, .e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._mouseDownHandler);this[t](i,"mousemove",this._mouseMoveHandler);this[t](i,"mouseup",this._mouseUpHandler);this[t](i,"keydown",this._keyDownHandler);this[t](i,"keyup",this._keyUpHandler);this[t](i,"click",".e-spreadsheetcontentcontainer .e-content,.e-spreadsheetrowheader,.e-spreadsheetheader,.e-spreadsheetactpanel, .e-ss-object",this._clickHandler);this[t](i,n.isFunction(n.fn.doubletap)&&this.model.enableTouch&&parseInt(this._browserDetails.version)>8&&!this._browserDetails.isMSPointerEnabled?"doubletap":"dblclick",".e-spreadsheetcontentcontainer, .e-spreadsheetheader, .e-spreadsheetrowheader, .e-numericcontainer .e-numericitem",this._dblClickHandler);this[t](i,"mouseleave",".e-spreadsheetrowheader, .e-spreadsheetheader, .e-viewhdrlbl, .e-vheading, .e-viewlinlbl, .e-vgridlines",this._mouseLeaveHandler);this[t](i,"mouseover",".e-spreadsheetcontentcontainer .e-content .e-rowcell, .e-viewhdrlbl, .e-vheading, .e-viewlinlbl, .e-vgridlines, .e-rowheadercontent, .e-vscrollbar, .e-hscrollbar, .e-spreadsheetfooter, .e-spreadsheetheader",this._mouseHoverHandler);this.model.allowFormulaBar&&this[t](this._getInputBox(),"input",this.XLEdit._formulaBoxInputChange);this[t](n(".e-"+r+".e-chartcell"),"click",this._chartClickHandler);this[t](n("#"+r+"_cellstyles"),"click",this._cellStyleClick);this[t](n("#"+r+"_formatastable"),"click",this._formatAsTableClick);this[t](n("#"+r+"_nmuseinformula"),"click",".e-nmuseinformularow",this._useInFormulaClick);this.model.scrollSettings.allowScrolling&&this[t](this.element.find(".e-spreadsheet-list"),"mousewheel DOMMouseScroll",n.proxy(this.XLScroll._spreadMouseWheel,this.XLScroll));this.model.scrollSettings.isResponsive&&this[t](n(window),"resize",n.proxy(this._resizeHandler,this))},_wireTouchEvts:function(n){(this._browserDetails.name!="msie"||["11.0","10.0"].indexOf(this._browserDetails.version)===-1)&&this[n](this.element,this._getBrowserEvt(),".e-spreadsheetcontentcontainer .e-content, .e-spreadsheetrowheader, .e-spreadsheetheader, .e-spreadsheetactpanel, .e-ribbon, .e-spreadsheetcontentcontainer .e-vscroll, .e-spreadsheetcontentcontainer .e-hscroll",this._mouseDownHandler);this[n](this.element,this._getBrowserEvt("move"),this._mouseMoveHandler);this[n](this.element,this._getBrowserEvt("end"),this._mouseUpHandler);this[n](this.element,"swipeleft swiperight",".e-spreadsheetfooter",this._swipeHandler)},_getBrowserEvt:function(n,t){return n==="move"?this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointermove":"MSPointerMove":t?"mousemove":"touchmove":n==="end"?this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointerup":"MSPointerUp":t?"mouseup":"touchend":this._browserDetails.isMSPointerEnabled?this._browserDetails.pointerEnabled?"pointerdown":"MSPointerDown":"touchstart"},_swipeHandler:function(n){var t=this.getActiveSheetIndex();this.gotoPage(n.type==="swiperight"?--t:++t)},_isTouchEvent:function(n){return this.model.enableTouch&&(n.type.indexOf("touch")>-1||n.type.indexOf("pointer")>-1)&&n.originalEvent.pointerType!=="mouse"&&n.originalEvent.pointerType!==4?!0:!1},_getOriginalEvt:function(n){return n.originalEvent.changedTouches?n.originalEvent.changedTouches[0]:n.originalEvent},_allChartType:function(t){n("#"+this._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n(t.target).addClass("e-chartselect")},refreshSpreadsheet:function(){this._responsiveHeight>350&&(this._refreshSheetonResize(),this.model.showRibbon&&n("#"+this._id+"_Ribbon").data("ejRibbon")._ribbonResize())},_resizeHandler:function(){var t,n=this;n.element.is(":hidden")||(t&&clearTimeout(t),t=setTimeout(function(){n._refreshSheetonResize();for(var t=1,i=n.model.sheets.length;t<i;t++)n.getSheet(t)._isResized=t!=n.getActiveSheetIndex()},100))},_refreshSheetonResize:function(){var i=this.getActiveSheetIndex(),r,v=this.getActivationPanel(),h=n(".e-menu:visible[id^="+this._id+"], .e-ddl-popup:visible[id^="+this._id+"]"),t,u,c=["CFormat","Validation","PageSize","FPane","Ins","Del","FindRep"],e,l,y=this._phoneMode,o,s,f,a;if(this._resizeColl[i-1]=this._isResized=!0,this.element.find(".e-inputbox").hide(),this.model.enablePivotTable&&this.hideActivationPanel(),this._phoneMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth<420,this._tabMode=this.model.scrollSettings.isResponsive&&document.documentElement.clientWidth>419&&document.documentElement.clientWidth<617,this._isFltrDlgChanged=this._isValDlgChanged=this._isGoDlgChanged=this._isFRDlgChanged=this._isChartDlgChanged=this._isFDlgChanged=this._isNMDlgChanged=this._isPasswordDlg=!0,r={width:this._responsiveWidth,height:this._responsiveHeight},r.width=v.is(":visible")?r.width-this.model.activationPanelWidth:r.width,this.model.showRibbon&&(this._tabMode||this._responsiveHeight<280)&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"),this._refreshSheetWithScreen(i),this._updateResponsiveSettings(),this._initViewPort(i),this.refreshContent(i),r.width=this._responsiveWidth,r.height=this._responsiveHeight,this._setSheetWidthHeight(i,r,null,"refresh"),contentrows=this._getContTBody(i).find("tr"),rowhdrrows=this._getRowHdrTBody(i).find("tr"),this.setRows([rowhdrrows,contentrows],i),this._dlgWidth=this._phoneMode||this._tabMode||this._responsiveWidth<350?this._responsiveWidth-2:this._responsiveWidth/1.5,this._dlgHeight=this._phoneMode||this._tabMode||this._responsiveHeight<350?this._responsiveHeight-2:this._responsiveHeight/1.2,this.model._isActPanelVisible&&this._refreshActivationPanel(),this.element.find(".e-inputbox").show(),this.model.showPager&&(this._isSheetRename&&(e=this.getPager().find("#"+this._id+"_Sheet_RenamePanel"),l=e.val(),e.remove()),this._refreshSpreadSheetPager(!0),this._isSheetRename&&this._renameSheet(l)),this._phoneMode&&(n("#"+this._id+"_CFormat").css("width",""),n("#"+this._id+"_Ribbon_Border").css("width",""),n("#"+this._id+"_indexbox").css({"text-overflow":"ellipsis",overflow:"hidden"})),this.model.showRibbon&&(this.XLRibbon._refreshBackstageHeight(),this._phoneMode&&!y&&this.XLRibbon._hideRibbonElem()),h.length&&(t=h[0].id.split("_",3),t.indexOf("Ribbon")===-1&&t.splice(1,0,"Ribbon"),t[2]=c.indexOf(t[2])>-1?["Home_Styles_ConditionalFormatting","Data_DataTools_DataValidationOptions","PageLayout_PageLayout_PageSizeOptions","Others_Window_FreezePanes","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect"][c.indexOf(t[2])]:t[2].toLowerCase(),t=t.join("_"),t.length&&(u=n("#"+t),u.hasClass("e-splitbutton")&&u.ejSplitButton("hide"),u.hasClass("e-dropdownlist")&&u.ejDropDownList("hidePopup"))),this._isResized=!1,this._isRibbonDestroyed){if(o=n("#"+this._id+"_Ribbon").ejRibbon("instance"),this.model.ribbonSettings.enableOnDemand)tabText=o.getTabText(o.model.selectedItemIndex),this.XLRibbon._createTabControls(tabText);else for(s=["HOME","DATA","PAGE LAYOUT","OTHERS"],f=0,a=s.length;f<a;f++)this.XLRibbon._updateRibCustomCss(s[f]);this._on(n(".e-"+this._id+".e-chartcell"),"click",this._chartClickHandler);this._on(n("#"+this._id+"_cellstyles"),"click",this._cellStyleClick);this._on(n("#"+this._id+"_formatastable"),"click",this._formatAsTableClick)}this._isRibbonDestroyed=!1;this._trigger("refresh")},_chartClickHandler:function(t){var i=n(t.target),r=n.extend(!0,{},n(t.target).data());i.parents().eq(1).hide();this.XLChart.createChart(null,r)},_useInFormulaClick:function(t){var i,r,e="=",o=!1,u=t.target.textContent,c=this.getActiveSheetIndex(),s=this.getActiveCell(c),f=this.XLEdit._editElem,h=f.text();if(this.XLEdit.editCell(s.rowIndex,s.colIndex,!0),h===e)f.text(e+u);else{if(r=this.XLDragFill._parseFormula(h),i=r.length,i){while(i--)if(r[i]===","||r[i]==="("){r.splice(i+1,0,u);o=!0;break}else if(this._isCellReference(r[i])||this.isNumber(r[i])){r[i]=u;o=!0;break}u=o?r.join(""):u}f.text(e+u)}f.focusEnd();n("#"+this._id+"_nmuseinformula").hide()},_formatAsTableClick:function(t){var u,f,i=t.target,e=this.getActiveSheetIndex(),o=this.getSheet(e),r=o._selectedCells;r.length!==0&&(i.parentNode.className==="e-formatastablecell"&&(u=this.XLEdit.getPropertyValue(r[0].rowIndex,r[0].colIndex,"tableName",e),this._showDialog(this._id+"_Ribbon_Insert_Tables_Table"),u?(this.XLFormat._formatAsTableStyle=this._FATStyles[i.parentNode.id.replace(/ /g,"")],this.XLFormat._createTable(this._getTableID(u),this.XLFormat._formatAsTableStyle)):r.length>1?(f=n("#"+this._id+"_fatname"),n("#"+this._id+"_fatnamedlg").ejDialog("open"),n("#"+this._id+"_fatheader").data("ejCheckBox").option("checked",!1),f.val("Table"+this._tableCnt).focus().setInputPos(f.val().length),this.model.allowCellFormatting&&(this.XLFormat._formatAsTableStyle=this._FATStyles[i.parentNode.id.replace(/ /g,"")])):this._showAlertDlg("Alert","FormatAsTableAlert",null,445)),(i.className.indexOf("back")>-1||i.parentNode.className==="e-formatastablecell")&&n("#"+this._id+"_Ribbon_Home_Styles_FormatAsTable").length&&n("#"+this._id+"_Ribbon_Home_Styles_FormatAsTable").data("ejSplitButton")._hidePopup())},_borderSelectionClick:function(t){var r={ID:t.target.parentNode.id},u,f=t.target,e=this.getActiveSheetIndex(),i=this.getSheet(e)._selectedCells;i.length!==0&&(this._borderStyles.indexOf(r.ID)>-1&&this.XLRibbon._updateBordeStyle(r),hexcode=this._borderColor||"#000000",u=this._getAlphaRange(e,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex),this.model.allowSelection&&(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering)?!(this._borderStyles.indexOf(r.ID)>-1)&&r.ID.indexOf("bordercolor")<0&&(this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1):this.setBorder({type:r.ID,color:hexcode,style:this._borderStyle},u),(f.className.indexOf("back")>-1||f.parentNode.className==="e-bordercell")&&n("#"+this._id+"_bordercontainer").hide())},_getTableID:function(n,t){var i,r=this.getSheet(this.getActiveSheetIndex()).tableManager;if(t){for(i in r)if(t===r[i].name)return Number(i)}else for(i in r)if(n.indexOf("e-table"+i)>-1)return Number(i)},_cellStyleClick:function(t){var i=this.model.sheets[this.getActiveSheetIndex()].selectedRange,r=t.target.className,f=this.XLFormat.getFormatClass(r),u={range:i,sheetIndex:this.getActiveSheetIndex(),reqType:"cell-styles",beforeFormat:this.getRangeData({range:i,property:["format","formats"]})};r.indexOf("e-cellstylecell")>-1&&this.XLFormat.updateUniqueFormat(f,i,t.target.innerText);(r.indexOf("e-cellstylecell")>-1||r.indexOf("back")>-1)&&n("#"+this._id+"_Ribbon_Home_Styles_CellStyles").length&&n("#"+this._id+"_Ribbon_Home_Styles_CellStyles").data("ejSplitButton")._hidePopup();u.afterFormat=this.getRangeData({range:i,property:["format","formats"]});this.isUndoRedo||this._completeAction(u);this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()},_mouseHoverHandler:function(t){var i=t.target,r;this._hasClass(t.target,"e-viewhdrlbl")||this._hasClass(t.target,"e-vheading")?this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").addClass("e-chkhover"):this._hasClass(t.target,"e-viewlinlbl")||this._hasClass(t.target,"e-vgridlines")?this.element.find(".e-vgridlines .e-chk-act, .e-vgridlines .e-chk-inact").addClass("e-chkhover"):this.model.allowDragAndDrop&&this.XLDragDrop._allowDragAndDrop&&(n(t.target).parents(".e-vscrollbar").length>0||t.target.className.indexOf("e-rowheader")>-1||n(t.target).parents(".e-spreadsheetfooter").length>0||t.target.className.indexOf("e-headercell")>-1||t.target.className.indexOf("e-spreadsheetfooter")>-1||n(t.target).parents(".e-hscrollbar").length>0||this.getSheet()._isFreezed&&t.target.className.indexOf("e-rowcell")>-1)?this.XLDragDrop._scrollHover(t):this._hasClass(t.target,"e-rowcell")&&(r=this._getCellIdx(i),this._trigger("cellHover",{target:i,event:t,cellIndex:r}))},_mouseDownHandler:function(i){var o,a,y,p,f,s,h,w,b,k,g=!0,nt=!0,v="e-ss-object",c="e-ss-pivot",r=i.target,u=n(r),e=this.getActiveSheetIndex(),d=this.getSheet(e),tt=this.getSheetElement(e),l=n("#"+this._id+"_Ribbon").data("ejRibbon");if(i.currentTarget.className.indexOf("e-ribbon")<0&&this.element.find(".e-bordercontainer").hide(),this.element.find("#"+this._id+"ddl_popup").has(r).length)return!1;if(this._isTouchEvt=this._isTouchEvent(i),this._isTouchEvt&&(this._touchArgs=i,this._startXY=this._setXY(i,navigator.userAgent.indexOf("WebKit")>-1),this.model.allowDragAndDrop&&this.XLDragDrop._dragtouch(this._startXY[0],this._startXY[1]),!this._hasClass(r,"e-autofill")&&this.model.allowAutoFill&&(y=this._hasClass(r,"e-headercell")?10:20,o=this._setXY(i),a=o[1],o=o[0],o=Math.abs(o-this.getAutoFillElem().offset().left),a=Math.abs(a-this.getAutoFillElem().offset().top),o<=y&&o>=0&&a<=y&&a>=0&&(u=this.getAutoFillElem(),r=i.target=u[0]))),u.parents(".e-ribbon").length||u.parents(".e-vscroll").length||u.parents(".e-hscroll").length)this._excelFilter&&(this.XLFilter._isSearchEdit=!1,this._excelFilter.closeXFDialog());else if(this._hasClass(r,"e-ssddl"))this._ddlopen(i);else{if(i.target=this._changeTargetWithOffset(i),this.model.allowCharts&&d._isChartBorderDrawn&&this.XLChart._clearChartRange(this._arrayAsString(this._chartBorder)),(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(u.hasClass(v)||n(u).parents("."+v).length)?(u.hasClass(v)||(r=i.target=n(u).parents("."+v)[0]),this.XLShape._shapeMouseDown(i)):(nt=!1,this.XLShape._shapeROStart&&this.XLShape._shapeRSStart||this._getContent(e).find(".e-ss-activeimg").removeClass("e-ss-activeimg e-ss-imgcresize e-ss-imgrresize")),(r.nodeName==="TD"||r.nodeName==="TH")&&(this.XLRibbon._isPanelVisible=!1),this.model.enablePivotTable&&(this._isPvtNameEdit&&(this._isPvtNameEdit=!1,this.XLPivot._changePvtName()),u.hasClass(c)||u.parents("."+c).length?(u.hasClass(c)||(r=i.target=u.parents("."+c)[0]),this.XLPivot._pivotMouseDown(i)):u.parents(".e-ss-pivotfield").length||u.hasClass("e-ss-pivotfield")||u.hasClass("e-vhandle")||u.hasClass("e-hhandle")||u.css("cursor")==="col-resize"||(this.hideActivationPanel(),this.getSheetElement(e).find(".e-ss-activepivot").removeClass("e-ss-activepivot"))),w=r.className,r.id.indexOf("picture")===-1&&this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("format")||l.isVisible("Format"))&&this.XLRibbon._toggleFormatTab(),this.model.showRibbon&&r.id.indexOf("chart")>-1?this.XLRibbon._chartDesignTabUpdate(n(r)):this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("cdesign")||l.isVisible("Chart Design"))&&this.XLRibbon._toggleChartDesignTab(),this.XLEdit._isEdit&&r.nodeName!="TD"&&!this._hasClass(r,"e-autofill"))return;if(this.model.allowDragAndDrop&&this.XLDragDrop._isDragAndDropStart&&w!=="e-autofill"&&w.indexOf("e-filterspan")<0&&this.XLDragDrop._dMouseDown(i),this.model.allowResizing&&!this.XLEdit._isEdit&&(n(r).hasClass("e-headercelldiv")||n(r).hasClass("e-headercell")?this.XLResize._headerMouseDown(i):n(r).hasClass("e-rowheader")?this.XLResize._rowMouseDown(i):(n(r).hasClass("e-spreadsheetactpanel")||n(r).parents(".e-spreadsheetactpanel").length)&&this.XLResize._apMouseDown(i)),n(r).parents("div.e-spreadsheetactpanel").length>0)return;if(this.model.allowEditing&&this.XLEdit._editElem.html()==="="&&(this._isFormulaSuggestion=!1,this.XLEdit._isFormulaEdit=!0),g=this.XLEdit._isEdit?(this._isFormulaSuggestion||!this.XLEdit._isFormulaEdit)&&this.XLEdit.saveCell():!0,!g&&!this.XLEdit._isFormulaEdit)return!1;this.model.allowComments&&!u.hasClass("e-pager")&&this.getSheetElement(e).find(".e-commentcell").length&&this.XLComment._commentMouseDownHandler(i);r.tagName!=="SPAN"&&r.tagName!=="A"||t.isNullOrUndefined(u.parent("td")[0])?r.tagName==="TD"&&this._hasClass(r,"e-rowcell")?(s=r,f=this._getCellIdx(s),this.model.showRibbon&&this.XLRibbon.updateRibbonIcons()):f=this.getActiveCell():(s=u.parent("td")[0],f=this._getCellIdx(s));r.tagName==="A"?(d._activeCell=f,this.model.allowSelection&&(this.XLSelection.selectRange(f,f),this.XLDragFill.positionAutoFillElement()),i.which!==3&&this._hlClick(this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"hyperlink",e))):(i.button!==2||i.which!==3||this.getSheetElement(e).find(".e-selected, .e-colselected .e-headercelldiv, .e-rowselected").index(r)===-1)&&this.model.allowSelection&&!nt&&(t.isNullOrUndefined(this.XLDragDrop)||!this.XLDragDrop._allowDragAndDrop)&&(this.XLResize&&this.XLResize._resizeStart||u.hasClass("e-comment-txtarea")||u.hasClass(c)||n(u).parents("."+c).length||this.XLSelection._selectionMouseDownHandler(i));this._filterClose(i.target);this._undoInputobj={};r.tagName==="TD"&&n(r).parents("div")[0].className==="e-content"&&this.displayActivationPanel(this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"range"));r.tagName==="TD"&&r.className.indexOf("e-rowheader")<0&&(t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null));r.tagName==="TD"&&this._hasClass(r,"e-rowcell")&&(k=this._getCellIdx(r),t.isNullOrUndefined(this.XLEdit.getPropertyValue(k.rowIndex,k.colIndex,"rule",e))||this._setddlCell(i));this._isTableRename&&(this.XLFormat._renameTable(this._tableClassName),this._isTableRename=!1);this._isSheetRename&&this._updateSheetNames(null,!1);this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup");this._hasClass(r,"e-rowcell")&&(b=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"tableName",e));b?(p=this._getTableID(b),this.isNumber(p)&&this.XLRibbon._designTabUpdate(p,f)):this.model.showRibbon&&(l.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||l.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(f);this.model.allowEditing&&(s=d._activeCell,this.XLEdit._isEdit&&i.target.id!==this._id+"_inputbox"&&(h=n(i.target).hasClass("e-ss-input")||!this.XLEdit._isFBarFocused?this.element.find("#"+this._id+"_Edit"):this._getInputBox(),h&&(i.target.id!==h[0].id&&h.focus().setInputPos(h[0].selectionStart,h[0].selectionEnd),h.hasClass("e-ss-input")&&(this.XLEdit._isFBarFocused=!1))),this.model.allowComments&&this.XLComment._isCommentEdit||this._isSheetRename||i.target.id!==this._id+"_inputbox"||(i.target.readOnly?this.setSheetFocus():(this.XLEdit._isEdit||this.XLEdit.editCell(s.rowIndex,s.colIndex,!0),this._getInputBox().focus(),this.XLEdit._isFBarFocused=!0)))}},_renderDDownList:function(){this.element.append(t.buildTag("input.e-"+this._id+"-ddl","","",{id:this._id+"ddl",style:"display:none"}));n("#"+this._id+"ddl").ejDropDownList({fields:{id:"Types",text:"text",value:"text"},beforePopupShown:n.proxy(this._drppopupshow,this),cssClass:"e-"+this._id+"-ddl e-ss-ddlwrap",width:.1,height:.1,change:n.proxy(this._changeddl,this)});n(document.body).append(n("#"+this._id+"ddl_popup_wrapper"))},_setddlCell:function(i){var v,u=[],h=[],d=[],y,a,f,p,w=this.getActiveSheetIndex(),g,b,e,r,l,o,k,s,c;if((t.isNullOrUndefined(i)||i.type!=="mousedown"?(f=this.getActiveCell(),p=n("#"+this._id+"GroupPanel").find("div.e-content")[0]):(f=this._getCellIdx(i.target),p=i.currentTarget),a=this.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"rule",w),a)&&(y=a.customVal.split("_"),a&&y[1]==="list")){if(this._ddlCell=f,e=y[0],o=[],e.startsWith("=")&&e.indexOf(",")<0){for(u=n.trim(e.replace("=","")),u.indexOf("!")>-1&&(k=u.split("!"),w=this._getSheetIndexByName(k[0]),u=k[1]),u.indexOf("$")>-1&&(u=u.split("$").join("")),u.indexOf(":")<0&&(u=u+":"+u),range=this.getRangeIndices(u),s=this._getMultiRangeCells(range),c=this.getRangeData({range:[s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex],property:["value","value2"],sheetIdx:w}),r=0,l=c.length;r<l;r++)t.isNullOrUndefined(c[r].value)||t.isNullOrUndefined(c[r].value2)?(o.push(""),h.push("")):(o.push(c[r].value),h.push(c[r].value2));o.length||(o.push(e),h.push(e))}else e.indexOf(",")>-1?h=o=e.split(","):(o=[],o.push(e),h.push(e));for(r=0,l=o.length;r<l;r++)d[r]={id:r+1,text:h[r],value:o[r]};f=this.getCell(f.rowIndex,f.colIndex);v={top:f[0].offsetTop,left:f[0].offsetLeft};p.insertAdjacentHTML("beforeEnd","<span id='"+this._id+"ddlspan' class='e-icon e-ssddl e-spanddl e-ddlspan' role='button'><\/span>");b=n("#"+this._id+"ddlspan");g=f.height()-(b.height()+3);b.css({top:v.top+g,left:v.left+f.width()+3});n("#"+this._id+"ddl").ejDropDownList("option","dataSource",d)}},_drppopupshow:function(){if(this._ddlCell){var t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:t.position().top,left:t.position().left})}},_ddlPosition:function(){if(this._ddlCell){var i,t=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex),r={top:t[0].offsetTop,left:t[0].offsetLeft};i=n("#"+this._id+"ddlspan");i.css({top:r.top+t.height()-(i.height()+3),left:r.left+t.width()+3})}},_changeddl:function(n){if(this._ddlCell&&this.model.allowEditing){var t=this.getActiveCell(),i=n.model.dataSource[n.itemId].value,r=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex);this.XLEdit._updateCellValue(t,i);this.getActiveCellElem().hasClass("e-hlcell")&&this.XLValidate.highlightInvalidData();this._trigrDdlActnCmplt(i,r,n.itemId)}},_trigrDdlActnCmplt:function(n,t,i){if(this.model.actionComplete!==null){var e=this.getActiveCell(),s=this.getActiveSheetIndex(),o,f,r,u,h;if(o=this.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"rule",s),f={reqType:"edit",sheetIndex:s,cValue:n,pValue:t,rowIndex:e.rowIndex,colIndex:e.colIndex,hasValidation:!0,rule:o,isRefrsVal:!1},o.type=="list"&&n!==""&&(r=o.customVal.split("_")[0],r[0]=="="&&r.indexOf(",")<0)){if(f.isRefrsVal=!0,r=r.replace("=",""),u=r.split("!"),f.refrValSheetIdx=refrSheetIdx=u.length==1?s:this._getSheetIndexByName(u[0]),refrRange=u.length==1?u[0]:u[1],refrRange.indexOf("$")>-1&&(refrRange=refrRange.replace(/\$/g,"")),range=this.getRangeIndices(refrRange),this.isUndefined(i)){h=this.getRangeData({range:range});for(idx in h)h[idx].value==n&&(i=parseInt(idx))}f.refrValCellAddr=range[0]===range[2]?this.getAlphaRange(range[0],range[1]+i):this.getAlphaRange(range[0]+i,range[1])}this._trigActionComplete(f)}},_ddlopen:function(i){var e=this.getActiveSheetIndex(),u=this.getActiveCell(e),o=this.getSheet(e).rowsHeightCollection[u.rowIndex],r,s,f;if(this.XLEdit._isEdit&&this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"rule").customVal.split("_")[2]==="true")return!1;this.XLEdit.saveCell();r=n("#"+this._id+"ddl").data("ejDropDownList");s=this.getCell(this._ddlCell.rowIndex,this._ddlCell.colIndex);i.stopPropagation();t.isNullOrUndefined(r)||(r._isPopupShown()?r._hideResult():(r._showResult(),n("#"+this._id+"ddl_popup").css({width:this.getActiveCellElem().width()+20,"font-size":"11",top:20,left:100}),f=this._getXYPos(s,n("#"+this._id+"ddl_popup"),o,0),n("#"+this._id+"ddl_popup_list_wrapper").css({top:f.yPos+o,left:f.xPos})))},_mouseMoveHandler:function(i){i.target=this._changeTargetWithOffset(i);var r=n(i.target),u,f;this._isTouchEvt=this._isTouchEvent(i);this._isTouchEvt&&(i.preventDefault(),u=this._setXY(i,navigator.userAgent.indexOf("WebKit")>-1),this.model.allowDragAndDrop&&this.XLDragDrop._dragtouch(u[0],u[1]));!this.model.allowResizing||!(this.XLResize._resizeType==="Col"||r.hasClass("e-headercelldiv")||r.hasClass("e-headercell")||r.hasClass("e-reSizeColbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?!this.model.allowResizing||!(this.XLResize._resizeType==="Row"||r.hasClass("e-rowheader")||r.hasClass("e-reSizeRowbg"))||this.XLEdit._isEdit||this.XLCMenu&&this.XLCMenu._isMenuOpened?this.model.allowResizing&&(this.XLResize._resizeType==="AP"||r.hasClass("e-spreadsheetactpanel")||r.parents(".e-spreadsheetactpanel").length>0)?this.XLResize._apMouseMove(i):(this.model.pictureSettings.allowPictures||this.model.allowCharts)&&(r.hasClass("e-ss-object")||r.parents(".e-ss-object").length||this.XLShape._shapeROStart||this.XLShape._shapeRSStart||r.hasClass("e-ss-imgvisual"))&&this.XLShape._imgMouseMove(i):this.XLResize._rMouseMove(i):this.XLResize._cMouseMove(i);this.model.allowSelection&&this.model.allowDragAndDrop&&t.spreadsheetFeatures.dragAndDrop&&r.parents(".e-spreadsheetmainpanel").length&&r.hasClass("e-rowcell")&&!this.XLEdit._isEdit&&this._getJSSheetHeader(this.getActiveSheetIndex())[0].querySelector(".e-spreadsheetcolumnheader").className.indexOf("e-sheetselected")===-1&&this.XLDragDrop._dMouseMove(i);this.model.allowComments&&!this.XLComment._isCommentEdit&&this.getSheetElement(this.getActiveSheetIndex()).find(".e-commentcell").length>0&&this.XLComment._commentMouseMove(i);t.isNullOrUndefined(i.target.parentNode)||i.target.id.indexOf("_svg")<0&&i.target.parentNode.className.indexOf("e-content")<0&&!n(i.target).is("td.e-rowcell")&&this.XLShape._shapeMouseUp(i);this._isTouchEvt&&!this._isSelected(i.target)&&!this._isTouchMoveSel&&this._touchArgs&&!this._isUniqueTarget(this._touchArgs,i)&&r.parents(".e-table").length&&r.parents(".e-spreadsheetcontentcontainer").length&&!this.XLDragDrop._allowDragAndDrop&&(f=this._getClientDiff(this._startXY,u),this._scrollContent(f),this._startXY=u,this._touchArgs=i,this._isTouchScroll=!0)},_mouseLeaveHandler:function(t){this._hasClass(t.target,"e-viewhdrlbl")||this._hasClass(t.target,"e-vheading")?this.element.find(".e-vheading .e-chk-act, .e-vheading .e-chk-inact").removeClass("e-chkhover"):this._hasClass(t.target,"e-viewlinlbl")||this._hasClass(t.target,"e-vgridlines")?this.element.find(".e-vgridlines .e-chk-act,.e-vgridlines .e-chk-inact").removeClass("e-chkhover"):this.model.allowResizing&&n(".e-ss-colresize, .e-ss-rowresize").removeClass("e-ss-colresize e-ss-rowresize")},_mouseUpHandler:function(t){var i=n(t.target),u=this.getActiveSheetIndex(),r=this.XLScroll._vScroller(u),f=this.XLScroll._hScroller(u);if(this.model.allowResizing&&(this.XLResize._resizeType==="Col"?this.XLResize._cMouseUp(t):this.XLResize._resizeType==="Row"?this.XLResize._rMouseUp(t):this.XLResize._resizeType==="AP"&&this.XLResize._apMouseUp(t)),this.model.showRibbon&&!this._phoneMode&&this.element.find(".e-ribbonpin").is(":visible")&&n(t.target).parents(".e-ribbon").length<=0&&n("#"+this._id+"_Ribbon").ejRibbon("collapse"),this.model.allowDragAndDrop&&this.XLDragDrop._allowDragAndDrop&&this.XLDragDrop._dMouseUp(t),this.model.allowComments&&this.XLComment._isCommentEdit&&this.getActiveCellElem().find("textarea").focus(),this._isSheetRename&&n("#"+this._id+"_Sheet_RenamePanel").focus(),this.model.pictureSettings.allowPictures&&this.XLShape._shapeMouseUp(t),this.model.enablePivotTable&&this.XLPivot._pivotMouseUp(t),this.XLEdit._isEdit&&i[0].id!==this.XLEdit._editElem[0].id&&this.XLEdit._editElem.setCursorPosition(this._browserDetails.version==="8.0"?document.selection.anchorOffset:window.getSelection().anchorOffset),this._hasClass(i[0],"e-vhandle")||this._hasClass(i[0],"e-vhandlespace")||this._hasClass(i[0],"e-vup")||this._hasClass(i[0],"e-vdown")){this._trigger("scrollStop",{scrollData:r._scrollData,position:r.model.value,reqType:"vertical"});return}if(this._hasClass(i[0],"e-hhandle")||this._hasClass(i[0],"e-hhandlespace")||this._hasClass(i[0],"e-hdown")||this._hasClass(i[0],"e-hup")){this._trigger("scrollStop",{scrollData:r._scrollData,position:f.model.value,reqType:"horizontal"});return}},_scrollContent:function(n,i){var r,u,e=this.getActiveSheetIndex(),f=this.getSheet(e);n.x&&(r=i?n.x:f._scrollLeft+n.x,u=this.XLScroll._hScroller(e),r<0?r=0:this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal?n.x>0&&u.model.maximum<r+u._scrollData.handle&&(r=u.model.maximum):u._scrollData.step=n.x<0?-1:1,f._scrollLeft!=r&&u.scroll(r));n.y&&(r=i?n.y:f._scrollTop+n.y,u=this.XLScroll._vScroller(e),r<0?r=0:this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&(u._scrollData.step=n.y<0?-1:1),(r||f._scrollTop!=r)&&u.scroll(r))},_keyDownHandler:function(i){var s,e,h,c,o,a=!0,l=!1,f=this.getActiveSheetIndex(),r=this.element.find("#"+this._id+"_AutoComplete").data("ejAutocomplete"),v=n("#"+this._id+"_Ribbon").data("ejRibbon"),u=this.getSheet(f)._activeCell;if(!this._trigger("keyDown",{event:i,isEdit:this.model.allowEditing&&this.XLEdit._isEdit,isCommentEdit:this.model.allowComments&&this.XLComment._isCommentEdit,isSheetRename:this._isSheetRename,sheetIndex:this._getSheetIndex()})){if(this._getContent(f).find(".e-ss-activeimg").length&&(n(i.target).hasClass("e-numerictextbox")&&i.keyCode===13&&i.preventDefault(),l=!0,c=document.activeElement.id,c.indexOf(this._id+"_Ribbon_Format_Size_PictureHeight")<0&&c.indexOf(this._id+"_Ribbon_Format_Size_PictureWidth")<0&&this.XLShape._imgKeyDown(i)),navigator.platform.toLowerCase().indexOf("mac")>-1&&i.metaKey){i.keyCode==67?this.XLClipboard.copy():i.keyCode==86?this.XLClipboard.paste():i.keyCode==88&&this.XLClipboard.cut();return}if(r.showSuggestionBox&&r.suggestionList){if(i.keyCode===38){r._removeListHover();r._activeItem=r._activeItem>1?r._activeItem-1:r._listSize;r._addListHover();r._targetFocus();return}if(i.keyCode===40){r._removeListHover();r._activeItem=r._activeItem<r._listSize?r._activeItem+1:1;r._addListHover();return}}if(i.target.id.indexOf("_Edit")>-1&&this.model.allowKeyboardNavigation&&(this.XLCellNav._canKeyBoardNavigate=!0),this.XLEdit._editElem&&(o=this.XLEdit._editElem.text()),i.target.id.indexOf("_Edit")>-1&&i.keyCode===9&&o.indexOf("=")===0&&o.indexOf(")")!=o.length-1){if(i.preventDefault(),!r.suggestionList.is(":visible")&&this.model.allowKeyboardNavigation){this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13&&!i.altKey)&&this.XLEdit.saveCell();this.XLCellNav._selectionKeyDownHandler(i);u=this.getSheet(f)._activeCell;return}e=r.getActiveText();this.XLEdit._isNamedRange(e)||(e+="(");this.XLEdit._editElem.text(e);this.model.allowFormulaBar&&this._getInputBox().val(e);i.target.id.indexOf("_Edit")>-1&&this.XLEdit._editElem.focusEnd();this.XLCellNav._canKeyBoardNavigate=!1;return}if(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"wrap")&&this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"merge")&&i.keyCode===46&&(this.getCell(u.rowIndex,u.colIndex,f).find("#"+this._id+"_MergeWrap")[0].textContent=""),i.target.id.indexOf("_Custom")<0&&i.target.id.indexOf("_Ribbon")<0){if((i.stopImmediatePropagation(),this.model.allowFiltering&&this.XLFilter._isSearchEdit&&i.keyCode!==27)||(n(i.target).parents(".e-formulabar").length&&this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=i.keyCode===13),this._isSheetRename||this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||!this.model.allowClipboard||this.XLClipboard._copyPasteHandler(i),l||this._isSheetRename||((this.XLComment&&this.XLComment._isCommentEdit)?this.model.allowKeyboardNavigation&&(this.XLCellNav._isNavigate=!1):this.model.allowEditing&&(document.activeElement.id.indexOf("_inputbox")===-1||i.keyCode===27)&&this.XLEdit._editingHandler(i)),this._isFormulaSuggestion&&(i.keyCode===39||i.keyCode===37||i.keyCode===13&&!i.altKey)?this.XLEdit.saveCell():this.XLEdit._isFormulaEdit||i.keyCode!==9&&(i.keyCode!==13||i.altKey)&&i.keyCode!==37&&i.keyCode!==38&&i.keyCode!==39&&i.keyCode!==40||(a=this.XLEdit._isEdit&&this.model.allowKeyboardNavigation&&this.XLCellNav._isNavigate?this.XLEdit.saveCell():!0),n(i.target).hasClass("e-field-validation-error")||i.target.id==this._id+"_Ribbon_Home_Font_FontFamily_wrapper"||i.target.id==this._id+"_Ribbon_Home_Number_NumberFormat_wrapper"||i.target.id==this._id+"_Ribbon_Home_Font_FontSize_wrapper"))return!0;if(this.model.allowDataValidation&&this.XLValidate._isErrorVisible&&(i.keyCode===37||i.keyCode===39||i.keyCode===38||i.keyCode===40))return this.XLValidate._isErrorVisible=!1,!0;if(!a&&!this.XLEdit._isFormulaEdit||i.keyCode===13&&i.altKey)return!1;!this.model.allowKeyboardNavigation||l||this._isSheetRename||(this.model.allowComments&&this.XLComment._isCommentEdit||n(i.target).parents(".e-formulabar").length&&i.keyCode!==9&&(i.keyCode!==13||i.altKey)||this.XLCellNav._selectionKeyDownHandler(i),u=this.getSheet(f)._activeCell,this._keyboardShortCuts(i));this.model.allowUndoRedo&&(this.model.allowComments&&!this.XLComment._isCommentEdit?this._undoRedoOperation(i):this.model.allowComments||this._undoRedoOperation(i));this.XLEdit._isFormulaEdit&&i.keyCode===9&&!this.XLCellNav._canKeyBoardNavigate&&(this.XLCellNav._canKeyBoardNavigate=!0)}if(i.target.id===this._id+"_Ribbon_Analyze_PivotTable_PivotTableName")return this._isPvtNameEdit=!0,!0;if(this._isPvtNameEdit&&(this._isPvtNameEdit=!1,this.XLPivot._changePvtName()),i.target.tagName!=="DIV"||this.XLEdit._isEdit||t.isNullOrUndefined(this._ddlCell)||(this.element.find("#"+this._id+"ddl").ejDropDownList("hidePopup"),this.element.find("#"+this._id+"ddlspan").remove(),this._ddlCell=null),h=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"tableName",f),i.target.id===this._id+"_Ribbon_Design_Properties_TableName")if(this._isTableRename=!0,this._tableClassName=this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"tableName")||"",this._isTableRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27))i.keyCode===13&&i.preventDefault(),this.XLFormat._renameTable(this._tableClassName);else return;h&&this._getContent(f).find(".e-ss-activeimg").length===0?(s=this._getTableID(h),this.isNumber(s)&&this.XLRibbon._designTabUpdate(s,u)):this.model.showRibbon&&(v.model.selectedItemIndex===this.XLRibbon._getTabIndex("design")||v.isVisible(this._getLocStr("Design")))&&this.XLRibbon._toggleDesignTab(u);this.XLEdit._isEdit||t.isNullOrUndefined(this.XLEdit.getPropertyValue(u.rowIndex,u.colIndex,"rule",f))||this._setddlCell(i);this._isSheetRename&&(i.keyCode===13||i.keyCode===9||i.keyCode===27)&&(i.preventDefault(),this._updateSheetNames(null,i.keyCode===27)&&this.setSheetFocus());r.suggestionList.is(":visible")&&(this.XLEdit._editElem.text()===""||i.keyCode===13)&&r._hideResult();this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}},_keyUpHandler:function(n){var t=this.element.find("#"+this._id+"_Edit").text();this.model.allowEditing&&this.XLEdit._isEdit&&t.indexOf("=")>-1&&t.length>0&&t.indexOf(")")==-1&&(this.XLEdit._isFEdit||(this.XLCellNav._isNavigate=!0),n.keyCode!==40&&n.keyCode!==38&&t.length>1&&this.XLEdit._captureEditing(n));this._trigger("keyUp",{event:n,isEdit:this.model.allowEditing&&this.XLEdit._isEdit,isCommentEdit:this.model.allowComments&&this.XLComment._isCommentEdit,isSheetRename:this._isSheetRename,sheetIndex:this._getSheetIndex()})},_dblClickHandler:function(t){var i,e,r,u,f;if(this.XLEdit._isFEdit=!1,t.target.tagName!=="A")if(this._hasClass(t.target,"e-numericitem")){if(this.XLEdit&&this.XLEdit._isEdit&&this.getActiveCellElem().find(".e-error").length)return;this._isSheetRename||this._renameSheet()}else{if(t.target.id.indexOf("chart")>-1||this._hasClass(t.target,"e-comment-txtarea")||this._hasClass(t.target,"e-filterspan")||n(t.target).parents(".e-ss-pivot").length)return;if(u=this.getActiveSheetIndex(),f=this.getSheet(u),t.target=this._changeTargetWithOffset(t),!this.model.allowEditing||!this.model.allowSelection)return;if(this.XLSelection._isOutsideBordering||this.XLSelection._isGridBordering){i=this._getContent(u).find("div:first-child");i.addClass("e-ss-cursor");i.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor");this.XLSelection.selectRange(f._startCell,f._endCell);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this.XLSelection._isOutsideBordering=this.XLSelection._isGridBordering=!1;return}if(!this.XLEdit._isEdit&&(n(t.target).hasClass("e-rowcell")||n(t.target).parents("td").hasClass("e-rowcell"))&&!this._hasClass(n(t.target),"e-readonly")&&!n(t.target).hasClass("e-cellreadonly")){if(this._isTouchEvt&&t.preventDefault(),n(".e-cdata").length&&n(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),e=n(t.target),e.closest("#"+this._id+"EditForm").length)return;r=t.target.id.length<1?this._getCellIdx(t.target):this._getCellIdx(n(t.target).parents("td")[0]);this.XLEdit.editCell(r.rowIndex,r.colIndex,!0)}this.model.allowResizing&&(n(t.target).hasClass("e-headercell")||n(t.target).hasClass("e-headercelldiv"))&&this.XLResize._resizeToFitWidth(t);n(t.target).is("span")&&this.model.allowResizing&&this._hasClass(n(t.target.parentNode)[0],"e-ss-rowresize")?this.XLResize._resizeToFitHeight(t.target.parentNode):this.model.allowResizing&&n(t.target).hasClass("e-ss-rowresize")&&this.XLResize._resizeToFitHeight(t)}},_setAndSelectActiveCell:function(n,t,i){this.setActiveCell(n,t);this._selectActiveCell(n,t,"",i)},_selectActiveCell:function(n,t,i,r){var u=this.getActiveSheetIndex(),f=i?{rowIndex:i.rowIndex,colIndex:i.colIndex}:{rowIndex:n,colIndex:t};this.model.allowSelection&&this.model.allowKeyboardNavigation&&this.model.scrollSettings.allowScrolling&&(this.XLSelection.selectRange(this._getAlphaRange(u,n,t,f.rowIndex,f.colIndex)),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),r||(this.XLCellNav._scrollReverse=!0,this.XLScroll._scrollSelectedPosition(u,i?{rowIndex:0,colIndex:0}:this.getActiveCell(u)),this.XLCellNav._scrollReverse=!1),this.XLScroll._getFirstColumn(u))},_pageUpDown:function(n){if(!this._isAutoWHMode){var s=this.getActiveCell(),r,u,f,e,o,h=this.getActiveSheetIndex(),i=this.getSheet(h);(f=i._rowHeightCollection[s.rowIndex],(i.rowCount-1!==i._bottomRow.idx||n!==1)&&(i._topRow.idx!==0||n!==-1))&&(e=i._bottomRow.value+i.rowsHeightCollection[i._bottomRow.idx],o=n*(e-i._topRow.value),r=f+o>0?f+o:0,n===1&&this.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&i._bottomRow.value+this.model.rowHeight+i._vPortHgt>=i._rowHeightCollection[i._rowHeightCollection.length-1]?r=i._rowHeightCollection[i._rowHeightCollection.length-1]:this._scrollContent({y:n*(e-i._scrollTop)}),u=this._getIdxWithOffset(r,i._colWidthCollection[s.colIndex],!0),this._setAndSelectActiveCell(u.rowIdx,u.colIdx,!0))}},_keyboardShortCuts:function(i){var v,p,c,y,w,a;if(this.model.allowEditing&&this.XLEdit._isEdit||this.model.allowComments&&this.XLComment._isCommentEdit&&i.keyCode!==27)return!1;var h,s,e,o=this.XLFormat,l=this.getActiveSheetIndex(),u=this.getSheet(l),f=u._selectedCells,r=!1;if(this.model.allowLockCell&&u.isSheetProtected&&(r=!0),!i.ctrlKey&&!i.shiftKey)switch(i.keyCode){case 33:i.preventDefault();this._pageUpDown(-1);break;case 34:i.preventDefault();this._pageUpDown(1);break;case 36:i.preventDefault();this._setAndSelectActiveCell(this.getActiveCell(l).rowIndex,this._isFrozen(u.frozenColumns)?u._frozenColumns-1:0)}if(i.ctrlKey&&!i.shiftKey){if(!this.element.find("#"+this._id+"_Ribbon .e-ribbonbackstagepage").is(":visible"))switch(i.keyCode){case 65:i.preventDefault();this.model.allowSelection&&(h=this.getActiveCellElem(),this.selectAll(),t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(n(h[0]).closest("tr").index(),h[0].cellIndex,{keyCode:i.keyCode}),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement());break;case 66:i.preventDefault();r||this._toggleFontPrpty("bold");break;case 68:case 82:i.preventDefault();this.model.allowAutoFill&&this.XLDragFill._fillRange(i.keyCode===68);break;case 73:i.preventDefault();r||this._toggleFontPrpty("italic");break;case 75:i.preventDefault();this.model.allowHyperlink&&!r&&this._showDialog(this._id+"_Ribbon_Insert_Links_Hyperlink");break;case 85:i.preventDefault();r||this._toggleFontPrpty("underline");break;case 32:if(i.preventDefault(),!this.model.allowSelection)return;v=f[0].colIndex;p=f[f.length-1].colIndex;s={rowIndex:0,colIndex:v};e={rowIndex:u.rowCount-1,colIndex:p};this.model.allowSelection&&this.XLSelection.selectRange(s,e);u._startCell=s;u._endCell=e;u._isColSelected=!0;t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(f[0].rowIndex,v);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();break;case 35:i.preventDefault();e=this._getUsedRangeFromSheet(l).endCell;this._setAndSelectActiveCell(e.rowIndex,e.colIndex);break;case 36:i.preventDefault();this._setAndSelectActiveCell(this._isFrozen(u.frozenRows)?u._frozenRows-1:0,this._isFrozen(u.frozenColumns)?u._frozenColumns-1:0);break;case 49:i.preventDefault();this._showDialog(this._id+"_FormatCells");break;case 53:i.preventDefault();r||this._toggleFontPrpty("line-through");break;case 56:i.shiftKey||r||(i.preventDefault(),this._hideColumn(u._startCell.colIndex,u._endCell.colIndex));break;case 57:i.shiftKey||(i.preventDefault(),r||this._hideRow(u._startCell.rowIndex,u._endCell.rowIndex,"isRHide"));break;case 220:i.shiftKey||(i.preventDefault(),this.model.allowSearching&&this.XLSearch._applyGotoRowDiff());break;case 90:i.preventDefault();break;case 89:i.preventDefault();break;case 114:i.preventDefault();this.model.showRibbon&&!r&&this.XLRibbon._openNameManagerDlg();break;case 70:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");n("#"+this._id+"_FRDialog").ejDialog("open");this.XLRibbon._refreshFRDlg();n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",0);break;case 71:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");this.XLRibbon._refreshGoDlg();n("#"+this._id+"_GoDialog").ejDialog("open");n("#"+this._id+"_GoToDlgTab").ejTab("option","selectedItemIndex",0);break;case 72:i.preventDefault();this._showDialog(this._id+"_Ribbon_Others_Editing_FindSelect");n("#"+this._id+"_FRDialog").ejDialog("open");this.XLRibbon._refreshFRDlg();n("#"+this._id+"_FRDialog_FPDlgTab").ejTab("option","selectedItemIndex",1)}switch(i.keyCode){case 80:i.preventDefault();this.XLPrint.printSheet();break;case 79:i.preventDefault();this.model.allowImport&&(this.isDirty?this._showAlertDlg("","ImportAlert","Open",470,135):n("#"+this._id+"_file .e-uploadinput").click());break;case 83:i.preventDefault();this.XLExport["export"]("Excel")}}if(i.ctrlKey&&i.shiftKey){if(!this.element.find("#"+this._id+"_Ribbon .e-ribbonbackstagepage").is(":visible"))switch(i.keyCode){case 192:i.preventDefault();r||o.format({type:"general"});break;case 52:i.preventDefault();r||o.format({type:"currency"});break;case 53:i.preventDefault();r||o.format({type:"percentage"});break;case 54:i.preventDefault();r||o.format({type:"scientific"});break;case 51:i.preventDefault();r||o.format({type:"shortdate"});break;case 50:i.preventDefault();r||o.format({type:"time"});break;case 49:i.preventDefault();r||o.format({type:"number"});break;case 55:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder({top:"1px solid #000000",right:"1px solid #000000",bottom:"1px solid #000000",left:"1px solid #000000"});break;case 189:i.preventDefault();this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder&&!r&&this.XLFormat.applyBorder("noborder");break;case 73:i.preventDefault();this.model.allowInsert&&!r&&this._showDialog(this._id+"_Ribbon_Others_Cells_InsertCellOptions");break;case 68:i.preventDefault();this.model.allowDelete&&!r&&this._showDialog(this._id+"_Ribbon_Others_Cells_DeleteCellOptions");break;case 113:i.preventDefault();c=n("#"+this._id+"_Ribbon").data("ejRibbon");this.model.showRibbon&&(c._isCollapsed?(c.expand(),c._removeRibbonPin()):c.collapse());break;case 56:i.preventDefault();!r&&this.model.allowSelection&&this._showColumn(f[0].colIndex,f[f.length-1].colIndex);break;case 57:i.preventDefault();!r&&this.model.allowSelection&&this._showRow(f[0].rowIndex,f[f.length-1].rowIndex,"isRHide");break;case 79:i.preventDefault();this.XLSearch._applyGotoComments();break;case 220:i.preventDefault();this.XLSearch._applyGotoColDiff();break;case 36:i.preventDefault();e=this.getActiveCell(l);this._selectActiveCell(0,0,e)}}else if(i.shiftKey)i.keyCode===32?(i.preventDefault(),this.model.allowSelection&&(y=f[0].rowIndex,w=f[f.length-1].rowIndex,s={rowIndex:y,colIndex:0},e={rowIndex:w,colIndex:u.colCount-1},this.XLSelection.selectRange(s,e),u._startCell=s,u._endCell=e,u._isRowSelected=!0,t.isNullOrUndefined(this.XLCellNav)||this.XLCellNav._updateActiveCell(y,f[0].colIndex),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())):i.keyCode===113?(this._dupDetails=!0,i.preventDefault(),h=this.getActiveCellElem(),this.model.allowComments&&!r&&(this._isRibbonClick=!0,h.hasClass("e-commentcell")?this.XLComment.editComment():this.XLComment.setComment(),this._isRibbonClick=!1),this._dupDetails=!1):i.keyCode===122&&(i.preventDefault(),this.addNewSheet());else if(i.keyCode===27){if(this.model.allowComments&&this.XLComment._isCommentEdit&&(this.XLComment._updateCurCmntVal(),this.XLComment._updateCmntRibIcons()),this.model.allowContextMenu&&(this.XLCMenu._isMenuOpened||n("#"+this._id+"_contextMenuColumnHeader").is(":visible")||n("#"+this._id+"_contextMenuRowHeader").is(":visible"))&&this.XLCMenu.hideCMenu(),this.model.allowFiltering&&this._excelFilter&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")){if(a=this._excelFilter._menuWrap.data("ejMenu"),a.element.find(".e-mhover li:visible").length){a._isContextMenuOpen||a._closeMenu();return}this.XLFilter._isSearchEdit=!1;this._excelFilter.closeXFDialog()}this.setSheetFocus()}else i.altKey&&(i.keyCode===112&&this.model.showRibbon&&this.model.allowCharts&&!r?(i.preventDefault(),this.XLChart.createChart(null,{type:"column",enable3D:!1,marker:{visible:!1}})):i.keyCode===84&&this.model.showRibbon&&!this.XLRibbon._isDirtySelect&&!r&&this.model.allowFormatAsTable&&(this._showDialog(this._id+"_Ribbon_Insert_Tables_Table"),i.preventDefault(),this.XLRibbon._openFATDlg()))},_triggerTBtnClick:function(t){var i=n("#"+t).data("ejToggleButton");i.buttontag.click()},_toggleFontPrpty:function(n){var e=this.getActiveCell(),o=this.XLFormat,u={style:{}},f,t,i,r;f=this.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"format");i=!this.isUndefined(f)&&this.XLFormat.getFormatFromHashCode(f);t=n==="bold"?"font-weight":n==="italic"?"font-style":"text-decoration";r=n.charAt(0).toUpperCase()+n.slice(1).toLowerCase();r==="Line-through"&&(r="StrikeThrough");i[t]===n?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!1),u.style[t]="none"):t==="text-decoration"&&(i[t]==="underline"||i[t]==="line-through")?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!0),u.style[t]=i[t]==="underline"?n+" "+i[t]:i[t]+" "+n):t==="text-decoration"&&(i[t]==="line-through underline"||i[t]==="underline line-through")?(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!1),i[t]=i[t].split(" ").join(""),u.style[t]=i[t].replace(n,"")):(this.model.showRibbon&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).length&&this.element.find("#"+this._id+"_Ribbon_Home_Font_"+r).ejToggleButton("option","toggleState",!0),u.style[t]=n);o.format(u)},_getLocStr:function(n){return this.localizedLabels[n]},_checkIndicesInContainer:function(n,t,i,r){var u=this._dataContainer.sheets;return n in u&&t in u[n]&&i in u[n][t]?r?r in u[n][t][i]?!0:!1:!0:!1},_textFormatting:function(t){switch(t){case"wrapText":var i=n("#"+this._id+"_Ribbon_Home_Alignment_WrapText").data("ejToggleButton");i&&this.setWrapText(i.model.toggleState?"wrap":"unwrap",null)}},wrapText:function(n){this.model.allowWrap&&!this.model.isReadOnly&&this.setWrapText("wrap",n)},unWrapText:function(n){this.model.allowWrap&&!this.model.isReadOnly&&this.setWrapText("unwrap",n)},setWrapText:function(n,i){var u,nt,tt;if(this.model.allowWrap&&!this.model.isReadOnly){var r,a,f,e=this.getActiveSheetIndex(),v,s,w,o=this.getSheet(e),h=0,y,c=this.model.rowHeight,p,d=this.getRows(e),ot=d[1],it=d[0],g,b=o.rowsHeightCollection,st=o.columnsWidthCollection,c=0,k=o._wrapHtCollection,l=!1,rt,ut=this.model.scrollSettings.allowVirtualScrolling,ft=o._clrWrapColl,et;if(a=this._getRangeArgs(i,"object"),r=this._getSelectedCells(e,a).selCells,r.length!==0){for(g=r.length>1?this._getProperAlphaRange(e,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex):this._getAlphaRange(e,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex),u=0,nt=r.length;u<nt;u++)if(rt=ut?this._getRowIdx(r[u].rowIndex):r[u].rowIndex,et=r[r.length-1],l=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"wrap"),this._isPaste||(n!=="unwrap"||l)&&(n!=="wrap"||!l)){if(n==="unwrap"&&l)this._isUndoRedo||ft.push({rowIdx:r[u].rowIndex,colIdx:r[u].colIndex}),this._isRowViewable(e,r[u].rowIndex)&&(f=this.getCell(r[u].rowIndex,r[u].colIndex),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge")&&!this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"cellType")&&(v=f.find("#"+this._id+"_MergeWrap"),v.length&&(f[0].innerHTML=v[0].innerHTML,v.remove())),s=r[u].rowIndex,w=r[u].colIndex,f&&this._removeClass(f[0],"e-sswraptext"),this._removeClass(it[s],"e-sswraprow"),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"altTxt")&&this.addClass(f[0],"e-alt-unwrap"),s in o._wrapColl&&w in o._wrapColl[s]&&(delete o._wrapColl[s][w],y=t.max(this._getObjectValues(o._wrapColl[s])),this._fRowHtColl[s]&&y<this._fRowHtColl[s]&&(y=this._fRowHtColl[s]),this.getObjectLength(o._wrapColl[s])||delete o._wrapColl[s]),f.find(".e-filterspan").length>0&&(p=f.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(f,p))),this.XLEdit._clearDataContainer({cellIdx:r[u],property:["wrap"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:0},property:["wrapRow"]}),this.XLEdit._clearDataContainer({cellIdx:{rowIndex:0,colIndex:r[u].colIndex},property:["wrapCol","wrapWidth"]}),h=this._getWrapCellHeight(e,r[u].rowIndex,r[u].colIndex,y),this._textClip(r[u].rowIndex,r[u].colIndex,"add");else if(n==="wrap"&&!l){if(this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"isFilterHeader"))continue;this._textClip(r[u].rowIndex,r[u].colIndex,"delete");this._wrapCollection(r[u].rowIndex,r[u].colIndex,b[r[u].rowIndex],e);this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},{dataObj:{wrap:!0}});this._isRowViewable(e,r[u].rowIndex)&&(f=this.getCell(r[u].rowIndex,r[u].colIndex),f.is(":visible")&&this.model.allowResizing&&!this.XLResize._preventRowResize(r[u].rowIndex)&&(this.addClass(f[0],"e-sswraptext"),this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"altTxt")&&this._removeClass(f[0],"e-alt-unwrap"),f.find(".e-filterspan").length>0&&(p=f.find(".e-filterspan"),this.model.allowFiltering&&this.XLFilter._postionFilterIcon(f,p))));h=this._getWrapCellHeight(e,r[u].rowIndex,r[u].colIndex);h.rowHt<c&&(h.rowHt=c);c=h.rowHt;this._wrapCollection(r[u].rowIndex,r[u].colIndex,h.cellHt,e);this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},{dataObj:{wrap:!0}});k[r[u].rowIndex]=u>0&&r[u].rowIndex===r[u-1].rowIndex?k[r[u-1].rowIndex]:k[r[u].rowIndex]=b[r[u].rowIndex];t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapRow"))&&this.XLEdit._updateDataContainer({rowIndex:r[u].rowIndex,colIndex:0},{dataObj:{wrapRow:!0}});t.isNullOrUndefined(this.XLEdit.getPropertyValue(r[u].rowIndex,0,"wrapCol"))&&this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r[u].colIndex},{dataObj:{wrapCol:!0,wrapWidth:this.getSheet(e).columnsWidthCollection[r[u].colIndex]}})}h.rowHt>0&&(n==="unwrap"||n==="wrap"&&h.rowHt>b[r[u].rowIndex])&&(r[u].colIndex===a[3]||this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge"))&&(this.setHeightToRows([{rowIndex:r[u].rowIndex,height:h.rowHt}]),c=0,this.model.allowFreezing&&this.XLFreeze._refreshFRowResize(r[u].rowIndex));r[u].colIndex===a[3]&&(c=0);h=0}this.model.allowComments&&this.XLComment._updateCmntArrowPos();this.model.scrollSettings.allowScrolling&&this.XLScroll._getRowHeights(e,r[0].rowIndex+1);(!o._isImported||o._isLoaded)&&(tt={sheetIndex:e,selectedCell:r,reqType:"textwrap",operation:n,range:g},this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(e,"refresh","all"),this.model.allowSelection&&this.XLSelection._refreshBorder(),this._isUndoRedo||this._dupDetails||this._completeAction(tt))}}},_getWrapCellHeight:function(n,t,i,r){var u,e,f=0,s=0,o,h=this.getSheet(n),c=h.rowsHeightCollection,l=h.columnsWidthCollection;if(e=this.XLEdit.getPropertyValue(t,i,"merge"),f=c[t],s=l[i],e){for(u=t+1;u<t+e.mSpan.rowSpan;u++)f=f+c[u];for(u=i+1;u<i+e.mSpan.colSpan;u++)s=s+l[u]}return o=r?r:this._detailsFromGlobalSpan(t,i,"height",this.XLEdit.getPropertyValue(t,i,"value"),s),f=e?f<o?this._getRowHeight(t,n)+(Math.ceil(o)-f):this._getRowHeight(t,n):o,{cellHt:o,rowHt:f}},_wrapCollection:function(n,t,i,r){var u=this.getSheet(r?r:this.getActiveSheetIndex());u._wrapColl[n]||(u._wrapColl[n]={});this.getObjectLength(u._wrapColl[n])>-1&&(u._wrapColl[n][t]=i)},_setWrapHeight:function(t,i,r,u,f,e){var o,h,c=r[i],s=this.getSheet(t),l=s.rowsHeightCollection;l[i]>0?o=l[i]:(s.hideRowsCollection.indexOf(i)===-1||e==="visible")&&(h=n(r[i].outerHTML).attr("id","ss"),f[0].insertBefore(h[0],f[0].childNodes[0]),o=f[0].rows[0].getBoundingClientRect().height,f[0].rows[0].parentNode.removeChild(f[0].rows[0]));o=o<20?20:o;parseInt(c.style.height)<o&&(c.style.height=o+"px",n(u[i])[0].style.height=o+"px",s.rowsHeightCollection[i]=o)},_setRowHdrHeight:function(n,t){var u=this._getRowIdx(t),r,i=this.getSheet(n),f=this.getRows(n),e=i.rowsHeightCollection[t];this._isRowViewable(n,t)&&(f[0][u].style.height=e+"px");this.model.allowSelection&&(r=this._intrnlReq,this._intrnlReq=!0,this.XLSelection.refreshSelection(),this._intrnlReq=r);(!i._isImported||i._isLoaded)&&this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_refreshRangeTRHght:function(n,t){for(var r=t[0]<1?t[0]:t[0]-1,u=this.getSheet(n),i=r;i<=t[2];i++)this._setRowHdrHeight(n,i);this.XLScroll._getRowHeights(n,r);(!u._isImported||u._isLoaded)&&this.model.allowSelection&&this.XLSelection._refreshBorder()},_renderAlertdlg:function(){var u,f,e,o,s,r,h="<div class='e-dlg-btnctnr' id=",i=this._id+"_alertdlg",c={text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertOkClick,this),enabled:!0};document.getElementById(this._id+"_alertdlg")||(o="<input id="+this._id+"_dialog_Ok ><\/input><input id="+this._id+"_dialog_Can style= 'margin-left: 10'; ><\/input>",u="<input id="+this._id+"_dialog_alertOk > <\/input>",e=h+i+"_condiv >"+o+"<\/div>",f=h+i+"_alertdiv >"+u+"<\/div>",r="<div class='e-alertdlgcontent' id="+i+"_dlgcontent > <\/div>",r=r+"<div class='e-dlg-btnfields' id="+i+"_dlgbtncontent >"+e+f+"<\/div>",s=n("<div id="+i+" class='e-alertdlg' style= 'display : none;'>"+r+"<\/div>"),this.element[0].appendChild(s[0]),n("#"+this._id+"_dialog_alertOk").ejButton(c),n("#"+this._id+"_dialog_Ok").ejButton(c),n("#"+this._id+"_dialog_Can").ejButton({text:this._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._alertCanClick,this)}))},alert:function(t){var i=n("#"+this._id+"_alertdlg");this._renderAlertDlgContent(i,"Alert",t);i.ejDialog("open")},_renderAlertDlgContent:function(n,i,r,u,f,e){var o=n.find("#"+this._id+"_alertdlg_dlgcontent"),s=n.find("#"+this._id+"_alertdlg_condiv"),h=n.find("#"+this._id+"_alertdlg_alertdiv");this._tabMode||this._phoneMode?f>this._responsiveWidth/1.2&&(f=this._responsiveWidth/1.2):f=f||400;e=e||"";i==="Alert"?(s.hide(),h.show()):(s.show(),h.hide());o.text("");o.html(r);n.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,enableAnimation:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Title"),width:f,height:"auto",minHeight:0,cssClass:"e-ss-dialog e-"+this._id+"-dlg"+e,open:t.proxy(this._alertDlgOpen)});this._alertDialog={element:n,action:u}},_alertDlgOpen:function(){this.element.find("input:visible:first").focus()},_alertOkClick:function(){var f,i=1,u=this.getActiveSheetIndex(),e,h=this._isUndoRedo,o,s,t,r;this._alertDialog.element.ejDialog("close");switch(this._alertDialog.action){case"findPrevComment":this.gotoPage(this.model.sheetCount,!1);f=this.model.sheets[this.model.sheetCount];this.XLComment._updateCurrentCell(f.rowCount-1,f.colCount-1);this.XLComment.findPrevComment();this._alertDialog.action=null;break;case"findNextComment":this.gotoPage(1,!1);this.XLComment._updateCurrentCell(0,0);this.XLComment.findNextComment();this._alertDialog.action=null;break;case"sheetRenameActn":n("#"+this._id+"_Sheet_RenamePanel").select().focus();break;case"sheetDeleteActn":this._removeSheet(u);this._alertDialog.action=null;break;case"New":this._isNew=!0;this._destroy();this._dataContainer.sheets[i]={};this.clearUndoRedo();this._updateCellType();this.model.sheetCount=i;this.model.activeSheetIndex=i;this._sheetSettings(i);this._newSIndex++;this._initCSSTag();this.gotoPage(i,!1);this.model.allowLockCell&&this.protectSheet(!1);e=n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").data("ejToggleButton");e&&(e.option("toggleState",!1),this.model.exportSettings.password=null,n("#"+this._id+"_AddSheet").removeClass("e-disable"));this.XLRibbon._toggleFormatTab();this.XLRibbon._toggleChartDesignTab();this.XLRibbon._toggleAnalyzeTab();this._refreshSpreadSheetPager();this.hideWaitingPopUp();this._isNew=!1;break;case"Open":n("#"+this._id+"_file .e-uploadinput").click();break;case"MergeCells":this._mergeCells(u,this.model.sheets[u]._selectedCells,{},[]);this._alertDialog.action=null;break;case"MergeAcrossCells":this._mergeAcrossCells(u,this.model.sheets[u]._selectedCells);this._alertDialog.action=null;break;case"MergeInsertDelete":for(this._dupDetails=!0,o=this._removeMergeColl,i=0,s=o.length;i<s;i++)this.unmergeCells(o[i].merge.mRange,!0);this._dupDetails=!1;t=this._insData;switch(t.value.status){case"shiftRight":this._insertShiftRight(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftBottom":this._insertShiftBottom(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftUp":this._deleteShiftUp(t.sheetIdx,t.startCell,t.endCell,t.value);break;case"shiftLeft":this._deleteShiftLeft(t.sheetIdx,t.startCell,t.endCell,t.value)}this._alertDialog.action=null;break;case"InvalidChartTitleActn":n("#"+this._id+"_chartnamedlg").find("input:first").focus();break;case"ConvertToRange":this.XLFormat._convertToRange({});break;case"TotalRow":this._isUndoRedo=this._dupDetails=!0;this.insertEntireRow(this._insRows.startRow,this._insRows.endRow);this.XLFormat._calculateTotalRow(u,null,!0,!1,!0);this._isUndoRedo=h;break;case"Drop":r=this.getSheet(u);this.XLDragDrop.moveRangeTo([r._startCell.rowIndex,r._startCell.colIndex,r._endCell.rowIndex,r._endCell.colIndex],[this._dStartCell.rowIndex,this._dStartCell.colIndex,this._dEndCell.rowIndex,this._dEndCell.colIndex]);r._startCell=this._dStartCell;r._endCell=this._dEndCell;this._trigger("drop",{sheetIndex:u,target:this.XLDragDrop._target,currentCell:this.XLDragDrop._dragAndDropCell,dragAndDropRange:{startCell:r._startCell,endCell:r._endCell}});break;case"FormulaAlert":this.XLEdit._editElem.focus();break;case"NMUniqueNameAlert":case"NMNameAlert":document.getElementById(this._id+"_nmgridname").focus();break;case"NMRangeAlert":document.getElementById(this._id+"_nmgridrefersto").focus();break;default:this.setSheetFocus()}},_alertCanClick:function(){var t=this._alertDialog,i;(t.action=="findNextComment"||t.action=="findPrevComment")&&n(this.getActiveCellElem()).find(".e-comment-txtarea").css("display","inline-table");t.action=="TotalRow"&&n("#"+this._id+"_Ribbon_Design_TableStyleOptions_TotalRow").length&&(this.XLRibbon._isSetModel=!0,n("#"+this._id+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox").option("checked",!1),this.XLRibbon._isSetModel=!1);t.element&&t.element.ejDialog("close");switch(t.action){case"Drop":i=this.getSheet(this.getActiveSheetIndex());this.performSelection(i._startCell,i._endCell)}this.hideWaitingPopUp()},_showAlertDlg:function(t,i,r,u,f){var e=n("#"+this._id+"_alertdlg"),o="Alert",s=i.indexOf("T-")===0?i.slice(2):this._getLocStr(i),h;if(h={reqType:"alert",action:r},this._trigActionBegin(h)){this._alertDialog.action=r;this._alertCanClick();return}t===o?this._renderAlertDlgContent(e,o,s,r,u,f):this._renderAlertDlgContent(e,"",s,r,u,f);e.ejDialog("open")},_isSheetsDirty:function(){var n=1,t=this._dataContainer.sheets,i=this.getObjectLength(t)+1;if(this.model.nameManager.length||this.getObjectLength(t)>1)return!0;while(n<i){if(this.getObjectLength(t[n]))return!0;n++}return!1},getCell:function(t,i,r){var u=0,r=this._getSheetIndex(r),f=this.getSheet(r);return this.model.scrollSettings.allowVirtualScrolling&&(u=1,t=this._getRowIdx(t),t===-1)?null:(this.isImport||f._isImported||this._isPrint)&&this._detachTable?n(this._detachTable[0].tBodies[u].rows[t].cells[i]):this._getContTBody(r)?n(this._getContTBody(r)[0].rows[t].cells[i]):null},getRange:function(i,r,u){i=this._getRangeArgs(i,"object",r);var l=i[0],e=i[1],h=i[2],f=i[3],o,y,c,s,a,w,v,p=[],r=this._getSheetIndex(r),b=this.getSheet(r);if(c=(this.isImport||b._isImported)&&this._detachTable?n(this._detachTable[0].tBodies[1].rows):n(this._getContTBody(r)[0].rows),l>h&&(a=l,l=h,h=a),e>f&&(a=e,e=f,f=a),this.model.scrollSettings.allowVirtualScrolling)for(o=l;o<=h;o++)y=this._getRowIdx(o),y>-1&&(s=n(c[y].cells),v=f===e?[s[f]]:this._browserDetails.version==="8.0"?s.slice(e,f+1).toArray():s.slice(e,f+1),t.merge(p,v));else for(c=h!==l?c.slice(l,h+1):c.eq(h),w=c.length,o=0;o<w;o++)u&&this._isHiddenRow(o,r)||(s=n(c[o].cells),v=f===e?[s[f]]:this._browserDetails.version==="8.0"?s.slice(e,f+1).toArray():s.slice(e,f+1),t.merge(p,v));return n(p)},getRangeIndices:function(n){n=n.indexOf(":")===-1?n+":"+n:n;var r=n.split(":"),t,i=[];return t=r[0].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[0].split(/[0-9]/)[0].toUpperCase())-1),t=r[1].split(/[A-Z]/i),i.push(parseInt(t[t.length-1])-1),i.push(this._generateColCount(r[1].split(/[0-9]/)[0].toUpperCase())-1),this.swapRange(i),i},swapRange:function(n){return n[0]>n[2]&&t.dataUtil.swap(n,0,2),n[1]>n[3]&&t.dataUtil.swap(n,1,3),n},updateRange:function(n,t){if(!this.model.isReadOnly){var u,o,v,s,y,h,c,f,l,i=[],a=[],e=t.dataSource,p=e.length,w=this.getObjectLength(e[0]);if(c=t.startCell,t.range?i=t.range:(h=c.split(/[A-Z]/i),i.push(parseInt(h[h.length-1])-1),i.push(this._generateColCount(c[0].split(/[0-9]/)[0].toUpperCase())-1),i.push(i[0]+p-(t.showHeader?0:1)),i.push(i[1]+w-1)),f=this._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),y=this._getContent(n),l=this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content >table"),this.model.allowAutoCellType&&this.model.allowCellType||l.detach(),t.showHeader)for(s in e[0])a.push(s);for(o=0;o<p;o++)if(e[o]!=r)for(s in e[0])a.push(e[o][s]);for(this._dupDetails=!0,u=0,v=f.length;u<v;u++)this.XLEdit._updateCell(f[u],a[u],n),t.showHeader&&u<w&&(i=t.startCell+":"+(this._generateHeaderText(f[f.length-1].colIndex+1)+(f[0].rowIndex+1)),t.headerStyles&&this.XLFormat.format({style:t.headerStyles},i));this._dupDetails=!1;this.model.allowAutoCellType&&this.model.allowCellType||y.find(".e-content").append(l);this._isUndoRedo||this._completeAction({sheetIndex:n,reqType:"update-range",rangeSettings:t})}},editRange:function(t,i){var o,s,a,f,v,r,l,u=this.getActiveSheetIndex(),e=this.getSheet(u).rangeSettings[t],h=this.getRangeIndices(e.range),c=this.getRange(h);for(this._trigger("editRangeBegin",{range:e,sheetIndex:u}),e.cssClass&&c.addClass(e.cssClass),e.readOnly&&c.addClass("e-readonly"),v=this._getContent(u),l=this._getJSSheetContent(u).find(".e-spreadsheetcontentcontainer > .e-content >table"),l.detach(),o=0,a=c.length;o<a;o++)f=c[o],$cell=n(f),n.trim(t).length&&this.XLEdit._updateDataContainer({rowIndex:f.parentNode.rowIndex,colIndex:f.cellIndex},{dataObj:{range:t}}),r=i(f,f.cellIndex,o),typeof r=="string"?this.XLEdit._updateCell($cell,r):typeof r=="object"&&(r.Value.indexOf("=")!==0?this.XLEdit._updateCell($cell,r.Value):this.XLEdit._updateCellValue($cell,r.Value),$cell.data("value2",r.Value2),$cell.data("type",r.NumberFormat),r.StyleIndex>1&&$cell.addClass(this._styleColl[r.StyleIndex]));for(v.find(".e-content").append(l),s=h[0];s<h[2]+1;s++)this._setRowHdrHeight(u,s);this._trigger("editRangeComplete",{range:e,sheetIndex:u});this.XLScroll._getRowHeights(u,h[0])},removeRange:function(n){this.clearRange(n);delete this.getSheet(this.getActiveSheetIndex()).rangeSettings[n]},clearRange:function(n){if(!this.model.isReadOnly){var r,t,i=this.getSheet(this.getActiveSheetIndex()).rangeSettings[n];r=this.getRangeIndices(i.range);t=this.getRange(r);i.cssClass&&t.removeClass(i.cssClass);i.readOnly&&t.removeClass("e-readonly");this.clearRangeData(null,["range","value","type","value2"],t);t.empty()}},getObjectLength:function(n){var t,i=0;if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},Object.keys)return Object.keys(n).length;for(t in n)n.hasOwnProperty(t)&&i++;return i},getObjectKeys:function(n){var t,i=[];if(n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{},!Object.keys){for(t in n)n.hasOwnProperty(t)&&i.push(t);return i}if(Object.keys)return Object.keys(n)},toArrayLowerCase:function(n){for(var t=0;t<n.length;t++)n[t]=n[t].toString().toLowerCase();return n},_isValueAlreadyExist:function(n,t,i){for(var r=0,u=n.length;r<u;){if(n[r][t]===i)return!0;r++}return!1},addClass:function(n,t){if(n){(n instanceof jQuery||n instanceof Array)&&(n=n[0]);var i=n.className;i.indexOf(t)===-1&&(n.className=i+" "+t)}},_removeClass:function(n,t){n&&((n instanceof jQuery||n instanceof Array)&&(n=n[0]),n.className=t?n.className.replace(new RegExp(t,"g"),"").replace(/ +/g," "):"")},_hasClass:function(n,t){return n?((n instanceof jQuery||n instanceof Array)&&(n=n[0]),!n||this._isAnimatedString(n.className))?!1:n.className.indexOf(t)>-1:!1},isUndefined:function(n){return n===r},_isString:function(n){return typeof n=="string"},_isEmptyString:function(n){return!n.toString().length},_isObject:function(n){return typeof n!="object"?!1:Object.prototype.toString.call(n)==="[object Object]"},_getObjectValues:function(n){var t,i=[];n=Object.prototype.toString.call(n)===Object.prototype.toString()?n:{};for(t in n)n.hasOwnProperty(t)&&i.push(n[t]);return i},_isAnimatedString:function(n){return Object.prototype.toString.call(n)==="[object SVGAnimatedString]"},_isBool:function(n){return n=n+"",n=n.toUpperCase(),n==="TRUE"||n==="FALSE"},isRange:function(n){return n[0]!==n[2]||n[1]!==n[3]},_isMultiRange:function(n){return!this._isString(n)&&!this.isNumber(n[0])},inRange:function(n,t,i){return t>=n[0]&&t<=n[2]&&i>=n[1]&&i<=n[3]},_inRow:function(n,t){return t>=n[0]&&t<=n[2]},_inColumn:function(n,t){return t>=n[1]&&t<=n[3]},_isUniqueRange:function(n,t){return n.toString()===t.toString()},_isUniqueTarget:function(n,t){var i=this._getOriginalEvt(t),r=document.elementFromPoint(i.clientX,i.clientY);return n.target===r},_getClientDiff:function(n,t){return{x:n[0]-t[0],y:n[1]-t[1]}},hasSpan:function(n){return this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")?!0:!1},_isFrozen:function(n){return n>0},_isSelected:function(t){return this._hasClass(t,"e-selected")||this._hasClass(t,"e-rowselected")||this._hasClass(t,"e-colselected")||n(t).parents(".e-colselected").length?!0:!1},_getMergedIdx:function(n,t){var u,e,o,s,h,i,c,l=ccount=0,f=this.getActiveSheetIndex(),r=this.XLEdit.getPropertyValue(n,t,"merge",f);if(r){if(r.mRange&&this.model.scrollSettings.allowVirtualScrolling){if(u=this.getRangeIndices(r.mRange),c=this.getSheet(f),c.hideRowsCollection.length&&(e=u[0],o=u[2],o-e>1))for(i=e+1;i<o;)this.XLEdit.getPropertyValue(i,0,["isRHide"],f)&&l++,i++;if(this.getObjectLength(c.hideColsCollection)&&(s=u[1],h=u[3],h-s>1))for(i=s+1;i<h;)this.XLEdit.getPropertyValue(0,i,["isCHide"],f)&&ccount++,i++}if(r.mSpan)return{rowIndex:n+r.mSpan.rowSpan+l-1,colIndex:t+r.mSpan.colSpan+ccount-1}}return{rowIndex:n,colIndex:t}},_getMergeParent:function(n,t){var i=this.XLEdit.getPropertyValue(n,t,"mergeIdx");return i?{rowIndex:i.rowIndex,colIndex:i.colIndex}:{rowIndex:n,colIndex:t}},_getCellInfo:function(n,t){var i=this.getSheet(this._getSheetIndex(t)),s,h,u,f=0,e=0,o,r;if(s=n.rowIndex>=i._frozenRows?i._rowHeightCollection[n.rowIndex]-(i._rowHeightCollection[i._ftopRowIdx]-i._rowHeightCollection[i._frozenRows-1]):i._rowHeightCollection[n.rowIndex],h=n.colIndex>=i._frozenColumns?i._colWidthCollection[n.colIndex]-(i._colWidthCollection[i._fleftColIdx]-i._colWidthCollection[i._frozenColumns-1]):i._colWidthCollection[n.colIndex],u=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge"),u){for(o=u.mSpan,r=0;r<o.rowSpan;r++)e+=i.hideRowsCollection.indexOf(n.rowIndex+r)===-1?i.rowsHeightCollection[n.rowIndex+r]:0;for(r=0;r<o.colSpan;r++)f+=i.columnsWidthCollection[n.colIndex+r]}else e=i.hideRowsCollection.indexOf(n.rowIndex)===-1?i.rowsHeightCollection[n.rowIndex]:0,f=i.columnsWidthCollection[n.colIndex];return{top:s-1,left:h-1,height:e,width:f}},_getRowIdx:function(n,t,i,r){var u,f=this.getSheet(t);return i?(u=f._rowIdxColl[n],n=this.isUndefined(u)?f._rowIdxColl[f._rowIdxColl.length-1]:u):r?(u=f._rowIdxColl.indexOf(n),n=u===-1?n:u):this.model.scrollSettings.allowScrolling&&this.model.scrollSettings.allowVirtualScrolling&&(n=f._virtualRowIdx.indexOf(n)),n},_getMinRowIdx:function(n){for(var t=0;t<n.rowCount;t++)if(n.hideRowsCollection.indexOf(t)===-1&&n._hiddenFreezeRows.indexOf(t)===-1)return t;return 0},_arrayAsString:function(n){return n.join(" ").replace(/,/g," ")},_rangeHasData:function(n){var t,i,r;for(n=this.swapRange(n),t=this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),i=t.length;i--;)if(r=t[i],this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex))return!0;return!1},_isTableRange:function(n,t,i){i=this._getSheetIndex(i);var r,u=this.getSheet(i).tableManager;for(r in u)if(this.inRange(u[r].range,n,t))return!0;return!1},_hasCellStyle:function(n,t,i){for(var r,u=["borders","formats"],f=u.length;f--;)if(r=this.XLEdit.getPropertyValue(n,t,u[f],i),r)return!0;return!1},_isHiddenRow:function(n,t){return this.XLEdit.getPropertyValue(n,0,"isFilterHide",t)||this.XLEdit.getPropertyValue(n,0,"isRHide",t)||!1},_refreshViewVar:function(n,i,r){r=this._getSheetIndex(r);var u=this.getSheet(r);t.isNullOrUndefined(n)||(u._topRow.idx=this.XLShape._getCellIndexFromOffset(n,null,r).rowIndex,u._topRow.value=this._getRowOffsetTop(u,u._topRow.idx),u._bottomRow.idx=u._rowIdxColl[u._topRow.idx+(u._virtualBlockRowCnt-this._bufferCnt-1)],u._bottomRow.value=this._getRowOffsetTop(u,u._bottomRow.idx),u.topLeftCell=this.getAlphaRange(u._topRow.idx,u._leftCol.idx));t.isNullOrUndefined(i)||(u._leftCol.idx=this.XLShape._getCellIndexFromOffset(null,i,r).colIndex,u._leftCol.value=this._getColOffsetLeft(u,u._leftCol.idx),u._rightCol.idx=this.XLShape._getCellIndexFromOffset(null,i+u._vPortWth,r).colIndex||u.colCount-1,u._rightCol.value=this._getColOffsetLeft(u,u._rightCol.idx),u.topLeftCell=this.getAlphaRange(u._topRow.idx,u._leftCol.idx))},_getFormatString:function(n,i){var r=t.Spreadsheet.CellFormat[n];return this.isNumber(i)&&!t.isNullOrUndefined(r)&&(r="{0:"+r.substr(3,1)+i+"}"),r||""},_refreshVrtlBlocks:function(n){for(var r,i=idx=0,u=["_virtualTopTBodyOffset","_virtualContTBodyOffset","_virtualBottomTBodyOffset"],n=this._getSheetIndex(n),t=this.getSheet(n);i<3;)(i||t._isVirtualTopReached)&&i!==1&&(i!==2||t._isVirtualEndReached)||(r=t._virtualRowIdx[idx],t[u[i]].top=this._getRowOffsetTop(t,r),idx+=t._virtualBlockRowCnt,r=t._virtualRowIdx[idx-1],t[u[i]].bottom=this._getRowOffsetBottom(r,n)),i++;t._virtualTBodyHgt=t._rowHeightCollection[t._rowHeightCollection.length-1]+t.rowsHeightCollection[t.rowsHeightCollection.length-1]},getRangeDataAsObject:function(n,i,r){var f,s,e,h,c,w=t.Spreadsheet.CellType,o=this._dataContainer,d=this.getActiveSheetIndex(),l=o.sheets[this.getActiveSheetIndex()],u,a,v,y,b=[],k=[],p=[];for(n.rowIndex>i.rowIndex?(u=i.rowIndex,a=n.rowIndex):(u=n.rowIndex,a=i.rowIndex),n.colIndex>i.colIndex?(v=i.colIndex,y=n.colIndex):(v=n.colIndex,y=i.colIndex);u<=a;){if(!r||!this._isHiddenRow(u)){for(h={},c={},f=v;f<=y;f++)s=this._generateHeaderText(f+1),u in l&&f in l[u]&&(e=l[u][f],h[s]=o.sharedData[e.value],c[s]=[w.General,w.Text].indexOf(o.cellType[e.type])===-1?e.value2:o.sharedData[e.value2]);b.push(h);k.push(c)}u++}return p.push(b),p.push(k),p},getRangeDataAsJSON:function(n,i,r,u){var o,b,e,l,a=t.Spreadsheet.CellType,h=this._dataContainer,s=h.sheets[u?u:this.getActiveSheetIndex()],f,y,p,w,k=[],v=!0,d=[],c;for(n.rowIndex>i.rowIndex?(f=i.rowIndex,y=n.rowIndex):(f=n.rowIndex,y=i.rowIndex),n.colIndex>i.colIndex?(p=i.colIndex,w=n.colIndex):(p=n.colIndex,w=i.colIndex);f<=y;){if(!r||!this._isHiddenRow(f)){for(l={},o=p;o<=w;o++)v?f in s&&o in s[f]&&(e=s[f][o],d[o]=this.isUndefined(e.type)||[a.General,a.Text].indexOf(h.cellType[e.type])!==-1?h.sharedData[e.value2]:e.value2):(b=d[o],f in s&&o in s[f]&&(e=s[f][o],c=this.isUndefined(e.type)||[a.General,a.Text].indexOf(h.cellType[e.type])!==-1?h.sharedData[e.value2]:e.value2,t.isNullOrUndefined(c)||(l[b]=this.isNumber(c)?parseInt(c):c)));!v&&this.getObjectLength(l)&&k.push(l)}f++;v&&(v=!1)}return k},_getColorFromFormat:function(n){var r=[],i,u,f;return t.isNullOrUndefined(n)||(i=n.replace("e-format","").toLowerCase(),u=i.startsWith("6n")?"#"+i.substr(2,6):"#"+i.substr(6,6),f="#"+i.substr(0,6),r.push(f),r.push(u)),r},getRangeData:function(n){n=n||{};n.sheetIdx=this._getSheetIndex(n.sheetIdx);n.range=this._toIntrnlRange(n.range,n.sheetIdx);n.property=n.property||["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","cellType","altTxt"];var e=0,c,l,i,r,o,s,u,h=[],f=[],a=this.getSheet(n.sheetIdx);if(n.rowIdxs)for(c=n.rowIdxs.length;e<c;)this._pushRowData(n,n.rowIdxs[e],0,a.colCount-1,f,h),e++;else for(u=!1,this.model.scrollSettings.allowVirtualScrolling&&n.skipHiddenRow&&!t.isNullOrUndefined(n.virtualRowIdx)?(u=!0,i=n.virtualRowIdx,r=i+(n.virtualRowCount-1),o=a.colCount-1):(i=n.range[0],r=n.range[2],o=n.range[3]);i<=r;)s=this._isHiddenRow(i,n.sheetIdx),u&&s?r++:n.skipHiddenRow&&s||(l=u?0:n.range[1],this._pushRowData(n,i,l,o,f,h,!0)),i++;return n.withRowIdx?{rowIdx:h,data:f}:f},_pushRowData:function(n,t,i,r,u,f,e){var o,h,c,s,a,v="value",p=this._intrnlUpdate,y=this._dataContainer,l=y.sheets[n.sheetIdx];if(e||this.XLEdit._refreshContainer(t,n.sheetIdx),l[t])if(n.valueOnly)while(i<=r)o="",s=l[t][i],s&&v in s&&(a=y.sharedData,o=a[s[v]],n.skipDateTime&&this._isDateTime(o)?o=this.XLEdit.getPropertyValue(t,i,"value2",n.sheetIdx):n.skipFormula&&this.isFormula(o)&&(o=this.XLEdit.getPropertyValue(t,i,"calcValue",n.sheetIdx))),n.skipEmptyCell&&(this.isUndefined(o)||!o.toString().length)||u.push(o),i++;else{for(this._intrnlUpdate=!0;i<=r;){if(s=l[t][i],s){h={};for(c in s)n.property.indexOf(c)>-1&&(h[c]=this.XLEdit.getPropertyValue(t,i,c,n.sheetIdx));(!n.skipEmptyCell||this.getObjectLength(h))&&u.push(h)}else n.skipEmptyCell||u.push({});i++}this._intrnlUpdate=p}else if(!n.skipEmptyCell)while(i<=r)n.valueOnly?u.push(""):u.push({}),i++;f.push(t)},_processBindings:function(n){if(this.model.query=new t.Query,this._trigger("actionBegin",n))return!0;this._ensureDataSource(n);n.action==="sorting"?(this.XLSort._sortComplete(n),this._isUndoRedo||this._completeAction(n)):this._completeAction(n)},_ensureDataSource:function(n){var i,v,o,u,s,h,f,c,l=this.getActiveSheetIndex(),a=this.getSheet(l),e,y;if(n.action==="filtering"||n.action==="clearfiltering"||n.requestType==="filterbycell"){for(i=a.filterSettings.filteredRange==null?this._dataSource(l):a.filterSettings.filteredRange,c=a.filterSettings.tableRange,e=0,y=c.length;e<y;e++)if(c[e].tableID===n.tableID){c[e].filteredRange=i;break}if(this._dataManager=t.DataManager(i),i instanceof t.DataManager||(this.model.currentViewData=i),this.model.query.requiresCount(),n.filteredcolumns.length){s=this._excelFilter._predicates[l];v=i[0];for(o in s)v.hasOwnProperty(o)&&(h=s[o]),h=s[o],u=u!=r?u.and(h):h;t.isNullOrUndefined(u)||this.model.query.where(u);i instanceof t.DataManager||(f=this._dataManager.executeLocal(this.model.query),this._filteredRecordsCount=f.count,this.model.currentViewData=f.result)}}else n.requestType==="sorting"&&(this._dataManager=t.DataManager(n.rangeData),n.rangeData instanceof t.DataManager||(this.model.currentViewData=n.rangeData),this.model.query.sortBy(n.columnName,n.sortDirection),n.rangeData instanceof t.DataManager||(f=this._dataManager.executeLocal(this.model.query),this.model.currentViewData=f));this._dataManager=null},_toArrayData:function(n){for(var u,t,i=0,r=[],f=n.length;i<f;){if(t=n[i],this.getObjectLength(t))for(u in t)r.push(t[u]);else r.push("");i++}return r},_updateRangeStyle:function(n,t,i){for(var u=this._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),r=0;r<u.length;r++)this.model.allowCellFormatting&&this.XLFormat._hasFormat(t[r].format)&&(this.XLFormat._updateFormatClass(u[r],t[r].format),this.XLEdit._updateDataContainer(u[r],{dataObj:{formats:t[r].formats},sheetIdx:this.getActiveSheetIndex(),status:i}))},updateRangeData:function(n,i){var u,f,r;if(!this.model.isReadOnly&&(n=this._getRangeArgs(n,"object"),n.length&&(n.startCell={rowIndex:n[0],colIndex:n[1]},n.endCell={rowIndex:n[2],colIndex:n[3]}),u=this._getSelectedRange(n.startCell,n.endCell),f=this._toArrayData(i),f.length===u.length))for(r=0;r<u.length;r++)t.isNullOrUndefined(f[r])||this.XLEdit._updateCellValue(this.getCell(u[r].rowIndex,u[r].colIndex),f[r])},updateData:function(n,i,r){if(!this.model.isReadOnly){var f,a,e,v,c,o,u,h,y=0,p="clear-format",s={},l=this._cellProp,w=this.getActiveSheetIndex(),b=this.getSheet(w);for(i=this._getRangeArgs(i,"object"),f=i[0],a=i[2],v=i[3];f<=a;){for(e=i[1];e<=v;)u=n[y],o=this.getCell(f,e,w),this.XLEdit._updateDataContainer({rowIndex:f,colIndex:e},{dataObj:u}),o&&(l[13]in u&&(h=u.hyperlink,h&&(r===p?o.find("a").css({color:this._hlColor,"text-decoration":"underline"}).addClass("e-hyperlinks"):h.webAddr?o.html(t.buildTag("a",u.value2,"",{href:h.webAddr,target:"_blank","class":"e-hyperlinks"})):o.html(t.buildTag("a",u.value2,"",{href:"#","class":"e-hyperlinks"})))),r===p&&(u.formatStr&&(s.formatStr=u.formatStr),u.type&&(s.type=u.type),t.isNullOrUndefined(u.decimalPlaces)||(s.decimalPlaces=u.decimalPlaces),t.isNullOrUndefined(u.thousandSeparator)||(s.thousandSeparator=u.thousandSeparator),this.XLFormat.format(s,[f,e,f,e])),l[21]in u&&this.XLComment._updateCmntFrmCntnr(f,e),l[0]in u&&(c=u.value,this.XLEdit._refreshCalcEngine(f,e,this.isFormula(c),c))),y++,e++;f++}}},updateUniqueData:function(n,t,i,r){if(!this.model.isReadOnly){t=this._getRangeArgs(t,"object");var u,f={dataObj:n},e=t[0],o=t[2],s=t[3];for(i&&(f.skipCell=i),f.sheetIdx=r;e<=o;){for(u=t[1];u<=s;)this.XLEdit._updateDataContainer({rowIndex:e,colIndex:u},f),u++;e++}}},clearRangeData:function(n,t,i,r,u,f){if(!this.model.isReadOnly){var e,o,s,h,c=this.getActiveSheetIndex();for(n=this._getRangeArgs(n,"object",c),t=t?t:["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","isFilterHighlight"],e=n[0],s=n[2],h=n[3];e<=s;){if(!r||!this._isHiddenRow(e))for(o=n[1];o<=h;)this.XLEdit._clearDataContainer({cellIdx:{rowIndex:e,colIndex:o},property:t,status:u,skipCell:f}),o++;t.indexOf("wrap")>-1&&this._setRowHdrHeight(c,e);e++}}},_getArrayRangeCells:function(n){return n?(n=this.swapRange(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getAlphaRangeCells:function(n){return n?(n=this.getRangeIndices(n),this.getRange(n)):this._getContent(this.getActiveSheetIndex()).find(".e-selected")},_getMultiRangeCells:function(n){var i,t,u,r,f;if(n){if(i=0,u=[],r=[],this._isString(n))r.push(this.getRangeIndices(n));else if(this.isNumber(n[0]))r.push(n);else for(f=n.length;i<f;)t=n[i],r.push(Array.isArray(t)?t:this.getRangeIndices(t)),i++;for(i=0,f=r.length;i<f;)t=r[i],u=u.concat(this._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]})),i++}else n=this._getRangeArgs(n,"object"),u=this._getSelectedCells(this.getActiveSheetIndex(),n).selCells;return u},_completeAction:function(n){var u=this.getActiveSheetIndex(),e=this.getSheet(u),i,s,v,y,h,c,l,r,f,o,a;if(n.reqType==="filter"){if(n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&n.operation!=="clearfilter")for(s=n.model.currentViewData,i={sheetIndex:u,range:e._selectedRange,currentViewData:s,fieldName:n.currentFilteringColumn,ejpredicate:n.ejpredicate,activeCell:n.activeCell,filteredValue:n.filteredValue,filterCollection:n.filteredcolumns,requestType:n.requestType,reqType:n.reqType,selectedCell:n.selectedCell,action:n.action,operation:"filter",selectedDataSource:e.selectedDataSource,tableID:n.tableID,filteredCells:n.filteredCells,fltrdIdxes:[],selRange:n.selRange},r=0,len=s.length;r<len;r++)i.fltrdIdxes.push(i.range.startRow+e.filterSettings.filteredRange.indexOf(s[r]));else i=n.operation==="remove-filter"||n.operation==="clearfilter"?n:{sheetIndex:u,filteredCells:n.filteredCells,reqType:"filter",operation:"apply-filter",tableID:n.tableID,fRange:this.getSheet(u).filterSettings.range};i.rowIndex=n.rowIndex;i.colIndex=n.colIndex}else if(n.requestType===t.Spreadsheet.Actions.Sorting){for(l=[],c=n.filterIcon.length>0?n.range[0]-1:n.range[0],r=0;r<n.filterIcon.length;r++)h=this.XLFilter._getFilterHeader(u,c,n.filterIcon[r].colIndex),v=t.isNullOrUndefined(h)?"":h.status.indexOf("-asc")>-1?"-asc":h.status.indexOf("-dsc")>-1?"-dsc":"",y=n.filterIcon[r].colIndex===this._generateColCount(n.columnName)-1?n.sortDirection==="ascending"?"-asc":"-dsc":"",l.push({rowIdx:c,colIdx:n.filterIcon[r].colIndex,prevIcon:v,currIcon:y});i={sheetIndex:u,filterIcons:l,isSortByFilter:n.isSortByFilter,colSelected:n.colSelected,range:n.range,columnName:n.columnName,rangeData:n.rangeData,reqType:"sort",direction:n.sortDirection,operation:"unsort"}}else if(n.requestType==="sortbycolor"||n.requestType==="filterbycolor"){if(i={sheetIndex:u,operation:n.operation,oprType:n.oprType,requestType:n.requestType,action:n.action,bgcolor:n.bgcolor,fgcolor:n.fgcolor,tableID:n.tableID,reqType:n.requestType,sortRange:n.sortRange},i.columnName=n.requestType==="sortbycolor"?n.sortColumn:n.filterColumn,n.requestType==="filterbycolor"){for(o=[],a=this._generateColCount(i.columnName),r=n.range.endRow;r>=n.range.startRow;r--)f=this.XLEdit.getPropertyValue(r,a-1,"formats"),t.isNullOrUndefined(f)||(n.operation==="filterbgcolor"?t.isNullOrUndefined(f["background-color"])||n.bgcolor.toLowerCase()===f["background-color"].toLowerCase()&&o.push(r):t.isNullOrUndefined(f.color)||n.fgcolor.toLowerCase()===f.color.toLowerCase()&&o.push(r));i.fltrdIdxes=o;i.rowIndex=n.range.startRow-1;i.colIndex=a-1}}else i=n;!this.model.allowUndoRedo||i.requestType==="sortbycolor"||this._dupDetails||this.updateUndoRedoCollection(i);(n.requestType==="filtering"||n.requestType==="filterbycolor"||n.requestType==="sortbycolor"||n.requestType==="filterbycell")&&n.operation!=="apply-filter"&&n.operation!=="remove-filter"&&this.sendDataRenderingRequest(i,this.getActiveSheetIndex());this.model.allowAutoFill&&n.reqType!=="find-replace"&&this.element.find(".e-ss-activeimg").length<1&&!e._isFreezed&&this.XLDragFill.positionAutoFillElement();this.XLComment&&this.XLComment._isCommentEdit||this._updateUndoRedoIcons();n.reqType!=="paging"&&(n.reqType==="edit"&&n.hasValidation?this._trigrDdlActnCmplt(n.cValue,n.pValue):this._trigActionComplete(n))},updateUndoRedoCollection:function(n){this._isUndoRedo||n.reqType==="update-range"||(this._undoCollection.push(n),this._redoCollection=[]);this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1);this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()},_trigActionBegin:function(n){return!this._isSaveAsJSON&&this._trigger("actionBegin",n)},_trigActionComplete:function(n){return!this._isSaveAsJSON&&this._trigger("actionComplete",n)},_updateUndoRedoIcons:function(){if(!this.model.showRibbon||!this.model.allowUndoRedo){this.XLComment&&this.XLComment._isCommentEdit||this.setSheetFocus();return}if(n("#"+this._id+"_Ribbon_Home_Actions_Undo").length&&n("#"+this._id+"_Ribbon_Home_Actions_Redo").length&&!this.model.isReadOnly){var t=n("#"+this._id+"_Ribbon_Home_Actions_Undo").data("ejButton"),i=n("#"+this._id+"_Ribbon_Home_Actions_Redo").data("ejButton");t&&(this._undoCollection.length?t.enable():t.disable());i&&(this._redoCollection.length?i.enable():i.disable());this.XLEdit._isEdit||this.XLComment&&this.XLComment._isCommentEdit||this._isSheetRename||!document.activeElement||!(document.activeElement.id.indexOf(this._id+"_Ribbon")<0)||this.setSheetFocus()}},_filterMergeCells:function(n,t){for(var s=this.getActiveSheetIndex(),h=this._dataContainer.sheets[s],e=this.getObjectKeys(h[n]),r,i,o=!1,u,f=0;f<e.length;f++)u=this.XLEdit.getPropertyValue(n,e[f],"mergeIdx"),u&&(r=u,o=!0);o&&(i=this.getCell(r.rowIndex,r.colIndex)[0],i.rowSpan=t==="incr"?i.rowSpan+1:i.rowSpan-1)},_isRowVisible:function(n,t){var i=this._dataContainer.sheets[n];return t in i?0 in i[t]&&(i[t][0].isRHide||i[t][0].isFRHide)?!1:!0:!0},_selectFirstCell:function(n,t,i,r){var u=this.getSheet(n);return u._isImported&&!u._isLoaded||r||(r=!r,this.performSelection({rowIndex:t,colIndex:i},{rowIndex:t,colIndex:i})),r},_clearAllMergeCells:function(t,i,r,u,f,e){var l=this.getSheet(t),y=!1,b=this._dupDetails,p,v=l._mergeColl,k=l._unmergeColl,d=this._removeMergeColl,o,c,g=this._dataContainer.sheets[t],a={isCancel:!1,isAlert:!0},s,w,h;for(this._dupDetails=!0,o=this.getObjectKeys(v),o.length<1&&(y=!0),s=0,w=o.length;s<w;s++)for(c=this.getObjectKeys(v[o[s]]),h=0;h<c.length;h++)mergeObj=n.extend(!0,{},this.XLEdit.getPropertyValue(o[s],c[h],"merge")),p=this.getRangeIndices(mergeObj.mRange),a=this._checkFilterMerge(t,p,i,r,u,f,e,"merge",y,o[s],c[h],mergeObj),a.isClear&&(o[s]in k?l._unmergeColl[o[s]][c[h]]={type:v[o[s]][c[h]],merge:mergeObj}:(l._unmergeColl[o[s]]={},l._unmergeColl[o[s]][c[h]]={type:v[o[s]][c[h]],merge:mergeObj}),this.unmergeCells(mergeObj.mRange,!0)),a.isClear=!1;return this._dupDetails=b,{isCancel:a.isCancel,isAlert:a.isAlert}},_checkFilterMerge:function(n,t,i,r,u,f,e,o,s,h,c,l){var v,p=this.getSheet(n),y=this._getSelectedCells(n,t).range,a=!1,w=p._mergeColl;return e.indexOf("shift")>-1&&!this._isUndoRedo?(o==="merge"&&(this._removeMergeColl=[]),e.indexOf("Bottom")>-1||e.indexOf("Up")>-1?(u>=t[1]||t[3]>=u+f-1?(i>=t[2]||i<=t[2])&&(u<t[1]&&u+f-1<t[1]?s=!0:u>t[3]&&u+f-1>t[3]?s=!0:this._isTotalRow||u!==t[1]||t[3]!==u+f-1||(a=!0,s=!0),!s&&i>t[2]&&(s=!0)):u<t[1]&&t[3]<u+f-1&&(s=!0,a=!0),o==="merge"&&e.indexOf("Up")>-1&&this.XLEdit._rangeHasProperty(y,"merge")&&(this._showAlertDlg("Alert","MergePreventInsertDelete","MergePreventInsertDelete",450),a=!1,v=!0)):(e.indexOf("Right")>-1||e.indexOf("Left")>-1)&&(i>=t[0]||t[2]>=i+r-1?(u>=t[3]||u<=t[3])&&(i<t[0]&&i+r-1<t[0]?s=!0:i>t[2]&&i+r-1>t[2]?s=!0:i===t[0]&&t[2]===i+r-1&&(a=!0,s=!0),!s&&u>t[3]&&(s=!0)):i<t[0]&&t[2]<i+r-1&&(s=!0,a=!0),o==="merge"&&e.indexOf("Left")>-1&&this.XLEdit._rangeHasProperty(y,"merge")&&(this._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450),a=!1,v=!0)),o!=="merge"||s||a||this._removeMergeColl.push({type:w[h][c],merge:l})):(this._isUndoRedo&&(s=!0),(i===-1||i!=-1&&t[0]<=i&&t[2]>i)&&(a=!0),(u===-1||u!=-1&&t[1]<=u&&t[3]>u)&&(a=!0)),{isClear:a,isAlert:s,isCancel:v}},_refreshAllMergeCells:function(n,i,r,u,f,e){var a=this.getSheet(n),v=!1,y=a._unmergeColl,w=this._dupDetails,b,k,h,l,o,d=this._dataContainer.sheets[n],s,p,c;for(h=this.getObjectKeys(y),this._dupDetails=!0,s=0,p=h.length;s<p;s++)for(b=parseInt(h[s])>i?e.indexOf("insert")>-1?parseInt(h[s])+r:parseInt(h[s])-r:h[s],l=this.getObjectKeys(y[h[s]]),c=0;c<l.length;c++)k=parseInt(l[c])>u?e.indexOf("insert")>-1?parseInt(l[c])+f:parseInt(l[c])-f:l[c],mergeObj=a._unmergeColl[h[s]][l[c]].merge,this.mergeCenter=a._unmergeColl[h[s]][l[c]].type==="center",o=this.getRangeIndices(mergeObj.mRange),(i>-1||u>-1)&&(t.isNullOrUndefined(o)||(e.indexOf("Shift")>-1?(this._unMergeRange=mergeObj.mRange,this._showAlertDlg("","MergeCellsAlert","MergeCellsInsertAlert",498)):(i>-1&&(this._isUndoRedo&&(v=i<o[2]?o[2]-i==1:i-o[2]==1),i<=o[0]&&(o[0]=e==="insert"?o[0]+r:o[0]-r),(i<=o[2]||v)&&(o[2]=e==="insert"?o[2]+r:o[2]-r)),u>-1&&(this._isUndoRedo&&(v=u<o[3]?o[3]-u==1:u-o[3]==1),u<=o[1]&&(o[1]=e==="insert"?o[1]+f:o[1]-f),(u<=o[3]||v)&&(o[3]=e==="insert"?o[3]+f:o[3]-f)),mRange=this._getAlphaRange(n,o[0],o[1],o[2],o[3]),delete a._unmergeColl[h[s]][l[c]],this.mergeCells(mRange,!0))));this._dupDetails=w},_refreshSHMergeCells:function(n,t,i,r,u){var b=this.getSheet(n),k=b._mergeColl,c,y,s,f,e,p,tt,l,w,a=!1,h,d,v,g,o,nt;for(c=this.getObjectKeys(k),h=0,d=c.length;h<d;h++)for(y=this.getObjectKeys(k[c[h]]),v=0,g=y.length;v<g;v++)if(p=!1,l=!1,e=0,w=!1,s=this.XLEdit.getPropertyValue(c[h],y[v],"merge"),!(this.getObjectKeys(s).length<1)){for(f=this.getRangeIndices(s.mRange),tt=u==="show"?this._getSpanFromMCells(f[0],f[1],r):0,o=0,nt=t.length;o<nt;o++){if(this._dupDetails=!0,r==="column"?f[1]<t[o]&&f[3]>t[o]-1&&(e+=1,p=!0):b.hideRowsCollection.indexOf(f[0])===-1&&f[0]<t[o]&&f[2]>=t[o]&&(e+=1,p=!0),r==="row"&&f[0]>=t[o]||r==="column"&&f[1]>=t[o]){if(!l){if(f[2]>t[t.length-1]&&f[0]<t[t.length-1])l=!0,w=!1;else{this._dupDetails=!1;break}this._isShowHide=!0;l&&this.unmergeCells(s.mRange);this._isShowHide=!1}e+=1}this._dupDetails=!1}p&&!w&&(this._isRowViewable(n,parseInt(c[h]))&&(actCell=this.getCell(parseInt(c[h]),parseInt(y[v]))[0],a=!0),r==="row"?u==="hide"?(a&&(actCell.rowSpan-=e),s.mSpan.rowSpan-=e):(a&&(actCell.rowSpan+=e),s.mSpan.rowSpan+=e):u==="hide"?(a&&(actCell.colSpan-=e),s.mSpan.colSpan-=e):(a&&(actCell.colSpan+=e),s.mSpan.colSpan+=e));l&&(u==="hide"?(r==="column"?f[1]+=e:f[0]+=e,this._setSpanToMCells(f[0],f[1],r,e)):(e+=this._getSpanFromMCells(f[0],f[1],r),r==="column"?f[1]-=e:f[0]-=e),this._dupDetails=!0,this.mergeCells(this._getAlphaRange(n,f[0],f[1],f[2],f[3]),!0),this._dupDetails=!1)}},_getSpanFromMCells:function(n,t,i){var u=this.getSheet(this.getActiveSheetIndex()),r=u._hideMergeColl;return!this.isUndefined(r[n])&&!this.isUndefined(r[n][t])?i==="row"?r[n][t].rowspan:r[n][t].colspan:0},_setSpanToMCells:function(n,t,i,r){var f=this.getSheet(this.getActiveSheetIndex()),u=f._hideMergeColl;this.isUndefined(u[n])&&(u[n]={});this.isUndefined(u[n][t])&&(u[n][t]={});i==="row"?u[n][t].rowspan=r:u[n][t].colspan=r},sendDataRenderingRequest:function(i,u){for(var f,it=!1,ri,g,at,lt,ui=this._rAlign,o=this.getSheet(u),tt=this.model.scrollSettings.allowVirtualScrolling,e=o._selectedRange,k=[],h,fi,kt,l=o.filteredRowsCollection,v,ft,y,p=o.filterSettings.tableRange,et=[],dt,ot,b=[],st,ut,w,pt,gt,s,wt,bt,d,ni,ct,ti,ii,a=0,rt=p.length;a<rt;a++)if(p[a].tableID==i.tableID){y=a;break}if(tt&&(ri=o.rowsHeightCollection,g=o.hideRowsCollection),this._dupDetails=!0,t.isNullOrUndefined(i)||i.reqType!="filter"){if(!t.isNullOrUndefined(i)&&(i.requestType==="sortbycolor"||i.requestType==="filterbycolor")){var ei=e.startRow,vt=[],ht,yt=[],h=this._generateColCount(i.columnName)-1,c,nt;if(i.prev={},i.cur={},i.oprType.indexOf("Put")<0&&(o._filterColl[e.startRow-1][h].status.indexOf("e-ssfilter")>-1&&i.requestType==="filterbycolor"?this._isRowViewable(u,e.startRow-1)&&(kt=this.getCell(e.startRow-1,h),kt.removeClass(ui),this.XLFilter._changeFilterIcon({rowIndex:e.startRow-1,colIndex:h},"filter",this.XLEdit.getPropertyValue(e.startRow-1,h,"filterState"))):o._filterColl[e.startRow-1][h].status.indexOf("-asc")&&(i.prev.icon=o._filterColl[e.startRow-1][h].status,this._isRowViewable(u,e.startRow-1)&&(kt=this.getCell(e.startRow-1,h),this.XLFilter._changeSortIcon({rowIndex:e.startRow-1,colIndex:h},"ascending")),i.cur.icon=o._filterColl[e.startRow-1][h].status)),i.requestType==="sortbycolor"){for(c=[e.startRow,h,e.endRow,h],nt=this.getRangeData({range:c,skipHiddenRow:!0}),a=0,ut=nt.length;a<ut;a++)ht=nt[a].formats,t.isNullOrUndefined(ht)||(i.operation==="sortbgcolor"?t.isNullOrUndefined(ht["background-color"])||i.bgcolor===ht["background-color"].toLowerCase()&&vt.push(a):t.isNullOrUndefined(ht.color)||i.fgcolor===ht.color.toLowerCase()&&vt.push(a));if((i.oprType==="PutCellColor"||i.oprType==="PutFontColor")&&(c=i.sortRange),this.isUndefined(i.tableID))for(w=[],bt=c[1];bt<=c[3];bt++)w.push(bt);else w=p[y].multifilterIdx;for(c=[e.startRow,w[0],e.endRow,w[w.length-1]],nt=this.getRangeData({range:c,skipHiddenRow:!0}),i.prev.data=n.extend(!0,[],nt),c.colIndex=h,i.range=c,s=0,rt=w.length;s<rt;s++){for(pt=[],gt=[],c=[e.startRow,w[s],e.endRow,w[s]],nt=this.getRangeData({range:c,skipHiddenRow:!0}),wt=vt.length-1;wt>=0;wt--)pt.push(nt.splice(vt[wt],1)[0]);gt=pt.reverse().concat(nt);pt.length>0&&(this._isSort=!0,this._dupDetails=!0,this.XLComment.deleteComment(c,null,!0,null),this._removeHyperlink(null,null,!0,c),this.clearRangeData(c,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(c,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this._isSort=!1,this._dupDetails=!1,this.XLEdit.updateCellWithContainer(gt,c,u,!0))}c=[e.startRow,w[0],e.endRow,w[w.length-1]];i.cur.data=n.extend(!0,[],this.getRangeData({range:c,skipHiddenRow:!0}));this.updateUndoRedoCollection(i)}else{for(yt=[],et=[],p[y].fltrdIdxes=k=i.fltrdIdxes,v=e.startRow===0?0:e.startRow,f=v;f<=e.endRow;f++){for(st=!1,s=0,ut=k.length;s<ut;s++)k[s]==f&&(st=!0);st?(ct=this.XLEdit.getPropertyValue(f,h,"value2"),ct=t.isNullOrUndefined(ct)?"":ct,dt={field:i.columnName,value:ct,predicate:"or",operator:"equal",matchcase:!1},ot=t.Predicate(i.columnName,"equal",ct),this.XLEdit.getPropertyValue(f,0,"filterID")===i.tableID&&(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID,tt?(g.splice(g.indexOf(f),1),this._refreshSHMergeCells(u,[f],1,"row","show")):(this._isFilter=!0,this._showRow(f+1,f),this._isFilter=!1,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1),o._isImported&&!o._isLoaded||it||(it=!it,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))),yt.push(dt),b.push(dt),d=b[0],ni=d.from):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:i.tableID}}),ft=!0),tt?ft&&(g.push(f),this._refreshSHMergeCells(u,[f],1,"row","hide")):(this._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this._isFilter=!1,l.indexOf(f)===-1&&l.push(f)),ft=!1)}for(tt&&(!o._isImported||o._isLoaded)&&(this.refreshContent(u),this.performSelection({rowIndex:k[0],colIndex:h},{rowIndex:k[0],colIndex:h})),this.XLScroll._getRowHeights(u,v),i.filterCollection=yt,ot=d.ejpredicate?d.ejpredicate:t.Predicate(d.field,d.operator,d.value,!d.matchcase),s=1;s<b.length;s++)ot=b[s].ejpredicate!=r?ot[b[s].predicate](b[s].ejpredicate):ot[b[s].predicate](b[s].field,b[s].operator,b[s].value,!b[s].matchcase);t.isNullOrUndefined(p[y].predicate[i.columnName])&&(p[y].predicate[i.columnName]={});p[y].filteredColumns=yt;p[y].predicate[i.columnName]=ni?{from:d.from,take:d.take}:ot;p[y].hiddenIdx=n.extend(!0,[],et);et=[]}}}else if(h=this._generateColCount(i.fieldName)-1,e=i.range,et=p[y].hiddenIdx,at=i.currentViewData,i.requestType.indexOf("filtering")>-1||i.requestType.indexOf("filterbycell")>-1||i.action.indexOf("clearfiltering")===-1){for(lt=o.filterSettings.filteredRange,at.length<1&&k.push(lt[lt.length-1].idx+1),a=0,rt=at.length;a<rt;a++)idx=lt.indexOf(at[a]),idx>-1&&k.push(lt[idx].idx);for(p[y].fltrdIdxes=k,v=e.startRow===0?0:e.startRow,f=v;f<=e.endRow;f++){for(st=!1,s=0,ut=k.length;s<ut;s++)k[s]==f&&(st=!0);st?(t.isNullOrUndefined(this._dataContainer.sheets[u][f])||t.isNullOrUndefined(this._dataContainer.sheets[u][f][0])||(delete this._dataContainer.sheets[u][f][0].isFilterHide,delete this._dataContainer.sheets[u][f][0].filterID,o._filterHRowsColl.indexOf(f)>-1&&o._filterHRowsColl.splice(o._filterHRowsColl.indexOf(f),1)),tt?(g.indexOf(f)>-1&&(this._refreshSHMergeCells(u,[f],1,"row","show"),g.splice(g.indexOf(f),1)),v=f===0?0:f-1,this.XLEdit.getPropertyValue(v,0,"hRow")&&(delete this._dataContainer.sheets[u][v][0].hRow,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1))):(this.XLFilter._isFilter=!0,this._showRow(f+1,f),this.XLFilter._isFilter=!1,l.indexOf(f)>-1&&l.splice(l.indexOf(f),1),o._isImported&&!o._isLoaded||it||(it=!it,this.performSelection({rowIndex:f,colIndex:h},{rowIndex:f,colIndex:h})))):(t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isRHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFHide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(f,0,"isFilterHide"))&&(this.XLEdit._updateDataContainer({rowIndex:f,colIndex:0},{dataObj:{isFilterHide:!0,filterID:i.tableID}}),l.indexOf(f)<0&&l.push(f),ft=!0),tt?(ft&&(g.push(f),ft=!1,this._refreshSHMergeCells(u,[f],1,"row","hide")),v=f===0?0:f-1,this.XLEdit._updateDataContainer({rowIndex:v,colIndex:0},{dataObj:{hRow:!0}}),l.indexOf(f)<0&&l.push(f)):(this.XLFilter._isFilter=!0,this._hideRow(f,f,"isFilterHide"),this.XLFilter._isFilter=!1,l.indexOf(f)===-1&&l.push(f)))}v=e.startRow===0?0:e.startRow-1;tt&&(!o._isImported||o._isLoaded)&&(this.refreshContent(u),this.performSelection({rowIndex:v,colIndex:h},{rowIndex:v,colIndex:h}));this.XLScroll._getRowHeights(u,v);fi=o.columns;i.action==="clearfiltering"&&(o._filteredByColor=-1,this._excelFilter.closeXFDialog());this.model.allowFiltering&&this.XLFilter._updateFilterIcons(v,e.startRow,h,i.action);p[y].hiddenIdx=n.extend(!0,[],et);et=[]}t.isNullOrUndefined(i)||i.action!=="filter"&&i.action!=="filtering"&&i.action!=="filterbycolor"?i.action==="clearfiltering"&&(i.tableID>-1&&o.filterSettings.tableRange[y].filterColumnName.pop(i.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"clear",i.tableID,i.filterCollection.length)):(i.tableID>-1&&o.filterSettings.tableRange[y].filterColumnName.push(i.fieldName),this.XLFilter._fltrRowHighlight(e.startRow,e.endRow,"add",i.tableID,i.filterCollection.length));this._dupDetails=!1;this.model.showRibbon&&this.model.allowFiltering&&(ti=n("#"+this._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton"),ii={rowIndex:this.getActiveCell().rowIndex,colIndex:this.getActiveCell().colIndex},this.XLRibbon._changeClrFltrStatus(ti,"button",ii));this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","vertical","filter")},_filterClose:function(t){this.model.allowFiltering&&!this._hasClass(t,"e-filterspan")&&n(t).parents(".e-excelfilter").length<1&&this._excelFilter._openedFltr&&n(this._excelFilter._openedFltr).is(":visible")&&(this._excelFilter.closeXFDialog(),this.XLFilter._isSearchEdit=!1)},showPager:function(n){this.model.showPager=n;settings=this.model.scrollSettings;this.element.find(".e-spreadsheetfooter").css("display",n?"block":"none");this._setSheetWidthHeight(this.getActiveSheetIndex(),{width:this._responsiveWidth,height:this._responsiveHeight})},_refreshClipboard:function(n,t){var r=this.model,i=this._id;n.length&&(r.allowFormatPainter&&r.allowCellFormatting||n.find("#"+i+"_Ribbon_home_Clipboard")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_1")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_Home_Clipboard_Cut")[t](),n.find("#"+i+"_Ribbon_home_Clipboard_Home_Clipboard_Copy")[t]())},_setModel:function(i){var f,a,g,h,w,c=this.getActiveSheetIndex(),e=this.model,y=e.scrollSettings,u=this._id,s=n("#"+u+"_Ribbon").ejRibbon("instance"),r=this.model.showRibbon?s.element:[],b,k,d,l,o,nt,tt,it,p,v;for(a in i){f=i[a];switch(a){case"allowClipboard":f?(this._refreshClipboard(r,"show"),t.isNullOrUndefined(this.XLClipboard)&&(this.XLClipboard=new t.spreadsheetFeatures.clipboard(this)),this.XLClipboard._initCopyPaste()):this._refreshClipboard(r,"hide");break;case"activeSheetIndex":this.gotoPage(f,!1);break;case"pageSettings":this.isUndefined(i.pageSettings.currentPage)||this.gotoPage(i.pageSettings.currentPage,!1);this.isUndefined(i.pageSettings.pageCount)||(this.getPager().ejPager("option","pageCount",i.pageSettings.pageCount),this._refreshSpreadSheetPager(!0));break;case"allowComments":f?(t.isNullOrUndefined(this.XLComment)&&(this.XLComment=new t.spreadsheetFeatures.comments(this)),r.length&&r.find("#"+u+"_Ribbon_review_Comments").show(),this.XLComment._updateCmntRibIcons()):this.model.showRibbon&&r.find("#"+u+"_Ribbon_review_Comments").hide();break;case"allowFormatPainter":e.allowCellFormatting&&(f?(e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),r.length&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").show()):r.length&&(e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),r.length&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").hide()));break;case"allowFormulaBar":f?(g=n("#"+this._id+"_formulabar"),g.length?this.showFormulaBar():this._renderFormulaBar(!0)):this.hideFormulaBar();this._setSheetWidthHeight(c,{width:this._responsiveWidth,height:this._responsiveHeight});break;case"allowHyperlink":r.length&&(f?r.find("#"+u+"_Ribbon_insert_Links").show():r.find("#"+u+"_Ribbon_insert_Links").hide());break;case"enableContextMenu":f&&t.isNullOrUndefined(this.XLCMenu)&&(this.XLCMenu=new t.spreadsheetFeatures.contextmenu(this),this.XLCMenu._initContextMenu(),this.XLCMenu._initColorDialog(),this.XLCMenu._initCMenuFooter());break;case"allowEditing":f?(t.isNullOrUndefined(this.XLEdit)&&(this.XLEdit=new t.spreadsheetFeatures.editing(this)),this.model.showRibbon&&r.length&&r.find("#"+u+"_Ribbon_home_Editing").show(),this.XLEdit._processEditing(),this.model.enableContextMenu&&this.XLCMenu._enableMenuOpt(["RenameSheet"],"contextMenuFooter")):(r.length&&r.find("#"+u+"_Ribbon_home_Editing").hide(),this.model.enableContextMenu&&this.XLCMenu._disableMenuOpt(["RenameSheet"],"contextMenuFooter"));break;case"allowResizing":f&&t.isNullOrUndefined(this.XLResize)&&(this.XLResize=new t.spreadsheetFeatures.resizing(this));break;case"allowDataValidation":f?(r.find("#"+u+"_Ribbon_data_DataTools").show(),t.isNullOrUndefined(this.XLValidate)&&(this.XLValidate=new t.spreadsheetFeatures.validation(this),this.XLRibbon._renderValDialog(this.XLRibbon._initValDialog()),this.XLValidate._addDVMethod())):r.length&&r.find("#"+u+"_Ribbon_data_DataTools").hide();break;case"allowConditionalFormats":f?(r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_ConditionalFormatting").show(),this.XLRibbon._initCFDialog(),t.isNullOrUndefined(this.XLCFormat)&&(this.XLCFormat=new t.spreadsheetFeatures.cFormat(this))):r.length&&r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_ConditionalFormatting").hide();break;case"allowSearching":this.model.allowSearching=f;f?(t.isNullOrUndefined(this.XLSearch)&&(this.XLSearch=new t.spreadsheetFeatures.findnreplace(this)),r.length&&r.find("#"+u+"_Ribbon_others_Editing").show()):r.length&&r.find("#"+u+"_Ribbon_others_Editing").hide();break;case"pictureSettings":for(w in f)switch(w){case"allowPictures":e.pictureSettings.allowPictures=f[w];f[w]?(t.isNullOrUndefined(this.XLShape)&&(this.XLShape=new t.spreadsheetFeatures.shape(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Illustrations").show()):r.length&&r.find("#"+u+"_Ribbon_insert_Illustrations").hide()}break;case"showRibbon":this.model.showRibbon=f;b=n("#"+u+"_Ribbon");f?(b.length?b.show():this.XLRibbon._renderRibbon(!0),s=n("#"+u+"_Ribbon").ejRibbon("instance"),r=s.element,r[0].style.overflow==="hidden"&&(r[0].style.overflow="")):b.hide();this.refreshSpreadsheet();break;case"exportSettings":for(h in f)switch(h){case"allowExporting":e.exportSettings.allowExporting=f[h];f[h]?(r.length&&r.find("#saveas_backStageTab").show(),t.isNullOrUndefined(this.XLExport)&&(this.XLExport=new t.spreadsheetFeatures.exporting(this))):r.length&&r.find("#saveas_backStageTab").hide();break;case"excelUrl":e.exportSettings.excelUrl=f[h];break;case"csvUrl":e.exportSettings.csvUrl=f[h];break;case"pdfUrl":e.exportSettings.pdfUrl=i[a][h]}break;case"allowKeyboardNavigation":f&&t.isNullOrUndefined(this.XLCellNav)&&(this.XLCellNav=new t.spreadsheetFeatures.cellNavigation(this));break;case"enablePivotTable":f?(t.isNullOrUndefined(this.XLPivot)&&(this.XLPivot=new t.spreadsheetFeatures.pivot(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").show()):(r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").hide(),this.hideActivationPanel(),this.XLRibbon._toggleAnalyzeTab(),this.getSheetElement(c).find(".e-ss-activepivot").removeClass("e-ss-activepivot"));break;case"allowAutoFill":f?(t.isNullOrUndefined(this.XLDragFill)?(this.XLDragFill=new t.spreadsheetFeatures.dragFill(this),this._createAutoFillElement()):this.getAutoFillElem().show(),this.XLDragFill.positionAutoFillElement()):this.getAutoFillElem().hide();break;case"autoFillSettings":for(autofillProp in f)switch(autofillProp){case"fillType":e.allowAutoFill&&(e.autoFillSettings.fillType=f[autofillProp]);break;case"showFillOptions":e.allowAutoFill&&(e.autoFillSettings.showFillOptions=f.showFillOptions)}break;case"allowSelection":f&&t.isNullOrUndefined(this.XLSelection)&&(this.XLSelection=new t.spreadsheetFeatures.selection(this),this._initSelection());break;case"allowDragAndDrop":f&&t.isNullOrUndefined(this.XLDragDrop)&&(this.XLDragDrop=new t.spreadsheetFeatures.dragAndDrop(this));break;case"allowCellFormatting":f?((e.allowConditionalFormats||e.allowFormatAsTable)&&r.find("#"+u+"_Ribbon_home_Styles").show(),r.length&&(r.find("#"+u+"_Ribbon_home_Font").show(),r.find("#"+u+"_Ribbon_home_Number").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_TopAlign").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_MiddleAlign").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_BottomAlign").show(),r.find("#"+u+"_Ribbon_separator_bottom").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignLeft").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignCenter").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignRight").show(),r.find("#"+u+"_Ribbon_separator_right").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_DecreaseIndent").show(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_IncreaseIndent").show(),r.find("#"+u+"_Ribbon_home_separator_right").show(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_CellStyles").show(),e.allowFormatPainter&&r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").show(),e.allowClipboard&&r.find("#"+u+"_Ribbon_home_Clipboard").show()),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),t.isNullOrUndefined(this.XLCellFrmtDlg)&&(this.XLCellFrmtDlg=new t.spreadsheetFeatures.formatCellDialog(this)),n("#"+u+"_formatdlg").length===0&&this.XLCellFrmtDlg._renderCellFrmtDlg()):r.length&&(r.find("#"+u+"_Ribbon_home_Font").hide(),r.find("#"+u+"_Ribbon_home_Number").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_TopAlign").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_MiddleAlign").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_BottomAlign").hide(),r.find("#"+u+"_Ribbon_separator_bottom").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignLeft").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignCenter").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_AlignRight").hide(),r.find("#"+u+"_Ribbon_separator_right").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_DecreaseIndent").hide(),r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_IncreaseIndent").hide(),r.find("#"+u+"_Ribbon_home_separator_right").hide(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_CellStyles").hide(),r.find("#"+u+"_Ribbon_home_Clipboard_Home_Clipboard_FormatPainter").hide(),e.allowClipboard||r.find("#"+u+"_Ribbon_home_Clipboard").hide(),e.allowConditionalFormats||e.allowFormatAsTable||r.find("#"+u+"_Ribbon_home_Styles").hide());break;case"allowImport":r.length&&(f?r.find("#open_backStageTab").show():r.find("#open_backStageTab").hide());break;case"importSettings":for(importProp in f)switch(h){case"importMapper":e.importSettings.importMapper=f[importProp];break;case"importUrl":e.importSettings.importUrl=f[importProp];break;case"password":e.importSettings.password=f[importProp]}break;case"allowSorting":if(k=document.getElementById(u+"number_MenuItem"),d=document.getElementById(u+"string_MenuItem"),f?(p=n("#"+u+"_Ribbon_SortFilter").data("ejMenu"),t.isNullOrUndefined(this.XLSort)&&(this.XLSort=new t.spreadsheetFeatures.sorting(this)),r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_1").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()),p.enableItemByID("Ribbon_SortAtoZ"),p.enableItemByID("Ribbon_SortZtoA")):r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_1").hide(),this.model.allowFiltering||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide())),this.model.allowFiltering)for(o=0;o<3;o++)t.isNullOrUndefined(k)||(k.childNodes[o].style.display=this.model.allowSorting?o===2?"block":"inline":"none"),t.isNullOrUndefined(d)||(d.childNodes[o].style.display=this.model.allowSorting?o===2?"block":"inline":"none");break;case"formatSettings":if(e.allowCellFormatting)for(l in f)switch(l){case"allowFontFamily":e.formatSettings.allowFontFamily=f[l];r.length&&(f[l]?r.find("#"+u+"_Ribbon_home_Font_Home_Font_FontFamily").show():r.find("#"+u+"_Ribbon_home_Font_Home_Font_FontFamily").hide());break;case"allowDecimalPlaces":e.formatSettings.allowDecimalPlaces=f[l];r.length&&(f[l]?(r.find("#"+u+"_Ribbon_home_Number_Home_Number_IncreaseDecimal").show(),r.find("#"+u+"_Ribbon_home_Number_Home_Number_DecreaseDecimal").show(),r.find("#"+u+"_Ribbon_separator_Home_Number_CommaStyle").show()):(r.find("#"+u+"_Ribbon_home_Number_Home_Number_IncreaseDecimal").hide(),r.find("#"+u+"_Ribbon_home_Number_Home_Number_DecreaseDecimal").hide(),r.find("#"+u+"_Ribbon_separator_Home_Number_CommaStyle").hide()));break;case"allowCellBorder":e.formatSettings.allowCellBorder=f[l];r.length&&(f[l]?(r.find("#"+u+"_Ribbon_separator_border").show(),r.find("#"+u+"_Ribbon_home_Font_Home_Font_Border").show()):(r.find("#"+u+"_Ribbon_separator_border").hide(),r.find("#"+u+"_Ribbon_home_Font_Home_Font_Border").hide()))}break;case"sheets":for(o=0,nt=f.length;o<nt;o++)for(tt in f[o]){if(this.model.sheetCount<o+1&&f.length>c)return;switch(tt){case"showGridlines":o+1===c?this._showGridlines(f[o].showGridlines,c):this.getSheet(o+1).showGridlines=f[o].showGridlines;break;case"showHeadings":o+1===c?this._showHeadings(f[o].showHeadings,c):this.getSheet(o+1).showHeadings=f[o].showHeadings}}break;case"scrollSettings":y={};it=e.scrollSettings.isResponsive;t.isNullOrUndefined(i.scrollSettings)||(t.isNullOrUndefined(i.scrollSettings.allowScrolling)||(e.scrollSettings.allowScrolling=i.scrollSettings.allowScrolling),t.isNullOrUndefined(i.scrollSettings.allowVirtualScrolling)||(e.scrollSettings.allowVirtualScrolling=i.scrollSettings.allowVirtualScrolling),t.isNullOrUndefined(i.scrollSettings.isResponsive)||(it=e.scrollSettings.isResponsive=i.scrollSettings.isResponsive),t.isNullOrUndefined(i.scrollSettings.scrollMode)||(e.scrollSettings.scrollMode=i.scrollSettings.scrollMode==="normal"?t.Spreadsheet.scrollMode.Normal:t.Spreadsheet.scrollMode.Infinite),t.isNullOrUndefined(i.scrollSettings.width)||(e.scrollSettings.width=i.scrollSettings.width),t.isNullOrUndefined(i.scrollSettings.height)||(e.scrollSettings.height=i.scrollSettings.height));e.scrollSettings.isResponsive||(n.extend(!0,y,this.model.scrollSettings),this.element.height(y.height).width(y.width),n("#"+this._id+"_Ribbon").ejRibbon("option",{width:y.width}),this._updateResponsiveSettings(),this._setSheetWidthHeight(c,{height:this._responsiveHeight,width:this._responsiveWidth}));break;case"allowFiltering":f?(p=n("#"+u+"_Ribbon_SortFilter").data("ejMenu"),r.length&&(r.find("#"+u+"_Ribbon_data_SortFilter_2").show(),r.find("#"+u+"_Ribbon_data_Sort").show(),r.find("#"+u+"_Ribbon_home_Editing_1").show()),p.enableItemByID("Ribbon_Filter"),t.isNullOrUndefined(this.XLFilter)&&(this.XLFilter=new t.spreadsheetFeatures.filter(this)),this.XLFilter._renderExcelFilter()):r.length&&(this.model.allowSorting||(r.find("#"+u+"_Ribbon_data_Sort").hide(),r.find("#"+u+"_Ribbon_home_Editing_1").hide()),r.find("#"+u+"_Ribbon_data_SortFilter_2").hide());break;case"allowInsert":f?(r.length&&!e.allowDelete&&r.find("#"+u+"_Ribbon_others_Cells").show(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_1").show(),this.getPager().find(".e-new").removeClass("e-disable"),e.enableContextMenu&&this.XLCMenu._enableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter")):(r.length&&!e.allowDelete&&r.find("#"+u+"_Ribbon_others_Cells").hide(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_1").hide(),this.getPager().find(".e-new").addClass("e-disable"),e.enableContextMenu&&this.XLCMenu._disableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter"));break;case"allowDelete":f?(!e.allowInsert&&r.length&&r.find("#"+u+"_Ribbon_others_Cells").show(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_2").show(),e.enableContextMenu&&this._getSheetNames(!0).length>1&&this.XLCMenu._enableMenuOpt(["DeleteSheet"],"contextMenuFooter")):(!e.allowInsert&&r.length&&r.find("#"+u+"_Ribbon_others_Cells").hide(),r.length&&r.find("#"+u+"_Ribbon_others_Cells_2").hide(),e.enableContextMenu&&this.XLCMenu._disableMenuOpt(["DeleteSheet"],"contextMenuFooter"));break;case"allowFreezing":f?(t.isNullOrUndefined(this.XLFreeze)&&(this.XLFreeze=new t.spreadsheetFeatures.freezepane(this),this.XLFreeze._initFreeze()),r.length&&r.find("#"+u+"_Ribbon_others_Window").show()):r.length&&r.find("#"+u+"_Ribbon_others_Window").hide();break;case"allowMerging":r.length&&(f?r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_Merge").show():r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_Merge").hide());break;case"allowWrap":r.length&&(f?r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_WrapText").show():r.find("#"+u+"_Ribbon_home_Alignment_Home_Alignment_WrapText").hide());break;case"allowUndoRedo":r.length&&(f?r.find("#"+u+"_Ribbon_home_Actions").show():r.find("#"+u+"_Ribbon_home_Actions").hide());break;case"frozenRows":e.allowFreezing&&this.XLFreeze.freezeRows(f);break;case"frozenColumns":e.allowFreezing&&this.XLFreeze.freezeColumns(f);break;case"freezePanes":e.allowFreezing&&this.XLFreeze.freezePanes(f.rowIndex,f.colIndex);case"allowFormatAsTable":f?(e.enablePivotTable||r.find("#"+u+"_Ribbon_insert_Tables").show(),t.isNullOrUndefined(this.XLFormat)&&(this.XLFormat=new t.spreadsheetFeatures.cellFormatting(this)),r.length&&(r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_FormatAsTable").show(),r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_Table").show())):r.length&&(e.enablePivotTable||r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.find("#"+u+"_Ribbon_home_Styles_Home_Styles_FormatAsTable").hide(),r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_Table").hide());break;case"enablePivotTable":r.length&&(f?(!e.allowFormatAsTable&&r.length&&r.find("#"+u+"_Ribbon_insert_Tables").show(),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").show()):(!e.allowFormatAsTable&&r.length&&r.find("#"+u+"_Ribbon_insert_Tables").hide(),r.length&&r.find("#"+u+"_Ribbon_insert_Tables_Insert_Tables_PivotTable").hide()));break;case"allowAutoSum":r.length&&(f?r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_AutoSum").show():r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_AutoSum").hide());break;case"allowCharts":f?((t.isNullOrUndefined(this.XLChart)||t.isNullOrUndefined(this.XLShape))&&(this.XLShape=new t.spreadsheetFeatures.shape(this),this.XLChart=new t.spreadsheetFeatures.chart(this)),r.length&&r.find("#"+u+"_Ribbon_insert_Charts").show()):r.length&&r.find("#"+u+"_Ribbon_insert_Charts").hide();break;case"printSettings":for(v in f)switch(v){case"allowPrinting":e.printSettings.allowPrinting=f[v];f[v]?(this.XLPrint=new t.spreadsheetFeatures.print(this),r.length&&(r.find("#"+u+"_Ribbon_pagelayout_Print").show(),r.find("#print_backStageTab").show())):r.length&&(r.find("#print_backStageTab").hide(),r.find("#"+u+"_Ribbon_pagelayout_Print").hide());break;case"allowPageSize":e.printSettings.allowPageSize=f[v];r.length&&(f[v]?r.find("#"+u+"_Ribbon_pagelayout_PageLayout").show():r.find("#"+u+"_Ribbon_pagelayout_PageLayout").hide())}break;case"allowLockCell":r.length&&(f?(r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_ProtectSheet").show(),r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_LockCell").show()):(r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_ProtectSheet").hide(),r.find("#"+u+"_Ribbon_review_Changes_Review_Changes_LockCell").hide()));break;case"undoRedoStep":this.undoRedoStep=f;break;case"enableTouch":this._wireTouchEvts(f?"_on":"_off");break;case"showPager":this.showPager(i[a]);this._refreshSpreadSheetPager();break;case"allowOverflow":this._refreshOverflow();break;case"allowClear":r.length&&(f?r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_Clear").show():r.find("#"+u+"_Ribbon_home_Editing_Home_Editing_Clear").hide());break;case"isReadOnly":this._readOnly();break;case"locale":this.model.locale=i[a];this._destroy();this.model.sheets.splice(0,1);this._init();break;case"allowCellType":f&&(this.XLCellType=new t.spreadsheetFeatures.cellType(this))}}r.length&&(e.allowAutoSum||e.allowFiltering||e.allowUndoRedo||e.allowSorting||e.allowClipboard||e.allowFormatPainter||e.allowCellFormatting||e.allowMerging||e.allowWrap||e.allowConditionalFormats||e.allowFormatAsTable?s.showTab("HOME"):s.hideTab("HOME"),e.allowFormatAsTable||e.allowPictures||e.allowHyperlink||e.allowCharts?s.showTab("INSERT"):s.hideTab("INSERT"),e.allowDataValidation||e.allowFiltering||e.allowSorting?s.showTab("DATA"):s.hideTab("DATA"),e.allowPrinting?s.showTab("PAGELAYOUT"):s.hideTab("PAGELAYOUT"),e.allowComments||e.allowLockCell?s.showTab("REVIEW"):s.hideTab("REVIEW"),e.allowFreezing||e.allowInsert||e.allowDelete||e.allowSearching?s.showTab("OTHERS"):s.hideTab("OTHERS"))},"import":function(t){if(this.model.allowImport){!t.dataContainer&&this.model.allowCellFormatting&&this.XLFormat&&this.getObjectLength(this.XLFormat._customFontFamily)>0&&(t.dataContainer=JSON.stringify({customFontFamily:this.XLFormat._customFontFamily}));var r=this,i={type:"POST",data:this._import(t),async:this.isUndefined(t.async)?!0:t.async,url:this.model.importSettings.importMapper,success:function(n){r._importSuccess(n)},error:function(n,t){r._importFailed({type:t,xhr:{status:n.status,statusText:n.statusText}})}};(this._browserDetails.name!=="msie"||this._browserDetails.version!=="9.0"||i.data.append)&&(i.processData=!1,i.contentType=!1);n("#"+this._id+"_Ribbon_BackStage").hide();r.showWaitingPopUp();n.ajax(i)}},_import:function(n){if(window.FormData&&this._isObject(n)){var t=new FormData;for(prop in n)prop!="async"&&t.append(prop,n[prop]);return t}return n},_importSuccess:function(n){var t=["UnsupportedFile","IncorrectPassword","InvalidUrl","NeedPassword"];if(t.indexOf(n)>-1){switch(n){case t[0]:case t[1]:case t[2]:this._showAlertDlg("Alert",n,"",null,110);break;case t[3]:this._showDialog(this._id+"_ImportPasswordDialog");this.model.importSettings.password=""}this.hideWaitingPopUp()}else this.loadFromJSON(JSON.parse(n))},loadFromJSON:function(t){this.isImport=!0;n("#"+this._id+"_file").ejUploadbox("option","autoUpload",!0);var i,u,r=1,f;if(this._isSheetReq)i=Number(this.getObjectKeys(t.dataContainer.sheets)[0]),this._refreshImpStyles(t.dataContainer.hashCode),this._impData.dataContainer=n.extend(!0,{},t.dataContainer),this._impData.dataContainer.sheets=this._dataContainer.sheets,this._impData.dataContainer.cellType=this._dataContainer.cellType,this._impData.dataContainer.sheets[i]=t.dataContainer.sheets[i],this._impData.model.sheets[i]=t.sheet,this._dataContainer=n.extend(!0,{},this._impData.dataContainer),this._dataContainer.sheetCellType={},this._refreshModel(t.sheet,!0,i),this._sheetSettings(i),this._intrnlReq||this.gotoPage(i,!1),this._isSheetReq=!1;else if(this.model.scrollSettings.allowVirtualScrolling||(u=this._getMaxRowColCnt(t.model.sheets,!0)),this.model.scrollSettings.allowVirtualScrolling||t.dataContainer.sharedData.length<50001&&u.rowCount<10001&&u.colCount<126){if(this._impData=t,f={importData:t},this._trigger("onImport",f))return;if(this._isInitLoad)this._initBase();else{for(this._destroy(),this._refreshModel(t.model),this._dataContainer=n.extend(!0,{},t.dataContainer),this._dataContainer.sheetCellType={},this._initCSSTag();r<=this.model.sheetCount;)this._sheetSettings(r),this.model.scrollSettings.allowVirtualScrolling||this.model.importSettings.allowSheetOnDemand||this._initSheet(r),this._newSIndex++,r++;this._refreshNameMngr(t.model.nameManager);this.gotoPage(this.getActiveSheetIndex(),!1)}this._trigger("loadComplete");this.clearUndoRedo()}else this._showAlertDlg("Alert","HugeDataAlert");this._intrnlReq||(this.isImport=!1);this._intrnlReq=!1;this._renderDDownList();this.hideWaitingPopUp()},_importFailed:function(n){var t={failureType:n.type};n.xhr?(t.status=n.xhr.status,t.statusText=n.xhr.statusText):t.statusText=n.error;this.hideWaitingPopUp();this._trigger("openFailure",t)},_importSheet:function(n,t){var i={},r=this.model.importSettings;this._isSheetReq=!0;i={sheetIndex:n,allowSheetOnDemand:r.allowSheetOnDemand,password:this._encrypt(r.password),async:t};i.dataContainer=JSON.stringify({hashCode:this._dataContainer.hashCode,sharedData:this._dataContainer.sharedData,valData:this._dataContainer.valData,cFormatData:this._dataContainer.cFormatData});this["import"](i);this.getSheet(n)._isRequested=!0},_refreshModel:function(n,t,i){var u,e,r,f=1;if(n)if(t)r=this.model.sheets[this._getSheetIndex(i)],r.rowCount=n.rowCount||this.defaults.rowCount,r.colCount=n.colCount||this.defaults.colCount;else{for(this.model.sheetCount=n.sheetCount||this.defaults.sheetCount,this.model.activeSheetIndex=n.activeSheetIndex||this.defaults.activeSheetIndex,this.model.rowHeight=n.rowHeight||this.defaults.rowHeight,this.model.columnWidth=n.columnWidth||this.defaults.columnWidth,this.model.sheets=[{}],u=n.sheets.length;f<u;)r=n.sheets[f],e={rowCount:r.rowCount||this.defaults.rowCount,colCount:r.colCount||this.defaults.colCount},this.model.sheets.push(e),f++;n.nameManager&&n.nameManager.length&&(this.model.nameManager=n.nameManager)}else u=this.model.sheets.length,this.model.sheetCount<u&&(this.model.sheetCount=u);this.model.apWidth===300&&this.model.activationPanelWidth!==300?this.model.apWidth=this.model.activationPanelWidth:this.model.apWidth!==300&&this.model.activationPanelWidth===300&&(this.model.activationPanelWidth=this.model.apWidth)},_refreshImpStyles:function(n){for(var r,t,i=0,u=n.length;i<u;)t=n[i],this._dataContainer.hashCode.indexOf(t)===-1&&(t.indexOf("e-format")===-1?(this._dataContainer.hashCode.push(t),t.length<25&&this.XLFormat._writeCssRules(t,this.XLFormat._getCssPropertyAsString({border:this.XLFormat.getBorderFromHashCode(t)}))):(r=this.XLFormat.getFormatFromHashCode(t),this.XLFormat._createFormatClass(r))),i++},_refreshImpSheets:function(t){var i=this._impData.model.sheets[t];this._refreshImpCells(t);this._refreshImpCF(t);this.model.allowMerging&&i.mergedCells&&this._refreshImpMC(i.mergedCells);this.model.allowFiltering&&i.filterSettings&&i.filterSettings.range&&this.XLFilter._filterCellRange(t,i.filterSettings.range);this._refreshImpHC(i.hideColsCollection);this._refreshImpHR(i.hideRowsCollection);this._refreshImpTable(i.tableManager);this._refreshOverflow();this.model.allowCellType&&this._refreshSheetCellTypes(this._impData.dataContainer.sheetCellType,t);this._refreshImpCharts(i.shapeMngr.chart);this._refreshImpPics(i.shapeMngr,t);this._refreshImpPvts(i.pivotMngr,t);i.showGridlines===!1&&n("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").ejCheckBox({checked:i.showGridlines});i.isSheetProtected&&this.protectSheet(!0)},_refreshImpCells:function(n){for(var t,i=0,u=this.getSheet(n).usedRange,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"value",n,!0),f=r.length;i<f;)t=r[i],this.XLEdit._refreshCalcEngine(t.rowIdx,t.colIdx,!0,t.value,n),i++;if(this.model.allowCellFormatting&&this.model.formatSettings.allowCellBorder)for(i=0,r=this.XLEdit._getPropWithCellIdx([0,0,u.rowIndex,u.colIndex],"borders",n),f=r.length;i<f;)t=r[i],this.XLFormat.applyBorder(t.value,[t.rowIdx,t.colIdx,t.rowIdx,t.colIdx]),i++},_refreshSheetCellTypes:function(n,t){var r=[],i,u;if(!(this.getObjectLength(n)<1)){for(i=1,u=this.getObjectLength(n[t]);i<=u;i++)r.push({range:n[t][i].settings.range,settings:n[t][i].settings});this.XLCellType._rangeCellTypes(r,t,!0)}},_refreshImpCF:function(n){if(this.model.allowConditionalFormats)for(var t,r=this._impData.dataContainer.cFormatData.length,i=0;i<r;i++)t=this._impData.dataContainer.cFormatData[i].split("_"),idx=Number(t[4]),idx===n&&(this.XLCFormat._cFormat(t[0],t[1],t[2],t[3],t[5],idx,this.getRangeIndices(t[5])),this._impData.dataContainer.cFormatData.splice(i,1),r=this._impData.dataContainer.cFormatData.length,i--)},_refreshImpMC:function(n){var t,i=n.length;if(i)while(i--)t=n[i],t.isCenterAlign&&(this.mergeCenter=!0),this.mergeCells(t.range,!0),this.mergeCenter=!1},_refreshImpHC:function(n){var t,r=this.getObjectKeys(n),i=r.length;if(i)while(i--)t=parseInt(r[i]),this._hideColumn(t,t)},_refreshImpResRowHght:function(n){for(var e,f,s,t,u,o=this.getSheet(n),v=o._restrictedHeightRows,p=this._dataContainer.sheets[n],w=this._dataContainer.hashCode,i,h,c=!0,y=this._impData&&this._impData.model.sheets[n]&&this._impData.model.sheets[n].mergedCells?this._impData.model.sheets[n].mergedCells:[],l=[],a,r=0;r<y.length;r++)i=this.getRangeIndices(y[r].range),l.push(i);for(f=this.element.find("#"+this._id+"_emptyDiv"),e=0;e<v.length;e++){u=v[e];cellsData=p[u];for(t in cellsData)if((a=this._dataContainer.sharedData[cellsData[t].value],a)&&(hashIdx=cellsData[t].formats,hashIdx)){if(s=w[hashIdx],cellsData[t].wrap){for(r in l)if(i=l[r],i[0]<=u&&i[2]>=u&&i[1]<=t&&i[3]>=t){c=!1;break}c&&(f.width(o.columnsWidthCollection[t]-3),s+=" e-sswraptext")}this.addClass(f[0],s);f.text(a);h=f[0].offsetHeight+1;o.rowsHeightCollection[u]<h&&(o.rowsHeightCollection[u]=h);this._refreshGlobalSpan(null,!0);c=!0}}},_refreshImpHR:function(n){for(var t,i,u=this.getActiveSheetIndex(),s=this.getSheet(u),n=n||[],f=this.getRows(u),h=f[1],c=f[0],e=this._getJSSheetRowHeaderContent(u),l=e.find("tr"),r=0,o=n.length;r<o;r++)t=parseInt(n[r]),i=t?t-1:0,this.isUndefined(this.XLEdit.getPropertyValue(i,0,"isRHide"))&&this.XLEdit._updateDataContainer({rowIndex:i,colIndex:0},{dataObj:{hRow:!0}}),this.model.scrollSettings.allowVirtualScrolling?this.addClass(e.find("[idx ="+i+"] .e-rowheader")[0],"e-hrow"):(this.addClass(l.find(".e-rowheader")[i],"e-hrow"),this.addClass(h[t],"e-r-hide"),this.addClass(c[t],"e-r-hide")),this.XLScroll._getRowHeights(u,s.hideRowsCollection.sort()[0])},_refreshImpTable:function(n){var t,i,r,u=this.getObjectLength(n);if(this.model.allowFormatAsTable&&u)while(u--)r=n[u],t=r.range,i=this.XLFormat._getTableLayoutFromName(r.formatName),i||(i=this.XLFormat._formatAsTableStyle,r.formatName=i.formatName),this.XLFormat.createTable({header:!0,name:"Table"+this._tableCnt,format:i.format,formatName:r.formatName},this._getAlphaRange(this.getActiveSheetIndex(),t[0],t[1],t[2],t[3]))},_refreshImpCharts:function(n){if(this.model.allowCharts)for(var i,t,r=0,u=this.getObjectLength(n);r<u;)t=n["chart"+r],i=this.getSheet(t.dataSheetIdx),t.dataSheetIdx!=this.getActiveSheetIndex()&&i._isImported&&!i._isRequested&&(this._intrnlReq=!0,this._importSheet(t.dataSheetIdx,!1)),this.XLChart.createChart(t.range,{type:t.commonSeriesOptions.type,enable3D:t.enable3D,marker:t.commonSeriesOptions.marker,top:t.top,left:t.left,height:t.size.height,width:t.size.width,title:t.title,legend:t.legend,primaryYAxis:t.primaryYAxis,primaryXAxis:t.primaryXAxis,dataSheetIdx:t.dataSheetIdx}),r++},_refreshImpPics:function(n,t){if(this.model.pictureSettings.allowPictures)for(var i,r=0,u=this.getObjectLength(n.picture);r<u;)i=n.picture["picture"+r],i.sheetIdx=t,this.getSheet(t)._isUpdated?(i.imgData=n.sharedPics[i.data],this.XLShape._refreshPictureElement(i)):this.XLShape._createPicture(t,null,n.sharedPics[i.data],i.top,i.left,i.width,i.height,null,i.bcolor,i.bstyle,i.bwidth,i),r++},_refreshImpPvts:function(n,t){if(this.model.enablePivotTable&&n)for(var i,r=0,e=this.getObjectLength(n.pivot),u=this.getObjectKeys(n.pivot),f;r<e;)i=n.pivot[u[r]],f={rows:i.rows,columns:i.columns,values:i.values,filters:i.filters},this.getSheet(t)._isUpdated?this.XLPivot._refreshPivotElement(i.dataSheetName+"!"+this._getProperAlphaRange(this._getSheetIndexByName(i.dataSheetName),i.dataRange[0],i.dataRange[1],i.dataRange[2],i.dataRange[3]),this.getSheet(i.sheetIdx).sheetInfo.text+"!"+this._getProperAlphaRange(i.sheetIdx,i.rowIndex,i.colIndex,i.rowIndex,i.colIndex),u[r],f,i):this.XLPivot.createPivotTable(i.dataSheetName+"!"+this._getProperAlphaRange(this._getSheetIndexByName(i.dataSheetName),i.dataRange[0],i.dataRange[1],i.dataRange[2],i.dataRange[3]),this.getSheet(i.sheetIdx).sheetInfo.text+"!"+this._getProperAlphaRange(i.sheetIdx,i.rowIndex,i.colIndex,i.rowIndex,i.colIndex),u[r],f,i),r++;this._isExport||this._getContent(t).find(".e-ss-activepivot").removeClass("e-ss-activepivot");this.hideActivationPanel()},_refreshNameMngr:function(t){t=t||this.model.nameManager;var i=t.length;if(this.model.showRibbon){if(i)while(i--)this.XLRibbon._updateNamedRanges(t[i].name,t[i].refersto,!0);n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:t});this.XLRibbon._updateUseInFormulaTrgt()}this.XLEdit._refreshAutoComplete()},_getBorderInput:function(n){n=n.split("_");for(var t=4,i={},r=["top","right","bottom","left"];t--;)n[t].length&&(i[r[t]]=n[t]);return i},_refreshHashCode:function(n){n=n||this._dataContainer.hashCode;for(var t,i=n.length;i--;)t=n[i],t.indexOf("e-format")===-1&&t.indexOf("e-border")===-1&&(n[i]="")},clearUndoRedo:function(){this._undoCollection=[];this._redoCollection=[];this._updateUndoRedoIcons()},_initializePicture:function(n){this._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content").append(t.buildTag("div.e-ss-imgvisual"))},_getShapePositionInManager:function(n,t,i,r){for(var o=this.getActiveSheetIndex(),f=this._dataContainer.sheets[o][n][t],u=0,e=f.length;u<e;u++)if(f[r][u].id===i)break;return u},_swapVal:function(n){var t=n.prev;n.prev=n.cur;n.cur=t},_getValue:function(n,t){for(var i,r=n.length;r--;)if(i=n[r],i.value===t)return i.value},_isRowViewable:function(n,t){var i=this.getSheet(n),r=i._isVPRendered;return this.model.scrollSettings.allowVirtualScrolling&&(r=i._virtualRowIdx.indexOf(t)>-1),r},_isColumnViewable:function(){return!0},_undoRedoOperation:function(t){var r,u,i=this.getActiveCell();(t.which===90||t.keyCode===90)&&t.ctrlKey?(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?(r=this.XLEdit.getCurrentEditCellData(),r!==this._cureditedCell&&(u=r,t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._cureditedCell:n("#"+this._id+"_Edit")[0].textContent=this._cureditedCell,this.model.allowFormulaBar&&this._getInputBox().val(this._cureditedCell),this._undoInputobj={value:u,rowIndex:i.rowIndex,colIndex:i.colIndex})):(this._isUndo=!0,this._performUndoRedo())):(t.which===89||t.keyCode===89)&&t.ctrlKey&&(t.preventDefault(),t.target.id.indexOf("_Edit")>-1||t.target.id.indexOf("_input")>-1?i.rowIndex===this._undoInputobj.rowIndex&&i.colIndex===this._undoInputobj.colIndex&&(t.target.id.indexOf("_Edit")>-1?t.target.textContent=this._undoInputobj.value:n("#"+this._id+"_Edit")[0].textContent=this._undoInputobj.value,this.model.allowFormulaBar&&this._getInputBox().val(this._undoInputobj.value)):(this._isUndo=!1,this._performUndoRedo()))},_performUndoRedo:function(){var n=this._isUndo?this._undoCollection.pop():this._redoCollection.pop(),i,r;if(!t.isNullOrUndefined(n)){n.sheetIndex!==this.getActiveSheetIndex()&&this.gotoPage(n.sheetIndex,null);this._isUndoRedo=!0;switch(n.reqType){case"auto-fill":this._undoForAutoFill(n);break;case"auto-sum":this._undoForAutoSum(n);break;case"cell-format":this._undoForFormat(n);break;case"cell-styles":this._undoForStyle(n);break;case"clear-all":this._undoForClAll(n);break;case"clear-comment":this._undoForClComment(n);break;case"clear-content":this._undoForClContent(n);break;case"clear-format":this._undoForClFormat(n);break;case"clear-link":this._undoForCLLink(n);break;case"comment":this._undoForComment(n);break;case"cond-format":this._undoForCondFormat(n);break;case"copy-paste":this._undoForCopyPaste(n);break;case"cut-paste":this._undoForCutPaste(n);break;case"delete":this._undoForDel(n);break;case"edit":this._undoForEdit(n);break;case"filter":this._undoForFilter(n);break;case"filterbycolor":this._undoForFilterByColor(n);break;case"find-replace":this._undoForFind(n);break;case"format-painter":this._undoForFormatPaint(n);break;case"format-table":this._undoForFormatTable(n);break;case"hyperlink":this._undoForHyperlink(n);break;case"insert":this._undoForIns(n);break;case"merge-cells":this._undoForMerge(n);break;case"paging":r=n.nSheetIndex;n.nSheetIndex=n.sheetIndex;n.sheetIndex=r;break;case"pivotgrid":this._undoForPivot(n);break;case"resize-column":this._undoForResizeCol(n);break;case"resize-row":this._undoForResizeRow(n);break;case"resize-fit-height":this._undoForResizeFHeight(n);break;case"resize-fit-width":this._undoForResizeFWidth(n);break;case"reorder-cells":this._undoForReOrder(n);break;case"show-hide":this._undoForShowHide(n);break;case"shape":this._undoForShape(n);break;case"sort":this._undoForSort(n);break;case"sortbycolor":this._undoForSortByColor(n);break;case"textwrap":this._undoForTextWrap(n);break;case"validation":this._undoForValidation(n)}if(this._isUndo?this._redoCollection.push(n):this._undoCollection.push(n),i={sheetIdx:n.sheetIndex,reqType:this._isUndo?"undo":"redo",operation:n},this._undoCollection.length>this.undoRedoStep&&this._undoCollection.splice(0,1),this._redoCollection.length>this.undoRedoStep&&this._redoCollection.splice(0,1),this._updateUndoRedoIcons(),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._isUndoRedo=!1,this._isUndo=!1,this.model.allowSelection&&n.reqType!="shape"&&this.XLSelection._refreshBorder(),this._trigActionComplete(i))return}},_undoForAutoFill:function(t){var i=this.getSheet(t.sheetIndex);this._isUndo?(this.clearRangeData(t.range,this._cellProp),this.model.allowCellFormatting&&(this.XLFormat.removeStyle(t.range),this.XLFormat.updateFormat(t.bFormat,t.range)),this.updateData(n.extend(!0,[],t.bData),t.range),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.bdData),t.bRange),t.colSel?this.XLSelection.selectColumns(i._startCell.colIndex,i._endCell.colIndex):t.rowSel?this.XLSelection.selectRows(i._startCell.rowIndex,i._endCell.rowIndex):this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.bRange[2],colIndex:t.bRange[3]})):(this.model.allowCellFormatting&&this.XLFormat.updateFormat(t.aFormat,t.range),this.updateData(n.extend(!0,[],t.aData),t.range),this.XLCFormat.refreshCFormat(),t.actionType=="flash-fill"&&this.updateData(n.extend(!0,[],t.adData),t.bRange),this.performSelection({rowIndex:t.bRange[0],colIndex:t.bRange[1]},{rowIndex:t.range[2],colIndex:t.range[3]}))},_undoForAutoSum:function(t){var e=this._dataContainer.sheets[t.sheetIndex],r,u,i,f;if(this._isUndo){for(i=0,f=t.updCell.length;i<f;i++)r=this.getCell(t.updCell[i].rowIndex,t.updCell[i].colIndex,t.sheetIndex),this._clearFormula(t.updCell[i].rowIndex,t.updCell[i].colIndex),this.clearRangeData([t.updCell[i].rowIndex,t.updCell[i].colIndex,t.updCell[i].rowIndex,t.updCell[i].colIndex],["value2"],null,!0),u=n.extend(!0,{},t.updCell[i].pObj),e[t.updCell[i].rowIndex][t.updCell[i].colIndex]=u,r.text(t.updCell[i].pValue);this.performSelection(t.range)}else this.XLRibbon.autoSum(t.oprType,t.range)},_undoForClAll:function(t){var u=this.model.sheets[t.sheetIndex],i,r;if(this._isPaste=this._dupDetails=!0,this._isUndo){for(this.updateData(n.extend(!0,[],t.bData),t.range),this.XLFormat.updateFormat(n.extend(!0,[],t.bBorder),t.range),i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx,t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);for(i=0,r=t.mergeColl.length;i<r;i++)this.mergeCenter=t.mergeColl[i].mergeObj.isCenterAlign,this.mergeCells(t.mergeColl[i].mergeObj.mRange,!0)}else this.model.showRibbon&&this.XLRibbon._isMergeSelect&&this.XLRibbon._isFilterSelect.status?(this.clearRangeData(t.range,["value","value2","hyperlink","cFormatRule","comment"],"",!1),this.XLFormat.removeStyle(null,{cellStyle:!0,format:!0})):this.clearRangeData(t.range,["value","value2","format","formats","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","comment","cFormatRule"]),this.setWrapText("unwrap",t.range),this.unmergeCells(t.range);this._isPaste=this._dupDetails=!1;t.tblObj&&(this._isUndo?(this.XLClipboard._isCut=!0,this.XLFormat.createTable(t.tblObj,t.tblObj.range),this.XLClipboard._isCut=!1):(this.XLFormat.removeTable(t.tblObj.tblId),this.clearRangeData(t.range,["value","value2","format","formats","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","comment","cFormatRule"]),this.XLRibbon._toggleDesignTab(this.getActiveCell())));this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range);this.model.allowDataValidation&&!this._isUndo&&this.XLValidate.clearDV();this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForClComment:function(n){var i,u,f,t,e;if(n.selectedCell.length){if(u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},this._isUndo)for(t=0,e=n.selectedCell.length;t<e;t++)i={rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},{dataObj:{comment:n.selectedCell[t].prevComment}}),this.XLSelection.selectRange(i,i),this.XLComment.setComment(),this.XLComment._updateCurCmntVal();else this.XLSelection.selectRange(u,f),this.XLComment.deleteComment(r,null,!1,"clear");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()}},_undoForClContent:function(t){this._isUndo?this.updateData(n.extend(!0,[],t.bData),t.range):this.clearRangeData(t.range,["value","value2","type","hyperlink"],t.reqType);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range);this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForClFormat:function(t){var u=this._dataContainer.sheets[t.sheetIndex],i,r;if(this._isUndo){for(i=0,r=t.wrapColl.length;i<r;i++)this.setWrapText("wrap",[t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx,t.wrapColl[i].rowIdx,t.wrapColl[i].colIdx]);for(i=0,r=t.mergeColl.length;i<r;i++)this.mergeCenter=t.mergeColl[i].mergeObj.isCenterAlign,this.mergeCells(t.mergeColl[i].mergeObj.mRange,!0);this.updateData(n.extend(!0,[],t.bData),t.range,t.reqType)}else this.XLRibbon._isMergeSelect&&this.XLRibbon._isFilterSelect.status?(this.clearRangeData(t.range,["decimalPlaces","thousandSeparator","hyperlink","cFormatRule"],"",!1,details.reqType),this.XLFormat.removeStyle(null,{cellStyle:!0,format:!0})):this.clearRangeData(t.range,["format","formats","border","type","formatstr","decimalPlaces","thousandSeparator","hyperlink","cFormatRule"],"",!1,t.reqType),this.setWrapText("unwrap",t.range),this.unmergeCells(t.range);this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t.range)},_undoForCLLink:function(n){var f={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},e,u,o={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},i,r;if(this.setActiveCell(n.selectedCell[0].rowIndex,n.selectedCell[0].colIndex),this.XLSelection.selectRange(f,o),this._isUndo)for(i=0,r=n.selectedCell.length;i<r;i++)n.selectedCell[i].prevLink&&(u=this.getCell(n.selectedCell[i].rowIndex,n.selectedCell[i].colIndex),n.selectedCell[i].prevLink.webAddr?u.html(t.buildTag("a.e-hyperlinks",n.selectedCell[i].prevText,"",{href:n.selectedCell[i].prevLink.webAddr,target:"_blank"})):u.html(t.buildTag("a.e-hyperlinks",n.selectedCell[i].prevText,"",{href:"#"})),this.isUndefined(n.selectedCell[i].prevLink.cellAddr)?this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{hyperlink:{webAddr:n.selectedCell[i].prevLink.webAddr}}}):this.XLdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{hyperlink:{cellAddr:n.selectedCell[i].prevLink.cellAddr}}}));else this._removeHyperlink("clear",n.selectedCell);for(this.XLSelection.selectRange(f,o),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),i=0,r=n.selectedCell.length;i<r;i++)e=n.selectedCell[i].prevLink,n.selectedCell[i].prevLink=n.selectedCell[i].curLink,n.selectedCell[i].curLink=e},_undoForComment:function(n){var t,u,f,r,i,e;for(u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},i=0,e=n.selectedCell.length;i<e;i++)t={rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},this.XLSelection.selectRange(t,t),this.getSheet(n.sheetIndex)._startCell=t,n.action==="add"?(n.selectedCell[i].prevComment=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment"),this.XLComment&&this.XLComment.deleteComment()):n.action==="edit"?(this._isRowViewable(n.sheetIndex,t.rowIndex)&&this.getCell(t.rowIndex,t.colIndex).find(".e-comment-txtarea").val(n.selectedCell[i].prevComment.value),this.XLComment._updateCurCmntVal(),r=n.selectedCell[i].prevComment,n.selectedCell[i].prevComment=n.selectedCell[i].curComment,n.selectedCell[i].curComment=r):(this.XLEdit._updateDataContainer(t,{dataObj:{comment:n.selectedCell[i].prevComment}}),this.XLComment.setComment([t.rowIndex,t.colIndex,t.rowIndex,t.colIndex],null,!1),this.XLSelection.selectRange(t,t),this.XLComment._updateCurCmntVal(),r=n.selectedCell[i].prevComment,n.selectedCell[i].prevComment=n.selectedCell[i].curComment,n.selectedCell[i].curComment=r);n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(u,f);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForCondFormat:function(n){var i,e,l,s,c,r,o=[],h,a,u,f,v;if(n.range=n.data,this._isUndo){if(n.action==="add"){for(u=this._getSelectedRange({rowIndex:n.range[0],colIndex:n.range[1]},{rowIndex:n.range[2],colIndex:n.range[3]}),c=this.XLEdit.getPropertyValue(u[0].rowIndex,u[0].colIndex,"cFormatRule"),n.poppedRule=c[c.length-1],i=0,e=u.length;i<e;i++){if(h=this.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"cFormatRule"),!this.isUndefined(h))for(h.pop(),f=0,l=h.length;f<l;f++)s=h[f],o.length===0?(r=s.indexOf("true")>-1?s.replace("_true",""):s.replace("_false",""),o.push(r)):o=this._addCondFormatRule(o,s);this._isRowViewable(n.sheetIndex,u[i].rowIndex)&&(a=this.getCell(u[i].rowIndex,u[i].colIndex,n.sheetIndex),a.removeClass("e-redft e-yellowft e-greenft e-redf e-redt"))}for(this.clearRangeData(n.range,["cFormatRule"],u),i=0,e=o.length;i<e;i++)r=o[i].split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)}else if(n.action==="clear")for(i=0,e=n.rule.length;i<e;i++)for(f=0,v=n.rule[i].length;f<v;f++)this.XLCFormat.setCFRule(n.rule[i][f])}else n.action==="add"?t.isNullOrUndefined(n.poppedRule)||(r=n.poppedRule.split("_"),this.XLCFormat._cFormat(r[0],r[2],r[3],r[4],r[5],n.sheetIndex,n.range)):n.action==="clear"&&(n.selection?this.XLCFormat.clearCF(n.range):this.XLCFormat.clearCF())},_getCopyText:function(n){for(var i,u,e=[],r,t=0,f=n.length;t<f;t++)for(r=n[t].split("\t"),i=0,u=r.length;i<u;i++)e.push(r[i]);return e},_cutShape:function(t,i,r,u){for(var o,h,e=["picture","chart"],s,f=0,c=e.length;f<c;f++)if(e[f]in t)for(this.XLShape._picCellIdx={rowIndex:i.rowIndex,colIndex:i.colIndex},o=0,h=t[e[f]].length;o<h;o++)s=n.extend(!0,{},r[e[f]][t[e[f]][o]]),this.XLShape._deleteShape(u,this.element.find("#"+s.id))},_pasteShape:function(t,i,r,u){for(var h,l,s=["picture","chart"],f,e,c,o=0,a=s.length;o<a;o++)if(s[o]in t){for(h=0,l=t.picture.length;h<l;h++)f=n.extend(!0,{},r[s[o]][t[s[o]][h]]),this.XLChart._shapeCnt===1||this.XLChart._shapeCnt--,s[o]==="picture"?(c=this._id+"_picture",this.XLShape._createPicture(u,{rowIndex:i.rowIndex,colIndex:i.colIndex},r.sharedPics[f.data],f.top,f.left,f.width,f.height,parseInt(f.id.replace(c,"")))):(e=f.range,this.XLChart.createChart(this._getAlphaRange(u,e[0],e[1],e[2],e[3]),f));s[o]==="chart"&&this.XLSelection.selectRange({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]},pSheetIndex)}},_undoForCopyPaste:function(i){var e={},f=this._dataContainer,k,l=this.getSheet(i.pSheetIndex).shapeMngr,u,tt,h,s,d;if(i.operation==="shape")k=i.pShapeId.indexOf("picture")>-1?"picture":"chart",u=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(u)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},k==="chart"?"chart"in u&&(this._isUndo?(e=n.extend(!0,{},l.chart[i.pShapeId]),t.isNullOrUndefined(f.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(f.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),f.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=u,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+e.id))):(this.setActiveCell(i.pasteCell.rowIndex,i.pasteCell.colIndex,i.pSheetIndex),e=n.extend(!0,{},i.pasteCell.shapeObj),o=e.range,this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),e),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex))):"picture"in u&&(this._isUndo?(e=n.extend(!0,{},l.picture[i.pShapeId]),t.isNullOrUndefined(f.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(f.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),f.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=u,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+e.id))):(e=n.extend(!0,{},i.pasteCell.shapeObj),it=this._id+"_picture",this.XLShape._createPicture(i.pSheetIndex,{rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},l.sharedPics[e.data],e.top,e.left,e.width,e.height,parseInt(e.id.replace(it,"")))))),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCell.rowIndex);else{var a,s,g,d,v,c,nt,tt,o,y,p,it,w,b,r,rt=!1,ut=[],f=this._dataContainer;for(this._getCopyText(i.text),this._dupDetails=!0,this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this.setActiveSheetIndex(i.pSheetIndex),a=0,g=i.pasteCells.length;a<g;a++)r=i.pasteCells[a],u=t.isNullOrUndefined(f.sheets[i.pSheetIndex][r.rowIndex])?{}:f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex],this._isUndo||"merge"in r.prevObj&&(this.mergeCenter=r.prevObj.merge.isCenterAlign,this.mergeCells(r.prevObj.merge.mRange,!0)),this._isRowViewable(i.pSheetIndex,r.rowIndex)&&(v=this.getCell(r.rowIndex,r.colIndex,i.pSheetIndex)[0],this._isUndo||(v.textContent=ut[a]),rt=!0),t.isNullOrUndefined(u)||(this._cutShape(u,r,l,i.pSheetIndex),c=this._generateHeaderText(r.colIndex+1)+(r.rowIndex+1),"wrap"in u&&this.setWrapText("unwrap",c+":"+c),"merge"in u&&this._isUndo&&(r.newObj=n.extend(!0,{},f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex]),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,r.rowIndex,r.colIndex,r.rowIndex,r.colIndex)),this.getCell(r.rowIndex,r.colIndex,i.pSheetIndex).prop("rowspan",!1).prop("colspan",!1),"merge"in r.prevObj&&(this.mergeCenter=r.prevObj.merge.isCenterAlign,this.mergeCells(r.prevObj.merge.mRange,!0),this.mergeCenter=!1))),rt&&this._isUndo&&(v.textContent="",this._removeClass(v,"e-commentcell")),t.isNullOrUndefined(f.sheets[i.pSheetIndex][r.rowIndex])&&(f.sheets[i.pSheetIndex][r.rowIndex]={}),t.isNullOrUndefined(f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex])||(w=f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0,border:!0}),f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex]=n.extend(!0,{},r.prevObj),w&&(f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex].overflow=w),this._textClip(r.rowIndex,r.colIndex,"delete"),this._setRowHdrHeight(i.pSheetIndex,r.rowIndex),u=t.isNullOrUndefined(f.sheets[i.pSheetIndex][r.rowIndex])?{}:f.sheets[i.pSheetIndex][r.rowIndex][r.colIndex],y=r.rowIndex,p=r.colIndex,this._applyCommentLink(u,{rowIndex:r.rowIndex,colIndex:r.colIndex},y,p),this._isPaste=!0,t.isNullOrUndefined(u)||(this._pasteShape(u,{rowIndex:y,colIndex:p},l,i.pSheetIndex),"cellType"in u&&(this._isUndo?this._removeClass(v,"e-cellreadonly"):(b=this._dataContainer.sheetCellType[u.cellType],b.text="",this.model.allowCellType&&this.XLCellType._renderControls(r.rowIndex,r.colIndex,i.pSheetIndex,b,!0))),c=this._generateHeaderText(r.colIndex+1)+(r.rowIndex+1),"wrap"in u&&this.setWrapText("wrap",c+":"+c),this._isPaste=!1),nt=r.prevObj,r.prevObj=r.newObj,r.newObj=nt;if(i.isSpecial&&(this.model.allowCellFormatting&&(this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),tt=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=tt),!t.isNullOrUndefined(i.pfat))for(h=i.pfat.ptable,s=0,d=h.length;s<d;s++)t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this._isUndo?(this.XLFormat.removeTable(h[s].id),this.XLFormat.removeStyle(h[s].range)):(h[s].header=!0,this.XLFormat.createTable(h[s],h[s].range)));t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter));this._dupDetails=!1}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])):(t.isNullOrUndefined(i.cSheetIndex)||this.setActiveSheetIndex(i.cSheetIndex),i.cutCells.length>0&&this.XLSelection._focusBorder(i.cutCells[0],i.cutCells[i.cutCells.length-1],this._cutFocus),this.setActiveSheetIndex(i.pSheetIndex),i.pasteCells.length>0&&this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex))},_undoForCutPaste:function(i){var u,y,c={},e=this._dataContainer,p=this.getSheet(i.pSheetIndex).shapeMngr,ft,it,et,g,ot,st,ht,nt,v,o,d,f,s,l,ct,lt,rt,r,h,ut,pt,wt,bt;if(i.operation==="shape")g=i.pShapeId.indexOf("picture")>-1?"picture":"chart",u=n.extend(!0,{},i.pasteCell.obj),t.isNullOrUndefined(u)||(this.XLShape._picCellIdx={rowIndex:i.pasteCell.rowIndex,colIndex:i.pasteCell.colIndex},c=n.extend(!0,{},p[g][i.pShapeId]),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCell.rowIndex]={}),e.sheets[i.pSheetIndex][i.pasteCell.rowIndex][i.pasteCell.colIndex]=u,this.XLShape._deleteShape(i.pSheetIndex,this.element.find("#"+c.id))),u=n.extend(!0,{},i.cutCell.obj),g=i.cShapeId.indexOf("picture")>-1?"picture":"chart",t.isNullOrUndefined(u)||(this.setActiveCell(i.cutCell.rowIndex,i.cutCell.colIndex,i.cSheetIndex),g==="chart"?"chart"in u&&(c=n.extend(!0,{},i.cutCell.shapeObj),o=c.range,this.setActiveSheetIndex(i.cSheetIndex),this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,o[0],o[1],o[2],o[3]),c),this.setActiveSheetIndex(i.sheetIndex),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.cSheetIndex)):"picture"in u&&(c=n.extend(!0,{},i.cutCell.shapeObj),ft=this._id+"_picture",this.XLShape._createPicture(i.cSheetIndex,{rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},p.sharedPics[c.data],c.top,c.left,c.width,c.height,parseInt(c.id.replace(ft,""))))),this.XLShape._picCellIdx={rowIndex:i.cutCell.rowIndex,colIndex:i.cutCell.colIndex},ot=i.pasteCell,i.pasteCell=i.cutCell,i.cutCell=ot,st=i.pShapeId,i.pShapeId=i.cShapeId,i.cShapeId=st;else{for(lt=[],e=this._dataContainer,this.element.find(".e-cdata").length&&n("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),this._getCopyText(i.text),r=0,ht=i.pasteCells.length;r<ht;r++)t.isNullOrUndefined(i.pSheetIndex)||(this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])||(u=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),v=this._generateHeaderText(i.pasteCells[r].colIndex+1)+(i.pasteCells[r].rowIndex+1),"wrap"in u&&this.setWrapText("unwrap",v+":"+v),this._isRowViewable(i.pSheetIndex,i.pasteCells[r].rowIndex)&&(d=this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex)[0],d.textContent="",this._removeClass(d,"e-commentcell")),this.isUndefined(u)||(this._cutShape(u,i.pasteCells[r],p,i.pSheetIndex),"merge"in u&&(this._isUndo?(n.extend(!0,i.pasteCells[r].newObj,e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]),this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange),this.getCell(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,i.pSheetIndex).prop("rowspan",!1).prop("colspan",!1),"merge"in i.pasteCells[r].prevObj&&(this.mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this.mergeCenter=!1)):(this.setActiveSheetIndex(i.pSheetIndex),this.unmergeCells(u.merge.mRange,!0),"merge"in i.pasteCells[r].prevObj&&(this.mergeCenter=i.pasteCells[r].prevObj.merge.isCenterAlign,this.mergeCells(i.pasteCells[r].prevObj.merge.mRange,!0),this.mergeCenter=!1),this.setActiveSheetIndex(i.cSheetIndex),this.unmergeCells(this._getAlphaRange(i.pSheetIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex,i.cutCells[r].rowIndex,i.cutCells[r].colIndex)),o=this.getRangeIndices(i.cutCells[r].prevObj.merge.mRange),this.XLSelection.selectRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]},i.sheetIndex))),"cellType"in u&&this._removeClass(d,"e-cellreadonly")),this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])&&(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex]={}),t.isNullOrUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex])||(y=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow),this.model.allowCellFormatting&&this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0,border:!0}),e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].wrap&&(it=!0),et=this.XLEdit.getPropertyValue(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"tableName")||"",e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex]=n.extend(!0,{},i.pasteCells[r].prevObj),this._textClip(i.pasteCells[r].rowIndex,i.pasteCells[r].colIndex,"delete"),this.isUndefined(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex])||(y&&(e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex].overflow=y),this._setRowHdrHeight(i.pSheetIndex,i.pasteCells[r].rowIndex),u=e.sheets[i.pSheetIndex][i.pasteCells[r].rowIndex][i.pasteCells[r].colIndex],s=i.pasteCells[r].rowIndex,l=i.pasteCells[r].colIndex,this._applyCommentLink(u,{rowIndex:s,colIndex:l},s,l),it&&(u.wrap=it),this._isPaste=!0,t.isNullOrUndefined(u)||(this._pasteShape(u,{rowIndex:s,colIndex:l},p,i.pSheetIndex,i.sheetIndex),v=this._generateHeaderText(l+1)+(s+1),"wrap"in u&&this.setWrapText("wrap",v+":"+v))),nt=i.pasteCells[r].prevObj,i.pasteCells[r].prevObj=i.pasteCells[r].newObj,i.pasteCells[r].newObj=nt,this._isPaste=!1);for(r=0;r<i.cutCells.length;r++)t.isNullOrUndefined(i.cSheetIndex)||(f=i.cutCells[r],this._isRowViewable(i.cSheetIndex,f.rowIndex)&&(ct=this.getCell(f.rowIndex,f.colIndex,i.cSheetIndex)[0],ct.textContent=lt[r]),this.setActiveSheetIndex(i.cSheetIndex),u=t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex])?{}:e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex],t.isNullOrUndefined(u)||this._cutShape(u,f,p,i.cSheetIndex),t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex])&&(e.sheets[i.cSheetIndex][f.rowIndex]={}),t.isNullOrUndefined(e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex])||(y=e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex].overflow),f.prevObj.tableName&&delete f.prevObj.tableName,e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex]=n.extend(!0,{},f.prevObj),this.getObjectLength(y)>0&&(e.sheets[i.cSheetIndex][f.rowIndex][f.colIndex].overflow=y)&&(y={}),nt=f.prevObj,f.prevObj=f.newObj,f.newObj=nt,s=f.rowIndex,l=f.colIndex,this._setRowHdrHeight(i.cSheetIndex,s),this.XLScroll._getRowHeights(i.cSheetIndex,s),u=t.isNullOrUndefined(e.sheets[i.cSheetIndex][s])?{}:e.sheets[i.cSheetIndex][s][l],this._applyCommentLink(u,{rowIndex:s,colIndex:l},s,l),this._isPaste=!0,t.isNullOrUndefined(u)||(this._pasteShape(u,{rowIndex:s,colIndex:l},p,i.cSheetIndex),"merge"in u&&(this.mergeCenter=u.merge.isCenterAlign,this.mergeCells(u.merge.mRange,!0),this.mergeCenter=!1),"cellType"in u&&(rt=this._dataContainer.sheetCellType[u.cellType],rt.text="",this.model.allowCellType&&this.XLCellType._renderControls(f.rowIndex,f.colIndex,i.pSheetIndex,rt,!0)),this._dupDetails=!0,v=this._generateHeaderText(f.colIndex+1)+(f.rowIndex+1),"wrap"in u&&this.setWrapText("wrap",v+":"+v),this._dupDetails=!1),this._isPaste=!1);if(this.XLScroll._getRowHeights(i.pSheetIndex,i.pasteCells[0].rowIndex<i.cutCells[0].rowIndex?i.pasteCells[0].rowIndex:i.cutCells[0].rowIndex),this.model.allowCellFormatting&&!t.isNullOrUndefined(i.pSheetIndex)&&(this.setActiveSheetIndex(i.pSheetIndex),this.XLFormat.removeStyle(i.pasteBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),this.isUndefined(i.pasteBorder.prevBorder)||this.XLFormat.updateFormat(i.pasteBorder.prevBorder,i.pasteBorder.range,"format")),nBrdr=i.pasteBorder.prevBorder,i.pasteBorder.prevBorder=i.pasteBorder.newBorder,i.pasteBorder.newBorder=nBrdr,this.model.allowCellFormatting&&!t.isNullOrUndefined(i.cSheetIndex)&&(this.setActiveSheetIndex(i.cSheetIndex),i.isSpecial&&this.XLFormat.removeStyle(i.cutBorder.range,{cellStyle:!0,tableStyle:!0,format:!0}),i.cutBorder.prevBorder&&this.XLFormat.updateFormat(i.cutBorder.prevBorder,i.cutBorder.range,"format")),nBrdr=i.cutBorder.prevBorder,i.cutBorder.prevBorder=i.cutBorder.newBorder,i.cutBorder.newBorder=nBrdr,!t.isNullOrUndefined(i.pfat)){var w,a=i.pfat.table,b,at=i.pfat.minRowIdx,vt=i.pfat.minColIdx,k,yt,tt=i.pfat.range;for(h=0,ut=a.length;h<ut;h++)b=a[h].range,t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),k=this._getTableID(et),yt=this.getSheet(i.sheetIndex).tableManager,w=yt[k].range,this.XLFormat.removeTable(k),this.XLFormat.removeStyle(w)),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLClipboard._isCut=!0,this._isUndo?(this.XLFormat.createTable(a[h].tblObj,a[h].range),a[h].tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,k,a[h].tblObj.fnNumber,a[h].range,!0)):(w=this.getRangeIndices(this._getAlphaRange(i.cSheetIndex,b[0]+at-tt[0],b[1]+vt-tt[1],at-tt[0]+b[2],vt-tt[1]+b[3])),this.XLFormat.createTable(a[h].tblObj,w),a[h].tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,k,a[h].tblObj.fnNumber,w,!0)),this.XLClipboard._isCut=!1)}t.isNullOrUndefined(i.filter)||(this.XLFilter.clearFilter(),this.XLFilter.filter(details.filter))}i.operation!=="shape"&&(this._isUndo?(t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1])),t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1]))):(t.isNullOrUndefined(i.pSheetIndex)||(this.setActiveSheetIndex(i.pSheetIndex),this.XLSelection._focusBorder(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1],this._cutFocus),this.XLSelection.selectRange(i.pasteCells[0],i.pasteCells[i.pasteCells.length-1])),t.isNullOrUndefined(i.cSheetIndex)||(this.setActiveSheetIndex(i.cSheetIndex),this.XLSelection.selectRange(i.cutCells[0],i.cutCells[i.cutCells.length-1]))));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();pt=i.pasteCells;i.pasteCells=i.cutCells;i.cutCells=pt;wt=i.pasteBorder;i.pasteBorder=i.cutBorder;i.cutBorder=wt;bt=i.cSheetIndex;i.cSheetIndex=i.pSheetIndex;i.pSheetIndex=bt},_undoForDel:function(t){this._delCells=n.extend(!0,[],t.delCells);this._deletedText=n.extend(!0,[],t.text);this._removeMergeColl=n.extend(!0,[],t.removeMerge);this._deletedDimension=n.extend(!0,[],t.deletedDimension);this._isUndo&&(this._fRow.fRowCnt=t.fRow.fRowCnt,this._fCol.fColCnt=t.fCol.fColCnt);switch(t.action){case"deleteShiftUp":this.deleteShiftUp(t.startCell,t.endCell);break;case"deleteShiftLeft":this.deleteShiftLeft(t.startCell,t.endCell);break;case"deleteRow":this.deleteEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"deleteColumn":this.deleteEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForEdit:function(n){var f,h,l,e,o,s=n.cFormatRule,u={rowIndex:n.rowIndex,colIndex:n.colIndex},c,r,a,v=this.getRows(n.sheetIndex);if(this.setActiveCell(n.rowIndex,n.colIndex,n.sheetIndex),this.XLSelection.selectRange(n.startCell,n.endCell),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this._isRowViewable(n.sheetIndex,n.rowIndex)&&(r=this.getCell(n.rowIndex,n.colIndex),a=r.find("a").css("text-decoration"),n.altwrap&&(this._isUndo?this.XLEdit._clearDataContainer({cellIdx:u,property:["altTxt"]}):this.XLEdit._updateDataContainer(u,{dataObj:{altTxt:!0}}))),f=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink",n.sheetIndex),t.isNullOrUndefined(f)||(h=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.action=h.length<1?"add":"delete",n.reqType="edit",u.prevLink=f,u.prevText=h,n.selectedCell=[]),c=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"),this.XLEdit._updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.pValue),this._dupDetails=!0,s&&s.length){for(i=0,len=s.length;i<len;i++)o=s[i].split("_"),this.XLCFormat._cFormat(o[0],o[2],o[3],o[4],o[5]);this.XLCFormat.refreshCFormat(this._getAlphaRange(n.sheetIndex,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex))}n.prevFrmtObj&&n.curFrmtObj&&(l=this._isUndo?n.prevFrmtObj:n.curFrmtObj,this.XLFormat.format(l,this._getAlphaRange(n.sheetIndex,n.rowIndex,n.colIndex,n.rowIndex,n.colIndex)));this._dupDetails=!1;this._textClip(n.rowIndex,n.colIndex,n.pValue.length>0?"add":"delete");t.isNullOrUndefined(c)||(this.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:{comment:c}}),this.XLComment.setComment(),this.XLComment._updateCurCmntVal());this._isRowViewable(n.sheetIndex,n.rowIndex)&&(f&&(f.webAdr?r.html(t.buildTag("a",r.text(),"",{href:hldata.webAdr,target:"_blank","class":"e-hyperlinks"})):r.html(t.buildTag("a",r.text(),"",{href:"#","class":"e-hyperlinks"}))),r.find("a").css("text-decoration",a),r.removeClass("e-commentcell"));t.isNullOrUndefined(f)||(u.curLink=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"hyperlink"),u.curText=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),n.selectedCell.push(u));n.prevHeight!=n.newHeight&&(this.getSheet(n.sheetIndex).rowsHeightCollection[n.rowIndex]=n.prevHeight,this._isRowViewable(n.sheetIndex,n.rowIndex)&&(v[0][n.rowIndex].style.height=n.prevHeight+"px",v[1][n.rowIndex].style.height=n.prevHeight+"px"),this._setRowHdrHeight(n.sheetIndex,n.rowIndex),this.XLScroll._getRowHeights(n.sheetIndex,n.rowIndex),e=n.newHeight,n.newHeight=n.prevHeight,n.prevHeight=e);e=n.cValue;n.cValue=n.pValue;n.pValue=e;this.XLEdit._isEdit=!1;e=n.previousValue;n.previousValue=n.value;n.value=e;this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForFilter:function(i){var y=!1,v=[],u,d,s=[],b,h,c,f,tt=i.sheetIndex||this.getActiveSheetIndex(),k=this._dataContainer.sheets[tt],p,g,r,e,l,a,nt,w,o;if(i.operation==="filter"&&i.requestType!=="filterbycell")if(this._isUndo){for(r=this._undoCollection.length-1;r>=0;r--){if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="filtering"&&this._undoCollection[r].status!=="apply-filterIcon"&&this._undoCollection[r].rowIndex===i.rowIndex&&this._undoCollection[r].colIndex===i.colIndex){for(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],u=this._undoCollection[r],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID),r=0,e=u.filterCollection.length;r<e;r++)v.push(u.filterCollection[r]);this.model.sheets[u.sheetIndex].filterSettings.filteredColumns=v;t.isNullOrUndefined(this._excelFilter._predicates[u.sheetIndex][u.fieldName])&&(this._excelFilter._predicates[u.sheetIndex][u.fieldName]={});this._excelFilter._predicates[u.sheetIndex][u.fieldName]=u.ejpredicate;this.model.sheets[u.sheetIndex]._selectedRange=u.range;this.XLFilter._filterHandler(u);b="undo";y=!0;break}if(this._undoCollection[r].reqType==="filter"&&this._undoCollection[r].tableID===i.tableID&&this._undoCollection[r].action==="clearfiltering"){delete this._excelFilter._predicates[i.sheetIndex][i.fieldName];u=this._undoCollection[r];this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,u.tableID);y=!0;break}if(this._undoCollection[r].requestType==="filterbycell"&&this._undoCollection[r].rowIndex===i.rowIndex&&this._undoCollection[r].colIndex===i.colIndex){u=this._undoCollection[r];delete this._excelFilter._predicates[u.sheetIndex][u.fieldName];this.XLFilter._clearFilterColumn(u.fieldName,"","","Or",null,null,u.tableID);n.extend(!0,s,u.selCells);this.XLFilter._filterActiveCell(u.sheetIndex,u.activeCell,s,u.filteredValue,u.selRange);b="undo";y=!0;break}}y||(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID))}else{for(v=[],delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),r=0,e=i.filterCollection.length;r<e;r++)v.push(i.filterCollection[r]);this.model.sheets[i.sheetIndex].filterSettings.filteredColumns=v;t.isNullOrUndefined(this._excelFilter._predicates[i.sheetIndex][i.fieldName])&&(this._excelFilter._predicates[i.sheetIndex][i.fieldName]={});this._excelFilter._predicates[i.sheetIndex][i.fieldName]=i.ejpredicate;i.filterCollection.length&&this.XLFilter._filterHandler(i);b="redo"}else if(this._isUndo){if(i.operation==="apply-filter"&&i.requestType!=="filterbycell")for(r=0,e=i.filteredCells.length;r<e;r++)h=i.filteredCells[r].rowIndex,c=i.filteredCells[r].colIndex,f=this.getCell(h,c,i.sheetIndex),f.find(".e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),this.addClass(f[0],"e-wrapword"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text(),{rowIndex:h,colIndex:c}).type==="datetime"||this.XLEdit._parseValue(f.text(),{rowIndex:h,colIndex:c}).type==="currency"||this.XLEdit._parseValue(f.text()).type==="percentage",{rowIndex:h,colIndex:c})&&f.addClass(this._rAlign),delete k[h][c].isFilterHeader,delete k[h][c].filterState,delete k[h][c].isFilterVisible;if(i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),!this.isUndefined(i.filteredCells)))for(r=0,e=i.filteredCells.length;r<e;r++)f=this.getCell(i.filteredCells[r].rowIndex,i.filteredCells[r].colIndex,i.sheetIndex),f.find(".e-ssfiltered, .e-ssfilter").remove(),this._removeClass(f[0],"e-filterhdr"),this.addClass(f[0],"e-wrapword"),(this.isNumber(f.text())||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="datetime"||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="currency"||this.XLEdit._parseValue(f.text(),{rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex}).type==="percentage")&&f.addClass(this._rAlign);if(this.model.sheets[i.sheetIndex].filterSettings.range="",i.operation==="apply-filter"&&i.requestType!="filterbycell"||i.requestType==="filterbycell"&&!this.isUndefined(i.filteredCells)){for(p=this.model.sheets[i.sheetIndex].filterSettings.tableRange,r=0,e=p.length;r<e;r++)if(p[r].tableID===i.tableID){g=r;break}i.filterRange=p.splice(g,1)[0]}if(i.operation==="remove-filter"){if(l=this._undoCollection[this._undoCollection.length-1],o=this.getSheet(i.sheetIndex),l.requestType==="filterbycell")n.extend(!0,s,l.selCells),this.XLFilter._filterActiveCell(l.sheetIndex,l.activeCell,s,l.filteredValue,l.selRange);else for(r=0,e=i.filteredCells.length;r<e;r++)w=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon(i.filteredCells[r],w);for(o._selectedRange=i.selRange,o.filterSettings.filteredRange=i.fltrdRange,o.filterSettings.filteredColumns=i.filteredCols,o.filterSettings.range=i.fRange,o.filterSettings.tableRange.push(i.filterRange),a=0,nt=i.filterCollection.length;a<nt;a++)this._excelFilter._predicates[i.sheetIndex][i.filterCollection[a].fieldName]=i.filterCollection[a].predicate,this.XLFilter._filterHandler(i.filterCollection[a])}}else if(i.operation==="remove-filter"&&(i.requestType==="filterbycell"?(this._isRowViewable(i.sheetIndex,i.activeCell.rowIndex)&&(d=this.getCell(i.activeCell.rowIndex,i.activeCell.colIndex),d.find("span.e-ssfilter").remove()),delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,s,i.selectedCell),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,s,i.filteredValue,i.selRange)):this.XLFilter.clearFilter("remove")),i.operation==="filter"&&i.requestType==="filterbycell"&&(delete this._excelFilter._predicates[i.sheetIndex][i.fieldName],this.XLFilter._clearFilterColumn(i.fieldName,"","","Or",null,null,i.tableID),n.extend(!0,s,i.selectedCell),this.XLFilter._filterActiveCell(i.sheetIndex,i.activeCell,s,i.filteredValue,i.selRange)),i.operation==="apply-filter"){for(o=this.getSheet(i.sheetIndex),r=0,e=i.filteredCells.length;r<e;r++)w=this.XLFilter._getFilterIcon(),this.XLFilter._applyFilterIcon({rowIndex:i.filteredCells[r].rowIndex,colIndex:i.filteredCells[r].colIndex},w);o.filterSettings.range=i.fRange;o.filterSettings.tableRange.push(i.filterRange)}},_undoForFilterByColor:function(n){var i,r=[],t;for(r.push(n),i=this._isUndo?this._undoCollection:r,delete this._excelFilter._predicates[n.sheetIndex][n.columnName],this.XLFilter._clearFilterColumn(n.columnName,"","","Or",null,null,n.tableID),t=i.length-1;t>=0;t--)if(i[t].reqType==="filterbycolor"&&i[t].tableID===n.tableID&&i[t].rowIndex===n.rowIndex&&i[t].colIndex===n.colIndex){this.XLFilter._filterHandler(i[t]);break}},_undoForFind:function(n){var i,t,r,u;switch(n.operation){case"replace":this.XLEdit._updateCellValue({rowIndex:n.rowIndex,colIndex:n.colIndex},n.prevData.value,null,n.sheetIndex);u=n.prevData;n.prevData=n.newData;n.newData=u;this.XLSelection.selectRange({rowIndex:n.rowIndex,colIndex:n.colIndex},{rowIndex:n.rowIndex,colIndex:n.colIndex});break;case"replaceAll":for(t=0,r=n.selectedCell.length;t<r;t++)this.XLEdit._updateCellValue({rowIndex:n.selectedCell[t].rowIndex,colIndex:n.selectedCell[t].colIndex},n.selectedCell[t].prevData.value,null,n.selectedCell[t].sheetIndex),u=n.selectedCell[t].prevData,n.selectedCell[t].prevData=n.selectedCell[t].newData,n.selectedCell[t].newData=u;break;case"blanks":case"conditions":case"validations":case"formulas":case"rowdiff":case"coldiff":case"comments":case"constants":for(t=0,r=n.selectedCell.length;t<r;t++)i=this.getCell(n.selectedCell[t].rowIndex,n.selectedCell[t].colIndex,n.sheetIndex),this._isUndo?i.operation==="coldiff"||i.operation==="rowdiff"?n.selectedCell[t].isApply?i.removeClass("e-selected"):i.addClass("e-selected"):n.selectedCell[t].isApply?i.addClass("e-selected"):i.removeClass("e-selected"):i.removeClass("e-selected")}this.model.allowFormulaBar&&this.updateFormulaBar()},_undoForFormat:function(i){var c=!1,y,r,f,e,o=this._dataContainer.sheets[i.sheetIndex],l,s,a,h="",u,v;if(t.isNullOrUndefined(i.process))for(i.oprType==="style"&&(this.XLFormat.removeStyle(i.range,{cellStyle:!0,format:!0}),h="e-format",!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(h="e-border"),a=new RegExp("\\b"+h+".*?\\b","g")),y={startCell:i.selectedCell[0],endCell:i.selectedCell[i.selectedCell.length-1]},u=0,v=i.selectedCell.length;u<v;u++)r=i.selectedCell[u],this._isRowViewable(i.sheetIndex,r.rowIndex)&&(e=this.getCell(r.rowIndex,r.colIndex)[0],c=!0),t.isNullOrUndefined(o[r.rowIndex])&&(o[r.rowIndex]={}),t.isNullOrUndefined(o[r.rowIndex][r.colIndex])&&(o[r.rowIndex][r.colIndex]={}),n.extend(!0,o[r.rowIndex][r.colIndex],i.selectedCell[u].beforeFormat),c&&(i.oprType==="format"?(l=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"),this.XLEdit._refreshTextNode(e,t.isNullOrUndefined(l)?"":l),this.XLEdit._refreshCellAlignment({cellIdx:{rowIndex:r.rowIndex,colIndex:r.colIndex}})):(f=h==="e-format"?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"format"):this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border"),e.className=e.className.replace(a,""),f=t.isNullOrUndefined(f)?"":f,this.addClass(e,f))),i.selectedCell[0].colIndex===i.selectedCell[u].colIndex&&this.model.allowResizing&&(this._isUndo?this.XLResize.setRowHeight(i.selectedCell[u].rowIndex,i.selectedCell[u].bRowHeight):this.XLResize.setRowHeight(i.selectedCell[u].rowIndex,i.selectedCell[u].aRowHeight)),s=i.selectedCell[u].beforeFormat,i.selectedCell[u].beforeFormat=i.selectedCell[u].afterFormat,i.selectedCell[u].afterFormat=s,c=!1;!t.isNullOrUndefined(i.process)&&i.process.indexOf("border")>-1&&(this.XLFormat.removeStyle(i.range,{cellStyle:!0,tableStyle:!0,format:!1,border:!0}),this._isUndo?this.XLFormat.updateFormat(i.beforeFormat,i.range):i.process==="noborder"?this.XLFormat.format({border:{}},i.range):this.XLFormat.applyBorder(n.extend(!0,{},i.options),i.range),s=i.beforeFormat,i.beforeFormat=i.afterFormat,i.afterFormat=s);i.status="undo-cellformat"},_undoForFormatPaint:function(t){var r,i,e,o,s=this._dataContainer.sheets[t.sheetIndex],u,f;for(this.XLCFormat.clearCF(t.range),this.XLFormat.removeStyle(t.range),this.updateData(n.extend(!0,[],t.beforeData),t.range),this.XLCFormat.refreshCFormat(t.range),e=this.getRangeData({range:t.range}),o=this._getSelectedRange({rowIndex:t.range[0],colIndex:t.range[1]},{rowIndex:t.range[2],colIndex:t.range[3]}),i=0,f=t.unwrapCells.length;i<f;i++)this.setWrapText("unwrap",this._getAlphaRange(t.sheetIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex,t.unwrapCells[i].rowIndex,t.unwrapCells[i].colIndex));for(i=0,u=t.wrapCells.length;i<u;i++)this.setWrapText("wrap",this._getAlphaRange(t.sheetIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex,t.wrapCells[i].rowIndex,t.wrapCells[i].colIndex));r=t.unwrapCells;t.unwrapCells=t.wrapCells;t.wrapCells=r;r=t.beforeData;t.beforeData=t.afterData;t.afterData=r},_undoForFormatTable:function(i){var o,k,h,c,l,s,y,p,v,f=0,u=i.sheetIndex,r=this.getSheet(u).tableManager,g,e=i.header,nt=n("#"+this._id+"_Ribbon").data("ejRibbon"),a,tt=this._isUndo,w,d,b;switch(i.action){case"Design_Tools_ConvertToRange":this._isUndo?(r[i.tableID]={name:i.name,range:i.beforeRange,format:i.format,formatName:i.formatName},this.performSelection(this._getAlphaRange(u,i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3])),this.XLFilter._filterTable(u,i.tableID),this.updateUniqueData({tableName:"e-table"+i.tableID},r[i.tableID].range),r[i.tableID].isFilter=i.isFilter,r[i.tableID].firstColumn=i.firstColumn,r[i.tableID].lastColumn=i.lastColumn,r[i.tableID].totalRow=i.totalRow,r[i.tableID].fnNumber=i.fnNumber,this.getSheet(u)._header[i.tableID]=e,range=this._getDollarAlphaRange(r[i.tableID].range,!0),this.XLRibbon.addNamedRange(i.name,range,null,u)):i.tableID in r&&(g="e-table"+i.tableID,this.XLFormat.removeTable(i.tableID),this.XLFilter._clearFilterTable(u,i.tableID),delete r[i.tableID],delete this.model.sheets[u]._header[i.tableID]);break;case"filtericon":w=n("#"+i.id).data("ejCheckBox");d=i.tableId;i.check?w.option("checked",!1):w.option("checked",!0);r[d].isFilter=!i.check;i.check=!i.check;break;case"firstlastcolumn":b=n("#"+i.id).data("ejCheckBox");i.check?(this.XLFormat.format({style:{"font-weight":"normal"}},i.range),b.option("checked",!1)):(this.XLFormat.format({style:{"font-weight":"bold"}},i.range),b.option("checked",!0));r[i.tableId][i.prop]=!i.check;i.check=!i.check;break;case"totalrow":n("#"+i.id).ejCheckBox("option",{checked:!i.check});i.check=!i.check;break;case"Design_Tools_ResizeTable":if(this._isUndo){for(this._isFATResize=!0,i.afterRange=n.extend(!0,[],i.afterRange),i.totalRow&&(this._dupDetails=!0,this.XLFormat._calculateTotalRow(u,i.tableId,!1),i.beforeRange[2]-=1,r[i.tableId].range[2]-=1),l=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLFormat.removeStyle(i.afterRange),h=i.beforeRange[3]-i.beforeRange[1]+1,s=e[i.tableId].header?this.getRangeData({range:i.beforeRange}):this.getRangeData({range:i.beforeRange}).splice(h,this.getRangeData({range:i.beforeRange}).length),this.clearRangeData(i.beforeRange),e[i.tableId].header?this.updateData(s,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2],i.beforeRange[3]]):this.updateData(s,[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),r[i.tableId]={header:e[i.tableId].header,tblId:i.tableId,name:l,range:i.beforeRange,format:i.format,formatName:i.formatName,firstColumn:i.firstColumn,lastColumn:i.lastColumn,isFilter:i.isFilter,totalRow:i.totalRow},this.XLClipboard._isCut=!0,e[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.beforeRange):this.XLFormat.createTable(r[i.tableId],[i.beforeRange[0],i.beforeRange[1],i.beforeRange[2]-1,i.beforeRange[3]]),i.totalRow&&(this._dupDetails=!0,this.XLFormat._calculateTotalRow(u,i.tableId,!0),i.beforeRange=r[i.tableId].range),a=this.getSheet(u).filterSettings.tableRange,f=0;f<a.length;f++)if(a[f].tableID==i.tableId){a[f].endRow=a[f].selectedRange.endRow=i.beforeRange[2];break}this.XLClipboard._isCut=!1;this._isFATResize=!1}else this._isFATResize=!0,i.beforeRange=n.extend(!0,[],i.beforeRange),i.totalRow&&(this.XLFormat._calculateTotalRow(u,i.tableId,!1),i.afterRange=r[i.tableId].range=[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),l=r[i.tableId].name,this.XLFormat.removeTable(i.tableId),this.XLFormat.removeStyle(i.beforeRange),h=i.beforeRange[3]-i.beforeRange[1]+1,s=e[i.tableId].header?this.getRangeData({range:i.afterRange}):this.getRangeData({range:i.afterRange}).splice(h,this.getRangeData({range:i.afterRange}).length),this.clearRangeData(i.afterRange),e[i.tableId].header?this.updateData(s,i.afterRange):this.updateData(s,[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),r[i.tableId]={header:e[i.tableId].header,tblId:i.tableId,name:l,range:i.beforeRange,format:i.format,formatName:i.formatName,firstColumn:i.firstColumn,lastColumn:i.lastColumn,isFilter:i.isFilter,totalRow:i.totalRow},this.XLClipboard._isCut=!0,e[i.tableId].header?this.XLFormat.createTable(r[i.tableId],i.afterRange):this.XLFormat.createTable(r[i.tableId],[i.afterRange[0],i.afterRange[1],i.afterRange[2]-1,i.afterRange[3]]),this.XLFilter._extendFilterRange(i.tableId,i.afterRange),i.totalRow&&(this.XLFormat._calculateTotalRow(u,i.tableId,!0),i.afterRange=r[i.tableId].range),this.XLClipboard._isCut=!1,this._isFATResize=!1;break;case"renaming":this.XLRibbon.removeNamedRange(r[i.tableId].name);document.getElementById(this._id+"_Ribbon_Design_Properties_TableName")&&(document.getElementById(this._id+"_Ribbon_Design_Properties_TableName").value=r[i.tableId].name=this._isUndo?i.prevName:i.newName);this.XLRibbon.addNamedRange(r[i.tableId].name,i.range,null,u);nt.showTab(this._getLocStr("Design"));break;default:if(this._isUndo){if(l=r[i.tableID].name,this.XLFormat.removeTable(i.tableID),this.XLFormat.removeStyle(i.afterRange),i.tableStyle.header)for(o=0,k=i.beforeRangeHeader.length;o<k;o++)t.isNullOrUndefined(i.beforeRangeHeader[o].value2)?this.XLEdit._updateCellValue(this._getCellIdx(i.pcells[o]),""):this.isNumber(i.pcells[o].innerHTML)&&this.XLEdit._refreshCellAlignment({cellIdx:this._getCellIdx(i.pcells[o])});else h=i.afterRange[3]-i.afterRange[1]+1,this.clearRangeData(i.afterRange),this.updateData(n.extend(!0,[],i.beforeRangeData),i.afterRange);if(this.XLFormat.updateFormat(i.beforeFormat,i.afterRange),y=i.beforeMergeRange,p=y.length,p)while(f<p)v=y[f].value,v&&(c=this.getRangeIndices(v.mRange),selCell=this._getSelectedRange({rowIndex:c[0],colIndex:c[1]},{rowIndex:c[2],colIndex:c[3]}),this.mergeCenter=v.isCenterAlign,this._mergeCells(i.sheetIndex,selCell,{},[])),f++}else this.XLFormat.createTable(i.tableStyle,i.beforeRange)}},_autosumFormatUpdate:function(n,t,i,r){var f={},u,e=this.getActiveSheetIndex();n.type!=="general"&&(this._dupDetails=!0,f.type=n.type,u=i?this._getAlphaRange(e,t[2]+1,t[3],t[2]+1,t[3]):this._getAlphaRange(e,t[0],t[1],t[2],t[3]),r?this.XLFormat.format({type:"general"},u+":"+u):this.XLFormat.format(f,u+":"+u),this._dupDetails=!1)},_undoForHyperlink:function(n){var t,i,r={rowIndex:n.selectedCell[n.selectedCell.length-1].rowIndex,colIndex:n.selectedCell[n.selectedCell.length-1].colIndex},u={rowIndex:n.selectedCell[0].rowIndex,colIndex:n.selectedCell[0].colIndex},f,e,o;for(this.setActiveCell(n.selectedCell[0].rowIndex,n.selectedCell[0].colIndex),this.XLSelection.selectRange(u,r),n.action==="add"?this._removeHyperlink(n.reqType,n.selectedCell):n.action==="edit"?this._setLink(n.selectedCell):this._setLink(n.selectedCell),t=0,i=n.selectedCell.length;t<i;t++)f=n.selectedCell[t].prevLink,n.selectedCell[t].prevLink=n.selectedCell[t].curLink,n.selectedCell[t].curLink=f,e=n.selectedCell[t].prevText,n.selectedCell[t].prevText=n.selectedCell[t].curText,n.selectedCell[t].curText=e,o=n.selectedCell[t].prevColor,n.selectedCell[t].prevColor=n.selectedCell[t].curColor,n.selectedCell[t].curColor=o;n.action==="add"?n.action="delete":n.action==="delete"&&(n.action="add");this.XLSelection.selectRange(u,r);this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForIns:function(t){n.extend(!0,this._delCells,t.delCells);n.extend(!0,this._deletedText,t.text);n.extend(!0,this._removeMergeColl,t.removeMerge);switch(t.action){case"insertShiftRight":this.insertShiftRight(t.startCell,t.endCell);break;case"insertShiftBottom":this.insertShiftBottom(t.startCell,t.endCell);break;case"insertRow":this.insertEntireRow(t.startCell.rowIndex,t.endCell.rowIndex);break;case"insertColumn":this.insertEntireColumn(t.startCell.colIndex,t.endCell.colIndex)}},_undoForMerge:function(n){var r,u,s,e,f,h,i,o;this._delCells=n.hideCells;this._selMergeCells=[];switch(n.action){case"merge-all":case"merge-across":case"un-merge":for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,n.action==="un-merge"?t.isNullOrUndefined(e.mRange)||(r=this.getRangeIndices(e.mRange),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this.mergeCenter=e.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[])):(s=this._getHiddenRowColumnCount(n.sheetIndex,f.mRange),this._unMergeAllCells(n.sheetIndex,i,n.mCells,[],s.hRow,s.hCol)),h=n.mCells[i].prevObj,n.mCells[i].prevObj=n.mCells[i].curObj,n.mCells[i].curObj=h;if(n.action!=="un-merge")for(i=0,o=n.mCells.length;i<o;i++)e=t.isNullOrUndefined(n.mCells[i].prevObj)?{}:t.isNullOrUndefined(n.mCells[i].prevObj.merge)?{}:n.mCells[i].prevObj.merge,f=t.isNullOrUndefined(n.mCells[i].curObj)?{}:t.isNullOrUndefined(n.mCells[i].curObj.merge)?{}:n.mCells[i].curObj.merge,t.isNullOrUndefined(f.mRange)||(r=this.getRangeIndices(f.mRange),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),this.mergeCenter=f.isCenterAlign,this._mergeCells(n.sheetIndex,u,{},[]));n.action=n.action==="un-merge"?"merge-all":"un-merge"}r=this._getSelectedCells(n.sheetIndex,n.range).range;u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]});this.performSelection(u[0],u[u.length-1]);this._delCells=[]},_undoForReOrder:function(i){var r=this.getSheet(i.sheetIndex),u=this.getSheet(i.sheetIndex).tableManager;this._isUndo?(this.XLComment&&this.XLComment.deleteComment(),this.clearRangeData(i.destinationRange),this.XLFormat.removeStyle(i.destinationRange),this.XLCFormat.clearCF(i.destinationRange),this.isUndefined(i.tblObj)||(this.XLFormat.removeTable(i.tblObj.tblId),this.XLClipboard._isCut=!0,this.XLFormat.createTable(i.tblObj,i.sourceRange),i.tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,i.tblObj.tblId,i.tblObj.fnNumber,i.sourceRange,!1),this.XLClipboard._isCut=!1),this.updateData(n.extend(!0,[],i.sourceData),i.sourceRange),this.updateData(n.extend(!0,[],i.destinationData),i.destinationRange),this.XLFormat.updateFormat(i.sourceFormat,i.sourceRange),this.XLFormat.updateFormat(i.destinationFormat,i.destinationRange),this.isUndefined(i.sourceCFormat)||i.sourceCFormat instanceof Array||this.XLCFormat.setCFRule(i.sourceCFormat),this.setActiveCell(i.sourceRange[0],i.sourceRange[1]),this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex),r._startCell={rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},r._endCell={rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement(),this.setHeightToRows(i.prevDestRowHt)):(this.XLSelection.selectRange({rowIndex:i.sourceRange[0],colIndex:i.sourceRange[1]},{rowIndex:i.sourceRange[2],colIndex:i.sourceRange[3]},i.sheetIndex),this.XLComment&&this.XLComment.deleteComment(),this.clearRangeData(i.sourceRange),this.clearRangeData(i.destinationRange),t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.destinationRange[0],i.destinationRange[1],"tableName"))&&this.XLFormat.removeStyle(i.destinationRange),this.isUndefined(i.tblObj)||(this.XLFormat.removeTable(i.tblObj.tblId),this.XLClipboard._isCut=!0,this.XLFormat.createTable(i.tblObj,i.destinationRange),this.XLClipboard._isCut=!1),t.isNullOrUndefined(this.XLEdit.getPropertyValue(i.sourceRange[0],i.sourceRange[1],"tableName"))&&this.XLFormat.removeStyle(i.sourceRange),this.XLCFormat.clearCF(i.sourceRange),this.updateData(n.extend(!0,[],i.sourceData),i.destinationRange),this.XLFormat.updateFormat(i.sourceFormat,i.destinationRange),i.tblObj&&i.tblObj.totalRow&&this.XLFormat._updateTotalRow(i.sheetIndex,i.tblObj.tblId,i.tblObj.fnNumber,i.destinationRange,!1),this.isUndefined(i.destinationCFormat)||i.destinationCFormat instanceof Array||this.XLCFormat.setCFRule(i.destinationCFormat),this.setHeightToRows(i.destHeight),this.setActiveCell(i.destinationRange[0],i.destinationRange[1]),this.XLSelection.selectRange({rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]},{rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]},i.sheetIndex),r._startCell={rowIndex:i.destinationRange[0],colIndex:i.destinationRange[1]},r._endCell={rowIndex:i.destinationRange[2],colIndex:i.destinationRange[3]},this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement())},_undoForPivot:function(n){var t=this._isUndo?this._undoCollection:this._redoCollection,i={curOperation:n,prevOperation:t[t.length-1],isUndo:this._isUndo};this._trigger("_readUndoRedo",i)},_undoForResizeCol:function(n){this.XLResize._resizeColumnUsingDiff(n.oldWidth,n.newWidth,n.cols);var t=n.oldWidth;n.oldWidth=n.newWidth;n.newWidth=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeRow:function(n){this.XLResize._resizeRowUsingDiff(n.oldHeight,n.newHeight,n.rows);var t=n.oldHeight;n.oldHeight=n.newHeight;n.newHeight=t;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForResizeFHeight:function(n){var t=this._isUndo,i=n.newHeight;n.newHeight=n.oldHeight;n.oldHeight=i;this.XLResize.setRowHeight(n.rowIndex,n.newHeight);this._isUndo?this.XLEdit._clearDataContainer({sheetIdx:n.sheetIndex,cellIdx:{rowIndex:n.rowIndex,colIndex:0},property:["isFitHeight"]}):this.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:0},{dataObj:{isFitHeight:!0}});this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isUndo=t},_undoForResizeFWidth:function(n){var t=this.getCell(0,n.colIndex).get(0),i=this._isUndo,r=n.newWidth;n.newWidth=t.offsetWidth===n.oldWidth?n.newWidth:n.oldWidth;n.oldWidth=r;this.XLResize._applyWidth(n.target,n.sheetIndex,n.colIndex,n.newWidth);this.XLScroll._getColWidths(n.sheetIndex,n.colIndex);this._isUndo?this.XLEdit._clearDataContainer({sheetIdx:n.sheetIndex,cellIdx:{rowIndex:0,colIndex:n.colIndex},property:["isFitWidth"]}):this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n.colIndex},{dataObj:{isFitWidth:!0}});this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isUndo=i},_undoForShape:function(i){var u,r,v,b,nt=0,k,ot=this.getSheet(i.sheetIndex).shapeMngr,y,p,l,rt,c,ut,w,ft,g,h,e,s,a,et;this.model.showRibbon&&(k=this.XLRibbon._chartThemes);i.action!="chartType"&&i.action!=="create"&&i.action!=="remove"&&i.action!=="edit"&&i.action!=="border"&&i.action!=="resetpicture"&&i.action!=="changepicture"&&i.action!=="picturesize"&&i.action!=="chartTheme"&&i.action!=="chartType"&&i.action!=="selectData"&&(u=n("#"+i.cid).data("ejChart"),r=this.getSheet(i.sheetIndex).shapeMngr.chart[this.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"chart")[0]]);switch(i.action){case"remove":this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.position.top,i.position.left);this.XLShape._deleteShape(i.sheetIndex,n("#"+i.id));i.action="create";break;case"create":i.shapeType==="picture"?(this.XLShape._createPicture(i.sheetIndex,i.actCell,i.img,i.position.top,i.position.left,i.position.width,i.position.height,i.cnt),this.XLRibbon._formatTabUpdate(),n(i.actCell).addClass("e-activecell")):(this.XLSelection.selectRange({rowIndex:i.range[0],colIndex:i.range[1]},{rowIndex:i.range[0],colIndex:i.range[1]},i.sheetIndex),this.setActiveCell(i.range[0],i.range[1],i.sheetIndex),this.XLChart.createChart(this._getAlphaRange(i.sheetIndex,i.range[0],i.range[1],i.range[2],i.range[3]),i.options,i.id));i.action="remove";break;case"edit":var tt,h=this._dataContainer.sheets[i.sheetIndex],o=i.id.split("_")[1].replace(/[0-9]/g,""),d={},it,f;n("#"+i.id).css({left:i.prev.left,top:i.prev.top,height:i.prev.height,width:i.prev.width});o==="chart"&&this.XLChart.resizeChart(i.id,i.prev.height,i.prev.width);i.visualImg.hide();this.XLShape._picCellIdx=this.XLShape._getCellIndexFromOffset(i.prev.top,i.prev.left);f=this.XLShape._getCellIndexFromOffset(i.cur.top,i.cur.left);tt=this._getShapePositionInManager(f.rowIndex,f.colIndex,i.id,o);d[o]=i.obj[o][tt];i.actionType!="resize"&&(this.getObjectLength(h[f.rowIndex][f.colIndex])<2&&h[f.rowIndex][f.colIndex][o].length<2?delete h[f.rowIndex][f.colIndex]:h[f.rowIndex][f.colIndex][o].length<2?delete h[f.rowIndex][f.colIndex][o]:(h[f.rowIndex][f.colIndex][o].some(function(n,t){if(d.id===n.id)return it=t,!0}),h[f.rowIndex][f.colIndex][o].splice(it,1)));this.XLEdit._updateDataContainer({rowIndex:this.XLShape._picCellIdx.rowIndex,colIndex:this.XLShape._picCellIdx.colIndex},{dataObj:d});this.getCell(this.XLShape._picCellIdx.rowIndex,this.XLShape._picCellIdx.colIndex,i.sheetIndex).addClass("e-activecell");this.model.showRibbon&&this.element.find(".e-ss-activeimg").length<1&&(o==="picture"?this.XLRibbon._toggleFormatTab():this.XLRibbon._toggleChartDesignTab());this.XLRibbon._setShapeWidthHeight({width:i.prev.width,height:i.prev.height,shapeType:o});this._swapVal(i);break;case"PHAxis":case"PVAxis":y=i.action=="PHAxis"?"primaryXAxis":"primaryYAxis";p=i.action==="PHAxis"?"xAxis":"yAxis";i.visibility=!i.visibility;u.option(y,{visible:i.visibility});r[p].visible=i.visibility;break;case"PX":case"PY":y=i.action=="PX"?"primaryXAxis":"primaryYAxis";p=i.action==="PX"?"xAxis":"yAxis";t.isNullOrUndefined(i.prev.text)&&(i.prev.text="");u.option(y,{title:{text:i.prev.text}});r[p].title.text=i.prev.text;this._swapVal(i);break;case"CT":u.option("title",{textAlignment:i.prev.align,text:i.prev.text});r.title={text:i.prev.text,textAlignment:i.prev.align};this._swapVal(i);break;case"DLNone":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible};this._swapVal(i);break;case"DL":u.option({series:i.prev.series});r.dataLabel={visible:i.prev.series[0].marker.dataLabel.visible,vAlign:i.prev.series[0].marker.dataLabel.verticalTextAlignment,tPosn:i.prev.series[0].marker.dataLabel.textPosition};this._swapVal(i);break;case"PMajorH":i.visibility=!i.visibility;u.option("primaryYAxis",{majorGridLines:{visible:i.visibility}});r.yAxis.majorGridLines={visible:i.visibility};break;case"PMajorV":i.visibility=!i.visibility;u.option("primaryXAxis",{majorGridLines:{visible:i.visibility}});r.xAxis.majorGridLines={visible:i.visibility};break;case"PMinorH":i.visibility=!i.visibility;u.option("primaryYAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.yAxis.minorGridLines={visible:i.visibility};break;case"PMinorV":i.visibility=!i.visibility;u.option("primaryXAxis",{minorGridLines:{visible:i.visibility},minorTicksPerInterval:5,minorTickLines:{visible:i.visibility}});r.xAxis.minorGridLines={visible:i.visibility};break;case"LNone":i.visibility=!i.visibility;u.option("legend",{visible:i.visibility});r.legend.visible=i.visibility;break;case"Legend":u.option("legend",{position:i.prev.position});r.legend.position=i.prev.position;this._swapVal(i);break;case"width":s={width:i.prev.width,height:i.prev.height,shapeType:"chart"};l=n("#"+u._id);u.option("size",n.extend(!0,{},s));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.height;this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"height":s={width:i.prev.width,height:i.prev.height,shapeType:"chart"};l=n("#"+u._id);u.option("size",n.extend(!0,{},s));l[0].style.height=i.prev.height+"px";l[0].style.width=i.prev.width+"px";r.width=i.prev.width;r.height=i.prev.Height;this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"srcolumn":u.model.series.length=0;r.isRowColSwitched=!r.isRowColSwitched;rt={xRange:r.xRange,yRange:r.yRange,lRange:r.lRange,isRowColSwitched:r.isRowColSwitched,dataSheetIdx:r.dataSheetIdx};c=this.XLChart._processChartSeries(rt);u.option({series:c.series});this.getActiveSheetIndex()===r.dataSheetIdx&&this.XLChart._focusChartRange(c.xRange,c.yRange,c.lRange);r.xAxis.range=c.xRange;r.yAxis.range=c.yRange;r.legend.range=c.lRange;break;case"border":ft=this._dataContainer.sheets[i.sheetIndex][i.cellIdx.rowIndex][i.cellIdx.colIndex].picture[i.picIdx];e=n("#"+i.id);this._removeClass(e[0],i.curClass);this.addClass(e[0],i.prevClass);w=this.XLShape._getImgStyleFromHashCode(i.prevClass);ft={bcolor:w["border-color"],bstyle:w["border-style"],bwidth:w["border-width"]};ut=i.prevClass;i.prevClass=i.curClass;i.curClass=ut;break;case"resetpicture":e=n("#"+i.id);g=new RegExp("\\be-shapebdr.*?\\b","g");this._isUndo?e[0].className.match(g)&&this.XLShape.changePictureBorder(e[0].id,i.prev.bwidth,i.prev.bstyle,i.prev.bcolor):e[0].className=e[0].className.replace(g,"");i.actionType!=="resetpicture"&&(e.css({width:i.prev.width,height:i.prev.height}),this.XLShape._selectImg(e),this.XLShape._updateShapeObj(e[0]));this._swapVal(i);break;case"changepicture":h=this._dataContainer;n("#"+i.id).css("background-image","url('"+i.prev.img+"')");ot.picture[i.prev.pcIdx].data=i.prev.data;this._swapVal(i);break;case"picturesize":e=n("#"+i.id);s={width:i.prev.width,height:i.prev.height,shapeType:"picture"};e.css(s);this.XLRibbon._setShapeWidthHeight(s);this._swapVal(i);break;case"chartTheme":for(v=this.element.find("#"+this._id+"_chart").val(),b=n("#"+this._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes").data("ejDropDownList"),i.prev.theme.indexOf("dark")>-1?n("#"+v).addClass("e-ss-charttheme"):n("#"+v).removeClass("e-ss-charttheme"),this.XLChart.refreshChart(v,{theme:i.prev.theme}),a=0,et=k.length;et>a;a++)if(i.prev.theme===k[a].value.toLowerCase()){nt=a;break}b&&b.option({selectedItemIndex:nt});this._swapVal(i);break;case"chartType":this.XLChart.refreshChart(i.chartId,{type:i.prev.chartType,enable3D:i.prev.enable3D,marker:i.prev.marker});this._swapVal(i);break;case"selectData":this.XLChart.changeDataRange(document.getElementById(this._id+"_chart").value,i.prev.xRange,i.prev.yRange,i.prev.lRange);this._swapVal(i)}},_undoForShowHide:function(n){var t,i,r,u,f,e,o;if(n.operation==="row"){for(r=this._getJSSheetRowHeaderContent(n.sheetIndex),n.action==="show"?this._hideRow(n.hideRows[0],n.hideRows[n.hideRows.length-1],"isRHide"):this._showRow(n.hideRows[0],n.hideRows[n.hideRows.length-1],"isRHide"),t=0,i=n.remBRows.length;t<i;t++)this.addClass(r.find("td")[n.remBRows[t]],"e-hrow"),this.XLEdit._updateDataContainer({rowIndex:n.remBRows[t],colIndex:0},{dataObj:{hRow:!0}});for(t=0,i=n.addBRows.length;t<i;t++)this._removeClass(r.find("td")[n.addBRows[t]],"e-hrow"),this._dataContainer.sheets[n.sheetIndex][n.addBRows[t]][0].hRow;this.setActiveCell(n.bSelect.startRow,0);n.bSelect.startRow===n.bSelect.endRow?this.XLSelection.selectRow(n.bSelect.startRow,n.sheetIndex):this.XLSelection.selectRows(n.bSelect.startRow,n.bSelect.endRow,n.sheetIndex);f=n.addBRows;n.addBRows=n.remBRows;n.remBRows=f}else{for(u=this._getJSSheetHeader(n.sheetIndex).find("th"),n.action==="show"?this._hideColumn(n.hideCols[0],n.hideCols[n.hideCols.length-1]):this._showColumn(n.hideCols[0],n.hideCols[n.hideCols.length-1]),t=0,i=n.remBCols.length;t<i;t++)this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n.remBCols[t]},{dataObj:{hCol:!0}}),this.addClass(u[n.remBCols[t]],"e-hcol");for(t=0,i=n.addBCols.length;t<i;t++)this._removeClass(u[n.addBCols[t]],"e-hcol"),this._dataContainer.sheets[n.sheetIndex][0][n.addBCols[t]].hCol;this.setActiveCell(0,n.bSelect.startCol);n.bSelect.startCol===n.bSelect.endCol?this.XLSelection.selectColumn(n.bSelect.startCol,n.sheetIndex):this.XLSelection.selectColumns(n.bSelect.startCol,n.bSelect.endCol,n.sheetIndex);e=n.addBCols;n.addBCols=n.remBCols;n.remBCols=e}n.action=n.action==="show"?"hide":"show";o=n.bSelect;n.bSelect=n.aSelect;n.aSelect=o;this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForSort:function(n){var o=this.XLEdit.getColumnIndexByField(n.columnName),u,i,r,f,e=this.getSheet(n.sheetIndex)._filterColl,t;if(n.colSelected<1&&(f=n.range[0],n.range[0]>0&&(f=n.range[0]-1)),n.operation==="unsort"?(this._dupDetails=!0,this.XLComment.deleteComment(n.range,null,!0,null),this._removeHyperlink(null,null,!0,n.range),this.clearRangeData(n.range,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0),this.XLFormat.removeStyle(n.range,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0}),this.XLEdit.updateCellWithContainer(n.rangeData,n.range,n.sheetIndex,!0),this._dupDetails=!1,n.operation="sort"):(this.XLSort._isSortByFilter=n.isSortByFilter,this.XLSort.sortByRange(n.range,n.columnName,n.direction),n.operation="unsort"),n.isSortByFilter)for(t=0;t<n.filterIcons.length;t++)r=e[n.filterIcons[t].rowIdx][n.filterIcons[t].colIdx],r.status=r.status.indexOf("-asc")>1?r.status.replace("-asc",n.filterIcons[t].prevIcon):r.status.indexOf("-dsc")>1?r.status.replace("-dsc",n.filterIcons[t].prevIcon):r.status+n.filterIcons[t].prevIcon,this._isRowViewable(n.sheetIndex,n.filterIcons[t].rowIdx)&&(i=this.getCell(n.filterIcons[t].rowIdx,n.filterIcons[t].colIdx).find(".e-filterspan")[0],i.className=i.className.indexOf("-asc")>1?i.className.replace("-asc",n.filterIcons[t].prevIcon):i.className.indexOf("-dsc")>1?i.className.replace("-dsc",n.filterIcons[t].prevIcon):i.className.indexOf("e-ssfiltered")>-1?i.className.replace("e-ssfiltered","e-ssfiltered"+n.filterIcons[t].prevIcon):i.className.replace("e-ssfilter","e-ssfilter"+n.filterIcons[t].prevIcon)),u=n.filterIcons[t].prevIcon,n.filterIcons[t].prevIcon=n.filterIcons[t].currIcon,n.filterIcons[t].currIcon=u},_undoForSortByColor:function(n){var t=n.range,r=n.prev.data,u=this._generateColCount(n.columnName)-1,i;this.XLComment.deleteComment(t,null,!0,null);this._isSort=!0;this._dupDetails=!0;this._removeHyperlink(null,null,!0,t);this._isSort=!1;this._dupDetails=!1;this.clearRangeData(t,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);this.XLFormat.removeStyle(t,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});this.XLEdit.updateCellWithContainer(r,t,n.sheetIndex,!0);n.oprType.indexOf("Put")<0&&(i=this.getCell(t[0]-1,u).find(".e-filterspan"),i.length>0&&(i[0].className=i[0].className.replace(n.cur.icon,n.prev.icon)));this._swapVal(n)},_undoForStyle:function(n){this.XLFormat.updateUniqueFormat(n.beforeFormat,n.range);this._updateRangeStyle(n.range,n.beforeFormat);var t=this.changePosition(n.beforeFormat,n.afterFormat);this._refreshRangeTRHght(this.getActiveSheetIndex(),n.range);n.beforeFormat=t[1];n.afterFormat=t[0];this._isUndoRedo=!0;n.status="undo-cellstyles"},_undoForTextWrap:function(n){n.operation==="wrap"?(this.setWrapText("unwrap",n.range),n.operation="unwrap"):(this.setWrapText("wrap",n.range),n.operation="wrap");this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()},_undoForValidation:function(n){var i,f,e=this.getRangeIndices(n.range),r,u,s,o;if(this.performSelection({rowIndex:e[0],colIndex:e[1]},{rowIndex:e[2],colIndex:e[3]}),n.operation==="cl-hl-data")this.XLValidate.highlightInvalidData(n.range),n.operation="hl-data";else if(n.operation==="apply-validation"){for(r=n.selectedCell,o=[],i=0,f=r.length;i<f;i++)s=this.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"rule"),u=this.changePosition(r[i].prevRule,s),n.selectedCell[i].prevRule=u[1],t.isNullOrUndefined(u[0])||(u[0].customVal=u[0].customVal,this.XLEdit._updateDataContainer({rowIndex:r[i].rowIndex,colIndex:r[i].colIndex},{dataObj:{rule:u[0]}})),o.push(r[i]);t.isNullOrUndefined(u[0])&&this.clearRangeData(null,["rule"],o)}else if(n.operation==="hl-data")this.XLValidate.clearHighlightedValData(n.range),n.operation="cl-hl-data";else if(this._isUndo){for(i=0,f=n.selectedCell.length;i<f;i++)this.XLEdit._updateDataContainer({rowIndex:n.selectedCell[i].rowIndex,colIndex:n.selectedCell[i].colIndex},{dataObj:{rule:n.selectedCell[i].rules}});n.hlStatus&&this.XLValidate.highlightInvalidData(n.range)}else this.XLValidate.clearDV(n.range)},_applyCommentLink:function(i,r,u,f){var a=this._dataContainer,w=a.cFormatData,e,c=!1,l=this.getActiveSheetIndex(),v,y,o,h,p,s;if(this._isRowViewable(l,r.rowIndex)&&(e=this.getCell(r.rowIndex,r.colIndex),c=!0,n(e).removeClass("e-redft e-yellowft e-greenft e-redf e-redt")),i){if(v=this.isNumber(i.value2)?a.sharedData[i.value2]:i.value2,this.XLEdit._updateCellValue(r,v),"cFormatRule"in i)for(y=i.cFormatRule,h=0,p=y.length;h<p;h++)o=w[h].split("_"),this.XLCFormat._cFormat(o[0],o[2],o[3],o[4],null,null,[u,f,u,f]);"hyperlink"in i&&(s=i.hyperlink,c&&(s&&!s.webAddr?e.html(t.buildTag("a.e-hyperlinks",this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",l),"",{href:"#"})):e.html(t.buildTag("a.e-hyperlinks",this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",l),"",{href:s.webAddr,target:"_blank"}))));"comment"in i&&(c&&e.removeClass("e-commentcell"),this.XLComment.setComment([r.rowIndex,r.colIndex,r.rowIndex,r.colIndex],null,!1))}},changePosition:function(n,i){var r=[];return r.push(i),r.push(n),t.swap(r,0,1),r},_addValidationRule:function(t,i){var u=[],r,f;for(n.extend(!0,u,t),r=0,f=t.length;r<f;r++)t[r].customVal!==i.customVal&&t[r].required!==i.required&&t[r].Number!==i.number&&u.push(i);return u},_addCondFormatRule:function(t,i){var f=!1,u=[],r,e;for(n.extend(!0,u,t),r=0,e=t.length;r<e;r++)if(i=i.indexOf("true")>-1?i.replace("_true",""):i.replace("_false",""),t[r]===i){f=!0;break}return f||u.push(i),u},getCellClass:function(n){var t=this._formatRegx;return n&&n.className.indexOf("e-format")>-1?n.className.match(t)[0]:""},_renderInsertDeleteDialog:function(){var n=this._id+"_insertdeletedlg",i,r,u,f,e,o;i=t.buildTag("div#"+n,"",{display:"none"});o=t.buildTag("div#"+n+"_content.e-dlg-fields e-dlgctndiv");i.append(o);f=t.buildTag("div#"+n+"_btndiv.e-dlg-btnfields");e=t.buildTag("div");r=t.buildTag("input#"+n+"_okbtn","",{"margin-left":4});u=t.buildTag("input#"+n+"_cantn");r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:this._isMaterial?64:"40%",click:t.proxy(this._insertDeleteOk,this),enabled:!0});u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._insertDeleteCancel,this),showRoundedCorner:!0,width:this._isMaterial?64:"40%"});f.append(e.append(r,u));i.append(f);i.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,width:this._isMaterial?260:187,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",minWidth:150})},_refreshInsDelDialog:function(t){var i=n("#"+this._id+"_insertdeletedlg"),r,u;i.ejDialog({title:this._getLocStr(t)});i.ejDialog("open");this._insDelStatus=t.toLowerCase();r=n("#"+i[0].id+"_content");u=this._insDelStatus==="insert"?["ShiftRight","ShiftBottom","EntireRow","EntireColumn"]:["ShiftLeft","ShiftUp","EntireRow","EntireColumn"];r.children().empty();this._createRadioButton(i,r,u);enableBtn=this._insDelStatus==="insert"?"ShiftBottom":"ShiftLeft";n("#"+i[0].id+"_"+enableBtn).ejRadioButton({checked:!0});i.find("input[type='submit']:first").focus()},_createRadioButton:function(n,i,r){var o,h,s,e,u,f,c;for(s=t.buildTag("table"),f=0,c=r.length;f<c;f++)e=t.buildTag("tr"),u=t.buildTag("td"),h=t.buildTag("label",this._getLocStr(r[f]),{"padding-bottom":4},{"for":n[0].id+"_"+r[f]}),o=t.buildTag("input#"+n[0].id+"_"+r[f],"",{},{type:"radio",name:"inserdelete"}),u.append(o),e.append(u),u=t.buildTag("td"),u.append(h),o.ejRadioButton({size:"medium"}),e.append(u),s.append(e);i.append(s)},_getSelectedOption:function(t){for(var u,f=this._id+"_insertdeletedlg",r=0,i=0;i<4;i++)if(u=n("#"+f+"_"+t[i]).data("ejRadioButton"),u.model.checked){r=i;break}return r},_insertDeleteOk:function(){var o,f;this._isUndo=!1;this._isUndoRedo=!1;this._delCells=[];this._deletedText=[];this._removeMergeColl=[];this._deletedDimension=[];var t,i,e=this.getActiveSheetIndex(),r=this.model.sheets[e]._selectedCells[0],u=this.model.sheets[e]._selectedCells[this.model.sheets[e]._selectedCells.length-1];for(this._insDelStatus.indexOf("insert")>-1?(t=["ShiftRight","ShiftBottom","EntireRow","EntireColumn"],i=this._getSelectedOption(t),t[i].indexOf("ShiftRight")>-1?this.insertShiftRight(r,u):t[i].indexOf("ShiftBottom")>-1?this.insertShiftBottom(r,u):t[i].indexOf("EntireRow")>-1?this.insertEntireRow(r.rowIndex,u.rowIndex):this.insertEntireColumn(r.colIndex,u.colIndex)):(t=["ShiftLeft","ShiftUp","EntireRow","EntireColumn"],i=this._getSelectedOption(t),t[i].indexOf("ShiftLeft")>-1?this.deleteShiftLeft(r,u):t[i].indexOf("ShiftUp")>-1?this.deleteShiftUp(r,u):t[i].indexOf("EntireRow")>-1?this.deleteEntireRow(r.rowIndex,u.rowIndex):this.deleteEntireColumn(r.colIndex,u.colIndex)),n("#"+this._id+"_insertdeletedlg").ejDialog("close"),o=this.model.sheets[this.model.activeSheetIndex].shapeMngr.chart,f=0;f<o.length;f++)this.XLChart._refreshChart(o[f])},_insertDeleteCancel:function(){n("#"+this._id+"_insertdeletedlg").ejDialog("close")},_undoredoDetails:function(t,i,r,u,f){var e={sheetIndex:t,startCell:i,endCell:r,reqType:u,action:f,delCells:n.extend(!0,[],this._delCells),text:this._deletedText,deletedDimension:this._deletedDimension,removeMerge:this._removeMergeColl,fRow:n.extend(!0,{},this._fRow),fCol:n.extend(!0,{},this._fCol)};this.isImport||this._isExport||this._intrnlReq||this._completeAction(e);this._removeMergeColl=[];this._delCells=[];this._fRow.fRowCnt=0;this._fCol.fColCnt=0},_getRangeFrmFormula:function(n){var t=n.substring(n.indexOf("(")+1,n.indexOf(")")),i=new RegExp("^\\b[a-zA-Z][0-9]*:[a-zA-Z][0-9]*\\b$","g");if(i.test(t))return t;if(t.indexOf(",")>1){if(i.test(t.split(",")[1]))return t.split(",")[1];if(i.test(t.replace(",",":")))return t.replace(",",":")}},_refreshFormula:function(n,i,r,u,f,e,o){var y=this.getActiveSheetIndex(),c,h,a=this.XLEdit.getPropertyValue(n,i,"value"),l,v,s,p,w=this.getSheet(y);if((!this._isUndo||this._formulaChanged.pop()!=="true")&&this.isFormula(a)){if(l=this._getRangeFrmFormula(a),t.isNullOrUndefined(l))return;s=this.getRangeIndices(l);c=f==="column"?u==="insert"?s[3]+r:s[3]-r:u==="insert"?s[2]+r:s[2]-r;h=f==="column"?u==="insert"?s[1]+r:s[1]-r:u==="insert"?s[0]+r:s[0]-r;f==="column"?e>s[1]&&(h=s[1]):e>s[0]&&(h=s[0]);f==="column"?e>s[3]&&(c=s[3]):e>s[2]&&(c=s[2]);o&&(s[1]===s[3]||s[0]!==s[2]||(f==="column"?s[1]===s[3]&&(c=s[3],h=s[1]):s[0]===s[2]&&(c=s[2],h=s[0])),f==="column"?c<s[1]&&(c=s[3]):c<s[0]&&(c=s[2]),f==="column"?h<s[1]&&(h=s[1]):h<s[0]&&(h=s[0]),f==="row"&&(u==="delete"?h<s[2]&&s[1]!=i&&(c=s[2],h=s[0]):s[1]!=i&&(c=s[2],h=s[0])),f==="column"&&(u==="delete"?h<s[3]&&s[0]!=n&&(c=s[3],h=s[1]):s[0]!=n&&(c=s[3],h=s[1])));v=f==="column"?this._getAlphaRange(y,s[0],h,s[2],c):this._getAlphaRange(y,h,s[1],c,s[3]);n===s[0]&&i===s[1]&&(v="#REF!",this._ref.push(l));this._isUndo&&l==="#REF!"&&(v=this._ref.pop());a=a.replace(l,v);p=new ValueChangedArgs(n+1,i+1,a);this._calcEngine.valueChanged(w.sheetInfo.value,p);this.XLEdit._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{value:a}});this._applyFormula(y,n,i);this._isUndo||(l===v?this._formulaChanged.push("true"):this._formulaChanged.push("false"))}},_applyFormula:function(n,i,r){var u,f=this.getSheet(n),e=f._formulaCollection[i];t.isNullOrUndefined(e)&&(f._formulaCollection[i]={});u=this._calcEngine.getFormulaInfoTable().values();f._formulaCollection[i][r]=u[u.length-1]},_clearFormula:function(n,t){var u,f,i,e=this.getActiveSheetIndex(),s=this.XLEdit.getPropertyValue(n,t,"value"),r,o;if(this.isFormula(s)){for(u=this.model.sheets[e]._formulaCollection[n][t],i=this._calcEngine.getFormulaInfoTable().values(),f=i.indexOf(u),i.splice(f,1),this._calcEngine.getFormulaInfoTable().clear(),r=0,o=i.length;r<o;r++)this._calcEngine.getFormulaInfoTable().add(i[r]);delete this.model.sheets[e]._formulaCollection[n][t]}},_refreshValAndCF:function(n,t,i,r){var e=this._dataContainer.sheets[this.getActiveSheetIndex()],u=this._dataContainer.cFormatData,f;this.isUndefined(i)&&this.isUndefined(r)?delete e[n][t]:(this.isUndefined(i)||(e[n][t]={rule:i}),this.isUndefined(r)||(f=u[r[0]].replace("true","false"),u.indexOf(f)<0&&u.push(f),e[n][t]={cFormatRule:[u.indexOf(f)]}))},_refreshRows:function(n){var t=this._getRowHdrTBody(n).find("tr"),i=this._getContTBody(n).find("tr");this.setRows([t,i],n)},_refreshFilterColl:function(t,i,r,u,f){var s=this.getSheet(t),l=s._filterColl,h=this.getObjectKeys(l),c,e,o;if(u==="row")if(f==="insert")for(e=parseInt(h[h.length-1]);e>=parseInt(h[0]);e--)e=parseInt(e),e>=i&&(s._filterColl[e+r]=n.extend(!0,{},s._filterColl[e]),delete s._filterColl[e]);else for(e=parseInt(h[0]);e<=parseInt(h[h.length-1]);e++)e=parseInt(e),e>=i&&(s._filterColl[e-r]=n.extend(!0,{},s._filterColl[e]),delete s._filterColl[e]);else for(e=parseInt(h[0]);e<=parseInt(h[h.length-1]);e++)if(c=this.getObjectKeys(s._filterColl[e]),f==="insert")for(o=parseInt(c[c.length-1]);o>=parseInt(c[0]);o--)o=parseInt(o),o>=i&&(s._filterColl[e][o+r]=n.extend(!0,{},s._filterColl[e][o]),delete s._filterColl[e][o]);else for(o=parseInt(c[0]);o<=parseInt(c[c.length-1]);o++)o=parseInt(o),o>=i&&(s._filterColl[e][o-r]=n.extend(!0,{},s._filterColl[e][o]),delete s._filterColl[e][o])},_refreshDataContainer:function(i,r){var y,bt,p,kt,ot,st,f,o,a,dt,et=0,gt=0,ni,ct,b,k,ri=0,ui=0,e=this._dataContainer.sheets[i],ti,yt,fi,s,c,l,ht,d,g,it,lt=this.model.scrollSettings.allowVirtualScrolling,h=this.getSheet(i),pt=h.usedRange,rt=this.getFrozenRows(),ut=this.getFrozenColumns(),tt,u,w,vt,ii,nt,wt,ft,ei,v,at;for(ct=parseInt(this.getObjectKeys(e)[this.getObjectLength(e)-1]),v=h.rowsHeightCollection,u=0;u<=ct;u++)t.isNullOrUndefined(e[u])||(ni=this.getObjectKeys(e[u]),gt=parseInt(ni[ni.length-1]),gt>et&&(et=gt));if(fi=r.startCol<=et?r.colCount+r.startCol:et-1,ti=r.status.indexOf("shift")>-1?fi:et-1,yt=r.status.indexOf("shift")>-1?r.rowCount+r.startRow:ct,y=r.startRow,bt=r.startRow+r.rowCount-1,p=r.startCol,kt=r.startCol+r.colCount-1,this._isFrozen(rt-1)&&rt>y){for(u=h._frozenRows-1;u<h._ftopRowIdx;u++)ri+=h.rowsHeightCollection[u];this._scrollContent({y:-ri})}if(this._isFrozen(ut-1)&&ut>p){for(u=h._frozenColumns-1;u<h._fleftColIdx;u++)ui+=h.columnsWidthCollection[u];this._scrollContent({x:-ui})}switch(r.status){case"insertRow":for(u=ct,a=r.startRow;u>=a;u--){if(!t.isNullOrUndefined(e[u])){if(e[u+r.rowCount]=n.extend(!0,{},e[u]),!t.isNullOrUndefined(e[u+r.rowCount]))for(l=this.getObjectKeys(e[u+r.rowCount]),f=0,dt=l.length;f<dt;f++)this._clearFormula(u,l[f]),this._checkIndicesInContainer(i,u,l[f],"wrap")&&(this._wrapCollection(u+r.rowCount,l[f],h._wrapColl[u][l[f]],i),delete h._wrapColl[u][l[f]]),u>=y&&u<=bt?(this._checkIndicesInContainer(i,y,l[f],"rule")&&(ot=this._dataContainer.sheets[i][y][l[f]].rule),this._checkIndicesInContainer(i,y,l[f],"cFormatRule")&&(st=this._dataContainer.sheets[i][y][l[f]].cFormatRule),this._refreshValAndCF(u,l[f],ot,st,r.rowCount,0),lt||y<1||this.addClass(this.getCell(u,l[f])[0],this.XLFormat.getFormatClass(this.getCell(y-1,l[f])[0].className,!1))):delete e[u][l[f]],this._refreshFormula(u+r.rowCount,parseInt(l[f]),r.rowCount,"insert","row",r.startRow,!1),this.XLEdit._refreshCalcEngine(u+r.rowCount,parseInt(l[f]));this.getObjectLength(e[u])<1&&delete e[u]}v[u+r.rowCount]=v[u];v[u]=this.model.rowHeight}if(this._refreshFilterColl(i,r.startRow,r.rowCount,"row","insert"),this._isUndo&&this._delCells.length>0){for(s=this._delCells,ht=s[s.length-1].row-s[0].row,u=0,a=s.length;u<a;u++){for(e[s[u].row]=s[u].value,l=this.getObjectKeys(e[s[u].row]),f=0,dt=l.length;f<dt;f++)this._refreshFormula(s[u].row,parseInt(l[f]),ht,"insert","row","",!1),this.XLEdit._refreshCalcEngine(s[u].row,parseInt(l[f])),this._checkIndicesInContainer(i,s[u].row,l[f],"wrap")&&this._wrapCollection(s[u].row,l[f],this._delWrapColl[s[u].row][l[f]],i);v[s[u].row]=s[u].height}this._delWrapColl={}}this.model.allowFreezing&&this._isFrozen(rt)&&(y<rt||this._isUndo&&this._fRow.fRowCnt>0)&&(b=h.frozenRows+(this._fRow.fRowCnt>0?this._fRow.fRowCnt:r.rowCount),k=h.frozenColumns,this._fRow.fRowCnt=0,this._fRow.rowAdj||(b-=1,this._fRow.rowAdj=!this._fRow.rowAdj),this._isFrozen(ut)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(b,k)):this.XLFreeze.freezeRows(b));this.XLScroll._getRowHeights(i,r.startRow);break;case"insertColumn":for(u=0;u<=yt;u++)for(f=et,a=r.startCol;f>=a;f--)d=g=null,t.isNullOrUndefined(e[u])||(t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(e[u][f+r.colCount].picture)||(d=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(g=e[u][f+r.colCount].chart)),e[u][f+r.colCount]=e[u][f],t.isNullOrUndefined(e[u][f].picture)&&t.isNullOrUndefined(e[u][f].chart)||(t.isNullOrUndefined(e[u][f].picture)||(d=e[u][f].picture),t.isNullOrUndefined(e[u][f].chart)||(g=e[u][f].chart)),t.isNullOrUndefined(e[u][f+r.colCount])||(t.isNullOrUndefined(d)||(e[u][f+r.colCount].picture=d),t.isNullOrUndefined(g)||(e[u][f+r.colCount].chart=g)),e[u][f].wrap&&(this._wrapCollection(u,f+r.colCount,h._wrapColl[u][f],i),delete h._wrapColl[u][f])),this._clearFormula(u,f),f>=p&&f<=kt?(this._checkIndicesInContainer(i,u,p,"rule")&&(ot=this._dataContainer.sheets[i][u][p].rule),this._checkIndicesInContainer(i,u,p,"cFormatRule")&&(st=this._dataContainer.sheets[i][u][p].cFormatRule),this._refreshValAndCF(u,f,ot,st,0,r.colCount),lt||!p<1&&this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,p-1)[0].className,!1))):delete e[u][f],!t.isNullOrUndefined(e[u][f])||t.isNullOrUndefined(d)&&t.isNullOrUndefined(g)||(e[u][f]={}),t.isNullOrUndefined(d)||(e[u][f].picture=d),t.isNullOrUndefined(g)||(e[u][f].chart=g),this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!1),this.XLEdit._refreshCalcEngine(u,f+r.colCount));if(this._refreshFilterColl(i,r.startCol,r.colCount,"column","insert"),this.model.allowFreezing&&this._isFrozen(ut)&&(p<ut||this._isUndo&&this._fCol.fColCnt>0)&&(b=h.frozenRows,k=h.frozenColumns+(this._fCol.fColCnt>0?this._fCol.fColCnt:r.colCount),this._fCol.fColCnt=0,this._fCol.colAdj||(k-=1,this._fCol.colAdj=!this._fCol.colAdj),this._isFrozen(rt)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(b,k)):this.XLFreeze.freezeColumns(k)),this._isUndo&&this._delCells.length>0)for(s=this._delCells,ht=s[s.length-1].col-s[0].col,o=0,a=s.length;o<a;o++)t.isNullOrUndefined(e[s[o].row])&&(e[s[o].row]={}),e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,ht,"insert","column","",!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),s[o].value.wrap&&this._wrapCollection(s[o].row,s[o].col,s[o].height,i);break;case"deleteRow":for(this._delCells=[],c=[],u=r.startRow;u<=ct;u++){if(u<r.startRow+r.rowCount){if(this._delCells.push({row:u,value:n.extend(!0,{},e[u]),height:v[u]}),!t.isNullOrUndefined(e[u]))for(l=this.getObjectKeys(e[u]),f=0,a=l.length;f<a;f++)this._clearFormula(u,l[f]),this._checkIndicesInContainer(i,u,l[f],"wrap")&&(this._delWrapColl[u]||(this._delWrapColl[u]={}),this._delWrapColl[u][l[f]]=n.extend(!0,{},h._wrapColl[u][l[f]]),delete h._wrapColl[u][l[f]]),e[u][l[f]]={};e[u]={};c.push({row:u})}if(!t.isNullOrUndefined(e[u+r.rowCount])){for(e[u]=n.extend(!0,{},e[u+r.rowCount]),l=this.getObjectKeys(e[u]),f=0,a=l.length;f<a;f++)this._checkIndicesInContainer(i,u+r.rowCount,l[f],"wrap")&&(this._wrapCollection(u,l[f],h._wrapColl[u+r.rowCount][l[f]],i),delete h._wrapColl[u+r.rowCount][l[f]]),this._clearFormula(u+r.rowCount,l[f]),e[u+r.rowCount][l[f]]={},this._refreshFormula(u,parseInt(l[f]),r.rowCount,"delete","row",r.startRow,!1);e[u+r.rowCount]={};c.push({row:u+r.rowCount})}v[u]=v[u+r.rowCount];v[u+r.rowCount]=this.model.rowHeight}for(o=0,a=c.length;o<a;o++)this.getObjectLength(e[c[o].row])===0&&(this._clearFormula(c[o].row,c[o].col),delete e[c[o].row]);if(this._refreshFilterColl(i,r.startRow,r.rowCount,"row","delete"),this.XLScroll._getRowHeights(i,r.startRow),this.model.allowFreezing&&this._isFrozen(rt)&&y<rt){if(bt>=rt)for(u=y;u<rt;u++)this._fRow.fRowCnt++;else this._fRow.fRowCnt=0;b=h.frozenRows-(this._fRow.fRowCnt>0?this._fRow.fRowCnt:r.rowCount);k=h.frozenColumns;this._fRow.rowAdj=b>1;this._isFrozen(ut)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(this._fRow.rowAdj?b:1,k)):this.XLFreeze.freezeRows(this._fRow.rowAdj?b:1)}break;case"deleteColumn":for(this._delCells=[],c=[],u=0;u<=yt;u++){for(f=r.startCol;f<=et;f++)d=g=null,f<r.startCol+r.colCount&&(t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f],e[u][f].wrap?h._wrapColl[u][f]:v[u])}),this._clearFormula(u,f),e[u][f]={},t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(it=this._delCells.length-1,t.isNullOrUndefined(this._delCells[it].value.picture)||(e[u][f].picture=this._delCells[it].value.picture),t.isNullOrUndefined(this._delCells[it].value.chart)||(e[u][f].chart=this._delCells[it].value.chart)),c.push({row:u,col:f}),h._wrapColl[u]&&delete h._wrapColl[u][f])),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),e[u][f+r.colCount].wrap&&(this._wrapCollection(u,f,h._wrapColl[u][f+r.colCount],i),delete h._wrapColl[u][f+r.colCount]),t.isNullOrUndefined(e[u][f+r.colCount].picture)||(d=e[u][f+r.colCount].picture),t.isNullOrUndefined(e[u][f+r.colCount].chart)||(g=e[u][f+r.colCount].chart),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},t.isNullOrUndefined(d)||(e[u][f+r.colCount].picture=d),t.isNullOrUndefined(g)||(e[u][f+r.colCount].chart=g),t.isNullOrUndefined(this._delCells[this._delCells.length-1])||(it=this._delCells.length-1,t.isNullOrUndefined(this._delCells[it].value.picture)||(e[u][f].picture=this._delCells[it].value.picture),t.isNullOrUndefined(this._delCells[it].value.chart)||(e[u][f].chart=this._delCells[it].value.chart)),c.push({row:u,col:f+r.colCount}),this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!1),lt||this.XLComment&&this.XLComment._updateCmntFrmCntnr(u,f));for(o=0,a=c.length;o<a;o++)this.getObjectLength(e[c[o].row][c[o].col])===0&&(this._clearFormula(c[o].row,c[o].col),delete e[c[o].row][c[o].col]);c=[]}if(this.model.allowFreezing&&this._isFrozen(ut)&&p<ut){if(kt>=ut)for(u=p;u<ut;u++)this._fCol.fColCnt++;else this._fCol.fColCnt=0;b=h.frozenRows;k=h.frozenColumns-(this._fCol.fColCnt>0?this._fCol.fColCnt:r.colCount);this._fCol.colAdj=k>1;this._isFrozen(rt)?(this.XLFreeze.unfreezePanes(),this.XLFreeze.freezePanes(b,this._fCol.colAdj?k:1)):this.XLFreeze.freezeColumns(this._fCol.colAdj?k:1)}this._refreshFilterColl(i,r.startCol,r.colCount,"row","delete");break;case"shiftRight":for(u=r.startRow;u<yt;u++)for(f=et,a=r.startCol;f>=a;f--)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(e[u][f+r.colCount]=n.extend(!0,{},e[u][f]),e[u][f].wrap&&(this._wrapCollection(u,f+r.colCount,h._wrapColl[u][f],i),delete h._wrapColl[u][f]),this._clearFormula(u,f),f>=p&&f<=kt?(this._checkIndicesInContainer(i,u,p,"rule")&&(ot=this._dataContainer.sheets[i][u][p].rule),this._checkIndicesInContainer(i,u,p,"cFormatRule")&&(st=this._dataContainer.sheets[i][u][p].cFormatRule),this._refreshValAndCF(u,f,ot,st,0,r.colCount),p<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(u,p-1)[0].className,!1))):delete e[u][f],this._refreshFormula(u,f+r.colCount,r.colCount,"insert","column",r.startCol,!0),this.XLEdit._refreshCalcEngine(u,f+r.colCount),this.XLEdit._refreshCalcEngine(u,f));if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,ht=s[s.length-1].col-s[0].col,o=0,a=s.length;o<a;o++)e[s[o].row][s[o].col]=s[o].value,this._refreshFormula(s[o].row,s[o].col,ht,"insert","column",r.startRow,!1),this.XLEdit._refreshCalcEngine(s[o].row,s[o].col),lt||this.XLComment&&this.XLComment._updateCmntFrmCntnr(s[o].row,s[o].col),s[o].value.wrap&&this._wrapCollection(s[o].row,s[o].col,s[o].height,i);break;case"shiftLeft":for(this._delCells=[],c=[],u=r.startRow;u<yt;u++){for(f=r.startCol;f<=et;f++)f<r.startCol+r.colCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f]),height:e[u][f].wrap?h._wrapColl[u][f]:v[u]}),this._clearFormula(u,f),e[u][f].wrap&&delete h._wrapColl[u][f],e[u][f]={},c.push({row:u,col:f}))),t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f+r.colCount])||(e[u][f]=n.extend(!0,{},e[u][f+r.colCount]),e[u][f+r.colCount].wrap&&(this._wrapCollection(u,f,h._wrapColl[u][f+r.colCount],i),delete h._wrapColl[u][f+r.colCount]),nt=this.getCell(u+r.rowCount,f),tt=this.getCell(u,f),nt&&(currText=nt[0].outerHTML,this.clearTextNode(nt)),tt&&(remText=tt[0].outerHTML,this.clearTextNode(tt,this.XLEdit.getPropertyValue(u,f,"value2"))),c.push({row:u,col:f+r.colCount}),this._clearFormula(u,f+r.colCount),e[u][f+r.colCount]={},this._refreshFormula(u,f,r.colCount,"delete","column",r.startCol,!0),nt&&(nt[0].outerHTML=currText),tt&&(tt[0].outerHTML=remText)),this.XLEdit._refreshCalcEngine(u,f);for(o=0,a=c.length;o<a;o++)this.getObjectLength(e[c[o].row][c[o].col])===0&&(this._clearFormula(c[o].row,c[o].col),this.XLEdit._refreshCalcEngine(c[o].row,c[o].col),delete e[c[o].row][c[o].col]);c=[]}break;case"shiftBottom":for(ei=this.getSheet(i).columnsWidthCollection,v=this.getSheet(i).rowsHeightCollection,u=ct,a=r.startRow;u>=a;u--){for(ft=this._checkIndicesInContainer(i,u,0,"wrapRow"),f=r.startCol;f<ti;f++)t.isNullOrUndefined(e[u])||t.isNullOrUndefined(e[u][f])||(t.isNullOrUndefined(e[u+r.rowCount])&&(e[u+r.rowCount]={}),ft&&(at=h._wrapColl[u][f],v[u+r.rowCount]=t.max([at,v[u+r.rowCount]]),this._checkIndicesInContainer(i,u+r.rowCount,0,"wrapRow")||this.XLEdit._updateDataContainer({rowIndex:u+r.rowCount,colIndex:0},{dataObj:{wrapRow:!0}}),this._wrapCollection(u+r.rowCount,f,at,i)),e[u+r.rowCount][f]=n.extend(!0,{},e[u][f]),this._clearFormula(u,f),u>=y&&u<=bt?(this._checkIndicesInContainer(i,y,f,"rule")&&(ot=this._dataContainer.sheets[i][y][f].rule),this._checkIndicesInContainer(i,y,f,"cFormatRule")&&(st=this._dataContainer.sheets[i][y][f].cFormatRule),this._refreshValAndCF(u,f,ot,st,r.rowCount,0),lt||y<1||this.addClass(this.getCell(u,f)[0],this.XLFormat.getFormatClass(this.getCell(y-1,f)[0].className,!1))):delete e[u][f],ft&&delete h._wrapColl[u][f],this._refreshFormula(u+r.rowCount,f,r.rowCount,"insert","row",r.startRow,!0)),this.XLEdit._refreshCalcEngine(u,f),this.XLEdit._refreshCalcEngine(u+r.rowCount,f);ft&&(v[u]=t.max(this._getObjectValues(h._wrapColl[u])),v[u]||(v[u]=this.model.rowHeight),this.getObjectLength(h._wrapColl[u])||delete this._dataContainer.sheets[i][u][0].wrapRow);t.isNullOrUndefined(e[u])||this.getObjectLength(e[u])===0&&delete e[u]}if(this._isUndo&&this._delCells.length>0)for(s=this._delCells,ht=s[s.length-1].row-s[0].row,u=0,a=s.length;u<a;u++)w=s[u].row,vt=s[u].col,t.isNullOrUndefined(e[w])&&(e[w]={}),e[w][vt]=s[u].value,this._refreshFormula(w,vt,ht,"insert","row",r.startRow,!0),this.XLEdit._refreshCalcEngine(w,vt),ft=this._checkIndicesInContainer(i,w,0,"wrapRow"),ii=s[u].value.wrap,(ft||ii)&&(at=ii?s[u].height:this.model.rowHeight,v[w]=t.max([at,v[w]]),this._checkIndicesInContainer(i,w,0,"wrapRow")||this.XLEdit._updateDataContainer({rowIndex:w,colIndex:0},{dataObj:{wrapRow:!0}}),this._wrapCollection(w,vt,at,i)),lt||this.XLComment&&this.XLComment._updateCmntFrmCntnr(w,vt);break;case"shiftUp":for(c=[],ei=this.getSheet(i).columnsWidthCollection,v=this.getSheet(i).rowsHeightCollection,u=r.startRow;u<=ct;u++){for(wt=this._checkIndicesInContainer(i,u,0,"wrapRow"),ft=this._checkIndicesInContainer(i,u+r.rowCount,0,"wrapRow"),f=r.startCol;f<ti;f++)u<r.startRow+r.rowCount&&!t.isNullOrUndefined(e[u])&&(t.isNullOrUndefined(e[u][f])||(this._delCells.push({row:u,col:f,value:n.extend(!0,{},e[u][f]),height:wt?h._wrapColl[u][f]:v[u]}),this._clearFormula(u,f),e[u][f]={},c.push({row:u,col:f}),wt&&delete h._wrapColl[u][f])),t.isNullOrUndefined(e[u+r.rowCount])?v[u+r.rowCount]=this.model.rowHeight:t.isNullOrUndefined(e[u+r.rowCount][f])||(t.isNullOrUndefined(e[u])&&(e[u]={}),e[u][f]=n.extend(!0,{},e[u+r.rowCount][f]),ft&&(this._wrapCollection(u,f,h._wrapColl[u+r.rowCount][f],i),delete h._wrapColl[u+r.rowCount][f]),nt=this.getCell(u+r.rowCount,f),tt=this.getCell(u,f),nt&&(currText=nt[0].outerHTML,this.clearTextNode(nt)),tt&&(remText=tt[0].outerHTML,this.clearTextNode(tt,this.XLEdit.getPropertyValue(u,f,"value2"))),this._clearFormula(u+r.rowCount,f),e[u+r.rowCount][f]={},c.push({row:u+r.rowCount,col:f}),this._refreshFormula(u,f,r.rowCount,"delete","row",r.startRow,!0),nt&&(nt[0].outerHTML=currText),tt&&(tt[0].outerHTML=remText)),this.XLEdit._refreshCalcEngine(u,f);wt&&this.getObjectLength(h._wrapColl[u])<1&&delete this._dataContainer.sheets[i][u][0].wrapRow;ft&&(this.XLEdit._updateDataContainer({rowIndex:u,colIndex:0},{dataObj:{wrapRow:!0}}),v[u+r.rowCount]=t.max(this._getObjectValues(h._wrapColl[u+r.rowCount])),v[u+r.rowCount]||(v[u+r.rowCount]=this.model.rowHeight),this.getObjectLength(h._wrapColl[u+r.rowCount])||delete this._dataContainer.sheets[i][u+r.rowCount][0].wrapRow);(wt||ft)&&(v[u]=t.max(this._getObjectValues(h._wrapColl[u])),v[u]||(v[u]=this.model.rowHeight))}for(o=0,a=c.length;o<a;o++)this.getObjectLength(e[c[o].row][c[o].col])===0&&(this._clearFormula(c[o].row,c[o].col),delete e[c[o].row][c[o].col]),this.getObjectLength(e[c[o].row])===0&&delete e[c[o].row]}r.status.indexOf("insert")>-1&&(pt.rowIndex=pt.rowIndex+r.rowCount,pt.colIndex=pt.colIndex+r.colCount,this.getSheet(i).usedRange=pt)},_undoInsDelMerge:function(){if(this._isUndo){this._dupDetails=!0;for(var n=0,t=this._removeMergeColl.length;n<t;n++)this.mergeCenter=this._removeMergeColl[n].merge.isCenterAlign,this.mergeCells(this._removeMergeColl[n].merge.mRange,!0);this._dupDetails=!1}},_updateCommentColl:function(n){this.getSheet(n)._commentColl={};this._isInsdel=!0;this.XLComment._updateCmntArrowPos();this._isInsdel=!1},insertShiftRight:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var r,f=!1,u=this.getActiveSheetIndex(),i;this._isUndo?(r="shiftLeft",this._insDelStatus="delete"):(r="shiftRight",this._insDelStatus="insert");i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:r};this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(f=this._clearAllMergeCells(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r),this._isUndoRedo||f.isAlert?this._insertShiftRight(u,n,t,i):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge())}},_insertShiftRight:function(t,i,r,u){var c=r.colIndex-i.colIndex+1,l=this.getRows(t)[1],a=this._getJSSheetHeader(t).find("col"),v=this._getContent(t).find("col"),o,s,e,f,h;if(this._isUndo){for(s=i.rowIndex;s<=r.rowIndex;s++)for(iTd=n(l[s]).find("td"),o=iTd.length-1,e=i.colIndex;e<=o-c;e++)iTd[e].outerHTML=iTd[e+c].outerHTML;for(f=o;f>o-c;f--)for(a.eq(f).remove(),v.eq(f).remove(),h=0;h<l.length;h++)n(l[h]).find("td:eq("+f+")").remove()}else this.XLScroll._createNewColumn(t,i,r,"shift");this.performSelection(i,r);this._refreshDataContainer(t,u);this._isUndo?this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"delete"):this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"insert");this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndoRedo||this._undoredoDetails(t,i,r,"insert","insertShiftRight");this._refreshRows(t)},insertShiftBottom:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var f=!1,r=this.getActiveSheetIndex(),u,i;if(u=this._isUndo?"shiftUp":"shiftBottom",i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isFilterApplied)if(this._isTotalRow)if(this._isUndoRedo)this._isUndoRedo=this._dupDetails=!0,this.deleteEntireRow(this._insRows.startRow,this._insRows.endRow),this.XLFormat._calculateTotalRow(r,null,!0,!1),this._isUndoRedo=!1;else return this._showAlertDlg("","TotalRowAlert","TotalRow",630),!0;else this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630);else f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isUndoRedo||f.isAlert?this._insertShiftBottom(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge()}},_insertShiftBottom:function(t,i,r,u){var w=this.model.scrollSettings.allowVirtualScrolling,f,e,c,a;if(this._refreshDataContainer(t,u),w)this._refreshViewport(this.getSheet(t)._scrollTop,t);else{var h,s,l,v=this.getSheet(t).rowsHeightCollection,p=this.getRows(t),o=p[1],y=p[0];if(this._isUndo){for(o=this._getContent(t).find("tbody").get(0).rows,f=i.rowIndex,a=o.length;f<a;f++){if(h=f+(r.rowIndex-i.rowIndex+1),l=n(o[f]).find("td"),h<o.length)for(s=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)l[e].outerHTML=s[e].outerHTML,s[e].innerHTML="";o[f].style.height=v[f]+"px";y[f].style.height=v[f]+"px"}for(e=i.colIndex;e<=r.colIndex;e++)for(c=a-1,length=a-1-(r.rowIndex-i.rowIndex+1);c>length;c--)n(o[c]).remove(),n(y[c]).remove(),this.model.sheets[t].rowCount=this.model.sheets[t].rowCount-1;this.XLScroll._refreshScroller(1,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"all")}else{for(f=i.rowIndex;f<=r.rowIndex;f++)this.XLScroll._createNewRow(t,-1,-1,"insert");for(f=o.length-1;f>=i.rowIndex;f--){if(h=f-(r.rowIndex-i.rowIndex+1),l=n(o[f]).find("td"),h>=i.rowIndex)for(s=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)l[e].outerHTML=s[e].outerHTML,s[e].innerHTML="",l[e].className=s[e].className,s[e].className="e-rowcell e-wrapword";o[f].style.height=v[f]+"px";y[f].style.height=v[f]+"px"}}this._refreshRows(t)}this.XLScroll._getRowHeights(t,i.rowIndex);this.performSelection(i,r);this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"insert","insertShiftBottom")},insertEntireRow:function(t,i){var h,v,c,l;if(this.model.allowInsert&&!this.model.isReadOnly){var y=this.model.scrollSettings.allowVirtualScrolling,u,a,o,e,r=this.getActiveSheetIndex(),f=this.getSheet(r),k=f.rowsHeightCollection,p=f._isRowSelected,s=f._selectedCells,w=s[0].colIndex,b=s[s.length-1].colIndex;if(this._isUndo?(o="deleteRow",this._insDelStatus="delete"):(o="insertRow",this._insDelStatus="insert"),e={startCol:0,colCount:f.colCount,startRow:t,rowCount:i-t+1,status:o},this._clearAllMergeCells(r,t,e.rowCount,-1,0,o),this._refreshDataContainer(r,e),y)this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus),this._refreshViewport(f._scrollTop,r);else{if(this._isUndo){for(h=this.getRows(r),v=h[1],c=h[0],u=i;u>=t;u--)n(v[u]).remove(),n(c[u]).remove(),f.rowCount=f.rowCount-1;for(l=c.find("td"),u=0,a=l.length;u<a;u++)n(l[u]).text(u+1)}else for(u=t;u<=i;u++)this.XLScroll._createNewRow(r,u,0,"insert");this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus);this.XLScroll._getRowHeights(r,t);this._refreshRows(r)}this._isFrozen(f.frozenRows)&&(t<f._frozenRows||i<f._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();this._isUndo?(this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"delete"),this._batchDeleteRow(t,i,r,!0)):(this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"insert"),this._batchAddRow(t,i,r));p?this.XLSelection.selectRows(t,i):this.performSelection({rowIndex:t,colIndex:w},{rowIndex:i,colIndex:b});this.model.allowComments&&this._updateCommentColl(r);this._isUndoRedo||this._dupDetails||this._undoredoDetails(r,{rowIndex:t,colIndex:0},{rowIndex:i,colIndex:f.colCount-1},"insert","insertRow")}},insertEntireColumn:function(n,t){if(this.model.allowInsert&&!this.model.isReadOnly){var f,i=this.getActiveSheetIndex(),u,r=this.getSheet(i),h=r._isColSelected,e,o,s=r._selectedCells,c=s[0].rowIndex,l=s[s.length-1].rowIndex;(this._isUndo?(this._insDelStatus="delete",f="deleteColumn"):(f="insertColumn",this._insDelStatus="insert"),r._isTemplate&&(n<r._templateColCount||t<r._templateColCount))||(u={startCol:n,colCount:t-n+1,startRow:0,rowCount:r.rowCount,status:f},this._clearAllMergeCells(i,-1,0,n,u.colCount,f),this._refreshDataContainer(i,u),e={rowIndex:c,colIndex:n},o={rowIndex:l,colIndex:t},this.XLScroll._createNewColumn(i,e,o,"insert"),this._isUndo?this._refreshAllMergeCells(i,-1,0,n,u.colCount,"delete"):this._refreshAllMergeCells(i,-1,0,n,u.colCount,"insert"),this.model.allowFiltering&&this.XLFilter._updateFilterCollection(i,n,t-n,"column",this._insDelStatus),this._isFrozen(r.frozenColumns)&&(n<r._frozenColumns||t<r._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv(),this._isUndoRedo||this._undoredoDetails(i,e,o,"insert","insertColumn"),this.model.allowComments&&this._updateCommentColl(i),h?this.XLSelection.selectColumns(n,t):this.performSelection(e,o),this._refreshRows(i),this._isAutoWHMode&&this._autoSSWidthHeight(i))}},deleteShiftLeft:function(n,t){if(this.model.allowDelete&&!this.model.isReadOnly){var f=!1,u=this.getActiveSheetIndex(),r,i;this._isUndo?(this._insDelStatus="insert",r="shiftRight"):(this._insDelStatus="delete",r="shiftLeft");i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:r};this.model.allowFiltering&&this.XLFilter._checkFilterApplied(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r);this._isFilterApplied?this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630):(f=this._clearAllMergeCells(u,n.rowIndex,i.rowCount,n.colIndex,i.colCount,r),this._isUndoRedo||f.isAlert?f.isCancel||this._deleteShiftLeft(u,n,t,i):(this._insData={sheetIdx:u,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge())}},_deleteShiftLeft:function(t,i,r,u){var o,s,f,e,h=r.colIndex-i.colIndex+1,l=this.getRows(t)[1],c=[],a;if(this._isUndo)for(n.extend(!0,c,this._deletedText),o=i.rowIndex;o<=r.rowIndex;o++){for(f=n(l[o]).find("td"),a=f.length-1,e=a-h;e>i.colIndex-1;e--)f[e+h].outerHTML=f[e].outerHTML;for(s=i.colIndex;s<=r.colIndex;s++)f[s].outerHTML=c.shift()}else for(this._insDelStatus="delete",o=i.rowIndex;o<=r.rowIndex;o++){for(f=n(l[o]).find("td"),s=i.colIndex;s<=r.colIndex;s++)c.push(f[s].outerHTML);for(e=i.colIndex,length=f.length;e<length-h;e++)f[e].outerHTML=f[e+h].outerHTML}this.performSelection(i,r);this._refreshDataContainer(t,u);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=c;this.model.allowComments&&this._updateCommentColl(t);this._isUndo?this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"insert"):this._refreshAllMergeCells(t,-1,0,i.colIndex,u.colCount,"delete");this._isUndoRedo||this._undoredoDetails(t,i,r,"delete","deleteShiftLeft");this._refreshRows(t)},deleteShiftUp:function(n,t){if(this.model.allowDelete&&!this.model.isReadOnly){var f=!1,r=this.getActiveSheetIndex(),u,i;if(u=this._isUndo?"shiftBottom":"shiftUp",i={startCol:n.colIndex,colCount:t.colIndex-n.colIndex+1,startRow:n.rowIndex,rowCount:t.rowIndex-n.rowIndex+1,status:u},this.model.allowFiltering&&this.XLFilter._checkFilterApplied(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isFilterApplied){if(this._isTotalRow)return;this._showAlertDlg("Alert","InsertDeleteAlert","InsertDeleteAlert",630)}else f=this._clearAllMergeCells(r,n.rowIndex,i.rowCount,n.colIndex,i.colCount,u),this._isUndoRedo||f.isAlert?f.isCancel||this._deleteShiftUp(r,n,t,i):(this._insData={sheetIdx:r,startCell:n,endCell:t,value:i},this._showAlertDlg("Alert","MergeInsertAlert","MergeInsertDelete",498)),this._undoInsDelMerge()}},_deleteShiftUp:function(t,i,r,u){var w=this.model.scrollSettings.allowVirtualScrolling,f,e,v,l=[],h;if(this._refreshDataContainer(t,u),w)this._refreshViewport(this.getSheet(t)._scrollTop,t);else{var s,c,a=this.getSheet(t).rowsHeightCollection,y=this.getRows(t),o=y[1],p=y[0];if(!this._isUndo||this._isTotalRow)for(f=i.rowIndex,v=o.length;f<v;f++){if(h=f+(r.rowIndex-i.rowIndex+1),s=n(o[f]).find("td"),h<o.length)for(c=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)l.push(s[e].outerHTML),s[e].outerHTML=c[e].outerHTML,c[e].innerHTML="";o[f].style.height=a[f]+"px";p[f].style.height=a[f]+"px"}else{for(n.extend(!0,l,this._deletedText),f=o.length-1;f>=i.rowIndex;f--){if(h=f-(r.rowIndex-i.rowIndex+1),s=n(o[f]).find("td"),h>=i.rowIndex)for(c=n(o[h]).find("td"),e=i.colIndex;e<=r.colIndex;e++)s[e].outerHTML=c[e].outerHTML,c[e].innerHTML="";o[f].style.height=a[f]+"px";p[f].style.height=a[f]+"px"}for(f=i.rowIndex;f<=r.rowIndex;f++)for(s=n(o[f]).find("td"),e=i.colIndex;e<=r.colIndex;e++)s[e].outerHTML=l.shift()}this._refreshRows(t)}this.XLScroll._getRowHeights(t,i.rowIndex);this.performSelection(i,r);this.model.allowComments&&this._updateCommentColl(t);this.model.allowComments&&(this.XLComment._curCommentHCell=null);this._deletedText=l;this._isUndo?this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"insert"):this._refreshAllMergeCells(t,i.rowIndex,u.rowCount,-1,0,"delete");this._isUndoRedo||this._dupDetails||this._undoredoDetails(t,i,r,"delete","deleteShiftUp")},deleteEntireRow:function(t,i){if(this.model.allowDelete&&!this.model.isReadOnly){var b=this.model.scrollSettings.allowVirtualScrolling,u,a,o,r=this.getActiveSheetIndex(),f=this.getSheet(r),h=f._selectedCells,k=h[0].colIndex,d=h[h.length-1].colIndex;if(rowHeightColl=f.rowsHeightCollection,this._isUndo?(this._insDelStatus="insert",o="insertRow"):(o="deleteRow",this._insDelStatus="delete"),e={startCol:0,colCount:f.colCount,startRow:t,rowCount:i-t+1,status:o},this._clearAllMergeCells(r,t,e.rowCount,-1,0,o),this._refreshDataContainer(r,e),b)this._refreshViewport(this.getSheet(r)._scrollTop,r);else{var c,v,s=[],y,e,p=this.getRows(r),l=p[1],w=p[0];if(this._isUndo){for(n.extend(!0,s,this._deletedText),u=t;u<=i;u++)y=s.pop(),n(l[u]).before(y),v=this.XLScroll._rowHeaderTemplate(1,rowHeightColl[u]),n(w[u]).before(v),f.rowCount=f.rowCount+1;this._refreshRows(r)}else for(u=i;u>=t;u--)s.push(l[u].outerHTML),n(l[u]).remove(),n(w[u]).remove(),f.rowCount=f.rowCount-1,this.XLScroll._createNewRow(r,-1,-1,"insert");for(c=n(this.getRows(r)[0]).find("td"),u=0,a=c.length;u<a;u++)n(c[u]).text(u+1);this._refreshRows(r)}this._isFrozen(f.frozenRows)&&(t<f._frozenRows||i<f._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();f._isRowSelected?this.XLSelection.selectRows(t,i):this.performSelection({rowIndex:t,colIndex:k},{rowIndex:i,colIndex:d});this._deletedText=s;this.model.allowComments&&this._updateCommentColl(r);this._isUndo?(this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"insert"),this._batchAddRow(t,i,r,!0)):(this._refreshAllMergeCells(r,t,e.rowCount,-1,0,"delete"),this._batchDeleteRow(t,i,r));this.model.allowFiltering&&this.XLFilter._updateFilterCollection(r,t,i-t,"row",this._insDelStatus);this.XLScroll._getRowHeights(r,t);this._isUndoRedo||this._dupDetails||this._undoredoDetails(r,{rowIndex:t,colIndex:0},{rowIndex:i,colIndex:f.colCount-1},"delete","deleteRow")}},deleteEntireColumn:function(i,r){var h;if(this.model.allowDelete&&!this.model.isReadOnly){var f,u,v,y,nt=0,e=this.getActiveSheetIndex(),tt=this.getFrozenColumns(),o=this.getSheet(e),c=this.getRows(e)[1],l=this._getContent(e).find("col"),p=this._getJSSheetHeader(e).find("col"),w=this._getJSSheetHeader(e).find("th"),g=o._selectedCells,ut=g[0].rowIndex,ft=g[g.length-1].rowIndex,b,s=[],a,it,k,rt=this.XLScroll._colGroupTemplate(1),d=o.columnsWidthCollection,et=this.model.scrollSettings.allowVirtualScrolling?this._getContent(e).find("tbody").get(1):this._getContent(e).find("tbody").get(0);if(this._isUndo?(b="insertColumn",this._insDelStatus="insert"):(b="deleteColumn",this._insDelStatus="delete"),!o._isTemplate||!(i<o._templateColCount||r<o._templateColCount)){if(a={startCol:i,colCount:r-i+1,startRow:0,rowCount:o.rowCount,status:b},this._clearAllMergeCells(e,-1,0,i,a.colCount,b),this._isUndo){for(s=n.extend(!0,s,this._deletedText),h=0,f=c.length-1;f>=0;f--){for(y=n(c[f]).find("td"),u=i;u<=r;u++)y.eq(u-h).before(s.pop()),h++;h=0}for(u=i;u<=r;u++)l.eq(u-h).before(s.pop()),w.eq(u-h).before("<th class='e-headercell'><div class='e-headercelldiv'><\/div><\/th>"),p.eq(u-h).before(s.pop()),h++;k=d.splice(0,i);t.merge(k,this._deletedDimension.reverse());t.merge(k,d);o.columnsWidthCollection=k;this._deletedDimension=[]}else{if(this._isFrozen(tt)&&tt>=i){for(f=o._frozenColumns-1;f<o._fleftColIdx;f++)nt+=o.columnsWidthCollection[f];this._scrollContent({x:-nt})}for(u=r;u>=i;u--)s.push(p[u].outerHTML),s.push(l[u].outerHTML),this._deletedDimension.push(d.splice(u,1)[0]),p.eq(u).remove(),l.eq(u).remove(),p.parent().append(rt),l.parent().append(rt),d.push(o.columnWidth);for(f=0,v=c.length;f<v;f++)for(y=n(c[f]).find("td"),u=r;u>=i;u--)it=this.XLScroll._columnTemplate(),n(c[f]).append(it),s.push(y[u].outerHTML),n(et.rows[f]).find("td:eq("+u+")").remove()}for(this.XLScroll._getColWidths(e,i),this._isFrozen(o.frozenColumns)&&(i<o._frozenColumns||r<o._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv(),this.model.allowFiltering&&this.XLFilter._updateFilterCollection(e,i,r-i,"column",this._insDelStatus),o.colCount=l.length,w=this._getJSSheetHeader(e).find("th"),f=0,v=w.length;f<v;f++)n(w[f]).find("div").text(this._generateHeaderText(f+1));this._refreshDataContainer(e,a);this._isUndo?this._refreshAllMergeCells(e,-1,0,i,a.colCount,"insert"):this._refreshAllMergeCells(e,-1,0,i,a.colCount,"delete");o._isColSelected?this.XLSelection.selectColumns(i,r):this.performSelection({rowIndex:ut,colIndex:i},{rowIndex:ft,colIndex:r});this._deletedText=s;this.model.allowComments&&this._updateCommentColl(e);this._isUndoRedo||this._undoredoDetails(e,{rowIndex:0,colIndex:i},{rowIndex:o.rowCount-1,colIndex:r},"delete","deleteColumn");this._refreshRows(e)}}},_getSelectedRange:function(n,t){for(var r,e,o=[],u=this.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),i=u[0],f=u[2];i<=f;){for(r=u[1],e=u[3];r<=e;)o.push({rowIndex:i,colIndex:r}),r++;i++}return o},performSelection:function(n,t){var r=this.getActiveSheetIndex(),i,c=this.getSheet(r),u,f,e,o,s,h;this.getObjectLength(n)||(i=this._getRangeArgs(n,"object"),n={rowIndex:i[0],colIndex:i[1]},t={rowIndex:i[2],colIndex:i[3]});this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(r,"refresh","all");this.setActiveCell(n.rowIndex,n.colIndex);this.model.allowSelection&&(e=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge"),o=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"merge"),e&&(s=this.getRangeIndices(e.mRange),n={rowIndex:s[0],colIndex:s[1]}),o&&(h=this.getRangeIndices(o.mRange),t={rowIndex:h[2],colIndex:h[3]}),this.XLSelection.selectRange(n,t));this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();c._startCell=n;c._endCell=t;this.model.showRibbon&&this.XLRibbon._updateRibbonIcons();u=this.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"tableName",r);u&&(f=this._getTableID(u),this.isNumber(f)&&this.XLRibbon._designTabUpdate(f,n))},_checkRowCol:function(n,i){if(n!==0&&i!==0)return t.isNullOrUndefined(i)&&(i=n),{start:n,end:i}},hideRow:function(n,t){var i=this._checkRowCol(n,t);this._hideRow(i.start-1,i.end-1,"isRHide")},showRow:function(n,t){var i=this._checkRowCol(n,t);this._showRow(i.start,i.end,"isRHide")},hideColumn:function(n,t){var i=this._checkRowCol(n,t);this._hideColumn(i.start-1,i.end-1)},showColumn:function(n,t){var i=this._checkRowCol(n,t);this._showColumn(i.start,i.end)},_hideRow:function(n,i,r,u){var o=this.getActiveSheetIndex(),f=this.getSheet(o),l=this.getRows(o),y=l[1],p=l[0],h=this.model.scrollSettings,s=h.allowVirtualScrolling,a=f.hideRowsCollection,c=[],w=f.rowsHeightCollection,e,v;for(this._isUndoRedo||u||(this.XLEdit._updateDataContainer({rowIndex:n?n-1:n,colIndex:0},{dataObj:{hRow:!0}}),s||this.addClass(this._getJSSheetRowHeaderContent(o).find(".e-rowheader")[n?n-1:n],"e-hrow")),e=n;e<=i;e++)r==="isRHide"&&this.XLEdit._updateDataContainer({rowIndex:e,colIndex:0},{dataObj:{isRHide:!0}}),c.push(e),a.indexOf(e)===-1&&(a.push(e),s||(this._isRowViewable(o,e)&&(this.addClass(y[e],"e-r-hide"),this.addClass(p[e],"e-r-hide")),h.allowScrolling&&h.scrollMode===t.Spreadsheet.scrollMode.Infinite&&(!f._isImported||f._isLoaded)&&this.XLScroll._createNewRow(o,-1,-1,"insert"),this._filterMergeCells(e,"decr")));this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,i,!0,!0);this._isFilter||this.XLScroll._getRowHeights(o,n);this._showHideRows(o,f,c,n,i,s,"hide");f._isImported&&!f._isLoaded||this._isFilter||this._isExport||(this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this._isFrozen(f.frozenRows)&&(n<f._frozenRows||i<f._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv(),this.model.scrollSettings.allowScrolling&&!s&&this.XLScroll._refreshScroller(o,"refresh","vertical"),this._isUndoRedo||u||(f._activeCell.rowIndex=i+1,v={sheetIndex:o,reqType:"show-hide",action:"hide",operation:"row",bSelect:{startRow:n,endRow:i},aSelect:{startRow:i+1,endRow:i+1},addBRows:n?[n-1]:[n],remBRows:[],hideRows:c},this._completeAction(v)));u||(this.XLSelection.selectRow(i+1,o),this.model.allowAutoFill&&this.XLDragFill.hideAutoFillElement())},_showRow:function(i,r,u,f){var c,l,e=this.getActiveSheetIndex(),p=i-1>0?i-1:0,o=this.getSheet(e),w=this.getRows(e),b=w[1],a=w[0],v=[],k=[],it=o.rowsHeightCollection,d=o.hideRowsCollection,tt=n(this._getJSSheetHeader(e).find("colgroup")[0].outerHTML).attr("id","ss"),h=t.buildTag("table#wrapTable.e-table",{}),y=this._dataContainer.sheets[e],s=this.model.scrollSettings.allowVirtualScrolling,rt=o.columnsWidthCollection,g=this.element.find(".e-spreadsheetcolumnheader"),nt;for(s||(h.append(tt),this.element[0].insertBefore(h[0],this.element[0].childNodes[0])),this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(i,r,!0),j=p;j<=r;j++)c=d.indexOf(j),c>-1&&(u==="isRHide"&&delete y[j][0].isRHide,v.push(j),d.splice(c,1),s||(this._removeClass(b[j],"e-r-hide"),this._removeClass(a[j],"e-r-hide"),this._filterMergeCells(j,"incr")),!this._isUndoRedo&&j>0&&!f?(k.push(j-1),delete y[j-1][0].hRow,s||this._removeClass(n(a[j-1]).find("td")[0],"e-hrow")):j!==0||f||(delete y[0][0].hRow,s||(g.height(20.5),this._removeClass(g[0],"e-hrow")))),s||(this._setWrapHeight(e,j,b,a,h,"visible"),h.remove()),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();this._isFilter||this.XLScroll._getRowHeights(e,p);this._showHideRows(e,o,v,i,r,s,"show");f||o._isImported&&!o._isLoaded||this._isUndoRedo||this._isFilter||(i<r?(this.setActiveCell(i,0),this.XLSelection.selectRows(i,r,e),l={startRow:i,endRow:r}):i>0&&(this.setActiveCell(i-1,0),this.XLSelection.selectRow(i-1,e),l={startRow:i-1,endRow:i-1}),this.XLDragFill.positionAutoFillElement(),nt={sheetIndex:e,reqType:"show-hide",action:"show",operation:"row",bSelect:{startRow:i,endRow:r},aSelect:l,addBRows:[],remBRows:k,hideRows:v},this._completeAction(nt));this._isFrozen(o.frozenRows)&&(i<o._frozenRows||r<o._frozenRows)&&this.XLFreeze._refreshFreezeRowDiv();this._isFilter||((!o._isImported||o._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(),this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(e,"refresh","vertical"))},_showHideRows:function(n,t,i,r,u,f,e){f&&(this.refreshContent(n),this._refreshViewport(this._isFrozen(t.frozenRows)?t._contScrollTop:t._scrollTop,n),this._refreshSHMergeCells(n,i,u-r+1,"row",e),t.selectedRange[0]<r&&t.selectedRange[2]>u&&(this.model.allowSelection&&this.XLSelection.selectRange(t._activeCell,t._activeCell),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()))},_colgroupRefresh:function(t){var i,r,u,f;this.model.allowResizing&&(i=this._getJSSheetHeader(t).find("colgroup"),r=this._getContent(t).find("colgroup"));u=n(i).clone();f=n(r).clone();n(r).remove();n(i).remove();n(u).prependTo(this._getJSSheetHeader(t).find(".e-table"));n(f).prependTo(this._getContent(t).find(".e-table"))},_updateFilterIcon:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.getActiveSheetIndex());for(var o=this.getSheet(r).filterSettings.tableRange,u,e,f=0,s=o.length;f<s;f++)e=o[f].multifilterIdx,n>=e[0]&&n<=e[e.length-1]&&(u=o[f].startRow-1,this._isRowViewable(r,u)&&(i==="hide"?this.addClass(this.getCell(u,n).find(".e-filterspan")[0],"e-hide"):this._removeClass(this.getCell(u,n).find(".e-filterspan")[0],"e-hide")),this.XLEdit._updateDataContainer({rowIndex:u,colIndex:n},{dataObj:{isFilterVisible:i!="hide"}}))},_hideColumn:function(n,i){for(var e,l,o,a=!1,u=this.getActiveSheetIndex(),b=this._getJSSheetHeader(u).find("th"),k=this._getJSSheetHeader(u).find("col"),v,f=this.getSheet(u),d=f.hideColsCollection,s=[],h=[],g=this._getContent(u).find("col"),y=f._filterColl,nt,c=f.columnsWidthCollection,p=this.element.find(".e-spreadsheetcolumnheader"),w,r=n;r<=i;r++)if(this._getContent(u).find(".e-rowcell:nth-child("+(r+1)+")").addClass("e-soverflow"),v=this.XLEdit.getPropertyValue(0,r,"isCHide"),this._isColumnViewable(u,r)&&(a=!0),t.isNullOrUndefined(v))for(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:r},{dataObj:{isCHide:!0}}),this._writeRule(r,u),a&&(this.addClass(b[r],"e-hide"),this.addClass(k[r],"e-hide"),this.addClass(g[r],"e-hide")),(!f._isImported||f._isLoaded)&&s.push(r),d[r]=c[r],c[r]=0,fltrKeys=this.getObjectKeys(y),e=0,l=fltrKeys.length;e<l;e++)t.isNullOrUndefined(y[fltrKeys[e]])||(nt=fltrKeys[e],t.isNullOrUndefined(this.XLEdit.getPropertyValue(fltrKeys[e],r,"isSpanHide"))&&this.XLEdit._updateDataContainer({rowIndex:fltrKeys[e],colIndex:r},{dataObj:{isSpanHide:!0}}));this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,i,!1,!0);this._isUndoRedo||(n?h.push(n-1):h.push(n),this._isColumnViewable(u,n)&&(n===0?(p.width(28),this.addClass(p[0],"e-hfcol"),this.XLEdit._updateDataContainer({rowIndex:0,colIndex:0},{dataObj:{hCol:!0}})):(this.XLEdit._updateDataContainer({rowIndex:0,colIndex:n-1},{dataObj:{hCol:!0}}),this.addClass(this._getJSSheetHeader(u).find("th:eq("+(n-1)+")")[0],"e-hcol"))));this._refreshSHMergeCells(u,s,i-n+1,"column","hide");this.XLScroll._getColWidths(u,n);this._isFrozen(f.frozenColumns)&&(n<f._frozenColumns||i<f._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv();this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(u,"refresh","horizontal");!f._isImported||f._isLoaded?(c.length-1===i?(this.XLSelection.selectColumn(i-1,u),this.setActiveCell(0,i-1),o={startCol:i-1,endCol:i-1}):(o={startCol:i+1,endCol:i+1},this.setActiveCell(0,i+1),this.XLSelection.selectColumn(i+1,u)),this.XLDragFill.positionAutoFillElement(),this._isUndoRedo||(w={sheetIndex:u,reqType:"show-hide",action:"hide",operation:"column",bSelect:{startCol:n,endCol:i},aSelect:o,hideCols:s,addBCols:h,remBCols:[]},this._completeAction(w)),this.model.allowComments&&this.XLComment._updateCmntArrowPos()):this.setActiveCell(0,0);this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(u)},_showColumn:function(n,t){var i=this.getActiveSheetIndex(),u=n-1>0?n-1:0,r=this.getSheet(i),f=r.hideColsCollection,e=[],o=!1,s=[],h=this._getJSSheetHeader(i).find("th"),c=this._getContent(i).find("col"),l=this._getJSSheetHeader(i).find("col"),y=r.columnsWidthCollection,a=this.element.find(".e-spreadsheetcolumnheader"),v;for(this.model.allowCellFormatting&&this.XLFormat._refreshHiddenBorder(n,t),j=u;j<=t;j++)this._getContent(i).find(".e-rowcell:nth-child("+(j+1)+")").removeClass("e-soverflow"),j in f&&(this._deleteRule(j,i),this._isColumnViewable(i,j)&&(o=!0),o&&(this._removeClass(h[j],"e-hide"),this._removeClass(l[j],"e-hide"),this._removeClass(c[j],"e-hide"),c[j].style.width=f[j]+"px",l[j].style.width=f[j]+"px"),y[j]=f[j],delete f[j],delete this._dataContainer.sheets[i][0][j].isCHide,this.model.allowFiltering&&this._updateFilterIcon(j,"show",i),e.push(j),!this._isUndoRedo&&j>0?(o&&this._removeClass(h.get(j-1),"e-hcol"),delete this._dataContainer.sheets[i][0][j-1].hCol,s.push(j-1)):j===0&&(a.width(29),this._removeClass(a[0],"e-hfcol"),delete this._dataContainer.sheets[i][0][0].hCol));this._refreshSHMergeCells(i,e,t-n+1,"column","show");this.XLScroll._getColWidths(i,u);this._isUndoRedo||r._isImported&&!r._isLoaded||(n<t?(this.XLSelection.selectColumns(n,t,i),aSelect={startCol:n,endCol:t}):(this.XLSelection.selectColumn(u,i),aSelect={startCol:u,endCol:u}),this.XLDragFill.positionAutoFillElement(),v={sheetIndex:i,reqType:"show-hide",action:"show",operation:"column",bSelect:{startCol:n,endCol:t},aSelect:aSelect,addBCols:[],remBCols:s,hideCols:e},this._completeAction(v));this._browserDetails.name.indexOf("msie")>-1&&this._colgroupRefresh(i);(!r._isImported||r._isLoaded)&&this.model.allowComments&&this.XLComment._updateCmntArrowPos();this._isFrozen(r.frozenColumns)&&(n<r._frozenColumns||t<r._frozenColumns)&&this.XLFreeze._refreshFreezeColDiv();this.model.scrollSettings.allowScrolling&&this.XLScroll._refreshScroller(i,"refresh","horizontal")},_destroySheet:function(n){this.element.find("#"+this._id+"_"+this.model.sheets[n].sheetInfo.value).empty()},_destroy:function(){var r,i=1,t;if(n("#"+this._id+"_sscustomformat").remove(),this.isImport||this._isNew){while(i<=this.model.sheetCount)delete n.templates[this._id+"JSONTemplate"+i],delete n.templates[this._id+"JSONRowHdrTemplate"+i],r=this.getSheet(i).sheetInfo.value,CalcEngine.unregisterGridAsSheet(r,r),i++;this.model.sheets=[];this.model.nameManager=[];this._sheets=[];this.getActivationPanel().empty();this.model.enablePivotTable&&(this.XLPivot._hasPvtField=!1);this.isDirty=!1;t=this.getCalcEngine();t.getFormulaInfoTable().clear();t.getDependentCells().clear();t.getDependentFormulaCells().clear();t.getNamedRanges().clear();t.getDependentNamedRangeCells().clear();this.isImport?(this._detachTable=null,this._updateFormulaCollection()):(document.getElementById(this._id+"_nmgrid")&&n("#"+this._id+"_nmgrid").ejGrid("option",{dataSource:[]}),this._dataContainer={sheets:{},hashCode:[],sharedData:[],cellType:[],valData:[],cFormatData:[]},this.XLRibbon._updateUseInFormulaTrgt(),this.XLEdit._refreshAutoComplete());this.element.append([this.getFocusTopElem(),this.getFocusRightElem(),this.getFocusBottomElem(),this.getFocusLeftElem(),this.getAutoFillElem(),this._getAutoFillOptElem()]);this.element.find(".e-spreadsheet-list .e-sheet").remove();document.getElementById(n("#"+this._id+"ddl"))&&n("#"+this._id+"ddl").data("ejDropDownList").destroy();n("#"+this._id+"ddl").remove();this._tableCnt=this._newSIndex=1;this.XLChart&&(this.XLChart._shapeCnt=1);CalcEngine._tokenCount=0;this._isVPRendered=!1}else this._wireEvents("_off"),this._destroySubControls(),this.element.empty(),this.element.css({height:"",width:"","min-height":"","min-width":""}),this.element.prop("tabindex",!1),this.element.removeEleEmptyAttrs(),this._removeClass(this.element[0],"e-spreadsheet"),document.getElementById(this._id+"_sshide")&&document.getElementById(this._id+"_sshide").remove(),n("#"+this._id+" _formatastable").parent().remove(),n("#"+this._id+" _cellstyles").parent().remove(),n("#"+this._id+"_Ribbon_Home_Font_BorderColor_popup").remove();this._isRibbonDestroyed=!0},_destroySubControls:function(){var r,u=this._id,t,f,i,o,e;if(t=n("span.e-"+u+"-ddl input.e-dropdownlist"),t.length)for(i=0,o=t.length;i<o;i++)f=n(t[i]).data("ejDropDownList"),f&&f.destroy();if(this.model.allowFiltering){e=n(".e-"+this._id+"_customddl");e.length&&e.ejDropDownList("destroy").remove();var s=n("#"+this._id+"_filter_custom_string_acString"),h=n("#"+this._id+"_filter_custom_number_acString"),c=n("#"+this._id+"_filter_custom_date_acString");s.length&&s.ejAutocomplete("destroy").remove();h.length&&h.ejNumericTextbox("destroy").remove();c.length&&c.ejDatePicker("destroy").remove()}n("#"+this._id+"_colordlg_cpicker").ejColorPicker("destroy").remove();this.model.showRibbon&&(this.XLRibbon._rbnDestroy({destroy:!0}),document.getElementById(this._id+"_nmgrid")&&n("#"+this._id+"_nmgrid").ejGrid("destroy"),n(".e-"+this._id+"-spltbtn").ejSplitButton("destroy"),n("#"+this._id+"_Ribbon").ejRibbon("destroy"));r=n(".e-"+u+"-dlg");r.length&&r.remove();this.model.allowFormulaBar&&n("#"+this._id+"_inputbox").ejAutocomplete("destroy");n("#"+this._id+"_AutoComplete").ejAutocomplete("destroy");this.model.allowAutoFill&&n("#"+this._id+"_dragfilloptionbtn").ejSplitButton("destroy");this.model.enableContextMenu&&(n("#"+this._id+"_contextMenuCell").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuColumnHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuRowHeader").ejMenu("destroy").remove(),n("#"+this._id+"_contextMenuFooter").ejMenu("destroy").remove(),n(".e-"+u+"-cmenu").remove());this.model.allowFiltering&&(this._excelFilter.resetExcelFilter(),n("#"+this._id+"number_excelDlg").remove(),n("#"+this._id+"string_excelDlg").remove(),n("#"+this._id+"date_excelDlg").remove());n("#"+this._id+"_copyPaste").remove();n("#"+this._id+"_wait").ejWaitingPopup("destroy");n("#"+this._id+"_wait").remove()},_getXYPos:function(n,t,i,r){var e=this.element.offset().top,o=this.element.offset().left,s=t.height(),h=t.width(),u=n.offset().left-o,f=n.offset().top-e;return f+i+s>this._responsiveHeight?f=f-(f+i+s-this._responsiveHeight)+(e-6):f+=e,f<e&&(f+=e-f),u+r+h>this._responsiveWidth?u=u-(u+r+h-this._responsiveWidth)+(o-6):u+=o+r,u<o&&(u+=o-u),{xPos:u,yPos:f}},getValueRowCol:function(n,t,i){var n=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+n),r=this.getSheet(n);return n==-1?"#REF!":(r._isImported&&!r._isRequested&&(this._intrnlReq=!0,this._importSheet(n,!1)),this.XLEdit.getPropertyValue(t-1,i-1,"value",n))},setValueRowCol:function(n,i,r,u){if(r--,u--,r!==-2||u!==-2){var f,e,s={rowIndex:r,colIndex:u},h=!1,o,c;(typeof i=="string"&&(i=i.replace(/^\"|\"$/g,"")),n=this._getSheetIdxFromSheetValue(this._getLocStr("Sheet")+n),f=this.getRangeData({range:[r,u,r,u],property:["value","formatStr","type","thousandSeparator","decimalPlaces"],sheetIdx:n})[0],f.formatStr&&(isNaN(parseInt(i))&&!isNaN(Date.parse(i))&&(i=new Date(i)),e=this.XLFormat._format(i,{formatStr:f.formatStr,type:f.type,thousandSeparator:f.thousandSeparator,decimalPlaces:f.decimalPlaces})),f.type=="fraction"&&(e=this.XLFormat._format(i,{type:f.type})),e=t.isNullOrUndefined(e)?i:e,this._isInitLoad&&!this.isImport&&(h=!0),o={value2:e,calcValue:this.XLEdit._parseValue(i,{rowIndex:r,colIndex:u}).value},f.type&&(o.type=f.type),c={isRefCells:!0,calcValue:o.calcValue,value:f.value,rowIndex:r,colIndex:u},this._isInitLoad||this.isImport||this.XLEdit._EditCellDetails.rowIndex===r&&this.XLEdit._EditCellDetails.columnIndex===u||!this._trigger("cellSave",c))&&(this.XLEdit._updateDataContainer(s,{dataObj:o,sheetIdx:n,skipCell:h}),this.XLEdit._refreshCellAlignment({cellIdx:s,value:i,type:f.type}))}},getActiveCellElem:function(n){n=this._getSheetIndex(n);var t=this.getSheet(n);return this.getCell(t._activeCell.rowIndex,t._activeCell.colIndex,n)},_hlDlgOpen:function(){var e=this.getActiveSheetIndex(),i=this.getActiveCellElem(e);if(!i.length||!this.model.allowEditing)return!1;if(this.XLEdit._rangeHasProperty(this.getSheet(e).selectedRange,"cellType")){this._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}var t=this._id,h,c=n("#"+t+"_Ribbon_webAddress"),l=n("#"+t+"_Ribbon_cellAddress"),o=n("#"+t+"_Ribbon_findText"),r,u=this.XLEdit.getPropertyValue(i.parent("tr").index(),i[0].cellIndex,"hyperlink",e),a,s,f=n("#"+t+"_Ribbon_cellText");n("#"+t+"_HLDialog").ejDialog("open");this._responsiveHeight<365&&n("#"+this._id+"_HLDialog_wrapper").css("top","0px");s=n("#"+t+"_Ribbon_sheentName").data("ejTreeView");s.option("fields",{dataSource:this.XLRibbon._sheetData()});h=n("#"+t+"_HLDialogTab").data("ejTab");f.attr("disabled",!1);o.attr("disabled",!1);this.isUndefined(u)?h.model.selectedItemIndex===0?(c.val("http://"),f.val("")):(s.selectNode(e+1),f.val(s.getText(e+1)+"!A1"),l.val("A1")):(this.isUndefined(u.webAddr)?h.option({selectedItemIndex:1}):h.option({selectedItemIndex:0}),this.isUndefined(u.cellAddr)?(c.val(u.webAddr),l.val("A1")):(l.val(u.cellAddr.split("_")[0]),a=parseInt(u.cellAddr.split("_")[1])+1,s.selectNode(a),c.val("http://")));n.validator&&(n("#"+t+"_Form_Ribbon_cellAddress").validate().resetForm(),n("#"+t+"_Form_Ribbon_webAddress").validate().resetForm());o.val("");r=this.XLEdit.getPropertyValueByElem(i);this.isUndefined(r)||(this.isFormula(r)||this.XLEdit.getPropertyValueByElem(i,"type")&&this.XLEdit.getPropertyValueByElem(i,"type").indexOf("date")>-1||n.isNumeric(r)||this.XLEdit.getPropertyValueByElem(i,"type").indexOf("time")>-1?(f.val(this._getLocStr("HyperLinkHide")),o.val(this._getLocStr("HyperLinkHide")),f.attr("disabled",!0),o.attr("disabled",!0)):(f.val(r),o.val(r)))},_setLink:function(i){var o,h,s,c,e,y,l,a=this.getActiveSheetIndex(),p,u,r=this.getActiveCell(a),f,v;e=this.getSheet(a).selectedRange;n("#"+this._id+"_HLDialog").length||this.XLRibbon._initHLDialog();v=n("#"+this._id+"_HLDialogTab").ejTab("option","selectedItemIndex");o=n("#"+this._id+"_Ribbon_cellText").val();h=n("#"+this._id+"_Ribbon_cellAddress").val();s=n("#"+this._id+"_Ribbon_findText").val();c=n("#"+this._id+"_Ribbon_webAddress").val();l=n("#"+this._id+"_Ribbon_sheentName").data("ejTreeView");y=this._getSheetIndexByName(l.getSelectedNode().text()||this._getSheetNames()[this.getActiveSheetIndex()-1].text);o.length||s.length||(o=l.getSelectedNode().text()+"!"+h,s=c);f=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex);this._prevText=t.isNullOrUndefined(f)?"":this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2");this._prevVal=t.isNullOrUndefined(f)?"":this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value");u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type")&&(this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type").indexOf("date")>-1||this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"type").indexOf("time")>-1)?this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"):n.isNumeric(f)||this.isFormula(f)?f:v===0?s:o;this._isUndoRedo&&(u=i[0].prevText);this.XLEdit._updateCellValue(r,u);(this.isFormula(u)||n.isNumeric(u))&&(u=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2"));p=v===0?{webAddr:c,text:u}:{cellAddr:h,text:u};this.setHyperlink(this._getAlphaRange(a,e[0],e[1],e[2],e[3]),p,y,i);this._dlgHLClick=!1},_getRangeArgs:function(n,i,r){return t.isNullOrUndefined(n)&&(n=this.getSheet(r).selectedRange),i===typeof n?n:typeof n=="object"?this._getAlphaRange(this.getActiveSheetIndex(),n[0],n[1],n[2],n[3]):this.getRangeIndices(n)},setHyperlink:function(i,r,u,f){var h;if(i=this._getRangeArgs(i,"string"),this.model.allowHyperlink&&!this.model.isReadOnly){if(h={range:i,address:r.webAddr,text:r.text,sheetIndex:u,reqType:"hyperlink",action:"add"},this.XLEdit._rangeHasProperty(i,"cellType")){this._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}if(this._trigActionBegin(h))return;i=h.range;r.webAddr=h.address;r.text=h.text;u=h.sheetIndex;var v,s,y,k,w,d=this.getActiveSheetIndex(),rt=this.getSheet(d),p,g,l=[],nt,c,e,a,o=this._getAlphaRangeCells(i),b={sheetIndex:this.getActiveSheetIndex(),reqType:"hyperlink"},tt,it;if(rng=this._getRangeArgs(i,"object"),selCellObj=this._getSelectedCells(b.sheetIndex,rng).selCells,b.action=t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"hyperlink"))?"add":"edit",this._isUndoRedo)for(e=0,a=selCellObj.length;e<a;e++)t.isNullOrUndefined(f[e].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:selCellObj[e].rowIndex,colIndex:selCellObj[e].colIndex},{dataObj:{hyperlink:f[e].prevLink}}),this._isRowViewable(u,selCellObj[e].rowIndex)&&(tt=n(o[e]).text(),n(o[e]).find("a").remove(),o[e].lastChild?o[e].lastChild.textContent="":n(o[e]).text(""),e===0?t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink").cellAddr)?n(o[e]).append(t.buildTag("a",f[e].prevText,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).append(t.buildTag("a",f[e].prevText,"",{href:"#"})):t.isNullOrUndefined(this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink").cellAddr)?n(o[e]).append(t.buildTag("a",tt,"",{href:this.XLEdit.getPropertyValueByElem(n(o[e]),"hyperlink").webAddr,target:"_blank"})):n(o[e]).append(t.buildTag("a",tt,"",{href:"#"})),n(o[e]).find("a").addClass("e-hyperlinks")),this._dupDetails=!0,this.XLFormat.format({style:{color:this._hlColor}}),this._dupDetails=!1);else{for(t.isNullOrUndefined(r.webAddr)?(s=r.cellAddr,v=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"value2"):r.text,s.indexOf("!")>-1&&(p=s.split("!"),u=p[0].indexOf("=")>-1?this._getSheetIndexByName(p[0].split("=")[1]):this._getSheetIndexByName(p[0]),s=p[1]),s.indexOf("$")>-1&&(cellAdr=s.split("$").join("")),g=t.isNullOrUndefined(v)?s:v):(k=r.webAddr,y=t.isNullOrUndefined(r.text)?this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex,"value2"):r.text,g=t.isNullOrUndefined(y)?k:y),this._dlgHLClick||(it=this.XLEdit.getPropertyValue(selCellObj[0].rowIndex,selCellObj[0].colIndex),this._prevText=t.isNullOrUndefined(it)?"":it,this.XLEdit._updateCellValue({rowIndex:selCellObj[0].rowIndex,colIndex:selCellObj[0].colIndex},g)),e=0,a=selCellObj.length;e<a;e++)l.push({rowIndex:selCellObj[e].rowIndex,colIndex:selCellObj[e].colIndex,prevLink:this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink"),prevColor:this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"formats")});for(this.isUndefined(h.text)||this.XLEdit._updateCellValue(selCellObj[0],h.text),this.isUndefined(s)?this.updateUniqueData({hyperlink:{webAddr:k}},rng):this.updateUniqueData({hyperlink:{cellAddr:s+"_"+u}},rng),e=0,a=selCellObj.length;e<a;e++)c=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"value2"),l[e].prevText=e===0?this._prevText:c,l[e].prevVal=e===0?this._prevVal:this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"value"),this._isRowViewable(d,selCellObj[e].rowIndex)&&(n(o.eq(e).find("a")).remove(),this.XLEdit._refreshTextNode(o[e]),w=!0),nt=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink",d),nt.cellAddr?(c=e===0?v:c,w&&o.eq(e).append(t.buildTag("a",c,"",{href:"#"})),l[e].curText=v):(c=e===0?y:c,w&&o.eq(e).append(t.buildTag("a",c,"",{href:nt.webAddr,target:"_blank"})),l[e].curText=y),l[e].curLink=this.XLEdit.getPropertyValue(selCellObj[e].rowIndex,selCellObj[e].colIndex,"hyperlink"),w&&n(o[e]).find("a").addClass("e-hyperlinks");this._dupDetails=!0;this.XLFormat.format({style:{color:this._hlColor}},i);this._dupDetails=!1;b.selectedCell=l;rt._isImported&&(!rt._isLoaded||this._isExport)||this._completeAction(b)}}},removeHyperlink:function(n,i,r,u,f){if(!this.model.allowHyperlink||this.model.isReadOnly)return!1;var e,c,s,l,a=[],b=this._dupDetails,o,h=this.getActiveSheetIndex(),p=this.getSheet(h),w=[],v,y={sheetIndex:h,reqType:"hyperlink",action:"delete",range:n};for(o=this._getMultiRangeCells(n),e=0,c=o.length;e<c;e++)f&&this._isHiddenRow(o[e].rowIndex)||(s={rowIndex:o[e].rowIndex,colIndex:o[e].colIndex,prevLink:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink"),prevText:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value2"),prevVal:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value"),prevColor:this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"formats")},this._dupDetails=!0,s.prevLink&&(i?this.XLFormat.format({style:{"text-decoration":"underline"}},this._getAlphaRange(h,o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex)):(t.isNullOrUndefined(u)||this.isUndefined(u[e].prevColor)||(l=u[e].prevColor.color),this.XLFormat.format({style:{color:this.isUndefined(l)?"#444445":l}},this._getAlphaRange(h,o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex))),s.curColor=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"formats")),this._dupDetails=b,this.clearRangeData([o[e].rowIndex,o[e].colIndex,o[e].rowIndex,o[e].colIndex],["hyperlink"]),this._isUndoRedo||(s.curLink=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"hyperlink")),this._isUndoRedo&&!this._dupDetails&&(t.isNullOrUndefined(u[e].prevText)||this.XLEdit._updateDataContainer({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex},{dataObj:{value2:u[e].prevText,value:u[e].prevVal},sheetIdx:h})),this._isUndoRedo||(s.curText=this.XLEdit.getPropertyValue(o[e].rowIndex,o[e].colIndex,"value2")),!this._isUndoRedo||this._dupDetails||t.isNullOrUndefined(u[e].prevLink)||(this.XLEdit._updateDataContainer({rowIndex:o[e].rowIndex,colIndex:o[e].colIndex},{dataObj:{hyperlink:u[e].prevLink}}),v={rowIndex:u[e].rowIndex,colIndex:u[e].colIndex},this.XLSelection.selectRange(v,v),this._setLink([u[e]]),a.push(e)),w.push(s));for(e=0,c=a.length;e<c;e++)o.splice(a[e],1);y.selectedCell=w;y.reqType=t.isNullOrUndefined(r)?"hyperlink":"clear-link";p._isImported&&!p._isLoaded||this._isUndoRedo||this._dupDetails||this._isExport||this._completeAction(y)},_removeHyperlink:function(n,t,i,r){var u=this.getActiveSheetIndex(),r=r?r:this.getSheet(u).selectedRange;this.removeHyperlink(this._getAlphaRange(u,r[0],r[1],r[2],r[3]),n==="clear",n,t,i)},_openLink:function(){var n=this.getActiveSheetIndex(),t=this.getSheetElement(n).find(".e-activecell");this._hlClick(this.XLEdit.getPropertyValue(t.closest("tr").index(),t[0].cellIndex,"hyperlink",n))},_hlClick:function(n){var r,f,t,e,s=this.getActiveSheetIndex(),h=this._getLocStr("HyperLinkAlert").split("-"),o,u,i=this.getSheet(s);this.model.enableContextMenu&&this.XLCMenu.hideCMenu();n.cellAddr?(u=n.cellAddr.split("_"),o=u[0].indexOf("$")>-1?u[0].split("$").join(""):u[0],r=this.getRangeIndices(o),t={rowIndex:r[0],colIndex:r[1]},e={rowIndex:r[2],colIndex:r[3]},f=Number(u[1]),this.gotoPage(f,!1),i._activeCell=t,this.XLSelection.selectRange(t,e,f),i._startCell=t,i._endCell=e,this.XLScroll._scrollSelectedPosition(f,t),this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement()):(t={rowIndex:i._activeCell.rowIndex,colIndex:i._activeCell.colIndex},i._startCell=t,i._endCell=t,this._isValidUrl(n.webAddr)?window.open(n.webAddr,"_blank"):this._showAlertDlg("Alert","HyperLinkAlert"))},_isValidUrl:function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(n)},showWaitingPopUp:function(){n("#"+this._id+"_wait").data("ejWaitingPopup").show()},hideWaitingPopUp:function(){n("#"+this._id+"_wait").data("ejWaitingPopup").hide()},_getSelRange:function(n){var t,i,r=this.getActiveSheetIndex();return t=n[0],i=n[n.length-1],this._generateHeaderText(t.colIndex+1)+(t.rowIndex+1)+":"+this._generateHeaderText(i.colIndex+1)+(i.rowIndex+1)},_getSelectedCells:function(n,i){var u,r,f=this.getSheet(n?n:this.getActiveSheetIndex());return t.isNullOrUndefined(i)?(u=f._selectedCells,u.length>0?(i=this._getSelRange(u),r=this.getRangeIndices(i)):(r=[0,0,0,0],u=[{rowIndex:0,colIndex:0}])):(r=this._getRangeArgs(i,"object"),u=this._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]})),{range:r,selCells:u}},_getHiddenCells:function(i,r,u,f){var e=this._dataContainer.sheets[i],o;return t.isNullOrUndefined(f[u.rowIndex])&&(f[u.rowIndex]={}),t.isNullOrUndefined(f[u.rowIndex][u.colIndex])&&(f[u.rowIndex][u.colIndex]={value:{},text:""}),t.isNullOrUndefined(e[u.rowIndex])||(f[u.rowIndex][u.colIndex].value=n.extend(!0,{},e[u.rowIndex][u.colIndex]),o=this.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2",i),delete e[u.rowIndex][u.colIndex],f[u.rowIndex][u.colIndex].text=t.isNullOrUndefined(o)?"":o),this._isRowViewable(i,r.rowIndex)&&(r=this.getCell(r.rowIndex,r.colIndex,i).empty()),f},_getRowSpan:function(n,i){for(var u=0,e=this.model.scrollSettings.allowVirtualScrolling,r=i[0].rowIndex,f=i[i.length-1].rowIndex;r<=f;r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isRHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFilterHide",n))&&(u=u+1);return u},_getColSpan:function(n,i){var u=0,f=this.model.scrollSettings.allowVirtualScrolling,e,r,o;for(f||(e=this._getJSSheetHeader(n).find("col")),r=i[0].colIndex,o=i[i.length-1].colIndex;r<=o;r++)(f||!f&&this._hasClass(e[r],"e-hide"))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(0,r,"isCHide",n))&&(u=u+1);return u},_getHiddenRowColumnCount:function(n,i){var f=this.getRangeIndices(i),e=0,o=0,r,u,s=this.model.scrollSettings.allowVirtualScrolling,h;for(s||(h=this._getJSSheetHeader(n).find("col")),r=f[0];r<=f[2];r++)t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isRHide",n))&&t.isNullOrUndefined(this.XLEdit.getPropertyValue(r,0,"isFHide",n))||(e=e+1);for(u=f[1];u<=f[3];u++)(s||!s&&this._hasClass(h[u],"e-hide")||!t.isNullOrUndefined(this.XLEdit.getPropertyValue(0,u,"isCHide",n)))&&(o=o+1);return{hRow:e,hCol:o}},_updateMergeColl:function(n,i,r,u){var f=this.getSheet(n)._mergeColl;t.isNullOrUndefined(f[i])&&(f[i]={});f[i][r]=u},mergeCells:function(i,r){if(!this.model.isReadOnly){var u,o,c=1,l=1,a,p=[],e=this.getActiveSheetIndex(),v=this.getSheet(e),b=n("#"+this._id+"_alertdlg"),f,h=!1,y,s=this._getRangeArgs(i,"object",e),w=s[2]-s[0]||s[3]-s[1];if(this.model.allowMerging&&(this.model.allowSelection||w)&&!(this.getSheetElement(e).find(".e-ss-activeimg").length>0)&&!this.model.isReadOnly){if(f=this._getSelectedCells(e,s).selCells,this._selMergeCells=[],this._mergeType="merge-cells",(!v._isImported||v._isLoaded)&&!this._isUndoRedo)if(this.performSelection(s),this.mergeCenter){for(h=!1,u=0,a=f.length;u<a;u++)o=this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan,(c>1||l>1)&&(y=this._getHiddenRowColumnCount(e,this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge").mRange),this._unMergeAllCells(e,u,f,p,y.hRow,y.hCol),h=!0));!h||this._dupDetails||this._isUndoRedo||(t.isNullOrUndefined(i)&&(i=this._getSelRange(f)),details={sheetIndex:e,cells:f,range:i,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:p},this._completeAction(details));this.performSelection(s)}else for(u=0,a=f.length;u<a;u++)if(o=this.XLEdit.getPropertyValue(f[u].rowIndex,f[u].colIndex,"merge",e),t.isNullOrUndefined(o)||(c=o.mSpan.rowSpan,l=o.mSpan.colSpan),c===1&&l===1){h=!1;break}v._isImported&&!v._isLoaded||this._isUndoRedo||!this._rangeHasData(s)||r||h||!w?h||this._mergeCells(e,f,{},[]):this._showAlertDlg("","MergeCellsAlert","MergeCells",498);this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}}},_mergeCells:function(i,r,u,f){var a,y,g=0,c=this._dataContainer.sheets[i],p,w,e,s,nt={},h,v,b,l=this.getSheet(i),k=this.XLEdit,d,it=l.columnsWidthCollection,o,tt;if(y=e=r[0].rowIndex,s=r[0].colIndex,this.model.scrollSettings.allowVirtualScrolling||(b=this._getJSSheetHeader(i).find("col")),(t.isNullOrUndefined(k.getPropertyValue(e,0,"isFRHide"))||t.isNullOrUndefined(k.getPropertyValue(e,0,"isRHide")))&&b&&b.eq(s).hasClass("e-fc-hide"))return{hideCell:[],mCells:[]};for(a={rowSpan:this._getRowSpan(i,r),colSpan:r[r.length-1].colIndex-r[0].colIndex+1},t.isNullOrUndefined(c[e])||t.isNullOrUndefined(c[e][s])||(delete c[e][s].isMHide,delete c[e][s].mergeIdx),this._isRowViewable(i,e)&&(h=this.getCell(e,s),h[0].colSpan=a.colSpan,h[0].rowSpan=a.rowSpan,h[0].className=h[0].className.replace("e-mc-hide",""),this.mergeCenter&&h.addClass("e-calign "),h.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(h)),this._selMergeCells.push(r[0]),this._textClip(r[0].rowIndex,r[0].colIndex,"add"),this._textClip(r[0].rowIndex,r[0].colIndex,"delete","",!0),this._isRowViewable(i,r[0].rowIndex)&&this.addClass(this.getCell(r[0].rowIndex,r[0].colIndex)[0],"e-moverflow"),g=this._getRowHeight(r[0].rowIndex,i),o=1,tt=r.length;o<tt;o++)this._isRowViewable(i,r[o].rowIndex)&&(v=this.getCell(r[o].rowIndex,r[o].colIndex),this._hasClass(v[0],"e-mc-hide")||this.addClass(v[0],"e-mc-hide"),this.addClass(v[0],"e-moverflow")),y!==r[o].rowIndex&&l.hideRowsCollection.indexOf(r[o].rowIndex)==-1&&(g+=this._getRowHeight(r[o].rowIndex,i),y=r[o].rowIndex),this._textClip(r[o].rowIndex,r[o].colIndex,"add"),this._textClip(r[o].rowIndex,r[o].colIndex,"delete","",!0),u=this._getHiddenCells(i,{rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},r[o],u),this.XLEdit._updateDataContainer({rowIndex:r[o].rowIndex,colIndex:r[o].colIndex},{dataObj:{isMHide:!0,mergeIdx:{rowIndex:e,colIndex:s}},sheetIdx:i}),this._selMergeCells.push(r[o]);return t.isNullOrUndefined(c[e])||n.extend(!0,nt,c[e][s]),w=this._getSelRange(r),l._activeCell=r[0],(!l._isImported||l._isLoaded)&&this.performSelection(r[0],r[r.length-1]),this.XLEdit._updateDataContainer({rowIndex:e,colIndex:s},{dataObj:{merge:{mSpan:a,isMerge:!0,mRange:w,isCenterAlign:this.mergeCenter}}}),this._updateMergeColl(i,e,s,this.mergeCenter?"center":"merge"),f.push({rowIndex:e,colIndex:s,prevObj:nt,curObj:n.extend(!0,{},c[e][s])}),k.getPropertyValue(e,s,"wrap")&&(d=this._getWrapCellHeight(i,e,s).rowHt,this._getRowHeight(e,i)<d&&this.setHeightToRows([{rowIndex:e,height:d}])),l._isImported&&!l._isLoaded||this._isUndoRedo||this._dupDetails||this._paste||this._mergeType!=="merge-cells"||(p={sheetIndex:i,cells:[{rowIndex:e,colIndex:s}],range:w,reqType:"merge-cells",action:"merge-all",hideCells:u,mCells:f},p.operation=this.mergeCenter?"merge-center":"merge-all",this._paste||this._completeAction(p)),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this.mergeCenter=!1,this._paste=!1,this.XLEdit._updateUsedRange(e+a.rowSpan,s+a.colSpan),{hideCells:u,mCells:f}},mergeAcrossCells:function(t,i){if(!this.model.isReadOnly){var u=this.getActiveSheetIndex(),f=this.getSheet(u),o=n("#"+this._id+"_alertdlg"),e,r;(r=this._getRangeArgs(t,"object",u),isMultiCell=r[2]-r[0]||r[3]-r[1],isMultiCol=r[3]-r[1],!this.model.allowMerging||this.getSheetElement(u).find(".e-ss-activeimg").length>0||!isMultiCell||this.model.isReadOnly)||(this._selMergeCells=[],e=this._getSelectedCells(u,r),this.isUndefined(t)||this.performSelection(r),!this._isUndoRedo&&this._rangeHasData(r)&&(!f._isImported||f._isLoaded)&&!i&&isMultiCol?this._showAlertDlg("","MergeCellsAlert","MergeAcrossCells",498):isMultiCol&&this._mergeAcrossCells(u,e.selCells),this.performSelection(r),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons())}},_mergeAcrossCells:function(i,r){var u,e,l,o,s=1,a=1,h=!0,v,y,p,w,b,c=[],f={mCells:[],hideCells:{}},k=this.getSheet(i);for(this._mergeType="merge-across",u=0,l=r.length;u<l;u++)if(o=this.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"merge",i),t.isNullOrUndefined(o)||(s=o.mSpan.rowSpan,a=o.mSpan.colSpan),s===1&&a===1){h=!1;break}else s>1&&(h=!1);if(!h)for(w=r[0].rowIndex,b=r[r.length-1].rowIndex,y=r[0].colIndex,p=r[r.length-1].colIndex,u=w;u<=b;u++){for(c=[],e=y;e<=p;e++)c.push({rowIndex:u,colIndex:e});f=this._mergeCells(i,c,f.hideCells,f.mCells)}k._isImported&&!k._isLoaded||this._isUndoRedo||this._dupDetails||(v={sheetIndex:i,cells:n.extend(!0,[],this._selMergeCells),range:this._getSelRange(this._selMergeCells),reqType:"merge-cells",action:"merge-across",operation:"merge-across",hideCells:f.hideCells,mCells:f.mCells},this._paste||this._completeAction(v),this._paste=!1);this.performSelection(r[0],r[r.length-1])},unmergeCells:function(n){var u,l;if(!this.model.isReadOnly){var r=this.getActiveSheetIndex(),e=this.getSheet(r),o=[],i,h,s,f,a=e._clrMergeColl,c=this._getRangeArgs(n,"object",r);if(this.model.allowMerging&&!(this.getSheetElement(r).find(".e-ss-activeimg").length>0)&&!this.model.isReadOnly){for(this._selMergeCells=[],i=this._getSelectedCells(r,c).selCells,u=0,l=i.length;u<l;u++)f=this.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"merge",r),this.isUndefined(f)||(s=this._getHiddenRowColumnCount(r,f.mRange),o=this._unMergeAllCells(r,u,i,o,s.hRow,s.hCol),a.push({rowIdx:i[u].rowIndex,colIdx:i[u].colIndex,mergeObj:f}));t.isNullOrUndefined(n)&&(n=this._getSelRange(i));this.performSelection(c);e._isImported&&!e._isLoaded||this._isUndoRedo||this._dupDetails||this._isExport||(h={sheetIndex:r,cells:i,range:n,reqType:"merge-cells",action:"un-merge",operation:"un-merge",mCells:o},this._completeAction(h));this.model.showRibbon&&this.XLRibbon._updateRibbonIcons()}}},_unMergeAllCells:function(i,r,u,f,e,o){var s,h,e,o,y,k,d=1,g=1,w,b=!1,l=this._dataContainer.sheets[i],ut={},p,nt,v,c,a,ft,tt,it=this.getSheet(i),rt;if(c=u[r].rowIndex,a=u[r].colIndex,rowhdrrows=this.getRows(i)[0],p=this.getCell(c,a),y=this.XLEdit.getPropertyValue(c,a,"merge",i),t.isNullOrUndefined(y)||(d=y.mSpan.rowSpan,g=y.mSpan.colSpan),g>1||d>1)for(tt=l[c][a],n.extend(!0,ut,tt),delete tt.merge,delete it._mergeColl[c][a],this.getObjectKeys(it._mergeColl[c]).length<1&&delete it._mergeColl[c],this._isRowViewable(i,c)&&(p=this.getCell(c,a),this.XLEdit.getPropertyValue(c,a,"wrap",i)&&!this.XLEdit.getPropertyValue(c,a,"cellType",i)&&(k=p.find("#"+this._id+"_MergeWrap"),k.length&&(p[0].innerHTML=k[0].innerHTML,k.remove())),t.isNullOrUndefined(y.isCenterAlign)||p.removeClass("e-calign"),p[0].colSpan=p[0].rowSpan=1,rt=p[0].offsetHeight,n(rowhdrrows[c]).height()<rt&&this.XLEdit.getPropertyValue(c,a,"wrap")&&this.setHeightToRows([{rowIndex:c,height:rt}]),this.XLScroll._getRowHeights(i,c)),f.push({rowIndex:c,colIndex:a,prevObj:ut,curObj:n.extend(!0,{},l[c][a])}),ft=[],s=c;s<c+d+e;s++)for(h=a;h<a+g+o;h++)this._selMergeCells.push({rowIndex:s,colIndex:h}),this._isRowViewable(i,s)&&(v=this.getCell(s,h,i),b=!0),t.isNullOrUndefined(this.XLEdit.getPropertyValue(s,h,"isMHide",i))||(this._isUndoRedo&&(w=this.XLEdit.getPropertyValue(s,h,"merge",i),t.isNullOrUndefined(w)||(w.mergeSpan.rowSpan>1||w.mergeSpan.colSpan>1)&&(ft.push({rowIndex:s,colIndex:h,rowSpan:w.mergeSpan.rowSpan,colSpan:w.mergeSpan.colSpan}),l[s][h].merge.mSpan={rowSpan:1,colSpan:1},v[0].rowSpan=1,v[0].colSpan=1)),mergeIdx=this.XLEdit.getPropertyValue(s,h,"mergeIdx",i),t.isNullOrUndefined(mergeIdx)||mergeIdx.rowIndex===c&&mergeIdx.colIndex===a&&(b&&(v.removeClass("e-mc-hide"),v[0].rowSpan=1,v[0].colSpan=1),delete l[s][h].isMHide,delete l[s][h].mergeIdx)),this._isUndoRedo&&!t.isNullOrUndefined(this._delCells)&&(t.isNullOrUndefined(this._delCells[s])||t.isNullOrUndefined(this._delCells[s][h])||t.isNullOrUndefined(l[s])||(nt=!t.isNullOrUndefined(l[s][h])&&l[s][h].overflow,l[s][h]=this._delCells[s][h].value,nt&&(l[s][h].overflow=nt),b&&v.text(this._delCells[s][h].text),y=this.XLEdit.getPropertyValue(s,h,"merge"),!t.isNullOrUndefined(y)&&y.isMerge&&this.mergeCells(y.mRange,!0))),b&&v.hasClass("e-commentcell")&&this.model.allowComments&&this.XLComment._updateCmntArrowPos(v),b&&(this._removeClass(v[0],"e-moverflow"),v.text().length>0?this._textClip(s,h,"add"):this._textClip(s,h,"delete")),t.isNullOrUndefined(l[s])||(this.getObjectLength(l[s][h])<1&&delete l[s][h],this.getObjectLength(l[s])<1&&delete l[s]);return f},_showHeadings:function(n,t){if(!this.model.isReadOnly){var t=t?t:this.getActiveSheetIndex(),i=this.getSheet(t),f=this._getJSSheetHeader(t),e=this._getContent(t).find(".e-content"),o=this._getJSSheetRowHeader(t),r=this.getFrozenRows(),u=this.getFrozenColumns();i.showHeadings=n;this._isDisplayHeader=!0;i.showHeadings?(o.show(),f.show(),e.removeClass("e-viewbrdr")):(o.hide(),f.hide(),e.addClass("e-viewbrdr"));this._heightWidthCalculation(t,{action:i._isLoaded?"":"initial"});this.model.showRibbon&&(checkObj=this.element.find("#"+this._id+"_Ribbon_PageLayout_Show_Headings").data("ejCheckBox"),checkObj&&(n?checkObj._checked():checkObj._unChecked()));this.model.allowFreezing&&i._isFreezed&&(this.XLFreeze.unfreezePanes(),this._isFrozen(r)&&this._isFrozen(u)?this.XLFreeze.freezePanes(r,u):this._isFrozen(r)?this.XLFreeze.freezeRows(r):this._isFrozen(u)&&this.XLFreeze.freezeColumns(u))}},showHeadings:function(n){this._showHeadings(n)},showGridlines:function(n){this._showGridlines(n)},_showGridlines:function(n,t){if(!this.model.isReadOnly){var t=t?t:this.getActiveSheetIndex(),i=this.getSheet(t),r=this._getContent(t).find(".e-rowcell");this.model.showRibbon&&(checkObj=this.element.find("#"+this._id+"_Ribbon_PageLayout_Show_Gridlines").data("ejCheckBox"),checkObj&&(n?checkObj._checked():checkObj._unChecked()));i.showGridlines=n;i.showGridlines?r.removeClass("e-hborder"):r.addClass("e-hborder")}},setSheetFocus:function(){this._hasClass(document.activeElement,"e-datepicker")||this.element.focus();this._isInitLoad||window.scrollTo(window.pageXOffset,window.pageYOffset)},_diffNumbers:function(n,t){return n-t},_isValidDate:function(n){var t,i;return/^\d{1,4}[\.|\/|-]\d{1,2}[\.|\/|-]\d{1,4}$/.test(n)?(n=n.replace(/0*(\d*)/gi,"$1"),t=n.split(/[\.|\/|-]/),t[0]=t[0]-1,t[2].length<4&&(t[2]=parseInt(t[2])<50?2e3+parseInt(t[2]):1900+parseInt(t[2])),i=new Date(t[2],t[0],t[1]),i.getDate()!=t[1]||i.getMonth()!=t[0]||i.getFullYear()!=t[2]?!1:!0):!1},_isValidTime:function(n){for(var t,r,i=0,o=!1,f,e,u=0,s=n.length;u<s;u++){if(t=n.substring(u,u+1),(t<"0"||t>"9")&&t!=":"&&t!=" "&&t!="a"&&t!="A"&&t!="p"&&t!="P"&&t!="m"&&t!="M")return!1;t==":"&&i++;(t=="p"||t=="P"||t=="a"||t=="A")&&(o=!0)}return i<1||i>2?!1:(r=n.substring(0,n.indexOf(":")),parseFloat(r)<0||parseFloat(r)>23)?!1:o&&(parseFloat(r)<1||parseFloat(r)>12)?!1:(f=i==2?n.substring(n.indexOf(":")+1,n.lastIndexOf(":")):n.substring(n.indexOf(":")+1,n.length),parseFloat(f)<0||parseFloat(f)>59)?!1:(e=i==2?n.substring(n.lastIndexOf(":")+1,n.length):"00",parseFloat(e)<0||parseFloat(e)>59)?!1:!0},_setXY:function(n,t){var i=0,r=0;return t=t?"page":"client",n.type==="mousemove"||n.type==="mousedown"||n.type==="mouseup"?(i=n[t+"X"],r=n[t+"Y"]):n.type==="touchmove"||n.type==="touchstart"||n.type==="touchend"?(i=n.originalEvent.changedTouches[0][t+"X"],r=n.originalEvent.changedTouches[0][t+"Y"]):(n.type==="MSPointerMove"||n.type==="pointermove"||n.type==="MSPointerUp"||n.type==="pointerup"||n.type==="MSPointerDown"||n.type==="pointerdown")&&(i=n.originalEvent[t+"X"],r=n.originalEvent[t+"Y"]),[i,r]},_getSelectedItems:function(n,i,r){var f,e,o,u;return n=n?n:this.getActiveSheetIndex(),u=this.getSheet(n),t.isNullOrUndefined(r)&&t.isNullOrUndefined(i)?(f=u._selectedCells,e=u._startCell,o=u._endCell,r=this._generateHeaderText(e.colIndex+1)+(e.rowIndex+1)+":"+this._generateHeaderText(o.colIndex+1)+(o.rowIndex+1)):(i=this.isUndefined(i)?this.getRangeIndices(r):i,f=this.getRange(i,n),r=this._generateHeaderText(i[1]+1)+(i[0]+1)+":"+this._generateHeaderText(i[3]+1)+(i[2]+1)),[f,r]},setBorder:function(n,t){if(this.model.allowCellFormatting&&!this.model.isReadOnly){var f="",e=!1,l=n.style,u=n.type,h=n.color,o,a,c,v,r,y,s=this._getContent(this.getActiveSheetIndex()).find("div:first-child");if(this.model.allowSelection||u!=="drawborder"&&u!=="drawbordergrid"){o=["bottom","top","left","right","outside","allborder"];a=["thickbox","thickbottom","topandbottom","topandthickbottom"];c={top:{top:""},right:{right:""},bottom:{bottom:""},left:{left:""},outside:{top:"",right:"",bottom:"",left:""},thickbox:{top:"2px solid",right:"2px solid",bottom:"2px solid",left:"2px solid"},thickbottom:{bottom:"2px solid"},topandbottom:{top:"1px solid",bottom:"1px solid"},topandthickbottom:{top:"1px solid",bottom:"2px solid"}};v={solid:"1px solid",dashed:"1px dashed",dotted:"1px dotted"};this.model.allowSelection&&(this.XLSelection._isGridBordering=this.XLSelection._isOutsideBordering=!1);switch(!0){case o.indexOf(u)>-1:e=u===o[5];r=c[e?o[4]:u];for(i in r)r[i]=v[l]+" "+h;e&&(r.isGridBorder=e);r.property=n;this.XLFormat.applyBorder(r,t);break;case a.indexOf(u)>-1:r=c[u];for(i in r)f="",y=r[i].split(" "),f=y.length===2?f+r[i]+" "+h:f+r[i]+" "+l+" "+h,r[i]=f;r.property=n;this.XLFormat.applyBorder(r,t);break;case u==="noborder":this.XLFormat.format({border:{}},t);break;case u==="drawborder":this.XLSelection._isOutsideBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrcursor");this.XLSelection._cleanUp(!0);break;case u==="drawbordergrid":this.XLSelection._isGridBordering=!0;s.removeClass("e-ss-cursor");s.addClass("e-ss-drwbrdrgridcursor");this.XLSelection._cleanUp(!0)}}}},clearBorder:function(n){this.model.isReadOnly||(n=this._getRangeArgs(n,"object"),this.XLFormat.removeStyle(n,{cellStyle:!0,tableStyle:!0,border:!0}))},clearHyperlinks:function(){this.model.allowClear&&!this.model.isReadOnly&&this._removeHyperlink("clear")},clearComments:function(n){this.model.allowClear&&!this.model.isReadOnly&&this.model.allowComments&&this.XLComment.deleteComment(r,n,!1,"clear")},clearAllFormat:function(i){if(this.model.allowClear&&!this.model.isReadOnly){var s=this.getActiveSheetIndex(),c=this._dataContainer.sheets[s],u=[],f,e,h=this.getSheet(s),r=this._getRangeArgs(i,"object"),l,o={sheetIndex:s,reqType:"clear-format",range:r};(o.bData=n.extend(!0,[],this.getRangeData({range:r,property:["format","tformats","type","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule"]})),this._dupDetails=!0,f=this.getObjectKeys(c),u[0]=r[0]>parseInt(f[0])?r[0]:parseInt(f[0]),u[2]=r[2]<parseInt(f[f.length-1])?r[2]:parseInt(f[f.length-1]),e=this.getObjectKeys(c[u[2]]),u[1]=r[1]>parseInt(e[0])?r[1]:parseInt(e[0]),u[3]=r[3]<parseInt(e[e.length-1])?r[3]:parseInt(e[e.length-1]),t.isNullOrUndefined(f))||(l=this._checkTableRange(this._getAlphaRange(s,u[0],u[1],u[2],u[3])),l.status!=="partial")&&(this.clearRangeData(r,["format","formatStr","decimalPlaces","thousandSeparator","formats","hyperlink","cFormatRule","border"],"",!1,o.reqType),this.clearBorder(i),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(r),h._clrWrapColl=[],h._clrMergeColl=[],this._isPaste=!0,this.setWrapText("unwrap",r),this._isPaste=!1,this.unmergeCells(r),o.wrapColl=n.extend(!0,[],h._clrWrapColl),o.mergeColl=n.extend(!0,[],h._clrMergeColl),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),this._dupDetails=!1,this._isUndoRedo||this._completeAction(o))}},clearContents:function(t){if(!this.model.isReadOnly){t=this._getRangeArgs(t,"object");var i=this.getActiveSheetIndex(),u=this.getRangeData({range:t,property:["value","value2","type","hyperlink"]}),r={sheetIndex:i,reqType:"clear-content",range:t,bData:n.extend(!0,[],u)};this.model.allowClear&&!this._isPropExists([t],"isReadOnly",i)&&(this.clearRangeData(t,["value","value2","hyperlink"],"",!1,r.reqType),this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(t),this._completeAction(r),this.setSheetFocus(),this.model.allowFormulaBar&&this.updateFormulaBar())}},clearAll:function(i){if(!this.model.isReadOnly){var e,o,c,s=this.getActiveSheetIndex(),h=this.getSheet(s),u=[],r=this._getRangeArgs(i,"object"),f={sheetIndex:s,reqType:"clear-all",range:r},l=this._dataContainer.sheets[s];if(this.model.allowClear&&!this._isPropExists([r],"isReadOnly",s)&&(this._dupDetails=!0,e=this.getObjectKeys(l),u[0]=r[0]>parseInt(e[0])?r[0]:parseInt(e[0]),u[2]=r[2]<parseInt(e[e.length-1])?r[2]:parseInt(e[e.length-1]),o=this.getObjectKeys(l[u[2]]),u[1]=r[1]>parseInt(o[0])?r[1]:parseInt(o[0]),u[3]=r[3]<parseInt(o[o.length-1])?r[3]:parseInt(o[o.length-1]),c=this._getAlphaRange(s,u[0],u[1],u[2],u[3]),!t.isNullOrUndefined(e)&&!t.isNullOrUndefined(o))){if(f.bData=n.extend(!0,[],this.getRangeData({range:r,property:["value","value2","hyperlink","merge","rule","cFormatRule","comment","format","formatStr","formats","tformat","decimalPlaces","thousandSeparator","type","borders","tborders"],sheetIdx:s})),f.bBorder=this.XLFormat.getHashCodeClassAsArray(r),isTable=this._checkTableRange(c),isTable.status==="full")f.tblObj=isTable.tableObj,f.tblObj.tblId=isTable.tblId,f.tblObj.header=!0,this.XLFormat.removeTable(f.tblObj.tblId);else if(isTable.status==="partial")return;this.clearRangeData(r,["value","value2","hyperlink","cFormatRule","comment","format","formats","formatStr","decimalPlaces","thousandSeparator"],"",!1);this.clearBorder(c);this.model.allowFiltering&&this.XLFilter.clearFilter("remove");h._clrMergeColl=[];h._clrWrapColl=[];this.model.allowConditionalFormats&&this.XLCFormat.refreshCFormat(r);this.model.allowDataValidation&&this.XLValidate.clearDV();this._isPaste=!0;this.setWrapText("unwrap",r);this._isPaste=!1;this.unmergeCells(r);f.mergeColl=n.extend(!0,[],h._clrMergeColl);f.wrapColl=n.extend(!0,[],h._clrWrapColl);this._dupDetails=!1;this.model.showRibbon&&(this.XLRibbon._updateRibbonIcons(),this.XLRibbon._toggleDesignTab(this.getActiveCell()));this._completeAction(f)}}},_checkTableRange:function(n,t){var e,o=this.getActiveSheetIndex(),s=this.model.sheets[o],r,u,h=this.getRangeIndices(n),i,f;return t?i=this.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"tableName"):(f=this.XLEdit._getPropWithCellIdx(h,"tableName"),f.length&&(i=f[0].value)),i?(r=this._getTableID(i),u=s.tableManager[r],tRange=u.range,e=this._getAlphaRange(o,tRange[0],tRange[1],tRange[2],tRange[3]),n===e?{status:"full",tableObj:u,tblId:r}:{status:"partial"}):{status:"no-table"}},clearTextNode:function(n,i){if(!t.isNullOrUndefined(n)&&!this.model.isReadOnly){var r=this.getActiveSheetIndex(),u=n[0].parentNode.rowIndex,f=n[0].cellIndex,o=this._dataContainer.sheets[r],e=n[0].childNodes[n[0].childNodes.length-1];(i=i||"",this._checkIndicesInContainer(r,u,f,"rule")&&o[u][f].rule.type==="list")||t.isNullOrUndefined(e)||e.hasChildNodes("a")||(n[0].lastChild.textContent=i)}},_isClassHasProperty:function(n,t,i){var r=this.XLFormat.getFormatFromHashCode(n);return r[t]&&r[t].toLowerCase()===i?!0:!1},_changeTargetWithOffset:function(t){var r,i=n(t.target),u=t.offsetX||t.pageX-i.offset().left;if(this._hasClass(document.activeElement,"e-datepicker")&&t.type==="mouseup"&&n("#"+this._id).focus(),i.is("a")&&(r=t.target,t.target=t.target.parentNode),i.is("#"+this._id+"_MergeWrap"))return i.parents().closest("td")[0];if(this._hasClass(i.parents().closest("td"),"e-cellreadonly"))return this._hasClass(i,"e-datepicker")&&t.type==="mouseup"&&i.focus(),i.parents().closest("td")[0];if(i.is("td")&&this._hasClass(i,"e-cellreadonly")&&i.find(".e-chk-image").length>0&&t.type==="mouseup")return n("#"+i.find(".e-checkbox")[0].id).ejCheckBox("instance")._checkedHandler(),t.target;if((u>t.target.offsetWidth||u<0)&&i.is("td")&&i.parents(".e-spreadsheetmainpanel").length&&this._hasClass(i,"e-rowcell")){var f=this.getSheet(this.getActiveSheetIndex()),e=this._getCellIdx(t.target),o=f._colWidthCollection[e.colIndex]+u,s=f._rowHeightCollection[e.rowIndex];return r&&this.addClass(r,"e-rmanchor"),this.getCell(this.XLShape._getCellIndexFromOffset(s,o).rowIndex,this.XLShape._getCellIndexFromOffset(s,o).colIndex)[0]}return r?(this._removeClass(r,"e-rmanchor"),r):(this._removeClass(i.find("a")[0],"e-rmanchor"),t.target)},_textClip:function(n,i,r,u,f){var g,e,v,o;if(this._canOverflow&&!this.XLEdit.getPropertyValue(n,i,"merge")&&!this.XLEdit.getPropertyValue(n,i,"wrap")){var p,w,y,a,nt,l,et,it,ct,ot,c,st,rt,ut=!1,d=!1,b=!1,ht=!1,s=this.XLEdit,h=this.getActiveSheetIndex(),ft=this.getSheet(h),k=ft._isLoaded||this.isImport,g=this.getCell(n,i),tt=s.getPropertyValue(n,i,"format",h);if(g&&(y=g[0]),this._isClassHasProperty(tt,"text-align","right")&&(b=!0),!(s.getPropertyValue(n,i,"cellType",h)>-1)){if(this._dupDetails||(this._dupDetails=ut=!0),r==="add"){if(!this.model.allowOverflow){this.addClass(y,"e-overflow");s._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{isOverflow:!1},skipCell:!0});ut&&(this._dupDetails=!1);return}if(this._hasClass(y,"e-overflow")&&this._removeClass(y,"e-overflow"),this.clearRangeData([n,i,n,i],["isOverflow"],"","","",!0),s.getPropertyValue(n,i+1,"value2",h)&&!b&&(d=!0),d||(ct=ft._rowHeightCollection,ot=ft._ofColWidthColl,rt=y?this.XLFormat.getFormatFromHashCode(this.XLFormat.getFormatClass(y.className)):{},u||(span=document.getElementById(this._id+"_emptySpan"),this.addClass(span,"e-rowcell e-wrapword"),this.addClass(span,tt),span.textContent=s.getPropertyValue(n,i,"value2",h),u="text-indent"in rt?Math.round(4/3*Number(rt[t.Spreadsheet.SupportedStyles.TextIndent].replace("pt",""))+this._detailsFromGlobalSpan(n,i,"width",span.textContent)):span.offsetWidth),this._refreshGlobalSpan(span),et=this.XLShape._getCellIndexFromOffset(null,ot[i]+u,h,!0),w=et.colIndex-i),!f&&s.getPropertyValue(n,i,"value2",h)&&(c=s.getPropertyValue(n,i,"overflow",h),!t.isNullOrUndefined(c)&&c.rowIndex===n))if(it=this.getCell(c.rowIndex,c.colIndex),it&&this.addClass(it[0],"e-overflow"),s._updateDataContainer({rowIndex:c.rowIndex,colIndex:c.colIndex},{dataObj:{isOverflow:!1},skipCell:!0}),c.colIndex<i)for(e=0,v=c.cellCount;e<=v;e++)e!==0&&this.clearRangeData([n,c.colIndex+e,n,c.colIndex+e],["overflow"],"","","",!0),e!==v&&(a=this.getCell(n,c.colIndex+e),k&&a&&this._removeClass(a[0],"e-ofbrdr"),this.clearRangeData([n,c.colIndex+e,n,c.colIndex+e],["isOfBrdr"],"","","",!0));else for(e=c.cellCount;e>0;e--)this.clearRangeData([n,c.colIndex-e,n,c.colIndex-e],["overflow"],"","","",!0),a=this.getCell(n,c.colIndex-e),k&&a&&this._removeClass(a[0],"e-ofbrdr"),this.clearRangeData([n,c.colIndex-e,n,c.colIndex-e],["isOfBrdr"],"","","",!0);if(b||d){for(e=i-1,v=i-w;e>=v;e--)if(l=s.getPropertyValue(n,e,"overflow",h),l&&l.colIndex!==i&&!ht&&(ht=!0,this._textClip(l.rowIndex,l.colIndex,"delete","",!0),g=this.getCell(l.rowIndex,l.colIndex),g&&this.addClass(g[0],"e-overflow")),s.getPropertyValue(n,e,"value2",h)){d=!0;break}}else for(e=1;e<=w;e++)if(s.getPropertyValue(n,i+e,"value2",h)||s.getPropertyValue(n,i+e,"merge",h)||s.getPropertyValue(n,i+e,"isMHide",h)||s.getPropertyValue(n,i+e,"overflow",h)&&s.getPropertyValue(n,i+e,"overflow",h).colIndex!==i){d=!0;break}if(d)this.addClass(y,"e-overflow"),s._updateDataContainer({rowIndex:n,colIndex:i},{dataObj:{isOverflow:!1},skipCell:!0});else if(w!==0)for(e=0;e<=w;e++)nt=b?i-e:i+e,e&&s._updateDataContainer({rowIndex:n,colIndex:nt},{dataObj:{overflow:{rowIndex:n,colIndex:i,cellCount:w}},skipCell:!0}),((!b||b&&e!==0)&&e!==w||e===w&&b)&&(k&&this._isRowViewable(h,n)&&this.addClass(this.getCell(n,nt)[0],"e-ofbrdr"),s._updateDataContainer({rowIndex:n,colIndex:nt},{dataObj:{isOfBrdr:!0},skipCell:!0}))}else if(r==="delete"){if(st=this._dataContainer.sheets[h],keys=this.getObjectKeys(st[n]),this._hasClass(y,"e-overflow"))this._removeClass(y,"e-overflow"),this.clearRangeData([n,i,n,i],["isOverflow"],"","","",!0);else if(b){if(l=s.getPropertyValue(n,i-1,"overflow",h),!t.isNullOrUndefined(l)&&l.colIndex===i)for(o=i-1,v=i-l.cellCount;o>=v;o--)this.clearRangeData([n,o,n,o],["overflow"],"","","",!0),k&&(a=this.getCell(n,o),a&&this._removeClass(a[0],"e-ofbrdr")),this.clearRangeData([n,o,n,o],["isOfBrdr"],"","","",!0)}else if(l=s.getPropertyValue(n,i+1,"overflow",h),!t.isNullOrUndefined(l)&&l.colIndex===i)for(o=i,v=i+1+l.cellCount;o<v;o++)o!==i&&this.clearRangeData([n,o,n,o],["overflow"],"","","",!0),o!==v&&(k&&(a=this.getCell(n,o),a&&this._removeClass(a[0],"e-ofbrdr")),this.clearRangeData([n,o,n,o],["isOfBrdr"],"","","",!0));if(!f&&this.model.allowOverflow){for(o=keys.indexOf(i.toString())-1;o>-1;o--)if(k&&(p=this.getCell(n,keys[o])),s.getPropertyValue(n,keys[o],"value2",h)||s.getPropertyValue(n,keys[o],"isMHide",h)){this._hasClass(p,"e-overflow")&&(p&&this._removeClass(p[0],"e-overflow"),this.clearRangeData([n,keys[o],n,keys[o]],["isOverflow"],"","","",!0),this._textClip(n,parseInt(keys[o]),"add"));break}for(o=keys.indexOf(i.toString())+1;o<keys.length;o++)if(k&&(p=this.getCell(n,keys[o])),s.getPropertyValue(n,keys[o],"value2",h)||s.getPropertyValue(n,keys[o],"isMHide",h)){tt=s.getPropertyValue(n,keys[o],"format",h);this._hasClass(p,"e-overflow")&&this._isClassHasProperty(tt,"text-align","right")&&(p&&this._removeClass(p[0],"e-overflow"),this.clearRangeData([n,keys[o],n,keys[o]],["isOverflow"],"","","",!0),this._textClip(n,parseInt(keys[o]),"add"));break}}}ut&&(this._dupDetails=!1)}}},selectAll:function(n){if(this.model.allowSelection){var y=[],w=[],k=[],b=[],r,i,s,g=!1,p=0,v=this.XLEdit,nt=this.getActiveCell(),e=nt.rowIndex,o=nt.colIndex,a=this.getActiveSheetIndex(),rt=this._dataContainer.sheets[a],d=this.getObjectKeys(rt),ut=parseInt(d[0]),ft=parseInt(d[d.length-1]),c=this.getSheet(a),tt=this._getUsedRangeFromSheet(a,!1),it=tt.rowCount+tt.colCount;if(c._startCell.rowIndex!==c._endCell.rowIndex||c._startCell.colIndex!==c._endCell.colIndex&&c._isMultiSelect){var f={rowIndex:c._startCell.rowIndex,colIndex:c._startCell.colIndex},u={rowIndex:c._endCell.rowIndex,colIndex:c._endCell.colIndex},l={rowIndex:c._startCell.rowIndex,colIndex:c._startCell.colIndex},h={rowIndex:c._endCell.rowIndex,colIndex:c._endCell.colIndex};for(g=!0,r=1;r<it;r++){for(i=l.colIndex;i<h.colIndex+2;i++)(v.getPropertyValue(l.rowIndex-1,i,"value2")||this._getDataObj(l.rowIndex-1,i,"mergeIdx",a))&&(f.colIndex=l.colIndex<i?l.colIndex:i,u.colIndex=h.colIndex>i?h.colIndex:i,f.rowIndex=l.rowIndex<l.rowIndex-1?l.rowIndex:l.rowIndex-1);for(i=l.rowIndex;i<h.rowIndex+2;i++)(v.getPropertyValue(i,h.colIndex+1,"value2")||this._getDataObj(i,h.colIndex+1,"mergeIdx",a))&&(u.rowIndex=h.rowIndex>i?h.rowIndex:i);for(i=h.colIndex;i>l.colIndex-2;i--)(v.getPropertyValue(h.rowIndex+1,i,"value2")||this._getDataObj(h.rowIndex+1,i,"mergeIdx",a))&&(u.rowIndex=h.rowIndex>h.rowIndex+1?h.rowIndex:h.rowIndex+1,f.colIndex=l.colIndex<i?l.colIndex:i);for(i=h.rowIndex;i>l.rowIndex-2;i--)(v.getPropertyValue(h.rowIndex+1,i,"value2")||this._getDataObj(h.rowIndex+1,i,"mergeIdx",a))&&(u.rowIndex=h.rowIndex>h.rowIndex+1?h.rowIndex:h.rowIndex+1,f.colIndex=l.colIndex<i?l.colIndex:i);if(u.colIndex===h.colIndex&&u.rowIndex===h.rowIndex&&f.rowIndex===l.rowIndex&&f.colIndex===l.colIndex)if(r===1){c._isRangeSelected=!0;break}else{c._isRangeSelected=!1;break}l={rowIndex:f.rowIndex,colIndex:f.colIndex};h={rowIndex:u.rowIndex,colIndex:u.colIndex}}}if(!c._isRangeSelected&&!g){var f={rowIndex:e,colIndex:o},u={rowIndex:e,colIndex:o},l={rowIndex:e,colIndex:o},h={rowIndex:e,colIndex:o};for(r=1;r<it+1;r++){for(i=-p;i<p+1;i++)(v.getPropertyValue(e+i,o+r,"value2")||this._getDataObj(e+i,o+r,"mergeIdx",a))&&(u.rowIndex=u.rowIndex>e+i?u.rowIndex:e+i,u.colIndex=u.colIndex>o+r?u.colIndex:o+r);for((v.getPropertyValue(e+r,o+r,"value2")||this._getDataObj(e+r,o+r,"mergeIdx",a))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,u.colIndex=u.colIndex>o+r?u.colIndex:o+r),i=-p;i<p+1;i++)(v.getPropertyValue(e+r,o+i,"value2")||this._getDataObj(e+r,o+i,"mergeIdx",a))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,u.colIndex=u.colIndex>o+i?u.colIndex:o+i);if(!v.getPropertyValue(e,o,"value2")&&u.colIndex===h.colIndex&&u.rowIndex===h.rowIndex&&f.rowIndex===l.rowIndex&&f.colIndex===l.colIndex&&p===0){c._isRangeSelected=!0;break}for((v.getPropertyValue(e+r,o-r,"value2")||this._getDataObj(e+r,o-r,"mergeIdx",a))&&(u.rowIndex=u.rowIndex>e+r?u.rowIndex:e+r,f.colIndex=f.colIndex<o-r?f.colIndex:o-r),i=-p;i<p+1;i++)(v.getPropertyValue(e+i,o-r,"value2")||this._getDataObj(e+i,o-r,"mergeIdx",a))&&(f.rowIndex=f.rowIndex<e+i?f.rowIndex:e+i,f.colIndex=f.colIndex<o-r?f.colIndex:o-r,u.rowIndex=u.rowIndex>e+i?u.rowIndex:e+i);for((v.getPropertyValue(e-r,o-r,"value2")||this._getDataObj(e-r,o-r,"mergeIdx",a))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,f.colIndex=f.colIndex<o-r?f.colIndex:o-r),i=-p;i<p+1;i++)(v.getPropertyValue(e-r,o+i,"value2")||this._getDataObj(e-r,o+i,"mergeIdx",a))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,f.colIndex=f.colIndex<o+i?f.colIndex:o+i,u.colIndex=u.colIndex>o+i?u.colIndex:o+i);if((v.getPropertyValue(e-r,o+r,"value2")||this._getDataObj(e-r,o+r,"mergeIdx",a))&&(f.rowIndex=f.rowIndex<e-r?f.rowIndex:e-r,u.colIndex=u.colIndex>o+r?u.colIdx:o+r),u.colIndex===h.colIndex&&u.rowIndex===h.rowIndex&&f.rowIndex===l.rowIndex&&f.colIndex===l.colIndex)if(p!==0){c._isRangeSelected=!1;break}else{c._isRangeSelected=!0;break}l={rowIndex:f.rowIndex,colIndex:f.colIndex};h={rowIndex:u.rowIndex,colIndex:u.colIndex};p++;y.push(u.colIndex);w.push(f.rowIndex);k.push(u.rowIndex);b.push(f.colIndex)}for(b=t.dataUtil.mergeSort(t.distinct(b)),f.colIndex=b[b.length-1],s=b.length-1;s>-1;s--)if(b[s-1]===b[s]-1)f.colIndex=b[s-1];else break;for(k=t.dataUtil.mergeSort(t.distinct(k)),u.rowIndex=k[0],s=0,len=k.length-1;s<len;s++)if(k[s+1]===k[s]+1)u.rowIndex=k[s+1];else break;for(w=t.dataUtil.mergeSort(t.distinct(w)),f.rowIndex=w[w.length-1],s=w.length-1;s>-1;s--)if(w[s-1]===w[s]-1)f.rowIndex=w[s-1];else break;for(y=t.dataUtil.mergeSort(t.distinct(y)),u.colIndex=y[0],s=0,len=y.length-1;s<len;s++)if(y[s+1]===y[s]+1)u.colIndex=y[s+1];else break;for(s=0,len=y.length-1;s<len;s++)if(y[s+1]===y[s]+1)u.colIndex=y[s+1];else break}c._isEmptyActiveCell||(!c._isRangeSelected&&!d.length<1?(this.XLSelection.selectRange(f,u,a,n),c._isMultiSelect=!1,c._startCell=f,c._endCell=u,c._isRangeSelected=!0,c._isEmptyActiveCell=v.getPropertyValue(e,o,"value2")?!1:!0):(this.XLSelection.selectSheet(),c._isRangeSelected=!0))}},_getDataObj:function(n,t,i,r){var u=this._dataContainer.sheets[r?r:this.getActiveSheetIndex()];return u[n]&&u[n][t]?u[n][t][i]:!1},_getUsedRangeFromSheet:function(n,t){n=this._getSheetIndex(n);var u,e=this.getSheet(n),s=this._dataContainer,o=s.sheets[n],f=this.getObjectKeys(o),r={rowIndex:parseInt(f[0])||0,colIndex:0},i={rowIndex:parseInt(f[f.length-1])||0,colIndex:0};for(u=0,length=f.length;u<length;u++)colKeys=this.getObjectKeys(o[parseInt(f[u])]),u===0?(r.colIndex=parseInt(colKeys[0]),i.colIndex=parseInt(colKeys[colKeys.length-1])):(r.colIndex=r.colIndex<parseInt(colKeys[0])?r.colIndex:parseInt(colKeys[0]),i.colIndex=i.colIndex>parseInt(colKeys[colKeys.length-1])?i.colIndex:parseInt(colKeys[colKeys.length-1]));return i.rowIndex<e.usedRange.rowIndex&&(i.rowIndex=e.usedRange.rowIndex),i.colIndex<e.usedRange.colIndex&&(i.colIndex=e.usedRange.colIndex),t?this._getAlphaRange(n,r.rowIndex,r.colIndex,i.rowIndex,i.colIndex):{startCell:r,endCell:i,rowCount:i.rowIndex-r.rowIndex+1,colCount:i.colIndex-r.colIndex+1}},sheetRename:function(n){this.model.isReadOnly||this._updateSheetNames(n)},_isSubMenuOpen:function(){for(var i=["_formatastable","_cellstyles","_Ribbon_CElement","_contextMenuCell","_contextMenuColumnHeader","_contextMenuRowHeader","_contextMenuFooter"],t=0,r=i.length;t<r;){if(n("#"+this._id+i[t]).is(":visible"))return!0;t++}return!1},copySheet:function(n,i,r){if(!this.model.isReadOnly){var y=this._getSheetIndex(y),u,f,a,e,v=!1,c=2,h,s=this.model.sheets,o=this.element.find(".e-numericcontainer").children().eq(n-1),l=i;if(!r&&s[l].sheetInfo.text===o.text()){this.setSheetFocus();return}for(f=1,a=s.length;f<a;f++)s.length-1!==l&&s[l].sheetInfo.text===s[f].sheetInfo.text&&(u=f),o.text()===s[f].sheetInfo.text&&(h=f);if(r){for(o.text().match(".*[ ]+[(]+[0-9]+[)]$")===null?e=o.text()+" ("+c+")":o.text().lastIndexOf(" ")>-1&&(c=parseInt(o.text().substring(o.text().lastIndexOf("(")+1,o.text().lastIndexOf(")"))),e=o.text().substring(0,o.text().lastIndexOf(" "))+" ("+c+")");!v;){for(e=e.substring(0,e.lastIndexOf(" "))+" ("+c+")",f=1,a=s.length;f<a;f++)e===s[f].sheetInfo.text&&c++;c===parseInt(e.substring(e.lastIndexOf("(")+1,e.lastIndexOf(")")))&&(v=!0)}this._copySheetProcess(h,e);h=this.model.sheetCount;t.isNullOrUndefined(u)&&(u=h)}else!t.isNullOrUndefined(u)&&u>h&&(u=u-1);t.isNullOrUndefined(u)&&(u=l);r||u!==h?(this._swapSheetDtCntr(h,u),this.getPager().ejPager("option",{currentPage:l}),this.gotoPage(l,!1),this.setSheetFocus()):this.setSheetFocus()}},getHyperlink:function(n){return this.XLEdit.getPropertyValueByElem(n,"hyperlink",this.getActiveSheetIndex())},getComment:function(n){return this.XLEdit.getPropertyValueByElem(n,"comment",this.getActiveSheetIndex())},saveAsJSON:function(){var nt,u,tt,w;if(!this.model.isReadOnly){var y,c,e=1,i,f,s,b,o,l,a,r,k=[],it,v,d,p,g,t,h,rt=["_activeCell","_endCell","_startCell","colCount","rowHeight","columnWidth","columnsWidthCollection","rowsHeightCollection","rowCount","frozenColumns","frozenRows","styleIndex","usedRange","sheetName","dataAttribute","filterSettings","tableManager","sheetInfo","hideColsCollection","hideRowsCollection","mergedCells","showGridlines","showHeadings","isSheetProtected","shapeMngr","pivotMngr","chart","rangeSettings","cellTypes","startCell","primaryKey","showHeader","fieldAsColumnHeader","headerStyles","rows"],ut=["type","value","value2","decimalPlaces","format","formats","borders","formatStr","comment","hyperlink","rule","cFormatRule","wrap","merge","picture","chart","pivot","thousandSeparator","isLocked","align","isRHide"];this._isSaveAsJSON=!0;this._isExport=!0;this.model.exportSettings.allowExporting&&this.XLExport._renderAll();this._isExport=!1;y={dataContainer:n.extend(!0,{},this._dataContainer),model:n.extend(!0,{},this.model)};f=y.dataContainer;s=y.model;it=b=f.hashCode.length;v=f.sheetCellType;f.sheetCellType={};for(t in f.hashCode)r=f.hashCode[t],r.indexOf("e-border")>-1&&r.length<25&&k.push(r);for(t=0;t<k.length;t++)f.hashCode.splice(f.hashCode.indexOf(k[t]),1);t="sheets";for(o in f[t])for(l in f[t][o]){for(a in f[t][o][l]){for(r in f[t][o][l][a])["format","formats","borders"].indexOf(r)>-1&&(nt=this._dataContainer.hashCode[this._dataContainer[t][o][l][a][r]],f[t][o][l][a][r]=f.hashCode.indexOf(nt)),ut.indexOf(r)<0&&delete f[t][o][l][a][r];this.getObjectLength(f[t][o][l][a])||delete f[t][o][l][a]}this.getObjectLength(f[t][o][l])||delete f[t][o][l]}for(t in s)s[t]===this.defaults[t]||Object.prototype.toString.call(s[t])===Object.prototype.toString()?delete s[t]:Array.isArray(s[t])&&(s[t].length||delete s[t]);for(c=s.sheets;e<c.length;){i=c[e];for(t in i){switch(t){case"frozenColumns":case"frozenRows":i[t]===0&&delete i[t];break;case"fieldAsColumnHeader":case"isSheetProtected":i[t]||delete i[t];break;case"showHeadings":case"showGridlines":case"showHeader":i[t]&&delete i[t];break;case"filterSettings":for(r in i[t])r==="range"?this._isEmptyString(i[t][r])&&delete i[t][r]:delete i[t][r];break;case"sheetInfo":for(r in i[t])if(r!=="text"){if(r==="isVisible"&&!i[t][r])continue;delete i[t][r]}break;case"_startCell":case"_endCell":case"_activeCell":case"usedRange":for(r in i[t])i[t][r]===0&&delete i[t][r];break;case"columnWidth":i[t]===64&&delete i[t];break;case"rowHeight":i[t]===20&&delete i[t];break;case"primaryKey":i[t].length||delete i[t];break;case"startCell":i[t]==="A1"&&delete i[t]}rt.indexOf(t)<0||i[t]===null?delete i[t]:Object.prototype.toString.call(i[t])===Object.prototype.toString()?this.getObjectLength(i[t])||delete i[t]:Array.isArray(i[t])&&(i[t].length||delete i[t])}if(p=c[e].shapeMngr.picture,g={},this.getObjectLength(p)){h=0;for(t in p)g["picture"+h]=p[t],h++;c[e].shapeMngr.picture=n.extend(!0,{},g)}if(charts=c[e].shapeMngr.chart,chartMngr={},this.getObjectLength(charts)){h=0;for(t in charts)u=n.extend(!0,{},charts[t]),tt={commonSeriesOptions:{type:u.type,marker:u.marker},enable3D:u.enable3D,top:u.top,left:u.left,size:{width:u.width,height:u.height},title:u.title,legend:u.legend,primaryXAxis:u.xAxis,primaryYAxis:u.yAxis,dataSheetIdx:u.dataSheetIdx,animation:u.animation,isRowColSwitched:u.isRowColSwitched,colIndex:u.colIndex,rowIndex:u.rowIndex,theme:u.theme,range:this._getAlphaRange(e,u.range[0],u.range[1],u.range[2],u.range[3])},u.colIndex&&u.rowIndex?f.sheets[e][u.rowIndex][u.colIndex].chart=[]:f.sheets[e][u.activeCell.rowIndex][u.activeCell.colIndex].chart=[],chartMngr["chart"+h]=tt,h++;c[e].shapeMngr.chart=chartMngr}if(tables=c[e].tableManager,tbMngr={},this.getObjectLength(tables)){h=0;for(t in tables){w=n.extend(!0,{},tables[t]);delete w.format;for(r in s.nameManager)s.nameManager[r].name===w.name&&s.nameManager.splice(parseInt(r),1);tbMngr[h]=w;h++}c[e].tableManager=tbMngr}i.cellTypes=[];b=this.getObjectLength(v);b&&(f.sheetCellType[e]={});h=1;for(t in v)(r=v[t],this.getObjectLength(r))&&(d=r.id.split("_")[2],o=parseInt(d.match(/[0-9]+/)[0]),e===o&&(delete r.id,r.range=d.replace(/[0-9]+/,""),f.sheetCellType[e][h]={settings:r},v[t]={},h++));c[e]._scrollTop=this.getSheet(e)._scrollTop;c[e]._scrollLeft=this.getSheet(e)._scrollLeft;e++}return this._isSaveAsJSON=!1,y}},_isvalidRange:function(n){var t=new RegExp(/^\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7}):\$?(?:\b[a-z]{1,3})\$?(?:\d{1,7})$/i);return t.test(n)},_renderFUpload:function(){this.element.append(t.buildTag("div","",{height:"0px"},{id:this._id+"_file"}));n("#"+this._id+"_file").ejUploadbox({width:"0px",height:"0px",uploadName:"file",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.element},saveUrl:this.model.importSettings.importMapper,fileSelect:n.proxy(this._fileSelect,this),complete:n.proxy(this._changeImport,this),error:n.proxy(this._importFailed,this)});n("#"+this._id+"_file_SelectButton").hide()},_fileSelect:function(t){var r=t.files[0],i=r.extension;if(this._uploadImage&&i===".xlsx"||!this._uploadImage&&((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?i.indexOf("jpg")>-1||i.indexOf("png")>-1||i.indexOf("jpeg")>-1||i.indexOf("gif")>-1:r.rawFile.type.indexOf("image")>-1))return this._showAlertDlg("Alert","CorrectFormat","",290),this._uploadImage=!1,!1;if(this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10||this._uploadImage)this.showWaitingPopUp();else return n("#"+this._id+"_file").ejUploadbox("option","autoUpload",!1),this["import"]({file:r.rawFile,password:this._encrypt(this.model.importSettings.password),allowSheetOnDemand:this.model.importSettings.allowSheetOnDemand}),this._uploadImage=!1,!1;this._uploadImage=!1},_changeImport:function(t){var r,i=n("#"+this._id+"_file").data("ejUploadbox");((this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10)?t.files[0].extension.indexOf("jpg")>-1||t.files[0].extension.indexOf("png")>-1||t.files[0].extension.indexOf("jpeg")>-1||t.files[0].extension.indexOf("gif")>-1:t.files.rawFile.type.indexOf("image")>-1)?(i.updialog.ejDialog("close"),this.XLShape._insertPicture(t),this.model.showRibbon&&this.XLRibbon._formatTabUpdate(),i.option("autoUpload",!0)):(r=this._browserDetails.name==="msie"&&parseInt(this._browserDetails.version)<10?t.responseText:t.xhr.response,i.updialog.ejDialog("close"),this._importSuccess(r));this.hideWaitingPopUp()},_dlgBeforeOpen:function(){var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");this.hideWaitingPopUp();n("#"+this._id+"_workBookName").text("'"+n("#"+this._id+"_file").data("ejUploadbox")._files[0].name+"'"+this._getLocStr("Protect"))},_dlgOk:function(){var t,i=n("#"+this._id+"_PasswordDialog").data("ejDialog"),r=n("#"+this._id+"_xlpassword"),u=n("#"+this._id+"_confirmpassword");t=n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").data("ejToggleButton");i.model.title==="Protect Workbook"?r.val().length&&u.val().length?r.val()===u.val()?(this.model.exportSettings.password=r.val(),n("#"+this._id+"_AddSheet").addClass("e-disable"),n("#"+this._id+"_confirm").hide(),i.option("title",this._getLocStr("UnProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),this._showAlertDlg("Alert","PasswordAlert1"),t&&t.option("toggleState",!1),i.option("title",this._getLocStr("ProtectWorkbook"))):(n("#"+this._id+"_confirm").show(),t&&t.option("toggleState",!1),i.option("title",this._getLocStr("ProtectWorkbook")),this._showAlertDlg("Alert","PasswordAlert2")):i.model.title==="Unprotect Workbook"&&(this.model.exportSettings.password===r.val()?(n("#"+this._id+"_AddSheet").removeClass("e-disable"),this.model.exportSettings.password=null,n("#"+this._id+"_confirm").show(),i.option("title",this._getLocStr("ProtectWorkbook"))):(i.option("title",this._getLocStr("UnProtectWorkbook")),t&&t.option("toggleState",!0),this._showAlertDlg("Alert","PasswordAlert3")));r.val("");u.val("");n("#"+this._id+"_PasswordDialog").ejDialog("close")},_passwordDlg:function(){var n,f,i,r,u,e;n=t.buildTag("div","","",{id:this._id+"_PasswordDialog"});u=t.buildTag("div.e-dlg-btnfields");e=t.buildTag("div.e-dlg-btnctnr");f="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_xlpassword' type ='password' class = 'ejinputtext'/><\/td><\/tr><tr class= 'e-dlgtd-fields' id ='"+this._id+"_confirm'><td><label>"+this._getLocStr("ConfirmPassword")+"<\/label><\/td><td><input id ='"+this._id+"_confirmpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>";n.append(f);i=t.buildTag("input","","",{type:"submit"});r=t.buildTag("input");i.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgOk,this),enabled:!0});r.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60});u.append(e.append(i,r));n.append(u);n.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("ProtectWorkbook"),width:this._dlgWidth>420?420:this._dlgWidth,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",close:t.proxy(this._dlgCancel,this)})},_importPasswordDlg:function(){var i,e,r,u,f,o;return i=t.buildTag("div","","",{id:this._id+"_ImportPasswordDialog"}),f=t.buildTag("div.e-dlg-btnfields"),o=t.buildTag("div.e-dlg-btnctnr"),e="<div class= 'e-dlgctndiv'><table><tr class= 'e-dlgtd-fields'><td><label id ='"+this._id+"_workBookName' ><\/label><\/td><\/tr><tr class= 'e-dlgtd-fields'><td><label>"+this._getLocStr("Password")+":<\/label><\/td><td><input id ='"+this._id+"_importpassword' type ='password'  class = 'ejinputtext'/><\/td><\/tr><\/table><\/div>",i.append(e),r=t.buildTag("input","","",{type:"submit"}),u=t.buildTag("input"),r.ejButton({text:this._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._importDlgOk,this),enabled:!0}),u.ejButton({text:this._getLocStr("Cancel"),click:t.proxy(this._dlgCancel,this),showRoundedCorner:!0,width:60}),f.append(o.append(r,u)),i.append(f),i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:this._getLocStr("Password"),beforeOpen:n.proxy(this._dlgBeforeOpen,this),width:420,height:"auto",cssClass:"e-ss-dialog e-"+this._id+"-dlg",close:t.proxy(this._dlgCancel,this)}),i},_dlgCancel:function(){this._showDialog(this._id+"_Ribbon_Review_Changes_ProtectWorkbook");var t=n("#"+this._id+"_PasswordDialog").data("ejDialog");t.model.title==="Protect Workbook"?n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").ejToggleButton("option","toggleState",!1):t.model.title==="Unprotect Workbook"&&n("#"+this._id+"_Ribbon_Review_Changes_ProtectWorkbook").ejToggleButton("option","toggleState",!0);n("#"+this._id+"_confirmpassword").val("");n("#"+this._id+"_xlpassword").val("");n("#"+this._id+"_importpassword").val("");n("#"+this._id+"_PasswordDialog").ejDialog("close");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close")},_importDlgOk:function(){var t={},i=n("#"+this._id+"_importpassword");this.model.importSettings.password=i.val();i.val("");n("#"+this._id+"_ImportPasswordDialog").ejDialog("close");t.file=n("#"+this._id+"_file").data("ejUploadbox")._files[0].rawFile;t.password=this._encrypt(this.model.importSettings.password);t.allowSheetOnDemand=this.model.importSettings.allowSheetOnDemand;this["import"](t)},lockCells:function(n,t){if(!this.model.isReadOnly){var i,r,u=this.getActiveSheetIndex(),f=this.getSheet(u);if(r=t!=!1,this.model.allowLockCell&&!f.isSheetProtected){if(n=this._getRangeArgs(n,"object",u),i={reqType:"lockCells",range:n,isLock:r},this._trigActionBegin(i))return;if(n=i.range,r=i.isLock,r?this.updateUniqueData({isLocked:!0},n):this.clearRangeData(n,["isLocked"]),this.model.showRibbon&&this.XLRibbon._updateRibbonIcons(),i={reqType:"lockCells",range:n,isLocked:r},this._trigActionComplete(i))return}}},protectSheet:function(t){if(!this.model.isReadOnly){var i,r,f,u=this.getActiveSheetIndex(),o=this.getSheet(u),e=this.XLRibbon;if(r=t!==!1,this.model.allowLockCell){if(i={reqType:"protectSheet",isProtect:t,sheetIdx:u},this._trigActionBegin(i))return;if(r=i.isProtect,o.isSheetProtected=r,this.model.showRibbon&&(f=n("#"+this._id+"_Ribbon_Review_Changes_LockCell").data("ejToggleButton"),f&&f.option("enabled",!r),r?e._disableRibbonIcons():e._enableRibbonIcons(),e._updateRibbonIcons()),o._showLockCellAlert=!0,this.model.allowFormulaBar&&this.updateFormulaBar(),this.model.allowUndoRedo&&(this.model.sheetCount>1?this._removeUndoRedoForCurSheet(u,"undo"):(this._undoCollection=[],this._redoCollection=[])),i={reqType:"protectSheet",isSheetProtected:t,sheetIdx:u},!this._isSheetNavigate&&this._trigActionComplete(i))return}}},_readOnly:function(){var r=this.XLRibbon,u=n("#"+this._id+"_FRDialog_FPDlgTab").data("ejTab"),t=this.element.find("#"+this._id+"_Ribbon_BackStage"),i=this.element.find("#"+this._id+"_inputbox");this.model.isReadOnly?(r._disableRibbonIcons(),r.enableRibbonItems(["Spreadsheet_Ribbon_Home_Clipboard_Copy","Spreadsheet_Ribbon_Review_Comments_ShowAllComments","Spreadsheet_Ribbon_Others_Editing_FindSelect"]),this.XLCMenu&&this.XLCMenu._disableMenuOpt(["Replace","GoTo","GoToSpecial","Formulas","Comments","CFormat","Constants","DataValidation"],"Ribbon_FindRep"),t.length&&(t.find("#saveas_backStageTab").hide(),t.find("#print_backStageTab").hide()),this.addClass(this.element.find("#"+this._id+"_AddSheet")[0],"e-disable"),i.length&&(i[0].disabled=!0)):(r._enableRibbonIcons(),this.XLCMenu&&this.XLCMenu._enableMenuOpt(["Replace","GoTo","GoToSpecial","Formulas","Comments","CFormat","Constants","DataValidation"],"Ribbon_FindRep"),t.length&&(t.find("#saveas_backStageTab").show(),t.find("#print_backStageTab").show()),this._removeClass(this.element.find("#"+this._id+"_AddSheet")[0],"e-disable"),i.length&&(i[0].disabled=!1))},_isPropExists:function(n,t,i,r){for(var u,f,h,e,c,s=0,o=!1;s<n.length;){for(u=this.swapRange(n[s]),f=u[0],h=u[2];f<=h;){for(e=u[1],c=u[3];e<=c;){if(this.XLEdit.getPropertyValue(f,e,t,i)){r||(t==="isLocked"?this._popUplockCellAlert():t==="isReadOnly"&&this._showAlertDlg("Alert","ReadOnly","",400));o=!0;break}e++}if(o)break;f++}if(o)break;s++}return o},_isCellProtected:function(n,t,i){return this.model.allowLockCell&&this.getSheet(this.getActiveSheetIndex()).isSheetProtected&&this.XLEdit.getPropertyValue(n,t,"isLocked")?(i&&this._popUplockCellAlert(),!0):this.XLEdit.getPropertyValue(n,t,"isReadOnly")?(this._showAlertDlg("Alert","ReadOnly","",400),!0):void 0},_popUplockCellAlert:function(){this.getSheet(this.getActiveSheetIndex())._showLockCellAlert&&this._showAlertDlg("Alert","LockAlert","",500)},_removeUndoRedoForCurSheet:function(n,t){var r=t==="undo"?this._undoCollection:this._redoCollection,i=r.length;if(i)while(i--)n===r[i].sheetIndex&&r.splice(i,1);t==="undo"&&this._removeUndoRedoForCurSheet(n,"redo")},_detailsFromGlobalSpan:function(i,r,u,f,e,o){var s,h,f=f||"w",c="e-rowcell e-wrapword ",l,a,y,p=this._browserDetails.name==="mozilla"?2:0,v;return v=!this.isUndefined(e),s=v?n("#"+this._id+"_emptyDiv"):n("#"+this._id+"_emptySpan"),e&&(s[0].style.width=e-4+"px"),l=this.XLEdit.getPropertyValue(i,r,"format"),a=this.XLEdit.getPropertyValue(i,r,"border"),y=this.XLEdit.getPropertyValue(i,r,"wrap"),t.isNullOrUndefined(l)||(c+=l+" "),t.isNullOrUndefined(a)?s[0].className.indexOf("e-rowcell")>-1&&(s[0].style.borderRight=0):c+=a+" ",t.isNullOrUndefined(y)||(c+="e-sswraptext"),this.addClass(s[0],c),s[0].className.indexOf("e-rowcell")>-1&&(s[0].style.padding=0),s.text(f),u==="height"?(h=Math.ceil(s.outerHeight()+p),!o&&this.model.rowHeight>h&&(h=this.model.rowHeight)):(h=Math.ceil(s.outerWidth()+p),!o&&this.model.columnWidth>h&&(h=this.model.columnWidth)),this._refreshGlobalSpan(null,v),Math.ceil(h)},_encrypt:function(n){if(!t.isNullOrUndefined(n)){for(var r="",i=0;i<n.length;++i)r+=String.fromCharCode(129^n.charCodeAt(i));return r}},_writeRule:function(n,t){var i,r,t=this.getSheetElement(t).index()+1;r="#"+this._id+" .e-sheet:nth-child("+t+") .e-content td.e-rowcell:nth-of-type("+(n+1)+")";i=document.getElementById(this._id+"_sshide");i.sheet.insertRule(r+"{display: none}",i.sheet.cssRules.length)},_deleteRule:function(n,t,i){var i=this.getSheetElement(i).index()+1,u,f,r,h;u=document.getElementById(this._id+"_sshide");var e=u.sheet.cssRules,o=" .e-sheet:nth-child("+i+") ",s=".e-rowcell:nth-of-type("+(n+1)+")";for(this._browserDetails.name==="msie"&&(o=" :nth-child("+i+").e-sheet ",s=":nth-of-type("+(n+1)+").e-rowcell"),f="#"+this._id+o+".e-content td"+s,r=0,h=e.length;r<h;r++)if(e[r].selectorText===f){u.sheet.deleteRule(r);break}},_refreshRowHeight:function(n,t){var i=this.XLEdit.getPropertyValue(t,0,"pHeight"),r=this.getSheet(n);this.isUndefined(i)||(this.XLEdit._updateDataContainer({rowIndex:t,colIndex:0},{dataObj:{cHeight:i,pHeight:r.rowsHeightCollection[t]}}),r.rowsHeightCollection[t]=i,this._isRowViewable(n,t)&&(this.getRows(n)[1][this._getRowIdx(t)].style.height=i+"px"))},_batchAddRow:function(n,t,i,r){var c,f,o,u,s,h=0,e=n,a=this.getSheet(i),l=this.getDataSettings(i);if(l)while(e<=t){while(h<l.length)f=l[h],u=f.range,s=f.batchChanges.deleted,e>u[0]&&e<=u[2]+1?(o=u[0]?this._getPosDiff(e,u[0]):e,!f.fieldAsColumnHeader&&f.showHeader&&(o=o-1),c=this._getRowData(e,u[1],u[3],f),f._jsonData.splice(o,0,c),f._isDataManager&&(r?s.length?s.pop():s.push(c):f.batchChanges.added.push(f._jsonData[o])),u[2]++):e<=u[0]&&(u[2]++,u[0]++),h++;h=0;e++}},_batchDeleteRow:function(n,t,i,r){var s,f,h,u,o,l,c=0,e=t,v=this.getSheet(i),a=this.getDataSettings(i);if(a)while(e>=n){while(c<a.length)f=a[c],u=f.range,o=f.batchChanges.added,e>=u[0]&&e<=u[2]?(h=u[0]?this._getPosDiff(e,u[0]):e,!f.fieldAsColumnHeader&&f.showHeader&&(h=h-1),s=f._jsonData.splice(h,1)[0],f._isDataManager&&(r?o.length?(l=o.indexOf(s),l>-1&&o.splice(l,1)):o.push(s):f.batchChanges.deleted.push(s)),u[2]--):e<u[0]&&(u[2]--,u[0]--),c++;c=0;e--}},_updateBatchDetails:function(t,i,r){var o,l,u,s,f,e,h,a=!0,c=0,v=this.getSheet(r);if(settings=this.getDataSettings(r),settings)while(c<settings.length){if(setting=settings[c],u=setting.range,u&&this.inRange(u,t,i)){h=setting.batchChanges.changed;o=u[0]?this._getPosDiff(t,u[0]):t;l=u[1]?this._getPosDiff(i,u[1]):i;!setting.fieldAsColumnHeader&&setting.showHeader&&(t===u[0]?a=!1:o=o-1);a&&(e=setting._jsonData[o],s=setting.fields[l],f=this.getRangeData({range:[t,i,t,i],valueOnly:!0,sheetIdx:r,skipFormula:!0})[0],(this.isUndefined(f)||this._isEmptyString(f))&&(f=null),e[s]!==f&&(e[s]=f,!setting.primaryKey||s!==setting.primaryKey||this.XLEdit.getPropertyValue(t,i,"isReadOnly",r)||this.isUndefined(f)||this.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{isReadOnly:!0}}),setting._isDataManager&&n.inArray(e,h)===-1&&n.inArray(e,setting.batchChanges.added)===-1&&h.push(e)));break}c++}},_getRowData:function(n,i,r,u){for(var f,s={},e=i,o=0,c=this.getSheet(this.getActiveSheetIndex()),h=u.fields;e<=r;)f=this.getRangeData({range:[n,e,n,e],valueOnly:!0,skipDateTime:!0})[0],this._isEmptyString(f)&&(f=null),u.primaryKey&&h[o]===u.primaryKey&&t.isNullOrUndefined(f)&&(f=0),s[h[o]]=f,e++,o++;return s},saveBatchChanges:function(n){var e,r,i,o,u=0,s=this,t=this.getSheet(n),f=this.getDataSettings(n);if(f)while(u<f.length)setting=f[u],setting._isDataManager&&(i=setting.batchChanges,e={sheetIdx:n,dataSetting:setting,batchChanges:i},o=this._trigger("beforeBatchSave",e),!o&&(i.changed.length||i.added.length||i.deleted.length)&&(r=setting._dataManager.saveChanges(i,setting.primaryKey,setting.query._fromTable),setting._isOffline||(this.showWaitingPopUp(),r.done(function(){t._resCnt++;t._reqCnt===t._resCnt&&s.hideWaitingPopUp()}),r.fail(function(){t._resCnt++;t._reqCnt===t._resCnt&&s.hideWaitingPopUp()})),t._reqCnt++,setting.batchChanges={added:[],changed:[],deleted:[]})),u++},setReadOnly:function(n){this.updateUniqueData({isReadOnly:!0},n)},removeReadOnly:function(n){this.clearRangeData(n,["isReadOnly"])},_updateCustomFormulas:function(n,t){var r=this._calcEngine,u;for(var i in n)t==="add"&&this.isUndefined(this.getCalcEngine().getLibraryFunctions().getItem(n[i].formulaName))&&!this.XLEdit._isNamedRange("="+n[i].formulaName)?(u=r.addCustomFunction(n[i].formulaName,n[i].functionName),this._formulaCollection.push({text:"="+n[i].formulaName,display:n[i].formulaName})):t==="delete"&&r.getCustomLibraryFunctions().contains(n[i].formulaName)?u=r.removeFunction(n[i].formulaName,n[i].functionName):this._showAlertDlg("Alert","CorrectFormula","FormulaAlert",372);return u},addCustomFormula:function(n,t){if(!this.model.isReadOnly){var i=this._updateCustomFormulas([{formulaName:n,functionName:t}],"add");i&&(this.model.customFormulas.push({formulaName:n,functionName:t}),this.XLEdit._refreshAutoComplete())}},removeCustomFormula:function(n,t){if(!this.model.isReadOnly){var r=this._updateCustomFormulas([{formulaName:n.toUpperCase(),functionName:t}],"delete"),i;if(r){i=this.model.customFormulas;for(key in i)i[key].formulaName===n&&i.splice(1,parseInt(key));this._updateFormulaCollection();this.XLEdit._refreshCalcEngine(null,null,!1,null,null);this.XLEdit._refreshAutoComplete()}}},getValueFromFormulaArg:function(n){var f=1,s,c=this._getSheetIndex(),e=this._calcEngine,r,t,o={},u=[],i,h;for(r=n.split(e.getParseArgumentSeparator()),i=0,h=r.length;i<h;i++)u=u.concat(r[i].indexOf(":")>-1?e.getCellsFromArgs(r[i]):[r[i]]);for(s in u)t=e.getValueFromArg(u[s]),o["arg"+f]=this.XLEdit._parseValue(t).value,u.indexOf(t)>-1&&t[0]==='"'&&t[t.length-1]==='"'&&(o["arg"+f]=t.substring(1,t.length-1)),f++;return o},getCalcEngine:function(){return this._calcEngine}});t.Spreadsheet.Locale=t.Spreadsheet.Locale||{};t.Spreadsheet.Locale["default"]=t.Spreadsheet.Locale["en-US"]={Cut:"Cut",Copy:"Copy",FormatPainter:"Format Painter",Paste:"Paste",PasteValues:"Paste Values Only",PasteSpecial:"Paste",Filter:"Filter",FilterContent:"Turn on filtering for the selected cells.",FilterSelected:"Filter by Selected Cell's value",Sort:"Sort",Clear:"Clear",ClearContent:"Delete everything in the cell, or remove just the formatting, contents, comments or hyperlinks.",ClearFilter:"Clear Filter",ClearFilterContent:"Clear the filter and sort state for the current range of data.",SortAtoZ:"Sort A to Z",SortAtoZContent:"Lowest to Highest.",SortZtoA:"Sort Z to A",SortZtoAContent:"Highest to Lowest.",SortSmallesttoLargest:"Sort Smallest to Largest",SortLargesttoSmallest:"Sort Largest to Smallest",SortOldesttoNewest:"Sort Oldest to Newest",SortNewesttoOldest:"Sort Newest to Oldest",Insert:"Insert",InsertTitle:"Insert Cells",InsertContent:"Add new cells, rows, or columns to your workbook.<br /><br />FYI: To insert multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Insert.",InsertSBContent:"Add cells, rows, columns, or sheets to your workbook.",Delete:"Delete",DeleteTitle:"Delete Cells",DeleteContent:"Delete cells, rows, columns, or sheets from your workbook.<br /><br />FYI: To delete multiple rows or columns at a time, select multiple rows or columns in the sheet, and click Delete.",FindSelectTitle:"Find & Select",FindSelectContent:"Click to see options for finding text in your document.",CalculationOptions:"Calculation Options",CalcOptTitle:"Calculation Options",CalcOptContent:"Choose to calculate formulas automatically or manually.<br/><br/>If you make a change that affects a value, Spreadsheet will automatically recalculate it.",CalculateSheet:"Calculate Sheet",CalculateNow:"Calculate Now",CalculateNowContent:"Calculate the entire workbook now.<br/><br/>You only need to use this if automatic calculation is turned off.",CalculateSheetContent:"Calculate the active sheet now.<br/><br/>You only need to use this if automatic calculation is turned off.",Title:"Spreadsheet",ColorPicker:"Color Picker",Ok:"OK",Cancel:"Cancel",Alert:"We couldn't do this for the selected range of cells. Select a single cell within a range of data and then try again.",HeaderAlert:"The command could not be completed as you are attempting to filter with the filter header. Select a single cell in the filter range and try the command again.",FlashFillAlert:"All the data next to your selection was checked and there was no pattern for filling in values.",Formatcells:"Format Cells",FontFamily:"Font",FFContent:"Pick a new font for your text.",FontSize:"Font Size",FSContent:"Change the size of your text.",IncreaseFontSize:"Increase Font Size",IFSContent:"Make your text a bit bigger.",DecreaseFontSize:"Decrease Font Size",DFSContent:"Make your text a bit smaller.",Bold:"Bold",Italic:"Italic",Underline:"Underline",Linethrough:"Linethrough",FillColor:"Fill Color",FontColor:"Font Color",TopAlign:"Top Align",TopAlignContent:"Align text to the top.",MiddleAlign:"Middle Align",MiddleAlignContent:"Align text so that it is centered between the top and bottom of the cell.",BottomAlign:"Bottom Align",BottomAlignContent:"Align text to the bottom.",WrapText:"Wrap Text",WrapTextContent:"Wrap extra-long text into multiple lines so you can see all of it.",AlignLeft:"Align Left",AlignLeftContent:"Align your content to the left.",AlignCenter:"Center",AlignCenterContent:"Center your content.",AlignRight:"Align Right",AlignRightContent:"Align your content to the right.",IncreaseIndent:"Increase Indent",IncreaseIndentContent:"Move your content farther away from the cell border.",DecreaseIndent:"Decrease Indent",DecreaseIndentContent:"Move your content closer to the cell border.",Undo:"Undo",Redo:"Redo",NumberFormat:"Number Format",NumberFormatContent:"Choose the format for your cells, such as percentage, currency, date or time.",AccountingStyle:"Accounting Style",AccountingStyleContent:"Format as dollar accounting number format.",PercentageStyle:"Percent Style",PercentageStyleContent:"Format as a percent.",CommaStyle:"Comma Style",CommaStyleContent:"Format with a thousands separator.",IncreaseDecimal:"Increase Decimal",IncreaseDecimalContent:"Show more decimal places for a more precise value.",DecreaseDecimal:"Decrease Decimal",DecreaseDecimalContent:"Show fewer decimal places.",AutoSum:"AutoSum",AutoSumTitle:"Sum",AutoSumContent:"Automatically add a quick calculation to your worksheet, such as sum or average.",Fill:"Fill",ExportXL:"Excel",ExportCsv:"CSV",ExportPdf:"PDF",SaveXml:"Save XML",BackgroundColor:"Fill Color",BGContent:"Color the background of the cells to make them stand out.",ColorContent:"Change the color of your text.",Border:"Border",BorderContent:"Apply borders to the currently selected cells.",BottomBorder:"Bottom Border",TopBorder:"Top Border",LeftBorder:"Left Border",RightBorder:"Right Border",OutsideBorder:"Outside Borders",NoBorder:"No Border",AllBorder:"All Borders",ThickBoxBorder:"Thick Box Border",ThickBottomBorder:"Thick Bottom Border",TopandThickBottomBorder:"Top and Thick Bottom Border",DrawBorderGrid:"Draw Border Grid",DrawBorder:"Draw Border",TopandBottomBorder:"Top and Bottom Border",BorderColor:"Line Color",BorderStyle:"Line Style",Number:"Number is used for general display of numbers.  Currency and Accounting offer specialized formatting for monetary value.",General:"General format cells have no specific number format.",Currency:"Currency formats are used for general monetary values.  Use Accounting formats to align decimal points in a column.",Accounting:"Accounting formats line up the currency symbols and decimal points in a column.",Text:"Text format cells are treated as text even when a number is in the cell.  The cell is displayed exactly as entered.",Percentage:"Percentage formats multiply the cell value by 100 and displays the result with a percent symbol.",CustomMessage:"Type number format code, using one of existing codes as a starting point.",Fraction:"",Scientific:"",Type:"Type:",CustomFormatAlert:"Enter a valid format",Date:"Date formats display date and time serial numbers as date values.",Time:"Time formats display date and time serial numbers as date values.",File:"FILE",New:"New",Open:"Open",SaveAs:"Save As",Print:"Print",PrintContent:"Print the current sheet.",PrintSheet:"Print Sheet",PrintSelected:"Print Selected",PrintSelectedContent:"Select an area on the sheet you would like to print.",HighlightVal:"Format Invalid Data",ClearVal:"Clear Validation",Validation:"Validation",DataValidation:"Data Validation",DVContent:"Pick from a list of rules to limit the type of data that can be entered in a cell.",A4:"A4",A3:"A3",Letter:"Letter",PageSize:"Page Size",PageSizeContent:"Choose a page size for your document.",FormatCells:"FormatCells",ConditionalFormat:"Conditional Formatting",CFContent:"Easily spot trends and patterns in your data using colors to visually highlight important values.",And:"and",With:"with",GTTitle:"Greater Than",GTContent:"Format cells that are GREATER THAN:",LTTitle:"Less Than",LTContent:"Format cells that are LESS THAN:",BWTitle:"Between",BWContent:"Format cells that are BETWEEN:",EQTitle:"Equal To",EQContent:"Format cells that are EQUAL TO:",DateTitle:"A Date Occurring",DateContent:"Format cells that contain a DATE:",ContainsTitle:"Text That Contains",ContainsContent:"Format cells that contain the text:",GreaterThan:"Greater Than",LessThan:"Less Than",Between:"Between",EqualTo:"Equal To",TextthatContains:"Text that Contains",DateOccurring:"A Date Occurring",ClearRules:"Clear Rules",ClearRulesfromSelected:"Clear Rules from Selected Cells",ClearRulesfromEntireSheets:"Clear Rules from Entire Sheet",CellStyles:"Cell Styles",CellStylesContent:"A colorful style is a great way to make important data stand out on the sheet.",CellStyleHeaderText:"Good, Bad and Neutral/Titles and Headings/Themed Cell Styles",Custom:"Type the number format code, using one of the existing codes as starting point.",CellStyleGBN:"Normal/Bad/Good/Neutral",CellStyleTH:"Heading 4/Title",CellsStyleTCS:"20% - Accent1/20% - Accent2/20% - Accent3/20% - Accent4/60% - Accent1/60% - Accent2/60% - Accent3/60% - Accent4/Accent1/Accent2/Accent3/Accent4",Style:"Style",FormatAsTable:"Format As Table",FormatasTable:"Format as Table",FATContent:"Quickly convert a range of cells to a table with its own style.",FATHeaderText:"Light/Medium/Dark",FATNameDlgText:"Table Name:/My table has headers",InvalidReference:"The range you have specified is invalid",ResizeAlert:"The specified range is invalid. The top of the table must remain in the same row, and the resulting table must overlap the original table. Specify a valid range.",RangeNotCreated:"Increasing the row beyond the maximum sheet rowcount is restricted in Format as Table.",ResizeRestrictAlert:"Increase or decrease of column count and decrease of row count is restricted in Format as Table.",FATResizeTableText:"Enter new data range for your table:",FATReizeTableNote:"Note: The headers must remain in the same row and the resulting table range must overlap the original table range.",FormatAsTableAlert:"Cannot create a table with a single row. A table must have at least two rows, one for the table header, and one for data",FormatAsTableTitle:"Light 1/Light 2/Light 3/Light 5/Light 8/Light 9/Light 10/Light 12/Light 15/Light 16/Light 17/Light 19/Medium 8/Medium 9/Medium 10/Medium 12/Medium 22/Medium 23/Medium 24/Medium 26/Dark 1/Dark 2/Dark 3/Dark 5",NewTableStyle:"New Table Style",ResizeTable:"Resize Table",ResizeTableContent:"Resize this table by adding or removing rows and columns.",ConvertToRange:"Convert to Range",ConvertToRangeContent:"Convert this table into a normal range of cells.",ConverToRangeAlert:"Do you want to convert the table to a normal range?",TableID:"Table ID:",Table:"Table",TableContent:"Create a table to organize and analyze related data.",TableStyleOptions:"First Column/Last Column/Total Row/Filter Button",Format:"Format",NameManager:"Name Manager",NameManagerContent:"Create, edit, delete and find all the names used in the workbook.<br /><br />Names can be used in formulas as substitutes for cell references.",DefinedNames:"Defined Names",DefineName:"Define Name",DefineNameContent:"Define and apply names.",UseInFormula:"Use In Formula",UseInFormulaContent:"Choose a name used in this workbook and insert it into the current formula.",RefersTo:"Refers To",Name:"Name",Scope:"Scope",NMNameAlert:"The name that you entered is not valid./Reason for this can include:/The name does not begin with a letter or an underscore/The name contains a space or other invalid characters/The name conflicts with a spreadsheet built-in name or the name of another object in the workbook",NMUniqueNameAlert:"The name entered already exists. Enter a unique name.",NMRangeAlert:"Enter a valid range",FORMULAS:"FORMULAS",Value:"Values",DataValue:"Values:",Formula:"Formulas",MissingParenthesisAlert:"Your formula is missing a parenthesis--) or (. Check the formula, and then add the parenthesis in the appropriate place.",UnsupportedFile:"Unsupported File",IncorrectPassword:"Unable to open the file or worksheet with the given password",InvalidUrl:"Please specify proper URL",Up:"Up",Down:"Down",Sheet:"Sheet",Workbook:"Workbook",Rows:"By Rows",Columns:"By Columns",FindReplace:"Find Replace",FindnReplace:"Find and Replace",Find:"Find",Replace:"Replace",FindLabel:"Find what:",ReplaceLabel:"Replace with:",ReplaceAll:"Replace All",Close:"Close",FindNext:"Find Next",FindPrev:"Find Prev",Automatic:"Automatic",Manual:"Manual",Settings:"Settings",MatchCase:"Match case",MatchAll:"Match entire cell contents",Within:"Within:",Search:"Search:",Lookin:"Look in:",ShiftRight:"Shift cells right",ShiftBottom:"Shift cells down",EntireRow:"Entire row",EntireColumn:"Entire column",ShiftUp:"Shift cells up",ShiftLeft:"Shift cells left",Direction:"Direction:",GoTo:"Go To",GoToName:"Go to:",Reference:"Reference:",Special:"Special",Select:"Select",Comments:"Comments",Formulas:"Formulas",Constants:"Constants",RowDiff:"Row differences",ColDiff:"Column differences",LastCell:"Last cell",CFormat:"Conditional formats",Blanks:"Blanks",GotoError:"Error",GotoLogicals:"Logicals",GotoNumbers:"Numbers",GotoText:"Text",FindSelect:"Find & Select",Comment:"Comment",NewComment:"New",InsertComment:"Insert Comment",EditComment:"Edit",DeleteComment:"Delete Comment",DeleteCommentContent:"Delete the selected comment.",HideComment:"Hide Comment",Next:"Next",NextContent:"Jump to the next comment.",Previous:"Previous",PreviousContent:"Jump to the previous comment.",ShowHide:"Show/Hide Comment",ShowHideContent:"Show or hide the comment on the active cell.",ShowAll:"Show All Comments",ShowAllContent:"Display all comments in the sheet.",UserName:"User Name",Hide:"Hide",Unhide:"Unhide",Add:"Add",DropAlert:"Do you want to replace the existing data?",PutCellColor:"Put Selected Cell Color To The Top",PutFontColor:"Put Selected Font Color To The Top",WebPage:"Web Page",WorkSheet:"Worksheet Reference",SheetReference:"Sheet Reference",InsertHyperLink:"Insert Hyperlink",HyperLink:"Hyperlink",EditLink:"Editlink",OpenLink:"Openlink",HyperlinkText:"Text:",RemoveLink:"Removelink",WebAddress:"Web Address:",CellAddress:"Cell Reference:",SheetIndex:"Select a place in this document",ClearAll:"Clear All",ClearFormats:"Clear Formats",ClearContents:"Clear Contents",ClearComments:"Clear Comments",ClearHyperLinks:"Clear Hyperlinks",SortFilter:"Sort & Filter",SortFilterContent:"Organize your data so it's easier to analyze.",NumberStart:"Minimum:",NumberEnd:"Maximum:",DecimalStart:"Minimum:",DecimalEnd:"Maximum:",DateStart:"Start Date:",DateEnd:"End Date:",ListStart:"Source:",FreeText:"Show error after invalid data is entered",ListEnd:"Cell Reference:",TimeStart:"Start Time:",TimeEnd:"End Time:",TextLengthStart:"Minimum:",TextLengthEnd:"Maximum:",CommentFindEndAlert:"Spreadsheet reached the end of the workbook. Do you want to continue reviewing from the beginning of the workbook?",InsertSheet:"Insert",DeleteSheet:"Delete",RenameSheet:"Rename",MoveorCopy:"Move or Copy",HideSheet:"Hide",UnhideSheet:"Unhide",SheetRenameAlert:"That name is already taken. Try a different one.",SheetRenameEmptyAlert:"You typed an invalid name for a sheet. Make sure that:<ul><li>The name that you type does not exceed 31 characters.<\/li><li>The name does not contain any of the following characters:  / ? * [ or  ]<\/li><li>You did not leave the name blank.<\/li><\/ul>",SheetDeleteAlert:"You can't undo deleting sheets, and you might be removing some data. If you don't need it, click OK to delete.",SheetDeleteErrorAlert:"A workbook must contain at least one visible worksheet. To hide, delete, or move the selected sheet, you must first insert a new sheet or unhide a sheet that is already hidden.",CtrlKeyErrorAlert:"That command cannot be used on  multiple selections.",ClipboardAccessError:"Your browser can't access the clipboard, so use these shortcuts:<br /><br />Cut = Ctrl + X<br />Copy = Ctrl + C<br />Paste = Ctrl + V",MoveToEnd:"Move To End",Beforesheet:"Before sheet:",CreateaCopy:"Create a copy",AutoFillOptions:"Copy Cells/Fill Series/Fill Formatting Only/Fill Without Formatting/Flash Fill",NumberValidationMsg:"Enter only digits",DateValidationMsg:"Enter only date",Required:"Required",TimeValidationMsg:"The time you entered for the Time is invalid.",CellAddrsValidationMsg:"Reference is not valid.",PivotTable:"Pivot Table",PivotTableContent:"Easily arrange and summarize complex data in a PivotTable.",NumberTab:"Number",AlignmentTab:"Alignment",FontTab:"Font",FillTab:"Fill",TextAlignment:"Text alignment",Horizontal:"Horizontal:",Vertical:"Vertical:",Indent:"Indent",TextControl:"Text Control",FontGroup:"Font:",FontStyle:"Font style:",Size:"Size:",PSize:"Page size",Effects:"Effects:",StrikeThrough:"Strikethrough",Overline:"Overline",NormalFont:"Normal font",Preview:"Preview",PreviewText:"AaBbCcYyZz",Line:"Line",Presets:"Presets",None:"None",Outline:"Outline",AllSide:"All sides",InsCells:"Insert Cells",InsRows:"Insert Sheet Rows",InsCols:"Insert Sheet Columns",InsSheet:"Insert Sheet",DelCells:"Delete Cells",DelRows:"Delete Sheet Rows",DelCols:"Delete Sheet Columns",DelSheet:"Delete Sheet",HyperLinkAlert:"The address of this site is not valid.Check the address and try again.",ReplaceData:"All done. We made / replacements.",NotFound:"We couldn't find what you were looking for. Select settings tab for more ways to search",Data:"Data:",Allow:"Allow:",IgnoreBlank:"Ignore blank",NotFind:"Unable to find the match to replace",FreezeTopRow:"Freeze Top Row",FreezeFirstColumn:"Freeze First Column",UnFreezePanes:"Unfreeze Panes",DestroyAlert:"Are you sure you want to destroy the current workbook without saving and create a new workbook?",ImageValAlert:"Upload image files only",Pictures:"Pictures",PicturesTitle:"From File",PicturesContent:"Insert pictures from computer or from other computers that you are connected to.",ImportAlert:"Are you sure you want to destroy the current workbook without saving and open a new workbook?",UnmergeCells:"Unmerge Cells",MergeCells:"Merge Cells",MergeAcross:"Merge Across",MergeAndCenter:"Merge & Center",MergeAndCenterContent:"Combine and center the contents of the selected cells in a new larger cell.",MergeCellsAlert:"Merging Cells keeps only upper left cell value and discards the other values.",MergeInsertAlert:"This operation will causes some merged cells to unmerge. Do you wish to continue ?",Axes:"Axes",PHAxis:"Primary Horizontal",PVAxis:"Primary Vertical",AxisTitle:"Axis Title",CTNone:"None",CTCenter:"Center",CTFar:"Far",CTNear:"Near",DataLabels:"Data Labels",DLNone:"None",DLCenter:"Center",DLIEnd:"Inside End",DLIBase:"Inside Base",DLOEnd:"Outside End",ErrorBar:"Error Bars",Gridline:"Gridlines",PMajorH:"Primary Major Horizontal",PMajorV:"Primary Major Vertical",PMinorH:"Primary Minor Horizontal",PMinorV:"Primary Minor Vertical",Legend:"Legends",LNone:"None",LLeft:"Left",LRight:"Right",LBottom:"Bottom",LTop:"Top",ChartTitleDlgText:"Enter Title",ChartTitle:"Title",InvalidTitle:"You typed an invalid name for the Title.",CorrectFormat:"Select the correct Format File",ResetPicture:"Reset Picture",ResetPictureContent:"Discard all of the formatting changes made to this picture.",PictureBorder:"Picture Border",PictureBorderContent:"Pick the color, width, and line style for the outline of your shape.",ResetSize:"Reset Picture & Size",Height:"Height",Width:"Width",ThemeColor:"Theme Colors",NoOutline:"No Outline",Weight:"Weight",Dashes:"Dashes",ColumnChart:"2-D Column/3-D Column",ColumnChartTitle:"Insert Column Chart",ColumnChartContent:"Use this chart type to visually compare values across a few categories.",BarChart:"2-D Bar/3-D Bar",BarChartTitle:"Insert Bar Chart",BarChartContent:"Use this chart type to visually compare values across a few categories when the chart shows duration or the category text is long.",StockChart:"Radar",StockChartTitle:"Insert Radar Chart",StockChartContent:"Use this chart type to show values relative to a center point.",LineChart:"2-D Line",LineChartTitle:"Insert Line Chart",LineChartContent:"Use this chart type to show trends over time (years, months, and days) or categories.",AreaChart:"2-D Area/3-D Area",AreaChartTitle:"Insert Area Chart",AreaChartContent:"Use this chart type to show trends over time (years, months, and days) or categories. Use it to highlight the magnitude of change over time.",ComboChart:"Combo",PieChart:"Pie",PieChartTitle:"Insert Pie/Doughnut Chart",PieChartContent:"Use this chart type to show proportions of a whole. Use it when the total of your numbers is 100%.",ScatterChart:"Scatter",ScatterChartTitle:"Insert Scatter (X, Y) Chart",ScatterChartContent:"Use this chart type to show the relationship between sets of values.",ClusteredColumn:"Clustered&nbsp;Column",StackedColumn:"Stacked&nbsp;Column",Stacked100Column:"100%&nbsp;Stacked&nbsp;Column",Cluster3DColumn:"3-D&nbsp;Clustered&nbsp;Column",Stacked3DColumn:"3-D&nbsp;Stacked&nbsp;Column",Stacked100Column3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Column",ClusteredBar:"Clustered&nbsp;Bar",StackedBar:"Stacked&nbsp;Bar",Stacked100Bar:"100%&nbsp;Stacked&nbsp;Bar",Cluster3DBar:"3-D&nbsp;Clustered&nbsp;Bar",Stacked3DBar:"3-D&nbsp;Stacked&nbsp;Bar",Stacked100Bar3D:"3-D&nbsp;100%&nbsp;Stacked&nbsp;Bar",Radar:"Radar",RadarMarkers:"Radar&nbsp;with&nbsp;Markers",LineMarkers:"Line&nbsp;with&nbsp;Markers",Area:"Area",StackedArea:"Stacked&nbsp;Area",Stacked100Area:"100%&nbsp;Stacked&nbsp;Area",Pie:"Pie",Pie3D:"3-D&nbsp;Pie",Doughnut:"Doughnut",Scatter:"Scatter",ChartRange:"Chart Range",XAxisRange:"Enter X-axis range:",YAxisRange:"Enter Y-axis range:",LegendRange:"Enter legend range:",YAxisMissing:"Enter Y-axis range to create chart",InvalidYAxis:"Y-axis range must be within the selected range",InvalidXAxis:"X-axis range must be within the selected range",InvalidLegend:"Legend range must be within the selected range",InvalidXAxisColumns:"X-axis range should be within a single column",FreezePanes:"Freeze Panes",FreezePanesContent:"Freeze a portion of the sheet to keep it visible while you scroll through the rest of the sheet.",PasteTitle:"Paste (Ctrl+V)",PasteContent:"Add content on the Clipboard to your document.",PasteSplitContent:"Pick a paste option, such as keeping formatting or pasting only content.",CutTitle:"Cut (Ctrl+X)",CutContent:"Remove the selection and put it on the Clipboard so you can paste it somewhere else.",CopyTitle:"Copy (Ctrl+C)",CopyContent:"Put a copy of the selection on the Clipboard so you can paste it somewhere else.",FPTitle:"Format Painter",FPContent:"Like the look of a particular selection? You can apply that look to other content in the document.",BoldTitle:"Bold (Ctrl+B)",BoldContent:"Make your text bold.",ItalicTitle:"Italic (Ctrl+I)",ItalicContent:"Italicize your text.",ULineTitle:"Underline (Ctrl+U)",ULineContent:"Underline your text.",LineTrTitle:"Strike Through (Ctrl+5)",LineTrContent:"Cross something out by drawing a strike through it.",UndoTitle:"Undo (Ctrl+Z)",UndoContent:"Undo your last action.",RedoTitle:"Redo (Ctrl+Y)",RedoContent:"Redo your last action.",TableTitle:"Table (Ctrl+T)",HyperLinkTitle:"Add a Hyperlink (Ctrl+K)",HyperLinkContent:"Create a link in your document for quick access to webpages and files. <br /><br />Hyperlinks can also take you to places in your document.",NewCommentTitle:"Insert a Comment",NewCommentContent:"Add a note about this part of the document.",RefreshTitle:"Refresh",RefreshContent:"Get the latest data from the source connected to the active cell",FieldListTitle:"Field List",FieldListContent:"Show or hide the Field List. <br /><br /> The field list allows you to add and remove fields from your PivotTable report",AddChartElement:"Add Chart Element",AddChartElementContent:"Add elements to the created chart.",SwitchRowColumn:"Switch Row/ Column",SwitchRowColumnContent:"Swap the data over the axis.",MergeAlert:"We can't do that to a merged cell.",UnhideDlgText:"Unhide Sheet:",ChartThemes:"Chart Themes",ChartThemesContent:"Pick a new theme for your chart.",ChangePicture:"Change Picture",ChangePictureContent:"Change to a different picture, preserving the formatting and size of the current picture.",ChangeChartType:"Change Chart Type",SelectData:"Select Data",SelectDataContent:"Change the data range included in the chart.",Sum:"Sum",Average:"Average",CountNumber:"Count Numbers",Max:"Max",Min:"Min",ChartType:"Change Chart Type",ChartTypeContent:"Change to a different chart type.",AllCharts:"All Charts",defaultfont:"Default",LGeneral:"General",LCurrency:"Currency",LAccounting:"Accounting",LDate:"Date",LTime:"Time",LPercentage:"Percentage",LFraction:"Fraction",LScientific:"Scientific",LText:"Text",LCustom:"Custom",FormatSample:"Sample",Category:"Category:",Top:"Top",Center:"Center",Bottom:"Bottom",Left:"Left (Indent)",Right:"Right",Justify:"Justify",GeneralTxt:"General format cells have no specific number format.",NegativeNumbersTxt:"Negative Numbers",ThousandSeparatorTxt:"Use 1000 Separator",DecimalPlacesTxt:"Decimal Places:",TextTxt:"Text format cells are treated as text even when a number is in the cell. The cell is displayed exactly as entered.",BoldItalic:"Bold Italic",Regular:"Regular",HyperLinkHide:"<<Selection in Document>>",InvalidSheetIndex:"Specify proper SheetIndex",HugeDataAlert:"File too large to open.",ImportExportUrl:"Give import/export URL and try again.",TitleColumnChart:"Clustered Column/Stacked Column/100% Stacked Column/3D Clustered Column/3D Stacked Column/ 3D 100% Stacked Column",TitleBarChart:"Clustered Bar/Stacked Bar/100% Stacked Bar/3D Clustered Bar/3D Stacked Bar/3D 100% Stacked Bar",TitleRadarChart:"Radar/Radar with Markers",TitleLineChart:"Line/Line with Markers",TitleAreaChart:"Area/Stacked Area/100% Stacked Area",TitlePieChart:"Pie/3D Pie/Doughnut",TitleScatterChart:"Scatter",BetweenAlert:"The Maximum must be greater or equal to the Minimum.",BorderStyles:"Solid/Dashed/Dotted",FPaneAlert:"Freeze Pane is not applied for the First Cell",ReplaceNotFound:"Spreadsheet cannot find a match.",BlankWorkbook:"Blank workbook",SaveAsExcel:"Save As Excel",SaveAsCsv:"Save As CSV",SaveAsPdf:"Save As PDF",Design:"DESIGN",NewName:"New Name",FormulaBar:"Formula Bar",NameBox:"Name Box",NumberValMsg:"Decimal values cannot be used for number conditions.",NumberAlertMsg:"Enter only digits.",ListAlert:"Cell range is incorrect, Please enter correct cell range.",ListValAlert:"The list source must be a delimited list, or a reference to single row or column.",ListAlertMsg:"The value you entered is not valid",AutoFillTitle:"AutoFillOptions",NewSheet:"New Sheet",FullSheetCopyPasteAlert:"We can't paste because the Copy area and paste area aren't the same size.",Heading:"Headings",Gridlines:"Gridlines",Firstsheet:"Scroll to the first sheet",Lastsheet:"Scroll to the last sheet",Nextsheet:"Scroll to the next sheet",Prevsheet:"Scroll to the previous sheet",ProtectWorkbook:"Protect Workbook",UnProtectWorkbook:"Unprotect Workbook",ProtectWBContent:"Keep others from making structural changes to your workbook",Password:"Password",ConfirmPassword:"Reenter password to proceed:",PasswordAlert1:"Confirmation password is not identical.",PasswordAlert2:"Please enter a password.",PasswordAlert3:"The password you supplied is not correct. Verify that the CAPS LOCK key is off and be sure to use the correct capitalization.",Protect:"is protected.",Lock:"LockCell",Unlock:"UnlockCell",Protectsheet:"Protect Sheet",ProtectSheetToolTip:"Prevent unwanted changes from others by limiting their ability to edit",Unprotect:"Unprotect Sheet",LockAlert:"The cell you are trying to change is on protected sheet. To make changes, click Unprotect Sheet in the Review tab.",InsertDeleteAlert:"This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet.",CreateRule:"New Rule",NewRule:"New Formatting Rule",NewRuleLabelContent:"Format values where this formula is true:",ReadOnly:"The range you are trying to change contains readonly cells.",CreatePivotTable:"Create PivotTable",Range:"Range:",ChoosePivotTable:"Choose where you want the PivotTable to be placed",NewWorksheet:"New Worksheet",ExistingWorksheet:"Existing Worksheet",Location:"Location:",Refresh:"Refresh",PivotRowsAlert:"This command requires at least two rows of source data. You cannot use the command on a selection in only one row.",PivotLabelsAlert:"The PivotTable field name is not valid, To create a PivotTable report, you must use data that is organized as a list with labeled columns. If you are changing the name of a PivotTable field, you must type a new name for the field.",FieldList:"Field List",MergeSortAlert:"To do this, all the merged cells need to be the same size.",FormulaSortAlert:"The sort range with formula cannot be sorted.",MergePreventInsertDelete:"This operation is not allowed. The operation is attempting to shift a merge cells on your worksheet.",FormulaRuleMsg:"Please enter correct format.",MovePivotTable:"Move PivotTable",MovePivotTableContent:"Move the PivotTable to another location in the workbook.",ClearAllContent:"Remove fields and filters.",ChangeDataSource:"Modify",ChangeDataSourceContent:"Change the source data for this PivotTable",ChangePivotTableDataSource:"Change PivotTable Data Source",TotalRowAlert:"This operation is not allowed. The operation is attempting to shift cells in a table on your worksheet. Click OK to proceed with entire row.",CellTypeAlert:"This operation is not allowed in cell type applied range.",PivotOverlapAlert:"A PivotTable report cannot overlap another PivotTable report",NoCellFound:"No cells were found",CorrectArgument:"To enter the correct argument",CorrectFormula:"To enter the correct formula",CorrectCellAddress:"To enter the correct cell address",ChartType:"Chart Type",NumberValidationAlert:"The Maximum must be greater than or equal to Minimum",DateValidationAlert:"The End Date must be greater than or equal to Start Date",TimeValidationAlert:"The End Time must be greater than or equal to Start Time",NewRuleAlert:"There's a problem with this formula"};t.Spreadsheet.scrollMode={Normal:"normal",Infinite:"infinite"};t.Spreadsheet.AutoFillOptions={CopyCells:"copycells",FillSeries:"fillseries",FillFormattingOnly:"fillformattingonly",FillWithoutFormatting:"fillwithoutformatting",FlashFill:"flashfill"};t.Spreadsheet.autoFillDirection={Up:"up",Right:"right",Down:"down",Left:"left"};t.Spreadsheet.pageSize={A4:"A4",A3:"A3",Letter:"Letter"};t.Spreadsheet.Actions={Sorting:"sorting",Selection:"selection",AutoFill:"autofill",CellNavigation:"cellnavigation",Filtering:"filtering"};t.Spreadsheet.exportType={Excel:"Excel",Csv:"Csv",Pdf:"Pdf"};t.Spreadsheet.CustomCellType={Button:"Button",CheckBox:"CheckBox",DropDownList:"DropDownList",DatePicker:"DatePicker"};t.Spreadsheet.CellType={String:"string",Number:"number",Custom:"custom",Formula:"formula",Time:"time",LongDate:"longdate",ShortDate:"shortdate",Scientific:"scientific",Fraction:"fraction",Text:"text",General:"general",Accounting:"accounting",Currency:"currency",Percentage:"percentage",Date:"date",DateTime:"datetime"};t.Spreadsheet.SupportedStyles={FontFamily:"font-family",FontSize:"font-size",FontStyle:"font-style",FontWeight:"font-weight",TextAlign:"text-align",TextDecoration:"text-decoration",VerticalAlign:"vertical-align",TextIndent:"text-indent"};t.Spreadsheet.Validation={">":"GreaterThan",">=":"GreaterOrEqualTo","<":"LessThan","<=":"LessThanOrEqualTo","==":"EqualTo","!=":"NotEqualTo","!":"Not","=":""};t.Spreadsheet.ValidationText={">":"greater than",">=":"greater than or equal to","<":"less than","<=":"less than or equal to","==":"equal to","!=":"not equal to","!":" not","=":""};t.Spreadsheet.msg=" ";t.Spreadsheet.getMsg=function(){return t.Spreadsheet.msg};t.Spreadsheet.SelectionType={Row:"row",Column:"column",Default:"default"};t.Spreadsheet.SelectionUnit={Single:"single",Range:"range",MultiRange:"multirange"};t.Spreadsheet.Align={Left:"left",Right:"right",Center:"center"};t.Spreadsheet.CFormatRule={GreaterThan:"greaterthan",LessThan:"lessthan",Between:"between",EqualTo:"equalto",TextContains:"textcontains",DateOccur:"dateoccur"};t.Spreadsheet.ContextMenu={Cell:"cell",RowHeader:"rowheader",ColumnHeader:"columnheader",Footer:"footer"};t.Spreadsheet.CFormatHighlightColor={RedFillwithDarkRedText:"redft",YellowFillwithDarkYellowText:"yellowft",GreenFillwithDarkGreenText:"greenft",RedFill:"redf",RedText:"redt"};t.Spreadsheet.BorderType={Top:"top",Left:"left",Right:"right",Bottom:"bottom",OutSide:"outside",AllBorder:"allborder",ThickBox:"thickbox",ThickBottom:"thickbottom",TopandBottom:"topandbottom",TopandThickBottom:"topandthickbottom"};t.Spreadsheet.ChartProperties={PrimaryHorizontal:"PHAxis",PrimaryVertical:"PVAxis",PrimaryHorizontalAxisTitle:"PHAxisTitle",PrimaryVerticalAxisTitle:"PVAxisTitle",TitleNone:"CTNone",TitleCenter:"CTCenter",TitleFar:"CTFar",TitleNear:"CTNear",DataLabelNone:"DLNone",DataLabelCenter:"DLCenter",DataLabelInsideBase:"DLIBase",DataLabelInsideEnd:"DLIEnd",DataLabelOutsideEnd:"DLOEnd",PrimaryMajorHorizontal:"PMajorH",PrimaryMajorVertical:"PMajorV",PrimaryMinorHorizontal:"PMinorH",PrimaryMinorVertical:"PMinorV",LegendsNone:"LNone",LegendsLeft:"LLeft",LegendsRight:"LRight",LegendsBottom:"LBottom",LegendsTop:"LTop"};t.Spreadsheet.HideTypes={Default:"default",Freeze:"freeze"}})(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.selection=function(n){this.XLObj=n;this._isRightClick=!1;this._colhdrClick=!1;this._rowhdrClick=!1;this._aFillDownHandler=!1;this._isOutsideBordering=!1;this._isGridBordering=!1;this._isRowSelected=!1;this._isColSelected=!1;this._isEndReached=!0;this._canTouchMove=!1};t.spreadsheetFeatures.selection.prototype={_selectionMouseDownHandler:function(i){var e,o,r=this.XLObj,f=r.getSheet(),u=i.target;r._isTouchEvt?(r._browserDetails.name==="msie"&&i.preventDefault(),(r._isSelected(i.target)||r._hasClass(i.target,"e-autofill"))&&(e=r._getBrowserEvt("move"),this._canTouchMove=!0),o=r._getBrowserEvt("end")):(i.preventDefault(),e=r._getBrowserEvt("move",!0),o=r._getBrowserEvt("end",!0)+" mouseleave");r._on(n(document),o,this._mouseUpHandler);i.which===3||i.button===2||r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.Single?this._isRightClick=!0:e&&r._on(r.element,e,this._mouseMoveHandler);u.tagName=="TD"?(r.XLEdit._isFormulaEdit?(i.ctrlKey&&(this._clearBorder(r._arrayAsString(r._ctrlFormulaBorder)),r._ctrlKeyCount=r._formulaRange.length),r._dStartCell=r._getCellIdx(u)):i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell=r._getCellIdx(u):(f._startCell=r._getCellIdx(u),f._activeCell=r._getCellIdx(u)),u.className.indexOf("e-rowheader")>-1&&(this._rowhdrClick=!0)):u.parentNode.tagName=="TH"?(i.shiftKey&&f._startCell.rowIndex!=-1?f._endCell={rowIndex:0,colIndex:u.parentNode.cellIndex}:(f._startCell={rowIndex:0,colIndex:u.parentNode.cellIndex},f._activeCell={rowIndex:0,colIndex:u.parentNode.cellIndex}),u.className.indexOf("e-headercelldiv")>-1&&(this._colhdrClick=!0)):u.className=="e-autofill"&&(this._aFillDownHandler=!0)},_mouseMoveHandler:function(i){var o,l,r=this,e=r.XLSelection,s=r.getActiveSheetIndex(),u=r.getSheet(s),f=i.target,a,h=r.model.selectionSettings.selectionType,c=t.Spreadsheet.SelectionType,v=n(i.target).get(0);if(!r._isTouchEvt||(r._isTouchMoveSel=!0,l=r._getOriginalEvt(i),f=document.elementFromPoint(l.clientX,l.clientY),f))if(n(f).hasClass("e-rowcell")||n(f).hasClass("e-rowheader")){if(this.XLSelection._isEndReached=!1,r._getContent(s).find("td").removeClass(r._ctrlFormulaBorder[r._ctrlKeyCount%6].join(" ")),r.XLEdit._isFormulaEdit){i.ctrlKey?(r._dEndCell=r._getCellIdx(f),e._processFormulaRange(r._ctrlFormulaBorder,!0)):(r._dEndCell=r._getCellIdx(f),e._processFormulaRange(r._ctrlFormulaBorder,!0));return}if(e._aFillDownHandler&&n(f).parents(".e-rowheadercontent").length===0){r.model.allowAutoFill&&r.XLDragFill._selectAutoFillRange(f);return}if(u._startCell=u._activeCell,u._endCell=r._getCellIdx(f),u._isFreezed&&r.XLFreeze._selectionScroll(),e._processBoundary(),n(f).parents(".e-spreadsheetcontentcontainer").length>0){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){r._getContent(r.getActiveSheetIndex()).find("td").removeClass("e-activecell e-focusright e-focusbottom");a=r.swapRange([u._startCell.rowIndex,u._startCell.colIndex,u._endCell.rowIndex,u._endCell.colIndex]);r.getRange(a).addClass("e-ctrlselected");e._focusRange(u._startCell,u._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();return}h===c.Row||e._rowhdrClick?e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex):h===c.Column||e._colhdrClick?e.selectColumns(u._startCell.colIndex,u._endCell.colIndex):e.selectRange(u._startCell,u._endCell,f);u._isFreezed&&r.XLFreeze._refreshSelection()}else if(n(f).parents(".e-rowheadercontent").length>0)e._colhdrClick||e._rowhdrClick?(h===c.Column?e.selectColumns(0,u.colCount-1):e.selectRows(u._startCell.rowIndex,u._endCell.rowIndex),u._isFreezed&&r.XLFreeze._refreshSelection()):(o={position:"horizontal",action:"Decrement"},e._scrollCalculation(s,f,o));else return}else if(t.isNullOrUndefined(f.parentNode)||f.parentNode.tagName!="TH")if(v.id.indexOf("chart")<1&&(f.className.indexOf("e-hhandlespace")>-1||f.className.indexOf("e-hhandle")>-1||f.className.indexOf("e-hup")>-1||f.className.indexOf("e-hdown")>-1))o={position:"vertical",action:"Increment"},e._scrollCalculation(s,f,o);else if(v.id.indexOf("chart")<1&&(f.className.indexOf("e-vhandlespace")>-1||f.className.indexOf("e-vhandle")>-1||f.className.indexOf("e-vup")>-1||f.className.indexOf("e-vdown")>-1))o={position:"horizontal",action:"Increment"},e._scrollCalculation(s,f,o);else return;else u._endCell={rowIndex:0,colIndex:f.parentNode.cellIndex},u._startCell=u._activeCell,u._isFreezed&&r.XLFreeze._selectionScroll(),e._processBoundary(),e._colhdrClick||e._rowhdrClick?(h===c.Row?e.selectRows(0,u.rowCount-1):e.selectColumns(u._startCell.colIndex,u._endCell.colIndex),u._isFreezed&&r.XLFreeze._refreshSelection()):(o={position:"vertical",action:"Decrement"},e._scrollCalculation(s,f,o))},_mouseUpHandler:function(i){i.target=this._changeTargetWithOffset(i);var e,h,v,l,k,d,a,o,g,nt,y,tt,it,p=!0,r=this,u=r.XLSelection,s=r.getActiveSheetIndex(),f=r.getSheet(s),rt=f.selectedRange,ut=r.getSheetElement(s),w=r.model.selectionSettings.selectionType,ft=f._startCell,et=f._endCell,b=t.Spreadsheet.SelectionType,c=r._getJSSheetContent(s).find(".e-spreadsheetcontentcontainer > .e-content");if(r.XLEdit._isEdit||r.setSheetFocus(),r._isTouchEvt?(tt=r._getBrowserEvt("end"),u._canTouchMove&&(y=r._getBrowserEvt("move")),r._isTouchMoveSel=!1):(y=r._getBrowserEvt("move",!0),tt=r._getBrowserEvt("end",!0)+" mouseleave"),y&&r._off(r.element,y,u._mouseMoveHandler),r._off(n(document),tt,u._mouseUpHandler),r._isTouchEvt){if(!u._aFillDownHandler&&r._isTouchScroll||!u._canTouchMove&&!r._isUniqueTarget(r._touchArgs,i)){u._canTouchMove=r._isTouchScroll=!1;return}if(u._canTouchMove=r._isTouchScroll=!1,it=r._getOriginalEvt(i),e=document.elementFromPoint(it.clientX,it.clientY),!e){this.model.allowAutoFill&&this.XLDragFill.positionAutoFillElement();return}}if(e=e||i.target,h=n(e),e.tagName=="TD"||e.tagName=="INPUT"&&!h.parents(".e-formulabar").length||u._aFillDownHandler){if(h.parents(".e-rowheadercontent").length&&(u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor")),r._preventctrlkey=i.ctrlKey,r.XLEdit._isFormulaEdit){c.find("td").removeClass(r._ctrlFormulaBorder.join(" ").replace(/,/g," "));i.ctrlKey?(r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder)):(u._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),r._ctrlKeyCount=0,r._dEndCell=r._getCellIdx(e),u._processFormulaRange(r._formulaBorder),r._formulaRange=[]);r._formulaRange.push(r._getProperAlphaRange(s,r._dStartCell.rowIndex,r._dStartCell.colIndex,r._dEndCell.rowIndex,r._dEndCell.colIndex));return}if(u._aFillDownHandler){if(a=e.tagName==="TD"?r._getCellIdx(e):r._dautoFillCell,r.model.allowAutoFill&&(o=r.XLDragFill._getAutoFillRange(a)),!o||!o.fillRange){u._aFillDownHandler=!1;r.XLDragFill.positionAutoFillElement();return}if(k=r.swapRange(o.fillRange),r.model.allowLockCell&&r.getSheet(s).isSheetProtected&&r._isPropExists([k],"isLocked",s)&&(p=!1),p&&r._isPropExists([k],"isReadOnly",s)&&(p=!1),p)"direction"in o?(r._pStartCell=f._startCell,r._pEndCell=f._endCell,r._pFillCell=a,r.inRange(f.selectedRange,a.rowIndex,a.colIndex)?r.clearRangeData(null,null,n(u.getSelectedCells()).not(".e-autofillcell")):r.model.allowAutoFill&&r.XLDragFill.autoFill({dataRange:f.selectedRange,fillRange:o.fillRange,direction:o.direction,fillType:r.model.autoFillSettings.fillType}),f._startCell=o.startCell,f._endCell=o.endCell):u._aFillDownHandler=!1;else{u._aFillDownHandler=!1;r.XLSelection.selectRange(ft,et);r.XLDragFill.positionAutoFillElement();return}u.refreshSelection(r.swapRange([o.startCell.rowIndex,o.startCell.colIndex,o.endCell.rowIndex,o.endCell.colIndex]))}else if(u._isOutsideBordering||u._isGridBordering)if(l="1px "+r._borderStyle+" "+r._borderColor,u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length)g={top:l,right:l,bottom:l,left:l},u._isGridBordering&&(g.isGridBorder=!0),r.XLFormat.applyBorder(g,r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex])),u._cleanUp(!0);else return;else if(e.tagName=="INPUT"&&h.parents("tr").length?f._endCell=u._isRightClick?f._startCell:r._getCellIdx(h.parents("td")[0]):u._isRightClick?f._endCell=f._startCell:(f._startCell=f._activeCell,f._endCell=r._getCellIdx(e),u._processBoundary()),h.parents(".e-spreadsheetcontentcontainer").length){if(i.ctrlKey&&r.model.selectionSettings.selectionType===t.Spreadsheet.SelectionType.Default&&r.model.selectionSettings.selectionUnit===t.Spreadsheet.SelectionUnit.MultiRange){c.find("td").removeClass("e-activecell e-focustop e-focusleft e-ctrlselected");rt=r.swapRange([f._startCell.rowIndex,f._startCell.colIndex,f._endCell.rowIndex,f._endCell.colIndex]);r.getRange(rt).addClass("e-selected");r.getCell(f._activeCell.rowIndex,f._activeCell.colIndex).addClass("e-activecell");u._focusRange(f._startCell,f._endCell,r._selectionBorder);r.model.allowAutoFill&&r.XLDragFill.hideAutoFillElement();r.getSheet(s)._selectedCells.push(r._getSelectedRange(r.getSheet(s)._startCell,r.getSheet(s)._endCell));r.model.showRibbon&&r.model.allowComments&&ut.find(".e-selected.e-commentcell").length&&r.XLRibbon._enableButtons(["Review_Comments_DeleteComment"],"ejButton");return}w===b.Row||u._rowhdrClick?u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex):w===b.Column||u._colhdrClick?u.selectColumns(f._startCell.colIndex,f._endCell.colIndex):u.selectRange(f._startCell,f._endCell,e);f._isFreezed&&r.XLFreeze._refreshSelection()}else if(h.parents(".e-rowheadercontent").length)(u._colhdrClick||u._rowhdrClick)&&(w===b.Column?u.selectColumns(0,f.colCount-1):u.selectRows(f._startCell.rowIndex,f._endCell.rowIndex),u._hdrClick=!1),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor");else return;e.tagName==="TD"&&r.model.showRibbon&&(nt=n("#"+r._id+"_Ribbon_clearfilter").data("ejButton"),nt&&r.XLRibbon._changeClrFltrStatus(nt,"button",r._getCellIdx(e)))}else u._aFillDownHandler||t.isNullOrUndefined(e.parentNode)||e.parentNode.tagName!="TH"?typeof e.className!="object"&&e.className&&e.className.indexOf("e-spreadsheetcolumnheader")>-1&&(u.selectSheet(!0),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor")):(f._startCell=f._activeCell,f._endCell=u._isRightClick?f._startCell:{rowIndex:0,colIndex:e.parentNode.cellIndex},u._processBoundary(),(u._colhdrClick||u._rowhdrClick)&&(w===b.Row?u.selectRows(0,f.rowCount-1):u.selectColumns(f._startCell.colIndex,f._endCell.colIndex)),u._isOutsideBordering=u._isGridBordering=!1,c.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor").addClass("e-ss-cursor"));r.model.allowCellFormatting&&r.XLFormat._formatEnable&&r.XLFormat._fPMouseUp(i);r.model.showRibbon&&(r.XLEdit._isEdit?r.XLRibbon._disableRibbonIcons():r.XLRibbon._updateRibbonIcons());!r.model.allowAutoFill||u._isOutsideBordering||u._isGridBordering||r.XLDragFill.positionAutoFillElement(u._aFillDownHandler);u._isRightClick=u._aFillDownHandler=!1;u._colhdrClick=u._rowhdrClick=!1;r.model.showRibbon&&(v=n("#"+r._id+"_Ribbon_merge").data("ejSplitButton"),t.isNullOrUndefined(v)||!r.model.allowLockCell||f.isSheetProtected||(r.XLRibbon._isDirtySelect?v.option("enabled",!1):v.option("enabled",!0)));r.model.allowEditing&&this.XLEdit._isEdit&&(d=r.getSheet(s)._startCell,r.getCell(d.rowIndex,d.colIndex).find(".e-ss-input").focus())},_processBoundary:function(){var u,o,f,t,e,r,s=[],i=this.XLObj,c=i.getActiveSheetIndex(),h=i.getSheet(c),l=h._startCell,a=h._endCell,n=i.swapRange([l.rowIndex,l.colIndex,a.rowIndex,a.colIndex]);for(h._startCell={rowIndex:n[0],colIndex:n[1]},h._endCell={rowIndex:n[2],colIndex:n[3]},t=i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[0],colIndex:n[3]}),t=t.concat(i._getSelectedRange({rowIndex:n[0],colIndex:n[3]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(i._getSelectedRange({rowIndex:n[2],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]})),t=t.concat(i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[1]})),u=t.length;u--;)if(f=t[u],e=i.XLEdit.getPropertyValue(t[u].rowIndex,t[u].colIndex,"mergeIdx",c),r=(f.rowIndex+":"+f.colIndex).toString(),o=i.hasSpan(f)&&s.indexOf(r)===-1&&(s.push(r),this._updateRange(f,n)),e&&(r=(e.rowIndex+":"+e.colIndex).toString(),s.indexOf(r)===-1&&(s.push(r),o=this._updateRange(e,n))),o)break;o&&this._processBoundary()},_updateRange:function(n,t){var r=this.XLObj,c=r.getActiveSheetIndex(),u=r.getSheet(c),i=t.slice(0),f=r._getMergedIdx(n.rowIndex,n.colIndex),e=n.rowIndex,o=n.colIndex,s=f.rowIndex,h=f.colIndex;return e<t[0]&&(t[0]=e),o<t[1]&&(t[1]=o),s>t[2]&&(t[2]=s),h>t[3]&&(t[3]=h),t[0]!=i[0]||t[1]!=i[1]||t[2]!=i[2]||t[3]!=i[3]?(u._startCell={rowIndex:t[0],colIndex:t[1]},u._endCell={rowIndex:t[2],colIndex:t[3]},!0):void 0},selectRange:function(n,t,i,r){var s,c,l,e,v,a,y,p,f,h,o=n,u=this.XLObj;if(u.model.allowSelection&&(u._isObject(n)||(n=u._getRangeArgs(n,"object"),o={rowIndex:n[0],colIndex:n[1]},t={rowIndex:n[2],colIndex:n[3]}),h=u.getActiveSheetIndex(),f=u.getSheet(h),y=u.model.scrollSettings.allowVirtualScrolling,y&&(f._goToCollection={multiple:!1,selected:[]}),p=f.selectedRange,e=u.swapRange([o.rowIndex,o.colIndex,t.rowIndex,t.colIndex]),v=!u.isImport&&(!f._isImported||f._isLoaded),!v||!u.model.beforeCellSelect||(s={prevRange:p,currRange:e,sheetIdx:h},i&&(s.target=i),u._intrnlReq||!u._trigger("beforeCellSelect",s)))){if(u._dStartCell=o,u._dEndCell=t,f.selectedRange=e.slice(0),this._cleanUp(!1),u.model.scrollSettings.allowScrolling&&y&&f._isColSelected&&(f._virtualRowIdx.indexOf(e[0])===-1&&(e[0]=f._virtualRowIdx[0]),f._virtualRowIdx.indexOf(e[2])===-1&&(e[2]=f._virtualRowIdx[f._virtualRowIdx.length-1])),a=u.isUndefined(r),a&&(c=u.getRange(e),l=c.length,l))while(l--)u.addClass(c[l],"e-selected");u.inRange(f.selectedRange,f._activeCell.rowIndex,f._activeCell.colIndex)||(f._activeCell={rowIndex:f.selectedRange[0],colIndex:f.selectedRange[1]});f._activeCell=u._getMergeParent(f._activeCell.rowIndex,f._activeCell.colIndex);u._isRowViewable(h,f._activeCell.rowIndex)&&u.addClass(u.getCell(f._activeCell.rowIndex,f._activeCell.colIndex)[0],"e-activecell");a&&(this._focusRange(o,t,u._selectionBorder),this._highlightHeader(e));f._selectedCells=u._getSelectedRange(o,t);u.model.allowFormulaBar&&u.updateFormulaBar();a&&(u.model.enableContextMenu||u.model.showRibbon)&&u.XLRibbon._dirtySelect(c);u._isMultiSelect=!0;u.model.showRibbon&&u.XLRibbon._updateRibbonIcons();u._isSheetNavigate||(f._isEmptyActiveCell=f._isRangeSelected=f._isRowSelected=f._isColSelected=f._isSheetSelected=!1);v&&u.model.cellSelected&&(s={selectedRange:f.selectedRange,target:i,sheetIdx:h},u._intrnlReq||u._trigger("cellSelected",s))}},selectRow:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(t._startCell={rowIndex:n,colIndex:0},t._endCell={rowIndex:n,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),this._selectRow(i._getRowIdx(n),"e-rowselected"),t._isRowSelected=!0)},selectRows:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:n,colIndex:0},i._endCell={rowIndex:t,colIndex:i.colCount-1},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"row"),i._isRowSelected=!0)},selectColumn:function(n){var t,i=this.XLObj;i.model.allowSelection&&(t=i.getSheet(i.getActiveSheetIndex()),t._startCell={rowIndex:0,colIndex:n},t._endCell={rowIndex:t.rowCount-1,colIndex:n},this.selectRange(t._startCell,t._endCell),this._selectColumn(n,"e-colselected"),t._isColSelected=!0)},selectColumns:function(n,t){var i,r=this.XLObj;r.model.allowSelection&&(i=r.getSheet(r.getActiveSheetIndex()),i._startCell={rowIndex:0,colIndex:n},i._endCell={rowIndex:i.rowCount-1,colIndex:t},this.selectRange(i._startCell,i._endCell),this._markHeaderSelection([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex],"column"),i._isColSelected=!0)},selectSheet:function(n){var i=this.XLObj,t=i.getSheet(i.getActiveSheetIndex());i.model.allowSelection&&(n&&(t._activeCell={rowIndex:t._topRow.idx,colIndex:0}),t._startCell={rowIndex:0,colIndex:0},t._endCell={rowIndex:t.rowCount-1,colIndex:t.colCount-1},this.selectRange(t._startCell,t._endCell),i.element.find(".e-spreadsheetcolumnheader").addClass("e-sheetselected"),t._isSheetSelected=!0)},refreshSelection:function(n){var t=this.XLObj,i=t.getSheet(t.getActiveSheetIndex()),n=t._getRangeArgs(n,"object"),r=n[0],u=n[1],f=n[2],e=n[3];i._isRowSelected?this.selectRows(r,f):i._isColSelected?this.selectColumns(u,e):i._isSheetSelected?this.selectSheet():this.selectRange({rowIndex:r,colIndex:u},{rowIndex:f,colIndex:e})},getSelectedCells:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n))[0].querySelectorAll("td.e-selected")},_select:function(n,t){var i=this.XLObj.getCell(n.rowIndex,n.colIndex);i&&i.addClass(t)},_selectRow:function(n,t){var i=this.XLObj._getJSSheetRowHeaderContent(this.XLObj.getActiveSheetIndex()).find("td:eq("+n+")");i&&i.addClass(t)},_selectRows:function(n,t,i){var r,e,u,f=this.XLObj,h=f.getActiveSheetIndex(),s=f.getSheet(h),o=f._getJSSheetRowHeaderContent(h).find("td");if(e=f._getRowIdx(n),u=f._getRowIdx(t),e===-1)if(n<s._virtualRowIdx[0])e=0;else return;if(u===-1)if(r=s._virtualRowIdx.length-1,t>s._virtualRowIdx[r])u=r;else return;if(o=e!==u?o.slice(e,u+1):o.eq(u),r=o.length,r)while(r--)f.addClass(o[r],i)},_selectColumn:function(n,t){var i=this.XLObj._getJSSheetHeader(this.XLObj.getActiveSheetIndex()).find("th:eq("+n+")");i&&i.addClass(t)},_selectColumns:function(n,t,i){var u,f=this.XLObj,r=f._getJSSheetHeader(f.getActiveSheetIndex()).find("th");if(r=t!==n?r.slice(n,t+1):r.eq(t),u=r.length,u)while(u--)f.addClass(r[u],i)},_focusBorder:function(n,t,i){var r=this.XLObj,e=r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]),u=e[0],f=e[1],o=e[2],s=e[3];u&&r.getRange([u-1,f,u-1,s]).addClass(i[1]);r.getRange([u,s,o,s]).addClass(i[0]);r.getRange([o,f,o,s]).addClass(i[1]);f&&r.getRange([u,f-1,o,f-1]).addClass(i[0])},_focusRange:function(n,t,i){for(var u=4,r=this.XLObj,f=[r.getFocusTopElem(),r.getFocusRightElem(),r.getFocusBottomElem(),r.getFocusLeftElem()],e=["e-focustop ","e-focusright ","e-focusbottom ","e-focusleft "];u--;)elem=f[u][0],r._removeClass(elem),r.addClass(elem,e[u]+i[u]);this._refreshBorder(r.swapRange([n.rowIndex,n.colIndex,t.rowIndex,t.colIndex]))},_refreshBorder:function(n){n=n?n:this.XLObj.getSheet().selectedRange;for(var u,f,r="e-hide",a=4,v=n[0],y=n[1],i=this.XLObj,t=this._focusInfo(n),e=i.getFocusTopElem(),s=i.getFocusRightElem(),h=i.getFocusBottomElem(),o=i.getFocusLeftElem(),tt=[e,s,h,o],p=ttop=t.topLeft.top,w=lleft=tleft=t.topLeft.left,b=t.topRight.left+t.topRight.width-t.topLeft.left,c=t.topRight.top,k=t.topRight.left+t.topRight.width,d=t.bottomRight.top+t.bottomRight.height-c,l=t.bottomLeft.top+t.bottomLeft.height,g=t.bottomRight.left+t.bottomRight.width-t.bottomLeft.left,nt=l-ttop;a--;)i._removeClass(tt[a][0],r);i.model.selectionSettings.enableAnimation?(u=i.model.selectionSettings.animationType,f=i.model.selectionSettings.animationTime,v?e.animate({top:ttop.toString(),left:tleft.toString(),width:b.toString()},f,u):e.addClass(r),s.animate({top:c.toString(),left:k.toString(),height:d.toString()},f,u),h.animate({top:l.toString(),left:w.toString(),width:g.toString()},f,u),y?o.removeClass(r).animate({top:p.toString(),left:lleft.toString(),height:nt.toString()},f,u):o.addClass(r)):(v?e.css({top:ttop,left:tleft,width:b}):e.addClass(r),s.css({top:c,left:k,height:d}),h.css({top:l,left:w,width:g}),y?o.css({top:p,left:lleft,height:nt}):o.addClass(r))},_focusInfo:function(n){var i={},u=n[0],f=n[1],e=n[2],r=n[3],t=this.XLObj;return i.topLeft=t._getCellInfo({rowIndex:u,colIndex:f}),i.topRight=t._getCellInfo(f===r?{rowIndex:u,colIndex:r}:t._getMergedIdx(u,r)),i.bottomLeft=t._getCellInfo({rowIndex:e,colIndex:f}),i.bottomRight=t._getCellInfo(t._getMergedIdx(e,r)),i},_highlightHeader:function(n){this._selectRows(n[0],n[2],"e-rowhighlight");this._selectColumns(n[1],n[3],"e-colhighlight")},_hideShowSelElem:function(n){(xlObj=this.XLObj,method=n==="block"?"_removeClass":"addClass",xlObj.model.allowSelection)&&(xlObj[method](xlObj.getAutoFillElem()[0],"e-hide"),xlObj[method](xlObj.getFocusBottomElem()[0],"e-hide"),xlObj[method](xlObj.getFocusTopElem()[0],"e-hide"),xlObj[method](xlObj.getFocusLeftElem()[0],"e-hide"),xlObj[method](xlObj.getFocusRightElem()[0],"e-hide"))},_markHeaderSelection:function(n,t){var i,r,u=this.XLObj;if(n=u.swapRange(n),i=n[0],t==="row")for(r=n[2];i<=r;)u._isRowViewable(u.getActiveSheetIndex(),i)&&this._selectRow(u._getRowIdx(i),"e-rowselected"),i++;else for(i=n[1],r=n[3];i<=r;)this._selectColumn(i,"e-colselected"),i++},_processFormulaRange:function(n){var u,t=this.XLObj,f=t.getActiveSheetIndex(),i=t._dStartCell,r=t._dEndCell,e=t._getContent(f).find(".e-editedcell");this._focusBorder(i,r,n[t._ctrlKeyCount%6]);t.model.allowAutoFill&&(u=t._getAlphaRange(f,i.rowIndex,i.colIndex,r.rowIndex,r.colIndex),t.XLDragFill.hideAutoFillElement(),t.XLEdit._updateFormulaCellRange(u));t.XLEdit._isCellEdit?t.XLEdit._focusElements(e):t._getInputBox().focus()},_scrollCalculation:function(n,i,r){var s,c,e,o,f=this.XLObj,u,h;f.model.scrollSettings.allowVirtualScrolling||(u=f.getSheet(f.getActiveSheetIndex()),f.XLSelection._isEndReached=!0,s=setInterval(function(){if(e=f.XLScroll._hScroller(n),o=f.XLScroll._vScroller(n),!f.XLSelection._isEndReached){clearInterval(s);return}if(r.position==="horizontal")r.action=="Increment"?(c=Math.ceil(parseFloat(e.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(e.element.find(".e-hhandle").width()))>=e.element.find(".e-hhandlespace").width()-2,c?f.model.scrollSettings.scrollMode!=t.Spreadsheet.scrollMode.Normal?f.XLScroll._scrollX(n):clearInterval(s):e.scroll(e.value()+u.columnWidth,!0),f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(u._endCell.colIndex=u.colCount-1)):(h=e.value()-u.columnWidth,h<0&&(h=0),e.value()>=0&&e.scroll(h,!0),f.XLSelection._aFillDownHandler&&(u._endCell.colIndex=u._leftCol.idx),u._frozenColumns>1&&(u._startCell=u._activeCell,u._endCell.rowIndex=u.selectedRange[2]===u._startCell.rowIndex?u.selectedRange[0]:u.selectedRange[2],u._endCell.colIndex=u._fleftColIdx));else if(r.position==="vertical")if(r.action=="Increment")c=Math.ceil(parseFloat(o.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(o.element.find(".e-vhandle").height()))>=o.element.find(".e-vhandlespace").height()-2,c?f.model.scrollSettings.scrollMode!=t.Spreadsheet.scrollMode.Normal?f.XLScroll._scrollY(n):clearInterval(s):o.scroll(o.value()+f.model.rowHeight,!0),f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(u._endCell.rowIndex=u.rowCount-1);else if(h=o.value()-f.model.rowHeight,h<0&&(h=0),o.value()>0&&o.scroll(h,!0),!f.XLShape._shapeROStart&&!f.XLShape._shapeRSStart){if(u._topRow.idx<1&&u._ftopRowIdx+1===u._frozenRows)return;u._startCell=u._activeCell;u._endCell.rowIndex=u._frozenRows>1?u._ftopRowIdx:u._topRow.idx-1;u._endCell.colIndex=u._frozenRows>1?u.selectedRange[3]===u._startCell.colIndex?u.selectedRange[1]:u.selectedRange[3]:i.parentNode.cellIndex}f.XLShape._shapeROStart||f.XLShape._shapeRSStart||(f.XLSelection._aFillDownHandler?f.XLDragFill._selectAutoFillRange(null,u._endCell):f.XLSelection.selectRange(u._startCell,u._endCell))},200),f._browserDetails.name==="msie"&&f._browserDetails.version==="8.0"?(i.attachEvent("onmouseup",function(){clearInterval(s)}),document.attachEvent("onmouseup",function(){clearInterval(s)})):(i.addEventListener("mouseup",function(){clearInterval(s)}),document.addEventListener("mouseup",function(){clearInterval(s)})))},_cleanUp:function(n){var i,r,o=!1,u="e-hide",t=this.XLObj,f=t.getActiveSheetIndex(),s=t.getSheet(f),h=t.getFocusTopElem(),e=t.getSheetElement(f);for(t.model.allowAutoFill&&t.XLDragFill._autoFillCleanUp(),s._isSheetSelected&&!t.model.scrollSettings.allowVirtualScrolling&&(o=!0,e.detach()),r=e[0].querySelectorAll(".e-selected,.e-rowselected,.e-colselected,.e-rowhighlight,.e-colhighlight,.e-sheetselected,.e-activecell"),i=r.length;i--;)r[i].className=r[i].className.replace(new RegExp("e-activecell|e-selected|e-rowhighlight|e-colhighlight|e-rowselected|e-colselected|e-sheetselected","g"),"").replace(/ +/g," ");o&&t.getMainPanel(f).find(".e-spreadsheet-list").append(e);n&&h&&(t.addClass(h[0],u),t.addClass(t.getFocusRightElem()[0],u),t.addClass(t.getFocusBottomElem()[0],u),t.addClass(t.getFocusLeftElem()[0],u));s._selectedCells=[]},clearAll:function(n){this._cleanUp(!n)},_clearBorder:function(n){var t=this.XLObj;t._getContent(t.getActiveSheetIndex()).find("td").removeClass(n)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.filter=function(n){this.XLObj=n;this._isSearchEdit=!1;this._isDecimal=!1;this._colName="";this._colType="";this._tableId=""};t.spreadsheetFeatures.filter.prototype={_renderExcelFilter:function(){var n=this.XLObj,i={instance:n,showSortOptions:n.model.allowSorting,maxFilterLimit:n.model.sheets[n.getActiveSheetIndex()].filterSettings.maxFilterChoices,filterHandler:t.proxy(this._filterHandler,this),cancelHandler:t.proxy(this._cancelHandler,this),customFilterHandler:t.proxy(this._customFilterHandler,this),enableComplexBlankFilter:!1,blankValue:"",interDeterminateState:!0};n._excelFilter=new t.excelFilter(i);n.element.append(t.buildTag("div#"+n._id+"_filter_custom.e-filterdlg.e-"+n._id+"-dlg","",{display:"none"}))},_customFilterHandler:function(){var t=this.XLObj;this._isDecimal&&(n("#"+t._id+"number_CustomValue1").ejNumericTextbox("option",{decimalPlaces:2}),n("#"+t._id+"number_CustomValue2").ejNumericTextbox("option",{decimalPlaces:2}))},_renderFilterDialogs:function(t){var i=this.XLObj;document.getElementById(i._id+"_filter_custom").className.indexOf("e-dialog")<0&&this._renderCustomFilter();i._excelFilter.renderDialog(t);this._refreshCustomFilter(t);i.element.find(".e-excelfilter.e-dlgcontainer").hide();n(document.body).append(n("#"+i._id+t+"_excelDlg"))},_createSelection:function(n,t,i,r,u){for(var e=this.XLObj,c=e.getSheet(n).usedRange.rowIndex,o=i,s,h,f=i;f<=c;f++){if(s=e.XLEdit.getPropertyValue(f,0,"isHide"),h=e.XLEdit.getPropertyValue(f,r,"value2",n),!s&&!e.XLEdit.getPropertyValue(f,r,"isMHide")&&!h&&f>=i)return{endRowIndex:f,filteredIndex:u};!s&&h?(o=f+1,u.push(f)):o=o}return{endRowIndex:o,filteredIndex:u}},_getSelectedRangeData:function(n,i,r,u){var o=this.XLObj,s=0,p=o.getActiveSheetIndex(),c=o.getSheet(p),b=[],v,f,h,l,k=[],y,d,g=[],a=o._dataContainer,e=a.sheets[p],w=o.getSheet(p)._multifilterIdx;for(r===-1&&(c.filterSettings.range=o._generateHeaderText(w[0]+1)+n.rowIndex+":"+o._generateHeaderText(w[w.length-1]+1)+(i.rowIndex+1)),c._multipleFiltering&&(i.colIndex=c._multifilterIdx[c._multifilterIdx.length-1]),f=n.rowIndex;f<=i.rowIndex;f++){for(temp={},h=n.colIndex;h<=i.colIndex;h++)v=o._generateHeaderText(h+1),f in e&&(!(s in e[f])||s in e[f]&&t.isNullOrUndefined(e[f][s].isRHide)&&t.isNullOrUndefined(e[f][s].isFHide))&&(!(s in e[f])||s in e[f]&&(t.isNullOrUndefined(e[f][s].isFilterHide)||!t.isNullOrUndefined(e[f][s].isFilterHide)&&e[f][s].filterID===r))&&(temp.idx=f,f in e&&h in e[f]?(l=e[f][h],h===u&&(y=o.XLEdit.getPropertyValue(f,h,"formats"),t.isNullOrUndefined(y)||(d={id:h,background:y["background-color"],foreground:y.color},k.push(d))),temp[v]=t.isNullOrUndefined(a.sharedData[l.value])?"":o._isDateTime(a.sharedData[l.value])||o.isFormula(a.sharedData[l.value])?l.value2:a.sharedData[l.value]):temp[v]=""),!(f in e)&&f<i.rowIndex&&(temp.idx=f,temp[v]="");o.getObjectLength(temp)>0&&(g.push(temp),b.push(f))}c._selectedCellColors=k;c._selectedRange={startRow:n.rowIndex,endRow:i.rowIndex,dataSourceIndexes:b};c.filterSettings.filteredRange=g},_getColumnType:function(t,i,r,u){for(var o="string",e,s,f=i;f<r;f++)if(e=this.XLObj.XLEdit.getPropertyValue(f,u,"value",t),s=this.XLObj.XLEdit.getPropertyValue(f,u,"type",t),s!="text"&&n.isNumeric(e))this._isDecimal||(this._isDecimal=e%1!=0),o="number";else return"string";return o},_getColumnByField:function(n,t){for(var u=this.XLObj,r=u.getSheet(n),i=0;i<r.columns.length;i++)if(r.columns[i].field===t)break;return i===r.columns.length?null:r.columns[i]},_checkEmptyText:function(n){for(var r=this.XLObj,u=r.model.sheets[n]._selectedCells,i=0,f=u.length;i<f;i++)if(!t.isNullOrUndefined(r.XLEdit.getPropertyValue(u[i].rowIndex,u[i].colIndex,"value",n)))return!0;return r._showAlertDlg("Alert","Alert",null,440),!1},_getFilterIcon:function(){var n=t.buildTag("span .e-icon","",{});return n.addClass("e-spanfilter e-filterspan e-ssfilter"),n},filterByActiveCell:function(){var n=this.XLObj,i=n.getActiveSheetIndex(),r;if(n.model.allowFiltering&&!n.model.isReadOnly){var t=n.model.sheets[i]._activeCell,u=n.getCell(t.rowIndex,t.colIndex),f=n.model.sheets[i]._selectedCells;this._checkEmptyText(i)&&(u.find("span").is(".e-ssfiltered, .e-ssfilter, .e-ssfilter-asc, .e-ssfiltered-asc, .e-ssfilter-dsc, .e-ssfiltered-dsc")?n._showAlertDlg("Alert","HeaderAlert","",440):(r=n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value",i),r=n._isDateTime(r)?n.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"value2",i):r,this._filterActiveCell(i,t,f,r)))}},_filterActiveCell:function(n,t,i,r,u){var f=this.XLObj,e=f.getSheet(n);e._activeCell=t;this._filterByValue(n,u,e.columns[t.colIndex].field,"or","equal",r,i);f.model.allowComments&&f.XLComment._updateCmntArrowPos()},_filterByValue:function(i,r,u,f,e,o,s){var c=this.XLObj,s,a,p,k,tt,it,d,g=-1,rt,w,h,v,ut=c.XLEdit.getColumnIndexByField(u),y=c.getSheet(i),b,nt,l;if(t.isNullOrUndefined(r)?s=s:(a=c.getRangeIndices(r),s=c._getSelectedRange({rowIndex:a[0]+1,colIndex:a[1]},{rowIndex:a[2],colIndex:a[3]})),p=s[0],!t.isNullOrUndefined(r)&&(w=c.XLEdit.getPropertyValue(p.rowIndex,p.colIndex,"value2",i),t.isNullOrUndefined(w)||w!==o))for(l=a[0];l<a[2];l++)if(w=c.XLEdit.getPropertyValue(l,ut,"value2",i),!t.isNullOrUndefined(w)&&w===o){p={rowIndex:l,colIndex:ut};break}for(v={currentFilteringColumn:u,action:"filter",predicated:f,requestType:"filterbycell",reqType:"filter",filteredValue:o,selCells:n.extend(!0,[],s),activeCell:p},h=this._applyFilterByValue(i,p,s,o),c._excelFilter._predicates[i]={},k={field:u,value:o,predicate:f,operator:e,matchcase:!1},{}.currentFilterCollection=o,c._excelFilter._predicates[i][u]=t.Predicate(u,e,o),y.filterSettings.filteredColumns.push(k),tt=t.DataManager(y.filterSettings.filteredColumns),it=(new t.Query).where("field",t.FilterOperators.equal,u),d=tt.executeLocal(it),l=0,rt=d.length;l<rt;l++)g=n.inArray(d[l],y.filterSettings.filteredColumns),g>-1&&y.filterSettings.filteredColumns.splice(g,1);if(y.filterSettings.filteredColumns.push(k),v.filteredcolumns=h.filteredColumns=y.filterSettings.filteredColumns,h.filteredColumns.length<1)for(b=h.multifilterIdx,l=b[0];l<=b[b.length-1];l++)nt=c._generateHeaderText(l+1),t.isNullOrUndefined(h.fColumns[nt])||(h.fColumns[nt]=[]);else h.fColumns[u]=n.extend(!0,[],h.filteredColumns);h.predicate=c._excelFilter._predicates[i];v.tableID=h.tableID;v.filteredCells=h.filteredCells;c.XLSelection._refreshBorder();v.operation="filterbycell";v.selRange=c._getAlphaRange(i,h.startRow-1,h.multifilterIdx[0],h.endRow,h.multifilterIdx[h.multifilterIdx.length-1]);c._processBindings(v)&&(y.filterSettings.filteredColumns=temp)},_applyFilterByValue:function(i,r,u){var s=this.XLObj,e=s.getSheet(i),b=[],v,h,y,tt,a,ft=s.getCell(r.rowIndex,r.colIndex)[0].className,c=e.filterSettings.tableRange,it=[],o,l,rt=!1,d,p,et=s.model.scrollSettings.allowVirtualScrolling,g=s.getSheet(i)._filterColl,w,k,nt,f,ut;for(a=s.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tableName",i),a=a?s._getTableID(a):-1,f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;break}if(!t.isNullOrUndefined(l)&&c[l].tableID===a&&c[l].selectedCellIndexes.indexOf(r.colIndex)!==-1&&c[f].startRow<=r.rowIndex&&c[f].endRow>=r.rowIndex)o=c[l],e.filterSettings.filteredRange=c[l].filteredRange,e._selectedRange=c[l].selectedRange;else{for(e._multipleFiltering=!1,e._multifilterIdx=[],s._dupDetails=!0,this.clearFilter("remove"),s._dupDetails=!1,w=s.getObjectKeys(g),f=w.length-1;f>=0;f--)for(k=s.getObjectKeys(g[f]),j=k.length-1;j>=0;j--)s._isRowViewable(i,w[f])&&(nt=s.getCell(w[f],k[j]),nt.find(".e-filterspan").remove(),nt.removeClass("e-filterhdr")),delete g[w[f]][k[j]];if(u.length<2||u[0].rowIndex===u[u.length-1].rowIndex){for(h=-1,y=u[u.length-1].rowIndex,f=u[0].rowIndex;f>=0;f--)if(t.isNullOrUndefined(s.XLEdit.getPropertyValue(f,u[0].colIndex,"value2"))){h=f;break}h=h===-1?1:h+2;y=this._createSelection(i,h,y,u[0].colIndex,[]).endRowIndex-1;v={rowIndex:y,colIndex:r.colIndex};this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex)}else h=r.rowIndex,y=this._createSelection(i,h,u[u.length-1].rowIndex,u[0].colIndex,[]).endRowIndex-1,v={rowIndex:y,colIndex:r.colIndex},this._getSelectedRangeData({rowIndex:h,colIndex:r.colIndex},v,-1,r.colIndex);for(ut=s.getSheet(i)._filterColl,f=u[0].colIndex,p=u[u.length-1].colIndex;f<=p;f++)b.push(f),tt=this._getFilterIcon(),h=h===0?1:h,d={rowIndex:h-1,colIndex:f},this._applyFilterIcon(d,tt),it.push(d);for(s.XLScroll._getColWidths(i,u[0].colIndex),b.length>1&&(e._multipleFiltering=!0),e._multifilterIdx=b,e._selectedCellIndexes=b,f=0,p=c.length;f<p;f++)if(c[f].tableID===a){l=f;rt=!0;break}rt?(o=c[l],o.startRow=r.rowIndex,o.endRow=v.rowIndex,o.multiFiltering=e._multipleFiltering,o.multifilterIdx=e._multifilterIdx,o.selectedCellIndexes=e._multifilterIdx,o.selectedRange=n.extend(!0,{},e._selectedRange),o.filteredRange=n.extend(!0,{},e.filterSettings.filteredRange),o.hiddenIdx=[],o.flterdIdxes=[],o.fColumns={},o.tableID=a,o.filterCollection=[]):(e.filterSettings.tableRange.push({filterCollection:[],startRow:h,endRow:v.rowIndex,tableID:-1,fColumns:{},flterdIdxes:[],multiFiltering:e._multipleFiltering,multifilterIdx:e._multifilterIdx,selectedCellIndexes:e._multifilterIdx,selectedRange:n.extend(!0,{},e._selectedRange),filteredRange:e.filterSettings.filteredRange,hiddenIdx:[]}),o=c[c.length-1]);o.filteredCells=it}return o},clearFilter:function(i){var r=this.XLObj,nt;if(!r.model.isReadOnly){var w=!1,s=r.getActiveSheetIndex(),a,c=r.getSheet(s),v=n.extend(!0,{},c._filterColl),b,h=c.filterSettings.tableRange,l=-1,u,f,k,d=[],p=r._dataContainer.sheets[s],e=r.getObjectKeys(v),o,y,g=[],tt=c.filterSettings.filteredRange,it=c.filterSettings.filteredColumns,rt=c.filterSettings.range;if(h.length){for(u=0;u<h.length;u++)if(h[u].tableID===-1){l=u;break}for(b=h[l].selectedRange,u=e.length-1;u>=0;u--)for(o=r.getObjectKeys(v[e[u]]),f=o.length-1;f>=0;f--)t.isNullOrUndefined(r.XLEdit.getPropertyValue(e[u],o[f],"tableName",s))&&(d.push({rowIndex:parseInt(e[u]),colIndex:parseInt(o[f])}),fltrdCol=v[e[u]][o[f]],fltrdCol.status.indexOf("e-ssfiltered")>-1&&(a=r.model.sheets[s].columns[o[f]].field,g.push({fieldName:a,predicate:h[l].predicate,filterCollection:h[l].filterCollection,action:"filtering",tableID:-1,predicate:r._excelFilter._predicates[s][a]}),delete r._excelFilter._predicates[s][a],r._dupDetails=!0,this._clearFilterColumn(a,"","","Or","","",-1),r._dupDetails=!1,w=!0),i==="remove"&&(delete v[e[u]][o[f]],delete p[e[u]][o[f]].isFilterHeader,delete p[e[u]][o[f]].filterState,delete p[e[u]][o[f]].isFilterVisible,r._isRowViewable(s,parseInt(e[u]))&&(y=r.getCell(parseInt(e[u]),parseInt(o[f])),n.isNumeric(r.XLEdit.getPropertyValue(parseInt(e[u]),parseInt(o[f])))&&y.addClass(r._rAlign),y.find(".e-filterspan").remove(),r.addClass(y[0],"e-wrapword"),r._removeClass(y[0],"e-filterhdr"))));i==="remove"&&(c._filterColl=v,l>-1&&(k=h.splice(l,1)[0]),r.model.allowComments&&r.XLComment._updateCmntArrowPos(),r._isUndoRedo||r._dupDetails||(nt={sheetIndex:s,operation:"remove-filter",status:i,process:"apply-filter",filteredCells:d,requestType:"filter",reqType:"filter",fRange:r.getSheet(s).filterSettings.range,filterRange:k,filterCollection:g,filteredCols:it,fltrdRange:tt,selRange:b},r._completeAction(nt)));w&&(n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").ejButton("disable"),n("#"+r._id+"_Ribbon_SortFilter").ejMenu("disableItemByID","Ribbon_ClearFilter"))}}},filter:function(n){var i=this.XLObj;if(i.model.allowFiltering&&!i.model.isReadOnly){var e=i.getActiveSheetIndex(),u=i.getSheet(e),o=!1,y=u._activeCell,f,c,h=u.filterSettings.tableRange,l,r,a,p,v,s;for(u._multipleFiltering=!1,u._multifilterIdx=[],f=i.XLEdit.getPropertyValue(y.rowIndex,y.colIndex,"tableName",e),t.isNullOrUndefined(f)||(f=i._getTableID(f)),r=0,a=h.length;r<a;r++)h[r].tableID===-1&&(o=!0),l=r;if(s={range:i._getRangeArgs(n,"string"),reqType:t.Spreadsheet.Actions.Filtering},i._trigActionBegin(s))return!0;if(n=s.range,o&&(this.clearFilter("remove"),u.filterSettings.filteredRange=[],u._selectedRange={},u._selectedCellIndexes=[],u.filterSettings.filteredColumns=[],i._excelFilter._predicates[e]={}),!t.isNullOrUndefined(f)&&f>-1){for(p=h[l].startRow,c=h[l].multifilterIdx,r=0,a=c.length;r<colLen;r++)v=this._getFilterHeader(e,p,c[r]),!t.isNullOrUndefined(v)&&v.status.indexOf("e-ssfiltered")>-1&&this._clearFilterColumn(u.columns[r].field,"","","","","",f);this._clearFilterTableIcon(e,f);o=!0}if(o){if(s={sheetIdx:e,reqType:"clear-Filter"},i._trigActionComplete(s))return}else this._filterCellRange(e,n);i._isFiltered=!o;i.model.allowComments&&i.XLComment._updateCmntArrowPos()}},_applyFilterIcon:function(n,t){var r=this.XLObj,s=this.XLObj._rAlign,e=r.getActiveSheetIndex(),i=n.rowIndex,u=n.colIndex,h=r.getSheet(e),o=r._isRowViewable(e,i),f=h._filterColl;o&&(activeEle=r.getCell(i,u,e),activeEle[0].insertBefore(t[0],activeEle[0].childNodes[activeEle[0].childNodes.length-1]),activeEle.addClass("e-filterhdr"),activeEle.removeClass("e-wrapword"),activeEle.removeClass("e-ralign"));r.XLEdit._updateDataContainer({rowIndex:i,colIndex:u},{dataObj:{isFilterHeader:!0,filterState:"filter",isFilterVisible:!0},sheetIdx:e});r.isNumber(r.model.allowFiltering&&r.XLEdit.getPropertyValue(i,u,"value2",e))&&o&&r._removeClass(activeEle[0],s);i in f||(f[i]={});u in f[i]||(f[i][u]={});f[i][u].status="e-ssfilter";f[i][u].isTable=t[0].className.indexOf("e-ft")>-1},_postionFilterIcon:function(n,t){var i=this.XLObj,u=n||i.getActiveCellElem(),o=t||u.find(".e-filterspan"),f,e,r=i._getCellIdx(u[0]);i.model.allowResizing&&(f=i.XLResize._getContentWidth(r.colIndex,i.getActiveSheetIndex(),r.rowIndex,r.rowIndex),e=i.XLResize._getContentHeight(r.rowIndex,i.getActiveSheetIndex()))},_filterCellRange:function(n,i){var e=this.XLObj,u,w=!1,nt,tt,b,it,k=[],s=-1,rt=!1,ut=0,ft,f,h,a,et,y,v,p,o,r=e.getSheet(n),ot=[],st=!1,c,l=[],d=[],g=!1,ht={sheetIndex:n,reqType:"filter",operation:"apply-filter"};if(t.isNullOrUndefined(i)){if(!e.model.allowSelection)return;u=r._selectedCells}else y=e.getRangeIndices(i),u=e._getSelectedRange({rowIndex:y[0],colIndex:y[1]},{rowIndex:y[2],colIndex:y[3]});for(u.length<2&&(c=u,t.isNullOrUndefined(i)||e.performSelection(i,n),e.selectAll(!1),u=r._selectedCells,st=!0),f=u[0].colIndex,a=u[u.length-1].colIndex;f<=a;f++){if(k.push(f),s=u[0].rowIndex,st)r._isSheetSelected||(l.push(f),r._multifilterIdx.push(f),w=!0);else{if(!rt||k.length>0)for(h=s,et=u[u.length-1].rowIndex;h<=et;h++)it=e._isRowVisible(n,h),it&&(e.XLEdit.getPropertyValue(h,f,"value2",n)||l.length&&e.XLEdit.getPropertyValue(0,f,"isCHide",n))&&((s===-1||s>h)&&(s=h),rt=!0,w=!0,g=!0),s<h&&ut===0&&ot.push(h);g&&(l.push(f),r._multifilterIdx.push(f),g=!1)}ut++}if(l.length>1&&(r._multipleFiltering=!0),d=[],w){for(f=0,a=l.length;f<a;f++)ft=this._getFilterIcon(),this._applyFilterIcon({rowIndex:s,colIndex:l[f]},ft),d.push({rowIndex:s,colIndex:l[f]});for(v={rowIndex:s+1,colIndex:u[0].colIndex},p={rowIndex:u[u.length-1].rowIndex},r._selectedRange={startRow:v.rowIndex,endRow:p.rowIndex,dataSourceIndexes:ot},this._getSelectedRangeData(v,u[u.length-1],-1,v.colIndex),r._selectedCellIndexes=k,ht={sheetIndex:n,filteredCells:d,reqType:"filter",operation:"apply-filter",tableID:-1},b=r.filterSettings.tableRange,f=0,a=b.length;f<a;f++)b[f].tableID===-1&&(nt=!0,tt=f);nt?(o=r.filterSettings.tableRange[tt],o.startRow=v.rowIndex,o.endRow=p.rowIndex,o.multiFiltering=r._multipleFiltering,o.multifilterIdx=r._multifilterIdx,o.selectedCellIndexes=r._multifilterIdx,o.selectedRange=r._selectedRange,o.filteredRange=r.filterSettings.filteredRange,o.filteredColumns=r.filterSettings.filteredColumns,o.predicate=e._excelFilter._predicates[n],o.hiddenIdx=[],o.flterdIdxes=[],o.fColumns={},o.filterColumnName=[],o.filterCollection=[]):r.filterSettings.tableRange.push({filterCollection:[],startRow:v.rowIndex,endRow:p.rowIndex,tableID:-1,multiFiltering:r._multipleFiltering,multifilterIdx:r._multifilterIdx,selectedCellIndexes:r._multifilterIdx,selectedRange:r._selectedRange,filteredRange:r.filterSettings.filteredRange,filteredColumns:r.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],fltrdIdxes:[],filterColumnName:[]});e.XLScroll._getColWidths(n,r._multifilterIdx[0]);r._isImported&&!r._isLoaded||e._isExport||(i=c?[c[0].rowIndex,c[0].colIndex,c[c.length-1].rowIndex,c[c.length-1].colIndex]:e.isUndefined(i)?[u[0].rowIndex,u[0].colIndex,u[u.length-1].rowIndex,u[u.length-1].colIndex]:e.getRangeIndices(i),e._completeAction(ht),t.isNullOrUndefined(i)||e.performSelection(i,n))}else e._showAlertDlg("Alert","Alert","",440)},openFilterDialog:function(n){var t,i=this.XLObj;i.model.isReadOnly||(typeof n=="string"&&(n=i.getRangeIndices(n)),t=i.getCell(n[0],n[1]).find("span.e-filterspan"),t.length>0&&this._filterClickHandler({target:t[0]}))},_filterClickHandler:function(i){var u=this.XLObj,d,g,w=n(i.target),o=u.getActiveSheetIndex(),e=u.getSheet(o),ft=!1,c,y,b,et,l,nt,tt,a,it,h,s,f,ot=[],st={},rt,ut,k,v,p,ht=u.model.scrollSettings.allowVirtualScrolling,ct=n(i.target).position(),lt=u.getSheetElement(o).find(".e-spreadsheetcontentcontainer").position(),r;if((y=u._generateHeaderText(i.target.parentNode.cellIndex+1),this._isDecimal=!1,(!u.model.allowLockCell||!u.getSheet(o).isSheetProtected)&&!u.preventFilterPopup)&&(w[0].className.indexOf("e-ssfiltered")>-1&&(ft=!0),a=i.target.parentNode.cellIndex,w[0].className.indexOf("e-ssfilter")>-1)){for(f=u.model.sheets[o].filterSettings.tableRange,d=u._getCellIdx(w.parent()[0]),g=u.XLEdit.getPropertyValue(d.rowIndex,d.colIndex,"tableName"),h=t.isNullOrUndefined(g)?-1:parseInt(g.replace("e-table","")),r=0,l=f.length;r<l;r++)f[r].tableID===h&&(v=r,f[r].multiFiltering?(nt=f[r].multifilterIdx[0],tt=f[r].multifilterIdx[f[r].multifilterIdx.length-1]):nt=tt=i.target.parentNode.cellIndex,ut={rowIndex:f[r].startRow,colIndex:nt},k={rowIndex:f[r].endRow,colIndex:tt},e._multipleFiltering=f[r].multiFiltering,e._multifilterIdx=f[r].multifilterIdx,s=e._selectedRange=f[r].selectedRange,e.filterSettings.filteredRange=f[r].filteredRange,e._selectedCellIndexes=f[r].selectedCellIndexes);if(h===-1){if(p=this._createSelection(o,s.startRow,s.endRow,a,s.dataSourceIndexes),c=p.endRowIndex>s.endRow?p.endRowIndex-1:p.endRowIndex,s.endRow!=c)for(r=s.endRow+1;r<=c;r++)it={field:y,value:u.XLEdit.getPropertyValue(r,a,"value2",o),matchcase:!1,operator:"equal",predicate:"or"},e.filterSettings.filteredColumns.push(it),f[v].filteredColumns.push(it),f[v].selectedRange.endRow=c;k={rowIndex:c,colIndex:a};f[v].selectedRange=e._selectedRange={startRow:ut.rowIndex,endRow:k.rowIndex,dataSourceIndexes:p.filteredIndex};f[v].endRow=c}for(this._getSelectedRangeData(ut,k,h,a),b=e.columns,et=this._getColumnType(o,s.startRow,s.endRow,a),r=0,l=b.length;r<l;r++)if(b[r].field===y){u._$colType=et;u._$curFieldName=b[r].field;break}for(u._showDialog(u._id+"_Filter",u._$colType),rt=u._getXYPos(w,n("#"+u._id+u._$colType+"_excelDlg"),18,18),f=u.model.sheets[o].filterSettings.tableRange,r=0,l=f.length;r<l;r++)f[r].tableID===h&&(ot=f[r].filteredColumns,st=f[r].predicate);u._excelFilter._predicates[o]=st;this._isSearchEdit=!0;u._phoneMode||u._tabMode?(u.XLRibbon._refreshFltrDlg(),this._openNormalFilterDlg(y,u._$colType,h,v)):u._excelFilter.openXFDialog({field:y,dataSource:e.filterSettings.filteredRange?e.filterSettings.filteredRange:e.dataSource,position:{X:rt.xPos,Y:rt.yPos},type:u._$colType,format:u._$colFormat,filteredColumns:ot,sortedColumns:[],key:o,tableID:h,selectedColors:e._selectedCellColors,isFiltered:ft,blank:"",enableColor:!0,filteredByColor:e._filteredByColor})}},_cancelHandler:function(){this._isSearchEdit=!1},applyFilter:function(n){var i=this.XLObj,u=t.Predicate(n.field,n.operator,n.value,!n.matchcase),e,f=[],r=i.getActiveSheetIndex();e=i.model.sheets[r].filterSettings.tableRange;i._isFiltered||i.XLFilter.filter(n.filterRange);t.isNullOrUndefined(i._excelFilter._predicates[r])&&(i._excelFilter._predicates[r]={},i._excelFilter._predicates[r][n.field]={});i._excelFilter._predicates[r][n.field]=u;f.push({actualFilterOperator:n.operator,actualFilterValue:n.value,actualPredicate:n.predicate,field:n.field,isCustom:!0,matchcase:n.matchcase,operator:n.operator,predicate:n.predicate,value:n.value});this._filterHandler({action:"filtering",fieldName:n.field,tableID:-1,ejpredicate:u,filterCollection:f})},_filterHandler:function(i){var d,b,it,s,k,f,a,y,rt,ut,ft;if(!i.originalEvent||(d=i.originalEvent.target.parentElement.className,!d||!(d.indexOf("hdr")>-1))){var f,a,e,et=!1,o=-1,g,h,u={},ot,r=this.XLObj,l=r.getActiveSheetIndex(),v=r.getSheet(l),st,nt,tt,c=[],p={},w;for(u.requestType=i.action==="sorting"||i.action==="filterbycolor"?i.action:"filtering",e=v.filterSettings.tableRange,r.XLFilter._isSearchEdit=!1,f=0,a=e.length;f<a;f++)e[f].tableID===i.tableID&&(n.extend(!0,c,e[f].filteredColumns),p=e[f].predicate,et=!0,o=f);if(u.tableID=i.tableID,i.action==="filtering"||i.action==="clearfiltering"){for(u.rowIndex=e[o].startRow-1,u.colIndex=r._generateColCount(i.fieldName)-1,ot=t.DataManager(c),st=(new t.Query).where("field",t.FilterOperators.equal,i.fieldName),nt=ot.executeLocal(st),u.filteredColumns=c,f=0,a=nt.length;f<a;f++)tt=n.inArray(nt[f],c),tt>=0&&c.splice(tt,1);i.action==="clearfiltering"?delete r._excelFilter._predicates[l][i.fieldName]:t.merge(c,i.filterCollection);p=r._excelFilter._predicates[l]}if(et)if(e[o].filteredColumns=c,e[o].filterCollection=i.filterCollection,e[o].predicate=p,e[o].action=i.action,c.length<1)for(b=e[o].multifilterIdx,f=b[0];f<=b[b.length-1];f++)it=r._generateHeaderText(f+1),t.isNullOrUndefined(e[o].fColumns[it])||(e[o].fColumns[it]=[]);else e[o].fColumns[i.fieldName]=n.extend(!0,[],c);if(h=v.filterSettings.tableRange[o].selectedRange,s=v.filterSettings.tableRange[o].selectedCellIndexes,k=v._filterColl,i.action==="filtering"||i.action==="clearfiltering")u.currentFilteringColumn=i.fieldName,u.ejpredicate=i.ejpredicate,u.filterCollection=n.extend(!0,[],i.filterCollection),u.action=i.action,u.reqType="filter",u.sheetIndex=l,u.filteredcolumns=c,u.predicate=p;else if(i.action==="sorting"){if(!r.model.allowSorting)return;if(u.requestType=u.action=i.action,g=r.XLEdit.getColumnIndexByField(i.sortDetails.field),r.XLSort._isSortByFilter=!0,r.XLSort.sortByRange(r.swapRange([h.startRow,s[0],h.endRow,s[s.length-1]]),i.sortDetails.field,i.sortDetails.direction,i.tableID))return;for(this._changeSortIcon({rowIndex:h.startRow-1,colIndex:g},i.sortDetails.direction),f=0,a=s.length;f<a;f++)s[f]!=g&&(k[h.startRow-1][s[f]].status.indexOf("-asc")>-1||k[h.startRow-1][s[f]].status.indexOf("-dsc")>-1)&&(k[h.startRow-1][s[f]].status="e-ssfilter",r._isRowViewable(l,h.startRow-1)&&(w=r.getCell(h.startRow-1,s[f]).find(".e-filterspan")[0],r._removeClass(w,"e-ssfilter-asc"),r._removeClass(w,"e-ssfilter-dsc"),r.addClass(w,"e-ssfilter")))}else{if(u.requestType=u.action=i.action,u.range=v._selectedRange,r.model.allowSorting&&r.XLSort._sortRangeAlert([h.startRow,s[0],h.endRow,s[s.length-1]]))return;i.action==="sortbycolor"?(u.sortColumn=i.sortDetails.field,u.operation=i.sortDetails.operation,y=i.sortDetails.color.replace("rgb(","").replace(")","").split(",")):(r._isUndoRedo?(u.filterColumn=i.columnName,u.operation=i.operation):(u.filterColumn=i.filterDetails.field,u.operation=i.filterDetails.operation,y=i.filterDetails.color.replace("rgb(","").replace(")","").split(",")),u.tableID=i.tableID,r.model.sheets[l]._filteredByColor=u.filterColumn);r._isUndoRedo||(rt=y[0],ut=y[1],ft=y[2]);u.operation==="sortbgcolor"||u.operation==="filterbgcolor"?u.bgcolor=r._isUndoRedo?i.bgcolor:this._convertrgbtohex(parseInt(rt),parseInt(ut),parseInt(ft)):u.fgcolor=r._isUndoRedo?i.fgcolor:this._convertrgbtohex(parseInt(rt),parseInt(ut),parseInt(ft))}u.oprType="filter";u.selRange=r._getAlphaRange(l,e[o].startRow-1,e[o].multifilterIdx[0],e[o].endRow,e[o].multifilterIdx[e[o].multifilterIdx.length-1]);i.action!=="sorting"&&r._processBindings(u)&&(c=temp);i.action==="clearfiltering"&&(r.XLRibbon._isFilterSelect.status=!1);r.model.allowComments&&r.XLComment._updateCmntArrowPos();r.XLSelection._refreshBorder();r.model.showRibbon&&r.XLRibbon._refreshRibbonIcons();r._isFrozen(r.getFrozenRows())&&r.XLFreeze._refreshFreezeRowDiv()}},_convertrgbtohex:function(n,t,i){return"#"+(16777216+(n<<16)+(t<<8)+i).toString(16).slice(1)},_clearFilterColumn:function(i,r,u,f,e,o,s){var c=this.XLObj,a,l={},h,k,w=c.getActiveSheetIndex(),v=c.getSheet(w),tt=!1,d={},it,rt,g,nt,y=v.filterSettings.tableRange,p=[],b,ut;for(l.requestType=t.Grid.Actions.Filtering,l.currentFilterObject=[],n.isArray(r)||(r=n.makeArray(r)),n.isArray(u)||(u=n.makeArray(u)),this._currentFilterColumn=this._getColumnByField(w,i),b=0,ut=r.length;b<ut;b++)if(d={field:i,operator:r[b],value:u[b],matchcase:e,predicate:f,actualFilterValue:o},!tt){for(h=0,k=y.length;h<k;h++)y[h].tableID===s&&(a=y[h],n.extend(!0,p,y[h].filteredColumns),c._excelFilter._predicates[w]=y[h].predicate,v.filterSettings.filteredRange=v.filterSettings.tableRange[h].filteredRange,v._selectedCellIndexes=y[h].selectedCellIndexes,v._selectedRange=y[h].selectedRange,v._multifilterIdx=y[h].multifilterIdx);for(it=t.DataManager(p),rt=(new t.Query).where("field",t.FilterOperators.equal,d.field),g=it.executeLocal(rt),h=0,k=g.length;h<k;h++)nt=n.inArray(g[h],p),nt!==-1&&p.splice(nt,1)}c._isUndoRedo&&c.isUndefined(a)||(tt=!0,delete c._excelFilter._predicates[w][i],a.filteredColumns=p,a.predicate=c._excelFilter._predicates[w],l.currentFilterObject.push(d),l.filterCollection=p,l.currentFilteringColumn=i,l.filteredcolumns=p,l.action="clearfiltering",l.reqType="filter",l.tableID=s,l.selRange=c._getAlphaRange(w,a.startRow-1,a.multifilterIdx[0],a.endRow,a.multifilterIdx[a.multifilterIdx.length-1]),c._processBindings(l)&&(v.filterSettings.filteredColumns.reverse().splice(0,r.length),v.filterSettings.filteredColumns.reverse()),c.model.allowComments&&c.XLComment._updateCmntArrowPos(),this.XLObj.XLSelection._refreshBorder())},_getFilterHeader:function(n,i,r){var f=this.XLObj,e=f.getSheet(n),u=e._filterColl;if(!t.isNullOrUndefined(u[i])&&!t.isNullOrUndefined(u[i][r]))return u[i][r]},_filterTable:function(i,r){var h=this.XLObj,f=h.getSheet(i),c=[],v=!1,y=!1,o,l,p,a,s,e,u,w;for(f._multipleFiltering=!1,f._multifilterIdx=[],s=n.extend(!0,{},f._endCell),e=n.extend(!0,{},f._startCell),u=e.colIndex;u<=s.colIndex;u++)a=this._getFilterHeader(i,e.rowIndex,u),!t.isNullOrUndefined(a)&&a.status.indexOf("e-ssfilter")>-1?v=!0:(l=this._getFilterIcon(),p="e-ft"+r,l.addClass(p),this._applyFilterIcon({rowIndex:e.rowIndex,colIndex:u},l),c.push(u),f._multifilterIdx.push(u));if(h.XLScroll._getColWidths(i,e.colIndex),!v)if(c.length>1&&(f._multipleFiltering=!0,y=!0),e.rowIndex=e.rowIndex+1,this._getSelectedRangeData(e,s,r,e.colIndex),h._isFATResize){if(o=f.filterSettings.tableRange,o.length)for(u=0,w=o.length;u<w;u++)if(o[u].tableID===r){o[u].endRow=s.rowIndex;break}h._isFATResize=!1}else f.filterSettings.tableRange.push({filterCollection:[],startRow:e.rowIndex,endRow:s.rowIndex,tableID:r,multiFiltering:y,multifilterIdx:c,selectedCellIndexes:c,selectedRange:n.extend(!0,{},f._selectedRange),filteredRange:f.filterSettings.filteredRange,filteredColumns:f.filterSettings.filteredColumns,fColumns:{},predicate:{},hiddenIdx:[],filterColumnName:[]})},_clearFilterTable:function(n,t,i){var e=this.XLObj.getSheet(n?n:this.getActiveSheetIndex()),u,r,f;for(u=e.filterSettings.tableRange,r=0,f=u.length;r<f;r++)u[r].tableID===t&&(this._clearAllFilter(n,r,i),f=u.length)},_clearAllFilter:function(i,r,u){var s=this.XLObj,a=s._dataContainer.sheets[i],c=s.getSheet(i),h=c.filterSettings.tableRange,l,y,f,p,w,e,o,v;for(c._selectedRange=h[r].selectedRange,e=h[r].multifilterIdx,o=h[r].startRow,f=0,p=e.length;f<p;f++)w=c.columns[e[f]].field,v=s.XLEdit.getPropertyValue(o-1,e[f],"filterState"),!t.isNullOrUndefined(v)&&v.indexOf("filtered")>-1&&this._clearFilterColumn(w,"","","Or","","",h[r].tableID),u||(s._isRowViewable(i,o-1)&&(l=s.getCell(o-1,e[f]),s.addClass(l[0],"e-wrapword"),y=l.find(".e-filterspan"),n(y).remove(),l.removeClass("e-filterhdr")),a[o-1][e[f]]&&(delete a[o-1][e[f]].isFilterHeader,delete a[o-1][e[f]].filterState),delete c._filterColl[o-1][e[f]]);u||(h.splice(r,1),len=h.length)},_clearFilterTableIcon:function(n,t){for(var i=this.XLObj,h,c,l=i.getSheet(n),u=l.filterSettings.tableRange,e,o,f,a,s,r=0,v=u.length;r<v;r++)if(u[r].tableID===t)for(l._selectedRange=u[r].selectedRange,l.filterSettings.filteredRange=u[r].filteredRange,e=u[r].multifilterIdx,o=u[r].startRow,f=0,a=e.length;f<a;f++)h=i.XLEdit.getPropertyValue(o-1,e[f],"isFilterVisible"),i._isRowViewable(n,o-1)&&(s=i.getCell(o-1,e[f]),c=s.find(".e-filterspan"),h?(c.hide(),i._removeClass(s[0],"e-filterhdr")):(i.addClass(s[0],"e-filterhdr"),c.show())),i.XLEdit._updateDataContainer({rowIndex:o-1,colIndex:e[f]},{dataObj:{isFilterVisible:!h}})},_insertFilterIcon:function(n,t,i){var r;r=this._getFilterIcon();i.tableID>-1&&this.XLObj.XLEdit._updateDataContainer({rowIndex:n,colIndex:t},{dataObj:{tableName:"e-table"+i.tableID}});this._applyFilterIcon({rowIndex:n,colIndex:t},r)},_changeFilterIcon:function(n,t,i){var f,s,h,c=!1,r=this.XLObj,u=n.rowIndex,e=n.colIndex,l=r._rAlign,o=r.getActiveSheetIndex();h=this._getFilterHeader(o,u,e).status;r._isRowViewable(o,u)&&(s=r.getCell(u,e),f=s.find(".e-filterspan")[0],s.removeClass(l),c=!0);t==="filter"?i.indexOf("filtered")<0&&(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:e},{dataObj:{filterState:i.replace("filter","filtered")}}),r.getSheet(o)._filterColl[u][e].status=h.replace("e-ssfilter","e-ssfiltered"),c&&(f.className=f.className.replace("e-ssfilter","e-ssfiltered"))):(r.XLEdit._updateDataContainer({rowIndex:u,colIndex:e},{dataObj:{filterState:i.replace("filtered","filter")}}),r.getSheet(o)._filterColl[u][e].status=h.replace("e-ssfiltered","e-ssfilter"),c&&!r.isUndefined(f)&&(f.className=f.className.replace("e-ssfiltered","e-ssfilter")))},_changeSortIcon:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),r,i,e,o=!1,s=u.getSheet(h)._filterColl,f;i=s[n.rowIndex][n.colIndex].status;r=i.indexOf("e-ssfiltered")>-1?12:10;e=i.substr(0,r);u._isRowViewable(h,n.rowIndex)&&(f=u.getCell(n.rowIndex,n.colIndex).find(".e-filterspan")[0],i=f.className,r=i.indexOf("e-ssfilter")+r,o=!0);t==="ascending"?(s[n.rowIndex][n.colIndex].status=e+"-asc",o&&(f.className=i.substr(0,r)+"-asc")):(s[n.rowIndex][n.colIndex].status=e+"-dsc",o&&(f.className=i.substr(0,r)+"-dsc"))},_extendFilterRange:function(n,t){var o=this.XLObj,u,r=o.getSheet(o.getActiveSheetIndex()).filterSettings.tableRange,i,e,f;if(r.length)for(i=0,f=r.length;i<f;i++)if(r[i].tableID==n){if(r[i].endRow<t[2]&&(u=r[i].selectedRange.dataSourceIndexes,r[i].endRow=r[i].selectedRange.endRow=t[2],u[u.length-1]<r[i].endRow))for(e=u[u.length-1],f=r[i].endRow;e<f;e++)u.push(e+1);break}},_checkFilteredCells:function(i){for(var u,b,c=this.XLObj,s=c.getSheet(i),l=s._selectedCells,d=new RegExp("\\be-table.*?\\b","g"),e,o=[-1],f=s.filterSettings.tableRange,h=s.selectedRange,a=!1,y=[],p,w,k=s.tableManager,r=0,v=l.length;r<v;r++)e=c.XLEdit.getPropertyValue(l[r].rowIndex,l[r].colIndex,"tableName",i),t.isNullOrUndefined(e)||(e=c._getTableID(e),o.indexOf(e)>-1&&o.push(e));for(r=0,v=o.length;r<v;r++)for(u=0,b=f.length;u<b;u++)if(f[u].tableID===o[r]){f[u].startRow===h[0]&&f[u].multifilterIdx[0]===h[1]&&f[u].endRow===h[2]&&f[u].multifilterIdx[f[u].multifilterIdx.length]===h[3]?(a=!0,p=n.extend(!0,{},k[o[r]]),w=n.extednd(!0,{},f[u]),y.push({tableID:o[r],tabObj:p,tabObj2:w})):a=!1;break}return tabDetails={isApplied:a,clrTable:y}},_moveFilteredCells:function(n,t){for(var u=t.clrTable,f,e,i=this.XLObj,r=0,o=u.length;r<o;r++)if(u[r].tableID>-1)i.XLFormat.removeTable(u[r].tableID),i.XLFormat.createTable(u[r].tableObj,newRng);else for(tabObj2=u[r].tabObj2,j=tabObj2.multifilterIdx[0],o=tabObj2.multifilterIdx[tabObj2.multifilterIdx.length-1];j<=o;j++)f=i._generateHeaderText(tabObj2.multifilterIdx[j]),delete i._excelFilter._predicates[n][f],i.XLFilter._clearFilterColumn(f,"","","Or",null,null,u[r].tableID),i._isRowViewable(n,tabObj2.startRow-1)&&(e=i.getCell(tabObj2.startRow-1,j,n),e.find("span.e-ssfilter").remove(),e.addClass(this._rAlign))},_updateFilterIcons:function(t,i,r,u){for(var o=this.XLObj,f,s,h=n("#"+o._id+"numberSelectAll").ejCheckBox("instance"),l=h?!1:h.model.checked,c=n("#"+o._id+"stringSelectAll").ejCheckBox("instance"),a=c?!1:c.model.checked,e=t;e<=i;e++){s={rowIndex:e,colIndex:r};f=o.XLEdit.getPropertyValue(e,r,"filterState");f.indexOf("filtered")>-1&&(u=="clearfiltering"||l||a)?this._changeFilterIcon(s,"filtered",f):f.indexOf("filtered")<0&&u!="clearfiltering"&&this._changeFilterIcon(s,"filter",f);break}},_fltrRowHighlight:function(t,i,r){var f=this.XLObj,c=f.getActiveSheetIndex(),h=f._getJSSheetRowHeaderContent(c),l=h.find("table tr:gt("+(t-1)+"):lt("+(i-t+1)+")"),e=f.model.sheets[c].filterSettings.tableRange,a,u,s=f.model.sheets[c].filteredRowsCollection,o;if(f.model.scrollSettings.allowVirtualScrolling&&(l=h.find("table tr").filter(function(){return n(this).attr("idx")>=t&&n(this).attr("idx")<=i})),r==="clear"){if(l.find("td").removeClass("e-filterhiglight"),f.clearRangeData([t,0,i,0],["isFilterHighlight"]),s.length)for(o=0;o<s.length;o++)for(u=0,a=e.length;u<a;u++)s[o]>=e[u].startRow&&s[o]<=e[u].endRow&&!f.XLEdit.getPropertyValue(s[o],0,"isRHide")&&(f.updateUniqueData({isFilterHighlight:!0},[e[u].startRow,0,e[u].endRow,0]),f.model.scrollSettings.allowVirtualScrolling?h.find("table tr").filter(function(){return n(this).attr("idx")>=e[u].startRow&&n(this).attr("idx")<=e[u].endRow}).find("td").addClass("e-filterhiglight"):h.find("table tr:gt("+(e[u].startRow-1)+"):lt("+(e[u].endRow-e[u].startRow+1)+")").find("td").addClass("e-filterhiglight"))}else r==="add"&&(l.find("td").addClass("e-filterhiglight"),f.updateUniqueData({isFilterHighlight:!0},[t,0,i,0]))},_checkFilterApplied:function(n,t,i,r,u,f){var s=this.XLObj,l=s.getSheet(n),o=l.filterSettings.tableRange,h,e,c;for(s._isFilterApplied=!1,e=0,c=o.length;e<c;e++)if(h=!1,chkObj=s._checkFilterMerge(n,[o[e].startRow-1,o[e].multifilterIdx[0],o[e].endRow,o[e].multifilterIdx[o[e].multifilterIdx.length-1]],t,i,r,u,f,"filter",h),s._isFilterApplied=!chkObj.isAlert,s._isFilterApplied)return},_updateFilterCollection:function(i,r,u,f,e){var l,h,v,p,g,nt,c=this.XLObj,a=c.getSheet(i),w=a.filterSettings.tableRange,o,s,rt=c.model.scrollSettings.allowVirtualScrolling,d,tt,it,b,y,k;if(u=u+1,f==="row")for(l=0,p=w.length;l<p;l++)o=w[l],s=o.multifilterIdx,e==="insert"?r<=o.endRow&&(o.endRow=o.endRow+u,r<o.startRow?(o.startRow=o.startRow+u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u})):r<=o.endRow&&(o.endRow=o.endRow-u,r<o.startRow?(o.startRow=o.startRow-u,o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})):o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})),startCell={rowIndex:o.startRow,colIndex:s[0]},endCell={rowIndex:o.endRow,colIndex:s[s.length-1]},this._getSelectedRangeData(startCell,endCell,o.tableID),o.selectedRange=n.extend(!0,{},a._selectedRange),o.filteredRange=n.extend(!0,{},a.filterSettings.filteredRange);else for(it=c._dataContainer.sheets[i],b=0,l=0,p=w.length;l<p;l++){if(o=w[l],s=o.multifilterIdx,y=n.extend(!0,[],s),this._updateFilteredColumns(l,r,u,e),e==="insert"){if(r<=s[0]){for(h=s.length-1;h>=0;h--)s[b]=s[b]+u,b++;o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u,isInsertBefore:!0})}else if(r<=s[s.length-1])for(o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:u}),h=y[y.length-1],g=y[y.length-1]+u;h<=g;h++)s.indexOf(h)===-1&&s.push(h)}else if(r<=s[0]){for(h=0;h<s.length;h++)s[h]=s[h]-u;o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u,isInsertBefore:!0})}else if(r<=s[s.length-1]){for(v=r,nt=s[s.length-1];v<=nt;v++)tt=c._generateHeaderText(v+1),d=c.XLEdit.getPropertyValue(o.startRow-1,v,"filterState"),!t.isNullOrUndefined(d)&&d.indexOf("filtered")>-1&&this._clearFilterColumn(tt,"","","Or","","",o.tableID);for(s.splice(s.length-u,u),k=1;k<=u;k++)delete a._filterColl[o.startRow-1][s[s.length-1]+k];o.tableID>-1&&c.XLFormat._refreshTableRowCol({tid:o.tableID,pos:f,cnt:-u})}startCell={rowIndex:o.startRow,colIndex:s[0]};endCell={rowIndex:o.endRow,colIndex:s[s.length-1]};this._getSelectedRangeData(startCell,endCell,o.tableID);o.selectedRange=n.extend(!0,{},a._selectedRange);o.filteredRange=n.extend(!0,{},a.filterSettings.filteredRange);s.length<2&&(o.multiFiltering=!1)}},_updateFilteredColumns:function(t,i,r,u){var f=this.XLObj,k,nt=f.getActiveSheetIndex(),e=f.getSheet(nt).filterSettings.tableRange[t],v=n.extend(!0,[],e.filteredColumns),d=n.extend(!0,{},e.fColumns),l=n.extend(!0,{},e.fColumns),g,o,c,a;for(colIdxes=e.multifilterIdx,o=0,g=v.length;o<g;o++)colIdx=f.XLEdit.getColumnIndexByField(e.filteredColumns[o].field),i<=colIdx&&(u==="delete"?i===colIdx?v.splice(o,1):v[o].field=f._generateHeaderText(colIdx-r+1):v[o].field=f._generateHeaderText(colIdx+r+1));e.filteredColumns=v;var s,y,p,h,w,tt=f.getObjectKeys(e.fColumns),b=f.getObjectKeys(d);for(e.predicate=e.predicate,o=b.length-1;o>=0;o--)for(k=f.XLEdit.getColumnIndexByField(b[o]),c=i;c<i+r;c++)if(c<=k){for(s=n.extend(!0,[],d[b[o]]),a=0;a<s.length;a++)colIdx=f.XLEdit.getColumnIndexByField(s[a].field),c<=colIdx&&(u==="delete"?c===colIdx?s.splice(o,1):s[a].field=f._generateHeaderText(colIdx-r+1):s[a].field=f._generateHeaderText(colIdx+r+1));y=f.XLEdit.getColumnIndexByField(b[o]);h=f._generateHeaderText(y+1);u==="delete"?(p=y-r,c===y?(delete e.predicate[h],delete l[h]):(w=f._generateHeaderText(p+1),l[colHeaderTxt]=s,delete l[h],e.predicate[colHeaderTxt]=f._excelFilter.generatePredicate(s),delete e.predicate[h])):(p=y+r,w=f._generateHeaderText(p+1),l[w]=s,delete l[h],e.predicate[w]=f._excelFilter.generatePredicate(s),delete e.predicate[h])}e.fColumns=l},_renderCustomFilter:function(){var o,i=this.XLObj,r=i._id+"_filter_custom",u=n("#"+r),s=t.buildTag("div#"+r+"_content"),f=t.buildTag("input#"+r+"_filterBtn.e-filter",{},{},{type:"button",value:"Filter"}),e=t.buildTag("input#"+r+"_clearBtn.e-clear",{},{},{type:"button",value:"Clear"});u.append(s.append(t.buildTag("div.e-fltrbtndiv").append(f).append(e)));this._createButton("filter",f);this._createButton("clear",e);o=i._dlgHeight>400&&!i._phoneMode?400:i._responsiveHeight-2;u.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Filter"),width:i._dlgWidth,height:i._dlgHeight,cssClass:"e-ss-dialog e-"+i._id+"-dlg",open:function(){n("#"+i._id+"_formatdlg_okbtn").focus()},close:t.proxy(this._customFltrDlgClose,this)})},_customFltrDlgClose:function(){n("#"+this.XLObj._id+"_filter_custom_"+this._colType).hide()},_refreshCustomFilter:function(i){var e=this.XLObj,r=e._id+"_filter_custom",u=t.buildTag("input#"+r+"_"+i+"_ddinput.e-"+e._id+"_customddl",{},{},{type:"text"}),f=t.buildTag("input#"+r+"_"+i+"_acString.e-filterval",{},{height:"26px",width:"100%"},{type:"text"}),o,s=n("#"+r+"_content");s.prepend(t.buildTag("div#"+r+"_"+i,"",{display:"none"}).append(t.buildTag("div.e-operdiv").append(u)).append(t.buildTag("div.e-textdiv").append(f)));u.ejDropDownList({dataSource:[{text:"Equal",value:"equal"},{text:"Not Equal",value:"notequal"},{text:"Less Than",value:"lessthan"},{text:"Less Than Or Equal",value:"lessthanorequal"},{text:"Greater Than",value:"greaterthan"},{text:"Greater Than Or Equal",value:"greaterthanorequal"},{text:"Between",value:"between"}],width:"100%",fields:{id:"value",text:"text",value:"value"},select:n.proxy(this._onNumFormatSelect,this),selectedItemIndex:0});switch(i){case"string":u.ejDropDownList("option",{dataSource:[{text:"Equal",value:"equal"},{text:"Not Equal",value:"notequal"},{text:"Starts With",value:"startswith"},{text:"Ends With",value:"endswith"},{text:"Contains",value:"contains"}],selectedItemIndex:0});f.ejAutocomplete({width:"100%",height:26,enableDistinct:!0,focusIn:function(){o=u.ejDropDownList("model.value")}});break;case"number":f.ejNumericTextbox({showSpinButton:!1,height:"26px",decimalPlaces:2,width:"100%"});break;case"boolean":$tchkBox.ejCheckBox({});break;case"date":f.ejDatePicker({width:"100%"})}},_createButton:function(n,i){var r=n=="filter"?t.proxy(this._fltrBtnHandler,this):t.proxy(this._fltrClrHandler,this);i.ejButton({size:"normal",type:"button",height:22,width:60,click:r,showRoundedCorner:!0})},_fltrBtnHandler:function(){var r=this.XLObj,e=r.getActiveSheetIndex(),i=r._id+"_filter_custom",u=n("#"+i+"_"+this._colType+"_ddinput").ejDropDownList("model.value"),f=n("#"+i+"_"+this._colType+"_acString").val();arg={action:"filtering",filterCollection:[{field:this._colName,matchcase:!0,operator:u,value:f,predicate:"or"}],fieldName:this._colName,ejpredicate:{field:this._colName,operator:u,value:f,isComplex:!1,ignoreCase:!1},tableID:this._tableId};r._excelFilter._predicates[e][this._colName]=t.Predicate(this._colName,u,f);this._filterHandler(arg);n("#"+i).ejDialog("close");n("#"+i+"_"+this._colType).hide()},_fltrClrHandler:function(){var i=this.XLObj,t=i._id+"_filter_custom",r=n("#"+t+"_"+this._colType+"_ddinput").ejDropDownList("model.value");this._clearFilterColumn(this._colName,"","","Or","","",this._tableId);n("#"+t).ejDialog("close");n("#"+t+"_"+this._colType).hide()},_openNormalFilterDlg:function(t,i,r,u){var f=this.XLObj,e=f._id+"_filter_custom";f.XLRibbon._refreshFltrDlg();n("#"+e+"_"+i).show();n("#"+e).ejDialog("open");n("#"+e+"_"+i+"_ddinput").ejDropDownList("option",{selectedItemIndex:0});this._colName=t;this._colType=i;this._tableId=r;i==="string"&&n("#"+e+"_"+i+"_acString").ejAutocomplete("option",{fields:{key:this._colName,text:this._colName},dataSource:f.getSheet(f.getActiveSheetIndex()).filterSettings.tableRange[u].filteredRange})}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.ribbon=function(n){this.XLObj=n;this._appTabCollection={};this._tabCollection=[];this._contextualTabCollection=[];this._smallBtnHeight=25;this._mediumBtnHeight=35;this._bigBtnHeight=75;this._splitBtnHeight=75;this._dropDownHeight=25;this._ribbonState=!0;this._isSetModel=!1;this._isDesignTab=!0;this._isDirtySelect=!1;this._isMergeSelect=!1;this._isFilterSelect={};this._hasTitle="";this._isNmgrid="";this._isPanelVisible=!1;this._ctrlCreated=!1;this._homeBtnIds=["Home_Clipboard_Paste","Home_Font_IncreaseFontSize","Home_Font_DecreaseFontSize","Home_Alignment_DecreaseIndent","Home_Alignment_IncreaseIndent","Home_Number_IncreaseDecimal","Home_Number_DecreaseDecimal","Home_Actions_Undo","Home_Actions_Redo","Home_Number_Accounting","Home_Number_CommaStyle","Home_Number_Percentage","Home_Clipboard_Cut","Home_Clipboard_Copy"];this._homeSptBtnIds=["Home_Clipboard_PasteOptions","Home_Font_Border","Home_Styles_ConditionalFormatting","Home_Styles_FormatAsTable","Home_Styles_CellStyles","Others_Editing_FindSelect","Home_Editing_Clear","Home_Alignment_Merge","Home_Editing_SortFilter","Home_Editing_AutoSum"];this._homeToggleBtnIds=["Home_Font_Bold","Home_Font_Italic","Home_Font_Underline","Home_Font_StrikeThrough","Home_Alignment_AlignLeft","Home_Alignment_AlignRight","Home_Alignment_AlignCenter","Home_Alignment_TopAlign","Home_Alignment_MiddleAlign","Home_Alignment_BottomAlign","Home_Alignment_WrapText","Home_Clipboard_FormatPainter"];this._homeDdIds=["Home_Number_NumberFormat","Home_Font_FontSize","Home_Font_FontFamily"];this._homeCpIds=["Home_Font_FillColor","Home_Font_FontColor"];this._insertBtnIds=["Insert_Tables_PivotTable","Insert_Tables_Table","Insert_Links_Hyperlink","Insert_Illustrations_Pictures"];this._insertSptBtnIds=["Insert_Charts_ColumnChart","Insert_Charts_BarChart","Insert_Charts_StockChart","Insert_Charts_LineChart","Insert_Charts_AreaChart","Insert_Charts_PieChart","Insert_Charts_ScatterChart"];this._dataBtnIds=["Data_SortFilter_SortAtoZ","Data_SortFilter_SortZtoA","Data_SortFilter_Filter","Data_SortFilter_ClearFilter","Data_DataTools_DataValidation"];this._dataSptBtnIds=["Data_DataTools_DataValidationOptions"];this._pageLayChckBxIds=["PageLayout_Show_Headings","PageLayout_Show_Gridlines"];this._pageLayBtnIds=["PageLayout_PageLayout_PageSize","PageLayout_Print_Print","PageLayout_Print_PrintSelected"];this._pageLaySptBtnIds=["PageLayout_PageLayout_PageSizeOptions"];this._reviewTglBtnIds=["Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","Review_Changes_LockCell"];this._cmntBtnIds=["Review_Comments_NewComment","Review_Comments_DeleteComment","Review_Comments_PreviousComment","Review_Comments_NextComment","Review_Comments_ShowHideComment"];this._cmntTglBtnIds=["Review_Comments_ShowAllComments"];this._othersBtnIds=["Others_Cells_InsertCell","Others_Cells_DeleteCell","Others_Formulas_NameManager","Others_Formulas_DefineName","Others_CalCulation_CalculateNow","Others_CalCulation_CalculateSheet"];this._othersSptBtnIds=["Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect","Others_Window_FreezePanes","Others_CalCulation_CalculationOptions"];this._contextualBtnIds=["Design_Tools_ResizeTable","Design_Tools_ConvertToRange"];this._contextualInputIds=["Ribbon_Design_Properties_TableName"];this._contextualCheckBoxIds=["Design_TableStyleOptions_FirstColumn","Design_TableStyleOptions_LastColumn","Design_TableStyleOptions_TotalRow","Design_TableStyleOptions_FilterColumn"];this._protectStateBtnIds=["Home_Clipboard_Cut","Home_Clipboard_Copy","Others_Editing_FindSelect","Home_Clipboard_Paste","Home_Clipboard_PasteOptions","Home_Actions_Undo","Home_Actions_Redo","Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","PageLayout_Print_Print","PageLayout_Print_PrintSelected","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Cells_InsertCell","Others_Cells_DeleteCell"];this._chartDesignBtnIds=["ChartDesign_Data_SwitchRowColumn","ChartDesign_Data_SelectData","ChartDesign_Type_ChangeChartType"];this._chartDesignSptBtnIds=["ChartDesign_ChartLayouts_AddChartElement"];this._chartDesignDdIds=["ChartDesign_ChartThemes_ChartThemes"];this._formatBtnIds=["Format_Adjust_ChangePicture"];this._formatSptBtnIds=["Format_Adjust_ResetPicture","Format_Border_PictureBorder"];this._pasteMenuData=[{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:null},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:null}];this._fontFamily=[{value:"1",text:"Angsana New"},{value:"2",text:"Arial"},{value:"3",text:"Arial Black"},{value:"4",text:"Batang"},{value:"5",text:"Book Antiqua"},{value:"6",text:"Browallia New"},{value:"7",text:"Calibri"},{value:"8",text:"Cambria"},{value:"9",text:"Candara"},{value:"10",text:"Century"},{value:"11",text:"Comic Sans MS"},{value:"12",text:"Consolas"},{value:"13",text:"Constantia"},{value:"14",text:"Corbel"},{value:"15",text:"Cordia New"},{value:"16",text:"Courier"},{value:"17",text:"Courier New"},{value:"18",text:"DilleniaUPC"},{value:"19",text:"Dotum"},{value:"20",text:"FangSong"},{value:"21",text:"Garamond"},{value:"22",text:"Georgia"},{value:"23",text:"Gulim"},{value:"24",text:"GungSuh"},{value:"25",text:"KaiTi"},{value:"26",text:"JasmineUPC"},{value:"27",text:"Malgun Gothic"},{value:"28",text:"Mangal"},{value:"29",text:"Meiryo"},{value:"30",text:"Microsoft JhengHei"},{value:"31",text:"Microsoft YaHei"},{value:"32",text:"MingLiu"},{value:"33",text:"MingLiU_HKSCS"},{value:"34",text:"MS Gothic"},{value:"35",text:"MS Mincho"},{value:"36",text:"MS PGothic"},{value:"37",text:"MS PMincho"},{value:"38",text:"PMingliU"},{value:"39",text:"PMingLiU-ExtB"},{value:"40",text:"SimHei"},{value:"41",text:"SimSun"},{value:"42",text:"SimSun-ExtB"},{value:"43",text:"Tahoma"},{value:"44",text:"Times"},{value:"45",text:"Times New Roman"},{value:"46",text:"Trebuchet MS"},{value:"47",text:"Verdana"},{value:"48",text:"Yu Gothic"},{value:"49",text:"Yu Mincho"}];this._fontSize=[{value:"8pt",text:"8"},{value:"9pt",text:"9"},{value:"10pt",text:"10"},{value:"11pt",text:"11"},{value:"12pt",text:"12"},{value:"14pt",text:"14"},{value:"16pt",text:"16"},{value:"18pt",text:"18"},{value:"20pt",text:"20"},{value:"22pt",text:"22"},{value:"24pt",text:"24"},{value:"26pt",text:"26"},{value:"28pt",text:"28"},{value:"36pt",text:"36"},{value:"48pt",text:"48"},{value:"72pt",text:"72"}];this._mergeMenuData=[{id:"MergeAndCenter",text:n._getLocStr("MergeAndCenter"),parentId:null,sprite:"e-icon e-ss-mergecenter"},{id:"MergeAcross",text:n._getLocStr("MergeAcross"),parentId:null,sprite:"e-icon e-ss-mergeacross"},{id:"MergeCells",text:n._getLocStr("MergeCells"),parentId:null,sprite:"e-icon e-ss-merge"},{id:"UnmergeCells",text:n._getLocStr("UnmergeCells"),parentId:null,sprite:"e-icon e-ss-unmerge"}];this._sortFltrMenuData=[{id:"Ribbon_SortAtoZ",text:this.XLObj._getLocStr("SortAtoZ"),parentId:null,sprite:"e-icon e-ssdrop-sortatoz"},{id:"Ribbon_SortZtoA",text:this.XLObj._getLocStr("SortZtoA"),parentId:null,sprite:"e-icon e-ssdrop-sortztoa"},{id:"Ribbon_Filter",text:this.XLObj._getLocStr("Filter"),parentId:null,sprite:"e-icon e-ssdrop-filter"},{id:"Ribbon_ClearFilter",text:this.XLObj._getLocStr("ClearFilter"),parentId:null,sprite:"e-icon e-ssdrop-clearfilter"}];this._findMenuData=[{id:"Find",text:n._getLocStr("Find")+"...",parentId:null,sprite:"e-icon e-ss-find"},{id:"Replace",text:n._getLocStr("Replace")+"...",parentId:null,sprite:"e-icon e-ss-replace"},{id:"GoTo",text:n._getLocStr("GoTo")+"...",parentId:null,sprite:"e-icon e-ss-goto"},{id:"GoToSpecial",text:n._getLocStr("GoTo")+" "+n._getLocStr("Special")+"...",parentId:null},{id:"Formulas",text:n._getLocStr("Formulas"),parentId:null},{id:"Comments",text:n._getLocStr("Comments"),parentId:null},{id:"CFormat",text:n._getLocStr("ConditionalFormat"),parentId:null},{id:"Constants",text:n._getLocStr("Constants"),parentId:null},{id:"DataValidation",text:n._getLocStr("DataValidation"),parentId:null}];this._calcOptData=[{id:this.XLObj._id+"_CalcAuto",text:n._getLocStr("Automatic"),parentId:null,sprite:"e-icon e-ss-calcauto"},{id:this.XLObj._id+"_CalcManual",text:n._getLocStr("Manual"),parentId:null,sprite:"e-icon"}];this._valMenuData=[{id:"Validation",text:n._getLocStr("DataValidation")+"...",parentId:null,sprite:"e-icon e-ss-validation"},{id:"HighlightVal",text:n._getLocStr("HighlightVal"),parentId:null,sprite:"e-icon e-ss-hlval"},{id:"ClearHLVal",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearval"},{id:"ClearVal",text:n._getLocStr("ClearVal"),parentId:null,sprite:"e-icon e-ss-clearval"}];this._pageSizes=[{id:"A4",text:n._getLocStr("A4"),parentId:null,sprite:"e-icon e-ss-A4size"},{id:"A3",text:n._getLocStr("A3"),parentId:null,sprite:"e-icon e-ss-A3size"},{id:"Letter",text:n._getLocStr("Letter"),parentId:null,sprite:"e-icon e-ss-lettersize"}];this._viewMenuData=[{id:"freezePanes",text:n._getLocStr("FreezePanes"),parentId:null,sprite:"e-icon e-ss-frzpane"},{id:"FreezeTopRow",text:n._getLocStr("FreezeTopRow"),parentId:null,sprite:"e-icon e-ss-frzrow"},{id:"FreezeFirstColumn",text:n._getLocStr("FreezeFirstColumn"),parentId:null,sprite:"e-icon e-ss-frzcln"}];this._insertMenuData=[{id:"InsertCells",text:n._getLocStr("InsCells")+"...",parentId:null,sprite:"e-icon e-ssr-inscell"},{id:"InsertSheetRows",text:n._getLocStr("InsRows"),parentId:null,sprite:"e-icon e-ssr-insrow"},{id:"InsertSheetColumns",text:n._getLocStr("InsCols"),parentId:null,sprite:"e-icon e-ssr-inscol"},{id:"InsertSheet",text:n._getLocStr("InsSheet"),parentId:null,sprite:"e-icon e-ssr-inssheet"}];this._resetPicture=[{id:"resetpicture",text:n._getLocStr("ResetPicture"),parentId:null,sprite:"e-icon e-ss-resetpicture"},{id:"resetsize",text:n._getLocStr("ResetSize"),parentId:null,sprite:"e-icon e-ss-resetpicture"}];var t=n._getLocStr("BorderStyles").split("/");this._borderMenuData=[{id:"bottom",text:n._getLocStr("BottomBorder"),parentId:null,sprite:"e-icon e-ss-bottom"},{id:"top",text:n._getLocStr("TopBorder"),parentId:null,sprite:"e-icon e-ss-top"},{id:"left",text:n._getLocStr("LeftBorder"),parentId:null,sprite:"e-icon e-ss-left"},{id:"right",text:n._getLocStr("RightBorder"),parentId:null,sprite:"e-icon e-ss-right"},{id:"noborder",text:n._getLocStr("NoBorder"),parentId:null,sprite:"e-icon e-ss-noborder"},{id:"allborder",text:n._getLocStr("AllBorder"),parentId:null,sprite:"e-icon e-ss-allborder"},{id:"outside",text:n._getLocStr("OutsideBorder"),parentId:null,sprite:"e-icon e-ss-outside"},{id:"thickbox",text:n._getLocStr("ThickBoxBorder"),parentId:null,sprite:"e-icon e-ss-thickbox"},{id:"thickbottom",text:n._getLocStr("ThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-thickbottom"},{id:"topandbottom",text:n._getLocStr("TopandBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandbottom"},{id:"topandthickbottom",text:n._getLocStr("TopandThickBottomBorder"),parentId:null,sprite:"e-icon e-ss-topandthickbottom"},{id:"drawborder",text:n._getLocStr("DrawBorder"),parentId:null,sprite:"e-icon e-ss-drawborder"},{id:"drawbordergrid",text:n._getLocStr("DrawBorderGrid"),parentId:null,sprite:"e-icon e-ss-drawbordergrid"},{id:n._id+"_bordercolor",text:n._getLocStr("BorderColor"),parentId:null},{id:n._id+"_Ribbon_borderstyle",text:n._getLocStr("BorderStyle"),parentId:null},{id:n._id+"_Ribbon_bordercolor",text:"",parentId:n._id+"_bordercolor"},{id:"solid",text:t[0],parentId:n._id+"_Ribbon_borderstyle"},{id:"dashed",text:t[1],parentId:n._id+"_Ribbon_borderstyle"},{id:"dotted",text:t[2],parentId:n._id+"_Ribbon_borderstyle"}];this._cFormatMenuData=[{id:n._id+"_HLCellRules",text:"Highlight Cell Rules",parentId:null,sprite:"e-icon e-ss-hlcellrules"},{id:"greaterthan",text:n._getLocStr("GreaterThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-greaterthan"},{id:"lessthan",text:n._getLocStr("LessThan")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-lessthan"},{id:"between",text:n._getLocStr("Between")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-between"},{id:"equalto",text:n._getLocStr("EqualTo")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-equalto"},{id:"textcontains",text:n._getLocStr("TextthatContains")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-textcontains"},{id:"dateoccur",text:n._getLocStr("DateOccurring")+"...",parentId:n._id+"_HLCellRules",sprite:"e-icon e-ss-dateoccur"},{id:n._id+"_CreateRule",text:n._getLocStr("CreateRule"),parentId:null,sprite:"e-icon e-ss-createrule"},{id:n._id+"_ClearRules",text:n._getLocStr("ClearRules"),parentId:null,sprite:"e-icon e-ss-clearrules"},{id:"clearselected",text:n._getLocStr("ClearRulesfromSelected"),parentId:n._id+"_ClearRules"},{id:"clearall",text:n._getLocStr("ClearRulesfromEntireSheets"),parentId:n._id+"_ClearRules"}];this._textAlign=[{value:"1",text:"Left"},{value:"2",text:"Center"},{value:"3",text:"Right"}];this._verticalAlign=[{value:"1",text:"Top"},{value:"2",text:"Middle"},{value:"3",text:"Bottom"}];this._actions=[{value:"Greater",text:"greater than"},{value:"GreaterOrEqual",text:"greater or equal to"},{value:"Less",text:"less than"},{value:"LessOrEqual",text:"less than or equal to"},{value:"Equal",text:"equal to"},{value:"NotEqual",text:"not equal to"},{value:"Between",text:"between"},{value:"NotBetween",text:"not between"}];this._types=[{value:"number",text:"Number"},{value:"decimal",text:"Decimal"},{value:"date",text:"Date"},{value:"time",text:"Time"},{value:"text",text:"TextLength"},{value:"list",text:"List"}];this._cFormatData={greaterthan:["GTTitle","GTContent"],lessthan:["LTTitle","LTContent"],between:["BWTitle","BWContent"],equalto:["EQTitle","EQContent"],textcontains:["ContainsTitle","ContainsContent"],dateoccur:["DateTitle","DateContent"]};this._styles=[{value:"redft",text:"Light Red Fill with Dark Red Text"},{value:"yellowft",text:"Yellow Fill with Dark Yellow Text"},{value:"greenft",text:"Green Fill with Dark Green Text"},{value:"redf",text:"Red Fill"},{value:"redt",text:"Red Text"}];this._currentCFormat="";this._addrList=[];this._within=[{value:"sheet",text:n._getLocStr("Sheet")},{value:"workbook",text:n._getLocStr("Workbook")}];this._sType=[{value:"columns",text:n._getLocStr("Columns")},{value:"rows",text:n._getLocStr("Rows")}];this._vType=[{value:"value",text:n._getLocStr("Value")},{value:"formula",text:n._getLocStr("Formula")},{value:"comment",text:n._getLocStr("Comments")}];this._direction=[{value:"down",text:n._getLocStr("Down")},{value:"up",text:n._getLocStr("Up")}];this._gotoRBtnSet1=["Comments","Blanks","LastCell","Formulas","Constants"];this._gotoRBtnSet2=["RowDiff","ColDiff","CFormat","DataValidation"];this._gotoChkBox=["GotoNumbers","GotoText","GotoLogicals","GotoError"];this._numberFormat=[{value:"1",text:"General"},{value:"2",text:"Number"},{value:"3",text:"Currency"},{value:"4",text:"Accounting"},{value:"5",text:"Percentage"},{value:"6",text:"Text"},{value:"7",text:"Shortdate"},{value:"8",text:"Longdate"},{value:"9",text:"Time"},{value:"10",text:"Scientific"},{value:"11",text:"Fraction"},{value:"12",text:"Custom"}];this._deleteMenuData=[{id:"DeleteCells",text:n._getLocStr("DelCells")+"...",parentId:null,sprite:"e-icon e-ssr-delcell"},{id:"DeleteSheetRows",text:n._getLocStr("DelRows"),parentId:null,sprite:"e-icon e-ssr-delrow"},{id:"DeleteSheetColumns",text:n._getLocStr("DelCols"),parentId:null,sprite:"e-icon e-ssr-delcol"},{id:"DeleteSheet",text:n._getLocStr("DelSheet"),parentId:null,sprite:"e-icon e-ssr-delsheet"}];this._clearMenuData=[{id:"Clear_All",text:n._getLocStr("ClearAll"),parentId:null,sprite:"e-icon e-ss-clear"},{id:"Clear_Formats",text:n._getLocStr("ClearFormats"),parentId:null,sprite:"e-icon e-ss-clearformat"},{id:"Clear_Contents",text:n._getLocStr("ClearContents"),parentId:null},{id:"Clear_Comments",text:n._getLocStr("ClearComments"),parentId:null},{id:"Clear_Hyperlinks",text:n._getLocStr("ClearHyperLinks"),parentId:null}];this._autosumMenuData=[{id:"Sum",text:n._getLocStr("Sum"),parentId:null,sprite:"e-icon e-ss-autosum"},{id:"Average",text:n._getLocStr("Average"),parentId:null},{id:"Count",text:n._getLocStr("CountNumber"),parentId:null},{id:"Max",text:n._getLocStr("Max"),parentId:null},{id:"Min",text:n._getLocStr("Min"),parentId:null}];this._chartThemes=[{value:"flatlight",text:"Flat Light"},{value:"flatdark",text:"Flat Dark"},{value:"azure",text:"Azure"},{value:"azuredark",text:"Azure Dark"},{value:"lime",text:"Lime"},{value:"limedark",text:"Lime Dark"},{value:"saffron",text:"Saffron"},{value:"saffrondark",text:"Saffron Dark"}];this._isCustomCellStyleReset=!1;this.allButtonIds=["Home_Clipboard_Paste","Home_Font_IncreaseFontSize","Home_Font_DecreaseFontSize","Home_Alignment_DecreaseIndent","Home_Alignment_IncreaseIndent","Home_Number_IncreaseDecimal","Home_Number_DecreaseDecimal","Home_Actions_Undo","Home_Actions_Redo","Home_Number_Accounting","Home_Number_CommaStyle","Home_Number_Percentage","Home_Clipboard_Cut","Home_Clipboard_Copy","Insert_Tables_PivotTable","Insert_Tables_Table","Insert_Links_Hyperlink","Insert_Illustrations_Pictures","Data_SortFilter_SortAtoZ","Data_SortFilter_SortZtoA","Data_SortFilter_Filter","Data_SortFilter_ClearFilter","Data_DataTools_DataValidation","PageLayout_PageLayout_PageSize","PageLayout_Print_Print","PageLayout_Print_PrintSelected","Review_Comments_NewComment","Review_Comments_DeleteComment","Review_Comments_PreviousComment","Review_Comments_NextComment","Review_Comments_ShowHideComment","Others_Cells_InsertCell","Others_Cells_DeleteCell","Others_Formulas_NameManager","Others_Formulas_DefineName","Others_CalCulation_CalculateNow","Others_CalCulation_CalculateSheet","Design_Tools_ResizeTable","Design_Tools_ConvertToRange","ChartDesign_Data_SwitchRowColumn","ChartDesign_Data_SelectData","ChartDesign_Type_ChangeChartType","Format_Adjust_ChangePicture"];this.allSplitButtonIds=["Home_Clipboard_PasteOptions","Home_Font_Border","Home_Styles_ConditionalFormatting","Home_Styles_FormatAsTable","Home_Styles_CellStyles","Others_Editing_FindSelect","Home_Editing_Clear","Home_Alignment_Merge","Home_Editing_SortFilter","Home_Editing_AutoSum","Insert_Charts_ColumnChart","Insert_Charts_BarChart","Insert_Charts_StockChart","Insert_Charts_LineChart","Insert_Charts_AreaChart","Insert_Charts_PieChart","Insert_Charts_ScatterChart","Data_DataTools_DataValidationOptions","PageLayout_PageLayout_PageSizeOptions","Others_Cells_InsertCellOptions","Others_Cells_DeleteCellOptions","Others_Editing_FindSelect","Others_Window_FreezePanes","Others_CalCulation_CalculationOptions","ChartDesign_ChartLayouts_AddChartElement","Format_Adjust_ResetPicture","Format_Border_PictureBorder"];this.allToggleButtonIds=["Home_Font_Bold","Home_Font_Italic","Home_Font_Underline","Home_Font_StrikeThrough","Home_Alignment_AlignLeft","Home_Alignment_AlignRight","Home_Alignment_AlignCenter","Home_Alignment_TopAlign","Home_Alignment_MiddleAlign","Home_Alignment_BottomAlign","Home_Alignment_WrapText","Home_Clipboard_FormatPainter","Review_Comments_ShowAllComments","Review_Changes_ProtectSheet","Review_Changes_ProtectWorkbook","Review_Changes_LockCell"];this.allDropDownIds=["ChartDesign_ChartThemes_ChartThemes","Home_Number_NumberFormat","Home_Font_FontSize","Home_Font_FontFamily"];this.colorPickerIds=["Home_Font_FillColor","Home_Font_FontColor"];this.checkBoxIds=["PageLayout_Show_Headings","PageLayout_Show_Gridlines","Design_TableStyleOptions_FirstColumn","Design_TableStyleOptions_LastColumn","Design_TableStyleOptions_TotalRow","Design_TableStyleOptions_FilterColumn"];this.InputIds=["Ribbon_Design_Properties_TableName"];this._fileMenuData=[{id:"File",text:n._getLocStr("File"),parentId:null},{id:"New",text:n._getLocStr("New"),parentId:"File",sprite:"e-icon e-ss-newsheet"},{id:"Open",text:n._getLocStr("Open")+"...",parentId:"File",sprite:"e-icon e-ss-open"},{id:"Save",text:n._getLocStr("SaveAs"),parentId:"File",sprite:"e-icon e-ss-saveas"},{id:"Print",text:n._getLocStr("Print"),parentId:"File",sprite:"e-icon e-ssm-print"},{id:"ExportXL",text:n._getLocStr("ExportXL"),parentId:"Save",sprite:"e-icon e-ssm-exportxl"},{id:"ExportCsv",text:n._getLocStr("ExportCsv"),parentId:"Save",sprite:"e-icon e-ssm-exportcsv"},{id:"ExportPdf",text:n._getLocStr("ExportPdf"),parentId:"Save",sprite:"e-icon e-ssm-exportpdf"},{id:"PrintSheet",text:n._getLocStr("PrintSheet"),parentId:"Print",sprite:"e-icon e-ssm-print"},{id:"PrintSelected",text:n._getLocStr("PrintSelected"),parentId:"Print",sprite:"e-icon e-ssm-printselected"}];this._isAppTabCreate=!1;this._isHomeTabCreate=!1;this._isInsertTabCreate=!1;this._isDataTabCreate=!1;this._isPageLayoutTabCreate=!1;this._isReviewTabCreate=!1;this._isOthersTabCreate=!1;this._isDesignTabCreate=!1;this._isFormatTabCreate=!1;this._isChartTabCreate=!1;this._analyzeTabCreate=!1;this._isHomeTabTrgt=!1;this._isInsertTabTrgt=!1;this._isDataTabTrgt=!1;this._isPageLayoutTrgtTab=!1;this._isReviewTabTrgt=!1;this._isOthersTabTrgt=!1;this._isDesignTabTrgt=!1;this._isFormatTabTrgt=!1;this._isChartTabTrgt=!1;this._analyzeTabTrgt=!1};t.spreadsheetFeatures.ribbon.prototype={_renderChartTypeDialog:function(){var r,h,f,o,c,l,a,v,y,p,w,b,k,i=this.XLObj,e=i._id+"_charttypedlg",u,s;return r=t.buildTag("div#"+e+".e-chartdialog","",{},{overflow:"hidden"}),o=t.buildTag("div#"+e+"_allcharttab.e-chtdlgtab"),b=t.buildTag("div.e-dlg-fields e-dlgctndiv"),v=t.buildTag("ul .e-ul","",""),w=t.buildTag("a",i._getLocStr("AllCharts"),{},{href:"#"+i._id+"_allchart"}),p=t.buildTag("li",w),r.append(b.append(o.append(v.append(p)))),a=t.buildTag("div#"+e+"_btndiv.e-dlg-btnfields"),k=t.buildTag("div.e-dlg-btnctnr"),c=t.buildTag("input#"+e+"_okbtn","",{},{type:"button"}),l=t.buildTag("input#"+e+"_cantn","",{},{type:"button"}),c.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._chartTypeOk,this),enabled:!0}),l.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._chartTypeCancel,this),showRoundedCorner:!0,width:60}),a.append(k.append(c,l)),r.append(a),i.element.append(r),f=i._dlgHeight>440&&!i._phoneMode?440:i._dlgHeight<380?i._responsiveHeight-2:i._dlgHeight,i._isMaterial&&(f=f+60),h=i._dlgWidth>617?510:i._dlgWidth<430?i._responsiveWidth-2:i._dlgWidth,r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("ChartType"),width:h,height:f,cssClass:"e-ss-dialog e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)}),s=n("#"+i._id+"_charttypedlg_okbtn").outerHeight(!0)+11,s<40&&(s+=4),u=f-(46+s),i._isMaterial&&(u=u-43),o.ejTab({cssClass:"e-ss-dlgtab",width:"100%",height:u}),i._phoneMode&&(y=3),o.find(".e-content").height(u-(41+y)),tabHt=u-(44+(i._isMaterial?35:0)),this._renderAllChartTab(tabHt,h),r},_renderAllChartTab:function(i,r){var o,c,b,v,y,u,p,k,w="",d="",f=this.XLObj,e=f._id,g=e+"_chartdlg_allcharttab",s=["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"],h,l,a,nt,tt;for(y=t.buildTag("div#"+g+"_content.e-chtdlgcontent","",{width:"98%",height:"93%","margin-top":"10px",overflow:"auto"}),$listUl=t.buildTag("ul #"+g+"_list .e-ul"),l=0,a=s.length;l<a;l++)u=s[l].split("-")[0],d+="<li><span class='e-icon e-ss-dlg"+u.toLowerCase()+"chart'><\/span>"+u+"<\/li>";for($listUl.append(d),h=t.buildTag("div#"+e+"_allchart_table","",{cellspacing:"0",cellpadding:"0",height:i-45}),n("#"+e+"_allchart").append(h),h.append($listUl),this._createChartList(s,h),h.append(y),c=0,a=s.length;c<a;c++){for(v=s[c].split("-"),k=f._getLocStr("Title"+v[0]+"Chart").split("/"),u=v[0].toLowerCase(),p=t.buildTag("div#"+e+"_"+u+"chart"),o=1,b=parseInt(v[1]);o<=b;o++)w+="<div class='e-chartimg e-dlg"+u+"chart"+o+"' title='"+k[o-1]+"'><\/div>";y.append(p.append(w));n("#"+e+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect");p.hide();w=""}f._phoneMode||(n("#"+e+"_allchart_table").height(i),nt=n("#"+f._id+"_chartdlg_allcharttab_content"),tt=n("#"+f._id+"_chartdlg_allcharttab_list_container"),r=f._isMaterial?r-210:r-198,nt.css({height:"99%",width:r+"px","margin-top":"0px",float:"right"}),tt.css("float","left"));f._on(n("#"+e+"_allchart").find(".e-chartimg"),"click",f._allChartType);n("#"+e+"_columnchart").show()},_createChartList:function(i,r){var o=this.XLObj,f=o._id+"_chartdlg_allcharttab",s=n("#"+o._id+"_allchart").height(),e,u=n("#"+f+"_list");o._phoneMode?(u.data("ejListBox")&&u.ejListBox("destroy"),document.getElementById(f+"_input")||(e=t.buildTag("input#"+f+"_input"),n("#"+o._id+"_allchart").prepend(e),e.ejDropDownList({targetID:f+"_list",width:"100%",fields:{id:"value",text:"text",value:"text"},select:n.proxy(this._onChartChange,this),selectedItemIndex:0}))):(document.getElementById(f+"_input")&&(e=n("#"+f+"_input"),e.ejDropDownList("destroy"),e.remove()),u.data("ejListBox")?(u=n("#"+f+"_list"),u.ejListBox("option",{height:"100%"})):(r.find("td:eq(0)").width("25%").append(u),u.ejListBox({selectedItemIndex:0,width:"120",height:"100%",fields:{text:"text",value:"value"},select:n.proxy(this._onChartChange,this),allowMultiSelection:!1})),u.parent().width(120))},_onChartChange:function(t){for(var r=this.XLObj,u=t.value?t.value.toLowerCase():t.text.toLowerCase(),f=["column","bar","radar","line","area","pie","scatter"],i=0;i<f.length;i++)n("#"+r._id+"_"+f[i]+"chart").hide();n("#"+r._id+"_"+u+"chart").show();n("#"+r._id+"_allchart").find(".e-chartimg").removeClass("e-chartselect");n("#"+r._id+"_"+u+"chart").find(".e-dlg"+u+"chart1").addClass("e-chartselect")},_initValDialog:function(){var f,e,o,s,h,c,a,v,i=this.XLObj,l,y,p,r,u;return f=t.buildTag("div#"+i._id+"_ValDialog"),e=t.buildTag("div#"+i._id+"_ValDialog_valDlgTab"),l=t.buildTag("div.e-dlg-fields e-dlgctndiv"),c=t.buildTag("ul .e-ul"),v=t.buildTag("a","Settings",{},{href:"#"+i._id+"_Validation"}),a=t.buildTag("li",v),c.append(a),e.append(c),f.append(l.append(e)),r=i._dlgHeight>440&&!i._phoneMode?440:i._dlgHeight<350||i._phoneMode?i._responsiveHeight-2:i._dlgHeight+40,p=i._dlgWidth>400?400:i._dlgWidth<330?i._responsiveWidth-2:i._dlgWidth,h=t.buildTag("div#"+i._id+"btnDiv.e-dlg-btnfields"),y=t.buildTag("div.e-dlg-btnctnr"),o=t.buildTag("input#"+i._id+"Dialog_OkBtn","",{},{type:"button"}),s=t.buildTag("input#"+i._id+"Dialog_CancelBtn","",{},{type:"button"}),o.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:"19%",click:t.proxy(this._valDlgBtnClick,this,"ok"),enabled:!0}),s.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._valDlgBtnClick,this,"cancel"),showRoundedCorner:!0,width:"19%"}),h.append(y.append(o,s)),f.append(h),i._isMaterial&&(r=r>400?r+110:r+150),f.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("DataValidation"),width:p,height:r,cssClass:"e-ss-dialog e-ss-valdlg e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)}),u=n("#"+i._id+"Dialog_OkBtn").outerHeight(!0)+11,u<40&&(u+=4),dlgCntHt=r-(46+u),i._isMaterial&&(dlgCntHt=r-(88+u)),l.height(dlgCntHt),e.ejTab({width:"100%",cssClass:"e-ss-dlgtab"}),r},_initCFDialog:function(){var n=this.XLObj,i,e,r,u,f,o,s=275;return i=t.buildTag("div#"+n._id+"_CFDialog"),n.element.append(i),e=t.buildTag("div#"+n._id+"_CondFormat.e-dlgctndiv"),i.append(e),f=t.buildTag("div#"+n._id+"cfBtnDiv.e-dlg-btnfields"),o=t.buildTag("div.e-dlg-btnctnr"),r=t.buildTag("input#"+n._id+"cfDialog_OkBtn","",{},{type:"button"}),u=t.buildTag("input#"+n._id+"cfDialog_CancelBtn","",{},{type:"button"}),r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgCFOk,this),enabled:!0}),u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgCFCancel,this),showRoundedCorner:!0,width:"25%"}),f.append(o.append(r,u)),i.append(f),n._isMaterial&&(s=290),i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("ConditionalFormat"),width:s,cssClass:"e-ss-dialog e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)}),i},_initHLDialog:function(){var i=this.XLObj,r,u,f,e,o,s,h,c,a,l=320;r=t.buildTag("div#"+i._id+"_HLDialog");u=t.buildTag("div#"+i._id+"_HLDialogTab");a=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul .e-ul");o=t.buildTag("a",i._getLocStr("WebPage"),{},{href:"#"+i._id+"_Web"});e=t.buildTag("li",o);f.append(e);o=t.buildTag("a",i._getLocStr("WorkSheet"),{},{href:"#"+i._id+"_Doc"});e=t.buildTag("li",o);f.append(e);u.append(f);r.append(a.append(u));s=t.buildTag("div#"+i._id+"hlBtnDiv.e-dlg-btnfields");$btnctnr=t.buildTag("div.e-dlg-btnctnr");h=t.buildTag("input#"+i._id+"hlDialog_OkBtn","",{},{type:"button"});c=t.buildTag("input#"+i._id+"hlDialog_CancelBtn","",{},{type:"button"});h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgHLOk,this),enabled:!0});c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._dlgHLCancel,this),showRoundedCorner:!0,width:60});s.append($btnctnr.append(h,c));r.append(s);l=i._isMaterial?367:320;r.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("InsertHyperLink"),width:i._dlgWidth>l?l:i._dlgWidth,cssClass:"e-ss-dialog e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_webAddress"),r=n("#"+i._id+"_Ribbon_cellAddress");t.focus().setInputPos(t.val().length);r.focus().setInputPos(r.val().length)})});u.ejTab({width:"100%",itemActive:t.proxy(this._hlTabChange,this),cssClass:"e-ss-dlgtab"});this._renderHLDialog()},_initFRDialog:function(){var i=this.XLObj,e,o,s,h,c,l,y,f,r,p,u,a,v;e=t.buildTag("div#"+i._id+"_FRDialog");o=t.buildTag("div#"+i._id+"_FRDialog_FPDlgTab");p=t.buildTag("div.e-dlg-fields e-dlgctndiv");f=t.buildTag("ul .e-ul");u=t.buildTag("a",i._getLocStr("Find"),{},{href:"#"+i._id+"_Find"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Replace"),{},{href:"#"+i._id+"_Replace"});r=t.buildTag("li",u);f.append(r);u=t.buildTag("a",i._getLocStr("Settings"),{},{href:"#"+i._id+"_Settings"});r=t.buildTag("li",u);f.append(r);o.append(f);e.append(p.append(o));l=t.buildTag("div#"+i._id+"btnFRDiv.e-dlg-btnfields");y=t.buildTag("div.e-dlg-btnctnr");a=t.buildTag("input#"+i._id+"FR_ReplaceBtn","",{"margin-left":0},{type:"button"});v=t.buildTag("input#"+i._id+"FR_ReplaceAllBtn","",{},{type:"button"});s=t.buildTag("input#"+i._id+"FR_NextBtn","",{},{type:"button"});h=t.buildTag("input#"+i._id+"FR_PrevBtn","",{},{type:"button"});c=t.buildTag("input#"+i._id+"FR_CloseBtn","",{},{type:"button"});a.ejButton({text:i._getLocStr("Replace"),showRoundedCorner:!0,width:55,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceBtn"),enabled:!0}).css("display","none");v.ejButton({text:i._getLocStr("ReplaceAll"),showRoundedCorner:!0,click:t.proxy(this._btnFROnClick,this,"FR_ReplaceAllBtn"),enabled:!0}).css("display","none");s.ejButton({text:i._getLocStr("FindNext"),showRoundedCorner:!0,width:69,click:t.proxy(this._btnFROnClick,this,"FR_NextBtn"),enabled:!0});h.ejButton({text:i._getLocStr("FindPrev"),showRoundedCorner:!0,width:69,click:t.proxy(this._btnFROnClick,this,"FR_PrevBtn"),enabled:!0});c.ejButton({text:i._getLocStr("Close"),click:t.proxy(this._btnFROnClick,this,"FR_CloseBtn"),showRoundedCorner:!0,width:47});l.append(y.append(a,v,s,h,c));e.append(l);e.ejDialog({showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("FindnReplace"),width:(i._dlgWidth>500?500:i._dlgWidth)+(i._isMaterial?70:0),height:"auto",cssClass:"e-ss-dialog e-ss-mattab e-ss-frdlg e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_Ribbon_textFind");t.focus().setInputPos(t.val().length)})});o.ejTab({width:"100%",itemActive:t.proxy(this._findTabChange,this),cssClass:"e-ss-dlgtab"})},_initGoToDialog:function(){var i=this.XLObj,r,f,l,e,o,s,h,c,a,u;return r=t.buildTag("div#"+i._id+"_GoDialog"),f=t.buildTag("div#"+i._id+"_GoToDlgTab"),a=t.buildTag("div.e-dlg-fields e-dlgctndiv"),u=i._dlgHeight>330?330:i._dlgHeight,i._isMaterial&&(u=u+110),e=t.buildTag("ul .e-ul"),s=t.buildTag("a",i._getLocStr("GoTo"),{},{href:"#"+i._id+"_GoTo"}),o=t.buildTag("li",s),e.append(o),s=t.buildTag("a",i._getLocStr("GoTo")+" "+i._getLocStr("Special"),{},{href:"#"+i._id+"_GoToSp"}),o=t.buildTag("li",s),e.append(o),f.append(e),r.append(a.append(f)),l=t.buildTag("div#"+i._id+"btnDiv.e-dlg-btnfields"),$btnctnr=t.buildTag("div.e-dlg-btnctnr"),r.append(l.append($btnctnr)),h=t.buildTag("input#"+i._id+"Dialog_GoOkBtn","",{},{type:"button"}),c=t.buildTag("input#"+i._id+"Dialog_GoCancelBtn","",{},{type:"button"}),h.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:i._isMaterial?64:"21.5%",click:t.proxy(this._gotoBtnClick,this,"ok")}),c.ejButton({text:i._getLocStr("Cancel"),click:t.proxy(this._gotoBtnClick,this,"cancel"),showRoundedCorner:!0,width:i._isMaterial?64:"21.5%"}),$btnctnr.append(h,c),i.element.append(r),r.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("GoTo"),width:i._dlgWidth>318?318:i._dlgWidth,height:u,cssClass:"e-ss-dialog e-ss-gotodlg e-ss-mattab e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),open:t.proxy(function(){var t=n("#"+i._id+"_textRef");t.focus().setInputPos(t.val().length)})}),f.ejTab({width:"100%",itemActive:t.proxy(this._gotoTabChange,this),cssClass:"e-ss-dlgtab"}),u},_initPvtDialog:function(){var n=this.XLObj,i,r,u,f,e;i=t.buildTag("div#"+n._id+"_PvtDialog");n.element.append(i);i.append(t.buildTag("div#"+n._id+"_Pivot.e-dlgctndiv"));f=t.buildTag("div#"+n._id+"pvtBtnDiv.e-dlg-btnfields");e=t.buildTag("div.e-dlg-btnctnr");r=t.buildTag("input#"+n._id+"PvtDialog_OkBtn");u=t.buildTag("input#"+n._id+"PvtDialog_CancelBtn");r.ejButton({text:n._getLocStr("Ok"),showRoundedCorner:!0,width:"25%",click:t.proxy(this._dlgPvtOk,this),enabled:!0});u.ejButton({text:n._getLocStr("Cancel"),click:t.proxy(this._dlgPvtCancel,this),showRoundedCorner:!0,width:"25%"});f.append(e.append(r,u));i.append(f);i.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:n._getLocStr("CreatePivotTable"),width:353,cssClass:"e-ss-dialog e-"+n._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_dialogClose:function(){this.XLObj.setSheetFocus()},_beforeDlgClose:function(t){var i=n("#"+this.XLObj._id+"_nmgrid_dialogEdit_overLay");i.length&&(t.cancel=!0)},_homeTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"home",text:"HOME",groups:[]},i=f._id,e=f.model;n={text:"Clipboard",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Home_Clipboard_Paste","paste","textandimage","e-icon e-ssr-paste",45,this._mediumBtnHeight,"PasteTitle","PasteContent",!1,u),this._generateSplitBtn("Home_Clipboard_PasteOptions","Paste","textandimage",i+"_Ribbon_Paste",{dataSource:this._pasteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,45,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pastesbtn","PasteTitle","PasteSplitContent")]},{groups:[this._generateBtn("Home_Clipboard_Cut","Cut","textandimage","e-icon e-ssr-cut",58,this._smallBtnHeight,"CutTitle","CutContent"),this._generateBtn("Home_Clipboard_Copy","Copy","textandimage","e-icon e-ssr-copy",67,this._smallBtnHeight,"CopyTitle","CopyContent"),this._generateToggleBtn("Home_Clipboard_FormatPainter","FormatPainter","textandimage","e-icon e-ss-formatpainter","FPTitle",110,this._smallBtnHeight,"FPContent")]}]};r.groups.push(n);n={text:"Font",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateDD("Home_Font_FontFamily","FontFamily",this._fontFamily,"7",150,this._smallBtnHeight,"FontFamily","FFContent"),this._generateDD("Home_Font_FontSize","FontSize",this._fontSize,"11pt",65,this._smallBtnHeight,"FontSize","FSContent"),this._generateBtn("Home_Font_IncreaseFontSize","IncreaseFontSize","imageonly","e-icon e-ss-increasefontsize","",this._smallBtnHeight,"IncreaseFontSize","IFSContent"),this._generateBtn("Home_Font_DecreaseFontSize","DecreaseFontSize","imageonly","e-icon e-ss-decreasefontsize","",this._smallBtnHeight,"DecreaseFontSize","DFSContent")]},{groups:[this._generateToggleBtn("Home_Font_Bold","Bold","imageonly","e-icon e-ss-bold","BoldTitle","",this._smallBtnHeight,"BoldContent"),this._generateToggleBtn("Home_Font_Italic","Italic","imageonly","e-icon e-ss-italic","ItalicTitle","",this._smallBtnHeight,"ItalicContent"),this._generateToggleBtn("Home_Font_Underline","Underline","imageonly","e-icon e-ss-underline","ULineTitle","",this._smallBtnHeight,"ULineContent"),this._generateToggleBtn("Home_Font_StrikeThrough","Linethrough","imageonly","e-icon e-ss-linethrough","LineTrTitle",25,this._smallBtnHeight,"LineTrContent",!0),this._generateSplitBtn("Home_Font_Border","Border","imageonly",i+"_Ribbon_Border",{dataSource:this._borderMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-bottom",!0,37,this._smallBtnHeight,"","","","e-borderbtn","Border","BorderContent"),this._generateCustomControl(i+"_Ribbon_Home_Font_FillColor","BackgroundColor","BackgroundColor","BGContent"),this._generateCustomControl(i+"_Ribbon_Home_Font_FontColor","FontColor","Color","ColorContent")]}]};r.groups.push(n);n={text:"Alignment",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateToggleBtn("Home_Alignment_TopAlign","TopAlign","imageonly","e-icon e-ss-topalign","TopAlign","","","TopAlignContent"),this._generateToggleBtn("Home_Alignment_MiddleAlign","MiddleAlign","imageonly","e-icon e-ss-middlealign","MiddleAlign","","","MiddleAlignContent"),this._generateToggleBtn("Home_Alignment_BottomAlign","BottomAlign","imageonly","e-icon e-ss-bottomalign","BottomAlign","","","BottomAlignContent",!0),this._generateToggleBtn("Home_Alignment_WrapText","WrapText","textandimage","e-icon e-ss-wraptext","WrapText",85,25,"WrapTextContent")]},{groups:[this._generateToggleBtn("Home_Alignment_AlignLeft","AlignLeft","imageonly","e-icon e-ss-alignleft","AlignLeft","","","AlignLeftContent"),this._generateToggleBtn("Home_Alignment_AlignCenter","AlignCenter","imageonly","e-icon e-ss-aligncenter","AlignCenter","","","AlignCenterContent"),this._generateToggleBtn("Home_Alignment_AlignRight","AlignRight","imageonly","e-icon e-ss-alignright","AlignRight","","","AlignRightContent",!0),this._generateSplitBtn("Home_Alignment_Merge","MergeAndCenter","textandimage",i+"_Ribbon_Merge",{dataSource:this._mergeMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-merge",!1,136,25,"right","","","e-spreadsheet e-mergebtn","MergeAndCenter","MergeAndCenterContent")]},{groups:[this._generateBtn("Home_Alignment_DecreaseIndent","DecreaseIndent","imageonly","e-icon e-ss-decreaseindent","",this._smallBtnHeight,"DecreaseIndent","DecreaseIndentContent"),this._generateBtn("Home_Alignment_IncreaseIndent","IncreaseIndent","imageonly","e-icon e-ss-increaseindent","",this._smallBtnHeight,"IncreaseIndent","IncreaseIndentContent")]}]};r.groups.push(n);n={text:"Actions",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Home_Actions_Undo","Undo","textandimage","e-icon e-ss-undo",40,this._bigBtnHeight,"UndoTitle","UndoContent",!1,u,""),this._generateBtn("Home_Actions_Redo","Redo","textandimage","e-icon e-ss-redo",40,this._bigBtnHeight,"RedoTitle","RedoContent",!1,u,"")]}]};r.groups.push(n);n={text:"Number",alignType:t.Ribbon.alignType.rows,enableGroupExpander:!0,content:[{groups:[this._generateDD("Home_Number_NumberFormat","NumberFormat",this._numberFormat,"1",125,this._smallBtnHeight,"NumberFormat","NumberFormatContent")]},{groups:[this._generateBtn("Home_Number_Accounting","AccountingStyle","imageonly","e-icon e-ss-accounting","",this._smallBtnHeight,"AccountingStyle","AccountingStyleContent"),this._generateBtn("Home_Number_Percentage","PercentageStyle","imageonly","e-icon e-ss-percentage","",this._smallBtnHeight,"PercentageStyle","PercentageStyleContent"),this._generateBtn("Home_Number_CommaStyle","CommaStyle","imageonly","e-icon e-ss-comma","",this._smallBtnHeight,"CommaStyle","CommaStyleContent",!0),this._generateBtn("Home_Number_IncreaseDecimal","IncreaseDecimal","imageonly","e-icon e-ss-increasedecimal","",this._smallBtnHeight,"IncreaseDecimal","IncreaseDecimalContent"),this._generateBtn("Home_Number_DecreaseDecimal","DecreaseDecimal","imageonly","e-icon e-ss-decreasedecimal","",this._smallBtnHeight,"DecreaseDecimal","DecreaseDecimalContent")]}]};r.groups.push(n);n={text:"Styles",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Home_Styles_ConditionalFormatting","ConditionalFormat","textandimage",i+"_CFormat",{dataSource:this._cFormatMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-condformat",!1,75,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-cformatbtn","ConditionalFormat","CFContent"),this._generateSplitBtn("Home_Styles_FormatAsTable","FormatasTable","textandimage",i+"_formatastable","","e-icon e-ssr-formatastable",!1,65,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-formatastablebtn","FormatAsTable","FATContent"),this._generateSplitBtn("Home_Styles_CellStyles","CellStyles","textandimage",i+"_cellstyles","","e-icon e-ssr-cellstyles",!1,55,this._splitBtnHeight,"bottom",t.ImagePosition.ImageTop,"dropdown","e-spreadsheet e-cellstylebtn","CellStyles","CellStylesContent")]}]};r.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Home_Editing_SortFilter","SortFilter","textandimage",i+"_Ribbon_SortFilter",{dataSource:this._sortFltrMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-sortfilter",!1,50,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-sortfltrbtn","SortFilter","SortFilterContent")]},{groups:[this._generateSplitBtn("Home_Editing_AutoSum","AutoSum","textandimage",i+"_Ribbon_AutoSum",{dataSource:this._autosumMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-autosum",!1,100,25,"right","","","e-spreadsheet e-autosumbtn","AutoSumTitle","AutoSumContent"),this._generateSplitBtn("Home_Editing_Clear","Clear","textandimage",i+"_Ribbon_Clear",{dataSource:this._clearMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-clear",!1,80,25,"right","","dropdown","e-spreadsheet e-clearbtn","Clear","ClearContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_insertTabObj:function(){var n,f=this.XLObj,u="imagetop",r={id:"insert",text:"INSERT",groups:[]},i=f._id;n={text:"Tables",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Tables_PivotTable","PivotTable","textandimage","e-icon e-ssr-pivottable",65,this._bigBtnHeight,"PivotTable","PivotTableContent",!1,u),this._generateBtn("Insert_Tables_Table","Table","textandimage","e-icon e-ssr-table",50,this._bigBtnHeight,"Table","TableContent",!1,u)]}]};r.groups.push(n);n={text:"Illustrations",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Illustrations_Pictures","Pictures","textandimage","e-icon e-ssr-pictures",50,this._bigBtnHeight,"PicturesTitle","PicturesContent",!1,u,"")]}]};r.groups.push(n);n={text:"Links",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Insert_Links_Hyperlink","HyperLink","textandimage","e-icon e-ssr-hyperlink",60,this._bigBtnHeight,"HyperLinkTitle","HyperLinkContent",!1,u,"")]}]};r.groups.push(n);n={text:"Charts",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Insert_Charts_ColumnChart","ColumnChart","imageonly",i+"_Ribbon_ColumnChart","","e-icon e-ss-colchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ColumnChartTitle","ColumnChartContent"),this._generateSplitBtn("Insert_Charts_BarChart","BarChart","imageonly",i+"_Ribbon_BarChart","","e-icon e-ss-barchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","BarChartTitle","BarChartContent"),this._generateSplitBtn("Insert_Charts_StockChart","StockChart","imageonly",i+"_Ribbon_StockChart","","e-icon e-ss-stockchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","StockChartTitle","StockChartContent")]},{groups:[this._generateSplitBtn("Insert_Charts_LineChart","LineChart","imageonly",i+"_Ribbon_LineChart","","e-icon e-ss-linechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","LineChartTitle","LineChartContent"),this._generateSplitBtn("Insert_Charts_AreaChart","AreaChart","imageonly",i+"_Ribbon_AreaChart","","e-icon e-ss-areachart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","AreaChartTitle","AreaChartContent"),this._generateSplitBtn("Insert_Charts_PieChart","PieChart","imageonly",i+"_Ribbon_PieChart","","e-icon e-ss-piechart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","PieChartTitle","PieChartContent")]},{groups:[this._generateSplitBtn("Insert_Charts_ScatterChart","ScatterChart","imageonly",i+"_Ribbon_ScatterChart","","e-icon e-ss-scterchart",!1,41,this._smallBtnHeight,"bottom","ej.ImagePosition.ImageTop","dropdown","e-spreadsheet e-chartbtn","ScatterChartTitle","ScatterChartContent")]}]};r.groups.push(n);this._tabCollection.push(r)},_dataTabObj:function(){var n,r=this.XLObj,i={id:"data",text:"DATA",groups:[]};n={text:"Sort & Filter",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Data_SortFilter_SortAtoZ","SortAtoZ","textandimage","e-icon e-ssr-sortatoz",90,this._smallBtnHeight,"SortAtoZ","SortAtoZContent",!1,"","e-datapadding"),this._generateBtn("Data_SortFilter_SortZtoA","SortZtoA","textandimage","e-icon e-ssr-sortztoa",90,this._smallBtnHeight,"SortZtoA","SortZtoAContent",!1,"","e-datapadding")]},{groups:[this._generateBtn("Data_SortFilter_Filter","Filter","textandimage","e-icon e-ssr-filter",60,this._smallBtnHeight,"Filter","FilterContent",!1,"","e-datapadding"),this._generateBtn("Data_SortFilter_ClearFilter","ClearFilter","textandimage","e-icon e-ss-clearfilter",90,this._smallBtnHeight,"ClearFilter","ClearFilterContent",!1,"","e-datapadding")]}]};i.groups.push(n);n={text:"Data Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Data_DataTools_DataValidation","Validation","imageonly","e-icon e-ssr-validation",70,39,"DataValidation","DVContent",!1,"imagetop"),this._generateSplitBtn("Data_DataTools_DataValidationOptions","DataValidation","textandimage",r._id+"_Ribbon_Validation",{dataSource:this._valMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,70,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-validationsbtn","DataValidation","DVContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_pageTabObj:function(){var n,u=this.XLObj,r="imagetop",i={id:"pagelayout",text:"PAGE LAYOUT",groups:[]};n={text:"Show",alignType:t.Ribbon.alignType.rows,width:105,content:[{groups:[{contentID:u._id+"_Ribbon_pagesetupleft",type:t.Ribbon.type.custom,height:80},]}]};i.groups.push(n);n={text:"Page Layout",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("PageLayout_PageLayout_PageSize","size","imageonly","e-icon e-ssr-pagesize",65,44,"size","PageSizeContent",!1,r,""),this._generateSplitBtn("PageLayout_PageLayout_PageSizeOptions","PageSize","textandimage",u._id+"_Ribbon_PageSize",{dataSource:this._pageSizes,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,65,this._mediumBtnHeight,"bottom","","dropdown","e-ssr-pagesizesbtn","PageSize","PageSizeContent")]}]};i.groups.push(n);n={text:"Print",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("PageLayout_Print_Print","Print","textandimage","e-icon e-ssr-print",50,this._bigBtnHeight,"Print","PrintContent",!1,r,"")]},{groups:[this._generateBtn("PageLayout_Print_PrintSelected","PrintSelected","textandimage","e-icon e-ssr-printselected",55,this._bigBtnHeight,"PrintSelected","PrintSelectedContent",!0,r,"")]}]};i.groups.push(n);this._tabCollection.push(i)},_reviewTabObj:function(){var n,u=this.XLObj,i="imagetop",r={id:"review",text:"REVIEW",groups:[]};n={text:"Comments",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Review_Comments_NewComment","New","textandimage","e-icon e-ssr-newcmnt",49,this._bigBtnHeight,"NewCommentTitle","NewCommentContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_DeleteComment","Delete","textandimage","e-icon e-ssr-deletecmnt",49,this._bigBtnHeight,"DeleteComment","DeleteCommentContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_PreviousComment","Previous","textandimage","e-icon e-ssr-previouscmnt",49,this._bigBtnHeight,"Previous","PreviousContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_NextComment","Next","textandimage","e-icon e-ssr-nextcmnt",49,this._bigBtnHeight,"Next","NextContent",!1,i)]},{groups:[this._generateBtn("Review_Comments_ShowHideComment","ShowHide","textandimage","e-icon e-ssr-showhidecmnt",160,this._smallBtnHeight,"ShowHide","ShowHideContent",!1,"imageLeft","e-ssr-cmntcolbtn"),this._generateToggleBtn("Review_Comments_ShowAllComments","ShowAll","textandimage","e-icon e-ssr-showallcmnt","ShowAll",155,this._smallBtnHeight,"ShowAllContent",!1,"e-ssr-cmntcolbtn")]}]};r.groups.push(n);n={text:"Changes",alignType:t.Ribbon.alignType.row,content:[{groups:[this._generateToggleBtn("Review_Changes_ProtectSheet","Protectsheet","textandimage","e-icon e-ssr-protectsheet","Protectsheet",60,this._bigBtnHeight,"ProtectSheetToolTip",!1,"e-ssr-protectsheetbtn","imagetop","Unprotect"),this._generateToggleBtn("Review_Changes_ProtectWorkbook","ProtectWorkbook","textandimage","e-icon e-ssr-protect","ProtectWorkbook",60,this._bigBtnHeight,"ProtectWBContent",!1,"e-ssr-cmntcolbtn","imagetop"),this._generateToggleBtn("Review_Changes_LockCell","Lock","textandimage","e-icon e-ssr-protlockcell","lock",90,this._smallBtnHeight,"Lock",!1,"e-ssr-lockbtn","","Unlock","e-icon e-ssr-protunlockcell"),]},]};r.groups.push(n);this._tabCollection.push(r)},_otherTabObj:function(){var n,r=this.XLObj,u="imagetop",i={id:"others",text:"OTHERS",groups:[]},f=r._id,e=t.ContentType;n={text:"Window",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Others_Window_FreezePanes","FreezePanes","textandimage",r._id+"_Ribbon_FPane",{dataSource:this._viewMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-frzpane",!1,55,this._splitBtnHeight,"bottom",u,"dropdown","e-spreadsheet e-fpanebtn","FreezePanes","FreezePanesContent")]}]};i.groups.push(n);n={text:r._getLocStr("Formula"),alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Others_Formulas_NameManager","NameManager",e.TextAndImage,"e-icon e-ssr-namemngr",55,this._bigBtnHeight,"NameManager","NameManagerContent",!1,u,"")]},{groups:[this._generateBtn("Others_Formulas_DefineName","DefineName",e.TextAndImage,"e-icon e-ssr-definename",110,25,"DefineName","DefineNameContent"),this._generateSplitBtn("Others_Formulas_UseInFormula","UseInFormula","textandimage",r._id+"_nmuseinformula","","e-icon e-ssr-useformula",!1,125,25,t.ArrowPosition.Bottom,t.ImagePosition.ImageLeft,"dropdown","e-spreadsheet e-useinformulabtn","UseInFormula","UseInFormulaContent")]}]};i.groups.push(n);n={text:"Cells",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Others_Cells_InsertCell","Insert","imageonly","e-icon e-ssr-insert",54,40,"InsertTitle","InsertContent",!1,u),this._generateSplitBtn("Others_Cells_InsertCellOptions","Insert","textandimage",f+"_Ribbon_Ins",{dataSource:this._insertMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-insertsbtn","InsertTitle","InsertSBContent")]},{groups:[this._generateBtn("Others_Cells_DeleteCell","Delete","imageonly","e-icon e-ssr-delete",54,40,"DeleteTitle","DeleteContent",!1,u),this._generateSplitBtn("Others_Cells_DeleteCellOptions","Delete","textandimage",f+"_Ribbon_Del",{dataSource:this._deleteMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"",!1,54,this._mediumBtnHeight,"bottom","","dropdown","e-deletesbtn","DeleteTitle","DeleteContent")]}]};i.groups.push(n);n={text:"Editing",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateSplitBtn("Others_Editing_FindSelect","FindSelect","textandimage",f+"_Ribbon_FindRep",{dataSource:this._findMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-findselect",!1,55,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-findbtn","FindSelectTitle","FindSelectContent")]}]};i.groups.push(n);n={text:"Calculation",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Others_CalCulation_CalculationOptions","CalculationOptions","textandimage",f+"_Ribbon_CalcOpt",{dataSource:this._calcOptData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ss-calcopt",!1,67,this._splitBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-coptbtn","CalcOptTitle","CalcOptContent")]},{groups:[this._generateBtn("Others_CalCulation_CalculateNow","CalculateNow",e.TextAndImage,"e-icon e-ss-calcnow",110,30,"CalculateNow","CalculateNowContent"),this._generateBtn("Others_CalCulation_CalculateSheet","CalculateSheet",e.TextAndImage,"e-icon e-ss-calcsheet",110,30,"CalculateSheet","CalculateSheetContent")]}]};i.groups.push(n);this._tabCollection.push(i)},_renderRibbon:function(i){var r=this.XLObj,e=r._id,o=r.element,h=r.model,u=t.buildTag("div","","",{id:e+"_Ribbon"}),c=["HOME","INSERT","DATA","PAGE LAYOUT","REVIEW","OTHERS"],s,f;if(i?o.prepend(u):o.append(u),h.ribbonSettings.applicationTab.type==="menu"&&o.append(t.buildTag("ul","","",{id:e+"_Menu"})),click=t.SplitButton.prototype._documentClick,t.SplitButton.prototype._documentClick=function(t){n(t.target).is(".e-formatastable")||n(t.target).is(".e-formatastable-adaptive")||click.call(this,t)},s=["HOME","INSERT","PAGE LAYOUT","DATA","OTHERS","Format","DESIGN","Chart Design","Analyze"],r.model.ribbonSettings.enableOnDemand&&!r._isRibbonDestroyed)this._createTrgtElement("HOME");else for(f=0;f<s.length;f++)this._createTrgtElement(s[f],u);if(this._menuCustomize(),this._homeTabObj(),this._insertTabObj(),this._dataTabObj(),this._pageTabObj(),this._reviewTabObj(),this._otherTabObj(),this._contextualTabObj(),u.attr("style","overflow:hidden"),u.height(0),u.width(0),u.ejRibbon({width:"100%",allowResizing:!0,applicationTab:this._appTabCollection,tabs:this._tabCollection,contextualTabs:this._contextualTabCollection,tabClick:n.proxy(this._onTabClick,this),tabSelect:n.proxy(this._onTabSelect,this),create:n.proxy(this._onControlCreated,this),collapse:n.proxy(this._onCollapse,this),backstageItemClick:n.proxy(this._onBackStageItemClick,this),groupExpand:n.proxy(this._onGroupExpander,this),pinState:n.proxy(this._onRibbonPin,this),expand:n.proxy(this._onRibbonExpand,this),groupClick:n.proxy(this._onRibbonGroupClick,this),_destroyed:n.proxy(this._rbnDestroy,this),enableOnDemand:r.model.ribbonSettings.enableOnDemand,beforeTabClick:n.proxy(this._onBeforeTabClick,this)}),u.css("height","auto"),u.width("100%"),h.scrollSettings.isResponsive&&(u.ejRibbon("option",{allowResizing:!0}),(r._phoneMode||r._tabMode)&&r._orientation==="landscape"&&u.ejRibbon("collapse")),r.model.ribbonSettings.enableOnDemand&&!r._isRibbonDestroyed)this._homeTabControls(),this._updateRibCustomCss("HOME"),this._isHomeTabCreate=!0,this._hideRibbonElem("HOME");else for(this._isHomeTabCreate=!0,this._isInsertTabCreate=!0,this._isDataTabCreate=!0,this._isPageLayoutTabCreate=!0,this._isReviewTabCreate=!0,this._isOthersTabCreate=!0,this._isDesignTabCreate=!0,this._isFormatTabCreate=!0,this._isChartTabCreate=!0,this._analyzeTabCreate=!0,this._isAppTabCreate=!0,n("#"+e+"_Ribbon_review_Comments_5").css("vertical-align","middle"),f=0;f<6;f++)f!==1&&f!==4&&this._updateRibCustomCss(c[f]),this._hideRibbonElem(c[f]);this._hideOtherControls()},_createTabControls:function(t){var i=this.XLObj;switch(t){case"HOME":this._isHomeTabCreate||(this._homeTabControls(),this._isHomeTabCreate=!0,i._on(n("#"+i._id+"_cellstyles"),"click",i._cellStyleClick),i._on(n("#"+i._id+"_formatastable"),"click",i._formatAsTableClick),this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case"INSERT":this._isInsertTabCreate||(this._isInsertTabCreate=!0,i._on(n(".e-"+i._id+".e-chartcell"),"click",i._chartClickHandler),this._hideRibbonElem(t));break;case"DATA":this._isDataTabCreate||(this._isDataTabCreate=!0,this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case"PAGE LAYOUT":this._isPageLayoutTabCreate||(this._pageTabControls(),this._isPageLayoutTabCreate=!0,this._updateRibCustomCss(t),this._hideRibbonElem(t));break;case"REVIEW":this._isReviewTabCreate||(n("#"+i._id+"_Ribbon_review_Comments_5").css("vertical-align","middle"),this._isReviewTabCreate=!0,this._hideRibbonElem(t));break;case"OTHERS":this._isOthersTabCreate||(this._othersTabControls(),this._isOthersTabCreate=!0,this._updateRibCustomCss(t),i._on(n("#"+i._id+"_nmuseinformula"),"click",".e-nmuseinformularow",i._useInFormulaClick),this._hideRibbonElem(t));break;case"Format":this._isFormatTabCreate||(this._isFormatTabCreate=!0);break;case"DESIGN":this._isDesignTabCreate||(this._isDesignTabCreate=!0);break;case"Chart Design":this._isChartTabCreate||(this._isChartTabCreate=!0);break;case"Analyze":this._analyzeTabCreate||(this._isFormatTabCreate=!0)}},_createTrgtElement:function(t,i){var r=this.XLObj,i=i?i:n("#"+r._id+"_Ribbon");switch(t){case"HOME":this._isHomeTabTrgt||this._homeTabTrgtElem();this._isHomeTabTrgt=!0;break;case"INSERT":this._isInsertTabTrgt||this._onTabCreate();this._isInsertTabTrgt=!0;break;case"DATA":this._isDataTabTrgt||this._dataTabTrgtElem();this._isDataTabTrgt=!0;break;case"PAGE LAYOUT":this._isPageLayoutTabTrgt||this._pageTabTrgtElem(i);this._isPageLayoutTabTrgt=!0;break;case"OTHERS":this._isOthersTabTrgt||this._othersTabTrgtElem();this._isOthersTabTrgt=!0;break;case"Chart Design":this._isChartTabTrgt||this._renderChartDesignTab();this._isChartTabTrgt=!0;break;case"Analyze":this._analyzeTabTrgt||this._renderAnalyzeTab();this._analyzeTabTrgt=!0;break;case"Format":this._isFormatTabTrgt||this._renderFormatTab();this._isFormatTabTrgt=!0;break;case"DESIGN":this._isDesignTabTrgt||this._renderDesignTab();this._isDesignTabTrgt=!0}},_onTabCreate:function(){var i=this.XLObj,u=i._id,t=i.element,r=n("#"+i._id+"_Ribbon");t.append(this._chartType("ColumnChart",6,2,2,["column","stackingcolumn","stackingcolumn100","column","stackingcolumn","stackingcolumn100"],["ClusteredColumn","StackedColumn","Stacked100Column","Cluster3DColumn","Stacked3DColumn","Stacked100Column3D"]));t.append(this._chartType("BarChart",6,2,2,["bar","stackingbar","stackingbar100","bar","stackingbar","stackingbar100"],["ClusteredBar","StackedBar","Stacked100Bar","Cluster3DBar","Stacked3DBar","Stacked100Bar3D"]));t.append(this._chartType("StockChart",2,2,2,["radar","radar"],["Radar","RadarMarkers"]));t.append(this._chartType("LineChart",2,2,3,["line","line"],["Line","LineMarkers"]));t.append(this._chartType("AreaChart",3,3,3,["Area","stackingarea","stackingarea100"],["Area","StackedArea","Stacked100Area"]));t.append(this._chartType("PieChart",3,3,4,["pie","pie","doughnut"],["Pie","Pie3D","Doughnut"]));t.append(this._chartType("ScatterChart",1,2,2,["scatter"],["Scatter"]));r.append("<div id='"+i._id+"_nmuseinformula' class='e-nmuseinformula' style='width:125px'><\/div>")},_rbnDestroy:function(i){var r=this.XLObj,u=r._id,s="#"+u+"_Ribbon_Home_Font_FillColor",h="#"+u+"_Ribbon_Home_Font_FontColor",c="#"+u+"_Ribbon_PictureColor",e="#"+u+"_Ribbon_Home_Font_BorderColor",l="#"+u+"_Ribbon_BorderCP",a=n("#"+u+"_Ribbon").ejRibbon("instance"),v=a.getTabText(a.model.selectedItemIndex),y=r.model.ribbonSettings.enableOnDemand;if(n(s).data("ejColorPicker")&&n(s).ejColorPicker("destroy"),n(h).data("ejColorPicker")&&n(h).ejColorPicker("destroy"),n(c).data("ejColorPicker")&&n(c).ejColorPicker("destroy"),n(e).data("ejColorPicker")&&n(e).ejColorPicker("destroy"),n("#"+u+"_Ribbon_Home_Font_BorderColor_Presets").parent().remove(),n(l).data("ejColorPicker")&&n(l).ejColorPicker("destroy"),i&&!i.destroy){if(r._off(n("#"+u+"_cellstyles"),"click",r._cellStyleClick),r._off(n("#"+u+"_formatastable"),"click",r._formatAsTableClick),n(e)[0].style.display="none",r._off(n(".e-"+u+".e-chartcell"),"click",r._chartClickHandler),!y||this._isHomeTabTrgt&&v==="HOME"){var u=r._id,f=r.element,p=u+"_Ribbon_",o=p+"Home_Font_";f.append(t.buildTag("input","",{display:"none"},{id:o+"FillColor",type:"text"}));f.append(t.buildTag("input","",{display:"none"},{id:o+"FontColor",type:"text"}));f.append(t.buildTag("input","",{display:"none"},{id:o+"BorderColor",type:"text"}));f.append(t.buildTag("div.e-spreadsheet e-formatastable","",{display:"none"},{id:r._id+"_formatastable"}));r.element.append(this._renderCellStyles())}else this._isHomeTabTrgt=!1;!y||this._isInsertTabTrgt&&v==="INSERT"?this._onTabCreate():this._isInsertTabTrgt=!1;this._isHomeTabCreate=this._isInsertTabCreate=this._isDataTabCreate=this._isPageLayoutTabCreate=this._isReviewTabCreate=!1;this._isOthersTabCreate=this._isDesignTabCreate=this._isFormatTabCreate=this._isChartTabCreate=this._analyzeTabCreate=this._isAppTabCreate=!1;r._isRibbonDestroyed=!0}else n(document.body).append(n("#"+u+" _formatastable").parent()),n(document.body).append(n("#"+u+" _cellstyles").parent())},_updateRibCustomCss:function(n){var r=this.XLObj,i=r._id,y,p,w,b,u,s,a,t=0,k,h="Options",e,o,c,f,v;switch(n){case"HOME":var d="e-ssr-colpickHprt",g="_Ribbon_Home_Font",nt="_Ribbon_home_Font_Home_Font_",tt="_Ribbon_home_Clipboard_Home_Clipboard_Paste",st=["e-mergebtn","e-borderbtn","e-autosumbtn"],it=[i+nt+"FontFamily",i+nt+"FontSize"],rt=["e-ssr-fontfamily","e-ssr-fontsize"];for(c=[i+tt+h],o=[i+tt],e=[i+"_Ribbon_home_Clipboard_1"],f=[" e-ssr-pastebtnHprt"],r.addClass(document.getElementById(i+g+"_FillColorWrapper").children[0],d),r.addClass(document.getElementById(i+g+"_FontColorWrapper").children[0],d),b=r.element[0].querySelectorAll(".e-ssr-colpickHprt .e-color-container,.e-ssr-colpickHprt .e-select");t<4;)r.addClass(b[t],"e-ssr-colorcontainer"),t++;for(t=0;t<3;)r.addClass(document.querySelectorAll("."+st[t])[0].parentNode,"e-ssr-horizontalprt"),t++;for(t=0;t<2;)r.addClass(document.getElementById(it[t]),rt[t]),t++;break;case"DATA":v="_Ribbon_data_DataTools_Data_DataTools_DataValidation";c=[i+v+h];o=[i+v];e=[i+"_Ribbon_data_DataTools_1"];f=[" e-ssr-dtvaldtnHprt"];break;case"PAGE LAYOUT":var ut="_Ribbon_pagelayout_PageLayout_PageLayout_PageLayout_PageSize",ft="_Ribbon_PageLayout_Show_",it=["ej"+i+ft+"Headings","ej"+i+ft+"Gridlines"],rt=["e-vheading","e-vgridlines"];for(c=[i+ut+h],o=[i+ut],e=[i+"_Ribbon_pagelayout_PageLayout_1"],f=[" e-ssr-pagesizebtnHprt"," e-ssr-sizebtnHprt"],t=0;t<2;)r.addClass(document.getElementById(it[t]),rt[t]),t++;break;case"OTHERS":var et="InsertCell",l="_Ribbon_others_Cells_Others_Cells_",ot="DeleteCell";c=[i+l+et+h,i+l+ot+h];o=[i+l+et,i+l+ot];e=[i+"_Ribbon_others_Cells_1",i+"_Ribbon_others_Cells_2"];f=[" e-ssr-insertbtnHprt"," e-ssr-deletebtnHprt"]}for(t=0,k=e.length;t<k;)a=document.getElementById(e[t]),w=document.getElementById(o[t]),y=document.getElementById(o[t]),p=document.getElementById(c[t]),u=document.createElement("span"),u.className="e-ssr-verticalHparent"+f[t],u.style.display="inherit",a.insertBefore(u,w),u.appendChild(y),u.appendChild(p),f[0]===" e-ssr-pagesizebtnHprt"&&(s=document.createElement("span"),s.className="e-ssr-verticalHparent"+f[t+1],s.style.display="inherit",s.appendChild(u),a.appendChild(s)),t++},_hideOtherControls:function(){for(var t=0,i=["CElement","Paste","Border","Merge","SortFilter","Clear","ColumnChart","BarChart","Validation","PageSize","FPane","Ins","Del","FindRep","PastePic","PictureBorder","AutoSum","ResetPic","PictureBorder","StockChart","LineChart","AreaChart","PieChart","ScatterChart","color_Presets","PictureColor_Presets","Home_Font_BorderColor_Presets"],r=i.length;t--;)n("#"+this._id+"_Ribbon_"+i[t]).hide();for(t=0,i=["CFormat","formatastable","cellstyles","ctxtmenu"],r=i.length;t--;)n("#"+this._id+"_"+i[t]).hide()},_renderAppTab:function(){var i,n=this.XLObj,r=[];i="<div  id='"+n._id+"_backstagetabnew' style='display:none' class='e-ssr-bstabnew'><div class='e-ssr-bscontent' title='"+n._getLocStr("BlankWorkbook")+"'><div class='e-ssr-bsnewtmpl' ><button id='"+n._id+"_bstab_new_blank' type='button' class = 'e-rbn-button' ><\/button><\/div><\/div><\/div>";i=i.concat("<div id='"+n._id+"_backstagetabsaveas' style='display:none' class='e-ssr-bstabsaveas'><div class='e-ssr-bscontent'><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_excel' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsExcel")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_csv' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsCsv")+"<\/span><\/div><div class='e-ssr-bssaveasopt'><button id='"+n._id+"_bstab_saveas_pdf' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("SaveAsPdf")+"<\/span><\/div><\/div><\/div>");i=i.concat("<div id='"+n._id+"_backstagetabprint' style='display:none' class='e-ssr-bstabprint'><div class='e-ssr-bscontent'><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_sheet' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("PrintSheet")+"<\/span><\/div><div class='e-ssr-bsprintopt'><button id='"+n._id+"_bstab_print_selected' type='button' class = 'e-rbn-button'><\/button><span>"+n._getLocStr("PrintSelected")+"<\/span><\/div><\/div><\/div>");n.element.append(i);r.push({id:"new",text:n._getLocStr("New"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabnew"});r.push({id:"open",text:n._getLocStr("Open")+"...",itemType:t.Ribbon.itemType.tab});r.push({id:"saveas",text:n._getLocStr("SaveAs"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabsaveas"});r.push({id:"print",text:n._getLocStr("Print"),itemType:t.Ribbon.itemType.tab,contentID:n._id+"_backstagetabprint"});this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:n._getLocStr("File"),headerWidth:124,height:n._responsiveHeight-2,width:n._responsiveWidth-3,pages:r}}},_onBackStageItemClick:function(t){var i,e,r,f,u;if(this._isAppTabCreate||(this._appTabControls(),this._isAppTabCreate=!0),i=this.XLObj,f=i.model.ribbonSettings.applicationTab,i.XLEdit._isEdit&&i.XLEdit.saveCell(),i.XLComment&&i.XLComment._isCommentEdit&&i.XLComment._updateCurCmntVal(),i._isSheetRename&&!i._updateSheetNames(null,!1)){i.element.find("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");return}if(f.type==="menu"){if(e={element:t.element},i._trigger("menuClick",e))return;t.ID==="Open"?(i.XLEdit._isEdit&&i.XLEdit.saveCell(),this._bSBtnClickHandler(t.ID.toLowerCase(),t)):this._bSBtnClickHandler(t.ID.toLowerCase(),t)}if(f.type==="backstage")if(t.type==="backstageItemClick"){if(r={id:t.id,text:t.text,type:t.type,target:t.target,prop:t.model},i._trigger("menuClick",r))return;t.id==="open_backStageTab"&&(i.XLEdit._isEdit&&i.XLEdit.saveCell(),this._bSBtnClickHandler("open",t))}else{if(r={e:t.e,type:t.type,status:t.status,target:t.target,id:t.target.id},i._trigger("menuClick",r))return;n("#"+i._id+"_Ribbon").ejRibbon("hideBackstage");i._phoneMode&&n("#"+i._id+"_Ribbon").ejRibbon("goToMainContent");u=t.model.prefixIcon;this._bSBtnClickHandler(u.indexOf("blank")>-1?u.split("-")[2]:u.split("-")[3],t)}},_bSBtnClickHandler:function(i,r){var u=this.XLObj,f=u.getActiveSheetIndex();if(arg={id:r.id||r.target.id,status:r.status,prop:r.model,model:u.model},!u._trigger("ribbonClick",arg)){n("#"+u._id+"_Ribbon").ejRibbon("hideBackstage");switch(i){case"open":if(u.isDirty)u._showAlertDlg("confirm","ImportAlert","Open",470);else{if(u.model.importSettings.importMapper.length<1){u._showAlertDlg("Alert","ImportExportUrl");return}n("#"+u._id+"_file .e-uploadinput").click();u._browserDetails.name!="msie"&&u._browserDetails.name!="edge"&&n("#"+u._id+"_Ribbon_BackStage").show();n("#"+u._id+"_Ribbon").find(".e-backstagetitlecontent").text("").append("Open")}break;case"new":case"blank":u._isSheetsDirty()&&u._showAlertDlg("confirm","DestroyAlert","New",470);break;case"exportxl":u.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case"exportcsv":u.XLExport["export"](t.Spreadsheet.exportType.Csv);break;case"exportpdf":u.XLExport["export"](t.Spreadsheet.exportType.Pdf);break;case"print":u.XLPrint.printSheet(f);break;case"printselected":u.XLPrint.printSelection(f)}}},_contextualTabObj:function(){var u=this.XLObj,n=u._id,r="imagetop",i;i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"design",text:u._getLocStr("Design"),groups:[{text:"Properties",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_Ribbon_Design_Properties_TableProperties"},{text:"Tools",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Design_Tools_ResizeTable","ResizeTable","textandimage","e-icon e-ssr-resizetable",101,this._smallBtnHeight,"ResizeTable","ResizeTableContent"),this._generateBtn("Design_Tools_ConvertToRange","ConvertToRange","textandimage","e-icon e-ssr-range",130,this._smallBtnHeight,"ConvertToRange","ConvertToRangeContent")]}]},{text:"Table Style Options",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_Ribbon_Design_TableStyleOptions"}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#EAF6BD",borderColor:"#90AA3C",tabs:[{id:"chartdesign",text:"Chart Design",groups:[{text:"Chart Layouts",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("ChartDesign_ChartLayouts_AddChartElement","AddChartElement","textandimage",n+"_Ribbon_CElement","","e-icon e-ssr-celements",!0,65,this._bigBtnHeight,"bottom","imagetop","dropdown","e-spreadsheet e-chartlayoutbtn","AddChartElement","AddChartElementContent")]}]},{text:"Data",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("ChartDesign_Data_SwitchRowColumn","SwitchRowColumn","textandimage","e-icon e-ssr-srcolumn",72,this._bigBtnHeight,"SwitchRowColumn","SwitchRowColumnContent","","imagetop"),this._generateBtn("ChartDesign_Data_SelectData","SelectData","textandimage","e-icon e-ssr-selectdata",50,this._bigBtnHeight,"SelectData","SelectDataContent",!1,r)]}]},{text:"Type",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("ChartDesign_Type_ChangeChartType","ChartType","textandimage","e-icon e-ssr-charttype",65,this._bigBtnHeight,"ChartType","ChartTypeContent",!1,r)]}]},{text:"Chart Themes",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateDD("ChartDesign_ChartThemes_ChartThemes","ChartThemes",this._chartThemes,"1",130,this._smallBtnHeight,"ChartThemes","ChartThemesContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,content:[{groups:[{contentID:n+"_Ribbon_ChartDesign_Size_ChartSize",enableSeparator:!0,type:t.Ribbon.type.custom,height:80}]}]}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#FCFBEB",borderColor:"#F2CC1C",tabs:[{id:"format",text:"Format",groups:[{text:"Adjust",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Format_Adjust_ChangePicture","ChangePicture","textandimage","e-icon e-ssr-changepicture",120,this._mediumBtnHeight,"ChangePicture","ChangePictureContent"),this._generateSplitBtn("Format_Adjust_ResetPicture","ResetPicture","textandimage",n+"_Ribbon_ResetPic",{dataSource:this._resetPicture,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},"e-icon e-ssr-resetpicture",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-resetpictbtn","ResetPicture","ResetPictureContent")]}]},{text:"Border",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateSplitBtn("Format_Border_PictureBorder","PictureBorder","textandimage",n+"_Ribbon_PictureBorder","","e-icon e-ssr-pictureborder",!1,120,this._mediumBtnHeight,"left","","dropdown","e-ss-pictbrdrbtn","PictureBorder","PictureBorderContent")]}]},{text:"Size",alignType:t.Ribbon.alignType.columns,type:"custom",contentID:n+"_Ribbon_Format_Size_PictureSize"}]}]};this._contextualTabCollection.push(i);i={backgroundColor:"#FCF0F7",borderColor:"#C9599C",tabs:[{id:"analyze",text:"Analyze",groups:[{text:"PivotTable",alignType:t.Ribbon.alignType.rows,type:"custom",contentID:n+"_pvttableproperties"},{text:"DataSource",alignType:t.Ribbon.alignType.rows,content:[{groups:[this._generateBtn("Analyze_DataSource_Refresh","Refresh","textandimage","e-icon e-ssr-datarefresh",50,this._bigBtnHeight,"RefreshTitle","RefreshContent",!1,r),this._generateBtn("Analyze_DataSource_ChangeDataSource","ChangeDataSource","textandimage","e-icon e-ssr-changedatasource",50,this._bigBtnHeight,"ChangeDataSource","ChangeDataSourceContent",!1,r)]}]},{text:"Actions",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateBtn("Analyze_Actions_ClearAll","ClearAll","textandimage","e-icon e-ssr-pivotclearall",70,this._smallBtnHeight,"ClearAll","ClearAllContent",!1,"","e-datapadding"),this._generateBtn("Analyze_Actions_MovePivotTable","MovePivotTable","textandimage","e-icon e-ssr-movepivottable",120,this._smallBtnHeight,"MovePivotTable","MovePivotTableContent",!1,"","e-datapadding")]}]},{text:"Show",alignType:t.Ribbon.alignType.columns,content:[{groups:[this._generateToggleBtn("Analyze_Show_FieldList","FieldList","textandimage","e-icon e-ssr-fieldlist","FieldListTitle",50,this._bigBtnHeight,"FieldListContent",!1,"",r,null,null,!0)]}]}]}]};this._contextualTabCollection.push(i)},_onRibbonPin:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);this._ribbonState=!0;t.action="toggleBtn";i.model._isActPanelVisible=this._isPanelVisible;i._isAutoWHMode?this._refreshBackstageHeight():i._heightWidthCalculation(i.getActiveSheetIndex(),r,t);i.model._isActPanelVisible&&i._refreshActivationPanel()},_onRibbonExpand:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);t.action="toggleBtn";t.type==="expand"&&t.clickType==="dblclick"||i._phoneMode?(this._ribbonState=!0,i._isAutoWHMode?this._refreshBackstageHeight():i._heightWidthCalculation(i.getActiveSheetIndex(),r,t),this.XLObj.model._isActPanelVisible&&i._refreshActivationPanel()):this.XLObj.model._isActPanelVisible&&(i.getActivationPanel().hide(),this._isPanelVisible=i.model._isActPanelVisible,i.model._isActPanelVisible=!1,i._heightWidthCalculation(i.getActiveSheetIndex(),r,t))},_onRibbonGroupClick:function(t){var i=this.XLObj,r;i._phoneMode&&(n(t.target).parents(".e-resizegroupdiv").length>0||t.target.className.indexOf("e-resizegroupdiv")>-1||t.target.className.indexOf("e-ribdownarrow")>-1||t.target.className.indexOf("e-ribuparrow")>-1||t.target.className.indexOf("e-ribleftarrow")>-1)&&(r=n.extend(!0,{},i.model.scrollSettings),this._ribbonState=!0,t.action="toggleBtn",i.model._isActPanelVisible=this._isPanelVisible,i._isAutoWHMode?this._refreshBackstageHeight():i._heightWidthCalculation(i.getActiveSheetIndex(),r,t),i.model._isActPanelVisible&&i._refreshActivationPanel())},_hideTabs:function(){for(var r=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance"),i=["",this.XLObj._getLocStr("Design"),"Chart Design","Format","Analyze"],t=i.length;t=t-1;)r.hideTab(i[t])},_renderDesignTab:function(){var i=this.XLObj,r="",u=i._getLocStr("TableStyleOptions").split("/"),t=i._id+"_Ribbon_Design_TableStyleOptions";i.element.append("<input id="+i._id+'_tableid type="text" style = "display:none"/>');r="<div id="+i._id+'_Ribbon_Design_Properties_TableProperties><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">Table Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+i._id+'_Ribbon_Design_Properties_TableName class="ejinputtext" style="width:86px;opacity:0.7;height: 18px;text-indent: 3px;padding-left: 0px;box-sizing: content-box;" /><\/div><\/div><\/div>';r=r+"<div id="+t+'><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+t+'_FirstColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_FirstColumn">'+u[0]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+t+'_LastColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_LastColumn">'+u[1]+'<\/label><\/div><\/div><div class="e-tablestyleoptionsrow" ><div class="e-tablestyleoptionscell"><input id='+t+'_TotalRow type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_TotalRow">'+u[2]+'<\/label><\/div><div class="e-tablestyleoptionscell" ><input id='+t+'_FilterColumn type="checkbox" /><label class="e-tablestyleoptionslabel" for="'+t+'_FilterColumn">'+u[3]+"<\/label><\/div><\/div><\/div>";i.element.append(r);n("#"+t+"_FirstColumn").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_LastColumn").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_TotalRow").ejCheckBox({change:this._ribbonClickHandler});n("#"+t+"_FilterColumn").ejCheckBox({change:this._ribbonClickHandler})},_renderFormatTab:function(){var u=this.XLObj,f=u._id,e=u.element,i=f+"_Ribbon",r=i+"_Format_Size_";e.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"_ResetPic"}));e.append(this._borderPicture());e.append("<div id="+r+"PictureSize class= e-ss-numeric style='display:none'><table><tr><td style='padding-right:4px;'>"+u._getLocStr("Height")+": <\/label><\/td><td style='padding-bottom:3px;'><input id='"+r+"PictureHeight' type='text' /><\/td><\/tr><tr><td><labe>"+u._getLocStr("Width")+": <\/label><\/td><td><input id='"+r+"PictureWidth' type='text' /><\/td><\/tr><\/table><\/div>");n("#"+r+"PictureHeight").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"PictureWidth")});n("#"+r+"PictureWidth").ejNumericTextbox({name:"numeric",value:100,minValue:25,incrementStep:5,change:n.proxy(this._pictureSizeChange,this,"PictureHeight")});n("#"+i+"_PictureColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:this._ribbonClickHandler});n("#"+i+"_PictureColorWrapper").hide();n("#"+i+"_PictureColor_popup").css({"padding-left":"10px",width:"197px",display:"block"});n("#"+f+"picturecolor ul li").find("a").remove();n("#"+f+"picturecolor ul li").append(n("#"+i+"_PictureColor_popup"))},_renderAnalyzeTab:function(){var n=this.XLObj;n.element.find("#"+n._id+"_Ribbon_analyze_PivotTable_content").width(132);n.element.find("#"+n._id+"_pvttableproperties").length||n.element.append("<div id="+n._id+'_pvttableproperties style="display:none" ><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell">PivotTable Name:<\/div><\/div><div class="e-tablepropertiesrow" ><div class="e-tablepropertiescell"><input type="text" id='+n._id+'_Ribbon_Analyze_PivotTable_PivotTableName class="ejinputtext" style="width:106px;opacity:0.7;height: 18px;text-indent: 3px;" /><\/div><\/div><\/div>')},_renderChartDesignTab:function(){var u=this.XLObj,r=u.element,i=u._id,t=i+"_Ribbon_ChartDesign_Size_";r.append("<input id="+i+'_chart type="text" style="display:none;"/>');r.append(this._chartElementTag());r.append("<div id="+t+"ChartSize class= e-ss-numeric style='width: 180;height: 80;'><table><tr><td><label class ='e-icon e-ssr-chartheight' style='width:25;height:25;display: visible' id = "+i+"_Ribbon_chartheightlbl /><\/td><td><input id='"+t+"ChartHeight' type='text' /><\/td><\/tr><tr><td><label class ='e-icon e-ssr-chartwidth' style='width: 180;height: 80;' id = "+i+"_Ribbon_chartwidthlbl /><\/td><td><input id='"+t+"ChartWidth' type='text' /><\/td><\/tr><\/table><\/div>");n("#"+t+"ChartWidth").ejNumericTextbox({name:"numeric",value:200,minValue:180,decimalPlaces:1,incrementStep:5,change:this._ribbonClickHandler});n("#"+t+"ChartHeight").ejNumericTextbox({name:"numeric",value:200,minValue:180,decimalPlaces:1,incrementStep:5,change:this._ribbonClickHandler})},_renderNameManagerDlg:function(){var r,u,i=this.XLObj,f="<div id = '"+i._id+"_nmdlg' style=display:'none'; ><div class='e-dlgctndiv' ><div class='e-dlg-fields'><div id='"+i._id+"_nmgrid' style=display:'none';><\/div><\/div><div class='e-dlg-fields'><label class='e-dlg-fields'>"+i._getLocStr("RefersTo")+":<\/label><input type='text' class='e-nmrange ejinputtext' id='"+i._id+"_nmrange' disabled='true' /><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+i._id+"_nmclose' >"+i._getLocStr("Close")+"<\/button><\/div><\/div><\/div><\/div>";f=f+"<script id='"+i._id+"_nmeditortemplate' class='e-hide' type='text/template' ><div class='e-dlg-fields e-dlgctndiv'><table cellpadding='0' cellspacing='0'><tr><td>"+i._getLocStr("Name")+":<\/td><td><input id='"+i._id+"_nmgridname' type='text' class='ejinputtext' value='{{: name}}'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Scope")+":<\/td><td><input class='e-nmscope ejinputtext' id='"+i._id+"_nmgridscope' type='text' disabled='disabled' value='Workbook'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("Comment")+":<\/td><td><textarea id='"+i._id+"_nmgridcomment' class='e-ss-textarea' style=' resize: none; height: 44px; width: 100%;' value='{{: comment}}'>{{: comment}}<\/textarea><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+i._getLocStr("RefersTo")+":<\/td><td><input type='text' class='ejinputtext' id='"+i._id+"_nmgridrefersto' value='{{: refersto}}' /><\/td><\/tr><\/table><\/div><\/script>";i.element.append(f);r=i._dlgHeight>440&&!i._phoneMode?440:i._dlgHeight<380?i._responsiveHeight-2:i._dlgHeight;u=i._dlgWidth>510?510:i._dlgWidth<430?i._responsiveWidth-2:i._dlgWidth;n("#"+i._id+"_nmclose").ejButton({showRoundedCorner:!0,width:68,click:n.proxy(this._nmdlgClose,i)});n("#"+i._id+"_nmdlg").ejDialog({enableResize:!1,showOnInit:!1,title:i._getLocStr("NameManager"),enableModal:!0,width:u,height:i._isMaterial?r+110:r,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this),beforeClose:t.proxy(this._beforeDlgClose,this),open:t.proxy(this._nmDlgOpen,this)});this._renderNMGrid(r,u)},_renderNMGrid:function(i,r){var u=this.XLObj,f=n("#"+u._id+"_nmclose").outerHeight(!0)+11,e;f<40&&(f+=30);e=82+f+37+42+12;r=u._isMaterial?r-19:r;n("#"+u._id+"_nmgrid").ejGrid({dataSource:u.model.nameManager.slice(0),scrollSettings:{height:i-e,width:r-33},allowScrolling:!0,allowSorting:!0,enableAltRow:!1,cssClass:"e-ss-dialog ej-ssgrid e-"+u._id+"-dlg",selectionType:t.Grid.SelectionType.Single,editSettings:{allowAdding:!0,allowDeleting:!1,editMode:t.Grid.EditMode.DialogTemplate,dialogEditorTemplateID:"#"+u._id+"_nmeditortemplate"},toolbarSettings:{showToolbar:!0,toolbarItems:[t.Grid.ToolBarItems.Add]},actionBegin:n.proxy(this._nmActionBegin,u),actionComplete:n.proxy(this._nmActionComplete,u),rowSelected:n.proxy(this._nmRecordSelected,u),columns:[{field:"name",headerText:u._getLocStr("Name"),isPrimaryKey:!0,width:120},{field:"refersto",headerText:u._getLocStr("RefersTo"),width:120},{field:"scope",headerText:u._getLocStr("Scope"),width:80},{field:"comment",headerText:u._getLocStr("Comment"),width:160}]})},_updateNMRange:function(){var t=this.XLObj;n("#"+t._id+"_nmgridEditForm").find("#"+t._id+"_nmgridrefersto").val("="+t._getDollarAlphaRange(t.getSheet(t.getActiveSheetIndex()).selectedRange,!0))},_nmdlgClose:function(){n("#"+this._id+"_nmdlg").ejDialog("close")},_nmRecordSelected:function(t){n("#"+this._id+"_nmdlg").find(".e-nmrange").val(n("<div/>").html(t.data.refersto).text())},_nmDlgOpen:function(){var t=this.XLObj;this._isNmgrid==="DefineName"&&(n("#"+t._id+"_nmgrid").ejGrid("instance").addRecord(),n("#"+t._id+"_nmgridEditForm input")[0].focus());this._isNmgrid=""},_nmActionBegin:function(n){var t=0,u=!1,f,e,r,i=this.getSheet(this.getActiveSheetIndex());if(n.requestType==="save"){if(r=n.data,r.sheetIndex=this._getSheetIndexByName(n.data.refersto.split("!")[0].replace(/[=\']/g,"")),n.cancel=!0,!r.sheetIndex){this._showAlertDlg("Alert","InvalidSheetIndex","NMRangeAlert",275);return}if(i._nmEdit)for(e in i._nmValue){for(f=this.model.nameManager.length;t<f;){if(this.model.nameManager[t].name===i._nmValue.name){this.model.nameManager.splice(t,1);this._calcEngine.removeNamedRange(i._nmValue.name);break}t++}for(t=this._formulaCollection.length;t--;)if(this._formulaCollection[t].display===i._nmValue.name){u=!0;this._formulaCollection.splice(t,1);break}if(u)break}this.XLRibbon._validateNamedRange(r.name,r.refersto)?n.cancel=!1:u&&this.model.nameManager.push(i._nmValue)}n.requestType==="beginedit"&&(i._nmEdit=!0,i._nmValue={name:n.model.dataSource[n.model.selectedRowIndex].name,refersto:n.model.dataSource[n.model.selectedRowIndex].refersto,comment:n.model.dataSource[n.model.selectedRowIndex].comment,sheetIndex:n.model.dataSource[n.model.selectedRowIndex].sheetIndex,scope:n.model.dataSource[n.model.selectedRowIndex].scope})},_nmActionComplete:function(t){var r=n("#"+this._id+"_nmgrid").data("ejGrid"),f=t.requestType,i,u;switch(f){case"add":i=n("#"+this._id+"_nmgrid_dialogEdit").data("ejDialog");i.model.open=n.proxy(this.XLRibbon._updateNMRange(),this);i.option("allowDraggable",!1);i.option("title",this._getLocStr("NewName"));u=n("#"+this._id+"_nmgridEditForm").find("input[type='button']:first");u.data("ejButton").option("text","OK");u.parent().addClass("e-dlg-btnfields").css("text-align","right");break;case"save":this.XLRibbon._addNamedRange(r,t.data.name,t.data.refersto,t.data.comment,t.data.sheetIndex);break;case"delete":this.XLRibbon._removeNamedRange(r,t.data.name);break;case"cancel":r.element.focus()}},_updateNamedRanges:function(n,t,i){var r=this.XLObj;t=r.XLEdit._parseSheetRef(t,!0);r._calcEngine.addNamedRange(n,t.replace("=",""));r._formulaCollection.push({text:"="+n,display:n});i||r.XLEdit._refreshAutoComplete()},_updateUseInFormulaTrgt:function(){for(var i=0,t=this.XLObj,r="",e=n("#"+t._id+"_nmuseinformula"),u=t.model.nameManager,f=u.length;i<f;)r=r+"<div class='e-nmuseinformularow' style = 'color:#333333'>"+u[i].name+"<\/div>",i++;f?n("#"+t._id+"_Ribbon_Others_Formulas_UseInFormula").ejSplitButton("enable"):n("#"+t._id+"_Ribbon_Others_Formulas_UseInFormula").ejSplitButton("disable");e.html("<div>"+r+"<\/div>")},addNamedRange:function(t,i,r,u){var f=this.XLObj,e;f._showDialog(f._id+"_Ribbon_Others_NameManager");e=n("#"+f._id+"_nmgrid").data("ejGrid");this._validateNamedRange(t,i)&&(e.addRecord({name:t,refersto:i,comment:r?r:"",scope:"WorkBook",sheetIndex:u}),e.refreshContent())},_addNamedRange:function(n,t,i,r,u){var f=this.XLObj;f.model.nameManager=n.model.dataSource.slice(0);this._updateNamedRanges(t,i);this._updateUseInFormulaTrgt();f._isSheetNavigate||f._trigActionComplete({sheetIndex:u,reqType:"named-range",name:t,refersTo:i,comment:r})},removeNamedRange:function(t){if(t){var i=n("#"+this.XLObj._id+"_nmgrid").data("ejGrid");i.option("editSettings",{allowDeleting:!0});i.deleteRecord("name",{name:t});i.option("editSettings",{allowDeleting:!1})}},_removeNamedRange:function(n,t){var r,u,i=this.XLObj,f=i.model.nameManager[i.model.nameManager.length-1];if(i.model.nameManager=n.model.dataSource.slice(0),u=i.model.nameManager,i._calcEngine.removeNamedRange(t),i._updateFormulaCollection(),r=u.length,r)while(r--)i._formulaCollection.push({text:"="+u[r].name,display:u[r].name});this._updateUseInFormulaTrgt()},_validateNamedRange:function(t,i){var e,o,s,a,u,r=this.XLObj,h="NMRangeAlert",c="NMNameAlert",l="NMUniqueNameAlert",f;if(e=this._validateDollarRange(i),t&&t.length>0&&(o=/^([a-zA-Z_0-9]){0,255}$/.test(t)&&this._validateLibraryFunctions(t)),s=this._validateNameManager(t),r._isUndoRedo||e&&o&&s)return!0;a=n("#"+r._id+"_alertdlg");e?o?(u=r._getLocStr(l),f=l):(u=r._getLocStr(c).split("/")[0],f=c):(u=r._getLocStr(h),f=h);r._showAlertDlg("Alert","T-"+u,f,370)},_validateLibraryFunctions:function(n){var i,r=[],u=this.XLObj.getCalcEngine().getLibraryFunctions();n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();for(i in u.items)r.push(i);for(i=r.length;i--;)if(r[i]===n)return!1;return!0},_validateNameManager:function(n){var i=0,r=this.XLObj.model.nameManager,u=r.length;for(n=t.isNullOrUndefined(n)?"":n.toString().toUpperCase();i<u;){if(r[i].name.toUpperCase()===n)return!1;i++}return!0},_validateDollarRange:function(n){try{if(n&&n.indexOf("!")>-1)return n=n.split("!")[1].replace(/\$/g,""),this.XLObj.getRangeIndices(n),!0}catch(t){return!1}},_renderFormatAsTable:function(){for(var f,a,it,e=this.XLObj,u=0,at=[11,19],rt=0,l="",ut="",i="w:bold",r="c:#FFFFFF",t="c:#000000",p="c:#2F75B5",w="c:#ED7D31",b="c:#FFC000",o="1px solid #000000",s="1px solid #2f75b5",h="1px solid #ED7D31",c="1px solid #FFC000",k="b:#D9D9D9",v="b:#DDEBF7",d="b:#FCE4D6",g="b:#FFF2CC",ft="b:#000000",et="b:#FFE2C6",ot="b:#FFF1BF",y="b:#000000",st="b:#D7D7D7",nt="b:#FFC000",tt="b:#5B9BD5",ht="b:#Ed7D31",ct="hl?"+i+";"+t+";bo:tb-"+o+"&cl?"+k+";"+t+","+t+"&cb?b-"+o+"/hl?"+i+";bo:tb-"+s+";"+p+"&cl?"+v+";"+p+","+p+"&cb?b-"+s+"/hl?"+i+";bo:tb-"+h+";"+w+"&cl?"+d+";"+w+","+w+"&cb?b-"+h+"/hl?"+i+";bo:tb-"+c+";"+b+"&cl?"+g+";"+b+","+b+"&cb?b-"+c+"/hl?"+i+";"+ft+";"+r+";bo:o-"+o+"&cl?bo:t-"+o+";"+t+"&cb?o-"+o+"/hl?bo:o-"+s+";"+i+";"+tt+";"+r+"&cl?bo:t-"+s+";"+t+"&cb?o-"+s+"/hl?"+i+";b:#EB7E2F;"+r+";bo:o-"+h+"&cl?bo:t-"+h+";"+t+"&cb?o-"+h+"/hl?"+i+";"+nt+";"+r+";bo:o-"+c+"&cl?bo:t-"+c+";"+t+"&cb?o-"+c+"/hl?"+i+";bo:gb-"+o+";"+t+"&cl?"+k+";"+t+","+t+"&cb?gb-"+o+"/hl?"+i+";bo:gb-"+s+";"+t+"&cl?"+v+";"+t+","+t+"&cb?gb-"+s+"/hl?"+i+";bo:gb-"+h+";"+t+"&cl?"+d+";"+t+","+t+"&cb?gb-"+h+"/hl?"+i+";bo:gb-"+c+";"+t+"&cl?"+g+";"+t+","+t+"&cb?gb-"+c+"/hl?"+i+";"+ft+";"+r+"&cl?b:#A6A6A6;"+t+","+k+";"+t+"/hl?"+i+";"+tt+";"+r+"&cl?b:#BDD7EE;"+t+","+v+";"+t+"/hl?"+i+";"+ht+";"+r+"&cl?b:#F8CBAD;"+t+","+d+";"+t+"/hl?"+i+";"+nt+";"+r+"&cl?b:#FFE699;"+t+","+g+";"+t+"/hl?"+i+";"+st+";"+t+";bo:gb-"+o+"&cl?b:#A7A7A7;"+t+","+st+";"+t+"&cb?gb-"+o+"/hl?"+i+";b:#DBECF6;"+t+";bo:gb-"+s+"&cl?b:#BED8F1;"+t+","+v+";"+t+"&cb?gb-"+s+"/hl?"+i+";"+et+";"+t+";bo:gb-"+h+"&cl?b:#F6CAAD;"+t+","+et+";"+t+"&cb?gb-"+h+"/hl?"+i+";"+ot+";"+t+";bo:gb-"+c+"&cl?b:#FDE18D;"+t+","+ot+";"+t+"&cb?gb-"+c+"/hl?"+i+";"+y+";"+r+"&cl?b:#404040;"+r+",b:#737373;"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#2F75B5;"+r+","+tt+";"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#C65911;"+r+","+ht+";"+r+"/hl?"+i+";"+y+";"+r+"&cl?b:#BF8F00;"+r+","+nt+";"+r,lt=e._getLocStr("FATHeaderText").split("/"),vt=e._getLocStr("FormatAsTableTitle").split("/"),yt=["Light1","Light2","Light3","Light5","Light8","Light9","Light10","Light12","Light15","Light16","Light17","Light19","Medium8","Medium9","Medium10","Medium12","Medium22","Medium23","Medium24","Medium26","Dark1","Dark2","Dark3","Dark5"],ct=ct.split("/");u<24;)l=l+e._renderDIV("e-formatastablecell",'<div class="e-ss-cellstyles-'+(u+1)+'" ><\/div>'),u===at[rt]&&(l+="<\/br>",rt++),u++;for(u=0,l=l.split("<\/br>");u<lt.length*2;)ut+=e._renderDIV(u%2==0?"e-formatastableheader":"e-formatastablecontent",u%2==0?lt[u/2]:l[0]),u%2!=0&&l.shift(),u++;for(f=document.getElementById(e._id+"_formatastable"),f.innerHTML=ut,f=n(f),a=f.find(".e-formatastablecell"),u=0,it=a.length;u<it;)n(a[u]).attr("id","Table Style "+yt[u]),n(a[u]).attr("title","Table Style "+vt[u]),u++;return e.XLFormat&&(e.XLFormat._formatAsTableStyle=e._FATStyles.TableStyleLight1),f.find(".e-formatastableheader:eq(0)").append("<span id ='"+e._id+"_formatastable_back' class = 'e-formatastable-back e-icon e-ss-leftarrow'/>"),f.data("ejMenu").model.open=function(){f.scrollTop(0)},f},_renderFATNameDlg:function(){var r,i=this.XLObj,u=i._getLocStr("FATNameDlgText").split("/"),f={showRoundedCorner:!0,width:"27%",click:n.proxy(this._fatNameDlgBtnClick,this)};r="<div id="+i._id+'_fatnamedlg><div class="e-dlg-fields e-dlgctndiv e-ss-nmdlg"><table cellspacing="0" cellpadding="0"><tr><td>'+u[0]+'<\/td><td><input id="'+i._id+'_fatname" class="ejinputtext" /><\/td><\/tr><tr class="e-dlgtd-fields"><td><\/td><td><input type="checkbox" id="'+i._id+'_fatheader" style="background-color:#ffffff"/> <label for="'+i._id+'_fatheader" style="margin-left: 4px;">'+u[1]+'<\/label><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatnamedlgok>"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(r);dlgWidth=286;n("#"+i._id+"_fatheader").ejCheckBox();n("#"+i._id+"_fatnamedlgok").ejButton(f);n("#"+i._id+"_fatnamedlgcancel").ejButton(f);i._isMaterial&&(dlgWidth=320);n("#"+i._id+"_fatnamedlg").ejDialog({showOnInit:!1,width:dlgWidth,showRoundedCorner:!0,title:i._getLocStr("FormatAsTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderChartNameDlg:function(){var r,i=this.XLObj,f=i._getLocStr("ChartTitleDlgText"),u={showRoundedCorner:!0,width:"23%",click:n.proxy(this._chartNameDlgBtnClick,this)};r="<div id="+i._id+'_chartnamedlg ><div class="e-dlg-fields e-dlgctndiv"><table cellpadding="0" cellspacing="0"><tr><td>'+f+'<\/td><td><input id="'+i._id+'_chartname" class="ejinputtext" /><\/td><\/tr><\/table><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_chartnamedlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_chartnamedlgcancel>"+i._getLocStr("Cancel")+"<\/button><\/div><\/div>";i.element.append(r);n("#"+i._id+"_chartnamedlgok").ejButton(u);n("#"+i._id+"_chartnamedlgcancel").ejButton(u);n("#"+i._id+"_chartnamedlg").ejDialog({showOnInit:!1,width:"334px",minHeight:"auto",showRoundedCorner:!0,title:i._getLocStr("ChartTitle"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_renderFATResizeTableDlg:function(){var i=this.XLObj,r={showRoundedCorner:!0,width:"15%",click:n.proxy(this._fatResizeTableBtnClick,this)},u="<div id="+i._id+'_fatresizetabledlg ><div class="e-dlgctndiv"><table><tr><td>'+i._getLocStr("FATResizeTableText")+'<\/td><td style="width: 50%;"><input id="'+i._id+'_fatresizetablerange" class="ejinputtext" style="margin-left: 2px;"><\/td><\/tr><\/table><div class="e-dlg-fields">'+i._getLocStr("FATReizeTableNote")+'<\/div><\/div><div class="e-dlg-btnfields"><div class="e-dlg-btnctnr"><button id='+i._id+"_fatresizetabledlgok >"+i._getLocStr("Ok")+"<\/button><button id="+i._id+"_fatresizetabledlgcancel >"+i._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>";i.element.append(u);n("#"+i._id+"_fatresizetabledlgok").ejButton(r);n("#"+i._id+"_fatresizetabledlgcancel").ejButton(r);n("#"+i._id+"_fatresizetabledlg").ejDialog({showOnInit:!1,width:"494px",showRoundedCorner:!0,title:i._getLocStr("ResizeTable"),enableModal:!0,enableResize:!1,cssClass:"e-ss-dialog e-"+i._id+"-dlg",close:t.proxy(this._dialogClose,this)})},_fatResizeTableBtnClick:function(t){var r=this.XLObj,h,f=document.getElementById(r._id+"_fatresizetablerange").value,o=r.getActiveSheetIndex(),e,i=document.getElementById(r._id+"_tableid").value,u=r.getSheet(o).tableManager,c,s;e={sheetIndex:o,reqType:"format-table",action:"Design_Tools_ResizeTable",tableId:i};canclose=!0;t.model.text===r._getLocStr("Ok")&&(r._isvalidRange(f)?(f=f.indexOf(":")!=-1?r.getRangeIndices(f):[],h=this._validateResizeRange(f,u[i].range),h?r._showAlertDlg("Alert",h,"",500):(e.beforeRange=n.extend(!0,[],u[i].range),u[i].totalRow?(c=n("#"+r._id+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox"),r._dupDetails=!0,c.option("checked",!1),u[i].range=[f[0],f[1],f[2]-1,f[3]]):u[i].range=f,this._isFilterSelect.isFiltered&&r.XLFilter._clearFilterTable(o,parseInt(i),!0),r.XLFormat._createTable(i,{format:u[i].format}),r.XLFilter._extendFilterRange(i,u[i].range),u[i].range[2]==f[2]-1&&(r._dupDetails=!0,c.option("checked",!0)),u[i].firstColumn&&(r._dupDetails=!0,s=r._getProperAlphaRange(o,u[i].range[0]+1,u[i].range[1],u[i].range[2],u[i].range[1]),r.XLFormat.format({style:{"font-weight":"bold"}},s),r._dupDetails=!1),u[i].lastColumn&&(r._dupDetails=!0,s=r._getProperAlphaRange(o,u[i].range[0]+1,u[i].range[3],u[i].range[2],u[i].range[3]),r.XLFormat.format({style:{"font-weight":"bold"}},s),r._dupDetails=!1),e.afterRange=f,e.format=u[i].format,e.formatName=u[i].formatName,e.header=n.extend(!0,{},r.model.sheets[o]._header),e.isFilter=u[i].isFilter,e.firstColumn=u[i].firstColumn,e.lastColumn=u[i].lastColumn,e.totalRow=u[i].totalRow,r.XLSelection.selectRange(u[i].range),r._completeAction(e))):(canclose=!1,r._showAlertDlg("Alert","InvalidReference","",375)));canclose&&n("#"+r._id+"_fatresizetabledlg").ejDialog("close")},_fatNameDlgBtnClick:function(t){var r,i=this.XLObj,u=i._id;n("#"+u+"_fatnamedlg").ejDialog("close");t.model.text===i._getLocStr("Ok")&&(r={header:n("#"+u+"_fatheader").ejCheckBox("checked"),name:document.getElementById(u+"_fatname").value,format:i.XLFormat._formatAsTableStyle.format},i.XLFormat._formatAsTableStyle.formatName&&(r.formatName=i.XLFormat._formatAsTableStyle.formatName),i.XLFormat.createTable(r))},_validateResizeRange:function(n,t){var i=this.XLObj;if(n.length){if(n[0]!=t[0]||n[1]!=t[1])return"ResizeAlert";if(n[3]!=t[3]||n[2]<t[2])return"ResizeRestrictAlert";if(n[2]>i.getSheet(i.getActiveSheetIndex()).rowCount)return"RangeNotCreated"}else return"InvalidReference"},_chartNameDlgBtnClick:function(t,i){var e,u,r=this.XLObj,h=r.getActiveSheetIndex(),s=r.getSheet(h).shapeMngr.chart[r.XLEdit.getPropertyValue(r.XLShape._picCellIdx.rowIndex,r.XLShape._picCellIdx.colIndex,"chart")[0]],f,o=r._id,c=document.getElementById(o+"_chart").value;if(e=n("#"+c).data("ejChart"),u={sheetIndex:h,reqType:"shape",shapeType:"chart",cid:c,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{},cur:{}},f=i||document.getElementById(o+"_chartname").value,t.model.text===r._getLocStr("Ok")){if(!f.length){r._showAlertDlg("Alert","InvalidTitle","InvalidChartTitleActn",375);return}switch(r._hasTitle){case"PX":e.option("primaryXAxis",{title:{text:f}});s.xAxis.title.text=f;u.action="PX";break;case"PY":e.option("primaryYAxis",{title:{text:f}});s.yAxis.title.text=f;u.action="PY";break;case"CT":e.option("title",{text:f});s.title.text=f;u.action="CT"}}u.prev.text=r._cOpt.prevText;r._hasTitle=="CT"&&(u.prev.align=r._cOpt.prevAlign,u.cur.align=r._cOpt.curAlign);u.cur.text=f;r._completeAction(u);r._cOpt={};document.getElementById(o+"_chartname").value="";n("#"+o+"_chartnamedlg").ejDialog("close")},_designTabUpdate:function(t,i){var r=this.XLObj;if(r.model.showRibbon&&!r._phoneMode){var u=r._id,e,o=n("#"+r._id+"_Ribbon").ejRibbon("instance"),f=r.getSheet(r.getActiveSheetIndex()).tableManager;o.showTab(r._getLocStr("Design"));this._isDesignTab&&!o._isCollapsed&&o.option({selectedItemIndex:this._getTabIndex("design")});document.getElementById(r._id+"_Ribbon_Design_Properties_TableName")&&(document.getElementById(r._id+"_Ribbon_Design_Properties_TableName").value=f[t].name);document.getElementById(r._id+"_tableid")&&(document.getElementById(r._id+"_tableid").value=t);this._isSetModel=!0;n("#"+u+"_Ribbon_Design_TableStyleOptions_TotalRow").data("ejCheckBox").option({checked:f[t].totalRow?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FirstColumn").data("ejCheckBox").option({checked:f[t].firstColumn?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_LastColumn").data("ejCheckBox").option({checked:f[t].lastColumn?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FilterColumn").data("ejCheckBox").option({enabled:r.model.allowFiltering?!0:!1});n("#"+u+"_Ribbon_Design_TableStyleOptions_FilterColumn").data("ejCheckBox").option({checked:f[t].isFilter?!0:!1});this._isSetModel=!1;e=n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton");e&&this._changeClrFltrStatus(e,"button",i)}},_formatTabUpdate:function(){var t=this.XLObj;if(t.model.showRibbon&&!t._phoneMode){var i=n("#"+t._id+"_Ribbon").ejRibbon("instance"),r=t.element.find("#"+t._id+"_Ribbon_Format_Size_PictureHeight"),u=t.element.find("#"+t._id+"_Ribbon_Format_Size_PictureWidth");i.showTab("Format");t._shapeChange=!0;r.length&&r.ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").height());u&&u.ejNumericTextbox("option","value",t.element.find(".e-ss-activeimg").width());t.model.showRibbon&&!i._isCollapsed&&i.option({selectedItemIndex:t.XLRibbon._getTabIndex("format")});t._shapeChange=!1}},_analyzeTabUpdate:function(){var t=this.XLObj,r,i;if(!t.model.enablePivotTable)return!1;r=t.element.find("#"+t._id+"_Ribbon_Analyze_PivotTable_PivotTableName");i=n("#"+t._id+"_Ribbon").data("ejRibbon");r.length&&r.val(t.XLPivot.names[t._getContent(t.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id]);i.showTab("Analyze");i._isCollapsed||i.option({selectedItemIndex:t.XLRibbon._getTabIndex("analyze")})},_chartDesignTabUpdate:function(t){var i=this.XLObj;if(i.model.showRibbon&&!i._phoneMode){var r=n("#"+i._id+"_Ribbon").data("ejRibbon"),f=t.get(0).id,e=t.get(0).offsetLeft,o=t.get(0).offsetTop,u=r.element.find("#"+i._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes");i.XLShape._picCellIdx=i.XLShape._getCellIndexFromOffset(o,e);r.showTab("Chart Design");r._isCollapsed||r.option({selectedItemIndex:i.XLRibbon._getTabIndex("chartdesign")});document.getElementById(i._id+"_chart").value=f;this._isSetModel=!0;this._setShapeWidthHeight({height:t.height(),width:t.width(),shapeType:"chart"});u.length&&u.ejDropDownList("setSelectedValue",t.ejChart("option","theme"));this._isSetModel=!1;i.model.allowFormulaBar&&i.updateFormulaBar()}},_setShapeWidthHeight:function(t){var i=this.XLObj,r,u;t.shapeType=="chart"?(r=n("#"+i._id+"_Ribbon_ChartDesign_Size_ChartWidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_ChartDesign_Size_ChartHeight").data("ejNumericTextbox")):(r=n("#"+i._id+"_Ribbon_Format_Size_PictureWidth").data("ejNumericTextbox"),u=n("#"+i._id+"_Ribbon_Format_Size_PictureHeight").data("ejNumericTextbox"));i._shapeChange=!0;i.model.showRibbon&&(u.option({value:t.height}),r.option({value:t.width}));i._shapeChange=!1},changeDimension:function(t){var u=this.XLObj,h=u.getActiveSheetIndex(),o,c,e,s,f,i={sheetIndex:h,reqType:"shape",rowIndex:u.XLShape._picCellIdx.rowIndex,colIndex:u.XLShape._picCellIdx.colIndex,actionType:"shapechange"},r;t.shapeType=="picture"?(o=u.getSheetElement(h).find(".e-ss-activeimg"),f=o.length?o[0]:n("#"+t.id),i.prev={width:f.width(),height:f.height()},c=n("#"+t.id),e={width:t.width,height:t.height},c.css(e),i.action="picturesize",i.shapeType="picture",i.cur={width:f.width(),height:f.height()}):(r=n("#"+t.id).data("ejChart"),i.prev={width:r.model.size.width,height:r.model.size.height},e={width:t.width.toString(),height:t.height.toString()},s=r.element,r.option("size",e),s[0].style.height=t.height+"px",s[0].style.width=t.width+"px",i.action="width",i.shapeType="chart",i.cid=t.id,i.cur={width:r.model.size.width,height:r.model.size.height});u._completeAction(i);this._setShapeWidthHeight(t)},_toggleDesignTab:function(i){var r=this.XLObj,f,u,e=r.getActiveSheetIndex();r.model.showRibbon&&(u=n("#"+r._id+"_Ribbon").data("ejRibbon"),(t.isNullOrUndefined(r.XLEdit.getPropertyValue(i.rowIndex,i.colIndex,"tableName"))||r.getSheetElement(e).find(".e-ss-activeimg").length)&&(u.hideTab(r._getLocStr("Design")),u._isCollapsed||u.option({selectedItemIndex:1})));f=n("#"+r._id+"_Ribbon_Data_SortFilter_ClearFilter").data("ejButton");this._changeClrFltrStatus(f,"button",i)},_toggleChartDesignTab:function(){this._toggleContextualTab("Chart Design")},_toggleFormatTab:function(){this._toggleContextualTab("Format")},_toggleAnalyzeTab:function(){this._toggleContextualTab("Analyze")},_toggleContextualTab:function(t){var r=this.XLObj,i;r.model.showRibbon&&(i=n("#"+r._id+"_Ribbon").data("ejRibbon"),i.hideTab(t),i._isCollapsed||i.option({selectedItemIndex:1}))},_getTabIndex:function(t){if(this.XLObj.model.showRibbon){for(var u=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("model"),r=u.tabs,f=u.contextualTabs,i=0;i<f.length;)r=r.concat(f[i].tabs),i++;for(i=r.length;i--;)if(r[i].id===t)return++i}},_getFormatAsTableInput:function(n){var h=this.XLObj,t,r,e,i,o=0,u=0,c=[],s={hl:"headerLayout",cl:"contentLayout",hb:"headerBorder",cb:"contentBorder"},f={};for(n=n.split("&");o<n.length;){if(e=n[o].split("?"),t=e[0],r=e[1],t==="hl")f[s[t]]=h._getStyleAsJSON(r,!0);else if(t==="cl"){for(i=r.split(",");u<i.length;)c.push(i[u].length?h._getStyleAsJSON(i[u],!0):{}),u++;f[s[t]]=c}else t==="cb"&&(i=r.split("-"),f[s[t]]={border:this._getBorderObj(i[0],i[1])});o++}return f},_getBorderObj:function(n,t){var r,i={t:{top:""},r:{right:""},b:{bottom:""},l:{left:""},o:{top:"",right:"",bottom:"",left:""},tb:{top:"",bottom:""},gb:{top:"",right:"",bottom:"",left:""}};for(r in i[n])i[n][r]=t;return n==="gb"&&(i[n].isGridBorder=!0),i[n]},_renderCellStyles:function(){for(var s,r,t=0,e=4,o=[],h="e-cellstylecell ",i="",u=this.XLObj,f=u._dataContainer.hashCode,l=u._getLocStr("CellStyleHeaderText").split("/"),v=u._getLocStr("CellStyleGBN").split("/"),y=[f[0],f[1],f[2],f[3]],p=u._getLocStr("CellStyleTH").split("/"),a=f.slice(4,6),w=u._getLocStr("CellsStyleTCS").split("/"),b=f.slice(6,18),c;t<e;)r=v[t],i=i+u._renderDIV(h+y[t],r,r),t++;for(o.push(i),i="",t=0,e=2;t<e;)r=p[t],i=t===1?i+'<div class="'+h+a[t]+'"  style="font-size: 11pt;" title="'+r+'">'+r+"<\/div>":i+u._renderDIV(h+a[t],r,r),t++;for(o.push(i),i="",t=0,e=12;t<e;)r=w[t],i=i+u._renderDIV(h+b[t],r,r),t++;for(o.push(i),i="",t=0;t<l.length*2;)s=t%2,i=i+u._renderDIV(s===0?"e-cellstyleheader":"e-cellstylecontent",s===0?l[t/2]:o[0]),s!=0&&o.shift(),t++;return c=n("<div id="+u._id+'_cellstyles class="e-spreadsheet e-cellstyles" style="display:none;">'+i+"<\/div>"),c.find(".e-cellstyleheader:eq(0)").append("<span id ='"+u._id+"_cellstyles_back' class = 'e-cellstyles-back e-icon e-ss-leftarrow'/>"),c},_homeTabTrgtElem:function(){var r=this.XLObj,u=r._id,n=r.element,i=u+"_Ribbon_",f=i+"Home_Font_";n.append(t.buildTag("input","",{display:"none"},{id:f+"FillColor",type:"text"}));n.append(t.buildTag("input","",{display:"none"},{id:f+"FontColor",type:"text"}));n.append(t.buildTag("input","",{display:"none"},{id:f+"BorderColor",type:"text"}));n.append(t.buildTag("div.e-spreadsheet e-formatastable","",{display:"none"},{id:r._id+"_formatastable"}));n.append(this._renderCellStyles());n.append(t.buildTag("ul","",{display:"none"},{id:u+"_Ribbon_Merge"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"Paste"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"Border"}));n.append(t.buildTag("ul.e-spreadsheet","",{display:"none"},{id:u+"_CFormat"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"Clear"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"SortFilter"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"AutoSum"}))},_pageTabTrgtElem:function(i){var f=this.XLObj,a=f._id,p=f.element,e,o,s,h,c,l,v,y,r=a+"_Ribbon_",u=r+"PageLayout_Show_";i=f.isUndefined(i)?n("#"+a+"_Ribbon").data("ejRibbon").element:i;p.append(t.buildTag("ul","",{display:"none"},{id:r+"PageSize"}));e=t.buildTag("div","",{width:"140",height:"80",display:"none"},{id:r+"pagesetup"});o=t.buildTag("div","",{width:"70",height:"80",float:"left"},{id:r+"pagesetupleft"});s=t.buildTag("table");tr=t.buildTag("tr");tr1=t.buildTag("tr");h=t.buildTag("td","",{padding:"6px 0px 6px 6px"});c=t.buildTag("td","",{padding:"6px 0px 6px 6px"});l=t.buildTag("td","",{padding:"6px 0px 6px 6px"});td12=t.buildTag("td","",{padding:"6px 0px 6px 6px"});v=t.buildTag("label.e-viewlinlbl","",{width:"40"},{id:r+"pagesetup_viewgrdlnlbl","for":u+"Gridlines"});y=t.buildTag("label.e-viewhdrlbl","",{width:"40",display:"visible"},{id:r+"pagesetup_viewhdrlbl","for":u+"Headings"});headerVchk=t.buildTag("input","","",{id:u+"Headings"});gridVchk=t.buildTag("input","","",{id:u+"Gridlines"});h.append(gridVchk);c.append(v);tr.append(h).append(c);l.append(headerVchk);td12.append(y);tr1.append(l).append(td12);s.append(tr1).append(tr);o.append(s);e.append(o);i.append(e)},_othersTabTrgtElem:function(){var r=this.XLObj,u=r._id,n=r.element,i=u+"_Ribbon_";n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"FPane"}));n.append(t.buildTag("ul","",{width:"auto"},{id:i+"Ins"}));n.append(t.buildTag("ul","",{width:"auto"},{id:i+"Del"}));n.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:i+"FindRep"}));n.append(t.buildTag("ul","",{display:"none"},{id:i+"CalcOpt"}))},_dataTabTrgtElem:function(){var n=this.XLObj;n.element.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:n._id+"_Ribbon_Validation"}))},_formatTabTrgtElem:function(){var n=this.XLObj;n.element.append(t.buildTag("ul","",{width:"auto",display:"none"},{id:n._id+"_Ribbon_ResetPic"}))},_onBeforeTabClick:function(n){this.XLObj.model.ribbonSettings.enableOnDemand&&this._createTrgtElement(n.activeHeader.innerText)},_onTabClick:function(t){var i=this.XLObj,u=n.extend(!0,{},i.model.scrollSettings),r=t.activeHeader.innerText;i._trigger("beforeTabClick",t);t.prevActiveIndex!==-1&&i.model.allowComments&&i.model.allowEditing&&(i.XLEdit._isEdit||i.XLComment._isCommentEdit||i._isSheetRename||!i.getSheet(i.getActiveSheetIndex()).isSheetProtected)&&!this._isDirtySelect&&this._enableRibbonIcons(t.activeIndex);i.model.ribbonSettings.enableOnDemand&&this._createTabControls(r);i._trigger("tabClick",t)},_onCollapse:function(t){var i=this.XLObj,r=n.extend(!0,{},i.model.scrollSettings);(this._ribbonState||t.isMobile)&&(i._phoneMode||(this._ribbonState=!1),t.action="toggleBtn",i._isAutoWHMode?this._refreshBackstageHeight():i._heightWidthCalculation(i.getActiveSheetIndex(),r,t),i.model._isActPanelVisible&&i._refreshActivationPanel())},_onTabSelect:function(t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),u;i.model.showRibbon&&(i.XLEdit._isEdit||i.model.allowComments&&i.XLComment._isCommentEdit||i._isSheetRename||r.isSheetProtected?this._disableRibbonIcons():this._enableRibbonIcons(),this._updateRibbonIcons(),i.model.isReadOnly&&i._readOnly(),i._phoneMode&&(u=n.extend(!0,{},i.model.scrollSettings),this._ribbonState=!0,t.action="toggleBtn",i.model._isActPanelVisible=this._isPanelVisible,i._isAutoWHMode?this._refreshBackstageHeight():i._heightWidthCalculation(i.getActiveSheetIndex(),u,t)));i.XLEdit.getPropertyValue(r._activeCell.rowIndex,r._activeCell.colIndex,"tableName")&&(this._isDesignTab=t.activeIndex==this._getTabIndex("design")||t.activeIndex==this._getTabIndex("format")||t.activeIndex==this._getTabIndex("chartdesign"));i._trigger("tabSelect",t)},_valDTypeOnChange:function(t){var i=this.XLObj;n.validator&&n("#"+i._id+"_Form_ValDialog").validate().resetForm();t.value==="Between"||t.value==="NotBetween"?(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("NumberStart"))):(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr("DataValue")));this._dialogValidate("_ValDialog")},_valTypeOnChange:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");r.enable();t.value==="List"?(n("#"+i._id+"_Ribbon_lbMax").hide(),n("#"+i._id+"_Ribbon_btnMax").hide(),r.disable()):(r._selectedValue==="Between"||r._selectedValue==="NotBetween")&&(n("#"+i._id+"_Ribbon_lbMax").show(),n("#"+i._id+"_Ribbon_btnMax").show());n("#"+i._id+"_Ribbon_lbMin").text(i._getLocStr(t.selectedText+"Start"));n("#"+i._id+"_Ribbon_lbMax").text(i._getLocStr(t.selectedText+"End"));this._dialogValidate("_ValDialog")},_valDlgBtnClick:function(t){var i=this.XLObj,f,e;if(t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid()){var s=n("#"+i._id+"_Ribbon_blank").data("ejCheckBox"),h=n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").isChecked(),o=n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList"),v=n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList");if(o._selectedValue==="List"){var r=n("#"+i._id+"_Ribbon_btnMin").val(),a=r,c,u,f=n("#"+i._id+"_alertdlg"),l;if(r.indexOf("=")>-1){if(r=r.split("=")[1],r.indexOf("!")>-1&&(c=r.split("!"),e=i._getSheetIndexByName(c[0]),r=c[1]),e===!1){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(r.indexOf("$")>-1&&(r=r.split("$").join("")),r.indexOf(":")<0&&(r=r+":"+r),e=i.isUndefined(e)?i.getActiveSheetIndex():e,l=i.getSheet(e),u=i.getRangeIndices(r),isNaN(u[0])||isNaN(u[1])||isNaN(u[2])||isNaN(u[3])||l.colCount<=u[3]||l.rowCount<=u[2]){i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}if(u[2]===u[0]||u[3]===u[1])i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h);else{i._renderAlertDlgContent(f,"Alert",i._getLocStr("ListValAlert"),"ListValidation");i._alertDialog.element.ejDialog("open")&&f.focus();return}}else i.XLValidate.applyDVRules(null,["list",a],this._types[o.selectedIndexValue].value,s.isChecked(),h)}else i.XLValidate.applyDVRules(null,[this._actions[v.selectedIndexValue].value,n("#"+i._id+"_Ribbon_btnMin").val(),n("#"+i._id+"_Ribbon_btnMax").val()],this._types[o.selectedIndexValue].value,s.isChecked(),h);i._setddlCell()}else n.validator||(t="cancel");(t==="cancel"||t==="ok"&&n.validator&&n("#"+i._id+"_Form_ValDialog").valid())&&(n("#"+i._id+"_Ribbon_ddType").data("ejDropDownList").option({selectedItemIndex:0}),n("#"+i._id+"_Ribbon_ddAction").data("ejDropDownList").option({selectedItemIndex:6}),n("#"+i._id+"_Ribbon_blank").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_freetext").data("ejCheckBox").option({checked:!0}),n("#"+i._id+"_Ribbon_btnMin").val(""),n("#"+i._id+"_Ribbon_btnMax").val(""),n("#"+i._id+"_ValDialog").ejDialog("close"),i.setSheetFocus())},_renderValDialog:function(i){var r=this.XLObj,o,l,f,v,k,d;if(n("#"+r._id+"_Ribbon_MainDiv").length<1){var y=t.buildTag("div.e-dlgctndiv","",{},{height:"100%"}),s=t.buildTag("div.e-dlg-fields","",{},{id:r._id+"_Ribbon_MainDiv"}),p,h=0,w=0,b;n("#"+r._id+"_Validation").append(s);o=t.buildTag("label.e-dlg-fields",r._getLocStr("Allow"));s.append(o);l=t.buildTag("input.e-"+r._id+"-ddl","","",{id:r._id+"_Ribbon_ddType",type:"text"});s.append(l);l.ejDropDownList({dataSource:this._types,fields:{id:"Types",text:"text",value:"text"},selectedItemIndex:1,cssClass:"e-"+r._id+"-ddl",width:"100%",height:25,change:n.proxy(this._valTypeOnChange,this)});var c=t.buildTag("input#"+r._id+"_Ribbon_blank"),a=t.buildTag("label",r._getLocStr("IgnoreBlank"),{},{"for":r._id+"_Ribbon_blank"}),e=t.buildTag("table"),f=t.buildTag("tr"),u=t.buildTag("td","",{},{width:30});u.append(c);f.append(u);u=t.buildTag("td");u.append(a);f.append(u);e.append(f);c.ejCheckBox();c=t.buildTag("input#"+r._id+"_Ribbon_freetext");a=t.buildTag("label#"+r._id+"_Ribbon_lblfreetext",r._getLocStr("FreeText"),{},{"for":r._id+"_Ribbon_lblfreetext"});f=t.buildTag("tr#"+r._id+"_val_freetext");u=t.buildTag("td","",{},{width:30});u.append(c);f.append(u);u=t.buildTag("td");u.append(a);f.append(u);e.append(f);i<375&&f.hide();n("#"+r._id+"_Validation").height(i-128);s.append(e);c.ejCheckBox({checked:!0});o=t.buildTag("label.e-dlg-fields").text(r._getLocStr("Data"));s.append(o);v=t.buildTag("input.e-"+r._id+"-ddl","","",{id:r._id+"_Ribbon_ddAction",type:"text"});s.append(v);v.ejDropDownList({dataSource:this._actions,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:6,cssClass:"e-"+r._id+"-ddl",width:"100%",height:25,change:n.proxy(this._valDTypeOnChange,this)});p=t.buildTag("div.e-dlgctndiv e-dlg-fields","",{},{id:r._id+"_Ribbon_SubDiv"});e=t.buildTag("table");f=t.buildTag("tr");u=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:r._id+"_Ribbon_lbMin"}).text(r._getLocStr("NumberStart"));e.append(f.append(u.append(o)));f=t.buildTag("tr");u=t.buildTag("td");k=t.buildTag("input.ejinputtext","",{width:"100%"},{id:r._id+"_Ribbon_btnMin",type:"text",name:r._id+"_valMin"});e.append(f.append(u.append(k)));f=t.buildTag("tr");u=t.buildTag("td");o=t.buildTag("label.e-dlg-fields","","",{id:r._id+"_Ribbon_lbMax"}).text(r._getLocStr("NumberEnd"));e.append(f.append(u.append(o)));f=t.buildTag("tr");u=t.buildTag("td");d=t.buildTag("input.ejinputtext","",{width:"100%"},{id:r._id+"_Ribbon_btnMax",type:"text",name:r._id+"_valMax"});e.append(f.append(u.append(d)));y.append(s,p.append(e));n("#"+r._id+"_Validation").append(y);n("#"+r._id+"_Ribbon_SubDiv").wrapInner('<form id="'+r._id+'_Form_ValDialog" onsubmit="return false"><\/form>');this._dialogValidate("_ValDialog");h=n("#"+r._id+"Dialog_OkBtn").outerHeight(!0)+11;h<40&&(h+=4);b=i-(r._isMaterial?95+h:46+h);r._phoneMode&&(w=3);n("#"+r._id+"_ValDialog_valDlgTab").find(".e-content:eq(0)").height(b-(26+(r._isMaterial?30:15)+w))}},_dialogValidate:function(t,i){var f=this.XLObj,e=f._id,l,tt=n("#"+e+"_Form"+t),o,r,a,v,s,y,p,u,w,b,h,k=!0,c,d,g,nt;if(n.validator){tt.validate({errorElement:"div",wrapper:"div",errorPlacement:function(n,t){n.insertAfter(t.closest("input"));n.children().addClass("e-dlg-field-validation-error");n.css({position:"relative"});n.offset({left:t.offset().left,top:t.offset().top+19})},onfocusout:function(n){this.element(n)}});c=n("#"+e+"_Ribbon_ddAction").ejDropDownList("getValue");switch(t){case"_ValDialog":l=n("#"+e+"_Ribbon_ddType").data("ejDropDownList");o=l.getSelectedValue();break;case"_CFDialog":o=i===e+"_CreateRule"?"formulaRule":i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();break;case"_GoToDiv":o="cellAddr";break;case"_Ribbon_PvtRange":case"_Ribbon_PvtLocation":case"_Ribbon_cellAddress":o="cellAddr";break;case"_Ribbon_webAddress":o="webAddr"}for(n("#"+e+"_Form"+t).validate().resetForm(),u=[],p=n("#"+e+"_Form"+t).find("input").length,y={required:!0,date:!0,messages:{date:f._getLocStr("DateValidationMsg"),required:f._getLocStr("RequiredField")}},v={required:!0,celladdr:!0},w={required:!0,numberVal:!0},g={required:!0,number:!0,messages:{required:f._getLocStr("RequiredField"),number:f._getLocStr("NumberValidationMsg")}},b={required:!0,time:!0},s={required:!0},d={required:!0,betweentype:!0},nt={required:!0,formularule:!0},n.validator.addMethod("time",function(n){return n===""||n.match(/^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])(:([0-5]?[0-9]))?(\s(AM|am|PM|pm))?$/)},f._getLocStr("TimeValidationMsg")),n.validator.addMethod("date",function(n,t){var i=n.split("/");return this.optional(t)||!/Invalid|NaN/.test(new Date(/chrom(e|ium)/.test(navigator.userAgent.toLowerCase())?n:i[1]+"/"+i[0]+"/"+i[2]))},f._getLocStr("DateValidationMsg")),n.validator.addMethod("celladdr",function(t,i){var f,o=n(i).data("parentID"),r=n("#"+o).data("ejSpreadsheet"),u,e;return n("#"+r._id+"_Ribbon_sheentName").length&&(u=n("#"+r._id+"_Ribbon_sheentName").ejTreeView("option","selectedNode")),(r.isUndefined(u)||u<0)&&(u=r.getActiveSheetIndex()),t.indexOf("=")>-1&&(t=t.split("=")[1]),t.indexOf("!")>-1&&(h=t.split("!"),u=r._getSheetIndexByName(h[0]),t=h[1]),u<1&&(k=!1),e=r.getSheet(u),t.indexOf("$")>-1&&(t=t.split("$").join("")),f=r.getRangeIndices(t),f=e.colCount<=f[3]||e.rowCount<=f[2]?null:t,(t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9]):(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)||t.match(/^(?:\bxfXF[a-zA-D]|xX[a-eA-E][a-zA-Z]|[a-wA-W][a-zA-Z]{2}|[a-zA-Z]{2}|[a-zA-Z])\$?(?:104857[0-6]|10485[0-6]\d|1048[0-4]\d{2}|104[0-7]\d{3}|10[0-3]\d{4}|[1-9]\d{1,5}|[1-9])$/)&&k)&&f},f._getLocStr("CellAddrsValidationMsg")),n.validator.addMethod("betweentype",function(t,i){var e=i.id.split("_")[0],f=n("#"+i.id.split("_")[0]+"_Ribbon_ddType").ejDropDownList("getSelectedValue"),r=n("#"+e+"_Ribbon_btnMin").val(),u=n("#"+i.id.split("_")[0]+"_Ribbon_btnMax").val();return(r===""||u===""||parseFloat(r)>parseFloat(u))&&(t=null),f==="Date"&&Date.parse(r)>Date.parse(u)&&(t=null),f==="Time"&&new Date("01/01/1990 "+r).getTime()>new Date("01/01/1990 "+u).getTime()&&(t=null),t},f._getLocStr("BetweenAlert")),n.validator.addMethod("numberVal",function(t){if(n.isNumeric(t))return parseFloat(t)%1!=0&&(t=null),n.validator.messages.numberVal=f._getLocStr("NumberValMsg"),t;n.validator.messages.numberVal=f._getLocStr("NumberAlertMsg")},n.validator.messages.numberVal),n.validator.addMethod("formularule",function(n){return n===""||n.startsWith("=")&&n.indexOf("!")<0},f._getLocStr("FormulaRuleMsg")),r=0,a=p;r<a;r++){u[r]=n("#"+e+"_Form"+t).find("input")[r].id;switch(o){case"Date":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",y);break;case"Time":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",b);break;case"Number":case"TextLength":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",w);break;case"Decimal":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",g);break;case"List":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"cellAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",v);break;case"webAddr":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",s);break;case"formulaRule":n("#"+u[r]).rules("remove");n("#"+u[r]).rules("add",nt)}o!=="List"&&(c==="Between"||c==="NotBetween")&&n("#"+e+"_Ribbon_btnMax").rules("add",d)}}},_renderCFDialog:function(i){var u,o,f,e,s,r=this.XLObj,h;s=n("#"+r._id+"_CFDialog").data("ejDialog");i.ID===r._id+"_CreateRule"?s.option({title:r._getLocStr("NewRule")}):s.option({title:r._getLocStr(this._cFormatData[i.ID][0])});n("#"+r._id+"_Ribbon_CFSubDiv").length<1&&(o=t.buildTag("div.e-dlg-fields","",{},{id:r._id+"_Ribbon_CFSubDiv"}),f=t.buildTag("label.e-dlg-fields").text(r._getLocStr("With")),o.append(f),h=t.buildTag("input.e-"+r._id+"-ddl","",{},{id:r._id+"_Ribbon_ddStyle",type:"text"}),o.append(h),h.ejDropDownList({dataSource:this._styles,fields:{id:"Types",text:"text",value:"value"},selectedItemIndex:0,cssClass:"e-"+r._id+"-ddl",width:"100%",height:25,change:n.proxy(this._ddOnChange,this)}),n("#"+r._id+"_CondFormat").append(o),n("#"+r._id+"_CondFormat").addClass("e-cfdiv"));n("#"+r._id+"_Ribbon_CFMainDiv").length>0&&n("#"+r._id+"_Ribbon_CFMainDiv").remove();u=t.buildTag("div.e-dlg-fields","","",{id:r._id+"_Ribbon_CFMainDiv"});n("#"+r._id+"_CondFormat").prepend(u);i.ID=="between"&&(e=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input2",type:"text"}),u.prepend(e),f=t.buildTag("label.e-dlg-fields").text(r._getLocStr("And")).css("display","table"),u.prepend(f));e=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_input1",type:"text"});u.prepend(e);f=i.ID===r._id+"_CreateRule"?t.buildTag("label.e-dlg-fields").text(r._getLocStr("NewRuleLabelContent")):t.buildTag("label.e-dlg-fields").text(r._getLocStr(this._cFormatData[i.ID][1]));u.prepend(f);(i.ID==="aboveavg"||i.ID==="belowavg")&&e.hide();n("#"+r._id+"_Ribbon_CFMainDiv").wrapInner('<form id="'+r._id+'_Form_CFDialog" onsubmit="return false"><\/form>');this._dialogValidate("_CFDialog",i.ID)},_dlgCFOk:function(){var t=this.XLObj,i,r;n("#"+t._id+"_Form_CFDialog").valid()&&(i=n("#"+t._id+"_Ribbon_ddStyle").data("ejDropDownList"),r=t.XLRibbon._currentCFormat===t._id+"_CreateRule"?"formularule":t.XLRibbon._currentCFormat,t.XLCFormat._cFormat(r,n("#"+t._id+"_Ribbon_input1").val(),n("#"+t._id+"_Ribbon_input2").val(),i.getSelectedValue()),n("#"+t._id+"_CFDialog").ejDialog("close"),t.setSheetFocus())},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_Form_CFDialog").validate().resetForm();n("#"+t._id+"_CFDialog").ejDialog("close");t.setSheetFocus()},_sheetData:function(){var r=this.XLObj,u=[],t=[],n,f,i=r._getSheetNames();for(t[0]={id:1,name:r._getLocStr("SheetReference"),hasChild:!0,expanded:!0},n=1,f=i.length;n<=f;n++)i[n-1].isVisible&&(u[n]=i[n-1].text,t[n]={id:n+1,pid:1,name:u[n],hasChild:!0,expanded:!0});return t},_renderHLDialog:function(){var i=this.XLObj,c,u,f,s,h,o,e,r,l;n("#"+i._id+"_Ribbon_WebDiv").length<1&&(c=t.buildTag("div.e-dlgctndiv","",{},{id:i._id+"_Ribbon_WebDiv"}),e=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_findText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("WebAddress"),"",{id:i._id+"_Ribbon_address"}),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_webAddress",type:"text"}),r.append($td.append(f)),n("#"+i._id+"_Web").append(c.append(e)),s=t.buildTag("div.e-dlgctndiv","","",{id:i._id+"_Ribbon_DocDiv"}),l=t.buildTag("div.e-dlg-fields"),e=t.buildTag("table"),r=t.buildTag("tr"),$td=t.buildTag("td","",{width:"32%"}),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("HyperlinkText")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellText",type:"text"}),r.append($td.append(f)),r=t.buildTag("tr.e-dlgtd-fields"),$td=t.buildTag("td"),e.append(r.append($td)),u=t.buildTag("label",i._getLocStr("CellAddress")),$td.append(u),$td=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:i._id+"_Ribbon_cellAddress",type:"text"}),f.data("parentID",i._id),r.append($td.append(f)),o=t.buildTag("div.e-dlg-fields","","",{id:i._id+"_Ribbon_Sheet"}),s.append(l.append(e),o),u=t.buildTag("label",i._getLocStr("SheetIndex")),o.append(u),h=t.buildTag("div","","",{id:i._id+"_Ribbon_sheentName"}),o.append(h),h.ejTreeView({fields:{id:"id",parentId:"pid",text:"name",hasChild:"hasChild",dataSource:this._sheetData(),expanded:"expanded"},nodeSelect:n.proxy(this._sheetSelect,i),height:90}),n("#"+i._id+"_Doc").append(s),n("#"+i._id+"_Ribbon_cellAddress").wrap("<form id='"+i._id+"_Form_Ribbon_cellAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_cellAddress"),n("#"+i._id+"_Ribbon_webAddress").wrap("<form id='"+i._id+"_Form_Ribbon_webAddress' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_webAddress"))},_sheetSelect:function(t){var i,u,f=this._getSheetNames(),r=n("#"+this._id+"_Ribbon_cellAddress"),e=n("#"+this._id+"hlDialog_OkBtn").data("ejButton"),o=n("#"+this._id+"_Ribbon_cellText");if(t.model.selectedNode>0)for(r.attr("disabled",!1),e.enable(),r.focus().setInputPos(1),i=0,u=f.length;i<u;i++)f[i].text===o.val().split("!")[0]&&o.val(t.value+"!"+r.val());else r.attr("disabled",!0),e.disable()},_dlgHLOk:function(){var t=this.XLObj;n("#"+t._id+"_Form_Ribbon_cellAddress").valid()&&n("#"+t._id+"_Form_Ribbon_webAddress").valid()&&(this.XLObj._dlgHLClick=!0,t._setLink(),this._dlgHLCancel())},_dlgHLCancel:function(){n("#"+this.XLObj._id+"_HLDialog").ejDialog("close")},_renderFRDialog:function(){var h,f,c,l,s,e,a,r=this.XLObj,o,u,i;n("#"+r._id+"_Ribbon_FindDiv").length<1&&(h=t.buildTag("div.e-dlgctndiv","",{height:"auto"},{id:r._id+"_Ribbon_FindDiv"}),n("#"+r._id+"_Find").append(h),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"26%"}),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("FindLabel"),"",{id:r._id+"_Ribbon_lbFind"}),i.append(f),i=t.buildTag("td"),c=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textFind",type:"text"}),i.append(c),u.append(i),u=t.buildTag("tr"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("ReplaceLabel"),"",{id:r._id+"_Ribbon_lbReplace"}),i.append(f),i=t.buildTag("td"),l=t.buildTag("input.ejinputtext","","",{id:r._id+"_Ribbon_textReplace",type:"text"}),i.append(l),u.append(i),h.append(o),n("#"+r._id+"_Ribbon_lbReplace").hide(),n("#"+r._id+"_Ribbon_textReplace").hide(),a=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_Ribbon_SettingsDiv"}),o=t.buildTag("table"),u=t.buildTag("tr"),i=t.buildTag("td","",{width:"50%"}),o.append(u.append(i)),s=t.buildTag("input#"+r._id+"_Ribbon_Case"),f=t.buildTag("label",r._getLocStr("MatchCase"),{},{"for":r._id+"_Ribbon_Case"}),i.append(s),i.append(f),s.ejCheckBox(),i=t.buildTag("td"),s=t.buildTag("input#"+r._id+"_Ribbon_AllContent"),f=t.buildTag("label",r._getLocStr("MatchAll"),{},{"for":r._id+"_Ribbon_AllContent"}),i.append(s),s.ejCheckBox(),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label").text(r._getLocStr("Within")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label").text(r._getLocStr("Search")),i.append(f),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddWithin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._within,{id:"Types",text:"text",value:"value"},0,110,25)),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddSearch",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._sType,{id:"Types",text:"text",value:"value"},0,120,25)),u.append(i),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),f=t.buildTag("label",r._getLocStr("Lookin")),i.append(f),i=t.buildTag("td"),f=t.buildTag("label",r._getLocStr("Replace")+" "+r._getLocStr("Direction")),u.append(i.append(f)),u=t.buildTag("tr.e-dlgtd-fields"),i=t.buildTag("td"),o.append(u.append(i)),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddLookin",type:"text"}),i.append(e),e.ejDropDownList(r._generateEJDD(this._vType,{id:"Types",text:"text",value:"value"},0,110,25,"Type")),i=t.buildTag("td"),e=t.buildTag("input","","",{id:r._id+"_Ribbon_ddDirection",type:"text"}),u.append(i.append(e)),e.ejDropDownList(r._generateEJDD(this._direction,{id:"Types",text:"text",value:"value"},0,120,25)),n("#"+r._id+"_Settings").append(a.append(o)))},_frTypeChange:function(t,i){t==="Type"&&i.value==="comment"?(n("#"+this._id+"_Ribbon_textReplace").attr("disabled",!0),n("#"+this._id+"FR_ReplaceBtn").ejButton("disable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("disable")):(n("#"+this._id+"_Ribbon_textReplace").prop("disabled",!1),n("#"+this._id+"FR_ReplaceBtn").ejButton("enable"),n("#"+this._id+"FR_ReplaceAllBtn").ejButton("enable"))},_hlTabChange:function(t){var i=this.XLObj,s=n("#"+i._id+"_Ribbon_sheentName").data("ejTreeView"),r=i.getActiveSheetIndex(),h=n("#"+i._id+"_Doc"),c=n("#"+i._id+"_Web"),l=n("#"+i._id+"_Ribbon_webAddress"),f=n("#"+i._id+"_Ribbon_findText"),u=n("#"+i._id+"_Ribbon_cellAddress"),e=n("#"+i._id+"_Ribbon_cellText"),a=i.getActiveCell(r),o=i.XLEdit.getPropertyValue(a.rowIndex,a.colIndex,"hyperlink",r);switch(t.activeIndex){case 0:l.focus().setInputPos(l.val().length);f.val(e.val());h.hide();c.show();n("#"+i._id+"hlDialog_OkBtn").ejButton("enable");break;case 1:u.val().length||u.val("A1");h.show();c.hide();o&&o.cellAddr&&(r=parseInt(o.cellAddr.split("_")[1]));s.selectNode(r+1);f.val().length?e.val(f.val()):e.val(s.getText(r+1)+"!A1");u.focus().setInputPos(u.val().length)}},_findTabChange:function(t){var r,i=this.XLObj;switch(t.activeIndex){case 0:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").hide();n("#"+i._id+"_Ribbon_textReplace").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Find").append(r);n("#"+i._id+"FR_PrevBtn").show();n("#"+i._id+"FR_NextBtn").show();n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 1:r=n("#"+i._id+"_Ribbon_FindDiv");n("#"+i._id+"_Ribbon_lbReplace").show();n("#"+i._id+"_Ribbon_textReplace").show();n("#"+i._id+"FR_ReplaceBtn").show();n("#"+i._id+"FR_ReplaceAllBtn").show();i._phoneMode?(n("#"+i._id+"FR_PrevBtn").hide(),n("#"+i._id+"FR_NextBtn").hide()):(n("#"+i._id+"FR_PrevBtn").show(),n("#"+i._id+"FR_NextBtn").show());n("#"+i._id+"_Replace").append(r);n("#"+i._id+"_Ribbon_textFind").focus().setInputPos(n("#"+i._id+"_Ribbon_textFind").val().length);break;case 2:n("#"+i._id+"FR_PrevBtn").hide();n("#"+i._id+"FR_NextBtn").hide();n("#"+i._id+"FR_ReplaceBtn").hide();n("#"+i._id+"FR_ReplaceAllBtn").hide();n("#"+i._id+"_Ribbon_ddWithin").focus();i._phoneMode?n("#"+i._id+"_Ribbon_SettingsDiv").find("td:eq(1)").hide():n("#"+i._id+"_Ribbon_SettingsDiv").find("td:eq(1)").show()}},_gotoTabChange:function(t){var i=this.XLObj;t.activeIndex==0&&n("#"+i._id+"_textRef").focus().setInputPos(n("#"+i._id+"_textRef").val().length)},_btnFROnClick:function(t){var i=this.XLObj;i.showWaitingPopUp();var r=i.getActiveSheetIndex(),c=i.getSheet(r)._startCell.rowIndex,l=i.getSheet(r)._startCell.colIndex,u=n("#"+i._id+"_Ribbon_Case").data("ejCheckBox").isChecked(),f=n("#"+i._id+"_Ribbon_AllContent").data("ejCheckBox").isChecked(),e=this._within[n("#"+i._id+"_Ribbon_ddWithin").data("ejDropDownList").selectedIndexValue].value,s=this._sType[n("#"+i._id+"_Ribbon_ddSearch").data("ejDropDownList").selectedIndexValue].value,o=this._vType[n("#"+i._id+"_Ribbon_ddLookin").data("ejDropDownList").selectedIndexValue].value,a=this._direction[n("#"+i._id+"_Ribbon_ddDirection").data("ejDropDownList").selectedIndexValue].value,h;switch(t){case"FR_NextBtn":case"FR_PrevBtn":i.XLSearch._findCount=0;h=t==="FR_NextBtn"?i.XLSearch._findNext(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s):i.XLSearch._findPrev(n("#"+i._id+"_Ribbon_textFind").val(),r,u,f,o,e,s);h||(i.XLSearch._updateSelection(c,l,r),i.hideWaitingPopUp(),i._showAlertDlg("Alert","NotFound"));break;case"FR_ReplaceBtn":i.XLSearch._replaceData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),r,u,f,o,a,e,s);break;case"FR_ReplaceAllBtn":i.XLSearch._replaceAllData(n("#"+i._id+"_Ribbon_textFind").val(),n("#"+i._id+"_Ribbon_textReplace").val(),u,f,o,e);break;case"FR_CloseBtn":n("#"+i._id+"_FRDialog").ejDialog("close");i.setSheetFocus()}i.hideWaitingPopUp()},_renderGoToDialog:function(i){var e,c,f,l,o,r=this.XLObj,u,s=i-194,h=129,a=n("#"+r._id+"Dialog_GoOkBtn").outerHeight(!0)+11;a>40&&(s-=7,h+=7);r._isMaterial&&(s=i-350,h=189);n("#"+r._id+"_GoToDiv").length<1&&(e=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_GoToDiv"}),n("#"+r._id+"_GoTo").append(e),u=t.buildTag("div.e-dlg-fields"),f=t.buildTag("label.e-dlg-fields",r._getLocStr("GoToName")),l=t.buildTag("ul#"+r._id+"_GotoAddr"),e.append(u.append(f,l)),n("#"+r._id+"_GotoAddr").ejListBox({dataSource:this._addrList,height:s.toString(),width:"247px",selected:n.proxy(this._gotoValChange,this),fields:{id:"Types",text:"text",value:"value"}}),u=t.buildTag("div.e-dlg-fields"),f=t.buildTag("label.e-dlg-fields",r._getLocStr("Reference")),o=t.buildTag("input.ejinputtext","","",{id:r._id+"_textRef",type:"text"}),o.data("parentID",r._id),e.append(u.append(f,o)),c=t.buildTag("div#"+r._id+"_GoToSpDiv.e-dlgctndiv","",""),u=t.buildTag("div.e-dlg-fields e-dlgctndiv"),n("#"+r._id+"_GoToSp").append(c.append(u)),n("#"+r._id+"_GoToSp").css("overflow","auto").height(i-h),f=t.buildTag("label.e-dlg-fields").text(r._getLocStr("Select")).css("display","table"),u.append(f),this._renderGotoSp(u,this._gotoRBtnSet1,this._gotoRBtnSet2,this._gotoChkBox),n("#"+r._id+"_GoToDiv").wrapInner('<form id="'+r._id+'_Form_GoToDiv" onsubmit="return false"><\/form>'),this._dialogValidate("_GoToDiv"))},_renderGotoSp:function(i,r,u,f){for(var l,c,s,e,h=this.XLObj,v=h._id+"_gotoSpDiv",a,y=t.buildTag("table"),o=0;o<r.length;o++)s=t.buildTag("tr","",{height:35}),e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+r[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,r[o])}),e=t.buildTag("td","",{width:100}),c=t.buildTag("label",h._getLocStr(r[o]),{},{"for":v+"_"+r[o]}),e.append(c),s.append(e),h.isUndefined(u[o])||(e=t.buildTag("td"),l=t.buildTag("input#"+v+"_"+u[o],"",{},{type:"radio",name:"gotospecial"}),e.append(l),s.append(e),l.ejRadioButton({size:"medium",change:n.proxy(this._rBtnOnClick,this,u[o])}),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(u[o]),{},{"for":v+"_"+u[o]}),e.append(c),s.append(e)),y.append(s);for(o=0;o<f.length;o=o+2)s=t.buildTag("tr"),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o]),{},{"for":h._id+"_"+f[o]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),e=t.buildTag("td"),a=t.buildTag("input#"+h._id+"_"+f[o+1]),e.append(a),s.append(e),e=t.buildTag("td"),c=t.buildTag("label",h._getLocStr(f[o+1]),{},{"for":h._id+"_"+f[o+1]}),e.append(c),s.append(e),a.ejCheckBox({checked:!0,enabled:!1}),y.append(s);i.append(y);n("#"+v+"_Blanks").ejRadioButton("option",{checked:!0})},_renderPvtDialog:function(){var r=this.XLObj,s,e,o,u,i,f;n("#"+r._id+"_Ribbon_PvtDiv").length<1&&(s=t.buildTag("div.e-dlgctndiv","",{},{id:r._id+"_Ribbon_PvtDiv"}),o=t.buildTag("table","",{},{cellpadding:0,cellspacing:0}),u=t.buildTag("tr.e-ss-changerange"),i=t.buildTag("td","",{width:"11%"}),e=t.buildTag("label",r._getLocStr("Range")),i.append(e),u.append(i),i=t.buildTag("td","",{width:"32%"}),f=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_PvtRange",type:"text"}),f.data("parentID",r._id),u.append(i.append(f)),o.append(u),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),e=t.buildTag("label",r._getLocStr("ChoosePivotTable")),i.append(e),i.attr("colspan",2).css({"padding-top":4,"padding-bottom":4}),o.append(u.append(i)),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),i.attr("colspan",2).css("padding-left","15px"),f=t.buildTag("input#"+r._id+"_dlg_newsheet","",{},{type:"radio",name:"sheet"}),i.append(f),e=t.buildTag("label"," "+r._getLocStr("NewWorksheet")),i.append(e),o.append(u.append(i)),f.ejRadioButton({size:"medium",checked:!0,change:n.proxy(this._rBtnPvtOnClick,this,"new")}),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),i.attr("colspan",2).css("padding-left","15px"),f=t.buildTag("input#"+r._id+"_dlg_existsheet","",{},{type:"radio",name:"sheet"}),i.append(f),e=t.buildTag("label"," "+r._getLocStr("ExistingWorksheet")),i.append(e),o.append(u.append(i)),f.ejRadioButton({size:"medium",change:n.proxy(this._rBtnPvtOnClick,this,"existing")}),u=t.buildTag("tr.e-ss-movepvttbl"),i=t.buildTag("td"),e=t.buildTag("label",r._getLocStr("Location")),i.append(e),u.append(i),i=t.buildTag("td"),f=t.buildTag("input.ejinputtext","",{},{id:r._id+"_Ribbon_PvtLocation",type:"text"}),f.data("parentID",r._id),u.append(i.append(f)),o.append(u),n("#"+r._id+"_Pivot").append(s.append(o)),n("#"+r._id+"_Ribbon_PvtLocation").wrap("<form id='"+r._id+"_Form_Ribbon_PvtLocation' onsubmit='return false'><\/form>").prop("disabled",!0),this._dialogValidate("_Ribbon_PvtLocation"),n("#"+r._id+"_Ribbon_PvtRange").wrap("<form id='"+r._id+"_Form_Ribbon_PvtRange' onsubmit='return false'><\/form>"),this._dialogValidate("_Ribbon_PvtRange"))},_dlgPvtOk:function(){var t=this.XLObj,r=n("#"+t._id+"_PvtDialog"),i;n("#"+t._id+"_Form_Ribbon_PvtRange").valid()&&n("#"+t._id+"_Form_Ribbon_PvtLocation").valid()&&(i=t.XLPivot._checkRange(n("#"+t._id+"_Ribbon_PvtRange").val(),n("#"+t._id+"_Ribbon_PvtLocation").val()),i.isRows?t._showAlertDlg("Alert","PivotRowsAlert","",450):i.isHeader?t._showAlertDlg("Alert","PivotLabelsAlert","",550):i.isOverlap?t._showAlertDlg("Alert","PivotOverlapAlert","",450):(n("#"+t._id+"_PvtDialog").ejDialog("close"),r.find(".e-ss-changerange:visible").length&&r.find(".e-ss-movepvttbl:visible").length?t.XLPivot.createPivotTable(n("#"+t._id+"_Ribbon_PvtRange").val(),n("#"+t._id+"_Ribbon_PvtLocation").val(),null):r.find(".e-ss-changerange:visible").length?t.XLPivot._changeDataSource():t.XLPivot._movePivotTable()))},_dlgPvtCancel:function(){var t=this.XLObj;n("#"+t._id+"_PvtDialog").ejDialog("close");t.setSheetFocus()},_rBtnPvtOnClick:function(t){var r=this.XLObj,u=n("#"+r._id+"_Ribbon_PvtRange"),i=n("#"+r._id+"_Ribbon_PvtLocation");i.prop("disabled",t==="new");t==="new"?(u.focus().setInputPos(u.val().length),n("#"+this.XLObj._id+"_Form_Ribbon_PvtLocation").validate().resetForm()):i.setInputPos(i.val().length)},_rBtnOnClick:function(t){var r=this.XLObj,i;if(t==="Formulas"||t==="Constants")for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!0});else for(i=0;i<this._gotoChkBox.length;i++)n("#"+r._id+"_"+this._gotoChkBox[i]).data("ejCheckBox").option({enabled:!1})},_gotoValChange:function(t){n("#"+this.XLObj._id+"_textRef").val(t.model.value)},_getAddrFromDollarAddr:function(n){var i,t;return n.indexOf("!")>-1&&(t=n.split("!"),i=this.XLObj._getSheetIndexByName(t[0]),n=t[1]),n.indexOf("$")>-1&&(n=n.split("$").join("")),n.indexOf(":")<0&&(n=n+":"+n),n=n.replace("=",""),[i,n]},_gotoBtnClick:function(t){var i=this.XLObj,r;switch(t){case"ok":n("#"+i._id+"_Form_GoToDiv").valid()&&(r=n("#"+i._id+"_GoToDlgTab").data("ejTab"),r.model.selectedItemIndex?i.XLSearch._applyGoToRule(n("#"+i._id+"_GoToSpDiv").find(".e-circle_01").parents("div")[0].id.split("ej"+i._id+"_gotoSpDiv_")[1].toLowerCase(),n("#"+i._id+"_"+this._gotoChkBox[0]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[1]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[2]).data("ejCheckBox").isChecked(),n("#"+i._id+"_"+this._gotoChkBox[3]).data("ejCheckBox").isChecked()):i.XLSearch.goTo(n.trim(n("#"+i._id+"_textRef").val().toString())),n("#"+i._id+"_GoDialog").ejDialog("close"));break;case"cancel":n.validator&&n("#"+i._id+"_Form_GoToDiv").validate().resetForm();n("#"+i._id+"_GoDialog").ejDialog("close")}i.setSheetFocus()},_borderPicture:function(){var n=this.XLObj;return"<ul id="+n._id+"_Ribbon_PictureBorder style='display:none'><li id='"+n._id+"picturecolor'><a>"+n._getLocStr("ThemeColor")+"<\/a><ul><li><input id='"+n._id+"_Ribbon_PictureColor'><\/input><\/li><\/ul><\/li><li id='nooutline' class='picturecolor'><a>"+n._getLocStr("NoOutline")+"<\/a><\/li><li id='weight' class='picturecolor'><a>"+n._getLocStr("Weight")+"<\/a><ul><li id='1px'><a>1px<\/a><\/li><li id='2px'><a>2px<\/a><\/li><li id='3px'><a>3px<\/a><\/li><\/ul><\/li><li id='dashes' class='picturecolor'><a>"+n._getLocStr("Dashes")+"<\/a><ul><li id='solid'><a><div style='top:9px;border:1px solid black;width:40px'><\/div><\/a><\/li><li id='dotted'><a><div style='top:9px;border:1px dotted black;width:40px'><\/div><\/a><\/li><li id='dashed'><a><div style='top:9px;border:1px dashed black;width:40px'><\/div><\/a><\/li><\/ul><\/li><\/ul>"},_chartElementTag:function(){var n=this.XLObj,t="<ul id="+n._id+'_Ribbon_CElement class="e-spreadsheet" style="display:none">';return t+='<li class="axes" id="Axes"><a><span class="e-ss-chartimg e-icon e-ss-axes"><\/span>'+n._getLocStr("Axes")+'<\/a><ul><li class="phaxis e-ss-cmenuitem" id="PHAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxis"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxis e-ss-cmenuitem" id="PVAxis"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxis"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="axistitle" id="AxisTitle"><a><span class="e-ss-chartimg e-icon e-ss-axistitle"><\/span>'+n._getLocStr("AxisTitle")+'<\/a><ul><li class="phaxistitle e-ss-cmenuitem" id="PHAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-phaxistitle"><\/span>'+n._getLocStr("PHAxis")+'<\/a><\/li><li class="pvaxistitle e-ss-cmenuitem" id="PVAxisTitle"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pvaxistitle"><\/span>'+n._getLocStr("PVAxis")+"<\/a><\/li><\/ul><\/li>",t+='<li class="charttitle" id="ChartTitle"><a><span class="e-ss-chartimg e-icon e-ss-charttitle"><\/span>'+n._getLocStr("ChartTitle")+'<\/a><ul><li class="ctnone e-ss-cmenuitem" id="CTNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnone"><\/span>'+n._getLocStr("CTNone")+'<\/a><\/li><li class="ctcenter e-ss-cmenuitem" id="CTCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctcenter"><\/span>'+n._getLocStr("CTCenter")+'<\/a><\/li><li class="ctfar e-ss-cmenuitem" id="CTFar"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctfar"><\/span>'+n._getLocStr("CTFar")+'<\/a><\/li><li class="ctnear e-ss-cmenuitem" id="CTNear"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ctnear"><\/span>'+n._getLocStr("CTNear")+"<\/a><\/li><\/ul><\/li>",t+='<li class="datalabels" id="DataLabels"><a><span class="e-ss-chartimg e-icon e-ss-datalabels"><\/span>'+n._getLocStr("DataLabels")+'<\/a><ul><li class="dlnone e-ss-cmenuitem" id="DLNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlnone"><\/span>'+n._getLocStr("DLNone")+'<\/a><\/li><li class="dlcenter e-ss-cmenuitem" id="DLCenter"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlcenter"><\/span>'+n._getLocStr("DLCenter")+'<\/a><\/li><li class="dliend e-ss-cmenuitem" id="DLIEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dliend"><\/span>'+n._getLocStr("DLIEnd")+'<\/a><\/li><li class="dlibase e-ss-cmenuitem" id="DLIBase"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dlibase"><\/span>'+n._getLocStr("DLIBase")+'<\/a><\/li><li class="dloend e-ss-cmenuitem" id="DLOEnd"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-dloend"><\/span>'+n._getLocStr("DLOEnd")+"<\/a><\/li><\/ul><\/li>",t+='<li class="gridline" id="Gridline"><a><span class="e-ss-chartimg e-icon e-ss-gridline"><\/span>'+n._getLocStr("Gridline")+'<\/a><ul><li class="pmajorh e-ss-cmenuitem" id="PMajorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorh"><\/span>'+n._getLocStr("PMajorH")+'<\/a><\/li><li class="pmajorv e-ss-cmenuitem" id="PMajorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pmajorv"><\/span>'+n._getLocStr("PMajorV")+'<\/a><\/li><li class="pminorh e-ss-cmenuitem" id="PMinorH"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon  e-ss-pminorh"><\/span>'+n._getLocStr("PMinorH")+'<\/a><\/li><li class="pminorv e-ss-cmenuitem" id="PMinorV"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-pminorv"><\/span>'+n._getLocStr("PMinorV")+"<\/a><\/li><\/ul><\/li>",t+('<li class="legend" id="Legend"><a><span class="e-ss-chartimg e-icon e-ss-legend"><\/span>'+n._getLocStr("Legend")+'<\/a><ul><li class="lnone e-ss-cmenuitem" id="LNone"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lnone"><\/span>'+n._getLocStr("LNone")+'<\/a><\/li><li class="lright e-ss-cmenuitem" id="LRight"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lright"><\/span>'+n._getLocStr("LRight")+'<\/a><\/li><li class="lleft e-ss-cmenuitem" id="LLeft"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lleft"><\/span>'+n._getLocStr("LLeft")+'<\/a><\/li><li class="lbottom e-ss-cmenuitem" id="LBottom"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-lbottom"><\/span>'+n._getLocStr("LBottom")+'<\/a><\/li><li class="ltop e-ss-cmenuitem" id="LTop"><a class="e-ss-chartlayout"><span class="e-ss-chartimg e-icon e-ss-ltop"><\/span>'+n._getLocStr("LTop")+"<\/a><\/li><\/ul><\/li>")},_cpClickHandler:function(t){var i=this.XLObj;t==="Ribbon_Home_Font_FillColor"?i.XLFormat.format({style:{"background-color":n("#"+i._id+"_Ribbon_Home_Font_FillColor").ejColorPicker("option","value")}}):t==="Ribbon_Home_Font_FontColor"&&i.XLFormat.format({style:{color:n("#"+i._id+"_Ribbon_Home_Font_FontColor").ejColorPicker("option","value")}});i.setSheetFocus()},_ribbonClickHandler:function(i){var rt,ci,kt,nt,dt,c,l,li,lt,st,g,et,ot,at,ut,tt,gt={},r=n("#"+this._id.split("_Ribbon")[0]).data("ejSpreadsheet"),f=r.getActiveSheetIndex(),e=r.getSheet(f),a={},o={},h=this._id.split("_"),y=t.Spreadsheet.SupportedStyles,ai,ht,wi,p,v=e._selectedCells,d,b,k,yt,ni,vt,ti,pt,vi,yi,wt,ii,it,bt,ri,s,ui,fi,ei,w,ft,u,bi,ct,oi,hi;if(!r._shapeChange&&!r.XLRibbon._isSetModel){if(r._isRibbonClick=!0,ht=r._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),wi=r.getMainPanel(),rt=n("#"+r._id+"_Ribbon_Home_Number_NumberFormat").data("ejDropDownList"),ut=n("#"+r._id+"_Ribbon_Home_Font_FontSize").data("ejDropDownList"),at=n(r.getCell(e._activeCell.rowIndex,e._activeCell.colIndex)),r.model.allowSelection&&r.model.allowFormatAsTable&&r.model.allowCellFormatting&&(r.XLFormat._formatEnable||r.XLSelection._isOutsideBordering||r.XLSelection._isGridBordering)&&(r._id+"_Ribbon_Home_Font_BorderColor"===this._id||r._id+"_Ribbon_bordercolor"===i.ID||r._borderStyles.indexOf(i.ID)>-1||(r.XLSelection._isGridBordering=r.XLSelection._isOutsideBordering=r.XLFormat._formatEnable=!1,n("#"+r._id+"_Ribbon_Home_Clipboard_FormatPainter").ejToggleButton("option",{toggleState:!1}),(i.type==="itemSelected"||i.type==="click")&&!r.isUndefined(i.model.prefixIcon)&&(i.model.prefixIcon.split("e-ss-")[1]===i.ID||i.model.prefixIcon.indexOf("e-ss-drawborder")>-1||i.model.prefixIcon.indexOf("e-ss-drawbordergrid")>-1)&&(r.XLSelection._isGridBordering=r.XLSelection._isOutsideBordering=!0),ht.addClass("e-ss-cursor"),ht.removeClass("e-ss-drwbrdrcursor e-ss-drwbrdrgridcursor e-ss-fpcursor"),r.XLSelection._cleanUp(!0))),ai={Id:this._id,isChecked:i.isChecked,status:i.status,prop:i.model,model:r.model},r._trigger("ribbonClick",ai)){r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();return}!t.isNullOrUndefined(r._getAutoFillOptElem())&&r.model.autoFillSettings.showFillOptions&&(r._getAutoFillOptElem().addClass("e-hide"),n("#"+r._id+"_ctxtmenu").hide());switch(this._id){case r._id+"_Ribbon_Home_Clipboard_Cut":r.XLClipboard.cut();break;case r._id+"_Ribbon_Home_Clipboard_Copy":r.XLClipboard.copy();break;case r._id+"_Ribbon_Home_Clipboard_Paste":case r._id+"_Ribbon_Home_Clipboard_PasteOptions":r.XLClipboard._isSpecial=!(i.ID==="PasteValues");r.XLClipboard.paste();break;case r._id+"_Ribbon_Home_Actions_Undo":r.XLClipboard._triggerKeyDown(90,!0);break;case r._id+"_Ribbon_Home_Actions_Redo":r.XLClipboard._triggerKeyDown(89,!0);break;case r._id+"_Ribbon_Home_Alignment_WrapText":r._textFormatting("wrapText");break;case r._id+"_Ribbon_exportXL":r.XLExport["export"](t.Spreadsheet.exportType.Excel);break;case r._id+"_Ribbon_exportCsv":r.XLExport["export"](t.Spreadsheet.exportType.Csv);break;case r._id+"_Ribbon_exportPdf":r.XLExport["export"](t.Spreadsheet.exportType.Pdf);break;case r._id+"_Ribbon_PageLayout_Print_Print":r.XLPrint.printSheet(f);break;case r._id+"_Ribbon_PageLayout_Print_PrintSelected":r.XLPrint.printSelection(f);break;case r._id+"_Ribbon_new":r._cellFormatHandler(this._id.replace(r._id+"_Ribbon_",""),i.selectedText);break;case r._id+"_Ribbon_Home_Font_Bold":o[y.FontWeight]=i.model.toggleState?"bold":"normal";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_Italic":o[y.FontStyle]=i.model.toggleState?"italic":"normal";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_Underline":case r._id+"_Ribbon_Home_Font_StrikeThrough":d=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(at[0].className))["text-decoration"]||"";h.indexOf("StrikeThrough")>-1?h[h.indexOf("StrikeThrough")]="line-through":h.indexOf("Underline")>-1&&(h[h.indexOf("Underline")]="underline");i.model.toggleState?(d=d.replace("none",""),o[y.TextDecoration]=d?d.indexOf("underline")<0?d+" "+h[h.length-1]:h[h.length-1]+" "+d:h[h.length-1]):(d=n.trim(d.replace(h[h.length-1],"")),o[y.TextDecoration]=d.length?d:"none");a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_FontSize":o[y.FontSize]=i.value;a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_IncreaseFontSize":case r._id+"_Ribbon_Home_Font_DecreaseFontSize":this._id==r._id+"_Ribbon_Home_Font_IncreaseFontSize"?(ot=t.isNullOrUndefined(ut.selectedIndexValue)?6:ut.selectedIndexValue+1,t.isNullOrUndefined(r.XLRibbon._fontSize[ot])||ut.option({selectedItemIndex:ot})):this._id==r._id+"_Ribbon_Home_Font_DecreaseFontSize"&&(ot=t.isNullOrUndefined(ut.selectedIndexValue)?4:ut.selectedIndexValue-1,t.isNullOrUndefined(r.XLRibbon._fontSize[ot])||ut.option({selectedItemIndex:ot}));break;case r._id+"_Ribbon_Home_Alignment_AlignLeft":case r._id+"_Ribbon_Home_Alignment_AlignRight":case r._id+"_Ribbon_Home_Alignment_AlignCenter":g=n(this.element.parents("div").eq(1)).find(".e-text-align");t.isNullOrUndefined(g[0])?this.element.addClass("e-text-align"):(n("#"+g[0].id).ejToggleButton("option","toggleState",!1),g.removeClass("e-text-align"),g[0].id!=this.element[0].id&&this.element.addClass("e-text-align"));o[y.TextAlign]=i.model.toggleState?h[h.length-1].split("Align")[1]:"left";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Alignment_DecreaseIndent":case r._id+"_Ribbon_Home_Alignment_IncreaseIndent":if(ni=0,ti=!1,v.length<2)pt=r.getActiveCell(),b=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(pt.rowIndex,pt.colIndex)[0].className)),vt=y.TextIndent in b?this._id===r._id+"_Ribbon_Home_Alignment_IncreaseIndent"?Number(b[y.TextIndent].replace("pt",""))+6:Number(b[y.TextIndent].replace("pt",""))-6:this._id===r._id+"_Ribbon_Home_Alignment_DecreaseIndent"?-6:6,r.XLRibbon._applyTextIndent(pt,b,vt,this);else{for(k=0,yt=v.length;k<yt;k++)b=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(v[k].rowIndex,v[k].colIndex)[0].className)),b[y.TextAlign]=="right"&&ni++;for(ni===v.length&&(ti=!0),k=0,yt=v.length;k<yt;k++)b=r.XLFormat.getFormatFromHashCode(r.XLFormat.getFormatClass(r.getCell(v[k].rowIndex,v[k].colIndex)[0].className)),ti||(b[y.TextAlign]="left"),vt=y.TextIndent in b?this._id===r._id+"_Ribbon_Home_Alignment_IncreaseIndent"?Number(b[y.TextIndent].replace("pt",""))+6:Number(b[y.TextIndent].replace("pt",""))-6:this._id===r._id+"_Ribbon_Home_Alignment_DecreaseIndent"?-6:6,r.XLRibbon._applyTextIndent(v[k],b,vt,this)}r.XLSelection.refreshSelection();r.XLDragFill.positionAutoFillElement();break;case r._id+"_Ribbon_Home_Alignment_TopAlign":case r._id+"_Ribbon_Home_Alignment_MiddleAlign":case r._id+"_Ribbon_Home_Alignment_BottomAlign":g=n(this.element.parents("div").eq(1)).find(".e-vertical-align");t.isNullOrUndefined(g[0])?this.element.addClass("e-vertical-align"):(n("#"+g[0].id).ejToggleButton("option","toggleState",!1),g.removeClass("e-vertical-align"),g[0].id!=this.element[0].id&&this.element.addClass("e-vertical-align"));o[y.VerticalAlign]=i.model.toggleState?h[h.length-1].split("Align")[0]:"bottom";a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_Home_Font_FontFamily":o[y.FontFamily]=i.text;a.style=o;r.XLFormat.format(a);break;case r._id+"_Ribbon_PageLayout_Show_Headings":r.showHeadings(i.isChecked);break;case r._id+"_Ribbon_PageLayout_Show_Gridlines":r.showGridlines(i.isChecked);break;case r._id+"_Ribbon_PageLayout_PageLayout_PageSize":case r._id+"_Ribbon_PageLayout_PageLayout_PageSizeOptions":vi=t.isNullOrUndefined(i.ID)?i.model.prefixIcon.substring(12):i.ID;r.XLPrint._printSetting(vi);break;case r._id+"_Ribbon_Home_Number_NumberFormat":a.type=i.text.toLowerCase();a.type!=="custom"?r.XLFormat.format(a):r._showDialog(r._id+"_FormatCells");break;case r._id+"_Ribbon_Home_Number_IncreaseDecimal":case r._id+"_Ribbon_Home_Number_DecreaseDecimal":at.data("type")!="number"&&n.isNumeric(r.XLEdit.getPropertyValueByElem(at))&&(r.XLRibbon._isSetModel=!0,rt.option({selectedItemIndex:1}),r.XLRibbon._isSetModel=!1);r.XLFormat.updateDecimalPlaces(h[h.length-1]);break;case r._id+"_Ribbon_Home_Number_Accounting":case r._id+"_Ribbon_Home_Number_Percentage":this._id===r._id+"_Ribbon_Home_Number_Accounting"?rt.option({selectedItemIndex:3}):rt.option({selectedItemIndex:4});a.type=rt.selectedTextValue.toLowerCase();break;case r._id+"_Ribbon_Home_Number_CommaStyle":rt.option({selectedItemIndex:1});a.type=rt.selectedTextValue.toLowerCase();break;case r._id+"_Ribbon_Data_SortFilter_SortAtoZ":r.XLSort._sortHandler("SortAtoZ");break;case r._id+"_Ribbon_Data_SortFilter_SortZtoA":r.XLSort._sortHandler("SortZtoA");break;case r._id+"_Ribbon_Data_SortFilter_Filter":r.XLFilter.filter();break;case r._id+"_Ribbon_Data_SortFilter_ClearFilter":et=r.XLEdit.getPropertyValue(r.getActiveCell().rowIndex,r.getActiveCell().colIndex,"tableName");t.isNullOrUndefined(et)?r.XLFilter.clearFilter():(s=r._getTableID(et),r.XLFilter._clearFilterTable(r.getActiveSheetIndex(),s,!0));break;case r._id+"_Ribbon_Home_Font_BorderColor":gt=n("#"+r._id+"_Ribbon_BorderColor").data("ejColorPicker");t.isNullOrUndefined(gt)||gt.hide();t.isNullOrUndefined(i.value)||(r._borderColor=i.value);break;case r._id+"_Ribbon_Home_Font_Border":r._borderStyles.indexOf(i.ID)<0?t.isNullOrUndefined(i.ID)?i.ID=i.model.prefixIcon.substring(12):i.ID.indexOf("bordercolor")<0&&n(this.element).find(".e-icon ").removeClass().addClass("e-icon e-ss-"+i.ID)&&this.option({prefixIcon:"e-icon e-ss-"+i.ID}):r.XLRibbon._updateBordeStyle(i);ci=r._borderColor||"#000000";c=e._startCell;l=e._endCell;yi=r._getAlphaRange(f,c.rowIndex,c.colIndex,l.rowIndex,l.colIndex);r.model.allowSelection&&(r.XLSelection._isOutsideBordering||r.XLSelection._isGridBordering)?!(r._borderStyles.indexOf(i.ID)>-1)&&i.ID.indexOf("bordercolor")<0&&(r.XLSelection._isOutsideBordering=r.XLSelection._isGridBordering=!1):r.setBorder({type:i.ID,color:ci,style:r._borderStyle},yi);break;case r._id+"_Ribbon_Data_DataTools_DataValidation":case r._id+"_Ribbon_Data_DataTools_DataValidationOptions":r._showDialog(this._id);i.ID=="ClearVal"?r.XLValidate.clearDV():i.ID=="HighlightVal"?r.XLValidate.highlightInvalidData():i.ID=="ClearHLVal"?r.XLValidate.clearHighlightedValData():(r.XLRibbon._refreshValDlg(),n("#"+r._id+"_ValDialog").ejDialog("open"),n.validator&&n("#"+r._id+"_Form_ValDialog").validate().resetForm(),n("#"+r._id+"_Ribbon_ddType_wrapper").focus(),wt=r.XLEdit.getPropertyValueByElem(r.getActiveCellElem(f),"rule"),wt?(ii=wt.customVal,it=ii.split("_"),ii.indexOf("list")>-1?(n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",5),n("#"+r._id+"_Ribbon_btnMin").val(it[0])):(r.XLRibbon._types.filter(function(n,t){if(it[4]===n.value)return bt=t,!0}),n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",bt),r.XLRibbon._actions.filter(function(n,t){if(it[0]===n.value)return bt=t,!0}),n("#"+r._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",bt),n("#"+r._id+"_Ribbon_btnMin").val(it[1].replace("^","")),n("#"+r._id+"_Ribbon_btnMax").val(it[2].replace("^",""))),n("#"+r._id+"_Ribbon_blank").ejCheckBox("option","checked",!wt.required),n("#"+r._id+"_Ribbon_freetext").ejCheckBox("option","checked",JSON.parse(it[it.length-3]))):(n("#"+r._id+"_Ribbon_ddType").ejDropDownList("option","selectedItemIndex",1),n("#"+r._id+"_Ribbon_ddAction").ejDropDownList("option","selectedItemIndex",6),n("#"+r._id+"_Ribbon_btnMin").val(""),n("#"+r._id+"_Ribbon_btnMax").val(""),n("#"+r._id+"_Ribbon_blank").ejCheckBox("option","checked",!0),n("#"+r._id+"_Ribbon_freetext").ejCheckBox("option","checked",!0)));break;case r._id+"_Ribbon_Home_Styles_ConditionalFormatting":if(!i.ID.length)break;r.XLRibbon._currentCFormat=i.ID;i.ID.startsWith("clear")?i.ID==="clearselected"?r.XLCFormat.clearCF(r.getSheet(f).selectedRange):r.XLCFormat.clearCF():i.ID.indexOf("_HLCellRules")>0||i.ID.indexOf("_ClearRules")>0||i.ID.indexOf("_CreateRule")<-1||(r._showDialog(this._id),r.XLRibbon._renderCFDialog(i));break;case r._id+"_Ribbon_Others_Editing_FindSelect":r._showDialog(this._id);kt=n("#"+r._id+"_GoToDlgTab").data("ejTab");ri=n("#"+r._id+"_FRDialog_FPDlgTab").data("ejTab");switch(i.ID){case"Find":r._responsiveHeight<365&&n("#"+r._id+"_FRDialog_wrapper").css("top","0px");n("#"+r._id+"_FRDialog").ejDialog("open");r.XLRibbon._refreshFRDlg();ri.option({selectedItemIndex:0});n("#"+r._id+"_Ribbon_textFind").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);r.model.isReadOnly?n("#"+r._id+"_FRDialog_FPDlgTab").ejTab("option",{disabledItemIndex:[1,2]}):n("#"+r._id+"_FRDialog_FPDlgTab").ejTab("option",{enabledItemIndex:[1,2]});break;case"Replace":r._responsiveHeight<365&&n("#"+r._id+"_FRDialog_wrapper").css("top","0px");n("#"+r._id+"_FRDialog").ejDialog("open");r.XLRibbon._refreshFRDlg();ri.option({selectedItemIndex:1});n("#"+r._id+"_Ribbon_textFind").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);break;case"GoTo":r.XLRibbon._refreshGoDlg();n("#"+r._id+"_GoDialog").ejDialog("open");kt.option({selectedItemIndex:0});n("#"+r._id+"_textRef").focus().setInputPos(n("#"+r._id+"_Ribbon_textFind").val().length);n.validator&&n("#"+r._id+"_Form_GoToDiv").validate().resetForm();break;case"GoToSpecial":r.XLRibbon._refreshGoDlg();n("#"+r._id+"_GoDialog").ejDialog("open");kt.option({selectedItemIndex:1});n("#"+r._id+"_Blanks").focus();break;default:r.XLSearch._applyGoToRule(i.ID.toLowerCase(),!0,!0,!0,!0)}break;case r._id+"_Ribbon_Others_CalCulation_CalculationOptions":switch(i.ID){case r._id+"_CalcAuto":r.XLEdit.calcOption(!0);break;case r._id+"_CalcManual":r.XLEdit.calcOption(!1)}break;case r._id+"_Ribbon_Others_CalCulation_CalculateNow":r.XLEdit.calcNow();break;case r._id+"_Ribbon_Others_CalCulation_CalculateSheet":r.XLEdit.calcNow(r.getActiveSheetIndex());break;case r._id+"_Ribbon_Home_Clipboard_FormatPainter":if(!i.model.toggleState)return r.performSelection(r.getActiveCell(),r.getActiveCell()),!1;r.XLFormat._formatEnable=!0;ht.removeClass("e-ss-cursor");ht.addClass("e-ss-fpcursor");r.XLFormat._formatPainter();break;case r._id+"_Ribbon_Design_Tools_ConvertToRange":r.XLFormat.convertToRange({alert:!0});break;case r._id+"_Ribbon_Design_Tools_ResizeTable":s=parseInt(document.getElementById(r._id+"_tableid").value);u=e.tableManager[s].range;r._showDialog(r._id+"_Ribbon_Design_Tools_ResizeTable");n("#"+r._id+"_fatresizetablerange").val(r._getAlphaRange(f,u[0],u[1],u[2],u[3]));n("#"+r._id+"_fatresizetabledlg").ejDialog("open");break;case r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn":case r._id+"_Ribbon_Design_TableStyleOptions_LastColumn":tt=e.tableManager;s=document.getElementById(r._id+"_tableid").value;s in tt&&(u=tt[s].range,u=this._id===r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn"?r._getProperAlphaRange(f,u[0]+1,u[1],u[2],u[1]):r._getProperAlphaRange(f,u[0]+1,u[3],u[2],u[3]),this._id===r._id+"_Ribbon_Design_TableStyleOptions_FirstColumn"?(i.isChecked?tt[s].firstColumn=!0:delete tt[s].firstColumn,dt="firstColumn"):(i.isChecked?tt[s].lastColumn=!0:delete tt[s].lastColumn,dt="lastColumn"),r._dupDetails=!0,r.XLFormat.format({style:{"font-weight":i.isChecked?"bold":"normal"}},u),r._dupDetails=!1,lt={sheetIndex:f,reqType:"format-table",action:"firstlastcolumn",range:u,check:i.isChecked,id:i.model.id,tableId:parseInt(s),prop:dt},r._completeAction(lt));break;case r._id+"_Ribbon_Design_TableStyleOptions_TotalRow":s=document.getElementById(r._id+"_tableid").value;s in e.tableManager&&r.XLFormat._calculateTotalRow(f,s,i.isChecked,i.isChecked);break;case r._id+"_Ribbon_Design_TableStyleOptions_FilterColumn":if(!r.model.allowFiltering)return;tt=e.tableManager;s=document.getElementById(r._id+"_tableid").value;r.XLFilter._clearFilterTableIcon(f,parseInt(document.getElementById(r._id+"_tableid").value));tt[s].isFilter=i.isChecked;lt={sheetIndex:f,reqType:"format-table",action:"filtericon",id:i.model.id,check:i.isChecked,tableId:parseInt(s)};r._completeAction(lt);break;case r._id+"_Ribbon_Insert_Tables_Table":r._showDialog(this._id);r.XLRibbon._openFATDlg();break;case r._id+"_Ribbon_Review_Comments_NewComment":n("#"+r._id+"_Ribbon_Review_Comments_NewComment").text()===r._getLocStr("NewComment")?r.XLComment.setComment():r.XLComment.editComment();break;case r._id+"_Ribbon_Review_Comments_DeleteComment":r.XLComment.deleteComment();break;case r._id+"_Ribbon_Review_Comments_ShowAllComments":r.XLComment.showAllComments();break;case r._id+"_Ribbon_Review_Comments_ShowHideComment":r.XLComment.showHideComment();break;case r._id+"_Ribbon_Review_Comments_NextComment":r.XLComment.findNextComment();break;case r._id+"_Ribbon_Review_Comments_PreviousComment":r.XLComment.findPrevComment();break;case r._id+"_Ribbon_Insert_Links_Hyperlink":r._showDialog(this._id);break;case r._id+"_Ribbon_Home_Editing_SortFilter":switch(i.ID){case"Ribbon_SortAtoZ":case"Ribbon_SortZtoA":r.model.allowSorting&&r.XLSort._sortHandler(i.ID);break;case"Ribbon_Filter":r.model.allowFiltering&&r.XLFilter.filter();break;default:et=r.getCell(r.getActiveCell().rowIndex,r.getActiveCell().colIndex)[0].className;et.indexOf("e-table")<0?r.XLFilter.clearFilter():(s=r._getTableID(et),r.XLFilter._clearFilterTable(r.getActiveSheetIndex(),parseInt(s),!0))}break;case r._id+"_Ribbon_Others_Cells_InsertCell":case r._id+"_Ribbon_Others_Cells_InsertCellOptions":if(v.length<1)return;c=v[0];l=v[v.length-1];switch(i.ID){case"InsertCells":r._getJSSheetRowHeaderContent(f).find(".e-rowselected").length?r.insertEntireRow(c.rowIndex,l.rowIndex):r._getJSSheetHeader(f).find(".e-colselected").length?(r._insDelStatus="insert",r.insertEntireColumn(c.colIndex,l.colIndex)):r._showDialog(this._id);break;case"InsertSheetRows":r.insertEntireRow(c.rowIndex,l.rowIndex);break;case"InsertSheetColumns":r._insDelStatus="insert";r.insertEntireColumn(c.colIndex,l.colIndex);break;case"InsertSheet":r.insertSheet();break;default:r.element.find(".e-rowselected").length>0?r.insertEntireRow(c.rowIndex,l.rowIndex):r.element.find(".e-colselected").length>0?(r._insDelStatus="insert",r.insertEntireColumn(c.colIndex,l.colIndex)):r.insertShiftBottom(c,l)}break;case r._id+"_Ribbon_Others_Cells_DeleteCell":case r._id+"_Ribbon_Others_Cells_DeleteCellOptions":if(v.length<1)return;c=v[0];l=v[v.length-1];switch(i.ID){case"DeleteCells":r._getJSSheetRowHeaderContent(f).find(".e-rowselected").length?r.deleteEntireRow(c.rowIndex,l.rowIndex,[]):r._getJSSheetHeader(f).find(".e-colselected").length?(r._insDelStatus="delete",r.deleteEntireColumn(c.colIndex,l.colIndex,[])):r._showDialog(this._id);break;case"DeleteSheetRows":r.deleteEntireRow(c.rowIndex,l.rowIndex,[]);break;case"DeleteSheetColumns":r._insDelStatus="delete";r.deleteEntireColumn(c.colIndex,l.colIndex,[]);break;case"DeleteSheet":r.deleteSheet(f);break;default:r.element.find(".e-rowselected").length>0?r.deleteEntireRow(c.rowIndex,l.rowIndex):r.element.find(".e-colselected").length>0?(r._insDelStatus="insert",r.deleteEntireColumn(c.colIndex,l.colIndex)):r.deleteShiftUp(c,l)}break;case r._id+"_Ribbon_Home_Editing_Clear":u=e.selectedRange;switch(i.ID){case"Clear_All":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearAll(u);break;case"Clear_Formats":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearAllFormat(u);break;case"Clear_Contents":u=r._getAlphaRange(f,u[0],u[1],u[2],u[3]);r.clearContents(u);break;case"Clear_Comments":r.clearComments(f);break;default:r.clearHyperlinks()}r.model.allowSelection&&r.XLSelection._clearBorder(r._arrayAsString(r._cutFocus),f);break;case r._id+"_Ribbon_Insert_Tables_PivotTable":if(r._showDialog(this._id),w=n("#"+r._id+"_PvtDialog"),e=r.getSheet(f),li={sheetIndex:f,model:r.model.sheets},r._trigger("_createPivotTable",li))return;n("#"+r._id+"_Ribbon_PvtRange").val("");n("#"+r._id+"_Ribbon_PvtLocation").val("");e._selectedCells.length>1?(u=e.selectedRange,n("#"+r._id+"_Ribbon_PvtRange").val(e.sheetInfo.text+"!$"+r._generateHeaderText(u[1]+1)+"$"+(u[0]+1)+":$"+r._generateHeaderText(u[3]+1)+"$"+(u[2]+1))):r.isUndefined(r.XLEdit.getPropertyValueByElem(r.getActiveCellElem()))||(r.selectAll(!1),n("#"+r._id+"_Ribbon_PvtRange").val(e.sheetInfo.text+"!$"+r._generateHeaderText(e._startCell.colIndex+1)+"$"+(e._startCell.rowIndex+1)+":$"+r._generateHeaderText(e._endCell.colIndex+1)+"$"+(e._endCell.rowIndex+1)));w.find(".e-ss-changerange").show();w.find(".e-ss-movepvttbl").show();w.data("ejDialog").option("title",r._getLocStr("CreatePivotTable"));n("#"+r._id+"_dlg_newsheet").click();w.ejDialog("open");break;case r._id+"_Ribbon_Analyze_Show_FieldList":i.model.toggleState?(r.XLPivot._displayActPanel=!0,r.getActivationPanel().find("#"+r._id+"_PivotTableSchema_"+r._getContent(f).find(".e-ss-activepivot")[0].id).show(),r.showActivationPanel()):(r.hideActivationPanel(),r.XLPivot._displayActPanel=!1);break;case r._id+"_Ribbon_Analyze_Actions_ClearAll":ui=r.element.find(".e-ss-activepivot")[0].id;fi=n("#"+ui).data("ejPivotGrid");ei=n("#"+r._id+"_PivotTableSchema_"+ui).data("ejPivotSchemaDesigner");r.XLPivot._clearFilters(fi,ei);ei.model.pivotControl=fi;break;case r._id+"_Ribbon_Analyze_Actions_MovePivotTable":w=n("#"+r._id+"_PvtDialog");f=r.getActiveSheetIndex();w.find(".e-ss-movepvttbl").show();w.find(".e-ss-changerange").hide();ft=r.getSheet(f).pivotMngr.pivot[r.element.find(".e-ss-activepivot")[0].id];n("#"+r._id+"_Ribbon_PvtLocation").val(r.getSheet(f).sheetInfo.text+"!$"+r._generateHeaderText(ft.colIndex+1)+"$"+(ft.rowIndex+1));w.data("ejDialog").option("title",r._getLocStr("MovePivotTable"));n("#"+r._id+"_dlg_existsheet").click();w.ejDialog("open");break;case r._id+"_Ribbon_Analyze_DataSource_Refresh":r.XLPivot.refreshDataSource();break;case r._id+"_Ribbon_Analyze_DataSource_ChangeDataSource":w=n("#"+r._id+"_PvtDialog");w.find(".e-ss-changerange").show();w.find(".e-ss-movepvttbl").hide();ft=r.getSheet(f).pivotMngr.pivot[r.element.find(".e-ss-activepivot")[0].id];u=ft.dataRange;bi=r.XLPivot._getSheetIdxFromName(ft.dataSheetName);n("#"+r._id+"_Ribbon_PvtRange").val(ft.dataSheetName+"!$"+r._generateHeaderText(u[1]+1)+"$"+(u[0]+1)+":$"+r._generateHeaderText(u[3]+1)+"$"+(u[2]+1));w.data("ejDialog").option("title",r._getLocStr("ChangePivotTableDataSource"));w.ejDialog("open");break;case r._id+"_Ribbon_ChartDesign_Type_ChangeChartType":r._showDialog(this._id);r.XLRibbon._refreshChartTypeDlg();break;case r._id+"_Ribbon_Insert_Illustrations_Pictures":if(r.model.importSettings.importMapper.length<1){r._showAlertDlg("Alert","ImportExportUrl","",266);return}r._uploadImage=!0;n("#"+r._id+"_file .e-uploadinput").click();r.XLRibbon._toggleFormatTab();break;case r._id+"_Ribbon_Others_Formulas_NameManager":r.XLRibbon._openNameManagerDlg();r.XLRibbon._isNmgrid="NameManager";break;case r._id+"_Ribbon_Others_Formulas_DefineName":r._showDialog(r._id+"_Ribbon_Others_NameManager");ct=n("#"+r._id+"_nmgrid").data("ejGrid");ct.getContentTable().find("td").addClass("e-ss-emptyrecord");ct.model.dataSource.length<1?ct.getContentTable().find("td").addClass("e-ss-emptyrecord"):ct.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");r.XLRibbon._refreshNMDlg();r.XLRibbon._isNmgrid="DefineName";break;case r._id+"_Ribbon_Others_Window_FreezePanes":switch(i.ID){case"freezePanes":r.XLFreeze.freezePanes();break;case"FreezeTopRow":r.XLFreeze.freezeTopRow();break;case"FreezeFirstColumn":r.XLFreeze.freezeLeftColumn();break;case"UnFreezePanes":r.XLFreeze.unfreezePanes()}break;case r._id+"_Ribbon_Home_Alignment_Merge":t.isNullOrUndefined(i.ID)&&(r.mergeCenter=!0,r.mergeCells());switch(i.ID){case"MergeCells":r.mergeCells();break;case"MergeAcross":r.mergeAcrossCells();break;case"MergeAndCenter":r.mergeCenter=!0;r.mergeCells();break;case"UnmergeCells":r.unmergeCells(e.selectedRange)}break;case r._id+"_Ribbon_Home_Editing_AutoSum":nt=e.selectedRange;i.type==="click"?r.XLRibbon.autoSum("SUM",r._getAlphaRange(f,nt[0],nt[1],nt[2],nt[3])):r.XLRibbon.autoSum(i.ID.toUpperCase(),r._getAlphaRange(f,nt[0],nt[1],nt[2],nt[3]));break;case r._id+"_Ribbon_ChartDesign_ChartLayouts_AddChartElement":r.XLChart.updateChartElement(null,i.ID);break;case r._id+"_Ribbon_ChartDesign_Size_ChartWidth":r.XLRibbon._changeChartSize("height",i.value);break;case r._id+"_Ribbon_ChartDesign_Size_ChartHeight":r.XLRibbon._changeChartSize("width",i.value);break;case r._id+"_Ribbon_ChartDesign_Data_SwitchRowColumn":r.XLChart.switchRowColumn();break;case r._id+"_Ribbon_PictureColor":case r._id+"_Ribbon_Format_Border_PictureBorder":if(["weight","dashes",r._id+"picturecolor",""].indexOf(i.ID)===-1){st=r.getSheetElement(f).find(".e-ss-activeimg");oi=new RegExp("\\be-shapebdr.*?\\b","g");o=st[0].className.match(oi)?r.XLShape._getImgStyleFromHashCode(st[0].className.match(oi)[0]):{"border-color":"transparent","border-width":"1px","border-style":"solid"};var si=o["border-color"],pi=o["border-width"],o=o["border-style"];if(st[0]){switch(!0){case this._id.indexOf("PictureColor")>-1:si=i.value;break;case i.ID.indexOf("px")>-1:pi=i.ID;break;case i.ID==="nooutline":si="transparent";break;default:o=i.ID}r.XLShape.changePictureBorder(st[0].id,pi,o,si)}}break;case r._id+"_Ribbon_Format_Adjust_ResetPicture":r.XLShape.resetPicture(null,i.ID);break;case r._id+"_Ribbon_Format_Adjust_ChangePicture":r._uploadImage=!0;r.XLShape._changePicture=!0;r.element.find("#"+r._id+"_file .e-uploadinput").click();r.XLRibbon._toggleFormatTab();break;case r._id+"_Ribbon_ChartDesign_Data_SelectData":r._showDialog(this._id);cid=document.getElementById(r._id+"_chart").value;p=r.XLChart._getShapeObj(cid,"chart");n("#"+r._id+"_crxaxis").val(p.xRange?r._getAlphaRange(f,p.xRange[0],p.xRange[1],p.xRange[2],p.xRange[3]):"");n("#"+r._id+"_cryaxis").val(p.yRange?r._getAlphaRange(f,p.yRange[0],p.yRange[1],p.yRange[2],p.yRange[3]):"");n("#"+r._id+"_crlaxis").val(p.lRange?r._getAlphaRange(f,p.lRange[0],p.lRange[1],p.lRange[2],p.lRange[3]):"");r._selectDataval={xRange:n("#"+r._id+"_crxaxis").val(),yRange:n("#"+r._id+"_cryaxis").val(),lRange:n("#"+r._id+"_crlaxis").val()};n("#"+r._id+"_chartrangedlg").ejDialog("open");n("#"+r._id+"_crxaxis").focus().setInputPos(0);break;case r._id+"_Ribbon_ChartDesign_ChartThemes_ChartThemes":r.XLChart.changeTheme(r.element.find("#"+r._id+"_chart").val(),this._selectedValue);break;case r._id+"_Ribbon_Review_Changes_LockCell":r.lockCells(null,i.model.toggleState);break;case r._id+"_Ribbon_Review_Changes_ProtectSheet":r.protectSheet(i.model.toggleState);break;case r._id+"_Ribbon_Review_Changes_ProtectWorkbook":r._showDialog(this._id);r.XLRibbon._refreshPasswordDlg();hi=n("#"+r._id+"_PasswordDialog").data("ejDialog");r.model.exportSettings.password||(hi.option("title",r._getLocStr("ProtectWorkbook")),n("#"+r._id+"_confirm").show());hi.open()}this._id.indexOf("Comment")===-1&&r.setSheetFocus();r._isRibbonClick=!1}},_applyTextIndent:function(n,i,r,u){var f=this.XLObj,v=f.getActiveSheetIndex(),y={},e=t.Spreadsheet.SupportedStyles,p,w,b,h,c,o,s,l=f.getCell(n.rowIndex,n.colIndex),a=f.getSheet(v);if(c=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value2"),o=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"value"),!(u._id.indexOf("DecreaseIndent")<0)||!f._hasClass(l[0],"e-sswraptext")||!(Math.round(4/3*r)+f._detailsFromGlobalSpan(n.rowIndex,n.colIndex,"width","W")>a.columnsWidthCollection[n.colIndex])){if(f.isFormula(o)&&(o=c),!i[e.TextIndent]&&u._id===f._id+"_Ribbon_Home_Alignment_DecreaseIndent"||r<0)return!1;i[e.TextIndent]=r+"pt";(i[e.TextAlign]==="center"||f.isNumber(o)&&!i[e.TextAlign])&&(i[e.TextAlign]="left");y.style=i;f.XLFormat.format(y,[n.rowIndex,n.colIndex,n.rowIndex,n.colIndex]);!i[e.TextIndent]||f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"merge")||f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"mergeIdx")||(s=l.outerHeight(),s>=f.model.rowHeight&&(l.parent().outerHeight(s),a.rowsHeightCollection[n.rowIndex]=s,f._fRowHtColl[n.rowIndex]=s,f._setRowHdrHeight(v,n.rowIndex)),p=f._detailsFromGlobalSpan(n.rowIndex,n.colIndex,"width",c),b=4/3*r,w=Math.round(b+p),h=a.columnsWidthCollection[n.colIndex],f.XLResize&&f.isNumber(o)&&u._id===f._id+"_Ribbon_Home_Alignment_IncreaseIndent"&&w>=h&&f.XLResize.setColWidth(n.colIndex,8+h))}},_changeChartSize:function(t,i){if(!this._ctrlCreated){var r=this.XLObj,c,s=r.XLEdit.getPropertyValue(r.XLShape._picCellIdx.rowIndex,r.XLShape._picCellIdx.colIndex,"chart")[0],f=document.getElementById(r._id+"_chart").value,u=n("#"+f).ejChart("instance"),e=n("#"+f),h=r.XLChart._getShapeObj(f,"chart"),o={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:t,cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex,prev:{width:u.model.size.width,height:u.model.size.height}};c=u.model.size;t==="height"?(u.option("size",{width:i.toString()}),s.width=i,h.width=i,e[0].style.width=i+"px",o.cur={width:i.toString(),height:u.model.size.height}):(u.option("size",{height:i.toString()}),s.height=i,h.height=i,e[0].style.height=i+"px",o.cur={width:u.model.size.width,height:i.toString()});r.XLChart._afterChartRefresh();r._completeAction(o);r.XLShape._shapeType="chart";r.XLShape._updateShapeObj(e[0]);r.XLShape._shapeType="img"}},_updateBordeStyle:function(n){var t=this.XLObj;t._borderStyle=n.ID&&n.ID.length>0&&n.ID},_colorPickerHandler:function(t,i){var u,r=this.XLObj,f;i.type==="open"?(n("#"+r._id+"_"+t+"_popup").find(".e-buttons, .e-button").hide(),n("#"+r._id+"_"+t+"_popup").focus()):i.type==="change"&&(u=r.XLFormat,f=n("#"+r._id+"_"+t).data("ejColorPicker"),t==="Ribbon_Home_Font_FontColor"?(u.format({style:{color:i.value}}),n("#"+r._id+"_Ribbon_home_Font_Color").find(".e-selected-color").css("background-color",i.value)):(u.format({style:{"background-color":i.value}}),n("#"+r._id+"_Ribbon_home_Font_Background").find(".e-selected-color").css("background-color",i.value)),f.hide(),r._dupDetails=!0,f.setValue(i.value),r._dupDetails=!1)},updateRibbonIcons:function(){this._updateRibbonIcons()},_updateRibbonIcons:function(){var r,a,b;if(this.XLObj.model.showRibbon){var y,p,k,w,v,u,e,i=this.XLObj,o=n("#"+i._id+"_Ribbon_Home_Number_NumberFormat").data("ejDropDownList"),d=i.getActiveSheetIndex(),s=i.getSheet(d),h,c=n("#"+i._id+"_Ribbon_Home_Font_FontSize").data("ejDropDownList"),g=!1;n("#"+i._id+"_Ribbon_Home_Font_FontSize").css("width","auto");var l=n("#"+i._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),f=-1,nt=n("#"+i._id+"_Ribbon").data("ejRibbon"),tt=nt.getTabText(nt.model.selectedItemIndex);switch(tt){case"HOME":if(e=s._activeCell,w=i.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"wrap"),k=i.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"merge"),format=i.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"format"),v=i.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"type"),t.isNullOrUndefined(i.XLFormat)||(u=i.XLFormat.getFormatFromHashCode(format)),i.isUndefined(w)&&(w=!1),n("#"+i._id+"_Ribbon_Home_Alignment_WrapText").ejToggleButton("option",{toggleState:w}),i.isUndefined(k)?(n("#"+i._id+"_Ribbon_Home_Alignment_Merge").removeClass("e-ss-active"),n("#"+i._id+"_Ribbon_Home_Alignment_Mergedrpbtn").removeClass("e-ss-active")):(n("#"+i._id+"_Ribbon_Home_Alignment_Merge").addClass("e-ss-active"),n("#"+i._id+"_Ribbon_Home_Alignment_Mergedrpbtn").addClass("e-ss-active")),["date"].indexOf(v)>-1&&(v="custom"),v)for(f=-1,r=0,a=this._numberFormat.length;r<a;r++)if(v===this._numberFormat[r].text.toLowerCase()){f=r;break}if(t.isNullOrUndefined(o)||(o._initValue=!0,f>-1?o.option({selectedItemIndex:f}):!t.isNullOrUndefined(o.selectedIndexValue)&&o.selectedIndexValue!=0&&o.option({selectedItemIndex:0}),o._initValue=!1),u){if(f=-1,!t.isNullOrUndefined(u["font-size"]))for(r=0,a=this._fontSize.length;r<a;r++)if(u["font-size"]===this._fontSize[r].value){f=r;break}if(!t.isNullOrUndefined(c)&&(c._initValue=!0,f>-1?c.option({selectedItemIndex:f})||(f=-1):!t.isNullOrUndefined(c.selectedIndexValue)&&c.selectedIndexValue!=3&&c.option({selectedItemIndex:3}),c._initValue=!1,f=-1,!t.isNullOrUndefined(u["font-family"])))for(r=0,a=this._fontFamily.length;r<a;r++)if(u["font-family"]===this._fontFamily[r].text.toLowerCase()){f=r;break}t.isNullOrUndefined(l)||(l._initValue=!0,f>-1?l.option({selectedItemIndex:f}):!t.isNullOrUndefined(l.selectedIndexValue)&&l.selectedIndexValue!=6&&l.option({selectedItemIndex:6}),l._initValue=!1);n("#"+i._id+"_Ribbon_Home_Font_Bold").length&&(u["font-weight"]=="bold"?n("#"+i._id+"_Ribbon_Home_Font_Bold").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_Home_Font_Bold").data("ejToggleButton").option("toggleState",!1));n("#"+i._id+"_Ribbon_Home_Font_Italic").length&&(u["font-style"]=="italic"?n("#"+i._id+"_Ribbon_Home_Font_Italic").data("ejToggleButton").option("toggleState",!0):n("#"+i._id+"_Ribbon_Home_Font_Italic").data("ejToggleButton").option("toggleState",!1));u["text-decoration"]=u["text-decoration"]||"";n("#"+i._id+"_Ribbon_Home_Font_Underline").length&&n("#"+i._id+"_Ribbon_Home_Font_Underline").data("ejToggleButton").option("toggleState",u["text-decoration"].indexOf("underline")!==-1);n("#"+i._id+"_Ribbon_Home_Font_StrikeThrough").length&&n("#"+i._id+"_Ribbon_Home_Font_StrikeThrough").data("ejToggleButton").option("toggleState",u["text-decoration"].indexOf("line-through")!==-1);this._tglAlignBtn(n(i.element).find(".e-text-align"),u,"text-align");g=this._tglAlignBtn(n(i.element).find(".e-vertical-align"),u,"vertical-align").isVertical;g||(h=i.element.find("#"+i._id+"_Ribbon_Home_Alignment_BottomAlign"),h.length&&(h.data("ejToggleButton").option("toggleState",!0),h.addClass("e-vertical-align")));i.getSheetElement(d).find(".e-ss-activeimg").length>0&&(h=i.element.find("#"+i._id+"_Ribbon_Home_Alignment_Merge"),h.length&&h.data("ejSplitButton").option("enabled",!1))}break;case"REVIEW":b=n("#"+i._id+"_Ribbon_Review_Changes_LockCell");!i.model.allowLockCell||i.XLComment&&i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||!b.length||(p=b.data("ejToggleButton"),y=i.XLEdit.getPropertyValue(s._activeCell.rowIndex,s._activeCell.colIndex,"isLocked"),i.isUndefined(y)&&(y=!1),p.option("toggleState",y),n("#"+i._id+"_Ribbon_Review_Changes_ProtectSheet").length&&n("#"+i._id+"_Ribbon_Review_Changes_ProtectSheet").data("ejToggleButton").option("toggleState",s.isSheetProtected),s.isSheetProtected?p.disable():p.enable());s.isSheetProtected&&i.model.allowLockCell||!i.model.allowComments||i.XLComment._isCommentEdit||i.XLEdit._isEdit||i._isSheetRename||i.XLComment._updateCmntRibIcons(i.getActiveCell())}!i.model.allowLockCell||s.isSheetProtected||!i.model.allowComments||i.XLComment._isCommentEdit||i._isSheetRename||this._refreshRibbonIcons(tt);i.model.isReadOnly&&i._readOnly()}},_tglAlignBtn:function(n,i,r){var e=!1,u,f=this.XLObj;return t.isNullOrUndefined(n[0])||(u=f.element.find("#"+n[0].id),u.length&&u.data("ejToggleButton").option("toggleState",!1),n.removeClass("e-"+r)),t.isNullOrUndefined(i[r])||(u=r==="vertical-align"?f.element.find("#"+f._id+"_Ribbon_Home_Alignment_"+i[r].charAt(0).toUpperCase()+i[r].slice(1)+"Align"):f.element.find("#"+f._id+"_Ribbon_Home_Alignment_Align"+i[r].charAt(0).toUpperCase()+i[r].slice(1)),u.length&&(u.data("ejToggleButton").option("toggleState",!0),u.addClass("e-"+r)),r==="vertical-align"&&(e=!0)),{isVertical:e}},_disableButtons:function(n,i){for(var e=-1,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&(r.XLEdit._isEdit||r._isSheetRename||!r.getSheet(r.getActiveSheetIndex()).isSheetProtected||(e=this._protectStateBtnIds.indexOf(n[u]))),e===-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).disable())},_enableButtons:function(n,i){for(var e=0,f,r=this.XLObj,u=0,o=n.length;u<o;u++)r.model.allowLockCell&&!r._isSheetRename&&r.getSheet(r.getActiveSheetIndex()).isSheetProtected&&(e=this._protectStateBtnIds.indexOf(n[u])),e>-1&&(f=r.element.find("#"+r._id+"_Ribbon_"+n[u]),f.length&&!t.isNullOrUndefined(f.data(i))&&f.data(i).enable())},_disableInputs:function(t,i){for(var r=0,u=t.length;r<u;r++)n("#"+this.XLObj._id+"_"+t[r]).attr("disabled",i)},_enableRibbonIcons:function(t){if(this.XLObj.model.showRibbon){var c,i=this.XLObj,r=n("#"+i._id+"_Ribbon").data("ejRibbon"),l=i.getActiveSheetIndex(),f=i.getSheet(l)._filterColl,h,u,e,o,s;c=t?t:r.model.selectedItemIndex;switch(r.getTabText(c)){case"HOME":this._enableButtons(this._homeBtnIds,"ejButton");this._enableButtons(this._homeSptBtnIds,"ejSplitButton");this._enableButtons(this._homeToggleBtnIds,"ejToggleButton");this._enableButtons(this._homeDdIds,"ejDropDownList");this._enableButtons(this._homeCpIds,"ejColorPicker");i._removeClass(r.element.find("#"+r._id+"_Number_e-groupexpander")[0],"e-disable");break;case"INSERT":this._enableButtons(this._insertBtnIds,"ejButton");this._enableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._enableButtons(this._dataBtnIds,"ejButton");this._enableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._enableButtons(this._pageLayBtnIds,"ejButton");this._enableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._enableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+r._id+"_pagesetup_viewhdrlbl").eq(0).removeClass("e-disable");n("#"+r._id+"_pagesetup_viewgrdlnlbl").eq(0).removeClass("e-disable");break;case"REVIEW":i.model.allowComments&&!i.XLComment._isCommentEdit&&i.XLComment._updateCmntRibIcons();this._enableButtons(this._reviewTglBtnIds,"ejToggleButton");break;case"OTHERS":this._enableButtons(this._othersBtnIds,"ejButton");this._enableButtons(this._othersSptBtnIds,"ejSplitButton");break;case i._getLocStr("Design"):this._enableButtons(this._contextualBtnIds,"ejButton");this._enableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!1)}for(i.XLClipboard._copyBackup.cells||i.XLClipboard._copyBackup.elem||(i.XLRibbon._disableButtons(["Home_Clipboard_Paste"],"ejButton")||i.XLRibbon._disableButtons(["Home_Clipboard_PasteOptions"],"ejSplitButton"),i.isPasteValuesOnly&&n("#"+i._id+"_Ribbon_Paste").data("ejMenu").disableItemByID("PasteSpecial")),n.isEmptyObject(f)&&this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton"),s=i.getObjectKeys(f),u=0,o=s.length;u<o;u++)for(h=i.getObjectKeys(f[s[u]]),e=0,o=h.length;e<o;e++)f[s[u]][h[e]].status.indexOf("e-ssfiltered")<0&&this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton");i._updateUndoRedoIcons()}},_disableRibbonIcons:function(){var i=this.XLObj,t;if(i.model.showRibbon){t=n("#"+i._id+"_Ribbon").data("ejRibbon");switch(t.getTabText(t.model.selectedItemIndex)){case"HOME":this._disableButtons(this._homeBtnIds,"ejButton");this._disableButtons(this._homeSptBtnIds,"ejSplitButton");this._disableButtons(this._homeToggleBtnIds,"ejToggleButton");this._disableButtons(this._homeDdIds,"ejDropDownList");this._disableButtons(this._homeCpIds,"ejColorPicker");i.addClass(t.element.find("#"+t._id+"_Number_e-groupexpander"),"e-disable");break;case"INSERT":this._disableButtons(this._insertBtnIds,"ejButton");this._disableButtons(this._insertSptBtnIds,"ejSplitButton");break;case"DATA":this._disableButtons(this._dataBtnIds,"ejButton");this._disableButtons(this._dataSptBtnIds,"ejSplitButton");break;case"PAGE LAYOUT":this._disableButtons(this._pageLayBtnIds,"ejButton");this._disableButtons(this._pageLaySptBtnIds,"ejSplitButton");this._disableButtons(this._pageLayChckBxIds,"ejCheckBox");n("#"+t._id+"_pagesetup_viewhdrlbl").eq(0).addClass("e-disable");n("#"+t._id+"_pagesetup_viewgrdlnlbl").eq(0).addClass("e-disable");break;case"REVIEW":this._disableButtons(this._cmntBtnIds,"ejButton");this._disableButtons(this._cmntTglBtnIds,"ejToggleButton");this._disableButtons(this._reviewTglBtnIds,"ejToggleButton");break;case"OTHERS":this._disableButtons(this._othersBtnIds,"ejButton");this._disableButtons(this._othersSptBtnIds,"ejSplitButton");break;case this.XLObj._getLocStr("Design"):this._disableButtons(this._contextualBtnIds,"ejButton");this._disableButtons(this._contextualCheckBoxIds,"ejCheckBox");this._disableInputs(this._contextualInputIds,!0)}}},_capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},_generateToggleBtn:function(n,i,r,u,f,e,o,s,h,c,l,a,v,y){return{id:n,toolTip:this.XLObj._getLocStr(i),type:t.Ribbon.type.toggleButton,enableSeparator:h,toggleButtonSettings:{width:e,height:o,contentType:r,cssClass:c,toggleState:y,defaultPrefixIcon:u,activePrefixIcon:v?v:u,defaultText:this.XLObj._getLocStr(i),activeText:a?this.XLObj._getLocStr(a):this.XLObj._getLocStr(i),imagePosition:l=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,click:this._ribbonClickHandler},customToolTip:{title:this.XLObj._getLocStr(f),content:"<h6>"+this.XLObj._getLocStr(s)+"<\/h6>"}}},_generateBtn:function(n,i,r,u,f,e,o,s,h,c,l){return{id:n,text:this.XLObj._getLocStr(i),toolTip:this.XLObj._getLocStr(i),cssClass:l,enableSeparator:h,buttonSettings:{type:t.Ribbon.type.button,contentType:r,width:f,height:e,imagePosition:c=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,prefixIcon:u,click:this._ribbonClickHandler},customToolTip:{title:this.XLObj._getLocStr(o),content:"<h6>"+this.XLObj._getLocStr(s)+"<\/h6>"}}},_generateDD:function(n,i,r,u,f,e,o,s){return{id:n,text:this.XLObj._getLocStr(i),toolTip:this.XLObj._getLocStr(i),type:t.Ribbon.type.dropDownList,dropdownSettings:{dataSource:r,value:u,change:this._ribbonClickHandler,width:f,height:e-1,cssClass:"e-"+this.XLObj._id+"-ddl"},customToolTip:{title:this.XLObj._getLocStr(o),content:"<h6>"+this.XLObj._getLocStr(s)+"<\/h6>"}}},_generateCustomControl:function(n,i,r,u){return{type:t.Ribbon.type.custom,contentID:n,toolTip:this.XLObj._getLocStr(i),click:this._ribbonClickHandler,change:this._ribbonClickHandler,customToolTip:{title:this.XLObj._getLocStr(r),content:"<h6>"+this.XLObj._getLocStr(u)+"<\/h6>"}}},_generateSplitBtn:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){return{id:i,toolTip:this.XLObj._getLocStr(r),text:this.XLObj._getLocStr(r),type:t.Ribbon.type.splitButton,cssClass:y+" e-"+this.XLObj._id+"-spltbtn",enableSeparator:s,splitButtonSettings:{contentType:u,targetID:f,arrowPosition:l=="bottom"?t.ArrowPosition.Bottom:t.ArrowPosition.Right,imagePosition:a=="imagetop"?t.ImagePosition.ImageTop:t.ImagePosition.ImageLeft,buttonMode:v=="dropdown"?t.ButtonMode.Dropdown:t.ButtonMode.Split,fields:e,prefixIcon:o,click:this._ribbonClickHandler,itemSelected:this._ribbonClickHandler,height:c,width:h,beforeOpen:n.proxy(this._splitBeforeOpen,this,i),close:i==="Others_Cells_InsertCellOptions"||i==="Others_Cells_DeleteCellOptions"||i==="Data_DataTools_DataValidationOptions"||i==="Home_Clipboard_PasteOptions"?n.proxy(this._splitbtnClose,this,i):null},customToolTip:{title:this.XLObj._getLocStr(p),content:"<h6>"+this.XLObj._getLocStr(w)+"<\/h6>"}}},_splitBeforeOpen:function(t,i){var r=this.XLObj,u;t==="Home_Editing_SortFilter"?this._sfbeforeOpen(i):t==="Others_Cells_InsertCellOptions"||t==="Others_Cells_DeleteCellOptions"?this._insdelbeforOpen(i):t==="Others_Window_FreezePanes"?this._fpbeforeOpen(i):t==="ChartDesign_ChartLayouts_AddChartElement"?this._celementpbeforeOpen(i):t==="Data_DataTools_DataValidationOptions"||t==="Home_Clipboard_PasteOptions"?this._validpasteOpen(i):t==="Home_Editing_Clear"?this._clearbeforeOpen(i):t==="Home_Styles_FormatAsTable"?(u=document.getElementById(r._id+"_formatastable"),u&&(!u||u.children.length)||this._renderFormatAsTable(),r.XLFormat._resizeFormatTableMenu()):t==="Home_Styles_CellStyles"?r.XLFormat._resizeStyleMenu():t==="Home_Font_Border"?r.XLFormat._resizeBorderMenu(i):t==="Home_Styles_ConditionalFormatting"&&(r._phoneMode?n("#"+r._id+"_CFormat").find("ul").addClass("e-adaptive"):n("#"+r._id+"_CFormat").find("ul").removeClass("e-adaptive"))},_splitbtnClose:function(n){this.XLObj.element.find("#"+this.XLObj._id+"_Ribbon_"+n).parents("div.e-controlpadding").siblings().children("button").removeClass("e-active")},_fpbeforeOpen:function(){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_FPane").data("ejMenu"),t=r.model.fields.dataSource.slice(0);i.getSheet()._isFreezed?(t[0].id="UnFreezePanes",t[0].text=i._getLocStr("UnFreezePanes")):(t[0].id="freezePanes",t[0].text=i._getLocStr("FreezePanes"));r.option("fields",{id:"id",dataSource:t,parentId:"parentId"})},_sfbeforeOpen:function(){var t=this.XLObj,i=n("#"+t._id+"_Ribbon_SortFilter").data("ejMenu");t.model.allowFiltering||i.disableItemByID("Ribbon_Filter");t.model.allowSorting||(i.disableItemByID("Ribbon_SortAtoZ"),i.disableItemByID("Ribbon_SortZtoA"));this._refreshRibbonIcons()},_validpasteOpen:function(n){var t=this.XLObj;n.model.targetID===t._id+"_Ribbon_Validation"?t.element.find("#"+t._id+"_Ribbon_Data_DataTools_DataValidation").addClass("e-active"):t.element.find("#"+t._id+"_Ribbon_Home_Clipboard_Paste").addClass("e-active")},_insdelbeforOpen:function(t){var i=this.XLObj,r=n("#"+i._id+"_Ribbon_Ins").data("ejMenu"),u=n("#"+i._id+"_Ribbon_Del").data("ejMenu"),h=["DeleteCells","DeleteSheetRows","DeleteSheetColumns"],c=["InsertCells","InsertSheetRows","InsertSheetColumns"],e,o,s,f;if(t.model.targetID===i._id+"_Ribbon_Ins"?i.element.find("#"+i._id+"_Ribbon_Others_Cells_InsertCell").addClass("e-active"):i.element.find("#"+i._id+"_Ribbon_Others_Cells_DeleteCell").addClass("e-active"),e=i.element.find(".e-colselected").length?"disableItemByID":"enableItemByID",r&&r[e]("InsertSheetRows"),u&&u[e]("DeleteSheetRows"),o=i.element.find(".e-rowselected").length?"disableItemByID":"enableItemByID",r&&r[o]("InsertSheetColumns"),u&&u[o]("DeleteSheetColumns"),s=i.model.exportSettings.password?"disableItemByID":"enableItemByID",r&&r[s]("InsertSheet"),u&&u[s]("DeleteSheet"),i.getSheet(i.getActiveSheetIndex()).isSheetProtected)for(f=0;f<3;f++)u&&u.disableItemByID(h[f]),r&&r.disableItemByID(c[f]);else u&&u.enableItemByID("DeleteCells"),r&&r.enableItemByID("InsertCells")},_celementpbeforeOpen:function(){var t=this.XLObj;if(chartEle=n("#"+t._id+"_chart").val(),chType=t.XLChart._getShapeObj(chartEle,"chart").type,cEleMenuObj=n("#"+t._id+"_Ribbon_CElement").data("ejMenu"),pieChart=["Axes","AxisTitle","Gridline"],radarChart=["AxisTitle","PMinorH","PMinorV"],menuEle=["Axes","AxisTitle","Gridline","PMinorH","PMinorV"],i,len=0,cEleMenuObj)return!1;for(i=0,len=menuEle.length;i<len;i++)cEleMenuObj.enableItemByID(menuEle[i]);if(chType==="pie"||chType==="doughnut")for(i=0,len=pieChart.length;i<len;i++)cEleMenuObj.disableItemByID(pieChart[i]);else if(chType==="radar")for(i=0,len=radarChart.length;i<len;i++)cEleMenuObj.disableItemByID(radarChart[i])},_clearbeforeOpen:function(){var i=this.XLObj,t=0,u=n("#"+i._id+"_Ribbon_Clear").data("ejMenu"),r=["Clear_Hyperlinks","Clear_Comments"];if(i.model.allowLockCell)if(i.getSheet(i.getActiveSheetIndex()).isSheetProtected)while(t<r.length)u.disableItemByID(r[t]),t++;else while(t<r.length)u.enableItemByID(r[t]),t++},_changeClrFltrStatus:function(n,t){var i=this.XLObj,r=i.getActiveSheetIndex();i.isUndefined(n)||(this._isFilterSelect.isFiltered?t==="menu"?n._id.indexOf("Ribbon")>-1?n.enableItemByID("Ribbon_ClearFilter"):n.enableItemByID("ClearFilter"):n.enable():t==="menu"?n._id.indexOf("Ribbon")>-1?n.disableItemByID("Ribbon_ClearFilter"):n.disableItemByID("ClearFilter"):n.disable())},_onControlCreated:function(){this._ctrlCreated=!0;xlRbn=n("#"+this.XLObj._id+"_Ribbon").ejRibbon("instance");this.XLObj.model.ribbonSettings.enableOnDemand||(this._homeTabControls(),this._othersTabControls(),this._pageTabControls(),this._appTabControls());this._hideTabs();this._ctrlCreated=!1},_appTabControls:function(){var r=this.XLObj,u=r.element,i=r._id,t={height:158,width:163,text:r._getLocStr("BlankWorkbook"),contentType:"textandimage",imagePosition:"imagetop",prefixIcon:"e-ss-blank",click:n.proxy(this._onBackStageItemClick,this)};n("#"+i+"_bstab_new_blank").ejButton(t);delete t.text;t.height=t.width=72;t.prefixIcon="e-icon e-ss-exportxl";n("#"+i+"_bstab_saveas_excel").ejButton(t);t.prefixIcon="e-icon e-ss-exportcsv";n("#"+i+"_bstab_saveas_csv").ejButton(t);t.prefixIcon="e-icon e-ss-exportpdf";n("#"+i+"_bstab_saveas_pdf").ejButton(t);t.prefixIcon="e-icon e-ss-print";n("#"+i+"_bstab_print_sheet").ejButton(t);t.prefixIcon="e-icon e-ss-printselected";n("#"+i+"_bstab_print_selected").ejButton(t)},_othersTabControls:function(){var n=this.XLObj;!n.model.allowInsert&&n.model.scrollSettings.allowScrolling&&(this._disableButtons(["Others_Cells_InsertCellOptions"],"ejSplitButton"),this._disableButtons(["Others_Cells_InsertCell"],"ejButton"));!n.model.allowDelete&&n.model.scrollSettings.allowScrolling&&(this._disableButtons(["Others_Cells_DeleteCellOptions"],"ejSplitButton"),this._disableButtons(["Others_Cells_DeleteCell"],"ejButton"))},_pageTabControls:function(){var t=this.XLObj,r=t._id,i=r+"_Ribbon_pagesetup",u=r+"_Ribbon_PageLayout_Show_";n("#"+i+"left").show();n("#"+u+"Headings").ejCheckBox({change:this._ribbonClickHandler,checked:!0});n("#"+u+"Gridlines").ejCheckBox({change:this._ribbonClickHandler,checked:!0});n("#"+i+"_viewhdrlbl").text(t._getLocStr("Heading"));n("#"+i+"_viewgrdlnlbl").text(t._getLocStr("Gridlines"))},_homeTabControls:function(){var u=this.XLObj,i=u._id,f=u.element,r=i+"_Ribbon_",t=r+"Home_Font_";n("#"+t+"FillColor").ejColorPicker({value:"#FFFF00",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-backgroundcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FillColor"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FillColor"),select:n.proxy(this._cpClickHandler,this,"Ribbon_Home_Font_FillColor")});n("#"+t+"FontColor").ejColorPicker({value:"#FF0000",modelType:"palette",showSwitcher:!1,cssClass:"e-ss-colorpicker",toolIcon:"e-ss-fontcolor",open:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FontColor"),change:n.proxy(this._colorPickerHandler,this,"Ribbon_Home_Font_FontColor"),select:n.proxy(this._cpClickHandler,this,"Ribbon_Home_Font_FontColor")});n("#"+t+"BorderColor").ejColorPicker({modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",change:this._ribbonClickHandler});n("#"+t+"BorderColorWrapper").hide();n("#"+i+"_bordercolor ul li").find("a").remove();n("#"+i+"_bordercolor ul li").append(n("#"+t+"BorderColor_popup"));n("#"+t+"BorderColor_popup").css({display:"block"});n("#"+r+"BorderCP").ejColorPicker({value:"#278787",displayInline:!0,modelType:"picker"});n("#"+r+"BorderCP_Presets").hide();n("#"+i+"_CFormat").width(200);n("#"+r+"Border").addClass("e-spreadsheet e-border");n("#"+t+"FontColor_Presets").css({width:"142px",top:"40px"});n("#"+t+"FillColor_Presets").css({width:"142px",top:"40px"});this._disableButtons(["Home_Clipboard_Paste"],"ejButton");this._disableButtons(["Home_Clipboard_PasteOptions","Others_Formulas_UseInFormula"],"ejSplitButton");n("#"+t+"FillColor_popup").find(".e-buttons, .e-button").hide();n("#"+t+"FontColor_popup").find(".e-buttons, .e-button").hide()},_hideRibbonElem:function(t){var s=this.XLObj,d=s._id,e=n("#"+s._id+"_Ribbon").data("ejRibbon"),i=s.model,r=e.element,u=d+"_Ribbon",a=u+"_home_Clipboard_Home_Clipboard_",f=u+"_home_Alignment_Home_Alignment_",v=u+"_separator_Home_Alignment_",c=u+"_home_Styles_Home_Styles_",p=u+"_home_Font_Home_Font_",w=u+"_home_Number_Home_Number_",y=u+"_home_Editing_Home_Editing_",o=u+"_insert_",l=u+"_data_",b=u+"_pagelayout_PageLayout",k=u+"_review_Changes_Review_Changes_",h=u+"_others_";i.allowFormulaBar||s.hideFormulaBar();switch(t){case"HOME":i.allowAutoSum||i.allowFiltering||i.allowUndoRedo||i.allowSorting||i.allowClipboard||i.allowFormatPainter||i.allowCellFormatting||i.allowMerging||i.allowWrap||i.allowConditionalFormats||i.allowFormatAsTable||e.hideTab("HOME");i.allowFormatPainter||r.find("#"+a+"FormatPainter").hide();i.allowClipboard||(r.find("#"+u+"_home_Clipboard_1").hide(),r.find("#"+a+"Cut").hide(),r.find("#"+a+"Copy").hide());i.allowClipboard||i.allowFormatPainter||r.find("#"+u+"_home_Clipboard").hide();i.allowCellFormatting||(r.find("#"+u+"_home_Font").hide(),r.find("#"+u+"_home_Number").hide(),r.find("#"+f+"TopAlign").hide(),r.find("#"+f+"MiddleAlign").hide(),r.find("#"+f+"BottomAlign").hide(),r.find("#"+v+"BottomAlign").hide(),r.find("#"+f+"AlignLeft").hide(),r.find("#"+f+"AlignCenter").hide(),r.find("#"+f+"AlignRight").hide(),r.find("#"+v+"AlignRight").hide(),r.find("#"+f+"DecreaseIndent").hide(),r.find("#"+f+"IncreaseIndent").hide(),r.find("#"+v+"IncreaseIndent").hide(),r.find("#"+c+"CellStyles").hide(),i.allowConditionalFormats||i.allowFormatAsTable||r.find("#"+u+"_home_Styles").hide());i.allowCellFormatting&&(i.formatSettings.allowFontFamily||r.find("#"+p+"FontFamily").hide(),i.formatSettings.allowDecimalPlaces||(r.find("#"+w+"IncreaseDecimal").hide(),r.find("#"+w+"DecreaseDecimal").hide(),r.find("#"+u+"_separator_Home_Number_CommaStyle").hide()),i.formatSettings.allowCellBorder||r.find("#"+p+"Border").hide());i.allowMerging||r.find("#"+f+"Merge").hide();i.allowWrap||r.find("#"+f+"WrapText").hide();i.allowUndoRedo||r.find("#"+u+"_home_Actions").hide();i.allowFormatAsTable||r.find("#"+c+"FormatAsTable").hide();i.allowConditionalFormats||i.allowFormatAsTable||i.allowCellFormatting||r.find("#"+u+"_home_Styles").hide();i.allowConditionalFormats||r.find("#"+c+"ConditionalFormatting").hide();i.allowEditing&&(i.allowAutoSum||r.find("#"+y+"AutoSum").hide(),i.allowSorting||i.allowFiltering||r.find("#"+s._id+"_Ribbon_home_Editing_1").hide());i.allowAutoSum||r.find("#"+y+"AutoSum").hide();i.allowClear||r.find("#"+y+"Clear").hide();break;case"INSERT":i.allowFormatAsTable||i.allowPictures||i.allowHyperlink||i.allowCharts||e.hideTab("INSERT");i.enablePivotTable||i.allowFormatAsTable?i.enablePivotTable||r.find("#"+o+"Tables_Insert_Tables_PivotTable").hide():(r.find("#"+o+"Tables").hide(),r.find("#"+c+"FormatAsTable").hide(),r.find("#"+o+"Tables_Insert_Tables_PivotTable").hide());i.pictureSettings.allowPictures||r.find("#"+o+"Illustrations").hide();i.allowHyperlink||r.find("#"+o+"Links").hide();i.allowCharts||r.find("#"+o+"Charts").hide();i.allowFormatAsTable||i.enablePivotTable||r.find("#"+o+"Tables").hide();break;case"DATA":i.allowDataValidation||i.allowFiltering||i.allowSorting||e.hideTab("DATA");i.allowFiltering||r.find("#"+l+"SortFilter_2").hide();i.allowSorting||r.find("#"+l+"SortFilter_1").hide();i.allowDataValidation||r.find("#"+l+"DataTools").hide();i.allowFiltering||i.allowSorting||r.find("#"+l+"Sort").hide();break;case"PAGE LAYOUT":i.printSettings.allowPrinting||e.hideTab("PAGE LAYOUT");i.printSettings.allowPrinting||r.find("#"+b+"Print_Print").hide();i.printSettings.allowPageSize||r.find("#"+b).hide();i.allowComments||i.allowLockCell||e.hideTab("REVIEW");i.allowLockCell||(r.find("#"+k+"ProtectSheet").hide(),r.find("#"+k+"LockCell").hide());i.allowComments||r.find("#"+u+"_review_Comments").hide();break;case"OTHERS":i.allowFreezing||i.allowInsert||i.allowDelete||i.allowSearching||e.hideTab("OTHERS");i.allowInsert||i.allowDelete||r.find("#"+h+"Cells").hide();i.allowInsert||r.find("#"+h+"Cells_1").hide();i.allowDelete||r.find("#"+h+"Cells_2").hide();i.allowFreezing||(s._phoneMode?r.find("#"+h+"Window_1").hide():r.find("#"+h+"Window").hide());i.allowSearching||r.find("#"+h+"Editing").hide()}i.allowImport||r.find("#open_backStageTab").hide();i.exportSettings.allowExporting||r.find("#saveas_backStageTab").hide();i.printSettings.allowPrinting||r.find("#print_backStageTab").hide()},_pictureSizeChange:function(t,i){var f=this.XLObj,u,o=f.getActiveSheetIndex(),r=f.getSheetElement(o).find(".e-ss-activeimg"),e={sheetIndex:o,reqType:"shape",shapeType:"picture",action:"picturesize",name:t,id:n(r).attr("id"),prev:{},cur:{}};f._shapeChange||this._isSetModel||(e.prev={width:r.width(),height:r.height()},t==="PictureHeight"?(u=parseInt(r.height()*i.value/r.width()),r.css({width:i.value,height:u}),e.cur={width:i.value,height:u}):(u=parseInt(r.width()*i.value/r.height()),r.css({height:i.value,width:u}),e.cur={height:i.value,width:u}),this._isSetModel=!0,n("#"+f._id+"_Ribbon_Format_Size_"+t).ejNumericTextbox("option",{value:u}),this._isSetModel=!1,f._completeAction(e),f.XLShape._updateShapeObj(r[0]))},_chartTypeOk:function(){var r=this.XLObj,o=r.element.find("#"+r._id+"_chart").val(),u=n("#"+o).data("ejChart"),e,t,f,s,h,i;f=n("#"+r._id+"_allchart").find(".e-chartselect:eq(0)").attr("class").split(" ")[1];t=f.split("e-dlg")[1].split("chart");s=["e-dlgcolumnchart4","e-dlgcolumnchart5","e-dlgcolumnchart6","e-dlgbarchart4","e-dlgbarchart5","e-dlgbarchart6","e-dlgpiechart2"];h=["e-dlgstockchart2","e-dlglinechart2","dlgradarchart2"];i={type:t[0],enable3D:!1,marker:{visible:!1}};(t[0]==="column"||t[0]==="bar"||t[0]==="area")&&(t[1]==="1"||t[1]==="4"?i.type=t[0]:t[1]==="2"||t[1]==="5"?i.type="stacking"+t[0]:(t[1]==="3"||t[1]==="6")&&(i.type="stacking"+t[0]+"100"));s.indexOf(f)>-1&&(i.enable3D=!0);h.indexOf(f)>-1&&(i.marker={visible:!0});f==="e-dlgpiechart3"&&(i.type="doughnut");e={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:o};e.prev={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};r.XLChart.refreshChart(o,i);e.cur={chartType:u.model.series[0].type,enable3D:u.model.enable3D,marker:u.model.series[0].marker.visible};n("#"+r._id+"_charttypedlg").ejDialog("close");r._completeAction(e)},_chartTypeCancel:function(){var t=this.XLObj;n("#"+t._id+"_charttypedlg").ejDialog("close");t.setSheetFocus()},_chartType:function(t,i,r,u,f,e){for(var v,y,l,c,a,p="<div class='e-chartheader'><span>",s="<div class='e-chartcontent'<\/div>",w=t.toLowerCase(),b={visible:!1},h=this.XLObj,k=h._getLocStr(t).split("/"),o=0;o<i;o++)v="<div class='e-"+h._id+" e-chartcell e-"+w+(o+1)+"' title="+h._getLocStr(e[o])+"><\/div>",s+=v,o===r&&(s+="<\/div>"+p+k[1]+"<\/span><\/div><div class='e-chartcontent'<\/div>");for(c=n("<div id="+h._id+"_Ribbon_"+t+" class='e-ss-dialog e-ss-chart e-ss-"+h._id+"' style='height:auto;'>"+p+k[0]+"<\/span><\/div>"+s+"<\/div>"),y=c.find(".e-chartcell"),o=0;o<i;o++)l=n(y[o]),a=f[o],l.data({type:a,enable3D:!1,marker:b}),o>u&&l.data({type:a,enable3D:!0,marker:b});s=n(c).find(".e-"+w+"2");(t==="StockChart"||t==="LineChart")&&s.data({marker:{visible:!0}});t==="PieChart"&&s.data({enable3D:!0});h.element[0].appendChild(c[0])},autoSum:function(i,r){var nt;if(this.XLObj.model.allowAutoSum){var f=this.XLObj,b=f.XLEdit,s=f.getActiveSheetIndex(),k=f.getActiveCell(s),tt=!1,a;if(!t.isNullOrUndefined(k)){var l,d,y=f.getActiveCell(s),p,g=f._getRangeArgs(r,"object"),o=f._getSelectedCells(s,g).selCells,c=o.length-1,it=o[c].rowIndex-o[0].rowIndex,rt=o[c].colIndex-o[0].colIndex,v={sheetIndex:s,range:r,reqType:"auto-sum",oprType:i,updCell:[]},u,e,w,ut=f.getRangeData({range:[o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex],valueOnly:!0}).length,h=f._dataContainer.sheets[s];if(c!==0&&ut)if(it===0&&rt>0){for(p=f._getAlphaRange(s,o[0].rowIndex,o[0].colIndex,o[c].rowIndex,o[c].colIndex),u=o[c].rowIndex,e=o[c].colIndex+1,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");!t.isNullOrUndefined(a)&&a!="";)e++,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");e===f.getSheet(s).colCount&&f.XLScroll._createNewColumn(s,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert");f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")});t.isNullOrUndefined(h[u])&&(h[u]={});t.isNullOrUndefined(h[u][e])&&(h[u][e]={});f._isUndoRedo||n.extend(!0,v.updCell[0].pObj,h[u][e]);f._isRowViewable(s,u)&&(w=f.getCell(u,e,s),w.addClass("e-ralign"));b._updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+p+")");"COUNT".indexOf(i)<0&&f._autosumFormatUpdate(f.getRangeData({range:[o[0].rowIndex,o[0].colIndex,o[0].rowIndex,o[0].colIndex]})[0],[u,e,u,e],!1,!1)}else{for(d=o[c].colIndex-o[0].colIndex,u=o[c].rowIndex+1,l=0;l<=d;l++)for(e=o[l].colIndex,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2"),nt=u;!t.isNullOrUndefined(a)&&a!="";)u++,nt=u,a=this.XLObj.XLEdit.getPropertyValue(u,e,"value2");for(l=0;l<=d;l++)e=o[l].colIndex,u=nt,p=f._getAlphaRange(s,o[0].rowIndex,e,o[c].rowIndex,e),o[c].rowIndex===f.getSheet(s).rowCount-1&&f.XLScroll._createNewRow(s,-1,-1,"insert"),f._isUndoRedo||v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),f._isUndoRedo||n.extend(!0,v.updCell[l].pObj,h[u][e]),f._isRowViewable(s,u)&&(w=f.getCell(u,e,s),w.addClass("e-ralign")),b._updateCellValue({rowIndex:u,colIndex:e},"="+i+"("+p+")"),"COUNT".indexOf(i)<0&&f._autosumFormatUpdate(f.getRangeData({range:[o[0].rowIndex,o[l].colIndex,o[0].rowIndex,o[l].colIndex]})[0],[u,e,u,e],!1,!1)}else u=k.rowIndex,e=k.colIndex,v.updCell.push({rowIndex:u,colIndex:e,pObj:{},pValue:t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,e,"value2"))?"":f.XLEdit.getPropertyValue(u,e,"value2")}),t.isNullOrUndefined(h[u])&&(h[u]={}),t.isNullOrUndefined(h[u][e])&&(h[u][e]={}),n.extend(!0,v.updCell[0].pObj,h[u][e]),f._isRowViewable(s,y.rowIndex)||f.XLScroll._scrollSelectedPosition(s,y),b.editCell(y.rowIndex,y.colIndex,!0),f.model.allowFormulaBar&&f._getInputBox().val("="+i+"()"),f._isRowViewable(s,u)&&(f.XLEdit._editElem.text("="+i+"()"),f.XLEdit._editElem.focusEnd()),tt=!0;f.performSelection({rowIndex:g[0],colIndex:g[1]},{rowIndex:u,colIndex:e});f._isUndoRedo||tt||f._completeAction(v)}}},_openNameManagerDlg:function(){var i=this.XLObj,t;i._showDialog(i._id+"_Ribbon_Others_NameManager");t=n("#"+i._id+"_nmgrid").data("ejGrid");t.getContentTable().find("td").addClass("e-ss-emptyrecord");t.model.dataSource.length<1?t.getContentTable().find("td").addClass("e-ss-emptyrecord"):t.getContentTable().find(".e-ss-emptyrecord").removeClass("e-ss-emptyrecord");this._refreshNMDlg();i._browserDetails.name=="msie"&&t.refreshContent();n("#"+i._id+"_nmgrid").focus()},_openFATDlg:function(){var t=this.XLObj;n("#"+t._id+"_fatnamedlg").ejDialog("open");n("#"+t._id+"_fatheader").ejCheckBox("option","checked",!1);n("#"+t._id+"_fatname").val("Table"+t._tableCnt).focus().setInputPos(n("#"+t._id+"_fatname").val().length)},_dirtySelect:function(){var f=this.XLObj,h=f.getActiveSheetIndex(),n,i=f.getSheet(h).filterSettings.tableRange,w=!1,e=!1,c=!1,l=!1,a=!1,v=!1,b=!1,o=!1,s=!1,r=!1,u=!1,k=0,y=!1,p=!1,t,d;if(!f.model.allowLockCell||!f.getSheet(h).isSheetProtected){if(n=f.getSheet(h)._selectedCells,n.length>0)for(t=0,d=i.length;t<d;t++){if(i[t].startRow-1<=n[0].rowIndex&&i[t].endRow>=n[n.length-1].rowIndex?u=!0:i[t].startRow-1>n[0].rowIndex&&n[n.length-1].rowIndex>=i[t].startRow-1&&i[t].endRow>=n[n.length-1].rowIndex?o=!0:i[t].startRow-1<=n[0].rowIndex&&n[0].rowIndex<=i[t].endRow&&i[t].endRow<n[n.length-1].rowIndex?o=!0:i[t].startRow-1>n[n.length-1].rowIndex?l=!0:i[t].endRow<n[0].rowIndex?a=!0:i[t].endRow<n[n.length-1].rowIndex&&i[t].startRow>n[0].rowIndex?y=!0:u=!1,i[t].multifilterIdx[0]<=n[0].colIndex&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]>=n[n.length-1].colIndex?r=!0:i[t].multifilterIdx[0]>n[0].colIndex&&n[n.length-1].colIndex>=i[t].multifilterIdx[0]&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]>=n[n.length-1].colIndex?s=!0:i[t].multifilterIdx[0]<=n[0].colIndex&&n[0].colIndex<=i[t].multifilterIdx[i[t].multifilterIdx.length-1]&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[n.length-1].colIndex?s=!0:i[t].multifilterIdx[0]>n[n.length-1].colIndex?v=!0:i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[0].colIndex?b=!0:i[t].multifilterIdx[0]>n[0].colIndex&&i[t].multifilterIdx[i[t].multifilterIdx.length-1]<n[n.length-1].colIndex?p=!0:r=!1,o&&s||o&&r||u&&s||o&&!b&&!v||s&&!l&&!a||y&&p||u&&p||r&&y){e=!0;break}if(!e){if((l||a||v)&&(e=!1,w=!1),u&&r){c=!0;k=t;break}u||r||(w=!0)}}this._isDirtySelect=e;this._isMergeSelect=c||e;this._isFilterSelect={status:c,tableIdx:k,isFiltered:!1}}},_refreshRibbonIcons:function(){var t=this.XLObj,e=t.getActiveSheetIndex(),i=n("#"+t._id+"_contextMenuCell").data("ejMenu"),o=["Home_Editing_SortFilter","Home_Editing_Clear","Home_Styles_FormatAsTable"],s=["Insert_Tables_Table","Design_Tools_ConvertToRange","Data_SortFilter_Filter","Data_SortFilter_ClearFilter"],h=n("#"+t._id+"_Ribbon_Home_Alignment_Merge").data("ejSplitButton"),r,l,f,u,c;if(!t.XLEdit._isEdit&&t.getSheetElement(e).find(".e-ss-activeimg").length<1&&h&&h.option("enabled",!this._isMergeSelect),this._isDirtySelect?(this._disableButtons(o,"ejSplitButton"),this._disableButtons(s,"ejButton"),i&&i.disableItemByID("Sort")):t.XLEdit._isEdit||(this._enableButtons(o,"ejSplitButton"),this._enableButtons(s,"ejButton"),i&&t.model.allowSorting&&i.enableItemByID("Sort")),r=t.getSheet(e).filterSettings.tableRange[this._isFilterSelect.tableIdx],this._isFilterSelect.status&&r){for(l=!1,f=r.multifilterIdx,u=0,c=f.length;u<c;u++)if(filterVal=t.XLEdit.getPropertyValue(r.startRow-1,f[u],"filterState"),filterVal&&filterVal.indexOf("filtered")>-1){this._isFilterSelect.isFiltered=!0;break}this._isFilterSelect.isFiltered?this._enableButtons(["Data_SortFilter_ClearFilter"],"ejButton"):this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton")}else this._disableButtons(["Data_SortFilter_ClearFilter"],"ejButton");this._isHomeTabCreate&&n("#"+t._id+"_Ribbon_SortFilter").ejMenu("disableItemByID","Ribbon_ClearFilter")},_onGroupExpander:function(n){var t=this.XLObj;if(!t.model.isReadOnly&&!t.XLEdit._isEdit)switch(n.target.id){case t._id+"_Ribbon_Number_e-groupexpander":t._showDialog(t._id+"_FormatCells")}},disableRibbonItems:function(n){var e=this.XLObj,i,u,r,f,t;if(!e.model.isReadOnly)for(r=0,f=n.length;r<f;r++){u=n[r].split("_")[2].toUpperCase();t=n[r].split("_Ribbon_")[1];do{switch(u){case"HOME":this._homeBtnIds.indexOf(t)>-1?(i="ejButton",this._homeBtnIds.splice(this._homeBtnIds.indexOf(t),1)):this._homeSptBtnIds.indexOf(t)>-1?(i="ejSplitButton",this._homeSptBtnIds.splice(this._homeSptBtnIds.indexOf(t),1)):this._homeToggleBtnIds.indexOf(t)>-1?(i="ejToggleButton",this._homeToggleBtnIds.splice(this._homeToggleBtnIds.indexOf(t),1)):this._homeDdIds.indexOf(t)>-1?(i="ejDropDownList",this._homeDdIds.splice(this._homeDdIds.indexOf(t),1)):this._homeCpIds.indexOf(t)>-1&&(i="ejColorPicker",this._homeCpIds.splice(this._homeCpIds.indexOf(t),1));break;case"INSERT":this._insertBtnIds.indexOf(t)>-1?(i="ejButton",this._insertBtnIds.splice(this._insertBtnIds.indexOf(t),1)):this._insertSptBtnIds.indexOf(t)>-1&&(i="ejSplitButton",this._insertSptBtnIds.splice(this._insertSptBtnIds.indexOf(t),1));break;case"DATA":this._dataBtnIds.indexOf(t)>-1?(i="ejButton",this._dataBtnIds.splice(this._dataBtnIds.indexOf(t),1)):this._dataSptBtnIds.indexOf(t)>-1&&(i="ejSplitButton",this._dataSptBtnIds.splice(this._dataSptBtnIds.indexOf(t),1));break;case"PAGELAYOUT":this._pageLayBtnIds.indexOf(t)>-1?(i="ejButton",this._pageLayBtnIds.splice(this._pageLayBtnIds.indexOf(t),1)):this._pageLaySptBtnIds.indexOf(t)>-1?(i="ejSplitButton",this._pageLaySptBtnIds.splice(this._pageLaySptBtnIds.indexOf(t),1)):this._pageLayChckBxIds.indexOf(t)>-1&&(i="ejCheckBox",this._pageLayChckBxIds.splice(this._pageLayChckBxIds.indexOf(t),1));break;case"REVIEW":this._cmntBtnIds.indexOf(t)>-1?(i="ejButton",this._cmntBtnIds.splice(this._cmntBtnIds.indexOf(t),1)):this._cmntTglBtnIds.indexOf(t)>-1?(i="ejToggleButton",this._cmntTglBtnIds.splice(this._cmntTglBtnIds.indexOf(t),1)):this._reviewTglBtnIds.indexOf(t)>-1&&(i="ejToggleButton",this._reviewTglBtnIds.splice(this._reviewTglBtnIds.indexOf(t),1));break;case"OTHERS":this._othersBtnIds.indexOf(t)>-1?(i="ejButton",this._othersBtnIds.splice(this._othersBtnIds.indexOf(t),1)):this._othersSptBtnIds.indexOf(t)>-1&&(i="ejSplitButton",this._othersSptBtnIds.splice(this._othersSptBtnIds.indexOf(t),1));break;case"FORMAT":this._formatBtnIds.indexOf(t)>-1?(i="ejButton",this._formatBtnIds.splice(this._formatBtnIds.indexOf(t),1)):this._formatSptBtnIds.indexOf(t)>-1&&(i="ejSplitButton",this._formatSptBtnIds.splice(this._formatSptBtnIds.indexOf(t),1));break;case"DESIGN":this._contextualBtnIds.indexOf(t)>-1?(i="ejButton",this._contextualBtnIds.splice(this._contextualBtnIds.indexOf(t),1)):this._contextualCheckBoxIds.indexOf(t)>-1?(i="ejCheckBox",this._contextualCheckBoxIds.splice(this._contextualCheckBoxIds.indexOf(t),1)):this._contextualInputIds.indexOf(t)>-1&&(i=!0);break;case"CHARTDESIGN":this._chartDesignBtnIds.indexOf(t)>-1?(i="ejButton",this._chartDesignBtnIds.splice(this._chartDesignBtnIds.indexOf(t),1)):this._chartDesignSptBtnIds.indexOf(t)>-1?(i="ejSplitButton",this._chartDesignSptBtnIds.splice(this._chartDesignSptBtnIds.indexOf(t),1)):this._chartDesignDdIds.indexOf(t)>-1&&(i="ejDropDownList",this._chartDesignDdIds.splice(this._chartDesignDdIds.indexOf(t),1))}this._disableButtons([t],i)}while((t==="PageLayout_PageLayout_PageSize"||t==="Home_Clipboard_Paste"||t==="Others_Cells_InsertCell"||t==="Others_Cells_DeleteCell"||t==="Data_DataTools_DataValidation")&&(t=t+"Options"))}},enableRibbonItems:function(n){for(var e=this.XLObj,i,u,t,r=0,f=n.length;r<f;r++){u=n[r].split("_")[2].toUpperCase();t=n[r].split("_Ribbon_")[1];do{switch(u){case"HOME":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._homeBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1?(i="ejSplitButton",this._homeSptBtnIds.push(t)):this.allToggleButtonIds.indexOf(t)>-1?(i="ejToggleButton",this._homeToggleBtnIds.push(t)):this.allDropDownIds.indexOf(t)>-1?(i="ejDropDownList",this._homeDdIds.push(t)):this.colorPickerIds.indexOf(t)>-1&&(i="ejColorPicker",this._homeCpIds.push(t));break;case"INSERT":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._insertBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1&&(i="ejSplitButton",this._insertSptBtnIds.push(t));break;case"DATA":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._dataBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1&&(i="ejSplitButton",this._dataSptBtnIds.push(t));break;case"PAGELAYOUT":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._pageLayBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1?(i="ejSplitButton",this._pageLaySptBtnIds.push(t)):this.checkBoxIds.indexOf(t)>-1&&(i="ejCheckBox",this._pageLayChckBxIds.push(t));break;case"REVIEW":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._cmntBtnIds.push(t)):this.allToggleButtonIds.indexOf(t)>-1&&n[r].split("_")[4]==="ShowAllComment"?(i="ejToggleButton",this._cmntTglBtnIds.push(t)):this.allToggleButtonIds.indexOf(t)>-1&&(i="ejToggleButton",this._reviewTglBtnIds.push(t));break;case"OTHERS":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._othersBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1&&(i="ejSplitButton",this._othersSptBtnIds.push(t));break;case"FORMAT":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._formatBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1&&(i="ejSplitButton",this._formatSptBtnIds.push(t));break;case"DESIGN":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._contextualBtnIds.push(t)):this.checkBoxIds.indexOf(t)>-1?(i="ejCheckBox",this._contextualCheckBoxIds.push(t)):this._contextualInputIds.indexOf(t)>-1&&(i=!0);break;case"CHARTDESIGN":this.allButtonIds.indexOf(t)>-1?(i="ejButton",this._chartDesignBtnIds.push(t)):this.allSplitButtonIds.indexOf(t)>-1?(i="ejSplitButton",this._chartDesignSptBtnIds.push(t)):this.allDropDownIds.indexOf(t)>-1&&(i="ejDropDownList",this._chartDesignDdIds.push(t))}this._enableButtons([t],i)}while((t==="PageLayout_PageLayout_PageSize"||t==="Home_Clipboard_Paste"||t==="Others_Cells_InsertCell"||t==="Others_Cells_DeleteCell"||t==="Data_DataTools_DataValidation")&&(t=t+"Options"))}},_refreshGoDlg:function(){var t=this.XLObj;if(t._isGoDlgChanged){t._isGoDlgChanged=!1;var i=t._dlgHeight>330?330:t._dlgHeight,r=129,u=i-194,f=n("#"+t._id+"Dialog_GoOkBtn").outerHeight(!0)+11;f>40&&(u-=7,r+=7);n("#"+t._id+"_GoDialog").ejDialog("option",{height:i});n("#"+t._id+"_GoDialog_wrapper").find(".e-dialog-scroller").height(i-36);n("#"+t._id+"_GotoAddr").ejListBox("option",{height:u.toString()});n("#"+t._id+"_GoToSp").height(i-r)}},_refreshValDlg:function(){var t=this.XLObj,o=n.extend(!0,[],this._actions),u=n("#"+t._id+"_Ribbon_ddAction").data("ejDropDownList"),f,s,i,e,r;t._isValDlgChanged&&(t._isValDlgChanged=!1,f=n("#"+t._id+"_val_freetext"),e=0,i=t._dlgHeight>440&&!t._phoneMode?440:t._dlgHeight<350||t._phoneMode?t._responsiveHeight-2:t._dlgHeight+40,s=t._dlgWidth>400?400:t._dlgWidth<330?t._responsiveWidth-2:t._dlgWidth,n("#"+t._id+"_ValDialog").ejDialog("option",{width:s,height:i}),n("#"+t._id+"_ValDialog_wrapper").find(".e-dialog-scroller").height(i-36),i>425?f.show():f.hide(),i<365?(o.splice(6,2),u.option({dataSource:o,selectedItemIndex:0})):u.model.dataSource.length<6&&u.option({dataSource:this._actions,selectedItemIndex:0}),r=n("#"+t._id+"Dialog_OkBtn").outerHeight(!0)+11,n("#"+t._id+"_ValDialog").height(i-50),r<40&&(r+=4),n("#"+t._id+"_Validation").height(i-(36+r+26+15)),t._phoneMode&&(e=3),n("#"+t._id+"_ValDialog_valDlgTab").find(".e-content").height(i-(46+r+26+15+e)),n("#"+t._id+"_ValDialog").find(".e-dlgctndiv:eq(0)").height(i-(46+r)));t._dlgHeight<350&&n("#"+t._id+"_ValDialog_wrapper").css("top","0px")},_refreshFRDlg:function(){var t=this.XLObj;t._isFRDlgChanged&&(t._isFRDlgChanged=!1,n("#"+t._id+"_FRDialog").ejDialog("option",{width:t._dlgWidth>500?500:t._dlgWidth}),t._responsiveHeight<365&&n("#"+t._id+"_FRDialog_wrapper").css("top","0px"));t._dlgWidth<365?(n("#"+t._id+"_Ribbon_lbFind").text("Find"),n("#"+t._id+"_Ribbon_lbReplace").text("Replace")):(n("#"+t._id+"_Ribbon_lbFind").text("Find What"),n("#"+t._id+"_Ribbon_lbReplace").text("Replace With"))},_refreshPasswordDlg:function(){var t=this.XLObj;t._isPasswordDlg&&(t._isPasswordDlg=!1,n("#"+t._id+"_PasswordDialog").ejDialog("option",{width:t._dlgWidth>420?420:t._dlgWidth}))},_refreshChartTypeDlg:function(){var t=this.XLObj,o,c;if(t._isChartDlgChanged){t._isChartDlgChanged=!1;var f,s=0,r=t._id+"_charttypedlg",h=n("#"+r+"_allcharttab"),e,i,u;i=t._dlgHeight>440&&!t._phoneMode?440:t._dlgHeight<380?t._responsiveHeight-2:t._dlgHeight;e=t._dlgWidth>617?510:t._dlgWidth<430?t._responsiveWidth-2:t._dlgWidth;u=n("#"+t._id+"_charttypedlg_okbtn").outerHeight(!0)+11;u<40&&(u+=4);dlgContHt=i-(46+u);f=dlgContHt-44;n("#"+t._id+"_allchart_table").height(t._phoneMode?f-30:f);this._createChartList(["Column-6","Bar-6","Radar-2","Line-2","Area-3","Pie-3","Scatter-1"],n("#"+t._id+"_allchart_table"));o=n("#"+t._id+"_chartdlg_allcharttab_content");c=n("#"+t._id+"_chartdlg_allcharttab_list_container");t._phoneMode?(o.css({height:"93%",width:"100%","margin-top":"10px","margin-left":"0px"}),n("#"+t._id+"_allchart_table").css("display",""),s=3):(t._browserDetails.name==="msie"?n("#"+t._id+"_allchart_table").css("display","-ms-flexbox"):n("#"+t._id+"_allchart_table").css("display","flex"),o.css({height:"100%",width:e-198+"px","margin-top":"0px","margin-left":"15px",float:"right"}),c.css("float","left"));h.height(dlgContHt);h.find(".e-content:eq(0)").height(dlgContHt-(41+s));n("#"+r).ejDialog("option",{height:i,width:e});n("#"+r+"_wrapper").find(".e-dialog-scroller").height(i-36);n("#"+r).height(i-50)}n("#"+t._id+"_charttypedlg").ejDialog("open");n("#"+t._id+"_chartdlg_allcharttab_list").ejListBox("refresh")},_refreshNMDlg:function(){var t=this.XLObj,u,r,i;t._isNMDlgChanged&&(i=t._dlgHeight>440&&!t._phoneMode?440:t._dlgHeight<380?t._responsiveHeight-2:t._dlgHeight,r=t._dlgWidth>510?510:t._dlgWidth<430?t._responsiveWidth-2:t._dlgWidth,t._isNMDlgChanged=!1,n("#"+t._id+"_nmgrid").ejGrid("destroy"),this._renderNMGrid(i,r),n("#"+t._id+"_nmdlg").ejDialog("option",{width:r,height:i}),n("#"+t._id+"_nmdlg_wrapper").find(".e-dialog-scroller").height(i-36),n("#"+t._id+"_nmdlg").height(i-52));n("#"+t._id+"_nmdlg").ejDialog("open");u=n("#"+t._id+"_nmgrid").data("ejGrid");u._refreshScroller({requestType:"refresh"})},_refreshFltrDlg:function(){var t=this.XLObj,i;t._isFltrDlgChanged&&(t._isFltrDlgChanged=!1,i=t._dlgHeight>400&&!t._phoneMode?400:t._responsiveHeight-2,n("#"+t._id+"_filter_custom").ejDialog("option",{height:i,width:t._dlgWidth-2}),n("#"+t._id+"_filter_custom_wrapper").find(".e-dialog-scroller").height(i-36),n("#"+t._id+"_filter_custom").height(i-50))},_menuCustomize:function(){var r=this.XLObj,f=r._id,u=r.model.ribbonSettings.applicationTab,i=u.menuSettings;u.type==="menu"?(i.isAppend?this._fileMenuData=this._fileMenuData.concat(i.dataSource):i.dataSource.length&&(this._fileMenuData=[{id:"File",text:r._getLocStr("File"),parentId:null},].concat(i.dataSource)),this._appTabCollection={type:t.Ribbon.ApplicationTabType.Menu,menuItemID:f+"_Menu",menuSettings:{click:n.proxy(this._onBackStageItemClick,this),openOnClick:!1,fields:{dataSource:this._fileMenuData,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"}}}):i.isAppend?(this._renderAppTab(),this._appTabCollection.backstageSettings.pages=this._appTabCollection.backstageSettings.pages.concat(i.dataSource)):i.dataSource.length?this._appTabCollection={type:t.Ribbon.applicationTabType.backstage,backstageSettings:{text:r._getLocStr("File"),headerWidth:124,height:r._responsiveHeight,width:r.model.scrollSettings.width,pages:i.dataSource}}:this._renderAppTab()},_refreshBackstageHeight:function(){var n=this.XLObj,i=n.element.find("#"+n._id+"_Ribbon").data("ejRibbon"),r=n._isAutoWHMode?n._responsiveHeight:n._responsiveHeight-2;i.model.applicationTab.type===t.Ribbon.ApplicationTabType.Backstage&&(i.setModel({applicationTab:{backstageSettings:{height:r,width:n._isAutoWHMode?n._responsiveWidth:n._responsiveWidth-2}}}),i.element.find(".e-responsivebackstagecontent .e-resbackstagecontent").css({height:r-(10+i.element.find(".e-backstagerestop").outerHeight())}))},hideMenu:function(){var t=this.XLObj;t.model.isReadOnly||(t.model.ribbonSettings.applicationTab.type==="menu"?n("#"+t._id+"_Menu").hide():t.element.find("#"+t._id+"_Ribbon").find(".e-backstagetab").hide())},showMenu:function(){var t=this.XLObj;t.model.isReadOnly||(t.model.ribbonSettings.applicationTab.type==="menu"?n("#"+t._id+"_Menu").show():t.element.find("#"+t._id+"_Ribbon").find(".e-backstagetab").show())},addTab:function(n,t,i){var r=this.XLObj;r.model.isReadOnly||r.element.find("#"+r._id+"_Ribbon").ejRibbon("addTab",n,t,i)},addTabGroup:function(n,t,i){var r=this.XLObj;r.model.isReadOnly||r.element.find("#"+r._id+"_Ribbon").ejRibbon("addTabGroup",n,t,i)},addContextualTabs:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+this.XLObj._id+"_Ribbon").ejRibbon("addContextualTabs",n,t)},removeTab:function(n,i){var r=this.XLObj,u;r.model.isReadOnly||(t.isNullOrUndefined(n)&&i?(u=r.element.find("#"+r._id+"_Ribbon .e-apptab"),u.length&&(u.find("a").empty(),u.find(".e-menu-wrap").remove(),u.hide(),r.element.find("#"+r._id+"_Ribbon_BackStage").remove())):r.element.find("#"+r._id+"_Ribbon").ejRibbon("removeTab",n))},removeTabGroup:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("removeTabGroup",n,t)},addBackStageItem:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("addBackStageItem",n,t)},removeBackStageItem:function(n){var t=this.XLObj;t.model.isReadOnly||t.element.find("#"+t._id+"_Ribbon").ejRibbon("removeBackStageItem",n)},updateBackStageItem:function(n,t){var i=this.XLObj;i.model.isReadOnly||i.element.find("#"+i._id+"_Ribbon").ejRibbon("updateBackStageItem",t,n)},removeMenuItem:function(t){var r=this.XLObj,i,u;r.model.isReadOnly||(i=n("#"+r._id+"_Menu"),u=i.data("ejMenu"),u.remove(["#"+i.find("li").eq(t).attr("id")]))},updateMenuItem:function(t,i){var f=this.XLObj,r,u;f.model.isReadOnly||(r=n("#"+f._id+"_Menu"),u=r.data("ejMenu"),u.insertBefore(t,"#"+r.find("li").eq(i).attr("id")),u.remove(["#"+r.find("li").eq(i+1).attr("id")]))},addMenuItem:function(t,i){var u=this.XLObj,r,f;u.model.isReadOnly||(r=n("#"+u._id+"_Menu"),f=r.data("ejMenu"),f.insertAfter(t,"#"+r.find("li").eq(i).attr("id")))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.freezepane=function(n){this.XLObj=n;this._hfreeze=null;this._vfreeze=null};t.spreadsheetFeatures.freezepane.prototype={_setHFreeze:function(n){this._hfreeze=n},_getHFreeze:function(){return this._hfreeze},_setVFreeze:function(n){this._vfreeze=n},_getVFreeze:function(){return this._vfreeze},_initFreeze:function(){var t,i,u="div",f="e-hide",r=this.XLObj,o=r.getSheet(),e=r.getMainPanel().find(".e-spreadsheet-list")[0];t=document.createElement(u);t.id=r._id+"_hfreeze";t.className="e-frow "+f;e.appendChild(t);this._setHFreeze(n(t));i=document.createElement(u);i.id=r._id+"_vfreeze";i.className="e-fcol "+f;e.appendChild(i);this._setVFreeze(n(i))},_refreshFreeze:function(){var u="px",r="e-hide",n=this.XLObj,i=n.getSheet(),t=this._getHFreeze()[0];t||this._initFreeze();n._isFrozen(n.getFrozenRows())?(n._removeClass(t,r),t.style.top=i._fDivTop,t.style.width=i._vPortWth+(i.showHeadings?n._rowHeaderWidth:0)-4+u):n.addClass(t,r);t=this._getVFreeze()[0];n._isFrozen(n.getFrozenColumns())?(n._removeClass(t,r),t.style.left=i._fDivLeft,t.style.height=i._vPortHgt+(i.showHeadings?n._colHeaderHeight:0)-4+u):n.addClass(t,r)},freezeTopRow:function(){var n=this.XLObj.getSheet();this.XLObj._isFrozen(n.frozenRows)&&this.unfreezePanes();this._freeze(n._topRow.idx+1)},freezeLeftColumn:function(){var n=this.XLObj.getSheet();this.XLObj._isFrozen(n.frozenColumns)&&this.unfreezePanes();this._freeze(null,n._leftCol.idx+1)},freezeRows:function(n){var t=this.XLObj.getSheet();this.XLObj._isFrozen(t.frozenRows)&&this.unfreezePanes();this._freeze(n)},freezeColumns:function(n){var t=this.XLObj.getSheet();this.XLObj._isFrozen(t.frozenColumns)&&this.unfreezePanes();this._freeze(null,n)},freezePanes:function(n,t){var i,r=this.XLObj;r.isNumber(n)||(i=r._toIntrnlRange(n),n=i[0],t=i[1]);this._freeze(n,t)},unfreezePanes:function(){this._freeze();this._refreshSelection()},_freeze:function(n,i){var h,o,c,r,f,e,s=crefresh=!0,u=this.XLObj;u.model.allowFreezing&&(h="px",c="e-hide",r=u.getSheet(),e=this._getHFreeze()[0],t.isNullOrUndefined(n)?(o=u.getFrozenRows()+1,u._isFrozen(o-1)?(n=0,this._showFreezeRow(o-1,r._ftopRowIdx-1),u.model.scrollSettings.allowVirtualScrolling&&u.refreshContent(),u.addClass(e,c),r._isFreezed=!1):s=!1):(f=u._getIdxWithOffset(n).yOffset,r._topRow.idx===n&&r._scrollTop!==f?u.XLScroll._vScroller().scroll(f):(n===0||n<r._topRow.idx||n>r._bottomRow.idx)&&(n=u._getMidCell().rowIdx),f=u._getRowOffsetBottom(n),u._removeClass(e,c),r._isFreezed=!0,e.style.top=r._fDivTop=f-r._scrollTop-(r.showHeadings?0:u._colHeaderHeight)+h,e.style.width=r._vPortWth+(r.showHeadings?u._rowHeaderWidth:0)-4+h,r._contScrollTop=r._scrollTop),s&&(r._ftopRowIdx=n,r._frozenHeight=u._getRowOffsetTop(r,n),r.paneTopLeftCell=u.getAlphaRange(n,r._fleftColIdx),u.setFrozenRows(n),r._frozenRows=n+1),e=this._getVFreeze()[0],t.isNullOrUndefined(i)?(o=u.getFrozenColumns()+1,u._isFrozen(o-1)?(i=0,this._showFreezeCol(o-1,r._fleftColIdx-1),u.addClass(e,c),r._isFreezed=!1):crefresh=!1):(f=u._getIdxWithOffset(null,i).xOffset,r._leftCol.idx===i&&r._scrollLeft!==f?u.XLScroll._hScroller().scroll(f):(i===0||i<r._leftCol.idx||i>r._rightCol.idx)&&(i=u._getMidCell().colIdx),f=u._getColOffsetLeft(r,i)+(r.showHeadings?u._rowHeaderWidth:0)-1,u._removeClass(e,c),r._isFreezed=!0,e.style.left=r._fDivLeft=f-r._scrollLeft+h,e.style.height=r._vPortHgt+(r.showHeadings?u._colHeaderHeight:0)-4+h,r._contScrollLeft=r._scrollLeft),crefresh&&(r._fleftColIdx=i,r._frozenWidth=u._getColOffsetLeft(r,i),r.paneTopLeftCell=u.getAlphaRange(r._ftopRowIdx,i),u.setFrozenColumns(i),r._frozenColumns=i+1),(s||crefresh)&&(u.XLScroll._refreshScroller(null,null,s&&crefresh?"all":s?"vertical":"horizontal"),s&&u.XLScroll._vScroller().scroll(u._isFrozen(u.getFrozenRows())?0:r._contScrollTop),crefresh&&u.XLScroll._hScroller().scroll(u._isFrozen(u.getFrozenColumns())?0:r._contScrollLeft)))},_frozenScrollHandler:function(n){var o,f,h=0,r=this.XLObj,u=r.XLScroll,i=r.getSheet(),e=r.getActiveSheetIndex(),s=u._vScroller(e),c=u._hScroller(e);if(n.model.orientation===t.ScrollBar.Orientation.Vertical){if(n.reachedEnd=Math.ceil(parseFloat(s.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(s.element.find(".e-vhandle").height()))>=s.element.find(".e-vhandlespace").height()-2,n.reachedEnd&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite){if(o=(n.scrollTop-i._scrollTop)/i.rowHeight,i._bottomRow.idx+o>=i.rowCount-1)if(r.model.scrollSettings.allowVirtualScrolling)for(i._virtualBlockCnt++,i.rowCount+=i._virtualBlockRowCnt;h<i._virtualBlockRowCnt;)i.rowsHeightCollection.push(i.rowHeight),h++;else r.XLScroll._scrollBottom(e);r.XLScroll._refreshScroller(e,"refresh","vertical")}u._isIntrnlScroll?(this._scrollFreeze(u._scrollIdx),u._scrollIdx=0,i._scrollTop=n.scrollTop):n.scrollTop==i._scrollTop||n.reachedEnd&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(f=this._ensureFreezeScrollPos(n),r.isUndefined(f.resetTo)?(this._scrollFreeze(f.rowIdx),i._scrollTop=n.scrollTop):(u._isIntrnlScroll=!0,u._scrollIdx=f.rowIdx,u._vScroller().scroll(f.resetTo),u._isIntrnlScroll=!1))}else n.reachedEnd=Math.ceil(parseFloat(c.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(c.element.find(".e-hhandle").width()))>=r.element.find(".e-hhandlespace").width()-2,o=(n.scrollLeft-i._scrollLeft)/i.columnWidth,n.reachedEnd&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&i._rightCol.idx+o>=i.colCount-1&&(r.XLScroll._scrollRight(e),r.XLScroll._refreshScroller(e,"refresh","horizontal")),u._isIntrnlScroll?(this._scrollFreeze(null,u._scrollIdx),u._scrollIdx=0,i._scrollLeft=n.scrollLeft):n.scrollLeft==i._scrollLeft||n.reachedEnd&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(f=this._ensureFreezeScrollPos(n),r.isUndefined(f.resetTo)?(this._scrollFreeze(null,f.colIdx),i._scrollLeft=n.scrollLeft):(u._isIntrnlScroll=!0,u._scrollIdx=f.colIdx,u._hScroller().scroll(f.resetTo),u._isIntrnlScroll=!1));r.model.allowComments&&r.XLComment._updateCmntArrowPos()},_ensureFreezeScrollPos:function(n){var i,r={},e=[t.Spreadsheet.HideTypes.Freeze],f=this.XLObj,u=f.getSheet();return n.model.orientation===t.ScrollBar.Orientation.Vertical?(i=n.scrollTop+u._frozenHeight,retVal=f._getIdxWithOffset(i,null,!0,e),r.rowIdx=retVal.rowIdx,i!==retVal.yOffset&&(r.resetTo=retVal.yOffset-u._frozenHeight)):(i=n.scrollLeft+u._frozenWidth,retVal=f._getIdxWithOffset(null,i,!0,e),r.colIdx=retVal.colIdx,i!==retVal.xOffset&&(r.resetTo=retVal.xOffset-u._frozenWidth)),r},_scrollFreeze:function(n,t){var r,u=this.XLObj,i=u.getSheet();n&&i._ftopRowIdx!==n?(i._ftopRowIdx<n?(r=n-i._ftopRowIdx==1?i._ftopRowIdx:n-1,this._hideFreezeRow(i._ftopRowIdx,r),this._refreshShape(i._ftopRowIdx,r,!0)):(r=i._ftopRowIdx-n==1?n:i._ftopRowIdx-1,this._showFreezeRow(n,r),this._refreshShape(n,r,!0)),u.model.scrollSettings.allowVirtualScrolling&&u.refreshContent(),i._ftopRowIdx=n,i.paneTopLeftCell=u.getAlphaRange(n,i._fleftColIdx)):t&&i._fleftColIdx!==t&&(i._fleftColIdx<t?(r=t-i._fleftColIdx==1?i._fleftColIdx:t-1,this._hideFreezeCol(i._fleftColIdx,r),this._refreshShape(i._fleftColIdx,r)):(r=i._fleftColIdx-t==1?t:i._fleftColIdx-1,this._showFreezeCol(t,r),this._refreshShape(t,r)),i._fleftColIdx=t,i.paneTopLeftCell=u.getAlphaRange(i._ftopRowIdx,t));this._refreshSelection()},_refreshShape:function(t,i,r){var o=this.XLObj,w=o.getActiveSheetIndex(),u=o.getSheet(w),v=u.shapeMngr,s,l,f,e,h,y,c,a,p;for(p=r?[t,u._fleftColIdx,i,u.colCount]:[u._ftopRowIdx,t,u.rowCount,i],c=o.getRangeData({range:p,property:["picture"]}),f=0;f<c.length;f++)a=o.getObjectLength(c[f]),a>0&&(h=r?v.picture[c[f].picture[a-1]].rowIndex:v.picture[c[f].picture[a-1]].colIndex,y=n("#"+c[f].picture[a-1])[0],this._freezeShape(y,r?u._hiddenFreezeRows.indexOf(h)>-1:u._hiddenFreezeCols.indexOf(h)>-1));for(s=o.getRangeData({range:p,property:["chart"]}),e=0;e<s.length;e++)l=o.getObjectLength(s[e]),l>0&&(h=r?v.chart[s[e].chart[l-1]].rowIndex:v.chart[s[e].chart[l-1]].colIndex,y=n("#"+s[e].chart[l-1])[0],this._freezeShape(y,r?u._hiddenFreezeRows.indexOf(h)>-1:u._hiddenFreezeCols.indexOf(h)>-1))},_freezeShape:function(n,t){var i=this.XLObj;t?i.addClass(n,"e-hide"):i._removeClass(n,"e-hide")},_hideFreezeRow:function(n,t){for(var i=this.XLObj,u=i.model.scrollSettings,o=u.allowScrolling&&u.allowVirtualScrolling,r=i.getActiveSheetIndex(),f=i.getRows(r),s=f[0],h=f[1],e=i.getSheet(r);n<=t;)e._hiddenFreezeRows.indexOf(n)===-1&&e._hiddenFreezeRows.push(n),!o&&i._isRowViewable(r,n)&&(i.addClass(h[n],"e-r-hide"),i.addClass(s[n],"e-r-hide")),n++},_showFreezeRow:function(n,t){for(var r,i=this.XLObj,u=i.model.scrollSettings,s=u.allowScrolling&&u.allowVirtualScrolling,f=i.getActiveSheetIndex(),e=i.getRows(f),h=e[0],c=e[1],o=i.getSheet();n<=t;)r=o._hiddenFreezeRows.indexOf(n),i.model.allowFiltering&&(isFHide=this._refreshFiltering(n)),r>-1&&(o._hiddenFreezeRows.splice(r,1),s||!i._isRowViewable(f,n)||isFHide||(i._removeClass(c[n],"e-r-hide"),i._removeClass(h[n],"e-r-hide"))),n++},_refreshFiltering:function(n){var i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet();return t.isNullOrUndefined(i.XLEdit.getPropertyValue(n,0,"isFilterHide",u))?!1:(r._filterHRowsColl.indexOf(n)===-1&&r._filterHRowsColl.push(n),!0)},_hideFreezeCol:function(n,t){for(var o,f="e-fcol-hide",i=n,r=this.XLObj,c=r.getActiveSheetIndex(),e=r.getSheet(),s=r.model.scrollSettings.allowVirtualScrolling?e._virtualRowIdx:e._rowIdxColl,h=r._getJSSheetHeader(c),l=r._getContent(c),v=h.find("th"),y=h.find("col"),p=l.find("col"),a=h.find("table"),u=r._getWidth(n,t);i<=t;)e._hiddenFreezeCols.indexOf(i)===-1&&e._hiddenFreezeCols.push(i),r.addClass(v[i],f),r.addClass(y[i],f),r.addClass(p[i],f),i++;if(o=r.getRange([s[0],n,s[s.length-1],t]),i=o.length,i)while(i--)r.addClass(o[i],f);u=a.width()-u;a.width(u);l.find("table").width(u)},_getWidth:function(n,t){for(var i=0,r=this.XLObj.getSheet();n<=t;n++)i+=r.columnsWidthCollection[n];return i},_showFreezeCol:function(n,t){for(var e,f="e-fcol-hide",r=n,i=this.XLObj,c=i.getActiveSheetIndex(),u=i.getSheet(),s=i._getJSSheetHeader(c),l=i._getContent(c),a=s.find("th"),h=i.model.scrollSettings.allowVirtualScrolling?u._virtualRowIdx:u._rowIdxColl,v=s.find("col"),y=l.find("col"),p=s.find("table"),o=i._getWidth(0,u.colCount-1)-(u._frozenColumns-1<n?i._getWidth(u._frozenColumns-1,n):0);r<=t;)e=u._hiddenFreezeCols.indexOf(r),e>-1&&(u._hiddenFreezeCols.splice(e,1),i._removeClass(a[r],f),i._removeClass(v[r],f),i._removeClass(y[r],f)),r++;if(cells=i.getRange([h[0],n,h[h.length-1],t]),r=cells.length,r)while(r--)i._removeClass(cells[r],f);p.width(o);l.find("table").width(o)},_refreshSelection:function(){var i,f,r,e,o=!1,u=this.XLObj,n=u.getSheet(),t=n.selectedRange,s=t[2],h=t[3],c=t[0],l=t[1];if(n._endCell.rowIndex+1>=n._frozenRows&&n._endCell.rowIndex<n._ftopRowIdx&&n._startCell.rowIndex<n._frozenRows-1)s=n._frozenRows-2,o=!0;else if(i=t[0],f=t[2],n._frozenRows-1<=i)while(i<=f)if(i<n._ftopRowIdx)i++;else{c=i;break}if(t[3]+1>=n._frozenColumns&&t[3]<n._fleftColIdx&&t[1]<n._frozenColumns-1)h=n._frozenColumns-2,o=!0;else if(r=t[1],e=t[3],n._frozenColumns-1<=r)while(r<=e)if(r<n._fleftColIdx)r++;else{l=r;break}i==f+1||r==e+1?u.XLSelection._hideShowSelElem("hide"):(u.XLSelection._refreshBorder([c,l,s,h]),o?u.addClass(u.getAutoFillElem()[0],"e-hide"):u.XLDragFill.positionAutoFillElement())},_selectionScroll:function(){var i,r,u,f=hiddenWth=0,t=this.XLObj,n=t.getSheet(),e=t.getActiveSheetIndex();if(t._isFrozen(n.frozenRows))if(n._startCell.rowIndex+1<n._frozenRows&&n._endCell.rowIndex+1>n._frozenRows&&n.selectedRange[2]<n._ftopRowIdx){if(n._ftopRowIdx+1-n._frozenRows>0){for(r=n._endCell.rowIndex-n._ftopRowIdx,n._endCell.rowIndex=n._frozenRows-1+r,i=n._frozenRows-1;i<n._ftopRowIdx;i++)f+=n.rowsHeightCollection[i];t._scrollContent({y:-f})}}else n.selectedRange[2]-n._endCell.rowIndex>0&&n._ftopRowIdx>n._frozenRows-1&&!n._isColSelected&&n._endCell.rowIndex<n._frozenRows-1&&n.selectedRange[2]-n.selectedRange[0]>0&&n.selectedRange[2]>=n._ftopRowIdx-1&&(n._endCell.rowIndex=n._ftopRowIdx-1,u=t.getCell(n._frozenRows-2,n._endCell.colIndex)[0],t.XLSelection._scrollCalculation(e,u,{position:"vertical",action:"Decrement"}));if(t._isFrozen(n.frozenColumns))if(n._startCell.colIndex+1<n._frozenColumns&&n._endCell.colIndex+1>n._frozenColumns&&n.selectedRange[3]<n._fleftColIdx){if(n._fleftColIdx+1-n._frozenColumns>0){for(r=n._endCell.colIndex-n._fleftColIdx,n._endCell.colIndex=n._frozenColumns-1+r,i=n._frozenColumns-1;i<n._fleftColIdx;i++)hiddenWth+=n.columnsWidthCollection[i];t._scrollContent({x:-hiddenWth})}}else n.selectedRange[3]-n._endCell.colIndex>0&&n._fleftColIdx>n._frozenColumns-1&&!n._isRowSelected&&n._endCell.colIndex<n._frozenColumns-1&&n.selectedRange[3]-n.selectedRange[1]>0&&n.selectedRange[3]>=n._fleftColIdx-1&&(n._endCell.colIndex=n._fleftColIdx-1,u=t.getCell(n._frozenColumns-2,n._endCell.colIndex)[0],t.XLSelection._scrollCalculation(e,u,{position:"horizontal",action:"Decrement"}))},_refreshFColResize:function(n){var u,f="px",i=this.XLObj,s=i.getActiveSheetIndex(),t=i.getSheet(),e=i.getFrozenColumns()+1,h=this._getVFreeze()[0],r=t._frozenWidth,o=parseInt(this._getVFreeze()[0].style.left);i.XLScroll._getColWidths(s,n);t._frozenWidth=i._getColOffsetLeft(t,e-1);u=r>t._frozenWidth?r-t._frozenWidth:t._frozenWidth-r;n<e-1&&(h.style.left=t._fDivLeft=r>=t._frozenWidth?o-u+f:o+u+f)},_refreshFRowResize:function(n){var u,f="px",i=this.XLObj,s=i.getActiveSheetIndex(),t=i.getSheet(),e=i.getFrozenRows()+1,h=this._getHFreeze()[0],r=t._frozenHeight,o=parseInt(this._getHFreeze()[0].style.top);i.XLScroll._getRowHeights(s,n);t._frozenHeight=i._getRowOffsetTop(t,e-1);u=r>t._frozenHeight?r-t._frozenHeight:t._frozenHeight-r;n<e-1&&(h.style.top=t._fDivTop=r>=t._frozenHeight?o-u+f:o+u+f)},_refreshFreezeRowDiv:function(){var n=this.XLObj;sheet=n.getSheet();sheet._fDivTop=n._getRowOffsetBottom(sheet._frozenRows-1)-sheet._contScrollTop-(sheet.showHeadings?0:n._colHeaderHeight)+"px";sheet._frozenHeight=n._getRowOffsetTop(sheet,sheet._frozenRows-1);this._refreshFreeze()},_refreshFreezeColDiv:function(){var n=this.XLObj;sheet=n.getSheet();sheet._fDivLeft=n._getColOffsetLeft(sheet,sheet._frozenColumns-1)-sheet._contScrollLeft+(sheet.showHeadings?n._rowHeaderWidth:0)-1+"px";sheet._frozenWidth=n._getColOffsetLeft(sheet,sheet._frozenColumns-1);this._refreshFreeze()}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.math={toFraction:function(n){if(this.isNumber(n)){var r=n.toString(),e=r.split(".")[0],t=r.split(".")[1];if(!t)return{integer:n};var i=(+t).toString(),u=this.getPlaceValue(t,i),f=this.getGcd(i,u);return{integer:e,numerator:Number(i)/f,denominator:Number(u)/f}}return null},toExponential:function(n,t){if(this.isNumber(n)){var i,r=Number(n);return t=t||2,t>20&&(t=20),i=r.toExponential(t).split("e+"),i[0]+"E+"+this.padZeros(i[1])}return null},toAccounting:function(i,r,u){if(this.isNumber(r)&&i){var e,o,s=t.widgetBase.formatting(i,r,u),f=this._currencySymbol,h=n.trim(s.replace(f,"")),c=s.indexOf(f);!c||r<0&&c===1?(e=f,o=Number(r)?h:"-"):(e=Number(r)?h:"-",o=f);r=e+"   "+o}return r},intToDate:function(n){return new Date((Number(n)-2)*864e5+new Date("01/01/1900").getTime())},getGcd:function(n,t){return(n=Number(n),t=Number(t),!t)?n:this.getGcd(t,n%t)},isNumber:function(n){return n-parseFloat(n)>=0},isTime:function(n){return n?n.toString().indexOf(":")!==-1:!1},isFormula:function(n){var t,i;return n&&!n.toString().indexOf("=")&&n.length>1?(t=n.split("(").length-1,i=n.split(")").length-1,t===i):!1},getPlaceValue:function(n,t){var i=n.indexOf(t)+t.length;return"1"+Array(i+1).join("0")},padZeros:function(n,i,r){return this.isNumber(n)?(i=this.isNumber(i)?i:2,r=t.isNullOrUndefined(t.Spreadsheet.autoFillDirection[r])?t.Spreadsheet.autoFillDirection.Left:t.Spreadsheet.autoFillDirection[r],r===t.Spreadsheet.autoFillDirection.Left?n<=this.maxValue(i)?Array(i-this.getDigits(n)+1).join("0")+n.toString():n.toString():n<this.minValue(i)?n.toString()+Array(i-this.getDigits(n)+1).join("0"):n.toString()):null},maxValue:function(n){return this.isNumber(n)?Number(Array(n+1).join("9")):null},minValue:function(n){return this.isNumber(n)?Number("1"+Array(n).join("0")):null},getDigits:function(n){return this.isNumber(n)?n.toString().length:null},_round:function(n,t){return Number(Math.round(n+"e"+t)+"e-"+t)},_parseTime:function(n){var u,t,i=0,r=3,f={},e;if(this.isTime(n))for(n=n.toString(),t=n.split(" "),u=t.length;i<u;){if(this.isTime(t[i]))for(e=t[i].split(":");r<6;)f[this._datePattern[r]]=e[r-3]||"0",r++;i++}return f},_dateToInt:function(n,t){var r=new Date("01/01/1900"),u=this._isDateTime(n)?n:new Date(n),f=u.getTime()-r.getTime(),i=f/864e5+2;return t?i%1:i},_defTimeFormat:function(n){return[n.getHours(),n.getMinutes(),n.getSeconds()].join(":")},_isDate:function(n){var i={};return t.isNullOrUndefined(t.parseDate(n.toString()))||(n=this._dateToInt(n.toString())),/^((0?[1-9]|1[012])[-.](0?[1-9]|[12][0-9]|3[01])[-.](19|20)?[0-9]{2})*$/.test(n.toString())?(n=n.toString().replace("-","/","g"),n=this._dateToInt(n.toString()),i.text=n,i.isDate=!0):(i.text=n,i.isDate=!1),i},_defDateFormat:function(n){return[n.getMonth()+1,n.getDate(),n.getFullYear()].join("/")},_isCellReference:function(n){return/^[a-z]{1,3}\d{1,7}$/gi.test(n)?"relative":/^\$[a-z]{1,3}\$\d{1,7}$/gi.test(n)?"absolute":/^((\$[a-z]{1,3})\d{1,7}|[a-z]{1,3}(\$\d{1,7}))$/gi.test(n)?"mixed":!1},_isDateTime:function(n){return Object.prototype.toString.call(n)==="[object Date]"&&!isNaN(n.valueOf())},_decimalCnt:function(n){var t;return this.isNumber(n)&&(n=Number(n),t=n.toString(),t.indexOf(this._decimalSeparator)>-1)?(fixVal=n.toFixed(),t.length-fixVal.length-1):0},_getPosDiff:function(n,t){return n>t?n-t:t-n}}}(jQuery,Syncfusion),function(n,t,r){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.resizing=function(t){this.XLObj=t;this._$visualElem=n();this._currentHCell=-1;this._colMinWidth=15;this._rowMinHeight=20;this._allowStart=!1;this._resizeStart=!1;this._resizeType="";this._tableY=null;this._oldWidth=null;this._orgX=null;this._orgY=null;this._extra=null;this._initialTableWidth=null;this._resizeElt=null;this._tableX=null;this._oldHeight=null;this._initialTableHeight=null;this._resizerowId=0};t.spreadsheetFeatures.resizing.prototype={getColWidth:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).columnsWidthCollection[n]},getRowHeight:function(n){return this.XLObj.getSheet(this.XLObj.getActiveSheetIndex()).rowsHeightCollection[n]},setColWidth:function(n,t){if(this.XLObj.model.allowResizing){var i=this.XLObj.getActiveSheetIndex();this._currentHCell=n;this._resizeColumnUsingDiff(t,this.XLObj.getSheet(i).columnsWidthCollection[n],[n]);this.XLObj.XLScroll._getColWidths(i,n)}},setRowHeight:function(n,t){var i=this.XLObj,r;this.XLObj.model.allowResizing&&(r=this.XLObj.getActiveSheetIndex(),this._currentHCell=n,this._resizeRowUsingDiff(t,this.XLObj.getSheet(r).rowsHeightCollection[n],[n]),i.model.allowSelection&&i.XLSelection._refreshBorder())},_headerMouseDown:function(n){n.preventDefault();this._colMouseDown(n)},_colMouseDown:function(t){var u,e,f,r=this.XLObj,i={};if(r._isTouchEvt&&this._mouseHover(t),this._allowStart&&(n(t.target).css("cursor")==="col-resize"||r._isTouchEvt)){if(f=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1),e=f[1],u=f[0],u+=document.documentElement.scrollLeft,i.event=t,i.target=t.target,i.colIndex=this._currentHCell,i.oldWidth=t.target.getBoundingClientRect().width,i.reqType="column-resize",r._trigger("resizeStart",i))return;t.button!==2&&this._start(u,e);this._resizeType="Col";t.preventDefault()}},_mouseHover:function(t){var s,i=this.XLObj,r=t.target,c=i.getActiveSheetIndex(),o=i._getJSSheetHeader(c);if(!this._$visualElem.is(":visible")&&(i._hasClass(r,"e-headercelldiv")&&(r=r.parentNode),i._hasClass(r,"e-headercell"))){var e=r,u=e.getBoundingClientRect(),h=i._setXY(t),f=h[0],l=h[1];if(s=n(o.find(".e-table")[0]).width()+n(o.find(".e-columnheader")[0]).offset().left,(f>=u.left+document.documentElement.scrollLeft+e.offsetWidth-(i._isTouchEvt?15:5)||f<=u.left+(i._isTouchEvt?13:3))&&f<s&&f>=u.left&&l<=u.top+document.documentElement.scrollTop+r.offsetHeight){if(this._currentHCell=o.find(".e-headercell").index(e),this._currentHCell<1&&f<u.left+e.offsetWidth-(i._isTouchEvt?15:5)||this._preventColResize(this._currentHCell,!1))return;i.addClass(r,"e-ss-colresize");this._allowStart=!0}else i._removeClass(n(".e-ss-colresize")[0],"e-ss-colresize"),this._allowStart=!1,this._currentHCell=-1}},_preventColResize:function(n,t){this._currentHCell=n;var r=this.XLObj,c=r.getActiveSheetIndex(),u=[],s=r.getSheet(c).pivotMngr.pivot,u=r.getObjectKeys(s),f,o,h,e,i,l=u.length;if(u.length)for(i=0;i<l;i++)return f=s[u[i]].colIndex,h=r.element.find("#"+u[i]).data("ejPivotGrid"),e=h.calculateCellWidths().columnWidths.length,e||(e=3),o=f+e,t?this._currentHCell>=f&&this._currentHCell<o:this._currentHCell>=f&&this._currentHCell<=o},_start:function(i,r){var u=this.XLObj,e,o=u.getActiveSheetIndex(),s=u._getJSSheetHeader(o),l=s.find(".e-columnheader"),h=l.find(".e-headercell"),f,c;(this._currentHCell>-1&&this._currentHCell<h.length&&(f=h[this._currentHCell]),t.isNullOrUndefined(f))||(c=f.getBoundingClientRect(),this._tableY=c.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop),this._allowStart?(this._$visualElem=n(document.createElement("div")),e=u._getJSSheetContent(o).height()+s.height(),this._$visualElem.addClass("e-reSizeColbg").appendTo(u.element).css({height:e+"px"}).addClass("e-ss-colresize"),this._$visualElem.css({left:i-1,top:this._tableY}),this._oldWidth=f.offsetWidth,this._orgX=i,this._orgY=r,this._extra=i-this._orgX,this._resizeStart=!0):this._currentHCell=-1)},_cMouseMove:function(n){if(this._resizeStart){var t=this.XLObj._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._moveVisual(t);this.XLObj.addClass(n.target,"e-ss-colresize")}else this._mouseHover(n)},_reSize:function(t){var f,i=this.XLObj,s,r=i.getActiveSheetIndex(),e,l=i._getJSSheetHeader(r),h=l.find(".e-colselected"),c=h.length,u,o=[];if(this._initialTableWidth=i._getJSSheetHeader(r).find(".e-headercontent").width(),this._getResizableCell(),this._currentHCell>-1&&this._resizeStart){for(f=i.getSheet(r).columnsWidthCollection[this._currentHCell],c>0&&(u=h[0].cellIndex),e=0;e<c;e++)this._currentHCell===u&&(s=!0),o.push(u),u++;s||(o=[this._currentHCell]);this._resizeColumnUsingDiff(t-this._orgX+f,f,o);i._isAutoWHMode&&i._autoSSWidthHeight();i.model.allowAutoFill&&(i.XLDragFill.positionAutoFillElement(),i.XLDragFill.hideAutoFillOptions());n("#"+i._id+"ddlspan").length&&i._ddlPosition()}i.XLScroll._getRowHeights(r,this._currentHCell);i.model.allowFreezing&&i.XLFreeze._refreshFColResize(this._currentHCell);i.model.allowSelection&&i.XLSelection._refreshBorder();this._removeVisualElem()},_resizeColumnUsingDiff:function(t,i,r){var h,f,c,l,a,v,y,p,u=this.XLObj,w={},o=u.getActiveSheetIndex(),b=u._getJSSheetHeader(o),e,k,d,s,g;if(t>0){for(t=t>this._colMinWidth?t:this._colMinWidth,e=0,k=r.length;e<k;e++)if(!u.XLEdit.getPropertyValue(0,r[e],"wrapCol")||!(u.XLEdit.getPropertyValue(0,r[e],"wrapWidth")>t))if(y=b.find("col:eq("+r[e]+")"),p=u._getJSSheetContent(o).find(".e-spreadsheetcontentcontainer").find("col:eq("+r[e]+")"),y.outerWidth(t),p.width(t),u.getSheet(o).columnsWidthCollection[r[e]]=t,t<i)for(a=u._getContent(o).find(".e-rowcell:nth-child("+(r[e]+1)+")"),s=0,d=a.length;s<d;s++)f=u._getCellIdx(a[s]),c=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),c&&(u._refreshGlobalSpan(),h=n("#"+u._id+"_emptySpan"),u.addClass(h[0],"e-rowcell"),h.text(c),l=h.outerWidth(),u._refreshGlobalSpan(),t<l&&(u._textClip(f.rowIndex,f.colIndex,"delete"),u._textClip(f.rowIndex,f.colIndex,"add",l)));else for(v=u._getContent(o).find(".e-rowcell.e-ofbrdr:nth-child("+(r[e]+1)+")"),s=0,g=v.length;s<g;s++)f=u._getCellIdx(v[s]),u._textClip(f.rowIndex,f.colIndex,"delete","",!0),u._textClip(f.rowIndex,f.colIndex,"add","",!0);b.find(".e-columnheader").css("cursor","default");u._dupDetails||(w={sheetIndex:o,cols:r,newWidth:t,oldWidth:i,reqType:"resize-column"},i!==t&&u._completeAction(w));u.XLScroll._getColWidths(o,r[0]);u.model.scrollSettings.allowScrolling&&(u.XLScroll._refreshScroller(o,"refresh","all"),u.XLScroll._getFirstColumn(o))}},_calculateWidth:function(){for(var t=this.XLObj,i=t._getJSSheetHeader(t.getActiveSheetIndex()).find("col"),r=0,n=0;n<i.length;n++)r+=i.eq(n).width();return r},_cMouseUp:function(n){if(this._resizeStart){var r,i=this.XLObj,u=this._currentHCell,f=i.getSheet(i.getActiveSheetIndex()).columnsWidthCollection,t={};if(r=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0],r+=document.documentElement.scrollLeft,t.event=n,t.target=n.target,t.oldWidth=f[u],t.colIndex=this._currentHCell,this._reSize(r),t.newWidth=f[u],t.reqType="column-resize",this.XLObj._trigger("resizeEnd",t))return;i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup")}},_getResizableCell:function(n){for(var i=this.XLObj,r=i.getActiveSheetIndex(),o=i._getJSSheetHeader(r).find(".e-columnheader"),u=o.find(".e-headercell"),s=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft,f,e,t=0,h=u.length;t<h;t++)if(e=u[t].getBoundingClientRect(),f=e.left+s+5,f>this._orgX){i.isUndefined(n)?this._currentHCell=t-1:n.target=i._getJSSheetHeader(r).find("th:eq("+(t-1)+")")[0];return}},_moveVisual:function(n){var i=this.XLObj,t=i._getJSSheetHeader(i.getActiveSheetIndex()).find(".e-headercontent")[0].getBoundingClientRect();t.left+document.documentElement.scrollLeft+t.width<n||n<t.left+document.documentElement.scrollLeft?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({left:n-1,top:this._tableY})},_rowMouseDown:function(t){var f,r,u,i={},e=this.XLObj;if(e._isTouchEvt&&this._rowMouseHover(t),this._allowStart&&n(t.target).css("cursor")==="row-resize"){if(u=e._setXY(t,navigator.userAgent.indexOf("WebKit")>-1),f=u[0],r=u[1],r+=document.documentElement.scrollTop,i.event=t,i.target=t.target,i.rowIndex=this._currentHCell,i.oldHeight=t.target.getBoundingClientRect().height,i.reqType="row-resize",this.XLObj._trigger("resizeStart",i))return;t.button!==2&&this._rowStart(f,r);this._resizeType="Row";t.preventDefault()}return!1},_rowMouseHover:function(t){var r;if(!this._$visualElem.is(":visible")&&(r=n(t.target),r.hasClass("e-rowheader"))){var i=this.XLObj,o=i.getActiveSheetIndex(),h=i._getJSSheetRowHeaderContent(o),e=r.get(0),u=e.getBoundingClientRect(),s=i._setXY(t),c=s[0],f=s[1],l=i._getJSSheetRowHeader(o).find(".e-table").height()+h.find("tbody").offset().top;if((f>=u.top+document.documentElement.scrollTop+e.offsetHeight-(i._isTouchEvt?8:5)||f<=u.top+(i._isTouchEvt?8:3))&&f<l&&f>=u.top&&c<=u.left+document.documentElement.scrollLeft+t.target.offsetWidth){if(this._resizeElt=r.parent(),this._currentHCell=i.model.scrollSettings.allowVirtualScrolling?parseInt(this._resizeElt.attr("idx")):this._resizeElt[0].rowIndex,this._currentHCell<1&&f<u.top+e.offsetHeight-(i._isTouchEvt?8:5)||this._preventRowResize(this._currentHCell,!1))return;r.addClass("e-ss-rowresize");this._allowStart=!0}else n(".e-ss-rowresize").removeClass("e-ss-rowresize"),this._allowStart=!1,this._currentHCell=-1;this._resizerowId=t.target.parentNode.getAttribute("idx")}},_preventRowResize:function(n,t){this._currentHCell=n;var r=this.XLObj,c=r.getActiveSheetIndex(),u=[],s=r.getSheet(c).pivotMngr.pivot,u=r.getObjectKeys(s),f,o,h,e,i,l=u.length;if(u.length)for(i=0;i<l;i++)return f=s[u[i]].rowIndex,h=r.element.find("#"+u[i]).data("ejPivotGrid"),e=h._rowCount,e||(e=4),o=f+e,t?this._currentHCell>=f&&this._currentHCell<o:this._currentHCell>=f-1&&this._currentHCell<=o},_rowStart:function(t,i){var r=this.XLObj,f=r.getActiveSheetIndex(),e=this._resizeElt[0].rowIndex,o=r._getJSSheetRowHeader(f).find(".e-rowheader"),u,s,h;(this._currentHCell>-1&&e<o.length&&(u=o[e]),u)&&(s=u.getBoundingClientRect(),this._tableX=s.left+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollLeft:document.documentElement.scrollLeft),this._allowStart?(this._$visualElem=n(document.createElement("div")),h=r._getJSSheetContent(f).width(),this._$visualElem.addClass("e-reSizeRowbg").appendTo(r.element).css({width:h+"px"}).addClass("e-ss-rowresize"),this._$visualElem.css({top:i-3,left:this._tableX}),this._oldHeight=u.offsetHeight,this._orgX=t,this._orgY=i,this._extra=i-this._orgY,this._resizeStart=!0):this._currentHCell=-1)},_rMouseMove:function(t){if(this._resizeStart){var i=this.XLObj._setXY(t,navigator.userAgent.indexOf("WebKit")>-1)[1];i+=document.documentElement.scrollTop;t.preventDefault();n(t.target).addClass("e-ss-rowresize");this._moveRowVisual(i)}else this._rowMouseHover(t)},_rowResize:function(t,i){var u,r=this.XLObj,f=r.getActiveSheetIndex(),p=r.getRows(f)[1],s=!1,h,w=r._getJSSheetRowHeaderContent(f),l=w.find(".e-rowselected"),a=l.length,e,v,c=[],y=0,o;if(this._initialTableHeight=r._getJSSheetRowHeader(f).find(".e-rowheadercontent").height(),this._getResizableRowCell(),s=n(p[this._currentHCell]).find(".e-sswraptext").length>0,this._currentHCell>-1&&this._resizeStart){for(o=0;o<=this._resizerowId;o++)r.XLEdit.getPropertyValue(o,0,"isRHide")&&y++;if(u=r.getSheet(f).rowsHeightCollection[this._currentHCell+y],!s||s&&i-this._orgY+u>u){for(a>0&&(e=l[0].parentNode.rowIndex),h=0;h<a;h++)this._currentHCell===e&&(v=!0),c.push(e),e++;v||(c=[this._currentHCell]);this._resizeRowUsingDiff(i-this._orgY+u,u,c)}r.model.allowAutoFill&&(r.XLDragFill.positionAutoFillElement(),r.XLDragFill.hideAutoFillOptions());r._isAutoWHMode&&r.model.showRibbon&&r._autoSSWidthHeight(f,!0)}r.model.allowSelection&&r.XLSelection._refreshBorder();this._removeVisualElem()},_resizeRowUsingDiff:function(n,t,r){var u=this.XLObj,f=u.getActiveSheetIndex(),c={},o=u._getJSSheetRowHeaderContent(f),l,a,v,e,s,h;if(n>0){for(n=n>this._rowMinHeight?n:this._rowMinHeight,i=0,l=r.length;i<l;i++)e=r[i],s=u.model.scrollSettings.allowVirtualScrolling?u.getSheet(f)._virtualRowIdx.indexOf(e):e,h=this._getContentHeight(e,f)<=n,u._isRowViewable(f,e)&&(u._isUndoRedo||h)&&(a=o.find("tr:eq("+s+")"),v=u._getJSSheetContent(f).find(".e-content").find("tr:eq("+s+")"),a.outerHeight(n),v.height(n)),(u._isUndoRedo||h)&&(u.getSheet(f).rowsHeightCollection[e]=n);u.XLScroll._getRowHeights(f,r[0]);o.find("tbody").css("cursor","default");o.find("tbody").children().css("cursor","default");u._dupDetails||(c={sheetIndex:f,rows:r,newHeight:n,oldHeight:t,reqType:"resize-row"},t!==n&&u._completeAction(c));u.model.allowFreezing&&u.XLFreeze._refreshFRowResize(e);u.model.scrollSettings.allowScrolling&&(u.XLScroll._refreshScroller(f,"refresh","all"),u.XLScroll._getFirstRow(f))}},_findRowsHeight:function(n){for(var t=this.XLObj,i=t.getActiveSheetIndex(),f=t.getSheet(i),e=t._getJSSheetContent(i).find("tbody").children(),r,u=0,o=n.length;u<o;u++)r=n[u],t._sheets[i]._Rows[0]&&(f.rowsHeightCollection[r]=e.eq(r).height())},_calculateHeight:function(){for(var t=this.XLObj,i=t.getRows(t.getActiveSheetIndex())[0],r=0,n=0,u=i.length;n<u;n++)r+=i.eq(n).height();return r},_rMouseUp:function(t){if(this._resizeStart){var r=this.XLObj,u=this._currentHCell,f=r.getSheet(r.getActiveSheetIndex()).rowsHeightCollection,i={},e=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1);if(x=e[0],y=e[1],y+=document.documentElement.scrollTop,i.event=t,i.target=t.target,i.oldHeight=f[u],i.rowIndex=this._currentHCell,this._rowResize(x,y),i.newHeight=f[u],i.reqType="row-resize",this.XLObj._trigger("resizeEnd",i))return;n("#"+this.XLObj._id+"ddlspan").length&&this.XLObj._ddlPosition()}},_getResizableRowCell:function(t){for(var r=this.XLObj,e=r.getActiveSheetIndex(),u=r._getJSSheetContent(e).find(".e-rowheader"),c=navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop,o,f,s=1,h,i=0,l=u.length;i<l;i++)if(f=u[i].getBoundingClientRect(),f.top===0&&s++,o=f.top+c+5,o>this._orgY){r.isUndefined(t)?(h=n(u[i-1]).is(":visible")?i-1:i-s,this._currentHCell=r._getCellIdx(u[h]).rowIndex):t.target=r._getJSSheetRowHeader(e).find("tr:eq("+i+") td")[0];return}},_moveRowVisual:function(n){var i=this.XLObj,t=i._getJSSheetContent(i.getActiveSheetIndex()).find(".e-rowheadercontent")[0].getBoundingClientRect();t.top+document.documentElement.scrollTop+t.height<n||n<t.top+document.documentElement.scrollTop?this._$visualElem.remove():this._currentHCell>-1&&this._$visualElem.css({top:n-3,left:this._tableX})},_apMouseDown:function(t){var i,r=this.XLObj;return r._isTouchEvt&&this._apMouseHover(t),this._allowStart&&n(t.target).closest("div").css("cursor")==="col-resize"&&(i=r._setXY(t,navigator.userAgent.indexOf("WebKit")>-1)[0],i+=document.documentElement.scrollLeft,t.button!==2&&this._apStart(i),this._resizeType="AP",t.preventDefault()),!1},_apMouseHover:function(t){var i=this.XLObj;if(!this._$visualElem.is(":visible")){var r=n(t.target),e=r.get(0),u=i.getActivationPanel()[0].getBoundingClientRect(),f=i._setXY(t)[0];f<=u.left+(i._isTouchEvt?20:4)&&f>=u.left?(r.parent().addClass("e-ss-apresize"),this._allowStart=!0):(i.element.find(".e-ss-apresize").removeClass("e-ss-apresize"),this._allowStart=!1)}},_apStart:function(t){var i=this.XLObj,f=i.getActivationPanel()[0],e=f.getBoundingClientRect(),r=i.getActiveSheetIndex(),u;this._tableY=e.top+parseInt(navigator.userAgent.indexOf("WebKit")>-1?document.body.scrollTop:document.documentElement.scrollTop);this._allowStart&&(this._$visualElem=n(document.createElement("div")),u=i._getJSSheetContent(r).height()+i._getJSSheetHeader(r).height(),this._$visualElem.addClass("e-reSizeAPbg").appendTo(i.element).css({height:u+"px"}).addClass("e-ss-apresize"),this._$visualElem.css({left:t,top:this._tableY}),this._resizeStart=!0)},_apMouseMove:function(n){if(this._resizeStart){var i=this.XLObj,t=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;n.preventDefault();this._apMoveVisual(t)}else this._apMouseHover(n)},_apMouseUp:function(n){if(this._resizeStart){var i=this.XLObj,t=i._setXY(n,navigator.userAgent.indexOf("WebKit")>-1)[0];t+=document.documentElement.scrollLeft;this._apReSize(t)}},_apMoveVisual:function(n){this._$visualElem.css({left:n-5,top:this._tableY})},_apReSize:function(t){var i=this.XLObj,s=i.model.activationPanelWidth,f=0,r=n.extend(!0,{},i.model.scrollSettings),e=i.getActivationPanel(),o,u;r.width=i._responsiveWidth;r.height=i._responsiveHeight;i.model.activationPanelWidth=Math.abs(r.width-(t-i.element.offset().left));i.model.enablePivotTable&&(u=i.getActivationPanel().data("ejScroller"),f=i.getActivationPanel().find(".e-vscrollbar").length?20:2,e.find(".e-ss-pivotfield").width(i.model.activationPanelWidth-f),e.find("#"+i._id+"_PivotField").width(i.model.activationPanelWidth-f),s>i.model.activationPanelWidth?(u.option({width:i.model.activationPanelWidth-1}),i._setSheetWidthHeight(i.getActiveSheetIndex(),{width:r.width,height:r.height},null,"resize")):(i._setSheetWidthHeight(i.getActiveSheetIndex(),{width:r.width,height:r.height},null,"resize"),u.option({width:i.model.activationPanelWidth-1})),o=i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner"),o._reSizeHandler(),u.refresh());this._removeVisualElem()},_removeVisualElem:function(){var n=this.XLObj;this._$visualElem.remove();n.element.find(".e-reSizeRowbg").remove();this._resizeStart=!1;this._currentHCell=-1;this._resizeType="";this._allowStart=!1;n.model.allowComments&&n.XLComment._updateCmntArrowPos()},fitWidth:function(n){var t=this.XLObj,r=t.getActiveSheetIndex(),i,u;if(t.model.allowResizing){for(i=0,u=n.length;i<u;i++)this._fitWidth(n[i],0,t.getSheet(r).usedRange.rowIndex);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getColWidths(r,n[0]+1),t.XLScroll._refreshScroller(r,"refresh","horizontal"));t.model.allowSelection&&t.XLSelection._refreshBorder();t.model.allowComments&&t.XLComment._updateCmntArrowPos(null,r,{colIndex:n[i]})}},_resizeToFitWidth:function(t){var i=this.XLObj,u,r=i.getActiveSheetIndex(),f=i.getSheet(r).usedRange.rowIndex;n(t.target).css("cursor")==="col-resize"&&(i._hasClass(t.target,".e-headercelldiv")&&(t.target=t.target.parentNode),this._getResizableCell(t),u=n(t.target),i._hasClass(u[0],"e-headercell")&&this._fitWidth(t.target.cellIndex,0,f));this._mouseHover(t);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getColWidths(i.getActiveSheetIndex(),t.target.cellIndex+1),i.XLScroll._refreshScroller(r,"refresh","horizontal"));i.model.allowSelection&&i.XLSelection._refreshBorder();i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement();i.model.allowComments&&i.XLComment._updateCmntArrowPos(null,r,{colIndex:t.target.cellIndex})},_fitWidth:function(t,i,r){var u=this.XLObj,f=u.getActiveSheetIndex(),o=u._getJSSheetHeader(f).find(".e-headercell")[t],a=n(o).children(".e-headercelldiv"),e=0,h=0,s=0,c=u.getSheet(f),l;r=r?r:c.usedRange.rowIndex;s=this._getContentWidth(t,f,i,r);h=this._getHeaderContentWidth(a,f);s>1&&(e=h>s?h:s,l={target:o,sheetIndex:f,colIndex:t,newWidth:e,oldWidth:o.offsetWidth,reqType:"resize-fit-width"},e>0&&(e<20&&(e=30),this._applyWidth(o,f,t,e),u.model.allowFreezing&&u.XLFreeze._refreshFColResize(t),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement(),c._isImported&&!c._isLoaded||u._isUndoRedo||u._dupDetails||u._isExport||u._completeAction(l)));u.XLEdit._updateDataContainer({rowIndex:0,colIndex:t},{dataObj:{isFitWidth:!0}})},_applyWidth:function(n,t,i,r){var u=this.XLObj;u._getJSSheetHeader(t).find("col:eq("+i+")").width(r);u._getJSSheetContent(t).find("col:eq("+(i+1)+")").width(r);u.getSheet(t).columnsWidthCollection[i]=r;u.getSheet(t).columns[i].width=r},_getContentWidth:function(n,i,u,f){for(var c=0,s,h,l=this.XLObj,a=l._dataContainer.sheets[i],o,e=u;e<=f;e++)t.isNullOrUndefined(a[e])||(s=a[e][n]),t.isNullOrUndefined(s)?(s={},h={spanWidth:0,paddingWidth:0}):h=this._getCalculatedCellWidth(i,s),o=l._detailsFromGlobalSpan(e,n,"width",l.XLEdit.getPropertyValue(e,n,"value2"),r,!0),o=o+h.spanWidth+h.paddingWidth+4,o>c&&(c=o);return c},_getCalculatedCellWidth:function(n,t){var i=0,r=0;return"isFilterHeader"in t?"isFilterVisible"in t&&(i+=17):i+=0,r=3,{spanWidth:i,paddingWidth:r}},_getHeaderContentWidth:function(n){var i=0,r=t.buildTag("span",{},{}),u=n.html();return r.html(u),n.html(r),i=n.find("span:first").width(),i=i+10,n.html(u),i},fitHeight:function(n){var i=this.XLObj,u,r,f;if(i.model.allowResizing){for(u=i.getActiveSheetIndex(),r=0,f=n.length;r<f;r++)t.isNullOrUndefined(i.XLEdit.getPropertyValue(n[r],0,"wrapRow"))&&this._fitHeight(n[r],n[r]),i._setRowHdrHeight(u,n[r]);i.model.scrollSettings.allowScrolling&&(i.XLScroll._getRowHeights(u,n[0]),i.XLScroll._refreshScroller(u,"refresh","vertical"));i.model.allowSelection&&i.XLSelection._refreshBorder();i.model.allowComments&&i.XLComment._updateCmntArrowPos(null,u,{rowIndex:n[0]})}},_resizeToFitHeight:function(n){var t=this.XLObj,i=t.getActiveSheetIndex(),r=n.target.parentNode.rowIndex,u;u=t.model.scrollSettings.allowVirtualScrolling?t.getSheet(i)._virtualRowIdx[r]:r;this._getResizableRowCell(n);this._fitHeight(r,u);t._setRowHdrHeight(i,u);t.model.scrollSettings.allowScrolling&&(t.XLScroll._getRowHeights(t.getActiveSheetIndex(),u),t.XLScroll._refreshScroller(i,"refresh","vertical"));t.model.allowSelection&&t.XLSelection._refreshBorder();t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement();t.model.allowComments&&t.XLComment._updateCmntArrowPos(null,i,{rowIndex:r})},_fitHeight:function(i,r){var u=this.XLObj,f=u.getActiveSheetIndex(),s=u.getSheet(f),c=u._getJSSheetRowHeader(f).find(".e-rowheader")[i],e=0,h=0,o,l=t.buildTag("span",{},{height:20,width:30}),a;h=this._getContentHeight(r,f,u.XLEdit.getPropertyValue(r,0,"wrapRow"));l.html(r+1);u.element.append(l);o=u.element.find("span:last").outerHeight(!0);u.element.find("span:last").remove();o=o+4;e=h<o?o:h;a={target:c,sheetIndex:f,rowIndex:r,newHeight:e,oldHeight:s.rowsHeightCollection[i],reqType:"resize-fit-height"};u._isRowViewable(f,r)&&(n(c.parentElement).height(e),n(u._getContent(f).find("tr")[i]).height(e));u.getSheet(f).rowsHeightCollection[r]=e;u.model.allowFreezing&&u.XLFreeze._refreshFRowResize(i);u.model.scrollSettings.allowScrolling&&u.XLScroll._refreshScroller(f,"refresh","all");s._isImported&&!s._isLoaded||u._dupDetails||u._isExport||u._completeAction(a);u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement();u.XLEdit._updateDataContainer({rowIndex:r,colIndex:0},{dataObj:{isFitHeight:!0}})},_getContentHeight:function(n,t,i){for(var u=this.XLObj,e=0,o,a=u._formatRegx,h=u.getSheet(t),s=u.getObjectKeys(u._dataContainer.sheets[t][n]),v=h.rowsHeightCollection[n],c=h.columnsWidthCollection,f=0,l=s.length;f<l;f++)o=u._detailsFromGlobalSpan(n,s[f],"height",u.XLEdit.getPropertyValue(n,s[f],"value2"),i?c[f]:r,!0),o>e&&(e=o);return e+3},_setRowHdrHeightResize:function(i,r){for(var f=this.XLObj,e=f.getRows(i),o=e[0],s=f.getSheet(i).usedRange.rowIndex,u=0;u<=s;u++)t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"mergeIdx"))&&t.isNullOrUndefined(f.XLEdit.getPropertyValue(u,r,"merge"))&&f._isRowViewable(i,u)&&(tdHeight=f._detailsFromGlobalSpan(u,r,"height",f.XLEdit.getPropertyValue(u,r,"value2")),n(o[u]).height(tdHeight))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.editing=function(n){this.XLObj=n;this._EditCellDetails={value:null,rowIndex:-1,columnIndex:-1,fieldName:null,cell:null};this._isEdit=!1;this._isFEdit=!1;this._isFormulaEdit=!1;this._isFBarFocused=!1;this._skipHTML=!1;this._editElem=null;this._filterIcon=null;this._isCellEdit=!0;this._validOperators=["+","-","*","/",","];this._invalidOperators=["%"];this._validCharacters=["+","-","*","/",",","(","="];this._textDecoration=!1;this._editCell=null;this._acPosition={left:0,top:0};this._isValidation=!1};t.spreadsheetFeatures.editing.prototype={getCurrentEditCellData:function(){var r,n,t=this.XLObj,i;return this._isEdit?(r=t.element.find("#"+t._id+"_Edit"),n=r.text(),i=t._getCellIdx(this._editCell[0]),this.getPropertyValue(i.rowIndex,i.colIndex,"type")!="text"&&t.isNumber(n)&&(n=parseFloat(n)),n):null},getColumnIndexByField:function(n){for(var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),t=0,u=r.columns.length;t<u;t++)if(r.columns[t].field===n)break;return t},_processEditing:function(){this._editElem||(this._editElem=t.buildTag("div.e-field e-ss-input","",{},{id:this.XLObj._id+"_Edit",contenteditable:!0}),this._editElem.data("parentID",this.XLObj._id))},editCell:function(t,i,r){var u=this.XLObj,o,f,c,e,l,a,s,h,v;u.model.allowEditing&&u.model.allowSelection&&!u._isCellProtected(t,i,!0)&&!u.model.isReadOnly&&((u=this.XLObj,v=u.element.find("#"+u._id+"_ValElem"),h={rowIndex:t,colIndex:i},o=u.getActiveSheetIndex(),f=u.getSheet(o),l=u.getActiveCell(o),u._isRowViewable(o,t)&&(this._textDecoration=u.getCell(t,i).find("a").css("text-decoration")==="none"),s=u.getCell(t,i),column=f.columns[i],this._editCell=s,e={columnName:column.field,value:u.getRangeData({range:[t,i,t,i],valueOnly:!0,sheetIdx:o,skipDateTime:!0})[0],columnObject:column,cell:s},u._trigger("cellEdit",e))||(u._cureditedCell=e.value,this._isValidation&&(v.rules("remove"),this._isValidation=!1),(l.rowIndex!==t||l.colIndex!==i)&&(f._activeCell=h,f._startCell.rowIndex<=t&&f._startCell.colIndex<=i&&f._endCell.rowIndex>=t&&f._endCell.colIndex>=i?u.XLSelection.selectRange(f._startCell,f._endCell):u.XLSelection.selectRange(h,h),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),this._EditCellDetails={rowIndex:t,value:e.value,columnIndex:i,fieldName:column.field,cell:s},r||(e.value=""),a=e.value,this._renderBulkEditObject(e,s,a),this.getPropertyValue(f._activeCell.rowIndex,f._activeCell.colIndex,"rule",o)&&u.model.allowDataValidation&&u.XLValidate._setValidation(),c=n("#"+u._id+"_Edit"),this.getPropertyValue(t,i,"hyperlink",o)&&c.addClass("e-hyperlinks"),this._textDecoration&&c.css("text-decoration","none"),u.model.allowComments&&s.hasClass("e-commentcell")&&u.XLComment._visibleCmntCnt(s),e.cell.addClass(u._browserDetails.name==="msie"?"e-editedcell e-msie-edit":"e-editedcell"),u.isFormula(e.value)&&this._processFormulaEditRange(e.value),u.model.allowKeyboardNavigation&&(u.XLCellNav._isNavigate=!1),u.model.enableContextMenu&&n("#"+u._id+"_contextMenuCell").data("ejMenu")._contextMenuEvents("_off")))},_renderBulkEditObject:function(i,r,u){var s,a,f=this.XLObj,v=r.height(),o=f.getActiveSheetIndex(),h=r.find(".e-filterspan"),l=f._getJSSheetContent(o).find(".e-spreadsheetcontentcontainer > .e-content"),y=f.XLFormat.getFormatClass(r[0].className),c,e;({})[i.columnObject.field]=i.value;h.length&&(a={filterIcon:h,rowIndex:h.parentsUntil("table").eq(1).index(),colIndex:h.parent().index()},this._filterIcon=a);s=r.height();this._refreshTextNode(r[0]);r.hasClass("e-sswraptext")&&v!==s&&r.height(v);e=this._editElem;e.text("");t.isNullOrUndefined(u)||e.text(f.isNumber(u)?f._getlocaleNumVal(u,!0):u);l.append(e);c=f._isClassHasProperty(y,"text-align","right")?{right:l.width()-r[0].offsetLeft-r[0].offsetWidth+2,left:"",maxWidth:r[0].offsetLeft+r[0].offsetWidth+2}:{left:r[0].offsetLeft+2,right:"",maxWidth:l.width()-(r.offset().left-(f.element.offset().left+n(f.getRows(o)[0][0]).width()))-2};e.css({left:c.left,right:c.right,top:r[0].offsetTop+1,"-webkit-user-select":"text",cursor:"text","min-height":s-1,height:"auto",lineHeight:"normal",wordWrap:"break-word",position:"absolute",minWidth:r.width(),whiteSpace:"pre-wrap"});this._editCell.hasClass("e-sswraptext")?(e.css({width:r.width(),maxWidth:""}),n(f.getRows(o)[1][r.parent().attr("idx")]).height(f.model.sheets[o].rowsHeightCollection[r.parent().attr("idx")]),f.XLScroll._getRowHeights(o,r.parent().index())):e.css({width:"",maxWidth:c.maxWidth});e.show();this._refreshEditForm(r,e,i.value,u,s);this._isEdit=!0;f.model.showRibbon&&f.XLRibbon._disableRibbonIcons()},_refreshEditForm:function(t,i,r,u){var h,e,c={},f=this.XLObj,l=document.getElementById(f._id+"EditForm"),a=n(l).find("input,select"),o=f._dataContainer.sheets[f.getActiveSheetIndex()],s=t.parent().index();o&&o[s]&&o[s][t[0].cellIndex]&&(c=o[s][t[0].cellIndex]);i[0].className="";e=this.getPropertyValueByElem(t,"type")||"";!f.isNumber(u)||e.indexOf("text")>-1||i.addClass("e-ralign");(e.indexOf("date")>-1||e.indexOf("time")>-1)&&i.addClass("e-ralign");i.css({border:"none",outline:"none"});this.XLObj.model.allowCellFormatting&&(h=f.XLFormat.getFormatClass(t[0].className));i.addClass(h);f.model.allowCellFormatting&&(i.css({color:t.css("color")}),i.css({"background-color":t.css("background-color")}));i.on("keyup",{xlObj:f},function(t){var i=t.data.xlObj;i.XLEdit._isFormulaEdit=!n(t.target).text().indexOf("=");i.XLEdit._isFormulaEdit&&i.XLEdit._processFormulaEditRange(n(t.target).text());i.model.allowFormulaBar&&i._getInputBox().val(n(t.target).text());i.XLEdit._isCellEdit=!0});i.on("focus",{xlObj:f},function(n){var t=n.data.xlObj;t.XLEdit._isCellEdit=!0});f._setFormulaSuggElem(n("#"+f._id+"_AutoComplete_suggestion"));i.focusEnd()},_renderAutoComplete:function(t,i,r,u){var f=this.XLObj,e=u?" e-cell-ac e-ss-editinput":"";t.ejAutocomplete({dataSource:f._formulaCollection,value:i,cssClass:"e-ss-autocomplete"+e,width:"100%",height:r,htmlattributes:u?{display:"none"}:"",delaySuggestionTimeout:10,minCharacter:2,popupWidth:"170px",popupHeight:"150px",showEmptyResultText:!1,autoFocus:!0,template:"<span class='e-icon e-ss-function'> <\/span><div> ${display} <\/div>",select:n.proxy(this._formulaSelect,f),open:n.proxy(this._formulaSuggestionStatus,f),close:n.proxy(this._formulaSuggestionStatus,f)});t.data("ejAutocomplete")._bubbleEvent(!0)},_refreshAutoComplete:function(){var t=this.XLObj,i,r,u="ejAutocomplete",f="dataSource";r=n("#"+t._id+"_inputbox").data(u);i=n("#"+t._id+"_AutoComplete").data(u);t.model.allowFormulaBar&&r&&r.option(f,t._formulaCollection);i&&i.option(f,t._formulaCollection)},_captureEditing:function(){var t=this.XLObj,i,f,e,r,u=document.activeElement,o=t.getActiveCell();u&&u.tagName==="DIV"&&t._isRowViewable(null,o.rowIndex)&&(i=t.element.find("#"+t._id+"_AutoComplete"),i.val(n(u).text()),i.data("ejAutocomplete").search(),f=t.getActiveCellElem(),e=t.element.find("#"+t._id+"_Edit")[0],r=f[0].getBoundingClientRect(),this._acPosition.left=r.left+window.pageXOffset,this._acPosition.top=r.top+window.pageYOffset+n(e).height(),n("#"+t._id+"_AutoComplete_suggestion").css({left:this._acPosition.left,top:this._acPosition.top}))},saveCell:function(){var t=this.XLObj,p,a,v,b,o,s,h,it,k,c,d,g,nt,w,rt,r,u,ut,e,f,l,i,tt,ot,ft,et,y;if(t.model.allowEditing&&!t.model.isReadOnly&&(tt=!1,ft=["ABS","LEFT","RIGHT","TRIM","UPPER","VALUE"],this._isEdit)){if(f=t.getActiveSheetIndex(),l=t.getSheet(f),ot=t.getRows(f),v=n("#"+t._id+"EditForm"),d=this._editCell,k=l.columns[this._EditCellDetails.columnIndex],g=t.element.find("#"+t._id+"_ValElem"),et=t.element.find("#"+t._id+"_Edit")[0],y=n(et).html(),nt=t._getCellIdx(d[0]),i=nt.rowIndex,r=nt.colIndex,u={columnName:k.field,value:this.getCurrentEditCellData(),pValue:this._EditCellDetails.value,columnObject:k,rowIndex:i,colIndex:r,cell:d,isRefCells:!1},t.model.allowDataValidation&&this._isValidation){if(g.val(u.value),v.css("display","block"),!v.validate().element(g[0]))return v.css("display","none"),!1;v.css("display","none");u.hasValidation=!0}if(u.value!==u.pValue&&t._trigger("cellSave",u))return;if(h=t.getRangeData({range:[i,r,i,r],property:["type","formatStr","decimalPlaces"]})[0],t.isFormula(u.value)&&!this._formulaValidate(u.value))return;if(ut=this._EditCellDetails.value||"",e={sheetIndex:f,rowIndex:i,colIndex:r,cValue:u.value,reqType:"edit",iconName:"",pValue:ut},e.prevHeight=l.rowsHeightCollection[i],t._dupDetails=!0,this._updateCellValue({rowIndex:i,colIndex:r},u.value),t._dupDetails=!1,this.getPropertyValue(i,r,"wrap",f)&&(rHgt=t._getWrapCellHeight(f,i,r),t._wrapCollection(i,r,rHgt.cellHt,f),t._getRowHeight(i,f)<rHgt.rowHt&&(t.setHeightToRows([{rowIndex:i,height:rHgt.rowHt}]),t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()),this._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{}})),t.XLEdit.getPropertyValue(i,r,"isFilterHeader")&&t._removeClass(u.cell[0],t._rAlign),this._textDecoration&&u.cell.find("a").css("text-decoration","none"),u.hasValidation&&(e.hasValidation=!0),t.isFormula(u.value)&&(!t.getObjectLength(h)||h.type==="general")&&(e.operation="formula",s=u.value,s=t.XLDragFill._parseFormula(s),ft.indexOf(s[0])===-1)){for(j=0,it=s.length;j<it;j++)if(o=s[j],o!="("&&s[j+1]!="(")break;o.indexOf(":")>-1&&(o=o.split(":")[0]);t._isCellReference(o)&&(o=o.replace(/\$/g,""),fRange=t.getRangeIndices(o),fObj=t.getRangeData({range:fRange,property:["type","formatStr","decimalPlaces"]})[0],t.getObjectLength(fObj)&&fObj.type!=h.type&&fObj.type!=="general"&&(t._dupDetails=!0,tt=!0,t.XLFormat.format(fObj,t._getAlphaRange(t.getActiveSheetIndex(),i,r,i,r)),t._dupDetails=!1,e.prevFrmtObj=t.getObjectLength(h)?h:{type:"general"},e.curFrmtObj=fObj))}if(t._setRowHdrHeight(f,i),t.model.scrollSettings.allowScrolling&&t.XLScroll._getRowHeights(f,i),this._isEdit=this._isFormulaEdit=!1,u.cell.removeClass("e-editedcell e-msie-edit"),t.model.allowKeyboardNavigation&&(t.XLCellNav._isNavigate=!0),t.model.showRibbon&&(t.XLRibbon._enableRibbonIcons(),t.XLRibbon._updateRibbonIcons()),t._updateUndoRedoIcons(),t.model.allowInsert||(t.XLRibbon._disableButtons(["Others_Cells_InsertCellOptions"],"ejSplitButton"),t.XLRibbon._disableButtons(["Others_Cells_InsertCell"],"ejButton")),t.model.allowDelete||(t.XLRibbon._disableButtons(["Others_Cells_DeleteCellOptions"],"ejSplitButton"),t.XLRibbon._disableButtons(["Others_Cells_DeleteCell"],"ejButton")),e.cFormatRule=w=this.getPropertyValue(i,r,"cFormatRule",f),t._dupDetails=!0,t.model.allowConditionalFormats&&w){for(p=0,rt=w.length;p<rt;p++)c=w[p].split("_"),c[0]!=="formularule"&&t.XLCFormat._cFormat(c[0],c[2],c[3],c[4],t._generateHeaderText(r+1)+(i+1));t.XLCFormat.refreshCFormat(t._getAlphaRange(f,i,r,i,r))}return t._dupDetails=!1,e.endCell=l._endCell,e.startCell=l._startCell,a=t.getActiveCellElem(),a&&(t.model.allowComments&&a.hasClass("e-commentcell")&&t.XLComment._visibleCmntCnt(a,!0),a.hasClass("e-hlcell")&&t.XLValidate.highlightInvalidData()),this._shiftKeyEnabled=this._isFBarFocused=!1,t._ctrlKeyCount=0,!this._isFormulaEdit&&t.model.allowSelection&&t.XLSelection._clearBorder(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.model.allowFormulaBar&&(b=n("#"+t._id+"_inputbox").data("ejAutocomplete"),b&&b.hide()),this._editElem.hide(),t.setSheetFocus(),t._browserDetails.name==="mozilla"&&(y=y.slice(0,-4)),y.indexOf("\n")>-1&&(e.altwrap=!0,this._updateDataContainer({rowIndex:i,colIndex:r},{dataObj:{altTxt:!0}})),this.getPropertyValue(i,r,"altTxt",f)&&(this.getPropertyValue(i,r,"wrap",f)||t.wrapText([i,r,i,r]),y.match(/\n/g)||this._clearDataContainer({cellIdx:{rowIndex:i,colIndex:r},property:["altTxt"]})),e.newHeight=l.rowsHeightCollection[i],t.XLScroll._getRowHeights(f,i),t.model.enableContextMenu&&n("#"+t._id+"_contextMenuCell").data("ejMenu")._contextMenuEvents("_on"),(u.value!==u.pValue||tt)&&t._completeAction(e),!0}},_formulaValidate:function(n){var f,h,t,e,o,c,l,s,u,a,i=n,r=this.XLObj,v=["TODAY","NOW","TRUE","FALSE","ROW","COLUMN","SHEET","SHEETS"];if(!this._isNamedRange(n)&&(c=i.length,e=i.split("(").length,o=i.split(")").length,s=r.getCalcEngine().getLibraryFunctions(),i.startsWith("=")&&c>1)){if(t=i=i.substring(1),e!==o){r._showAlertDlg("Alert","MissingParenthesisAlert","FormulaAlert",440);return}if(e===1&&o===1&&r.isUndefined(s.getItem(t.toUpperCase()))&&!this._isValidCell(i)&&!(t.substring(0,u)=="TRUE"||t.substring(0,u)=="FALSE")){r._showAlertDlg("Alert","CorrectFormula","FormulaAlert",372);return}do{if(u=t.indexOf("("),a=t.indexOf(")"),v.indexOf(t.substring(0,u).toUpperCase())<0&&u+1===a){r._showAlertDlg("Alert","CorrectArgument","FormulaAlert",372);return}t=t.substring(u+1);t.indexOf(",")>-1&&(t=t.substring(t.indexOf(",")+1))}while(t.indexOf("(")>-1);for(splitStr=i.split(","),f=0,h=splitStr.length;f<h;f++)if(splitStr[f].indexOf("(")>-1&&(l=splitStr[f].split("("),r.isUndefined(s.getItem(l[0].toUpperCase())))){r._showAlertDlg("Alert","CorrectFormula","FormulaAlert",372);return}}return!0},_isValidCell:function(n){for(var u=this.XLObj,f,r,e,s=!0,h,t,o=["<=",">=","<",">","=","+","-","/","*","^","&"],i=0,c=o.length;i<c;i++){if(n.indexOf(o[i])>-1)for(r=n.split(o[i]),t=0,e=r.length;t<e;t++)if(r[t].length){if(e==t+1&&r[t].length)return!0}else return!1;if(n.indexOf("%")>-1&&n.split("%").length==2)return!0}return n=n.trim(),n=n.startsWith("=")?n.substring(1):n,n.indexOf("!")>-1&&(f=n.split("!"),n=f[1],u._getSheetIndexByName(f[0])<1&&(s=!1)),h=n.indexOf(":")>-1?u._isvalidRange(n):u._isvalidRange(n+":"+n),h&&s},updateValue:function(n,t,i,r){var u=this.XLObj,f;u.model.isReadOnly||(f=u.getRangeIndices(n),u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&u.XLFormat._createFormatClass(u.XLFormat.getFormatFromHashCode(i),i),this._updateCellValue({rowIndex:f[0],colIndex:f[1]},t,i,r))},updateCellValue:function(n,t,i,r){var u=this.XLObj;u._isPublic=!0;u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&u.XLFormat._createFormatClass(u.XLFormat.getFormatFromHashCode(i),i);this._updateCellValue(n,t,i,r);u._isPublic=!1},_updateCellValue:function(n,t,i,r){var u=this.XLObj;if(n&&!u.model.isReadOnly){var f=n.colIndex,e=n.rowIndex,r=u._getSheetIndex(r);u.isFormula(t)?(this._refreshCalcEngine(e,f,!0,t,r),this._updateDataContainer({rowIndex:e,colIndex:f},{dataObj:{value:t},sheetIdx:r}),u._isFormulaSuggestion=!1):(this._updateCell({rowIndex:e,colIndex:f},t,r),this._refreshCalcEngine(e,f,!1,null,r));u.model.allowCellFormatting&&u.XLFormat._hasFormat(i)&&u.XLFormat._updateFormatClass(n,i);u.model.allowDataValidation&&this.getPropertyValue(e,f,"isHighlight",r)&&u.XLValidate.highlightInvalidData()}},updateCell:function(n,t,i){var r=this.XLObj;r._isPublic=!0;this._updateCell(n,t,i);r._isPublic=!1},_updateCell:function(n,i,r){var f=this.XLObj;if(n&&!f.model.isReadOnly){var c=f.getSheet(r),e=n.rowIndex,s=n.colIndex,h=t.Spreadsheet.CellType,l,a=this.getPropertyValue(e,s,"value2"),v=c.rowsHeightCollection[e],o=this._parseValue(i,n),u=f.getRangeData({range:[e,s,e,s],property:["formatStr","type","thousandSeparator","decimalPlaces"],sheetIdx:r})[0];f.model.isReadOnly||(u.type&&u.type!=h.General&&(o.type=u.type,delete o.formatStr),(u.formatStr||u.type===h.Scientific||u.type===h.Fraction)&&(o.value2=f.XLFormat._format(o.value,{formatStr:u.formatStr,type:u.type,thousandSeparator:u.thousandSeparator,decimalPlaces:u.decimalPlaces})),this._updateDataContainer(n,{dataObj:o,sheetIdx:r}),l={sheetIndex:r?r:f.getActiveSheetIndex(),rowIndex:e,colIndex:s,reqType:"edit",cValue:i,pValue:a?a:"",prevHeight:v,newHeight:c.rowsHeightCollection[e]},f._isPublic&&!f._dupDetails&&f._completeAction(l))}},_parseValue:function(i,r){var p;r&&this.getPropertyValue(r.rowIndex,r.colIndex,"type")=="text"||(p=this.XLObj._getlocaleNumVal(i),i=this.XLObj.isNumber(i)?Number(i):t.isNullOrUndefined(i)?"":typeof i=="object"&&!this.XLObj._isDateTime(i)?JSON.stringify(i):i);var h,f,w,l,b,a,y,k,o,e=this.XLObj,c=e.model.locale,s=t.Spreadsheet.CellType,d=t.Spreadsheet.Align.Right,u=typeof i=="object"&&!this.XLObj._isDateTime(i)?JSON.stringify(i):i+"",v=s.General,g=u.indexOf(e._currencySymbol);if(p&&(i=p),(g===0||g>-1&&g===u.length-1)&&(f=t.parseFloat(u,10,c),f))return o=u.indexOf(e._decimalSeparator)>-1?e._decimalCnt(f):0,{type:s.Currency,value:f,value2:u,formatStr:e._getFormatString(s.Currency,o),decimalPlaces:o,align:d};if(u.indexOf(e._percentSymbol)>-1&&(f=n.trim(u).replace(e._percentSymbol,""),e.isNumber(f)))return o=u.indexOf(e._decimalSeparator)>-1?e._decimalCnt(f):0,{type:s.Percentage,value:Number(f)/100,value2:u,formatStr:e._getFormatString(s.Percentage,o),decimalPlaces:o,align:d};if(y=t.preferredCulture(c),w=y.numberFormat[","]||",",a=new RegExp("\\"+w+"\\d{3}"),u.indexOf(e._decimalSeparator)>-1&&a.test(u)&&(f=t.parseFloat(u,10,c),f))return o=u.substr(u.indexOf(e._decimalSeparator)+1).length,o>2&&(o=2),u=t.format(f,"N"+o,c),{type:s.Number,value:f,value2:u,formatStr:e._getFormatString(s.Number,o),decimalPlaces:o,thousandSeparator:!0};if(u.indexOf(w)>-1)if(a.test(u)){if(f=t.parseInt(u,10,c),f)return o=0,u=t.format(f,"N"+o,c),{type:s.Number,value:f,value2:u,formatStr:e._getFormatString(s.Number,o),decimalPlaces:o,thousandSeparator:!0}}else i=u;l=y.calendar.patterns;b=!0;a=y.calendar._parseRegExp;for(h in l)if(a&&l[h]in a?f=new RegExp(a[l[h]].regExp).exec(u):(b=!1,f=t.parseDate(u,l[h],c)),f)break;return f&&(b&&(f=t.parseDate(u,l[h],c)),f)?(h==="T"||h==="t"||e.XLFormat._customFormatSpecifierType[h]===s.Time?(f.setYear(1990),f.setMonth(0),f.setDate(1),v=s.Time):v=h==="d"?s.ShortDate:h==="D"?s.LongDate:s.Date,k="{0:"+l[h]+"}",u=e.XLFormat._format(f,{type:v,formatStr:k}),{type:v,value:f,value2:u,formatStr:k,align:d}):((u.toLowerCase()==="true"||u.toLowerCase()==="false")&&(i=u=u.toUpperCase()),{type:v,value:i,value2:u})},updateCellWithContainer:function(n,i,r,u){var f=this.XLObj;if(!f.model.isReadOnly){for(var o,h,s,e,c,a=0,y=0,r=f._getSheetIndex(r),i=i?i:f.getSheet(r).selectedRange,l=f._getSelectedRange({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]}),v=l.length;a<v;)c=l[a],s=c.rowIndex,u&&f._isHiddenRow(s)||(h=c.colIndex,e=n[y],o=f.getCell(s,h,r),this._updateDataContainer(c,{dataObj:e}),this._refreshCalcEngine(s,h,f.isFormula(e.value),e.value),o&&e.format&&f.addClass(o[0],e.format),o&&e.hyperlink&&o.html(t.buildTag("a.e-hyperlinks",e.value2,"","cellAdr"in e.hyperlink?{href:"#"}:{href:e.hyperlink.webAdr,target:"_blank"})),e.comment&&f.XLComment.setComment([s,h,s,h],null,!1),e.border&&f.XLFormat.applyBorder(f.XLFormat.getBorderFromHashCode(e.border),f._getAlphaRange(r,s,h,s,h)),o&&(e.rule&&e.rule.isApply?f.addClass(o[0],"e-hlcell"):f._removeClass(o[0],"e-hlcell")),y++),a++;f.model.allowConditionalFormats&&f.XLCFormat.refreshCFormat(i)}},_refreshCellAlignment:function(n){n=n||{};var o,s,f=t.Spreadsheet.Align,i=this.XLObj,r=n.cellIdx.rowIndex,u=n.cellIdx.colIndex,e=this.getPropertyValue(r,u,"merge");f in n||(n.value=t.isNullOrUndefined(n.value)?this.getPropertyValue(r,u,"value"):n.value,i.isFormula(n.value)&&(n.value=i.XLEdit.getPropertyValue(r,u,"calcValue")),n.type=n.type?n.type:this.getPropertyValue(r,u,"type"),n.align=!i.isNumber(n.value)&&typeof n.value!="object"||n.type===t.Spreadsheet.CellType.Text||e&&e.isCenterAlign?i._isBool(n.value)||e&&e.isCenterAlign?f.Center:f.Left:f.Right);o=this.getPropertyValue(r,u,"align");i._isInitLoad&&!i.isImport&&(s=!0);(!n.align||o&&o!=n.align)&&i.clearRangeData([r,u,r,u],["align"],"","","",s);n.align&&this._updateDataContainer(n.cellIdx,{dataObj:{align:n.align},skipCell:s})},_editingHandler:function(i){var it,r,e,u,o,b,c,s,h,rt,l,k,p,d,et,g,nt,a,ot,lt,v,f,st,ht,ut,w,tt,y,ct,ft;if(!n(i.target).parents(".e-backstagecontent").length)if(r=this.XLObj,!(i.keyCode===61||!i.shiftKey&&i.keyCode===32||i.keyCode>=48&&i.keyCode<=59||i.keyCode>=65&&i.keyCode<=90||i.keyCode>=96&&i.keyCode<=111||i.keyCode===173||i.keyCode>=186&&i.keyCode<=192||i.keyCode>=219&&i.keyCode<=222)||i.ctrlKey||i.altKey)if(i.keyCode!==113||i.shiftKey||i.ctrlKey)if(i.keyCode===27&&this._isEdit)e=r.getActiveSheetIndex(),u=r.getSheet(e),s=u._activeCell.rowIndex,h=u._activeCell.colIndex,o=r.getCell(s,h),b=r._dataContainer.sheets[e],r.XLEdit.getPropertyValue(s,h,"wrap")&&r.XLEdit.getPropertyValue(s,h,"merge")&&(ht=r.getCell(s,h,e),ut=ht.find("#"+r._id+"_MergeWrap")[0]),c=s in b&&h in b[s]?b[s][h]:c,w=c?typeof c.value2=="string"?c.value2:r._dataContainer.sharedData[c.value]:"",r.isFormula(w)&&(w=this.getPropertyValue(s,h,"value2")),r.element.find("#"+r._id+"_Edit").hide(),it=r._isRowViewable(e,s),it?(ut?ut.innerHTML=w:this._refreshTextNode(o[0],w),r.setSheetFocus(),r._setRowHdrHeight(e,u._selectedCells[0].rowIndex)):r.model.allowFormulaBar&&r.updateFormulaBar(),this._isFormulaEdit&&n("#"+r._id+"_AutoComplete").data("ejAutocomplete").suggestionList.hide(),this._isEdit=this._isFormulaEdit=this._isFBarFocused=!1,r._getContent(e).find("td").removeClass(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")),it&&(r.model.allowComments&&o.hasClass("e-commentcell")&&r.XLComment._visibleCmntCnt(o,!0),r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement(),o.removeClass("e-editedcell e-msie-edit")),r.model.showRibbon&&r.XLRibbon._enableRibbonIcons(),r._getContent(r.getActiveSheetIndex()).find(".e-error").remove(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0);else if(i.keyCode===46)if(this._isEdit)r._ctrlKeyCount>0&&(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._formulaBorder.join(" ").replace(/,/g," ")+" "+r._ctrlFormulaBorder.join(" ").replace(/,/g," ")));else{if(r._preventctrlkey){r._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}if(e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),lt=new RegExp("\\be-format.*?\\b","g"),v,f=u._selectedCells,text=r.getRangeData({range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex]}),r.model.allowLockCell&&u.isSheetProtected&&r._isPropExists([u.selectedRange],"isLocked",e))return;if(r._isPropExists([u.selectedRange],"isReadOnly",e))return;if(!this._isEdit){for(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),tt=r.model.sheets[e].tableManager,ct=r.getObjectKeys(tt),g=0,nt=r.getObjectLength(tt);g<nt;g++)if(y=tt[ct[g]].range,r.XLClipboard._compareRange([f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],y)){ot=r._getAlphaRange(e,y[0],y[1],y[2],y[3]);r.clearAll(ot);return}for(r._hasClass(o,"e-readonly")||r.clearRangeData(null,["value2","value","hyperlink"]),rt=f[0].rowIndex,p=0,et=f.length;p<et;p++)if(l=f[p].rowIndex,k=f[p].colIndex,r._textClip(l,k,"delete"),!this.getPropertyValue(l,k,"isReadOnly")){if(r.model.allowFormulaBar&&r._getInputBox().val(""),v=this.getPropertyValue(l,k,"cFormatRule"),r.model.allowConditionalFormats&&v&&v.length)for(d=0,nt=v.length;d<nt;d++)a=v[d].split("_"),r.XLCFormat._cFormat(a[0],a[2],a[3],a[4],a[5]);rt!==l&&(r._setRowHdrHeight(e,l),rt++)}r.XLSelection._refreshBorder()}st={sheetIndex:e,range:[f[0].rowIndex,f[0].colIndex,f[f.length-1].rowIndex,f[f.length-1].colIndex],bData:text,reqType:"clear-content"};r._completeAction(st)}else i.ctrlKey||i.shiftKey||i.keyCode!==8?(i.keyCode!==13||i.altKey)&&i.keyCode!==9||!this._isEdit||!r.model.allowKeyboardNavigation||r.XLCellNav._isNavigate||this._isFormulaEdit?i.keyCode===13&&i.altKey&&this._isEdit&&(i.preventDefault(),ft=r.element.find("#"+r._id+"_Edit"),ft.focus(),ft.altEnter()):(i.preventDefault(),t.isNullOrUndefined(r.XLCellNav)||(r.XLCellNav._isNavigate=!0)):(e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1),r._setRowHdrHeight(e,u._activeCell.rowIndex),r.model.allowFormulaBar&&r._getInputBox().val("")));else e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isFEdit=!0,this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),r.XLCellNav._navToCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!0));else e=r.getActiveSheetIndex(),u=r.getSheet(e),o=r.getCell(u._activeCell.rowIndex,u._activeCell.colIndex),this._isEdit||r._hasClass(o,"e-readonly")||r._hasClass(o,"e-cellreadonly")||(r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom"),r.XLCellNav._navToCell(u._activeCell.rowIndex,u._activeCell.colIndex),this.editCell(u._activeCell.rowIndex,u._activeCell.colIndex,!1))},_focusElements:function(t){n(t).not(":hidden").focus().setInputPos(n(t).text().length)},_updateUsedRange:function(n,t){var r=this.XLObj,i=r.getSheet(r.getActiveSheetIndex()).usedRange;i.rowIndex<n&&(i.rowIndex=n);i.colIndex<t&&(i.colIndex=t)},_updateDataContainer:function(i,r){var d,pt,g,l,w,nt,ft,et,ot,o,f,c,h,tt,a,y,st,ht,ct,lt,wt,p,it,k,bt,kt,rt,b,at,ut,vt=!1,s=r.dataObj,u=this.XLObj,v=u._getSheetIndex(r.sheetIdx),yt=u.getSheet(v),e;if(!r.skipCell&&u._isRowViewable(v,i.rowIndex)&&(g=u.getCell(i.rowIndex,i.colIndex,v),l=g[0]),s){et=t.Spreadsheet.CellType;ot=t.Spreadsheet.Align;p=u._dataContainer;a=i.colIndex;y=i.rowIndex;h=u._cellProp;it=p.sheets[v];y in it?(k=it[y],a in k?o=k[a]:k[a]=o={}):(k=it[y]={},k[a]=o={});l&&(u._hasClass(l,"e-sswraptext")&&(u._removeClass(l,"e-sswraptext"),u.addClass(l,"e-sswraptext")),this.getPropertyValue(i.rowIndex,i.colIndex,"wrap",v)&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge",v)&&(w=g.find("#"+u._id+"_MergeWrap")[0],w&&(b=w.lastChild,b?b.nodeType===1?(u._hasClass(b,"e-hyperlinks")&&(b.textContent=""),u._hasClass(b,"e-comment")&&(b.lastChild.textContent="")):b.textContent="":w.textContent="",nt=w.innerHTML,w.remove())));for(e in s){c=s[e];switch(e){case h[0]:case h[4]:case h[5]:case h[11]:f=p.sharedData.indexOf(c);f===-1&&(f=p.sharedData.push(c),f--);o[e]=f;yt._isLoaded&&e===h[0]&&!u._intrnlUpdate&&(vt=!0);break;case h[1]:if(rt=this.getPropertyValue(y,a,"value2",v),s.type&&s.type!=et.General&&s.type!=et.Text?o[e]=s.value2:(f=p.sharedData.indexOf(s.value2),f===-1&&(f=p.sharedData.push(s.value2),f--),o[e]=f),l&&!("cellType"in s)){if(wt=l.getElementsByTagName("a"),wt.length)this._refreshTextNode(l,s.value2);else if(o[h[24]]>-1){if(ct=p.sheetCellType[o[h[24]]],lt=ct.id,n("#"+lt).length===0)return;if(s.value2)switch(ct.type){case"Button":n("#"+lt).ejButton("instance").option("text",s.value2)}}else st=s.value2.toString().length>7&&!isNaN(new Date(s.value2).valueOf()),ht=["true","yes","false","no"].indexOf(s.value2.toString().toLowerCase())>-1,u.model.allowCellType&&u.model.allowAutoCellType&&(st||ht)?st?(u.XLCellType._rangeCellTypes([{type:"DatePicker",range:u._getAlphaRange(v,y,a,y,a)}],v,!0),n("#"+u._dataContainer.sheetCellType[o[h[24]]].id).ejDatePicker("instance").option("value",s.value2)):ht&&(u.XLCellType._rangeCellTypes([{type:"CheckBox",range:u._getAlphaRange(v,y,a,y,a)}],v,!0),n("#"+u._dataContainer.sheetCellType[o[h[24]]].id).ejCheckBox("instance").option("checked",["true","yes"].indexOf(s.value2.toString().toLowerCase())>-1?!0:!1)):this._skipHTML?l.innerHTML.concat(s.value2):this._refreshTextNode(l,s.value2);this._refreshCellAlignment({cellIdx:i,value:s.value,type:s.type})}u.model.allowOverflow&&u._canOverflow?(rt||s.value2)&&(at=t.isNullOrUndefined(rt)?!0:rt.length<=s.value2.length?!0:!1,u._textClip(y,a,at?"add":"delete"),!at&&s.value2.length>0&&u._textClip(y,a,"add")):u._canOverflow&&u.refreshOverflow([y,a,y,a],v);o.isDirty=!0;break;case h[2]:o[e]=p.cellType.indexOf(s.type);break;case h[3]:for(d=0,pt=c.length;d<pt;)f=p.cFormatData.indexOf(c[d]),f===-1&&(f=p.cFormatData.push(c[d]),f--),o[e]?o[e].indexOf(f)===-1&&o[e].push(f):o[e]=[f],d++;break;case h[6]:f=p.valData.indexOf(c.customVal);f===-1&&(f=p.valData.push(c.customVal),f--);o[e]=JSON.parse(JSON.stringify(c));o[e].customVal=f;break;case h[7]:case h[8]:l&&(bt=e===h[8]?"e-border":"e-format",kt=new RegExp("\\b"+bt+".*?\\b","g"),l.className=l.className.replace(kt,""),u.addClass(l,c));f=p.hashCode.indexOf(c);f===-1&&(f=p.hashCode.push(c),f--);o[e]=f;break;case h[9]:case h[10]:case h[26]:o[e]?o[e].indexOf(c)===-1&&o[e].push(c):o[e]=[c];break;case h[12]:o[e]=c;l&&(c===ot.Center?u.addClass(l,u._cAlign):c===ot.Right?u.addClass(l,u._rAlign):n(l).removeClass(u._rAlign+" "+u._cAlign));break;case h[14]:case h[16]:ut=u.XLFormat.getFormatHashCode(c);f=p.hashCode.indexOf(ut);f===-1&&(u.XLFormat._createFormatClass(c,ut),f=p.hashCode.push(ut),f--);o[e]=f;break;case h[15]:case h[17]:c=u.XLFormat._getBorderHashCode(c,!0);f=p.hashCode.indexOf(c);f===-1&&(f=p.hashCode.push(c),f--);o[e]=f;break;default:o[e]=c}}if(this._updateUsedRange(i.rowIndex,i.colIndex),vt&&(u.model.allowCharts&&u.XLChart._refreshChartElements(y,a,v),u.model.allowConditionalFormats&&u.XLCFormat._refreshCFormatFormula(y,a,v),u._updateBatchDetails(y,a,v),vt=!1),l&&this.getPropertyValue(i.rowIndex,i.colIndex,"wrap",v)&&this.getPropertyValue(i.rowIndex,i.colIndex,"merge",v)&&(cellHeight=yt._wrapColl[i.rowIndex][i.colIndex],u._isRowViewable(v,i.rowIndex)&&(ft=this.getPropertyValue(i.rowIndex,i.colIndex,"value2",v),this._refreshTextNode(l),nt=nt?nt.concat(s.value2||ft):s.value2||ft,w=g.find("#"+u._id+"_MergeWrap")[0],w||(l.innerHTML="<div id ="+u._id+"_MergeWrap style = 'border :0px;overflow: hidden;max-height:"+cellHeight+"px'>"+l.innerHTML.concat(nt||"")+"<\/div>",w=g.find("#"+u._id+"_MergeWrap")[0]),child=w.children,child.length)))for(e=0;e<child.length;e++)u._hasClass(w.children[e],"e-comment")&&(w.children[e].lastChild.textContent=this.getPropertyValue(i.rowIndex,i.colIndex,"comment",v).value),u._hasClass(w.children[e],"e-hyperlinks")&&(w.lastChild.textContent="",w.children[e].textContent=this.getPropertyValue(i.rowIndex,i.colIndex,"value2",v));(Object.keys?Object.keys(o).length:u.getObjectLength(o))===3&&(tt=u.getRangeData({range:[y,a,y,a],property:h.slice(0,3)})[0],tt.value===""&&tt.value2===""&&tt.type===t.Spreadsheet.CellType.General&&u.clearRangeData([y,a,y,a],h.slice(0,3)));!yt._isLoaded||u.isDirty||u._intrnlReq||u.isImport||(u.isDirty=!0)}else l&&this._refreshTextNode(l)},_clearDataContainer:function(i){var y,u,p,o,l,d,a,w,b,g=!1,e=this.XLObj,c=e._getSheetIndex(i.sheetIdx),s=e._cellProp,r=i.cellIdx.rowIndex,f=i.cellIdx.colIndex,k=i.property||[],nt=!1,tt,v,it=e._dataContainer,h=it.sheets[c];if(k.length&&r in h&&f in h[r]){for(a=h[r][f],y=k.length,!i.skipCell&&e._isRowViewable(c,r)&&(u=e.getCell(r,f,c));y--;){value=null;b=!1;o=k[y];switch(o){case s[0]:value=this.getPropertyValue(r,f,o,c);e.model.allowCharts&&e.XLChart._refreshChartElements(r,f,c);e._updateBatchDetails(r,f,c);b=!0;break;case s[1]:d=this.getPropertyValue(r,f,"value2");u&&this._refreshTextNode(u[0]);d&&(g=!0);break;case s[3]:value=this.getPropertyValue(r,f,o,c);value&&u&&n(u).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");break;case s[7]:case s[8]:value=this.getPropertyValue(r,f,o,c);value&&u&&e._removeClass(u[0],value);break;case s[14]:value=this.getPropertyValue(r,f,o,c);value&&value["text-align"]&&value["text-align"]==="right"&&u&&e._removeClass(u[0],"e-rightalign");break;case s[12]:value=a[o];value&&u&&e._removeClass(u[0],value===t.Spreadsheet.Align.Center?e._cAlign:e._rAlign);break;case s[13]:if(value=a[o],value&&u){if(w=u[0].lastChild.textContent,i.status==="clear-content"){u[0].lastChild.textContent="";break}else if(i.status==="clear-format"){p=u.find("a");e._hasClass(p[0],"e-hyperlinks")&&p.css({color:"#444445","text-decoration":"none"}).removeClass("e-hyperlinks");break}u.find("a").remove();t.isNullOrUndefined(u[0].lastChild)?u[0].textContent=w:u[0].lastChild.textContent=w}break;case s[18]:value=a[o];value&&u&&(u.removeClass("e-filterhdr"),u.find(".e-filterspan").remove());break;case s[21]:e.XLComment&&e.XLComment.deleteComment([r,f,r,f]);break;case s[5]:case s[22]:case s[23]:nt||(value=this.getPropertyValue(r,f),v={decimalPlaces:0,thousandSeparator:!1,formatStr:"",type:"general",value:value},v.value2=tt=e.XLFormat._getFormattedValue(r,f,v,value),e.XLEdit._updateDataContainer({rowIndex:r,colIndex:f},{dataObj:v}),nt=!0);break;case s[25]:delete h[r][f][o]}i.status==="clear-content"&&o==="hyperlink"?this.getPropertyValue(r,f,o,c)&&(delete h[r][f][o].webAddr,delete h[r][f][o].cellAddr):delete h[r][f][o];o==="wrap"&&u&&(l=u.find("#"+e._id+"_MergeWrap"),l.length&&(u[0].innerHTML=l[0].innerHTML,l.remove()));b&&this._refreshCalcEngine(r,f,!1,value)}g&&e._textClip(r,f,"delete");e.getObjectLength(h[r][f])||delete h[r][f];e.getObjectLength(h[r])||delete h[r]}},getPropertyValue:function(i,r,u,f){var e,o,s,l,y,p,h=this.XLObj,c=h._dataContainer,a=c.sheets,v=h._cellProp;if(f=h._getSheetIndex(f),h._intrnlUpdate||this._refreshContainer(i,f),a[f]&&a[f][i]&&a[f][i][r]&&(o=a[f][i][r],o)){u=u||"value";s=o[u];switch(u){case"value":case"range":case"thousandSeparator":case"calcValue":e=c.sharedData[s];break;case"format":case"border":e=c.hashCode[s];break;case"value2":p=t.Spreadsheet.CellType;e=!h.isUndefined(o.type)&&[p.General,p.Text].indexOf(c.cellType[o.type])===-1?o.value2:c.sharedData[o.value2];break;case"type":e=c.cellType[o.type];break;case"cFormatRule":for(l=y=0,e=[],h.isUndefined(s)||(y=s.length);l<y;)o[u][l]in c.cFormatData&&e.push(c.cFormatData[o[u][l]]),l++;break;case"rule":h.isUndefined(s)||(e={},n.extend(!0,e,s),e.customVal=c.valData[e.customVal]);break;case v[14]:case v[15]:case v[16]:case v[17]:h.isUndefined(s)||(e=c.hashCode[s],e=e.indexOf("e-format")===-1?h.XLFormat.getBorderFromHashCode(e,!0):h.XLFormat.getFormatFromHashCode(e));break;default:e=s}}return e},_refreshContainer:function(n,t){var r,i=this.XLObj,u=i.getSheet(t);!u._isImported&&u._hasDataSrc&&(i._intrnlUpdate=!0,i.model.scrollSettings.allowVirtualScrolling?(r=i._getBlockInfo(n,t,!0),u._virtualDataMngrLoadedBlks.indexOf(r.orgIdx)===-1&&(u._virtualDataMngrLoadedBlks.push(r.orgIdx),this._ensureDataMngr(r.orgRange,t)),u._virtualDataLoadedBlks.indexOf(r.orgIdx)===-1&&(u._virtualDataLoadedBlks.push(r.orgIdx),i._canOverflow=!1,i._refreshDataSrc(r.orgRange,t),i._refreshCellData(r.orgRange,t),i._canOverflow=!0,i._refreshOverflow(r.orgRange))):u._isLoaded||u._isDataMoved||(u._isDataMoved=!0,i._canOverflow=!1,i._refreshDataSrc(null,t),i._refreshCellData(null,t),i._canOverflow=!0,i._refreshOverflow()),i._intrnlUpdate=!1)},_ensureDataMngr:function(n,i){var e,u,r,o=0,h=this.XLObj,s=h.getDataSettings(i),c,f;if(s)for(c=s.length;o<c;)r=s[o],h._inRow(r.range,n[0])&&r._dataManager&&(u=this._getQueryPropWithValues(n.slice(0),r.range),f=t.pvt.filterQueries(r.query.queries,"onSkip"),e=u.skip||0,r._skip&&(e+=r._skip),e&&(f.length?f[0].e.nos=e:r.query.skip(e)),f=t.pvt.filterQueries(r.query.queries,"onTake"),u.take&&(f.length?f[0].e.nos=u.take:r.query.take(u.take)),r._dataManager.dataSource.async=!1,promise=r._dataManager.executeQuery(r.query),promise.done(function(n){if(len=n.result.length,len)for(k=0;k<len;)r._jsonData[u.skip+k]=n.result[k],k++}),r._dataManager.dataSource.async=!0),o++},_getQueryPropWithValues:function(n,t){var i,r={},u=this.XLObj;return i=n[0]-t[0],r.skip=i,t[2]<n[2]&&(n[2]=t[2]),u._inRow(t,n[2])&&(i=n[2]-n[0]+1,r.take=i),r},getPropertyValueByElem:function(n,i,r){if(!t.isNullOrUndefined(n[0])){var u;return u=n.hasClass("e-hyperlinks")?this.XLObj._getCellIdx(n.parent()[0]):this.XLObj._getCellIdx(n[0]),this.getPropertyValue(u.rowIndex,u.colIndex,i,r)}},_getPropWithCellIdx:function(n,t,i,r){for(var f,o=[],u=n[0],h=n[2],c=n[3],e=this.XLObj,i=e._getSheetIndex(i),s=e._dataContainer.sheets[i];u<=h;){if(s[u])for(minc=n[1];minc<=c;)s[u][minc]&&(f=this.getPropertyValue(u,minc,t,i),e.isUndefined(f)||(r?e.isFormula(f)&&o.push({rowIdx:u,colIdx:minc,value:f}):o.push({rowIdx:u,colIdx:minc,value:f}))),minc++;u++}return o},_refreshCalcEngine:function(n,i,r,u,f){var l,h,e,s=this.XLObj,f=s._getSheetIndex(f),c=s.getSheet(f),o=s._calcEngine;r?(u=this._parseSheetRef(u),l=new ValueChangedArgs(n+1,i+1,u),o.valueChanged(c.sheetInfo.value,l),s._applyFormula(f,n,i)):(h=CalcEngine.getSheetFamilyItem(c.sheetInfo.value),e=RangeInfo.getAlphaLabel(i+1)+(n+1),o.isSheetMember()&&!t.isNullOrUndefined(h.parentObjectToToken)&&(e=h.parentObjectToToken.getItem(c.sheetInfo.value)+e),o.getFormulaInfoTable().containsKey(e)&&(o.getFormulaInfoTable().remove(e),o.getDependentCells().contains(e)&&o.clearFormulaDependentCells(e)),o.refresh(e))},_parseSheetRef:function(n,t){for(var u,i=0,f=this.XLObj,h=f.model.sheetCount,e=[],s=[],r=f._getSheetNames(),o='(?=[\'!])(?=[^"]*(?:"[^"]*"[^"]*)*$)';i<r.length;)s.push(r[i].text),i++;for(i=0;i<h;i++)r[i].value!==r[i].text&&(u=new RegExp(r[i].text+o,"gi"),n.match(u)&&(n=n.replace(u,i+"/"),e.push(i)),s.indexOf(r[i].value)<0&&n.indexOf(r[i].value)>-1&&!t&&(u=new RegExp(r[i].value+o,"gi"),n.match(u)&&(n=n.replace(u,f._newSIndex+"/"),e.push(f._newSIndex))));for(i=0;i<e.length;)u=new RegExp(e[i]+"/"+o,"gi"),n=n.replace(u,e[i]===f._newSIndex?f._generateSheetName(f._newSIndex):r[e[i]].value),i++;return n},_refreshTextNode:function(n,i){var u=this.XLObj,r;i=t.isNullOrUndefined(i)?"":i;u.isUndefined(n)||(r=n.lastChild,r&&(r.nodeType===3||r.nodeType===1&&r.tagName==="A")?u._browserDetails.name==="msie"&&u._browserDetails.version==="8.0"?r.nodeValue=i:r.textContent=i:n.appendChild(document.createTextNode(i)))},_formulaSelect:function(n){var t=value=n.text;this.XLEdit._isNamedRange(value)||t.slice(1)=="TRUE"||t.slice(1)=="FALSE"||(t+="(");this.XLEdit._editElem.text(t);this.model.allowFormulaBar&&this._getInputBox().val(t);this.XLEdit._editElem.focusEnd();this._isFormulaSuggestion=!1;this.XLCellNav._canKeyBoardNavigate=!1},_isNamedRange:function(n){var i=this.XLObj.model.nameManager,t=i.length;if(n=n.slice(1),t)while(t--)if(i[t].name.toUpperCase()===n.toUpperCase())return!0;return!1},_formulaBoxInputChange:function(n){var r=this.getActiveSheetIndex(),t=this.getSheet(r)._activeCell,i=this.element.find("#"+this._id+"_Edit");this.XLEdit._isFormulaEdit=!n.target.value.indexOf("=");this.XLEdit._isFormulaEdit&&this.XLEdit._processFormulaEditRange(n.target.value,!0);this.XLEdit._isEdit||(this.XLCellNav._navToCell(t.rowIndex,t.colIndex),this.XLEdit.editCell(t.rowIndex,t.colIndex,!0),i=this.element.find("#"+this._id+"_Edit"));i.text(n.target.value);n.target.focus();this.XLEdit._isCellEdit=!1},_formulaSuggestionStatus:function(n){this._isFormulaSuggestion=n.type==="open"},_updateFormulaCellRange:function(n,t){var u,r=this.XLObj,f=r.element.find("#"+r._id+"_Edit").not(":hidden"),i=f.text(),e=i[i.length-1];t&&this._validCharacters.indexOf(e)===-1?i=i+",":(u=this._getCharPosition(i),u>-1&&(i=i.substr(0,[u+1])));n=i+n;f.text(n);this._editElem.focusEnd();r.model.allowFormulaBar&&r._getInputBox().val(n)},_getCharPosition:function(n){for(var t=n.length;t--;)if(this._validCharacters.indexOf(n[t])>-1)return t;return-1},_processFormulaEditRange:function(t,i){var u,e,f=0,r=this.XLObj,o=r.XLDragFill._parseFormula(t),s=o.length;for(r._ctrlKeyCount=0,r._formulaRange=[],r.XLSelection._clearBorder(r._arrayAsString(r._ctrlFormulaBorder.concat(r._formulaBorder)));f<s;){if(u=o[f],this._invalidOperators.indexOf(u)>-1)break;r._isCellReference(u)&&(u=u.replace(/\$/g,""),o[f+1]===":"&&(f++,r._isCellReference(o[f+1])&&(u=u+":"+o[f+1],f++)),this._updateFormulaEditRange(u,r._ctrlKeyCount),r._ctrlKeyCount++);f++}e=t.charAt(t.length-1);e==="("&&t.split("(").length===2?(r._isFormulaSuggestion=!1,r.model.allowFormulaBar&&r._getInputBox().val(t),i?n("#"+r._id+"_inputbox_suggestion").hide():r._getFormulaSuggElem().hide()):e===")"&&r.isFormula(t)&&(r.XLEdit._isFormulaEdit=!1,r._formulaRange=[],r._ctrlKeyCount=0);e===":"?(r._shiftKeyEnabled=!0,r._ctrlKeyCount--):this._validOperators.indexOf(e)>-1&&(r._dStartCell=r.getSheet(r.getActiveSheetIndex())._activeCell,r._shiftKeyEnabled=!1)},_updateFormulaEditRange:function(n,t){var i=this.XLObj,r=i.getRangeIndices(n);i._formulaRange[t]=n;i._dStartCell={rowIndex:r[0],colIndex:r[1]};i._dEndCell={rowIndex:r[2],colIndex:r[3]};i.XLSelection._focusBorder(i._dStartCell,i._dEndCell,i._formulaBorder[t%6])},calcOption:function(t){var i=this.XLObj,u,f,e,r,o;if(!i.model.isReadOnly){for(e=i.getActiveSheetIndex(),t?(n("#"+i._id+"_CalcAuto").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcManual").find("span").removeClass("e-ss-calcauto")):(n("#"+i._id+"_CalcManual").find("span").addClass("e-ss-calcauto"),n("#"+i._id+"_CalcAuto").find("span").removeClass("e-ss-calcauto")),r=1,o=i._sheets.length;r<o;r++)u=i._calcEngine,t?(u.setCalculatingSuspended(!1),f=i.getSheet(r).usedRange,i.setActiveSheetIndex(r),u.grid=i.model.sheets[r].sheetInfo.value,u.refreshRange(RangeInfo.cells(1,1,f.rowIndex+1,f.colIndex+1))):u.setCalculatingSuspended(!0);i.setActiveSheetIndex(e)}},calcNow:function(n){var t=this.XLObj;if(!t.model.isReadOnly){var i=1,r,u,f=t._sheets.length,e=t.getActiveSheetIndex(),o;for(n&&(i=n,f=n+1);i<f;)r=t._calcEngine,r.setCalculatingSuspended(!1),u=t.getSheet(i).usedRange,t.setActiveSheetIndex(i),r.grid=t.model.sheets[i].sheetInfo.value,r.refreshRange(RangeInfo.cells(1,1,u.rowIndex+1,u.colIndex+1)),r.setCalculatingSuspended(!0),i++;t.setActiveSheetIndex(e);o={sheetIndex:e,reqType:"calc-now"};t._completeAction(o)}},_rangeHasProperty:function(n,t,i){n&&(i=this.XLObj.getRangeData({range:n,property:[t]}));for(var r=0,u=i.length;r<u;){if(!this.XLObj.isUndefined(i[r][t]))return!0;r++}},saveEditingValue:function(){var c=this.XLObj;if(!c.model.isReadOnly){var r,u,t,f,n,i,l,a,e,o={},s,v,y,p=c._dataContainer,h;for(f=Object.getOwnPropertyNames(p.sheets),o.EditedData=[],t=0,l=f.length;t<l;t++)for(conSheet=p.sheets[f[t]],e=Object.getOwnPropertyNames(conSheet),r=0,v=e.length;r<v;r++)for(n=parseInt(e[r]),s=Object.getOwnPropertyNames(conSheet[n]),u=0,y=s.length;u<y;u++)i=parseInt(s[u]),conSheet[n][i].isDirty&&(h=parseInt(f[t]),a={SheetIndex:h,Value:this.getPropertyValue(n,i,"value2",h),CellIndex:{RowIndex:n,ColIndex:i}},delete conSheet[n][i].isDirty,o.EditedData.push(a));return o}}};n.fn.focusEnd=function(){var r;n(this).focus();var u=n("<span />").appendTo(n(this)),f=u.get(0),t=null,i=null;return document.selection?(t=document.body.createTextRange(),t.moveToElementText(f),t.select()):window.getSelection&&(r=this[0],t=document.createRange(),i=window.getSelection(),t.setStart(r,1),t.collapse(!0),i.removeAllRanges(),i.addRange(t),r.focus()),u.remove(),this};n.fn.altEnter=function(){var n,t,i,u,f,e,r;n=window.getSelection();t=n.anchorNode;i=n.anchorOffset;u=t.textContent;f=u.slice(0,i);e=u.slice(i)||" ";t.textContent=f+"\n"+e;r=document.createRange();r.setStart(t,i+1);r.setEnd(t,i+1);n.removeAllRanges();n.addRange(r)};n.fn.setCursorPosition=function(n){var u=this,t,i,r;u.focus();t=u[0].firstChild;i=document.createRange();t&&(i.setStart(t,n),i.setEnd(t,n));r=window.getSelection();r.removeAllRanges();r.addRange(i)}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.validation=function(n){this.XLObj=n;this._ruleSymbols={Greater:">",GreaterOrEqual:">=",Less:"<",LessOrEqual:"<=",Equal:"==",NotEqual:"!=",Between:">=&&<=&&=",NotBetween:">=&&<=&&!"};this._isErrorVisible=!1};t.spreadsheetFeatures.validation.prototype={_setValidation:function(){this.XLObj.model.allowDataValidation&&n.validator&&(this._initValidator(),this._setValidationToField())},_initValidator:function(){var i=n("#"+this.XLObj._id+"EditForm");t.isOnWebForms&&n.data(i[0],"validator",null);i.validate({errorClass:"e-field-validation-error",errorElement:"div",wrapper:"div",errorPlacement:function(i,r){var u=n("#"+n(r).data("id")).data("ejSpreadsheet"),o=u._getJSSheetContent(u.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content"),f=u.XLEdit._editCell,e=n(i).addClass("e-error");o.append(e);e.prepend(t.buildTag("div.e-errortail e-toparrow"));e.css({left:f[0].offsetLeft,top:f[0].offsetTop+f.height()});u.XLValidate._isErrorVisible=!0}})},_setValidationToField:function(){var n=this.XLObj,i=n.XLEdit.getPropertyValueByElem(n.getActiveCellElem(),"rule"),r;delete i.type;delete i.isApply;delete i.isHighlight;n.element.find("#"+n._id+"_ValElem").rules("add",i);r=n.element.find("#"+n._id+"EditForm").validate();t.isNullOrUndefined(i.required)||(r.settings.messages[name]={},r.settings.messages[name].required=n.XLEdit._EditCellDetails.fieldName+(n.XLEdit._EditCellDetails.rowIndex+1)+" is required");n.XLEdit._isValidation=!0},applyDVRules:function(n,r,u,f,e){var y,l,h={},o=this.XLObj,c=o.getActiveSheetIndex(),p=o.getSheet(c),w=!1,b,s,k,d,g,nt,v,a;switch(u){case"decimal":if(parseFloat(r[1])>parseFloat(r[2])){o._showAlertDlg("Alert","NumberValidationAlert","",400);return}break;case"date":if(new Date(r[1])>new Date(r[2])){o._showAlertDlg("Alert","DateValidationAlert","",400);return}break;case"time":if(d=Date.parse("01/01/1990 "+r[1]),g=Date.parse("01/01/1990 "+r[2]),r[2]&&r[2].length&&d>g){o._showAlertDlg("Alert","TimeValidationAlert","",400);return}break;default:if(parseInt(r[1])>parseInt(r[2])){o._showAlertDlg("Alert","NumberValidationAlert","",400);return}}if(!o.model.isReadOnly&&o.model.allowDataValidation&&(o.model.allowSelection||!t.isNullOrUndefined(n))){b=o._getRangeArgs(n,"object");s=o._getSelectedCells(c,b).selCells;o._showDialog(o._id+"_Ribbon_Data_DataTools_DataValidation");h.required=!f;(r[0]!="Between"||r[0]!="NotBetween")&&r.length<3&&r.push("");switch(u){case"number":r.push("parseInt");h.digits=!0;r.push("number");break;case"decimal":r.push("parseFloat");h.number=!0;r.push("decimal");break;case"date":r.push("parseDate");h.date=!0;r.push("date");break;case"time":r.push("parseTime");r.push("time");break;case"text":r[1]="^"+r[1];r[2]="^"+r[2];r.push("length");r.push("text");break;case"list":nt=r[1];r=[];r.push(nt);r.push("list")}for(r.push(e),r.push(n?n:o._getSelectedItems(c,n)[1]),r.push(c),h.customVal=r.join("_"),h.isApply=!1,h.type=u,v=[],a={},i=0,len=s.length;i<len;i++)a={rowIndex:s[i].rowIndex,colIndex:s[i].colIndex,prevRule:o.XLEdit.getPropertyValue(s[i].rowIndex,s[i].colIndex,"rule")},o._isRowViewable(c,s[i].rowIndex)&&(l=o.getCell(s[i].rowIndex,s[i].colIndex),l.hasClass("e-hlcell")&&(w=!0),l.removeData("rule"),l.removeClass("e-hlcell")),o.XLEdit._updateDataContainer({rowIndex:s[i].rowIndex,colIndex:s[i].colIndex},{dataObj:{rule:h}}),o.model.actionComplete!==null&&(a.newRule=o.XLEdit.getPropertyValue(s[i].rowIndex,s[i].colIndex,"rule")),v.push(a);w===!0&&this.highlightInvalidData();p._isImported&&!p._isLoaded||o._isUndoRedo||o._isExport||(k=r[2]==""?[r[0],r[1]]:[r[0],r[1],r[2]],y={showErrorAlert:r[5],values:k,required:!h.required,rule:h,sheetIndex:c,reqType:"validation",operation:"apply-validation",selectedCell:v,range:o._getAlphaRange(c,s[0].rowIndex,s[0].colIndex,s[s.length-1].rowIndex,s[s.length-1].colIndex)},o._completeAction(y))}},clearDV:function(n){var i=this.XLObj,o,r,s,f,e,u,h;if(i.model.allowDataValidation&&!i.model.isReadOnly&&i.model.allowSelection){for(f=i.getActiveSheetIndex(),e={sheetIndex:f,reqType:"validation",operation:"clear-validation",selectedCell:[]},s=i._getRangeArgs(n,"object"),r=i._getSelectedCells(f,s).selCells,u=0,h=r.length;u<h;u++)e.selectedCell.push({rowIndex:r[u].rowIndex,colIndex:r[u].colIndex,rules:i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"rule")}),i.clearRangeData([r[u].rowIndex,r[u].colIndex,r[u].rowIndex,r[u].colIndex],["rule"]),i._isRowViewable(f,r[u].rowIndex)&&(o=i.getCell(r[u].rowIndex,r[u].colIndex),t.isNullOrUndefined(i._ddlCell)||(i.element.find("#"+i._id+"ddl").ejDropDownList("hidePopup"),i.element.find("#"+i._id+"ddlspan").remove(),i._ddlCell=null),e.hlStatus=o.hasClass("e-hlcell"),o.removeClass("e-hlcell"));e.range=i._getAlphaRange(f,r[0].rowIndex,r[0].colIndex,r[r.length-1].rowIndex,r[r.length-1].colIndex);i._isUndoRedo||i._dupDetails||i._completeAction(e)}},clearHighlightedValData:function(n){var r=this.XLObj,i,e,o,f,u,s,h;if(r.model.allowDataValidation&&!r.model.isReadOnly){for(f=r.getActiveSheetIndex(),e=r._getRangeArgs(n,"object"),i=r._getSelectedCells(f,e).selCells,u=0,s=i.length;u<s;u++)r._isRowViewable(f,i[u].rowIndex)&&(o=r.getCell(i[u].rowIndex,i[u].colIndex),o.removeClass("e-hlcell")),t.isNullOrUndefined(r.XLEdit.getPropertyValue(i[u].rowIndex,i[u].colIndex,"rule"))||(r._dataContainer.sheets[f][i[u].rowIndex][i[u].colIndex].rule.isApply=!1);r._isUndoRedo||(h={sheetIndex:f,reqType:"validation",operation:"cl-hl-data",range:t.isNullOrUndefined(n)?this.XLObj._getAlphaRange(1,i[0].rowIndex,i[0].colIndex,i[i.length-1].rowIndex,i[i.length-1].colIndex):n},r._completeAction(h))}},_checkValidation:function(n,i,r,u){var f=this.XLObj,v,c,e,l,a,o,s,h;if(u=f._getSheetIndex(u),!JSON.parse(i[i.length-3])&&!r)return!0;if(n=this._convertValueByType(n,i[4]),i[1]=this._convertValueByType(i[1],i[4]),i[2]=this._convertValueByType(i[2],i[4]),n.length){if(i[i.length-4]==="list"){for(a=!1,i[0].indexOf(",")>-1?c=i[0].split(","):i[0].indexOf("=")>-1?(e=i[0].split("=")[1],c=e.indexOf("!")>-1?e.split("!")[1].indexOf("$")>-1?f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("!")[1].split("$").join("")),valueOnly:!0}):e.indexOf("$")>-1?f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("$").join("")),valueOnly:!0}):f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e.split("!")[1]),valueOnly:!0}):f.getRangeData({sheetIdx:u,range:f.getRangeIndices(e),valueOnly:!0})):c=n,l=0,v=c.length;l<v;l++)if(a=c[l].toString()===n,a)break;return t.Spreadsheet.msg=f._getLocStr("ListAlertMsg"),a}return i[0]=this._ruleSymbols[i[0]],i[1].indexOf("=")>-1&&(o=i[1].replace("=",""),s=this.getRangeIndices(o+":"+o),i[1]=f.XLEdit.getPropertyValue(s[0],s[1],null,u).toString()),i[2].indexOf("=")>-1&&(o=i[2].replace("=",""),s=this.getRangeIndices(o+":"+o),i[2]=f.XLEdit.getPropertyValue(s[0],s[1],null,u).toString()),i[0].length<=2?(t.Spreadsheet.msg="The "+i[4]+" should be "+t.Spreadsheet.ValidationText[i[0]]+" "+i[1].replace("^",""),f.operators[i[0]](f.parse[i[3]](n),f.parse[i[3]](i[1]))):(h=[],h=i[0].split("&&"),t.Spreadsheet.msg="The "+i[4]+" should"+t.Spreadsheet.ValidationText[h[2]]+" be between "+i[1].replace("^","")+" and "+i[2].replace("^",""),f.operators[h[2]](f.operators[h[0]](f.parse[i[3]](n),f.parse[i[3]](i[1]))&&f.operators[h[1]](f.parse[i[3]](n),f.parse[i[3]](i[2]))))}return!0},_convertValueByType:function(t,i){if(t.length){var r=this.XLObj;switch(i){case"number":case"decimal":r._isValidDate(t)&&(t=r._dateToInt(t));break;case"date":n.isNumeric(t)&&(t=r.intToDate(t).toString())}}return t},highlightInvalidData:function(n){var u=this.XLObj,c,l,r,h,s,i,o,f,e,a;if(u.model.allowDataValidation&&!u.model.isReadOnly){for(f=u.getActiveSheetIndex(),o=u._getRangeArgs(n,"object"),r=u._getSelectedCells(f,o).selCells,n=u._getAlphaRange(f,o[0],o[1],o[2],o[3]),i=0,c=r.length;i<c;i++)(e=u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"rule",f),e)&&(u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,null,f)&&!t.isNullOrUndefined(e)?(l=u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"type",f)==="datetime"||u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"type",f)==="time"?u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,"value2",f).toString():u.XLEdit.getPropertyValue(r[i].rowIndex,r[i].colIndex,null,f).toString(),s=e?!this._checkValidation(l,e.customVal.split("_"),!0,f):!1,u._dataContainer.sheets[f][r[i].rowIndex][r[i].colIndex].rule.isApply=s):t.isNullOrUndefined(e)||(s=e.required),u._isRowViewable(f,r[i].rowIndex)&&(h=u.getCell(r[i].rowIndex,r[i].colIndex,f),s?h.addClass("e-hlcell"):h.removeClass("e-hlcell")),u.XLEdit._updateDataContainer({rowIndex:r[i].rowIndex,colIndex:r[i].colIndex},{dataObj:{isHighlight:!0},sheetIdx:f}));u._isUndoRedo||(a={sheetIndex:f,reqType:"validation",operation:"hl-data",range:n},u._completeAction(a))}},_replaceRule:function(n,t){this.XLObj._dataContainer.cFormatData[n]=t},_addDVMethod:function(){t.isNullOrUndefined(n.validator)||n.validator.addMethod("customVal",function(t,i,r){var u=n("#"+n(i).data("id")).data("ejSpreadsheet"),f=u._getJSSheetContent(u.getActiveSheetIndex()).find(".e-spreadsheetcontentcontainer > .e-content");return(f.find(".e-error").remove(),u.model.showRibbon&&n("#"+u._id+"_Ribbon_freetext").length&&!n("#"+u._id+"_Ribbon_freetext").data("ejCheckBox").isChecked())?!0:u.XLValidate._checkValidation(t,r.split("_"))},t.Spreadsheet.getMsg)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragFill=function(n){this.XLObj=n;this._customList=[["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]];this._property=["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","format","rule"];this._fillInfo=null;this._verticalFill=!1;this._uniqueOBracket=String.fromCharCode(129);this._uniqueCBracket=String.fromCharCode(130);this._uniqueCSeparator=String.fromCharCode(131);this._uniqueCOperator=String.fromCharCode(132);this._uniquePOperator=String.fromCharCode(133);this._uniqueSOperator=String.fromCharCode(134);this._uniqueMOperator=String.fromCharCode(135);this._uniqueDOperator=String.fromCharCode(136);this._uniqueModOperator=String.fromCharCode(137)};t.spreadsheetFeatures.dragFill.prototype={positionAutoFillElement:function(n){var l,r,u,f,s,t,e=0,o=0,a=0,h=0,v=0,c=0,i=this.XLObj,y="e-hide";if(i.model.allowAutoFill&&i.model.allowSelection){if(s=i.getActiveSheetIndex(),t=i.getSheet(s),t._isRowSelected)a=-3,h=-1,v=5,c=4,r=t.selectedRange[2],u=t.selectedRange[1],o=i._isFrozen(t.frozenColumns)?i._getContent(s).find(".e-content").scrollLeft():t._scrollLeft;else if(t._isColSelected)h=-3,c=5,r=t.selectedRange[0],u=t.selectedRange[3],e=i._isFrozen(t.frozenRows)?i._getContent(s).find(".e-content").scrollTop():t._scrollTop;else{if(t._isSheetSelected){this.hideAutoFillElement();return}a=-3;h=-3;v=1;c=3;r=t.selectedRange[2];u=t.selectedRange[3]}l=i._getMergedIdx(r,u);r=l.rowIndex;u=l.colIndex;f=i._getCellInfo({rowIndex:r,colIndex:u});t._isColSelected||(e+=f.height);t._isRowSelected||(o+=f.width);e+=f.top;o+=f.left;i.getAutoFillElem()&&i.getAutoFillElem().removeClass(y).css({top:Math.round(e)+a,left:Math.round(o)+h});i.model.autoFillSettings.showFillOptions&&n&&i.model.allowEditing&&!i.model.isReadOnly&&i._getAutoFillOptElem().removeClass(y).css({top:e+v,left:o+c});t._autoFillCell=i._dautoFillCell={rowIndex:r,colIndex:u}}},hideAutoFillElement:function(){var n=this.XLObj.getAutoFillElem();n&&n.addClass("e-hide")},hideAutoFillOptions:function(){var n=this.XLObj._getAutoFillOptElem();n&&(n.find("button").data("ejSplitButton")._hidePopup(),n.addClass("e-hide"))},autoFill:function(n){var i=this.XLObj;if(n=n||{},i.model.allowAutoFill&&n.dataRange&&n.fillRange&&n.direction&&i.model.allowEditing&&!i.model.isReadOnly){var r,f=i.getActiveSheetIndex(),e=i.getSheet(f),u=t.Spreadsheet.AutoFillOptions;if(this._fillInfo=this._getFillInfo(n),n.fillType=n.fillType||this._fillInfo.fillType,this._verticalFill=n.direction==="down"||n.direction==="up",n.sheetIdx=f,n.dataRange=i._toIntrnlRange(n.dataRange,f),n.fillRange=i._toIntrnlRange(n.fillRange,f),r={sheetIndex:n.sheetIdx,reqType:"auto-fill",direction:n.direction,range:n.fillRange,bRange:n.dataRange,bData:i.getRangeData({range:n.fillRange}),bFormat:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(n.fillRange)},r.rowSel=e._isRowSelected,r.colSel=e._isColSelected,!i._trigger("autoFillBegin",n)){switch(n.fillType){case u.FillSeries:case u.FillWithoutFormatting:this._fillSeries(n);break;case u.CopyCells:case u.FillFormattingOnly:this._copyCells(n);break;case u.FlashFill:r.actionType="flash-fill";r.bdData=i.getRangeData({range:n.dataRange});this._flashFill(n);r.adData=i.getRangeData({range:n.dataRange})}r.aData=i.getRangeData({range:n.fillRange});i.model.allowCellFormatting&&(r.aFormat=i.XLFormat.getHashCodeClassAsArray(n.fillRange));n.isKeyFill||this.positionAutoFillElement(!0);i._completeAction(r);i._trigger("autoFillComplete",n)}}},_updateFillValues:function(n,t,i,r,u,f,e,o,s,h){var c,l,a,v;return n?(c={rowIndex:t,colIndex:i+h},l={rowIndex:r,colIndex:i+h},a={rowIndex:f,colIndex:e+h},v={rowIndex:o,colIndex:e+h}):(c={rowIndex:t+h,colIndex:i},l={rowIndex:t+h,colIndex:u},a={rowIndex:f+h,colIndex:e},v={rowIndex:f+h,colIndex:s}),patrnRange=[c.rowIndex,c.colIndex,l.rowIndex,l.colIndex],fillRange=[a.rowIndex,a.colIndex,v.rowIndex,v.colIndex],{patrnRange:patrnRange,fillRange:fillRange}},_fillSeries:function(n){for(var u,ot,o,i,rt,k,h,v,s,st,c,d,g,ht,l,ut,y,ft,p,ct,f,e,et=0,w={},r=this.XLObj,nt=t.Spreadsheet.autoFillDirection,tt=t.Spreadsheet.CellType,lt=n.dataRange[0],at=n.dataRange[1],vt=n.dataRange[2],yt=n.dataRange[3],pt=n.fillRange[0],wt=n.fillRange[1],bt=n.fillRange[2],kt=n.fillRange[3],it=[nt.Down,nt.Up].indexOf(n.direction)>-1,b=[nt.Up,nt.Left].indexOf(n.direction)>-1,dt=it?yt-at:vt-lt,a=n.fillType===t.Spreadsheet.AutoFillOptions.FillSeries;et<=dt;){if(rt=this._updateFillValues(it,lt,at,vt,yt,pt,wt,bt,kt,et),k=rt.patrnRange,h=rt.fillRange,o=this._getPattern(k,{isRFill:b,isVFill:it}),v=r.getRangeData({range:k,property:["hyperlink","rule","cFormatRule","type","formatStr","decimalPlaces","wrap"]}),st=v.length,!o)return;for(ot=o.length,r.clearRangeData(h,[a?"formatStr":null,"hyperlink",a?"cFormatRule":null,"rule"]),a&&(r.model.allowCellFormatting&&r.XLFormat.removeStyle(h),y=r.getRangeData({range:k,property:["format","formats"]})),p=r._getSelectedRange({rowIndex:h[0],colIndex:h[1]},{rowIndex:h[2],colIndex:h[3]}),ct=p.length,b&&(p=p.reverse(),o=o.reverse(),o=this._ensurePattern(o),v=v.reverse(),a&&(y=y.reverse())),c=0;c<ct;){w={};f=p[c];i=o[c%ot];r.isNumber(i)&&(i=o[i]);switch(i.type){case tt.Number:u=r._round(i.regVal.a+i.regVal.b*i.i,5);b?i.i--:i.i++;break;case tt.String:u=i.val[i.i%i.val.length];i.i++;break;case tt.Formula:for(ut=!1,u="=",d=0,ht=i.val.length;d<ht;)s=i.val[d],r._isObject(s)?(ut=!0,l=r._round(s.a+s.b*i.i,0),u+=l<1?"#REF!":it?s.c+(s.b?l:"$"+l):(s.b?r._generateHeaderText(l):"$"+r._generateHeaderText(l))+s.c):u+=s,d++;ut&&b?i.i--:i.i++;break;case tt.Custom:u=r._round(i.regVal.a+i.regVal.b*i.i,0);u<0&&(u=u%i.len+i.len);u>=i.len&&(u=u%i.len);u=i.val[u];b?i.i--:i.i++}g=c%st;e=v[g];r.XLEdit._updateCellValue(f,u,a?y[g].format:null);a&&(r.model.allowCellFormatting&&e.type&&e.type!="general"&&this._updateNFormat(e,f.rowIndex,f.colIndex),r.model.allowConditionalFormats&&e.cFormatRule&&this._updateCFormat(f,e.cFormatRule),ft=y[g].formats,ft&&(w.formats=ft));r.model.allowHyperlink&&e.hyperlink&&this._updateHyperlinkTag(e.hyperlink,f);r.model.allowDataValidation&&e.rule&&(w.rule=e.rule);r.getObjectLength(w)&&r.XLEdit._updateDataContainer(f,{dataObj:w});r.model.allowWrap&&e.wrap&&r.setWrapText("wrap",[f.rowIndex,f.colIndex,f.rowIndex,f.colIndex]);c++}et++}},_copyCells:function(n){for(var e,s,p,r,k,l,d,h,a,v,g,w,u,f,o={},i=this.XLObj,vt=i.getActiveSheetIndex(),nt=0,b=t.Spreadsheet.autoFillDirection,it=n.dataRange[0],rt=n.dataRange[1],ut=n.dataRange[2],ft=n.dataRange[3],ot=n.fillRange[0],st=n.fillRange[1],ht=n.fillRange[2],ct=n.fillRange[3],et=[b.Down,b.Up].indexOf(n.direction)>-1,lt=[b.Up,b.Left].indexOf(n.direction)>-1,at=et?ft-rt:ut-it,tt=n.fillType===t.Spreadsheet.AutoFillOptions.FillFormattingOnly,c,y;nt<=at;){if(k=this._updateFillValues(et,it,rt,ut,ft,ot,st,ht,ct,nt),p=k.patrnRange,r=k.fillRange,i.model.allowCellFormatting)if(r[0]==r[2])for(c=[1];c<=[3];c++)i.XLEdit.getPropertyValue(r[0],c,"tformats")||i.XLEdit.getPropertyValue(r[0],c,"formats")||i.XLFormat.removeStyle([r[0],c,r[2],c]);else for(y=r[0];y<=r[2];y++)i.XLEdit.getPropertyValue(y,r[1],"tformats")||i.XLEdit.getPropertyValue(r[0],c,"formats")||i.XLFormat.removeStyle([y,r[1],y,r[3]]);if(tt?l=i.getRangeData({range:p,property:["cFormatRule","type","decimalPlaces","formatStr"]}):(w=["value","value2","type","formatStr","decimalPlaces","thousandSeparator","hyperlink"],i.model.allowConditionalFormats&&w.push("cFormatRule"),i.model.allowDataValidation&&w.push("rule"),i.clearRangeData(r,w),l=i.getRangeData({range:p,property:["value","hyperlink","rule","cFormatRule","type","decimalPlaces","formatStr"]})),h=i.getRangeData({range:p,property:["format","formats"]}),d=h.length,v=i._getSelectedRange({rowIndex:r[0],colIndex:r[1]},{rowIndex:r[2],colIndex:r[3]}),g=v.length,e=0,lt&&(v=v.reverse(),h=h.reverse(),tt||(l=l.reverse())),tt)while(e<g)o={},s=e%d,f=v[e],u=l[s],i.model.allowCellFormatting&&(i.XLFormat._updateFormatClass(f,h[s].format),this._updateNFormat(u,f.rowIndex,f.colIndex)),a=h[s].formats,a&&(o.formats=a),i.getObjectLength(o)&&i.XLEdit._updateDataContainer(f,{dataObj:o}),i.model.allowConditionalFormats&&u.cFormatRule&&this._updateCFormat(f,u.cFormatRule),e++;else while(e<g)o={},s=e%d,f=v[e],u=l[s],i.XLEdit._updateCellValue(f,u.value,h[s].format),i.model.allowCellFormatting&&u.type&&u.type!="general"&&this._updateNFormat(u,f.rowIndex,f.colIndex),i.model.allowHyperlink&&u.hyperlink&&this._updateHyperlinkTag(u.hyperlink,f),a=h[s].formats,a&&(o.formats=a),i.model.allowDataValidation&&u.rule&&(o.rule=u.rule),i.getObjectLength(o)&&i.XLEdit._updateDataContainer(f,{dataObj:o}),i.model.allowConditionalFormats&&u.cFormatRule&&this._updateCFormat(f,u.cFormatRule),e++;nt++}},_flashFill:function(n){var o,f,e,t=this.XLObj,s=n.dataRange[0],h=n.dataRange[2],i=n.fillRange[0],c=n.fillRange[1],r=n.fillRange[2],l=n.fillRange[3],u=this._getFlashFillPattern(n.dataRange,"left");if(u)for(f=t.getRangeData({range:[i,u.colIndex,r,u.colIndex],valueOnly:!0,skipDateTime:!0}),u.subStr>-1&&(f=this._splitString(f," ",u.subStr)),o=t._getSelectedRange({rowIndex:i,colIndex:c},{rowIndex:r,colIndex:l}),e=o.length;e--;)t.XLEdit._updateCellValue(o[e],f[e]);else i>s&&(i=s),r<h&&(r=h),t._getAutoFillOptElem().addClass("e-hide"),t.updateUniqueData({value:"",value2:"",type:"general"},[i,c,r,l]),t._showAlertDlg("Alert","FlashFillAlert")},_getFlashFillPattern:function(n,i){var u,f,c,y,e,l,r=0,o=-1,a=this.XLObj,s=a.getRangeData({range:n,valueOnly:!0,skipDateTime:!0}),p=s.length,v=n[0],w=t.Spreadsheet.autoFillDirection.Right,h=i===w;if(s.join().replace(/,/g,"").length){for(l=s[0].toString(),r=n[1],r===0&&(h=!0),h?r++:r--;r>-1;)if(f=a.XLEdit.getPropertyValue(v,r),f=a.isUndefined(f)?"":f.toString(),f.length){if(f===l)if(p>1){if(u=this._matchData(v,r,s),u)return u}else return{colIndex:r,subStr:o};for(c=f.split(" "),y=c.length,e=0;e<y;){if(l===c[e])if(o=e,p>1){if(u=this._matchData(v,r,s),u)return o>u.subStr&&(u.subStr=o),u}else return{colIndex:r,subStr:o};e++}h?r++:r--}else break;if(!h)return this._getFlashFillPattern(n,w)}},_matchData:function(n,i,r){for(var u,o=!1,s,f,h,l,e=1,c=-1,a=r.length;e<a;){if(o=!1,s=r[e].toString(),f=this.XLObj.XLEdit.getPropertyValue(n+e,i),f=t.isNullOrUndefined(f)?"":f.toString(),s===f){o=!0;e++;continue}for(h=f.split(" "),l=h.length,u=0;u<l;){if(s===h[u]){c<u&&(c=u);o=!0;break}u++}e++}if(o&&e===a)return{colIndex:i,subStr:c}},_splitString:function(n,t,i){for(var e,u,f=n.length,r;f--;){for(r=i,e=n[f].split(t);r>-1;){if(u=e[r],u)break;r--}n[f]=u}return n},_getPattern:function(n,i){var u,o,s,a,l,v,w,b,h,e,y=0,f=[],k=this.XLObj,c=t.Spreadsheet.CellType,p=this._getDataPattern(n),d=p.length,r;if(p){while(y<d){r=p[y];switch(r.type){case c.Number:for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,e===1&&r.val.push(r.val[0]+1),a=this._getPredictionValue(r.val),s={regVal:a,type:r.type,i:h},f.push(s),u=1;u<e;)f.push(o),u++;break;case c.String:for(o=f.length,s={val:r.val,type:r.type,i:0},f.push(s),u=1,e=r.val.length;u<e;)f.push(o),u++;break;case c.Formula:if(e=r.val.length,r=this._getFormulaPattern(r.val,i),h=i.isRFill?-1:e,r.isInPattern)for(o=f.length,s={val:r.val,type:c.Formula,i:h},f.push(s),u=1;u<e;)f.push(o),u++;else for(u=0,h=i.isRFill?-1:1;u<e;)f.push({val:r.val[u],type:c.Formula,i:h}),u++;break;default:if(r.type.indexOf(c.Custom)>-1)for(o=f.length,e=r.val.length,h=i.isRFill?-1:e,l=this._customList[Number(r.type.replace(c.Custom,""))],b=l.indexOf(r.val[0])===-1,v=k.toArrayLowerCase(l.slice(0)),w=k.toArrayLowerCase(r.val),a=this._getCustomPredictionValue(w,v),s={val:b?v:l,regVal:a,i:h,type:c.Custom,len:l.length},f.push(s),u=1;u<e;)f.push(o),u++}y++}return f}},_getCustomPredictionValue:function(n,t){for(var r=0,i=[],u=n.length;r<u;)i.push(t.indexOf(n[r])),r++;return i.length===1&&i.push(i[0]+1),this._getPredictionValue(i)},_getDataPattern:function(n){var i,r,u=0,t={},f=[],e=this.XLObj.getRangeData({range:n,valueOnly:!0,skipDateTime:!0}),o=e.length;if(o){while(u<o)i=e[u],r=this._getType(i),u===0?t={val:[i],type:r}:r===t.type?t.val.push(i):(f.push(t),t={val:[i],type:r}),u++;return f.push(t),f}},_getFormulaPattern:function(n,t){for(var r,o,f,s,c=this.XLObj,e=[],i=0,h=n.length,u;i<h;)e.push(this._parseFormula(n[i])),i++;if(s=this._isInPattern(e,t.isVFill),s){for(r=e[0],i=r.length;i--;)f=r[i],u=c._isCellReference(f),u&&u!=="absolute"&&(r[i]=this._getCellRefPrediction(f,t,null,u));return{isInPattern:s,val:r}}for(i=0;i<h;){for(r=e[i],o=r.length;o--;)f=r[o],u=c._isCellReference(f),u&&u!=="absolute"&&(e[i][o]=this._getCellRefPrediction(f,t,h,u));i++}return{isInPattern:s,val:e}},_getCellRefPrediction:function(n,t,i,r){n=n.toUpperCase();var f="",s=new RegExp("[a-z$]","gi"),h=new RegExp("[0-9$]","g"),e=t.isVFill?n.replace(h,f):n.replace(s,f),u=t.isVFill?Number(n.replace(s,f)):this.XLObj._generateColCount(n.replace(h,f)),o=[u],c=n[0]==="$";return i&&i!==1?o.push(u+i):o.push(u+1),u=this._getPredictionValue(o),r&&r==="mixed"&&(c===t.isVFill?e="$"+e:u.b=0),u.c=e,u},_isInPattern:function(n,t){var o,i,s,a,r,u,h,c,f=this.XLObj,e="",v=0,l=1,y=n.length,p=new RegExp("[0-9$]","g"),w=new RegExp("[a-z$]","gi");if(y===1)return!1;while(l<y){if(o=n[v],s=n[l],i=o.length,a=s.length,i!==a)return!1;while(i--)if(r=o[i],u=s[i],f._isCellReference(r)===f._isCellReference(u)){if(t?(h=Number(r.replace(w,e)),c=Number(u.replace(w,e))):(h=f._generateColCount(r.replace(p,e)),c=f._generateColCount(u.replace(p,e))),h!==c-1)return!1}else if(r!==u)return!1;v++;l++}return!0},_parseFormula:function(n){var t,i,f,u=0,r=[];for(n=this._markSpecialChar(n.replace("=","")),n=n.split(/\(|\)|,|:|\+|-|\*|\/|%/g),f=n.length;u<f;){if(t=n[u],!t){u++;continue}t.length===1?r.push(this._isUniqueChar(t)?this._getUniqueCharVal(t):t):(i=t[0],t.indexOf("!")>0?(this._isUniqueChar(i)&&(r.push(this._getUniqueCharVal(i)),t=t.substr(1)),i=t.indexOf("!")+1,r.push(t.substr(0,i)),r.push(t.substr(i))):this._isUniqueChar(i)?(r.push(this._getUniqueCharVal(i)),r.push(t.substr(1))):r.push(t));u++}return r},_getUniqueCharVal:function(n){switch(n){case this._uniqueOBracket:return"(";case this._uniqueCBracket:return")";case this._uniqueCSeparator:return",";case this._uniqueCOperator:return":";case this._uniquePOperator:return"+";case this._uniqueSOperator:return"-";case this._uniqueMOperator:return"*";case this._uniqueDOperator:return"/";case this._uniqueModOperator:return"%"}return""},_isUniqueChar:function(n){var t=n.charCodeAt(n);return t>=129&&t<=137},_markSpecialChar:function(n){return n=n.replace(/\(/g,"("+this._uniqueOBracket).replace(/\)/g,")"+this._uniqueCBracket),n=n.replace(/,/g,","+this._uniqueCSeparator).replace(/:/g,":"+this._uniqueCOperator),n=n.replace(/\+/g,"+"+this._uniquePOperator).replace(/-/g,"-"+this._uniqueSOperator),n=n.replace(/\*/g,"*"+this._uniqueMOperator).replace(/\//g,"/"+this._uniqueDOperator),n.replace(/%/g,"%"+this._uniqueModOperator)},_getPredictionValue:function(n){for(var t=0,i=0,u=0,f=0,r=0,e=n.length,o,s;t<e;)i=i+t,u=u+Number(n[t]),f=f+t*Number(n[t]),r=r+t*t,t++;return o=this.XLObj._round((u*r-i*f)/(e*r-i*i),5),s=this.XLObj._round((e*f-i*u)/(e*r-i*i),5),{a:o,b:s}},_getType:function(n){var i=this._isCustomType(n),r=t.Spreadsheet.CellType,u=this.XLObj;return i?i=i:u.isFormula(n)?i=r.Formula:u.isNumber(n)&&(i=r.Number),i||r.String},_isCustomType:function(n){n=n+"";n=n.toLowerCase();for(var i=this._customList.length;i--;)if(this.XLObj.toArrayLowerCase(this._customList[i].slice(0)).indexOf(n)>-1)return t.Spreadsheet.CellType.Custom+i;return!1},_ensurePattern:function(n){for(var i,u=-1,r=n.length;r--;)i=n[r],this.XLObj._isObject(i)?(u=r,i.type===t.Spreadsheet.CellType.String&&(i.val=i.val.reverse())):n[r]=u;return n},_selectAutoFillRange:function(n,t){n&&(t=this.XLObj._getCellIdx(n));var u,f,r=this.XLObj,i=this._getAutoFillRange(t);if(i){for(this._autoFillCleanUp(),f=r.getRange([i.startCell.rowIndex,i.startCell.colIndex,i.endCell.rowIndex,i.endCell.colIndex]),u=f.length;u--;)r.addClass(f[u],"e-autofillcell");r.XLSelection._focusRange(i.startCell,i.endCell,r._autofillBorder);r._dautoFillCell=t}},_getAutoFillRange:function(n){var e=t.Spreadsheet.autoFillDirection,a=this.XLObj,l=a.getSheet(a.getActiveSheetIndex()),y=l._startCell,p=l._endCell,o=l._autoFillCell,h=l.selectedRange,u=h[0],f=h[1],r=h[2],i=h[3],v=a.inRange(h,n.rowIndex,n.colIndex),s={rowIndex:u,colIndex:f},c={rowIndex:r,colIndex:i};if(n.rowIndex<o.rowIndex){if(u-n.rowIndex>n.colIndex-i&&u-n.rowIndex>f-n.colIndex)return v?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i}}:{startCell:c,endCell:{rowIndex:n.rowIndex,colIndex:f},fillRange:[n.rowIndex,f,u-1,i],direction:e.Up};if(n.colIndex>o.colIndex)return{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return v?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left}}else{if(n.colIndex>o.colIndex)return n.rowIndex-r>n.colIndex-i?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:{startCell:s,endCell:{rowIndex:r,colIndex:n.colIndex},fillRange:[u,i+1,r,n.colIndex],direction:e.Right};if(n.colIndex<o.colIndex)return n.rowIndex-r>i-n.colIndex||n.rowIndex-u>i-n.colIndex&&n.rowIndex!==r?{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down}:v?{startCell:s,endCell:c}:{startCell:c,endCell:{rowIndex:u,colIndex:n.colIndex},fillRange:[u,n.colIndex,r,f-1],direction:e.Left};if(n.rowIndex>o.rowIndex)return{startCell:s,endCell:{rowIndex:n.rowIndex,colIndex:i},fillRange:[r+1,f,n.rowIndex,i],direction:e.Down};if(n.rowIndex===o.rowIndex&&n.colIndex===o.colIndex)return{startCell:y,endCell:p}}},_getDirection:function(n,i,r){var u=t.Spreadsheet.autoFillDirection;if(r=this.XLObj.isUndefined(r)?this._verticalFill:r,r){if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down;if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left}else{if(i.colIndex>n.colIndex)return u.Right;if(i.colIndex<n.colIndex)return u.Left;if(i.rowIndex<n.rowIndex)return u.Up;if(i.rowIndex>n.rowIndex)return u.Down}return null},_getFillRange:function(n,i,r,u){var f=t.Spreadsheet.autoFillDirection;switch(u){case f.Up:return[r.rowIndex,n.colIndex,n.rowIndex-1,i.colIndex];case f.Right:return[n.rowIndex,i.colIndex+1,i.rowIndex,r.colIndex];case f.Down:return[i.rowIndex+1,n.colIndex,r.rowIndex,i.colIndex];case f.Left:return[n.rowIndex,r.colIndex,i.rowIndex,n.colIndex-1]}return null},_autoFillOptionClick:function(t){var r,i,u,f,e,o,s,h=n("#"+t.model.targetID).find("#"+t.ID).find(">>");this._hasClass(h[0],"e-ss-fillselect")||(r=this.XLDragFill,i=this.getSheet(this.getActiveSheetIndex()),u=r._getDirection(this._pEndCell,this._pFillCell),f=this.swapRange([this._pStartCell.rowIndex,this._pStartCell.colIndex,this._pEndCell.rowIndex,this._pEndCell.colIndex]),e=r._getFillRange(this._pStartCell,this._pEndCell,this._pFillCell,u),o=i._startCell,s=i._endCell,this._isUndo=!0,this._performUndoRedo(),i._isColSelected||i._isRowSelected||(i._startCell=o,i._endCell=s,this.XLSelection.selectRange(i._startCell,i._endCell)),r.positionAutoFillElement(!0),r.autoFill({dataRange:f,fillRange:e,direction:u,fillType:t.ID}),r._fillInfo.fillType=t.ID,this._isUndo=!1)},_autoFillCleanUp:function(){var i,n,r,u,f="e-hide",t=this.XLObj,e=t.getAutoFillElem(),o=t._getAutoFillOptElem();for(e&&t.addClass(e[0],f),o&&t.addClass(o[0],f),r=t._getContent(t.getActiveSheetIndex())[0].querySelectorAll("td.e-autofillcell"),i=r.length;i--;)u=r[i],n=u.className,n=n.replace(/e-autofillcell|e-blur/g,""),n=n.replace(/ +/g," "),u.className=n},_autoFillClick:function(){var f,r=0,u="e-ss-fillselect",i=n("#"+this._id+"_ctxtmenu").find("li"),t=i.find("."+u);for(t.length&&(t=t[0],this._removeClass(t,u),this.addClass(t,"e-ss-filloption")),i.show(),f=this.XLDragFill._fillInfo.disableItems.length;r<f;)n(i[this.XLDragFill._fillInfo.disableItems[r]]).hide(),r++;i.filter("#"+this.XLDragFill._fillInfo.fillType).find("span").addClass(u)},_fillRange:function(n,i){var c,v,l,r,u,o,s,f={isKeyFill:!0},e=this.XLObj,a=e.getActiveSheetIndex(),y=e.getSheet(a),h=t.Spreadsheet.autoFillDirection;if(i=i?i:y.selectedRange,r=i[0],u=i[1],o=i[2],s=i[3],c=this._getDirection({rowIndex:r,colIndex:u},{rowIndex:o,colIndex:s},n),v=n?c===h.Down:c===h.Right,e.isRange(i)&&v)n?(f.dataRange=[r,u,r,s],f.fillRange=[r+1,u,o,s]):(f.dataRange=[r,u,o,u],f.fillRange=[r,u+1,o,s]);else{if(n){if(!r)return;f.dataRange=[r-1,u,r-1,s]}else{if(!u)return;f.dataRange=[r,u-1,o,u-1]}f.fillRange=i}(f.direction=n?h.Down:h.Right,f.fillType=t.Spreadsheet.AutoFillOptions.CopyCells,l=e.swapRange(f.fillRange),e.model.allowLockCell&&y.isSheetProtected&&e._isPropExists([l],"isLocked",a))||e._isPropExists([l],"isReadOnly",a)||this.autoFill(f)},_getFillInfo:function(n){var e,i,o=!0,u=t.Spreadsheet.AutoFillOptions.CopyCells,s=[],r=this.XLObj,h=t.Spreadsheet.autoFillDirection,c=[h.Down,h.Up].indexOf(n.direction)>-1,f=r.getRangeData({range:n.dataRange,valueOnly:!0,skipDateTime:!0}),l=f.join().replace(/,/g,"").length;if(r.isRange(n.dataRange)&&l){for(e=f.length;e--;)if(i=f[e],r.isNumber(i)||r.isFormula(i)||this._isCustomType(i)){o=!1;u=r.model.autoFillSettings.fillType;break}}else i=f[0],(r.isNumber(i)||r.isFormula(i)||this._isCustomType(i))&&(o=!1,u=r.model.autoFillSettings.fillType);return(!l||o)&&(s.push(1),u=n.fillType=="fillseries"?u:n.fillType),(!c||c&&n.dataRange[1]!==n.dataRange[3])&&s.push(4),{fillType:u,disableItems:s}},_updateHyperlinkTag:function(i,r){var f,u=this.XLObj,e=u.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"value2");u._isRowViewable(u.getActiveSheetIndex(),r.rowIndex)&&(f=u.getCell(r.rowIndex,r.colIndex),f[0].lastChild.nodeType===3&&n(f[0].lastChild).remove(),f.append(t.buildTag("a.e-hyperlinks",e,"",i.webAddr?{href:i.webAddr,target:"_blank"}:{href:"#"})));u.XLEdit._updateDataContainer(r,{dataObj:{hyperlink:i}})},_updateCFormat:function(n,t){var i,r=0,u=this.XLObj,f=t.length;for(u._dupDetails=!0;r<f;)i=t[r].split("_"),u.XLCFormat._cFormat(i[0],i[2],i[3],i[4],null,null,[n.rowIndex,n.colIndex,n.rowIndex,n.colIndex]),r++;u._dupDetails=!1},_updateNFormat:function(n,t,i){var u={type:n.type},r=this.XLObj;n.type!="general"&&(n.formatStr&&(u.formatStr=n.formatStr),"decimalPlaces"in n&&(u.decimalPlaces=n.decimalPlaces));r._dupDetails=!0;r.XLFormat.format(u,r._getAlphaRange(r.getActiveSheetIndex(),t,i,t,i));r._dupDetails=!1}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellNavigation=function(n){this.XLObj=n;this._canKeyBoardNavigate=!0;this._isNavigate=!0};t.spreadsheetFeatures.cellNavigation.prototype={_selectionKeyDownHandler:function(n){var v,w,o,l,y,g,rt,d=[],t=this.XLObj,b=t.getActiveSheetIndex(),i=t.getSheet(b),f=n.keyCode,k=n.shiftKey,nt=n.ctrlKey,e={keyCode:f,shiftKey:k,ctrlKey:nt,altKey:n.altKey},tt=!1,r=i._activeCell,a=i._endCell,s=i.rowCount,c=i.colCount,it=t._dataContainer,p,u,h=i.usedRange;if((f===9&&this._canKeyBoardNavigate||f===13)&&!nt){if(n.preventDefault(),v=t.XLEdit.getCurrentEditCellData(),t.isFormula(v)&&!t.XLEdit._formulaValidate(v))return;if(t.XLEdit._isFormulaEdit&&!t._isFormulaSuggestion)if(v.length>1)if(this._isValidParameter(v))t.isFormula(v)||(v=v+")",t.XLEdit._editElem.text(v),t.model.allowFormulaBar&&t._getInputBox().val(v)),t.XLEdit.saveCell(),t._getContent(b).find("td").removeClass(t._formulaBorder.join(" ").replace(/,/g," ")+" "+t._ctrlFormulaBorder.join(" ").replace(/,/g," ")),t.XLSelection._cleanUp(),t.XLSelection.selectRange(i._activeCell,i._activeCell),t.XLEdit._isFormulaEdit=!1,t._formulaRange=[],t._ctrlKeyCount=0;else{t._showAlertDlg("Alert","MissingParenthesisAlert","FormulaAlert",440);return}else t.XLEdit.saveCell(),t.XLEdit._isFormulaEdit=!1;else f===9&&t.XLEdit._isEdit&&t.XLEdit.saveCell();w=i.selectedRange;rt=i._isRowSelected||i._isColSelected;rt?w[0]===w[2]||w[1]===w[3]?d.push({rowIndex:w[0],colIndex:w[1]}):d=i._selectedCells:d=i._selectedCells;d.length&&(d.length===1||!rt&&this._isRangeMerged(d)?i._isRowSelected?k?r.colIndex>0&&this._navigateRow("Backward",e):r.colIndex<39&&this._navigateRow("Forward",e):i._isColSelected?k?r.rowIndex>0&&this._navigateCol("Backward",e):r.rowIndex<39&&this._navigateCol("Forward",e):k?f===9&&r.colIndex>0?this._navigateCell(r.rowIndex,r.colIndex-1,e):f===13&&r.rowIndex>0&&this._navigateCell(r.rowIndex-1,r.colIndex,e):f===9&&r.colIndex<c?this._navigateCell(r.rowIndex,r.colIndex+1,e):f===13&&r.rowIndex<s&&this._navigateCell(r.rowIndex+1,r.colIndex,e):k?f===9?this._navigateRange("ShiftTab",e):this._navigateRange("ShiftEnter",e):f===9?this._navigateRange("Tab",e):this._navigateRange("Enter",e))}else if((f===37||f===38&&!t._isFormulaSuggestion||f===39||f===40&&!t._isFormulaSuggestion)&&this._isNavigate)if(n.preventDefault(),t.XLEdit._isFormulaEdit)y=t.swapRange([t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex]),t.getRange([y[0]?y[0]-1:y[0],y[1]?y[1]-1:y[1],y[2],y[3]]).removeClass(t._formulaBorder[t._ctrlKeyCount%6].join(" ")+" "+t._ctrlFormulaBorder[t._ctrlKeyCount%6].join(" ")),nt&&(o=t._dStartCell,f===37&&o.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:o.rowIndex,colIndex:0}:f===38&&o.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:0,colIndex:o.colIndex}:f===39&&o.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:o.rowIndex,colIndex:i.colCount}:f===40&&o.rowIndex<s&&(t._dStartCell=t._dEndCell={rowIndex:i.colCount,colIndex:o.colIndex})),k||t._shiftKeyEnabled?(l=t._dEndCell,f===37&&l.colIndex>0?t._dEndCell={rowIndex:l.rowIndex,colIndex:l.colIndex-1}:f===38&&l.rowIndex>0?t._dEndCell={rowIndex:l.rowIndex-1,colIndex:l.colIndex}:f===39&&l.colIndex<i.colCount?t._dEndCell={rowIndex:l.rowIndex,colIndex:l.colIndex+1}:f===40&&l.rowIndex<i.rowCount&&(t._dEndCell={rowIndex:l.rowIndex+1,colIndex:l.colIndex})):(o=t._dStartCell,f===37&&o.colIndex>0?t._dStartCell=t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex-1}:f===38&&o.rowIndex>0?t._dStartCell=t._dEndCell={rowIndex:o.rowIndex-1,colIndex:o.colIndex}:f===39&&o.colIndex<i.colCount?t._dStartCell=t._dEndCell={rowIndex:o.rowIndex,colIndex:o.colIndex+1}:f===40&&o.rowIndex<i.rowCount&&(t._dStartCell=t._dEndCell={rowIndex:o.rowIndex+1,colIndex:o.colIndex})),t.XLSelection._processFormulaRange(t._ctrlFormulaBorder),t._formulaRange[t._ctrlKeyCount]=t._getProperAlphaRange(b,t._dStartCell.rowIndex,t._dStartCell.colIndex,t._dEndCell.rowIndex,t._dEndCell.colIndex);else if(nt){if(f===37&&r.colIndex>0){if(p=it.sheets[b][r.rowIndex],u=r.colIndex-1,p&&u<h.colIndex)if(t.XLEdit.getPropertyValue(r.rowIndex,u+1,"value2")&&t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")){while(t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<=h.colIndex)u--;c=u+1}else{while(!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<h.colIndex&&u>0)u--;c=u}else if(t.XLEdit.getPropertyValue(r.rowIndex,h.colIndex,"value2"))c=h.colIndex;else{for(u=h.colIndex;u>0&&!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2");)u--;c=u}this._navigateCell(r.rowIndex,c,e)}else if(f===38&&r.rowIndex>0){if(p=it.sheets[b],u=r.rowIndex-1,u<=h.rowIndex)if(p[u]&&t.XLEdit.getPropertyValue(u+1,r.colIndex,"value2")&&t.XLEdit.getPropertyValue(u,r.colIndex,"value2")){while(t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<=h.rowIndex)u--;s=u+1}else{while(!t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u>0)u--;s=u}else if(t.XLEdit.getPropertyValue(h.rowIndex,r.colIndex,"value2"))s=h.rowIndex;else{for(u=h.rowIndex;u>0&&!t.XLEdit.getPropertyValue(u,r.colIndex,"value2");)u--;s=u}this._navigateCell(s,r.colIndex,e)}else if(f===39&&r.colIndex<c-1){if(p=it.sheets[b][r.rowIndex],u=r.colIndex+1,p&&u<=h.colIndex)if(t.XLEdit.getPropertyValue(r.rowIndex,u-1,"value2")&&t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")){while(t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<=h.colIndex)u++;c=u-1}else{while(!t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")&&u<h.colIndex)u++;c=t.XLEdit.getPropertyValue(r.rowIndex,u,"value2")?u:i.colCount}else c=i.colCount;c===i.colCount&&--c;this._navigateCell(r.rowIndex,c,e)}else if(f===40&&r.rowIndex<s-1){if(p=it.sheets[b],u=r.rowIndex+1,u<h.rowIndex)if(p[u]&&t.XLEdit.getPropertyValue(u-1,r.colIndex,"value2")&&t.XLEdit.getPropertyValue(u,r.colIndex,"value2")){while(t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<=h.rowIndex)u++;s=u-1}else{while(!t.XLEdit.getPropertyValue(u,r.colIndex,"value2")&&u<i.rowCount)u++;s=u}else s=i.rowCount-1;s===i.rowCount&&--s;this._navigateCell(s,r.colIndex,e)}}else if(k){if(f===37&&a.colIndex>0?i._endCell={rowIndex:a.rowIndex,colIndex:a.colIndex-1}:f===38&&a.rowIndex>0?(tt=!0,i._endCell={rowIndex:a.rowIndex-1,colIndex:a.colIndex}):f===39&&a.colIndex<c?i._endCell={rowIndex:a.rowIndex,colIndex:a.colIndex+1}:f===40&&a.rowIndex<s&&(tt=!0,i._endCell={rowIndex:a.rowIndex+1,colIndex:a.colIndex}),(i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&t.model.scrollSettings.scrollMode==="normal")return;if((i.rowCount===i._endCell.rowIndex||i.colCount===i._endCell.colIndex)&&!t.model.scrollSettings.allowScrolling)return;t.model.scrollSettings.allowScrolling&&(i.rowCount===i._endCell.rowIndex&&f===40?t._scrollContent({x:0,y:+t.model.rowHeight}):i.colCount-1===i._endCell.colIndex&&f===39&&t._scrollContent({x:+t.model.columnWidth,y:0}));this._isHiddenCell(i._endCell)&&(g={rowIndex:i._endCell.rowIndex,colIndex:i._endCell.colIndex},this._skipHiddenRowsAndCols(g,e),i._endCell.rowIndex=g.rowIndex,i._endCell.colIndex=g.colIndex);(t.XLEdit.getPropertyValue(i._endCell.rowIndex,i._endCell.colIndex,"isMHide")||t.XLEdit.getPropertyValue(i._endCell.rowIndex,i._endCell.colIndex,"merge")||tt&&t._isPropExists([[i._endCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"merge")||t._isPropExists([[i._endCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]],"isMHide"))&&(tt=!1,t.XLSelection._processBoundary());this._scrollToCell(i._endCell,e);t.XLSelection.selectRange(i._startCell,i._endCell);t.model.allowAutoFill&&t.XLDragFill.positionAutoFillElement()}else if(e={keyCode:f,shiftKey:!1,ctrlKey:!1,altKey:!1},f===37&&r.colIndex>0)this._navigateCell(r.rowIndex,r.colIndex-1,e);else if(f===38&&r.rowIndex>0)this._navigateCell(r.rowIndex-1,r.colIndex,e);else if(f===39&&r.colIndex<c)this._navigateCell(r.rowIndex,r.colIndex+1,e);else if(f===40&&r.rowIndex<s)this._navigateCell(r.rowIndex+1,r.colIndex,e);else return!1},_navigateCell:function(r,u,f){var v,d,g,w,b,nt,tt=hiddenWth=0,s={rowIndex:r,colIndex:u},e=this.XLObj,c=e.getActiveSheetIndex(),o=e.getSheet(c),l=e._getContent(c),h=l.find("#hscrollBar").data("ejScrollBar"),a=l.find("#vscrollBar").data("ejScrollBar"),p=l.find(".e-content"),it=e.XLEdit,y=!1,k=p[0].offsetWidth;if((o.rowCount!==s.rowIndex&&o.colCount!==s.colIndex||e.model.scrollSettings.scrollMode!=="normal")&&(o.rowCount!==s.rowIndex||!e.model.scrollSettings.allowVirtualScrolling)&&(o.rowCount!==s.rowIndex&&o.colCount!==s.colIndex||e.model.scrollSettings.allowScrolling)){if(o.rowCount===s.rowIndex&&(e.XLScroll._scrollY(c),y=!0),e._isAutoWHMode||o.colCount!==s.colIndex||e.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Infinite||(e.XLScroll._scrollX(c),y=!0),o._isFreezed)if(o._frozenRows-1<=r&&r<o._ftopRowIdx){for(i=r;i<o._ftopRowIdx;i++)tt+=o.rowsHeightCollection[i];e._scrollContent({y:-tt})}else if(o._frozenColumns-1<=u&&u<o._fleftColIdx){for(i=u;i<o._fleftColIdx;i++)hiddenWth+=o.columnsWidthCollection[i];e._scrollContent({x:-hiddenWth})}for(g=e.getCell(s.rowIndex,s.colIndex),this._isHiddenCell(s)&&this._skipHiddenRowsAndCols(s,f),b=it.getPropertyValue(o._activeCell.rowIndex,o._activeCell.colIndex,"merge"),b&&it.getPropertyValue(s.rowIndex,s.colIndex,"mergeIdx")&&this._updateMergeRange(b,s,f),o._activeCell=o._endCell=o._startCell=s,(e.XLEdit.getPropertyValue(s.rowIndex,s.colIndex,"mergeIdx")||e.hasSpan(s))&&(e.XLSelection._processBoundary(),o._activeCell=o._startCell,g=e.getCell(o._activeCell.rowIndex,o._activeCell.colIndex),d=!0),cellInfo=e._getCellInfo(s,c),w=o._leftCol.idx>0?o._leftCol.idx-1:o._leftCol.idx,e.model.scrollSettings.allowScrolling&&o._bottomRow.idx<=s.rowIndex&&(f.keyCode===40||f.keyCode===13&&!f.shiftKey)&&!y?(a._scrollData.step=1,f.ctrlKey&&f.keyCode===40?e.XLScroll._scrollSelectedPosition(c,e.getActiveCell(c)):a.scroll(a.value()+(e._isFrozen(o.frozenRows)?e._getRowHeight(o._ftopRowIdx,c):cellInfo.height),!0)):e.model.scrollSettings.allowScrolling&&!e._isFrozen(o.frozenRows)&&o._topRow.idx>s.rowIndex&&(f.keyCode===38||f.keyCode===13&&f.shiftKey)&&!y&&!e._hasClass(l.find("tr").eq(s.rowIndex)[0],"e-fr-hide")&&(a._scrollData.step=-1,s.rowIndex>0?f.ctrlKey?a.scroll(cellInfo.top,!0):a.scroll(a.value()-cellInfo.height,!0):a.scroll(0)),e.model.scrollSettings.allowScrolling&&u>=o._rightCol.idx&&k<=o._colWidthCollection[o._activeCell.colIndex]-o._colWidthCollection[w]+cellInfo.width&&(f.keyCode===39||f.keyCode===9&&!f.shiftKey)&&!y?(h._scrollData.step=1,f.ctrlKey&&f.keyCode===39?h.scroll(cellInfo.left+cellInfo.width-h._scrollData.handleSpace,!0):h.scroll(h.value()+(e._isFrozen(o.frozenColumns)?e._getColWidth(o._fleftColIdx,c):cellInfo.width),!0)):e.model.scrollSettings.allowScrolling&&!e._isFrozen(o.frozenColumns)&&w>=s.colIndex&&(f.keyCode===37||f.keyCode===9&&f.shiftKey)&&!y?(h._scrollData.step=-1,s.colIndex>0?f.ctrlKey?h.scroll(cellInfo.left,!0):h.scroll(h.value()-cellInfo.width,!0):h.scroll(0)):e.model.scrollSettings.allowScrolling&&f.ctrlKey&&!y&&(f.keyCode===37?h.scroll(cellInfo.left,!0):f.keyCode===38?a.scroll(cellInfo.top,!0):f.keyCode===39?h.scroll(cellInfo.left-h._scrollData.handleSpace,!0):e.XLScroll._scrollSelectedPosition(c,e.getActiveCell(c))),v=l.find("col"),nt=n(e.getRows(c)[1]),rowIdx=o._startCell.rowIndex,colIdx=o._startCell.colIndex,(k>=cellInfo.left||p.offset().left+k>=cellInfo.left+cellInfo.width)&&(f.keyCode==39||f.keyCode==9&&!f.shiftKey)&&(e.XLSelection.selectRange(o._startCell,o._startCell),e.model.showRibbon&&e.XLRibbon._updateRibbonIcons(),e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()),(!v.eq(colIdx).hasClass("e-fc-hide")||f.keyCode==37||f.keyCode==9&&f.shiftKey)&&(e.XLSelection.selectRange(o._startCell,o._endCell),e.model.showRibbon&&e.XLRibbon._updateRibbonIcons(),e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()),!nt.eq(rowIdx).hasClass("e-fr-hide")&&(f.keyCode==38||f.keyCode==13&&f.shiftKey)&&(e.XLSelection.selectRange(o._startCell,o._endCell),e.model.showRibbon&&e.XLRibbon._updateRibbonIcons(),e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()),(p.offset().top+p[0].offsetHeight>=cellInfo.top||p.offset().top+p[0].offsetHeight>=cellInfo.top+cellInfo.height)&&(f.keyCode==40||f.keyCode==13&&!f.shiftKey)&&(e.XLSelection.selectRange(o._startCell,o._endCell),e.model.showRibbon&&e.XLRibbon._updateRibbonIcons(),e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()),d&&(f.keyCode===37||f.shiftKey&&f.keyCode===9?s.colIndex=o._startCell.colIndex:f.keyCode===38||f.shiftKey&&f.keyCode===13?s.rowIndex=o._startCell.rowIndex:f.keyCode===39||f.keyCode===9?s.colIndex=o._endCell.colIndex:(f.keyCode===40||f.keyCode===13)&&(s.rowIndex=o._endCell.rowIndex),o._activeCell=s),o._startCell=s;(f.keyCode===37||f.shiftKey&&f.keyCode===9)&&e._hasClass(v[o._startCell.colIndex],"e-c-hide");)e._removeClass(v[o._startCell.colIndex],"e-fc-hide"),o._startCell.colIndex--;while((f.keyCode===38||f.shiftKey&&f.keyCode===13)&&e._hasClass(l.find("tr")[o._startCell.rowIndex],"e-r-hide"))e._removeClass(l.find("tr")[o._startCell.rowIndex],"e-fr-hide"),o._startCell.rowIndex--;while((f.keyCode===39||f.keyCode===9)&&e._hasClass(v[o._startCell.colIndex],"e-c-hide"))o._startCell.colIndex++;while((f.keyCode===40||f.keyCode===13)&&e._hasClass(l.find("tr")[o._startCell.rowIndex],"e-r-hide"))o._startCell.rowIndex++;rIdx=o._startCell.rowIndex;cIdx=o._startCell.colIndex;(e._hasClass(v[cIdx],"e-fc-hide")||e._hasClass(l.find("tr")[rIdx],"e-fr-hide"))&&(o._activeCell=o._endCell={rowIndex:rIdx,colIndex:cIdx},e._hasClass(v[cIdx],"e-fc-hide")&&(f.keyCode===37||f.shiftKey&&f.keyCode===9)?(e._scrollReverse=!0,e._removeClass(v[cIdx],"e-fc-hide"),e._removeClass(e._getJSSheetHeader(c).find("col")[cIdx],"e-fc-hide"),h.scroll(h.value()-o.columnsWidthCollection[cIdx],!0),(h.value()<0||!e._hasClass(v[cIdx-1],"e-fc-hide"))&&h.scroll(0)):e._hasClass(l.find("tr")[rIdx],"e-fr-hide")&&(f.keyCode==38||f.shiftKey&&f.keyCode===13)?(e._scrollReverse=!0,e._removeClass(l.find("tr")[rIdx],"e-fr-hide"),e._removeClass(e._getJSSheetRowHeader(c).find("tr")[rIdx],"e-fr-hide"),a.scroll(a.value()-o.rowsHeightCollection[rIdx],!0),(a.value()<0||!e._hasClass(l.find("tr")[rIdx-1],"e-fr-hide"))&&a.scroll(0)):e._hasClass(v[cIdx],"e-fc-hide")&&(f.keyCode===39||f.keyCode===9)?e.XLScroll._scrollDirection("hscrollBar",0):e._hasClass(l.find("tr")[rIdx],"e-fr-hide")&&(f.keyCode===40||f.keyCode===13)&&e.XLScroll._scrollDirection("vscrollBar",0),e.XLSelection.selectRange({rowIndex:rIdx,colIndex:cIdx},{rowIndex:rIdx,colIndex:cIdx}));e.model.allowAutoFill&&e.XLDragFill.positionAutoFillElement()}},_navToCell:function(n,t){var u=this.XLObj,e=u.getActiveSheetIndex(),r=u.getSheet(),f=hiddenWth=0;if(r._isFreezed)if(n<r._ftopRowIdx||t<r._fleftColIdx){if(r._frozenRows-1<=n&&n<r._ftopRowIdx){for(i=n;i<r._ftopRowIdx;i++)f+=r.rowsHeightCollection[i];u._scrollContent({y:-f})}if(r._frozenColumns-1<=t&&t<r._fleftColIdx){for(i=t;i<r._fleftColIdx;i++)hiddenWth+=r.columnsWidthCollection[i];u._scrollContent({x:-hiddenWth})}}else{if(r._frozenRows-1<=n&&n>r._bottomRow.idx){for(i=r._bottomRow.idx;i<n;i++)f+=r.rowsHeightCollection[i];u._scrollContent({y:+f})}if(r._frozenColumns-1<=t&&t>r._rightCol.idx){for(i=r._rightCol.idx;i<t;i++)hiddenWth+=r.columnsWidthCollection[i];u._scrollContent({x:+hiddenWth})}}},_navigateRange:function(n,t){var c=this.XLObj,h=c.getSheet(c.getActiveSheetIndex()),r=h._startCell,u=h._endCell,i=h._activeCell,f=r.rowIndex<u.rowIndex?r.rowIndex:u.rowIndex,e=r.rowIndex>u.rowIndex?r.rowIndex:u.rowIndex,o=r.colIndex<u.colIndex?r.colIndex:u.colIndex,s=r.colIndex>u.colIndex?r.colIndex:u.colIndex;if(n=="Tab")if(i.colIndex<s)this._navigateRow("Forward",t);else if(i.rowIndex<e)this._updateActiveCell(i.rowIndex+1,o,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="Enter")if(i.rowIndex<e)this._navigateCol("Forward",t);else if(i.colIndex<s)this._updateActiveCell(f,i.colIndex+1,t,n);else if(i.rowIndex==e&&i.colIndex==s)this._updateActiveCell(f,o,t,n);else return!1;else if(n=="ShiftTab")if(i.colIndex>o)this._navigateRow("Backward",t);else if(i.rowIndex>f)this._updateActiveCell(i.rowIndex-1,s,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1;else if(i.rowIndex>f)this._navigateCol("Backward",t);else if(i.colIndex>o)this._updateActiveCell(e,i.colIndex-1,t,n);else if(i.rowIndex==f&&i.colIndex==o)this._updateActiveCell(e,s,t,n);else return!1},_navigateRow:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Tab"):(i=-1,r="ShiftTab");this._updateActiveCell(f.rowIndex,f.colIndex+i,t,r)},_navigateCol:function(n,t){var i,r,u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex())._activeCell;n==="Forward"?(i=1,r="Enter"):(i=-1,r="ShiftEnter");this._updateActiveCell(f.rowIndex+i,f.colIndex,t,r)},_updateActiveCell:function(n,t,i,r){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),e=f._activeCell;u._removeClass(u.getCell(e.rowIndex,e.colIndex),"e-activecell");f._activeCell={rowIndex:n,colIndex:t};i&&this._isHiddenCell(f._activeCell)&&this._skipHiddenRowsAndCols(f._activeCell,i,!0,r);this._isMergedCell(f._activeCell)&&this._skipMergedCells(f._activeCell,i);this._scrollToCell(f._activeCell,i);u.addClass(u.getCell(f._activeCell.rowIndex,f._activeCell.colIndex),"e-activecell");u.model.allowFormulaBar&&u.updateFormulaBar();u.setSheetFocus()},_isValidParameter:function(n){var t=n.indexOf("(");return t>-1?(n=n.split("("),n[1].length>0):!0},_skipHiddenRowsAndCols:function(n,t,i,r){var e=this.XLObj,u=e.getSheet(e.getActiveSheetIndex()),f=!0;i?this._navigateRange(r,t):((t.keyCode===37||t.keyCode===9&&t.shiftKey||t.keyCode===39&&t.ctrlKey)&&n.colIndex?n.colIndex--:(t.keyCode===38||t.keyCode===13&&t.shiftKey||t.keyCode===40&&t.ctrlKey)&&n.rowIndex?n.rowIndex--:(t.keyCode===39||t.keyCode===9||t.keyCode===37&&t.ctrlKey)&&n.colIndex<u.colCount?n.colIndex++:(t.keyCode===40||t.keyCode===13||t.keyCode===38&&t.ctrlKey)&&n.rowIndex<u.rowCount?n.rowIndex++:f=!1,this._isHiddenCell(n)&&f?this._skipHiddenRowsAndCols(n,t):f||((t.keyCode===37||t.keyCode===9&&t.shiftKey)&&!n.colIndex?n.colIndex=t.keyCode===37&&t.shiftKey?u._endCell.colIndex+1:u._startCell.colIndex:(t.keyCode===38||t.keyCode===13&&t.shiftKey)&&!n.rowIndex&&(n.rowIndex=t.keyCode===38&&t.shiftKey?u._endCell.rowIndex+1:u._startCell.rowIndex)))},_isHiddenCell:function(n){return this.XLObj.XLEdit.getPropertyValue(0,n.colIndex,"isCHide")||this.XLObj.XLEdit.getPropertyValue(n.rowIndex,0,"isRHide")||!1},_isMergedCell:function(n){return this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isMHide")||!1},_skipMergedCells:function(n,t){var u=this.XLObj,f=u.getSheet(u.getActiveSheetIndex()),i=f._startCell,r=f._endCell,e=!0,o=u._rcRegx;minr=i.rowIndex<r.rowIndex?i.rowIndex:r.rowIndex;maxr=i.rowIndex>r.rowIndex?i.rowIndex:r.rowIndex;minc=i.colIndex<r.colIndex?i.colIndex:r.colIndex;maxc=i.colIndex>r.colIndex?i.colIndex:r.colIndex;t.shiftKey&&t.keyCode===9?n.colIndex--:t.keyCode===9?n.colIndex++:t.shiftKey&&t.keyCode===13?n.rowIndex--:t.keyCode===13?n.rowIndex++:e=!1;n.colIndex>maxc?(n.colIndex=minc,n.rowIndex=n.rowIndex===maxr?minr:n.rowIndex+1):n.colIndex<minc?(n.colIndex=maxc,n.rowIndex=n.rowIndex===minr?maxr:n.rowIndex-1):n.rowIndex>maxr?(n.rowIndex=minr,n.colIndex=n.colIndex===maxc?minc:n.colIndex+1):n.rowIndex<minr&&(n.rowIndex=maxr,n.colIndex=n.colIndex===minc?maxc:n.colIndex-1);this._isMergedCell(n)&&e&&this._skipMergedCells(n,t)},_updateMergeRange:function(n,t,i){var f=this.XLObj,r=n.mSpan.colSpan-1,u=n.mSpan.rowSpan-1;i.shiftKey||i.keyCode!==39&&i.keyCode!==9?i.shiftKey||i.keyCode!==40&&i.keyCode!==13||(t.rowIndex=t.rowIndex+u):t.colIndex=t.colIndex+r},_isRangeMerged:function(n){var i,r={},u=this.XLObj,f=n[0],t=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"merge");if(t&&(r={rowIndex:n[0].rowIndex+t.mSpan.rowSpan-1,colIndex:n[0].colIndex+t.mSpan.colSpan-1},i=u._getSelectedRange(n[0],r),i.length===n.length))return!0},_scrollToCell:function(n,t){var f=this.XLObj,o=f.getActiveSheetIndex(),i=f._getCellInfo(n,o),r=f.getSheet(o),s=f._getContent(o),h=s.find(".e-content"),u=s.find("#hscrollBar").data("ejScrollBar"),e=s.find("#vscrollBar").data("ejScrollBar");(f.model.scrollSettings.scrollMode!=="normal"||r.colCount-1!==n.colIndex)&&(r._bottomRow.idx>0&&n.rowIndex>r._bottomRow.idx-1&&r.rowCount-1>n.rowIndex&&t.keyCode===40?e.scroll(e.value()+i.height,!0):n.rowIndex-1<r._topRow.idx&&t.keyCode===38?(e._scrollData.step=-1,n.rowIndex>0?e.scroll(i.top,!0):e.scroll(0)):n.colIndex<r._leftCol.idx-1?n.colIndex>0?u.scroll(u.value()-i.width,!0):u.scroll(0):h[0].offsetWidth<=i.left+i.width&&(t.keyCode===39?r.colCount===n.colIndex+1?f.XLScroll._scrollX(o):u.scroll(u.value()+i.width,!0):t.keyCode===37&&(u._scrollData.step=-1,u.scroll(i.left,!0))))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellFormatting=function(n){this.XLObj=n;this._formatEnable=!1;this._thousandSeparator=t.preferredCulture(this.XLObj.model.locale).numberFormat[","];this._formatAsTableStyle={};this._rowLength=null;this._colLength=null;this._getFormat=null;this._getEformatClass=null;this._borderPosition=["top","right","bottom","left"];this._cellObj=null;this._isFAT=!1;this._customFormatSpecifierType={};this._customFontFamily={}};t.spreadsheetFeatures.cellFormatting.prototype={format:function(i,r){var u=this.XLObj,yt,v;if(u.model.allowCellFormatting&&!u.model.isReadOnly){var f,e,y,w,rt,ct,ut,ft,h,g,l,b,a,et,nt,c,lt,ot=0,k={},at=[],tt="style",it="format",s=u.getActiveSheetIndex(),o=u.getSheet(s),wt=u._rAlign,p=u._dataContainer,d={sheetIndex:s,reqType:"cell-format"},pt=u._dupDetails,st=!1,vt=o.rowsHeightCollection,ht=0;if((y=u._getMultiRangeCells(r),g=y.length,!u._trigger("beforeCellFormat",{sheetIndex:s,format:i,cells:y}))&&g){if(i=this._getFormatObj(i),tt in i||it in i){for(d.oprType=(tt in i)?"style":"format",lt=y[g-1].colIndex;ot<g;){if(e=y[ot],b={sheetIndex:s,format:i,cell:e},this._cellObj={},f={rowIndex:e.rowIndex,colIndex:e.colIndex,beforeFormat:{},afterFormat:{},bRowHeight:u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex)},k=t.isNullOrUndefined(p.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(p.sheets[s][f.rowIndex][f.colIndex])?{}:p.sheets[s][f.rowIndex][f.colIndex],u._isRowViewable(s,e.rowIndex)&&(ft=u.getCell(e.rowIndex,e.colIndex),h=ft[0]),tt in i&&(f.prevClass=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,it),f.prevClass=f.prevClass?f.prevClass:"",c=this._getExtendedFormat(e,i.style),c.format["text-align"]&&c.format["text-align"].toLowerCase()==="right"&&!u._hasClass(h,"e-rightalign")?u.addClass(h,"e-rightalign"):(!c.format["text-align"]||c.format["text-align"].toLowerCase()!=="right")&&u._hasClass(h,"e-rightalign")&&u._removeClass(h,"e-rightalign"),this._cellObj.formats=n.extend(!0,{},c.format),rt=u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"tformats"),rt&&(c.format=n.extend(rt,c.format)),this._cellObj.format=f.className=this._createFormatClass(c.format),f.beforeFormat=n.extend(!0,{},k),("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"isMHide")&&t.isNullOrUndefined(u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"merge"))&&(nt=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),u.model.allowResizing&&(u.isNumber(nt)||u._isDateTime(nt)||u.isTime(nt))&&(et=u.XLResize._getContentWidth(f.colIndex,s,f.rowIndex,f.rowIndex)+2,et>o.columnsWidthCollection[f.colIndex]&&u.setWidthToColumns([{colIndex:f.colIndex,width:et}])),u.model.allowSelection&&u.XLSelection._refreshBorder(),st=!0),b.cssClass=c.className),it in i&&i.type&&(l=u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex),l=t.isNullOrUndefined(l)?"":l,this._cellObj.value=l,this._cellObj.type=i.type,this._cellObj.formatStr=i.format.formatStr,this._cellObj.decimalPlaces=i.format.decimalPlaces,this._cellObj.thousandSeparator=i.format["thousandSeparator"]?!0:!1,this._cellObj.canUpdate=!0,f.beforeFormat=n.extend(!0,{},k),l=this._getFormattedValue(f.rowIndex,f.colIndex,this._cellObj,l),b.value=this._cellObj.value,b.value2=this._cellObj.value2=t.isNullOrUndefined(l)?"":l+"",delete this._cellObj.canUpdate,f.beforeFormat.Oprtype=this._cellObj.type),u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")&&u._textClip(f.rowIndex,f.colIndex,"delete"),u.XLEdit._updateDataContainer(f,{dataObj:this._cellObj}),tt in i&&("font-family"in i.style||"font-size"in i.style)&&!u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"isMHide")){if(w=o.columnsWidthCollection[f.colIndex],u.XLEdit.getPropertyValue(e.rowIndex,e.colIndex,"merge")&&u._isRowViewable(s,e.rowIndex)){if(h.colSpan>1)for(v=e.colIndex+1,yt=e.colIndex+h.colSpan;v<yt;v++)w=w+o.columnsWidthCollection[v];if(a=u._detailsFromGlobalSpan(f.rowIndex,f.colIndex,"height",u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),w),h.rowSpan>1)for(v=e.rowIndex;v<e.rowIndex+h.rowSpan;v++)ht=ht+vt[v];a=a-(ht-vt[e.rowIndex])}else a=u._detailsFromGlobalSpan(f.rowIndex,f.colIndex,"height",u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2"),w);a>=u.model.rowHeight&&(h&&ft.parent().outerHeight(a),o.rowsHeightCollection[f.rowIndex]=a,u._fRowHtColl[f.rowIndex]=a,st=!0,u.model.allowFreezing&&u.XLFreeze._refreshFRowResize(e.rowIndex))}ct=u._getCellInfo(e);u._dupDetails=!0;it in i&&["text","general"].indexOf(this._cellObj.type)===-1&&(ut=u._detailsFromGlobalSpan(e.rowIndex,e.colIndex,"width",this._cellObj.value2),ut>ct.width&&u.XLResize.setColWidth(e.colIndex,ut),u.model.allowFreezing&&u.XLFreeze._refreshFColResize(e.colIndex));u._dupDetails=!1;u._dupDetails=pt;o._isColSelected&&o.selectedRange[1]<=f.colIndex&&f.colIndex<=o.selectedRange[3]&&(o._columnStyles[f.colIndex]=n.extend(!0,o._columnStyles[f.colIndex],this._cellObj));o._isRowSelected&&o.selectedRange[0]<=f.rowIndex&&f.rowIndex<=o.selectedRange[2]&&(o._rowStyles[f.rowIndex]=n.extend(!0,o._rowStyles[f.rowIndex],this._cellObj));this._cellObj=null;k=t.isNullOrUndefined(p.sheets[s][f.rowIndex])?{}:t.isNullOrUndefined(p.sheets[s][f.rowIndex][f.colIndex])?{}:p.sheets[s][f.rowIndex][f.colIndex];f.afterFormat=n.extend(!0,{},k);f.afterFormat.Oprtype=f.beforeFormat.Oprtype;f.aRowHeight=u.model.allowResizing&&u.XLResize.getRowHeight(e.rowIndex);at.push(f);u._trigger("cellFormatting",b);u.XLEdit.getPropertyValue(f.rowIndex,f.colIndex,"value2")&&u._textClip(f.rowIndex,f.colIndex,"add");lt===f.colIndex&&u._setRowHdrHeight(s,f.rowIndex);ot++}d.selectedCell=at;d.range=o.selectedRange;u.XLScroll._getRowHeights(s,y[0].rowIndex);u._intrnlReq=!0;u.model.allowSelection&&u.XLSelection.refreshSelection();u._intrnlReq=!1;st&&(!o._isImported||o._isLoaded)&&u.model.allowComments&&!u._isExport&&u.XLComment._updateCmntArrowPos(null,s)}"border"in i&&!u._isMultiRange(r)?this.applyBorder(i.border,r,d):o._isImported&&!o._isLoaded||u._isUndoRedo||u._dupDetails||u._isSort||u._isExport||u._completeAction(d)}}},_getFormattedValue:function(n,i,r,u){var o,f=this.XLObj,e={},u=t.isNullOrUndefined(u)?"":f.XLEdit.getPropertyValue(n,i);return t.isNullOrUndefined(u)&&(u=""),f.isFormula(u)&&(u=f.XLEdit.getPropertyValue(n,i,"calcValue"),r.canUpdate=!1),["text","general"].indexOf(r.type)!==-1?(f._isDateTime(u)&&(o=f.XLEdit.getPropertyValue(n,i,"type"),u=f._dateToInt(u,o===t.Spreadsheet.CellType.Time),r.value=u),r.type===t.Spreadsheet.CellType.Text?e.align="":f.isNumber(u)&&f.XLEdit.getPropertyValue(n,i,"align")!="right"&&(e.align=t.Spreadsheet.Align.Right),"align"in e&&(e.cellIdx={rowIndex:n,colIndex:i},f.XLEdit._refreshCellAlignment(e))):u=this._format(u,{formatStr:r.formatStr,type:r.type,thousandSeparator:r.thousandSeparator,decimalPlaces:r.decimalPlaces,cellObj:r}),u},_format:function(n,i){var u=this.XLObj,e=i.formatStr,r=u.isUndefined(n)?"":n,l=i.type||"",f=t.Spreadsheet.CellType,h=u.model.locale,a=["."].indexOf(this._thousandSeparator)>-1?"\\":"",v=new RegExp(a+this._thousandSeparator,"g");n=r.toString();switch(l){case f.Accounting:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toAccounting(e,r,h));break;case f.Currency:case f.Number:case f.Percentage:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.formatting(e,r,h),!i.thousandSeparator&&[f.Number,f.Percentage].indexOf(l)>-1&&this._thousandSeparator&&(r=r.replace(v,"")));break;case f.Scientific:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toExponential(r,i.decimalPlaces));break;case f.Fraction:u._isDateTime(r)&&(r=u._dateToInt(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r));u.isNumber(r)&&(r=u.toFraction(r),r="numerator"in r?r.integer+" "+r.numerator+"/"+r.denominator:r.integer);break;case f.LongDate:case f.ShortDate:case f.Date:case f.Time:case f.DateTime:u.isNumber(r)?(r=u.intToDate(r),this._cellObj&&this._cellObj.canUpdate&&(this._cellObj.value=r)):u._isDateTime(r)||(r=t.parseDate(r));u._isDateTime(r)&&(r=u.formatting(e,r,h));break;case f.String:var c=e.indexOf("\\"),o=e.indexOf("#"),s=e.split("\\").join("");o<0&&(o=e.indexOf("0"));c<o?r=s.substr(c,s.length-1)+n:c>o&&(r=n+s.substr(o+1,s.length))}return t.isNullOrUndefined(r)?n:r},createTable:function(i,r){var u=this.XLObj;if(u.model.allowFormatAsTable&&(u.model.allowSelection||!t.isNullOrUndefined(r))&&!u.model.isReadOnly){t.isNullOrUndefined(i.format)&&(i.format=this._getTableLayoutFromName(i.formatName).format);var h,b,f,w,c,o,l=i.name||"",s=u.getActiveSheetIndex(),e=u.getSheet(s),a=e.tableManager,v=e._startCell,y=e._endCell,k="formatName",d={sheetIndex:s,tableStyle:i,reqType:"format-table"},g=i.format||this._getTableLayoutFromName(i.formatName).format,p={format:g},tt=u._dupDetails,nt=u.element.find("#"+u._id+"_Ribbon_tsofiltercolumn");if(!u._trigActionBegin(d)&&g)return(i=d.tableStyle,this._isFAT=!0,r=u._getRangeArgs(r,"object"),f=u._isUndoRedo?n.merge([],r):r?r:e.selectedRange,i.name&&!u.XLRibbon._validateNamedRange(i.name,u._getDollarAlphaRange(f,!0))&&!u.XLClipboard._isCut)?void 0:(w=u.XLEdit.getPropertyValue(f[0],f[1],"tableName")||"",(!e._isImported||e._isLoaded)&&(b=u.getRange(f),h={sheetIndex:s,reqType:"format-table",beforeFormat:this.getHashCodeClassAsArray(),beforeRange:n.extend(!0,[],f),pcells:b,beforeRangeHeader:u.getRangeData({range:[f[0],f[1],f[0],f[3]]})},c=i.header?[f[0],f[1],f[2],f[3]]:[f[0],f[1],f[2]+1,f[3]],h.beforeRangeData=u.getRangeData({range:c}),h.beforeMergeRange=u.XLEdit._getPropWithCellIdx(c,"merge",s),u._dupDetails=!0,h.beforeMergeRange.length&&u.unmergeCells(u._getAlphaRange(s,c[0],c[1],c[2],c[3])),u._dupDetails=!1),k in i&&(p[k]=i.formatName),w?(this._formatAsTableStyle=p,u._dupDetails=!0,this._createTable(u._getTableID(w),p),u._dupDetails=!1,u._undoCollection.pop(),u._undoCollection.pop()):(o=u.XLClipboard._isCut?parseInt(i.tblId):u.getObjectLength(a)+1,l=l.length?l:"Table"+o,u.model.sheets[s]._header[o]={header:i.header},i.header?(r?(e._startCell={rowIndex:r[0],colIndex:r[1]},e._endCell={rowIndex:r[2],colIndex:r[3]},u.XLSelection.selectRange(e._startCell,e._endCell),u.model.allowAutoFill&&(!e._isImported||e._isLoaded)&&u.XLDragFill.positionAutoFillElement()):r=u.swapRange([v.rowIndex,v.colIndex,y.rowIndex,y.colIndex]),r[0]===r[2]&&(f=r,f[2]=f[2]+1)):(u._isUndoRedo?f=n.extend(!0,[],r):(f=r?r:u.swapRange([v.rowIndex,v.colIndex,y.rowIndex,y.colIndex]),r=f),u.model.allowDragAndDrop&&u.XLDragDrop._moveRangeTo(f,[f[0]+1,f[1],f[2]+1,f[3]],["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","borders","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","tformats","tborders","tableName"]),e._startCell={rowIndex:f[0],colIndex:f[1]},e._endCell={rowIndex:f[2]+1,colIndex:f[3]},u.XLSelection.selectRange(e._startCell,e._endCell),u.model.allowAutoFill&&(!e._isImported||e._isLoaded)&&u.XLDragFill.positionAutoFillElement(),f[2]=f[2]+1),"dataSource"in i&&u.updateRange(s,{showHeader:"showHeader"in i?i.showHeader:!0,startCell:u._getAlphaRange(s,r[0],r[1],r[0],r[1]),dataSource:i.dataSource}),u.updateUniqueData({tableName:"e-table"+o},r),a[o]={name:l,range:f},i.fnNumber&&(a[o].fnNumber=i.fnNumber),a[o].isFilter=!0,u.XLRibbon._isDesignTab=!0,u._dupDetails=!0,this._createTable(o,p),u.model.allowFiltering&&u.XLFilter._filterTable(s,o),u._dupDetails=!1,this._updateTblStyleOptns(o,i),e._isImported&&!e._isLoaded||i.hideTab||u.XLRibbon._designTabUpdate(o,{rowIndex:r[0],colIndex:r[1]}),u.model.allowComments&&u.XLComment._updateCmntArrowPos()),(!e._isImported||e._isLoaded)&&(u.XLRibbon._dirtySelect(u.getRange(r)),h.tableID=o,h.tableStyle=i,h.afterRange=f,u._dupDetails=tt,u._isPaste||u._isUndoRedo||u._dupDetails||u._isExport||u._completeAction(h)),nt.length&&nt.ejCheckBox("option",{checked:!0}),u.XLRibbon.addNamedRange(l,u._getDollarAlphaRange(r,!0),null,s),u.XLSelection._refreshBorder(),this._isFAT=!1,i.name)}},_createTable:function(t,i){var f,s,h,u,c,nt,tt,rt,b,k,e,d,a=1,ut="format",ht=ut+"s",lt="t"+ht,ft="border",et="tableName",g="e-table"+t,ot=!1,r=this.XLObj,o=r.getActiveSheetIndex(),ct=r.getSheet(o),it=ct.tableManager[t],v=it.range,y=v[0],p=v[1],st=v[2],w=v[3],at=r.element.find("#"+r._id+"_Ribbon_tsofiltercolumn");for(it[ut]=i.format,i.formatName&&(it["formatName"]=i.formatName),this.removeStyle(v,{tableStyle:!0,border:!0,sheetIdx:o}),("headerLayout"in i.format)&&(u=n.extend(!0,{},i.format.headerLayout),ft in u&&(c=r._getProperAlphaRange(o,y,p,y,w),r._intrnlReq=!0,this.applyBorder(u.border,c),r._intrnlReq=!1,delete u.border)),ot=r.getObjectLength(u)>0,f=y,s=p,h=w;s<=h;)k=!1,e={},cellIdx={rowIndex:f,colIndex:s},nt=r.XLEdit.getPropertyValue(f,s,"value2")||"",tt="Column"+a,r.XLEdit.getPropertyValue(f,s,et,o)!==g&&(e.tableName=g,k=!0),nt.length?nt.toLowerCase()===tt.toLowerCase()&&a++:(r.XLEdit._updateCell(cellIdx,tt),a++),ot&&(b=this._getExtendedFormat(cellIdx,u,this._isFAT),e.format=this._createFormatClass(b.format),e.tformats=u,k=!0),k&&r.XLEdit._updateDataContainer(cellIdx,{dataObj:e,sheetIdx:o}),s++;if("contentLayout"in i.format)for(rt=i.format.contentLayout.length,a=0,f=y+1,s=st;f<=s;){if(u=n.extend(!0,{},i.format.contentLayout[a%rt]),ft in u&&(c=r._getProperAlphaRange(o,f,p,f,w),r._intrnlReq=!0,this.applyBorder(u.border,c),r._intrnlReq=!1,delete u.border),r.getObjectLength(u))for(h=p,l=w;h<=l;)e={},cellIdx={rowIndex:f,colIndex:h},d=n.extend({},u),r.XLEdit.getPropertyValue(f,h,et,o)!==g&&(e.tableName=g),d.color&&r.XLEdit.getPropertyValue(f,h,"hyperlink")&&delete d.color,b=this._getExtendedFormat(cellIdx,d,this._isFAT),e.format=this._createFormatClass(b.format),e.tformats=u,r.XLEdit._updateDataContainer(cellIdx,{dataObj:e,sheetIdx:o}),h++;f++;a++}"contentBorder"in i.format&&(c=r._getProperAlphaRange(o,y+1,p,st,w),r._intrnlReq=!0,this.applyBorder(n.extend({},i.format.contentBorder.border),c),r._intrnlReq=!1);r.XLClipboard._isCut||r._tableCnt++},_updateTblStyleOptns:function(n,t){var i,r,e="firstColumn",o="lastColumn",h="bold",c="normal",l="totalRow",s="isFilter",u=this.XLObj,f=u._getSheetIndex(),v=u.getSheet(f),a=v.tableManager;n in a&&(i=a[n],r=i.range,i[s]=s in t?t.isFilter:!0,u.model.allowFiltering&&!i[s]&&u.XLFilter._clearFilterTableIcon(f,n),u._dupDetails=!0,e in t&&(i[e]=t.firstColumn,this.format({style:{"font-weight":i[e]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[1],r[2],r[1]))),o in t&&(i[o]=t.lastColumn,this.format({style:{"font-weight":i[o]?h:c}},u._getProperAlphaRange(f,r[0]+1,r[3],r[2],r[3]))),u._dupDetails=!1,l in t&&(i[l]=t.totalRow))},removeTable:function(t){var i=this.XLObj;if(i.model.allowFormatAsTable&&!i.model.isReadOnly){var r,c,l,e,a,o,u=0,s=i.getActiveSheetIndex(),h=i.getSheet(s).tableManager,f=h[t].range,y=h[t].name,v=i.element.find("#"+i._id+"_Ribbon_tsofiltercolumn");if(t in h){if(i.clearRangeData(f,["tableName"]),r=i._getSelectedRange({rowIndex:f[0],colIndex:f[1]},{rowIndex:f[2],colIndex:f[3]}),c=r.length,c)while(u<c)l=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"formats"),e=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tformats"),a=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"borders"),o=i.XLEdit.getPropertyValue(r[u].rowIndex,r[u].colIndex,"tborders"),e&&(n.extend(e,l),i.XLEdit._updateDataContainer(r[u],{dataObj:{formats:e}})),o&&(n.extend(o,a),i.XLEdit._updateDataContainer(r[u],{dataObj:{borders:o}})),i.XLEdit._clearDataContainer({cellIdx:{rowIndex:r[u].rowIndex,colIndex:r[u].colIndex},property:["tformats","tborders"]}),u++;i.model.allowFiltering&&!i._isFATResize&&i.XLFilter._clearFilterTable(s,parseInt(t));delete h[t];delete i.model.sheets[s]._header[t];i.XLRibbon.removeNamedRange(y);v.length&&v.ejCheckBox("option",{checked:!1});i.XLRibbon._toggleDesignTab(i.getActiveCell(s))}}},_renameTable:function(t){var i=this.XLObj,s=i.getActiveSheetIndex(),u=i.getSheet(s).tableManager,r=i._getTableID(t),f,e,h,c=n("#"+i._id+"_Ribbon").data("ejRibbon"),o;r&&(o=document.getElementById(i._id+"_Ribbon_Design_Properties_TableName")&&document.getElementById(i._id+"_Ribbon_Design_Properties_TableName").value,f=u[r].name,f!=o&&(e=i._getDollarAlphaRange(u[r].range,!0),i.XLRibbon._validateNamedRange(o,e)&&(h={sheetIndex:s,reqType:"format-table",action:"renaming",range:e,tableId:parseInt(r),prevName:f},i.XLRibbon.removeNamedRange(f),u[r].name=o,i.XLRibbon.addNamedRange(u[r].name,e,null,s),h.newName=u[r].name,c.showTab(i._getLocStr("Design")),i._completeAction(h))))},_getTableLayoutFromName:function(n){if(n)return this.XLObj._FATStyles[n]},_getTableIdxFromName:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()).tableManager,t=i.getObjectLength(r);if(t)while(t--)if(r[t].name===n)return t;return-1},convertToRange:function(n){var t=this.XLObj;t.model.isReadOnly||(n.alert?t._showAlertDlg("","ConverToRangeAlert","ConvertToRange",498):this._convertToRange(n))},_convertToRange:function(t){var u=this.XLObj,e=t.sheetIdx||u.getActiveSheetIndex(),s=u.getSheet(e),r,h,f=u.getSheet(e).tableManager,o=s.filterSettings.tableRange;for(r=t.tableId||u._getTableID(null,document.getElementById(u._id+"_Ribbon_Design_Properties_TableName")&&document.getElementById(u._id+"_Ribbon_Design_Properties_TableName").value),i=0;i<o.length;i++)o[i].tableID==r&&(tableId=i);u.getObjectLength(f)&&(h={sheetIndex:e,reqType:"format-table",action:"Design_Tools_ConvertToRange",beforeFormat:u.XLFormat.getHashCodeClassAsArray(),tableID:r,name:f[r].name,format:f[r].format,formatName:f[r].formatName,tableRange:o[tableId],beforeRange:f[r].range,isFilter:f[r].isFilter,header:n.extend(!0,[],s._header[r]),firstColumn:f[r].firstColumn,lastColumn:f[r].lastColumn,totalRow:f[r].totalRow,fnNumber:f[r].fnNumber});u.isNumber(r)&&u.XLFormat.removeTable(r);u.model.showRibbon&&u.XLRibbon._toggleDesignTab(u.getActiveCell());u._completeAction(h)},_calculateTotalRow:function(r,u,f,e,o){var s=this.XLObj,v,k=[],d=[],w,y,h,b=!1,p,rt=s.getSheet(r),c=rt.tableManager,g,nt,tt=s._id+"_Ribbon_Design_TableStyleOptions_TotalRow",et=n("#"+tt).data("ejCheckBox"),l,a,it=s._isUndo,ut=s._isUndoRedo,ft=s._dupDetails;if(u=u||parseInt(document.getElementById(s._id+"_tableid").value),h=c[u].range,k.push(s.getRangeData({range:[h[2]+1,h[1],h[2]+1,h[3]]})),w=s._getProperAlphaRange(r,h[0]+1,h[3],h[2],h[3]),v=s._getSelectedRange({rowIndex:h[2]+1,colIndex:h[1]},{rowIndex:h[2]+1,colIndex:h[3]}),f){if(l={rowIndex:h[2]+1,colIndex:h[1]},a={rowIndex:h[2]+1,colIndex:h[3]},s._dupDetails=s._isTotalRow=!0,s._insRows={startRow:l.rowIndex,endRow:a.rowIndex},s._isUndo=!1,!o&&(s._isUndoRedo?s.insertEntireRow(l.rowIndex,a.rowIndex):s._insDelStatus!="insert"&&(g=s.insertShiftBottom(l,a)),g))return;if(s._isUndo=it,s._isUndoRedo=ut,s._dupDetails=s._isTotalRow=!1,!s._isFilterApplied||s._insDelStatus=="insert"){if(v.length>1&&s.XLEdit._updateCellValue(v[0],f?"Total":""),!c[u].fnNumber&&f){if(p=t.distinct(s.getRangeData({range:s.getRangeIndices(w),valueOnly:!0})),p=p.filter(Boolean),i=p.length,i){while(i--)if(!s.isNumber(p[i])){b=!0;break}}else b=!0;c[u].fnNumber=b?103:109}s.XLEdit._updateCellValue(v[v.length-1],f?"=SUBTOTAL("+c[u].fnNumber+","+w+")":"");c[u].range[2]+=1;s._insDelStatus==""}}else l={rowIndex:h[2],colIndex:h[1]},a={rowIndex:h[2],colIndex:h[3]},s._dupDetails=s._isTotalRow=!0,s._isFilterApplied?(s._intrnlReq=!0,s._isUndo=!1,s.deleteEntireRow(l.rowIndex,a.rowIndex),s._isUndo=it,s._intrnlReq=!1,e=!1):s._deleteShiftUp(r,l,a,{startCol:l.colIndex,colCount:a.colIndex-l.colIndex+1,startRow:l.rowIndex,rowCount:a.rowIndex-l.rowIndex+1,status:"shiftUp"}),s._isTotalRow=!1,c[u].range[2]-=1;s._dupDetails=ft;f?c[u].totalRow=!0:"totalRow"in c[u]&&delete c[u].totalRow;y=c[u].range;s.XLFormat._createTable(u,{format:c[u].format});d.push(s.getRangeData({range:[y[2]+1,y[1],y[2]+1,y[3]]}));nt={sheetIndex:r,reqType:"format-table",action:"totalrow",range:w,check:f,id:tt,cell:v,tmgr:c,tableId:u,pcells:k[0],curCells:d[0],fnNumber:c[u].fnNumber,isShift:e};o&&(s._dupDetails=s._isUndoRedo=!1);s._dupDetails||s._completeAction(nt);s._dupDetails=!1},_updateTotalRow:function(n,t,i,r,u){var f=this.XLObj,o=f.getSheet(n),e=o.tableManager;e[t].fnNumber=i;u&&f._clearFormula(r[2],r[3]);f.XLEdit._updateCellValue({rowIndex:r[2],colIndex:r[3]},"=SUBTOTAL("+e[t].fnNumber+","+f._getAlphaRange(val.sheetIndex,r[0]+1,r[3],r[2]-1,r[3])+")")},customFormatParser:function(n){if(this.XLObj.model.allowCellFormatting){var i,f,e,o={},h=t.Spreadsheet.CellType,r="{0:",u="}",c="N",a="P",s=".",l="0";return n=t.isNullOrUndefined(n)?"":n.toString(),Number(n)===0?(n.indexOf(s)>-1?(e=n.split(s),i=r+c+e[1].length+u):i=r+"D"+n.length+u,f=h.Number):!n.indexOf("#")&&n.indexOf(",")>-1&&n.lastIndexOf(l)===n.length-1?(n.indexOf(s)>-1?(e=n.split(s),i=r+c+e[1].length+u):i=r+c+l+u,o.thousandSeparator=!0,f=h.Number):n.lastIndexOf("%")===n.length-1&&Number(n.replace(/%/g,""))===0?(n.indexOf(s)>-1?(e=n.split(s),i=r+a+--e[1].length+u):i=r+a+l+u,f=h.Percentage):/^[dMy/\-\s,]+$/.test(n)?(i=r+n+u,f=h.Date):/^[hmst:\s]+$/.test(n)?(i=r+n+u,f=h.Time):n.indexOf("\\")>-1&&(o.formatStr=n,o.type="string"),i&&(o.formatStr=i,o.type=f),o}},addCustomFormatSpecifier:function(n,i,r){var e,u=t.Spreadsheet.CellType,f=t.cultures[this.XLObj.model.locale];if([u.Date,u.DateTime,u.LongDate,u.ShortDate,u.Time].indexOf(r)>-1){for(e in f.calendar.patterns)if(f.calendar.patterns[e]==i)return;n||(n="cDFrmt"+Object.keys(f.calendar.patterns).length);f.calendar.patterns[n]=i;this._customFormatSpecifierType[n]=r}},addFontFamily:function(i){var s,r,h=i,e=this._customFontFamily,f=this.XLObj,u=49,o;if(i=i.toLowerCase(),f.isUndefined(e[i])){for(s in e)o=parseInt(e[s]),o>u&&(u=o);u++;f.model.showRibbon&&(r=n("#"+f._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),ddDataSrc=n.extend(!0,[],f.XLRibbon._fontFamily),ddDataSrc.push({text:h,value:u}),r&&(selectedIdx=r.model.selectedItemIndex,r.option({dataSource:ddDataSrc}),r._initValue=!0,r.selectItemByIndex(selectedIdx),r._initValue=!1,f.XLRibbon._fontFamily=ddDataSrc));e[i]=u+"";t.Spreadsheet.FontFamily[i]=u+""}},removeFontFamily:function(i){var e,r,o=this._customFontFamily,u=this.XLObj,f,s;if(u.model.showRibbon)for(r=n("#"+u._id+"_Ribbon_Home_Font_FontFamily").data("ejDropDownList"),f=n.extend(!0,[],u.XLRibbon._fontFamily),e=0;e<f.length;e++)if(f[e].text===i){f.splice(e,1);r&&(s=r.model.selectedItemIndex,r.option({dataSource:f}),r._initValue=!0,r.selectItemByIndex(s),r._initValue=!1);u.XLRibbon._fontFamily=f;break}i=i.toLowerCase();u.isUndefined(o[i])||(delete o[i],u.isUndefined(t.Spreadsheet.FontFamily[i])||delete t.Spreadsheet.FontFamily[i])},applyBorder:function(i,r,u){var f=this.XLObj,e,o;f.model.allowCellFormatting&&f.model.formatSettings.allowCellBorder&&!f.model.isReadOnly&&(e=f.getActiveSheetIndex(),o=f.getSheet(e),r=f._getRangeArgs(r,"object",e),(!o._isImported||o._isLoaded)&&(u||(u={sheetIndex:e,reqType:"cell-format",process:"border",options:n.extend(!0,{},i)}),u.range=r,u.beforeFormat=this.getHashCodeClassAsArray(r),u.property=i.property,delete i.property),f.getObjectLength(i)?i.isGridBorder?this._applyAllBorderCss(i,r,u):this._applyBorderCss(i,r,u):this.removeStyle(r,{cellStyle:!0,border:!0,sheetIdx:e}),o._isImported&&!o._isLoaded||f._isUndoRedo||(f._refreshRangeTRHght(e,r),t.isNullOrUndefined(i.tableID)&&!this._dupDetails&&(u.afterFormat=this.getHashCodeClassAsArray(r),f._intrnlReq||f._completeAction(u))))},updateDecimalPlaces:function(i,r){var u=this.XLObj;if(u.model.allowCellFormatting&&u.model.formatSettings.allowDecimalPlaces&&!u.model.isReadOnly){var v,s,y,l,h,o,f,a=0,e={},c=u.getActiveSheetIndex(),b=u.getSheet(c),k=u._dataContainer,p={action:"decimal",reqType:"cell-format",sheetIndex:c,oprType:"format"},w=[];for(r=u._getRangeArgs(r,"object"),l=u._getSelectedCells(c,r).selCells,v=l.length;a<v;)h=l[a].rowIndex,o=l[a].colIndex,f=u.getRangeData({range:[h,o,h,o]})[0],s={rowIndex:h,colIndex:o,afterFormat:{},beforeFormat:{}},n.extend(!0,s.beforeFormat,f),u.isNumber(f.value)&&(u.isUndefined(f.decimalPlaces)&&(f.decimalPlaces=u._decimalCnt(f.value)),e.type=f.type===t.Spreadsheet.CellType.General?t.Spreadsheet.CellType.Number:f.type,e.decimalPlaces=f.decimalPlaces=i==="DecreaseDecimal"?f.decimalPlaces>0?f.decimalPlaces-1:f.decimalPlaces:f.decimalPlaces+1,e.formatStr=u._getFormatString(e.type,e.decimalPlaces),y=this._format(f.value,{formatStr:e.formatStr,type:e.type,thousandSeparator:f.thousandSeparator,decimalPlaces:e.decimalPlaces}),e.value2=y,u.XLResize&&u.XLResize._getContentWidth(o,c,0,u.getSheet(c).usedRange.rowIndex)>=b.columnsWidthCollection[o]-5&&(u._dupDetails=!0,u.XLResize._fitWidth(o),u._dupDetails=!1,u.XLSelection.refreshSelection(),u.model.allowAutoFill&&u.XLDragFill.positionAutoFillElement()),u.XLEdit._updateDataContainer({rowIndex:h,colIndex:o},{dataObj:e}),s.beforeFormat.Oprtype=e.type),f=u.getRangeData({range:[h,o,h,o]})[0],n.extend(!0,s.afterFormat,f),s.afterFormat.Oprtype=s.beforeFormat.Oprtype,w.push(s),a++;p.selectedCell=w;u._isUndoRedo||u._completeAction(p)}},getFormatClass:function(n,t){var i=t?"e-border":"e-format",r=new RegExp("\\b"+i+".*?\\b","g");return n.indexOf(i)!==-1?n.match(r)[0]:""},getHashCodeClassAsArray:function(n){var r,e,u,t=0,f={format:[]},i=this.XLObj,o=i.getActiveSheetIndex(),s=["topborder","leftborder"];for(n=i._toIntrnlRange(n,o),n=n?i.swapRange(n):i.getSheet(o).selectedRange,r=i.getRange(n),e=r.length;t<e;)u=r[t].className,f.format.push(this.getFormatClass(u)+" "+this.getFormatClass(u,!0)),t++;for(t=2;t--;)f[s[t]]=this._getBorderArray(n,s[t]);return f},_getBorderArray:function(n,t){var i,r=0,u=[],o=this.XLObj,f="topborder",s=t===f?n[0]-1:n[1]-1,e;if(s>=0)for(e=t===f?o.getRange([n[0]-1,n[1],n[0]-1,n[3]]):o.getRange([n[0],n[1]-1,n[2],n[1]-1]),i=e.length;r<i;)u.push(this.getFormatClass(e[r].className,!0)),r++;else for(i=t===f?n[3]-n[1]+1:n[2]-n[0]+1;i--;)u.push("");return u},removeStyle:function(t,i){var f=this.XLObj;if(!f.model.isReadOnly){i=i||{cellStyle:!0,tableStyle:!0,format:!0,border:!0};var w,g,e,r,o,b,l,h,u,c,s,k,a,y,d=0,v=this._borderPosition,nt=f._getSheetIndex(i.sheetIdx),p=f.getSheet(nt);for(t=f._getRangeArgs(t,"object"),w=f._getSelectedCells(nt,t).selCells,g=w.length;d<g;)a=!1,r=w[d],i.skipHiddenRow&&f._isHiddenRow(r.rowIndex,i.sheetIdx)||(i.format&&(i.cellStyle&&i.tableStyle?f.XLEdit._clearDataContainer({cellIdx:r,property:["format","formats","tformats"]}):(i.cellStyle&&f._hasCellStyle(r.rowIndex,r.colIndex,i.sheetIdx)||i.tableStyle&&f._isTableRange(r.rowIndex,r.colIndex,i.sheetIdx))&&(k=[i.cellStyle?"formats":"tformats"],b=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,i.cellStyle?"tformats":"formats",i.sheetIdx),b?(o=this.getFormatHashCode(b),this._updateFormatClass(r,o)):k.push("format"),f.XLEdit._clearDataContainer({cellIdx:r,property:k}))),i.border&&(i.cellStyle&&i.tableStyle?(l=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(h,l),v[0]in h&&r.rowIndex&&(e=r.rowIndex-1,o=f.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(e,r.colIndex,s,u,"bottom","bottom",!0),a=!0),v[1]in h&&(y=!0,e=r.colIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.colCount&&(c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),v[3]in s&&(u.right!=s.left&&(u.right=s.left,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)),y=!1)),y&&(delete u.right,f.getObjectLength(u)?(o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):f.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[2]in h&&(y=!0,e=r.rowIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.rowCount&&(c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),v[0]in s&&(u.bottom!=s.top&&(u.bottom=s.top,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)),y=!1)),y&&(delete u.bottom,f.getObjectLength(u)?(o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):f.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),v[3]in h&&r.colIndex&&(e=r.colIndex-1,o=f.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,e,s,u,"right","right",!0),a=!0),a&&f.XLEdit._clearDataContainer({cellIdx:r,property:["borders","tborders"]})):i.cellStyle?(l=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},v[0]in l&&r.rowIndex&&(e=r.rowIndex-1,o=f.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"bottom"in s?l.bottom===u.bottom&&("top"in h?(u.bottom=h.top,o=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:e,colIndex:r.colIndex},o,!0)):s.bottom!=u.bottom&&(u.bottom=s.bottom,o=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:e,colIndex:r.colIndex},o,!0))):this._remStyle(e,r.colIndex,s,u,"top","bottom"),a=!0),v[1]in l&&(e=r.colIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.colCount?(c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),"left"in s?l.right===u.right&&("right"in h?(u.right=h.right,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):s.left!=u.right&&(u.right=s.left,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0))):this._remStyle(r.rowIndex,r.colIndex,h,u,"right","right")):this._remStyle(r.rowIndex,r.colIndex,h,u,"right","right"),a=!0),v[2]in l&&(e=r.rowIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.rowCount?(c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),"top"in s?l.bottom===u.bottom&&("bottom"in h?(u.bottom=h.bottom,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):s.top!=u.bottom&&(u.bottom=s.top,o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0))):this._remStyle(r.rowIndex,r.colIndex,h,u,"bottom","bottom")):this._remStyle(r.rowIndex,r.colIndex,h,u,"bottom","bottom"),a=!0),v[3]in l&&r.colIndex&&(e=r.colIndex-1,o=f.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),"right"in s?l.left===u.right&&("left"in h?(u.right=h.left,o=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:e},o,!0)):s.right!=u.right&&(u.right=s.right,o=this._getBorderHashCode(u),this._updateFormatClass({rowIndex:r.rowIndex,colIndex:e},o,!0))):this._remStyle(r.rowIndex,e,h,u,"left","right"),a=!0),a&&f.XLEdit._clearDataContainer({cellIdx:r,property:["borders"]})):i.tableStyle&&(l=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"borders",i.sheetIdx)||{},h=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"tborders",i.sheetIdx)||{},"top"in h&&!("top"in l)&&r.rowIndex&&(e=r.rowIndex-1,o=f.XLEdit.getPropertyValue(e,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(e,r.colIndex,s,u,"bottom","bottom",!0),a=!0),"right"in h&&!("right"in l)&&(e=r.colIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.colCount?(c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,r.colIndex,s,u,"left","right",!0)):(delete u.right,f.getObjectLength(u)?(o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):f.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"bottom"in h&&!("bottom"in l)&&(e=r.rowIndex+1,o=f.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),e<p.rowCount?(c=f.XLEdit.getPropertyValue(e,r.colIndex,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(e,r.colIndex,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,r.colIndex,s,u,"top","bottom",!0)):(delete u.bottom,f.getObjectLength(u)?(o=this._getBorderHashCode(u),this._updateFormatClass(r,o,!0)):f.XLEdit._clearDataContainer({cellIdx:r,property:["border"]})),a=!0),"left"in h&&!("left"in l)&&r.colIndex&&(e=r.colIndex-1,o=f.XLEdit.getPropertyValue(r.rowIndex,e,"border",i.sheetIdx),u=this.getBorderFromHashCode(o),c=f.XLEdit.getPropertyValue(r.rowIndex,e,"borders",i.sheetIdx)||{},s=f.XLEdit.getPropertyValue(r.rowIndex,e,"tborders",i.sheetIdx)||{},n.extend(s,c),this._remStyle(r.rowIndex,e,s,u,"right","right",!0),a=!0),a&&f.XLEdit._clearDataContainer({cellIdx:r,property:["tborders"]})))),d++}},_remStyle:function(n,t,i,r,u,f,e){var o=this.XLObj;u in i?e&&i[u]==r[f]||(r[f]=i[u],this._updateFormatClass({rowIndex:n,colIndex:t},this._getBorderHashCode(r),!0)):(delete r[f],o.getObjectLength(r)?this._updateFormatClass({rowIndex:n,colIndex:t},this._getBorderHashCode(r),!0):o.XLEdit._clearDataContainer({cellIdx:{rowIndex:n,colIndex:t},property:["border"]}))},_refreshStyles:function(t,i,r){for(var e,f,o,h="format",s="border",a=!i||i===h,v=!i||i===s,u=this.XLObj,c=u._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),l=c.length;l--;)cellIdx=c[l],a&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"formats")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tformats")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._createFormatClass(f),this._updateFormatClass(cellIdx,o,!1)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,h)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[h]})),v&&(e=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"borders")||{},f=u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,"tborders")||{},n.extend(f,e),u.getObjectLength(f)?(o=this._getBorderHashCode(f),this._updateFormatClass(cellIdx,o,!0)):u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&(r,style=this.getBorderFromHashCode(hCode),"right"in style,u.XLEdit.getPropertyValue(cellIdx.rowIndex,cellIdx.colIndex,s)&&u.XLEdit._clearDataContainer({cellIdx:cellIdx,property:[s]})))},updateFormat:function(n,t){var r=this.XLObj,i,u,f,e;if(!r.model.isReadOnly){for(f=["topborder","leftborder"],e=n.format,t=r._getRangeArgs(t,"object"),u=r._getSelectedCells(r.getActiveSheetIndex(),t).selCells,i=u.length;i--;)this._updateHashCodeClass(u[i],e[i]);for(i=2;i--;)this._updateBorderClass(t,n[f[i]],f[i])}},_updateBorderClass:function(n,t,i){var r,u,f=this.XLObj,e="topborder",o=i===e?n[0]-1:n[1]-1;if(o>=0)for(u=i===e?f._getSelectedRange({rowIndex:n[0]-1,colIndex:n[1]},{rowIndex:n[0]-1,colIndex:n[3]}):f._getSelectedRange({rowIndex:n[0],colIndex:n[1]-1},{rowIndex:n[2],colIndex:n[1]-1}),r=u.length;r--;)this._updateFormatClass(u[r],t[r],!0)},updateUniqueFormat:function(n,i,r){var u=this.XLObj,o,h,i,e,c,f,s,l;if(!u.model.isReadOnly){for(o=u.getActiveSheetIndex(),h=u.getSheet(o),i=u._getRangeArgs(i,"object"),e=u._getSelectedCells(o,i).selCells,f=e.length;f--;)c=u._isUndoRedo?t.isNullOrUndefined(n[f].format)?"e-format":n[f].format:n,this._updateFormatClass(e[f],c),u.XLEdit._updateDataContainer(e[f],{dataObj:{formats:this.getFormatFromHashCode(c)},sheetIdx:o}),(r=="Title"||r=="Heading 4")&&(u._isRowViewable(o,e[f].rowIndex)&&(l=u.getCell(e[f].rowIndex,e[f].colIndex)),s=u._detailsFromGlobalSpan(e[f].rowIndex,e[f].colIndex,"height",u.XLEdit.getPropertyValue(e[f].rowIndex,e[f].colIndex,"value2"),h.columnsWidthCollection[e[f].colIndex]),s>=u.model.rowHeight&&(l&&l.parent().outerHeight(s),h.rowsHeightCollection[e[f].rowIndex]=s),u.model.allowFreezing&&u.XLFreeze._refreshFRowResize(e[f].rowIndex));u._refreshRangeTRHght(o,u.swapRange(i))}},_hasFormat:function(n){return n?!t.isNullOrUndefined(n.match(/e-format|e-border/)):!1},getFormatHashCode:function(n){var i,u,t="",r=0,f="background-color",e="color",o="font-family",s="font-size",h=["font-style","text-decoration","vertical-align","text-align","font-weight"],l=h.length,a=["FontStyle","TextDecoration","VerticalAlign","TextAlign","FontWeight"],c="text-indent";for(t=(f in n)?n[f].replace("#",""):"6N",t+=(e in n)?n[e].replace("#",""):"6N",(o in n)?(i=this._getStyleCode("FontFamily",n[o]),t+=i||"2N"):t+="2N",t+=(s in n)?this._getFontCode(n[s]):"2N";r<l;)u=h[r],u in n?(i=this._getStyleCode(a[r],n[u]),t+=i||"1N"):t+="1N",r++;return t.endsWith("N")||(t=t+"N"),c in n&&(t+=n[c].replace(/pt|-|\+/g,"")),"e-format"+t},getFormatFromHashCode:function(n){var t,f,e,o,s,h,c,l,u,a,i,r={},v="e-format";if(n=n||"",!n.indexOf(v)){for(e="pt",t=f=0,a=["FontStyle","TextDecoration","VerticalAlign","TextAlign"],c=["font-style","text-decoration","vertical-align","text-align"],l=c.length,i=n.replace(v,"").split("N"),i[t].length===1?t++:(r["background-color"]="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),i[t].length===1?t++:(r.color="#"+i[t].slice(0,6),i[t]=i[t].substr(6)),u=i[t].length,u===1?t++:(s="FontFamily",o="font-family",u===2?(r[o]=this._getCodeStyle(s,i[t].slice(0,1)+"1N"),t++):(r[o]=this._getCodeStyle(s,i[t].slice(0,2)),i[t]=i[t].substr(2))),u=i[t].length,u===1?t++:(h="font-size",u===2?(r[h]=i[t].slice(0,1)+e,t++):(r[h]=i[t].slice(0,2)+e,i[t]=i[t].substr(2)));f<l;)i[t].length===1?t++:(r[c[f]]=this._getCodeStyle(a[f],i[t].slice(0,1)),i[t]=i[t].substr(1)),f++;i[t]==="2"&&(r["font-weight"]="bold");t++;i[t]&&(r["text-indent"]=i[t]+e)}return r},getBorderFromHashCode:function(n,t){var r,i=0,u={},e="e-border",f=this._borderPosition;return n=n||"",n.indexOf(e)||(r=n.replace(e,"").split("N"),r[i].length>1?(u[f[1]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1?(u[f[2]]=this._concatBorderCode(r[i]),t&&(r[i]=r[i].substr(8))):i+=3,t&&(r[i].length>1?(u[f[0]]=this._concatBorderCode(r[i]),r[i]=r[i].substr(8)):i+=3,r[i].length>1&&(u[f[3]]=this._concatBorderCode(r[i])))),u},_formatPainter:function(){var n=this.XLObj,f,e,h;if(n.model.allowFormatPainter&&n.model.allowCellFormatting){var c=n.getActiveSheetIndex(),t,i,o=0,s=n.getSheet(c),r=s._startCell,u=s._endCell;for(this._rowLength=u.rowIndex-r.rowIndex+1,this._colLength=u.colIndex-r.colIndex+1,f=this._rowLength,e=this._colLength,h=n.getRangeData({range:[r.rowIndex,r.colIndex,u.rowIndex,u.colIndex],property:["value","value2","type","wrap","formatStr","thousandSeparator","decimalPlaces","cFormatRule","hyperlink","format","cellType"]}),this._getEformatClass=new Array(f),t=0;t<f;t++)for(this._getEformatClass[t]=new Array(e),i=0;i<e;i++)this._getEformatClass[t][i]={rangeData:h[o]},o++}},_fPMouseUp:function(){var o,b,n=this.XLObj,f=n.getActiveSheetIndex(),p=n.getSheet(f),d=n._getContent(f).find("div.e-content"),k=0,g,u=p._selectedCells,nt=p._startCell,tt=p._endCell,s,h,i=0,it=0,c,l,rt,ut,w,ft=tt.rowIndex-nt.rowIndex,et=tt.colIndex-nt.colIndex,e,st=n.XLEdit,r,a=p.selectedRange,v=n.getRangeData({range:a,property:["wrap","hyperlink","value","value2","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator","type"]}),y={sheetIndex:f,reqType:"format-painter",range:a,beforeData:v,bFormat:this.getHashCodeClassAsArray(a),unwrapCells:[],wrapCells:[]},ot=n.element.find("#"+n._id+"_Ribbon_Home_Clipboard_FormatPainter");for(n._dupDetails=!0,s=0;s<=ft;s++){for(it++,h=0;h<=et;h++){if(k++,e=n._getAlphaRange(f,u[i].rowIndex,u[i].colIndex,u[i].rowIndex,u[i].colIndex),cell=u[i],r=this._getEformatClass[s][h],this.removeStyle([u[i].rowIndex,u[i].colIndex,u[i].rowIndex,u[i].colIndex],{cellStyle:!0,tableStyle:!1,format:!0}),o={type:r.rangeData.type?r.rangeData.type:"general"},r.rangeData.format&&(o.style=this.getFormatFromHashCode(r.rangeData.format)),r.rangeData.formatStr&&(o.formatStr=r.rangeData.formatStr),r.rangeData.decimalPlaces&&(o.decimalPlaces=r.rangeData.decimalPlaces),r.rangeData.thousandSeparator&&(o.thousandSeparator=r.rangeData.thousandSeparator),this.format(o,e),r.rangeData.cellType&&(b=n._dataContainer.sheetCellType[r.rangeData.cellType],b.text="",n.XLCellType._renderControls(u[i].rowIndex,u[i].colIndex,f,b)),!t.isNullOrUndefined(r.rangeData.cFormatRule))for(w=0,ut=r.rangeData.cFormatRule.length;w<ut;w++)g=r.rangeData.cFormatRule[w],l=g.split("_"),rt=l[5],l[l.indexOf(rt)]=e,n._dataContainer.cFormatRule=l.join("_"),c=n._dataContainer.cFormatRule.split("_"),n.XLCFormat._cFormat(c[0],c[2],c[3],c[4],c[5]);if(v[i].wrap&&!r.rangeData.wrap?(n.setWrapText("unwrap",e),y.wrapCells.push({rowIndex:u[i].rowIndex,colIndex:u[i].colIndex})):!v[i].wrap&&r.rangeData.wrap&&(n.setWrapText("wrap",e),y.unwrapCells.push({rowIndex:u[i].rowIndex,colIndex:u[i].colIndex})),r.rangeData.hyperlink&&!v[i].hyperlink?this.format({style:{"text-decoration":"underline",color:n._hlColor}},e):!r.rangeData.hyperlink&&v[i].hyperlink&&(this.format({style:{"text-decoration":"none"}},e),n.addClass(n.getCell(cell.rowIndex,cell.colIndex,f).find("a"),st.getPropertyValue(cell.rowIndex,cell.colIndex,"format",f))),i++,k===et+1){k=0;break}this._colLength===h+1&&(h=-1)}if(it===ft+1)break;this._rowLength===s+1&&(s=-1)}this._formatEnable=!1;d.addClass("e-ss-cursor");d.removeClass("e-ss-fpcursor");ot.length&&ot.ejToggleButton("option",{toggleState:!1});n._dupDetails=!1;y.afterData=n.getRangeData({range:a,property:["wrap","hyperlink","value","value2","cFormatRule","format","cellType","formats","formatStr","decimalPlaces","thousandSeparator","type"]});y.aFormat=this.getHashCodeClassAsArray(a);n.XLSelection.refreshSelection();n.XLDragFill.positionAutoFillElement();n._isUndoRedo||n._completeAction(y)},_getFormatObj:function(n){if("type"in n||"formatStr"in n){var t={},i="thousandSeparator";t.formatStr="formatStr"in n?n.formatStr:this.XLObj._getFormatString(n.type,n.decimalPlaces);t.decimalPlaces="decimalPlaces"in n?n.decimalPlaces:["currency","accounting","number"].indexOf(n.type)!==-1?parseInt(t.formatStr.replace(/{0:|[A-Z]|}/g,"")):0;i in n?t[i]=n[i]:n.type==="number"&&(t[i]=!0);n.format=t}return"style"in n&&n.style.border&&(n.border=n.style.border,delete n.style.border,this.XLObj.getObjectLength(n.style)||delete n.style),n},_createFormatClass:function(n,t,i){var r,u=this.XLObj._dataContainer.hashCode;return(t=t||this.getFormatHashCode(n),u.indexOf(t)!==-1)?t:(r=this._getCssPropertyAsString(n),this._writeCssRules(t,r,i),u.push(t),t)},_writeCssRules:function(n,t,i){var r=document.getElementById(this.XLObj._id+"_sscustomformat"),u=".e-spreadsheet .e-spreadsheetmainpanel ."+n+" {"+t+"}";r.styleSheet?r.styleSheet.cssText+=u:r.appendChild(document.createTextNode(u));i&&(u=u.replace(".e-spreadsheetmainpanel ",""),r.styleSheet?r.styleSheet.cssText+=u:r.appendChild(document.createTextNode(u)))},_getCssPropertyAsString:function(n){var t="",i,r,u;if("border"in n){i=n.border;for(r in i)n["border-"+r]=i[r];delete n.border}for(u in n)t=t+(u+":"+n[u]+";");return t},_splitBorderCode:function(n){return n=n.split(" "),n[0].replace("px","")+this._getStyleCode("BorderStyle",n[1])+n[2].replace("#","")},_concatBorderCode:function(n){return n.substr(0,1)+"px "+this._getCodeStyle("BorderStyle",n.substr(1,1))+" #"+n.substr(2,6)},_getCodeStyle:function(n,i){n=t.Spreadsheet[n];for(var r in n)if(n.hasOwnProperty(r)&&n[r]===i)return r},_getStyleCode:function(n,i){return i=i||"",t.Spreadsheet[n][i.toLowerCase()]},_getFontCode:function(n){var t=n.replace(/pt|-|\+/g,"");return t.length===2?t:t.length===1?t+"1N":"2N"},_getExtendedFormat:function(t,i,r){var u=this.XLObj.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"formats")||{};return r?(n.extend(i,u),{format:i}):u["text-indent"]&&i["text-align"]?(delete u["text-indent"],delete u["text-align"],n.extend(i,u),{format:i}):(n.extend(u,i),{format:u})},_updateHashCodeClass:function(n,t){var i,r,u=this.XLObj,f={},e=u._formatRegx,o=u._borderRegx;t&&(i=t.indexOf("e-format")>-1,r=t.indexOf("e-border")>-1,i&&(f.format=t.match(e)[0]),r&&(f.border=t.match(o)[0]),(i||r)&&u.XLEdit._updateDataContainer({rowIndex:n.rowIndex,colIndex:n.colIndex},{dataObj:f}))},_updateFormatClass:function(n,t,i){t&&(t.indexOf("e-format")>-1||t.indexOf("e-border")>-1)&&this.XLObj.XLEdit._updateDataContainer(n,{dataObj:i?{border:t}:{format:t}})},_applyBorderCss:function(n,t){var e=this._borderPosition,h=e[0],o=e[1],s=e[2],c=e[3],i=t[0],r=t[1],u=t[2],f=t[3];h in n&&(i?this._updateBorder([i-1,r,i-1,f],n,s,!0):this._updateBorderObj([i,r,i,f],n,h));o in n&&this._updateBorder([i,f,u,f],n,o);s in n&&this._updateBorder([u,r,u,f],n,s);c in n&&(r?this._updateBorder([i,r-1,u,r-1],n,o,!0):this._updateBorderObj([i,r,u,r],n,c))},_applyAllBorderCss:function(n,t){var u=this._borderPosition[1],f=this._borderPosition[2],i=t[0],r=t[1],e=t[2],o=t[3];this._updateBorder(t,n,u+" "+f);i&&this._updateBorder([i-1,r,i-1,o],n,f,!0);r&&this._updateBorder([i,r-1,e,r-1],n,u,!0)},_updateBorderObj:function(n,t,i){for(var r,o,u,f,e=n[0],s=n[2];e<=s;){for(r=n[1],o=n[3];r<=o;)f={rowIndex:e,colIndex:r},u=this._extendBorderObj(f,this._parseBorder(t,i).border,this._isFAT),this.XLObj.XLEdit._updateDataContainer(f,{dataObj:this._isFAT?{tborders:u}:{borders:u}}),r++;e++}},_updateBorder:function(t,i,r,u){var v,tt,p,w,h,c,l,b,k,o,e,d,s,g=!1,nt=!1,f=this._borderPosition,y=t[0],it=t[2],rt=i.isGridBorder,a=this.XLObj;for(delete i.isGridBorder;y<=it;){for(v=t[1],tt=t[3];v<=tt;){if(l={rowIndex:y,colIndex:v},p=y,w=v,u?(nt=r===f[2],nt?p++:w++,o=this._parseBorder(i,nt?f[0]:f[3]).border):o=this._parseBorder(i,r).border,rt?u||(e=this._extendBorderObj(l,i,this._isFAT),g=!0):u?(b={rowIndex:p,colIndex:w},e=this._extendBorderObj(b,o,this._isFAT),a.XLEdit._updateDataContainer(b,{dataObj:this._isFAT?{tborders:e}:{borders:e},skipCell:i.skipCell})):(e=this._extendBorderObj(l,this._parseBorder(i,r).border,this._isFAT),g=!0),g&&a.XLEdit._updateDataContainer(l,{dataObj:this._isFAT?{tborders:e}:{borders:e},skipCell:i.skipCell}),!(u&&a.hasSpan(l))){if(h=l.colIndex,r===f[1]&&u&&h)while(h){if(!a.XLEdit.getPropertyValue(0,h,"isCHide"))break;h--}if(c=l.rowIndex,r===f[2]&&u&&c)while(c){if(!a.XLEdit.getPropertyValue(c,0,"isRHide"))break;c--}s=a.XLEdit.getPropertyValue(c,h,"border");s=s?this.getBorderFromHashCode(s):a.XLEdit.getPropertyValue(c,h,"borders")||{};u?(e={},f[1]in s&&(e[f[3]]=s[f[1]]),f[2]in s&&(e[f[0]]=s[f[2]]),o=this._isFAT?n.extend(o,e):n.extend(e,o)):o=this._isFAT?n.extend(o,s):n.extend(s,o);d=this._parseBorder(o,f[1]+" "+f[2],u);k=this._getBorderHashCode(d.border);this._createFormatClass(d,k);this._updateFormatClass({rowIndex:c,colIndex:h},k,!0)}v++}y++}},_extendBorderObj:function(t,i,r){var f=this.XLObj,u=f.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,r?"tborders":"borders")||{};return n.extend(u,i),u},_getBorderHashCode:function(n,t){var i="",r="1N1N6N",u=this._borderPosition,f=u[0],e=u[1],o=u[2],s=u[3];return i=e in n?this._splitBorderCode(n[e]):r,i+=o in n?this._splitBorderCode(n[o]):r,t&&(i+=f in n?this._splitBorderCode(n[f]):r,i+=s in n?this._splitBorderCode(n[s]):r),"e-border"+i},_parseBorder:function(n,t,i){var r,u,e={border:{}},f=this._borderPosition;for(t=t.split(" "),r=t.length;r--;)u=key=t[r],i&&(u=key===f[1]?f[3]:f[0]),value=n[u],value&&(e.border[key]=value);return e},_refreshTableRowCol:function(n){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()),u=r.tableManager,t=u[n.tid];t&&(n.isInsertBefore?n.pos==="row"?(t.range[0]+=n.cnt,t.range[2]+=n.cnt):(t.range[1]+=n.cnt,t.range[3]+=n.cnt):(n.pos==="row"?t.range[2]=t.range[2]+n.cnt:t.range[3]=t.range[3]+n.cnt,i._dupDetails=!0,i.XLFormat._createTable(n.tid,{format:t.format}),i._dupDetails=!1))},_refreshHiddenBorder:function(n,t,i,r){var c,u,s,e,o,b,k,p,g,nt,h,tt,l,v,d,a,w,y,f=this.XLObj.XLEdit,it=this.XLObj.getSheet().usedRange;if(i?(h="bottom",v="top",tt="isRHide",it=it.colIndex):(h="right",v="left",tt="isCHide",it=it.rowIndex),r){for(p=n,g=t;g++;)if(e=i?g:0,o=i?0:g,!f.getPropertyValue(e,o,tt))break;while(p){if(e=i?p:0,o=i?0:p,!f.getPropertyValue(e,o,tt))break;p--}for(c=0;c<=it;c++)i?(e=p,u=b=n,s=o=k=c):(o=p,u=e=b=c,s=k=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),d=f.getPropertyValue(e,o,"borders"),a=f.getPropertyValue(u,s,"borders"),w=f.getPropertyValue(e,o,"tborders"),y=f.getPropertyValue(b,k,"tborders"),(!d||d&&!d[h])&&(a&&a[v]||(!w||w&&!w[h])&&y&&y[v])&&(nt=f.getPropertyValue(e,o,"border"),l=this.getBorderFromHashCode(nt),delete l[h],w&&w[h]&&(l[h]=w[h]),l.bottom||l.right?(nt=this._getBorderHashCode(l),f._updateDataContainer({rowIndex:e,colIndex:o},{dataObj:{border:nt}})):f._clearDataContainer({cellIdx:{rowIndex:e,colIndex:o},property:["border"]})),i?(k=p,u=e=g,s=o=b=c):(b=p,s=o=g,u=e=k=c),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),eCelBrdr=f.getPropertyValue(u,s,"borders"),eTblBrdr=f.getPropertyValue(e,o,"tborders"),(!d||d&&!d[h])&&(eCelBrdr&&eCelBrdr[v]||(!w||w&&!w[h])&&eTblBrdr&&eTblBrdr[v])&&(l={},(d||f.getPropertyValue(k,b,"border"))&&(nt=f.getPropertyValue(k,b,"border"),l=this.getBorderFromHashCode(nt)),l[h]=eCelBrdr&&eCelBrdr[v]?eCelBrdr[v]:eTblBrdr[v],nt=this._getBorderHashCode(l),f._updateDataContainer({rowIndex:k,colIndex:b},{dataObj:{border:nt}}))}else{if(e=i?n-1:0,o=i?0:n-1,f.getPropertyValue(e,o,tt)){for(p=n-1;p;){if(e=i?p:0,o=i?0:p,!f.getPropertyValue(e,o,tt))break;p--}for(c=0;c<=it;c++)i?(e=p,s=o=k=c,u=b=n-1):(o=p,u=e=b=c,s=k=n-1),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),d=f.getPropertyValue(e,o,"borders"),a=f.getPropertyValue(u,s,"borders"),w=f.getPropertyValue(e,o,"tborders"),y=f.getPropertyValue(b,k,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!d||d&&!d[h]||d&&d[h]!==(l&&l[h]))&&(!w||w&&!w[h]||w&&w[h]&&(f.getPropertyValue(e,o,"border")!==this._getBorderHashCode(w)||a&&a[v]))&&(a&&a[v]||l&&l[h]&&(!a||a&&!a[v])||y&&y[v])&&(e=i?u:s,o=i?s:u,this._showHiddenBorder(p,e,o,c,i));for(c=0;c<=it;c++)i?(e=u-1,u=b=n,s=k=o=c):(o=s-1,u=e=b=c,s=k=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),a=f.getPropertyValue(e,o,"borders"),eCelBrdr=f.getPropertyValue(u,s,"borders"),y=f.getPropertyValue(e,o,"tborders"),eTblBrdr=f.getPropertyValue(b,k,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!a||a&&!a[h]||a&&a[h]!==(l&&l[h]))&&(!y||y&&!y[h]||y&&y[h]&&f.getPropertyValue(b,k,"border")!==this._getBorderHashCode(y))&&(eCelBrdr&&eCelBrdr[v]||l&&l[h]&&(!eCelBrdr||eCelBrdr&&!eCelBrdr[v])||eTblBrdr&&eTblBrdr[v])&&(e=i?u:s,o=i?s:u,this._showHiddenBorder(n-1,e,o,c,i))}for(n;n<t;n++)if(g=n+1,i?(e=g,o=s=0,u=n):(o=g,e=u=0,s=n),f.getPropertyValue(e,o,tt)||f.getPropertyValue(u,s,tt))for(c=0;c<=it;c++)i?(u=g,s=o=c,e=n):(u=e=c,s=g,o=n),f.getPropertyValue(u,s,"isMHide")&&(u=f.getPropertyValue(u,s,"mergeIdx"),s=u.colIndex,u=u.rowIndex),a=f.getPropertyValue(e,o,"borders"),eCelBrdr=f.getPropertyValue(u,s,"borders"),y=f.getPropertyValue(e,o,"tborders"),eTblBrdr=f.getPropertyValue(u,s,"tborders"),l=this.getBorderFromHashCode(f.getPropertyValue(e,o,"border")),(!a||a&&!a[h]||a&&a[h]!==(l&&l[h]))&&(!y||y&&!y[h]||y&&y[h]&&(f.getPropertyValue(e,o,"border")!==this._getBorderHashCode(y)||eCelBrdr&&eCelBrdr[v]))&&(eCelBrdr&&eCelBrdr[v]||l&&l[h]&&(!eCelBrdr||eCelBrdr&&!eCelBrdr[v])||eTblBrdr&&eTblBrdr[v])&&(u=i?s:u,this._showHiddenBorder(n,g,u,c,i))}},_showHiddenBorder:function(n,t,i,r,u){var c,l,a,v,y,p,f,w,e,b,k,d,s,h,o=this.XLObj.XLEdit;u?(a=t,p=r,l=v=i,c=y=n,f="bottom",h="top"):(v=t,y=r,c=a=i,l=p=n,f="right",h="left");w=o.getPropertyValue(c,l,"border");e=this.getBorderFromHashCode(w);e[f]&&delete e[f];s=o.getPropertyValue(c,l,"tborders");k=o.getPropertyValue(a,v,"borders");d=o.getPropertyValue(a,v,"tborders");b=o.getPropertyValue(y,p,"borders");b&&b[f]?e[f]=b[f]:k&&k[h]?e[f]=k[h]:(s&&s[f]||d&&d[h])&&(e[f]=s&&s[f]?s[f]:d[h]);e.bottom||e.right?(w=this._getBorderHashCode(e),o._updateDataContainer({rowIndex:y,colIndex:p},{dataObj:{border:w}})):o._clearDataContainer({cellIdx:{rowIndex:c,colIndex:l},property:["border"]})},_resizeFormatTableMenu:function(){var t=this.XLObj,i=document.getElementById(t._id+"_formatastable");t._tabMode||t._phoneMode?(n("#"+t._id+"_Ribbon").append(n("#"+t._id+"_formatastable").parent()),t._removeClass(i,"e-formatastable"),t.addClass(i,"e-formatastable-adaptive"),i.style.height=t._dlgHeight+"px"):(t._removeClass(i,"e-formatastable-adaptive"),t.addClass(i,"e-formatastable"))},_resizeStyleMenu:function(){var t=this.XLObj,i=document.getElementById(t._id+"_cellstyles");t._tabMode||t._phoneMode?(n("#"+t._id+"_Ribbon").append(n("#"+t._id+"_cellstyles").parent()),t._removeClass(i,"e-cellstyles"),t.addClass(i,"e-cellstyles-adaptive"),i.style.height=t._dlgHeight+"px"):(t._removeClass(i,"e-cellstyles-adaptive"),t.addClass(i,"e-cellstyles"),i.style.height="auto")},_resizeBorderMenu:function(t){var i=this.XLObj,r=i.element.find(".e-bordercontainer"),u;i._phoneMode&&(n("#"+i._id+"_Ribbon").append(n("#"+i._id+"_Ribbon_Border").parent()),r.length?r.show():(this._createBorderDiv(),i.element.find(".e-bordercontainer").show()),i.addClass(r[0],"e-border e-adaptive"),t.cancel=!0,u=n("#"+i._id+"_Ribbon_Home_Font_Border").ejSplitButton("instance"),u.contstatus=!0)},_createBorderDiv:function(){for(var i=this.XLObj,f="<div class='e-ss-bdr-header'><span id ='"+i._id+"_border_back' class = 'e-border-back e-icon e-ss-leftarrow'/><\/div><div class='e-ss-border-content'>",e="",o=t.buildTag("div#"+i._id+"_bordercontainer.e-bordercontainer",{},{display:"none",height:i._responsiveHeight-2}),u=i.XLRibbon._borderMenuData,r=0;r<13;r++)e+="<div class = 'e-bordercell' id="+u[r].id+">"+i._renderDIV("e-ss-border "+u[r].sprite+" e-ss-menu","",u[r].text)+"<\/div>";f+=e+"<\/div>";o.append(n(f));n("#"+i._id+"_Ribbon").append(o);i._on(n("#"+i._id+"_bordercontainer"),"click",i._borderSelectionClick)}};t.Spreadsheet.FontFamily={"angsana new":"11N",arial:"21N","arial black":"31N",batang:"41N","book antiqua":"51N","browallia new":"61N",calibri:"71N",cambria:"81N",candara:"91N",century:"10","comic sans ms":"11",consolas:"12",constantia:"13",corbel:"14","cordia new":"15",courier:"16","courier new":"17",dilleniaupc:"18",dotum:"19",fangsong:"20",garamond:"21",georgia:"22",gulim:"23",gungsuh:"24",kaiti:"25",jasmineupc:"26","malgun gothic":"27",mangal:"28",meiryo:"29","microsoft jhenghei":"30","microsoft yahei":"31",mingliu:"32",mingliu_hkscs:"33","ms gothic":"34","ms mincho":"35","ms pgothic":"36","ms pmincho":"37",pmingliu:"38","pmingliu-extb":"39",simhei:"40",simsun:"41","simsun-extb":"42",tahoma:"43",times:"44","times new roman":"45","trebuchet ms":"46",verdana:"47","yu gothic":"48","yu mincho":"49"};t.Spreadsheet.FontStyle={normal:"1",italic:"2",oblique:"3"};t.Spreadsheet.TextAlign={left:"1",right:"2",center:"3",justify:"4"};t.Spreadsheet.VerticalAlign={top:"1",middle:"2",bottom:"3"};t.Spreadsheet.TextDecoration={none:"1",underline:"2",overline:"3","line-through":"4","line-through underline":"5"};t.Spreadsheet.FontWeight={normal:"1",bold:"2"};t.Spreadsheet.BorderStyle={solid:"1",dashed:"2",dotted:"3"};t.Spreadsheet.CellFormat={number:"{0:N2}",currency:"{0:C2}",accounting:"{0:C2}",percentage:"{0:P2}",shortdate:"{0:M/d/yyyy}",longdate:"{0:dddd, MMMM dd, yyyy}",time:"{0:h:mm:ss tt}",scientific:"{0:N2}"}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cellType=function(n){this.XLObj=n;this._isIntrnlUpdate=!1};t.spreadsheetFeatures.cellType.prototype={_renderControls:function(t,i,r,u,f){var ut,et,g,o,b,y;if(u){var s,c,a,nt,e=this.XLObj,ft=e._browserDetails.name,l,h=e._getSheetIndex(r),tt=e.getCell(t,i,h),ot=e.getSheet(h),it=e.XLEdit.getPropertyValue(t,i,"value2",h),k=u.type,d=e._generateHeaderText(i+1),p=u.text||e.XLEdit.getPropertyValue(t,i,"value2",h)||u.type+d+(t+1),w=e._dataContainer.sheetCellType,ht=e._getColWidth(i,r),st=e._getRowHeight(t,r),rt=e.XLEdit.getPropertyValue(t,i,"cellType"),v=rt>-1?rt:e.getObjectLength(w);e._textClip(t,i,"delete","",!0);e._textClip(t,i,"add","");tt&&(c=tt[0]);e.addClass(c,"e-cellreadonly");e._dupDetails||(rt?u.isChecked=w[v].isChecked:ot.cellTypes.push({range:e._getAlphaRange(r,t,i,t,i),settings:u}));switch(k){case"Button":s=e._id+"_btn_"+h+d+(t+1);e.XLFormat._writeCssRules("e-btncls"+t+i,"border: 0px; vertical-align: middle;padding: 0px;color:"+u.color+";background:"+u["background-color"]+";");c&&(c.innerHTML="<button id ="+s+' class = "e-btncls'+t+i+'"><\/button>');(c&&ft==="mozilla"||ft==="msie")&&(e.addClass(c,"e-btnhgt"),e.addClass(tt.parents(".e-table")[0],"e-btnhgt"));f||(a={type:k,id:s,text:p,color:u.color||"","background-color":u["background-color"]||""},w[v]=a,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:v},sheetIdx:h}));n("#"+s).ejButton({type:"button",width:"100%",height:"100%",text:p,create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:u["class"]||""});break;case"CheckBox":s=e._id+"_chk_"+h+d+(t+1);c&&(c.innerHTML="<input id ="+s+' style = "" />');f||(a={type:k,id:s,text:p,isChecked:u.isChecked||it&&it.toLowerCase()==="true"||!1},w[v]=a,nt=e.XLEdit._parseValue(a.isChecked,{rowIndex:t,colIndex:i}),nt.cellType=v,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:nt,sheetIdx:h}),c&&(c.lastChild.textContent=""));n("#"+s).ejCheckBox({text:"",size:"small",change:n.proxy(this.onActiveStateChange),checked:a.isChecked,cssClass:u["class"]||""});break;case"DropDownList":if(l=u.dataSourceSheetIndex||h,s=e._id+"_drpdwn_"+h+d+(t+1),dataRange=u.dataSourceRange&&e.getRangeIndices(u.dataSourceRange),c&&(c.innerHTML="<input id ="+s+" />"),l===h||e.getSheet(l)._isLoaded||e._initSheet(l),e.isUndefined(u.selectedIndex)&&p)for(ut=u.dataSource=u.dataSource||e.getRangeData({range:dataRange,sheetIdx:l}),et=u.field=u.field||"value2",g=ut.length;--g>=0;)if(ut[g][et]===p){u.selectedIndex=g;break}if(f||(a={type:k,id:s,text:p,style:"",dataSource:u.dataSource||"",dataSourceRange:u.dataSourceRange||"",selectedIndex:u.selectedIndex>-1?u.selectedIndex:0,dataSourceSheetIndex:l},w[v]=a,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:v},sheetIdx:h})),u.dataSourceRange)if(o=e._getSelectedRange({rowIndex:dataRange[0],colIndex:dataRange[1]},{rowIndex:dataRange[2],colIndex:dataRange[3]}),b=e.XLEdit._getPropWithCellIdx([o[0].rowIndex,o[0].colIndex,o[o.length-1].rowIndex,o[o.length-1].colIndex],"ddlRange",l),b.length===0)e.updateUniqueData({ddlRange:[{rowIndex:t,colIndex:i,sheetIndex:h}]},[o[0].rowIndex,o[0].colIndex,o[o.length-1].rowIndex,o[o.length-1].colIndex],"",l);else for(y=0;y<o.length;y++)b=e.XLEdit.getPropertyValue(o[y].rowIndex,o[y].colIndex,"ddlRange",l),b?(b.push({rowIndex:t,colIndex:i}),e.XLEdit._updateDataContainer({rowIndex:o[y].rowIndex,colIndex:o[y].colIndex},{dataObj:{ddlRange:b},sheetIdx:l})):e.XLEdit._updateDataContainer({rowIndex:o[y].rowIndex,colIndex:o[y].colIndex},{dataObj:{ddlRange:[{rowIndex:t,colIndex:i}]},sheetIdx:l});n("#"+s).ejDropDownList({width:"100%",height:e.model.rowHeight-1,change:n.proxy(this.onActiveValueChange),dataSource:u.dataSource||e.getRangeData({range:dataRange,sheetIdx:l}),fields:{text:u.field||"value2"},watermarkText:u.watermarkText||"Select an option",cssClass:u["class"]||"",selectedIndex:u.selectedIndex>-1?u.selectedIndex:"",beforePopupShown:n.proxy(this._onBeforePopupOpen)});break;case"DatePicker":s=e._id+"_dp_"+h+d+(t+1);c&&(c.innerHTML="<input id ="+s+' style = "height:'+(st-1)+'px" />');f||(a={type:k,id:s,text:p,style:""},w[v]=a,e.XLEdit._updateDataContainer({rowIndex:t,colIndex:i},{dataObj:{cellType:v},sheetIdx:h}));n("#"+s).ejDatePicker({width:"100%",height:e.model.rowHeight-1,value:u.value||it||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:u["class"]||""})}}},addCellTypes:function(n,t,i){var r=this.XLObj;r.model.isReadOnly||(Array.isArray(n)&&(n=r._getAlphaRange(i,n[0],n[1],n[2],n[3])),this._rangeCellTypes([{range:n,settings:t}],i,!0))},_rangeCellTypes:function(i,r,u){var y,at,b,vt,ut,st,ht,o,yt;if(i){var f=this.XLObj,it,ft,p,k=[],ct=f._browserDetails.name,s=f._getSheetIndex(r),nt,ot=f._dataContainer,v,e,l,w,tt,h,et,rt,d=f.getSheet(s),g,lt=0,c,a;for((u||!d._isLoaded)&&(lt=d.cellTypes.length,t.merge(d.cellTypes,i),i=d.cellTypes),y=lt,at=d.cellTypes.length;y<at;y++)if(et=f.getRangeIndices(i[y].range),e=i[y].settings,v=f._getSelectedRange({rowIndex:et[0],colIndex:et[1]},{rowIndex:et[2],colIndex:et[3]}),v.length===1)f._dupDetails=!0,this._renderControls(v[0].rowIndex,v[0].colIndex,s,e),f._dupDetails=!1;else{for(b=0,vt=v.length;b<vt;b++){p=e.dataSourceSheetIndex||s;c=v[b].rowIndex;a=v[b].colIndex;f._textClip(c,a,"delete","",!0);f._textClip(c,a,"add");rt=f.getObjectLength(ot.sheetCellType);f._isRowViewable(s,c)&&(l=f.getCell(c,a,s)[0]);text=e.text||f.XLEdit.getPropertyValue(c,a,"value2",s)||e.type+f._generateHeaderText(v[b].colIndex+1)+(v[b].rowIndex+1);l&&(l.innerHTML="");f._hasClass(l,"e-cellreadonly")||f.addClass(l,"e-cellreadonly");ft=f._generateHeaderText(a+1);switch(e.type){case"Button":w=f._id+"_btn"+y+"_"+s+ft+(c+1);f.XLFormat._writeCssRules("e-btncls"+c+a,"border: 0px; vertical-align: middle; padding: 0px;color:"+(e.color||"")+";background:"+(e["background-color"]||"")+";");l&&(l.innerHTML="<button id ="+w+' type="button" class = "e-btncls'+c+a+'"><\/button>');(l&&ct==="mozilla"||ct==="msie")&&(f.addClass(l,"e-btnhgt"),f.addClass($cell.parents(".e-table")[0],"e-btnhgt"));(u||!d._isLoaded)&&(nt={type:e.type,id:w,text:text,color:e.color||"","background-color":e["background-color"]||""},it={cellType:rt});break;case"CheckBox":w=f._id+"_chk"+y+"_"+s+ft+(c+1);l&&(l.innerHTML="<input id ="+w+" />");(u||!d._isLoaded)&&(nt={type:e.type,id:w,text:"",isChecked:e.isChecked||!1},it=f.XLEdit._parseValue(e.isChecked||f.XLEdit.getPropertyValue(c,a,"value2")||"false",{rowIndex:c,colIndex:a}),it.cellType=rt);l&&(l.lastChild.textContent="");break;case"DropDownList":if(w=f._id+"_drpdwn"+y+"_"+s+ft+(c+1),l&&(l.innerHTML="<input id ="+w+" value = "+text+" />"),nt={type:e.type,id:w,style:"",dataSource:e.dataSource||"",dataSourceRange:e.dataSourceRange||"",selectedIndex:e.selectedIndex>-1?e.selectedIndex:"",dataSourceSheetIndex:p},tt=f.getRangeIndices(e.dataSourceRange),h=f._getSelectedRange({rowIndex:tt[0],colIndex:tt[1]},{rowIndex:tt[2],colIndex:tt[3]}),u||!d._isLoaded){if(e.dataSourceRange)if(ut=f.XLEdit._getPropWithCellIdx([h[0].rowIndex,h[0].colIndex,h[h.length-1].rowIndex,h[h.length-1].colIndex],"ddlRange",p),ut.length===0)f.updateUniqueData({ddlRange:[{rowIndex:c,colIndex:a,sheetIndex:s}]},[h[0].rowIndex,h[0].colIndex,h[h.length-1].rowIndex,h[h.length-1].colIndex],"",p);else for(o=0;o<h.length;o++)ut=f.XLEdit.getPropertyValue(h[o].rowIndex,h[o].colIndex,"ddlRange",p),ut?(ut.push({rowIndex:c,colIndex:a,sheetIndex:s}),f.XLEdit._updateDataContainer({rowIndex:h[o].rowIndex,colIndex:h[o].colIndex},{dataObj:{ddlRange:ut},sheetIdx:p})):f.XLEdit._updateDataContainer({rowIndex:h[o].rowIndex,colIndex:h[o].colIndex},{dataObj:{ddlRange:[{rowIndex:c,colIndex:a,sheetIndex:s}]},sheetIdx:p});if(p===s||f.getSheet(p)._isLoaded||f._initSheet(p),f.isUndefined(e.selectedIndex)&&text)for(st=e.dataSource||f.getRangeData({range:tt,sheetIdx:p}),e.dataSource||(e.dataSource=st),ht=e.field||"value2",e.field||(e.field=ht),o=st.length;--o>=0;){if(st[o][ht]===text){nt.selectedIndex=o;break}o==0&&delete nt.selectedIndex}it={cellType:rt}}break;case"DatePicker":w=f._id+"_dp"+y+"_"+s+ft+(c+1);l&&(l.innerHTML="<input id ="+w+" value = "+text+' style = "height:'+(f._getRowHeight(c,s)-1)+'px" />');(u||!d._isLoaded)&&(nt={type:e.type,id:w,style:""},it={cellType:rt})}(u||!d._isLoaded)&&(ot.sheetCellType[rt]=nt,f.XLEdit._updateDataContainer({rowIndex:c,colIndex:a},{dataObj:it,sheetIdx:s}));f._checkIndicesInContainer(s,v[b].rowIndex,v[b].colIndex,"cellType")&&(g=ot.sheetCellType[ot.sheets[s][v[b].rowIndex][v[b].colIndex].cellType],g.type==="CheckBox"&&g.isChecked&&k.push({type:g.type,id:g.id}),g.type==="DropDownList"&&g.selectedIndex>-1&&k.push({type:g.type,id:g.id,selectedIndex:g.selectedIndex}))}switch(e.type){case"Button":n("[id^='"+f._id+"_btn"+y+"_"+s+"']").ejButton({type:"button",width:"100%",height:"100%",text:text,create:n.proxy(this._onButtonCreate),click:n.proxy(this.onButtonClick),cssClass:i["class"]||""});break;case"CheckBox":n("[id^='"+f._id+"_chk"+y+"_"+s+"']").ejCheckBox({change:n.proxy(this.onActiveStateChange),checked:!1,cssClass:i["class"]||""});break;case"DropDownList":n("[id^='"+f._id+"_drpdwn"+y+"_"+s+"']").ejDropDownList({width:"100%",height:f.model.rowHeight-1,change:n.proxy(this.onActiveValueChange),dataSource:e.dataSource||f.getRangeData({range:tt,sheetIdx:p}),fields:{text:e.field||"value2"},watermarkText:e.watermarkText||"Select an option",cssClass:e["class"]||"",selectedIndex:e.selectedIndex>-1?e.selectedIndex:"",beforePopupShown:n.proxy(this._onBeforePopupOpen)});break;case"DatePicker":n("[id^='"+f._id+"_dp"+y+"_"+s+"']").ejDatePicker({width:"100%",height:f.model.rowHeight-1,value:e.value||new Date,create:n.proxy(this._onDateCreate),change:n.proxy(this.onDateChange),cssClass:i["class"]||""})}for(o=0,yt=k.length;o<yt;o++)this._isIntrnlUpdate=!0,k[o].type==="CheckBox"?n("#"+k[o].id).length&&n("#"+k[o].id).ejCheckBox("instance").option("checked",!0):k[o].type==="DropDownList"&&n("#"+k[o].id).length&&n("#"+k[o].id).ejDropDownList("instance").option("selectedIndex",k[o].selectedIndex),this._isIntrnlUpdate=!1}}},removeCellTypes:function(n,t){var r=this.XLObj;if(!r.model.isReadOnly){var i,e=t||r.getActiveSheetIndex(),f=r._getRangeArgs(n,"object"),u=r.XLEdit._getPropWithCellIdx(f,"cellType",t);for(i=0,len=u.length;i<len;i++)this._removeControls(u[i].rowIdx,u[i].colIdx,t)}},_removeControls:function(n,t,i,r){var e,u=this.XLObj,f=i||u.getActiveSheetIndex(),o=u._dataContainer,f=u.getActiveSheetIndex();r||(delete o.sheetCellType[o.sheets[f][n][t].cellType],delete o.sheets[f][n][t].cellType);u._isRowViewable(f,n)&&(e=u.getCell(n,t,i)[0],e.innerHTML=u.XLEdit.getPropertyValue(n,t,"value2",f)||"",u._removeClass(e,"e-cellreadonly"))},onActiveValueChange:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!t.model.isReadOnly){var f=t._dataContainer,o=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(o[0]),r=t._getRowIdx(i.rowIndex,e),u=i.colIndex;f.sheetCellType[f.sheets[e][r][u].cellType].selectedIndex=n.itemId;t.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:t.XLEdit._parseValue(n.value,{rowIndex:r,colIndex:u})});n.cellIndex=i;n.cellType="dropdownlist";t._trigger("cellSave",n);t.model.allowFormulaBar&&t.updateFormulaBar()}},onActiveStateChange:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!t.model.isReadOnly&&!t.XLCellType._isIntrnlUpdate){var u=t._dataContainer,f,o=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(o[0]),s=t._getRowIdx(i.rowIndex,e),r=i.colIndex;u.sheetCellType[u.sheets[e][i.rowIndex][r].cellType].isChecked=n.isChecked;f=["yes","no"].indexOf(t.XLEdit.getPropertyValue(i.rowIndex,r,"value2").toString().toLowerCase())>-1?n.isChecked?"YES":"NO":n.isChecked.toString().toUpperCase();t.XLEdit._updateDataContainer({rowIndex:i.rowIndex,colIndex:r},{dataObj:t.XLEdit._parseValue(f,{rowIndex:i.rowIndex,colIndex:r})});n.cellIndex=i;n.cellType="checkbox";t._trigger("cellSave",n);t.model.allowFormulaBar&&t.updateFormulaBar()}},_onDateCreate:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),o=t._dataContainer,f=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(f[0]),r=t._getRowIdx(i.rowIndex,e),u=i.colIndex;t.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:t.XLEdit._parseValue(n.model.value.toLocaleString().split(", ")[0],{rowIndex:r,colIndex:u})})},onDateChange:function(n){var i=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");if(!i.model.isReadOnly){var s=i._dataContainer,e=this.element.closest("td"),o=i.getActiveSheetIndex(),r=i._getCellIdx(e[0]),u=i._getRowIdx(r.rowIndex,o),f=r.colIndex;i.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:i.XLEdit._parseValue(n.model.value.toLocaleString().split(t.isNullOrUndefined(n.model.value.toLocaleString().match(/[,]/))?" ":", ")[0],{rowIndex:u,colIndex:f})});n.cellIndex=r;n.cellType="datepicker";i._trigger("cellSave",n)}},_onButtonCreate:function(n){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),o=t._dataContainer,f=this.element.closest("td"),e=t.getActiveSheetIndex(),i=t._getCellIdx(f[0]),r=t._getRowIdx(i.rowIndex,e),u=i.colIndex;t.XLEdit._updateDataContainer({rowIndex:r,colIndex:u},{dataObj:t.XLEdit._parseValue(n.model.text,{rowIndex:r,colIndex:u})})},onButtonClick:function(t){var i=this.element.closest(".e-spreadsheet").data("ejSpreadsheet");i.model.isReadOnly||(t.cellIndex=i._getCellIdx(n(t.target).closest("td")[0]),t.cellType="button",i._trigger("cellClick",t))},_onBeforePopupOpen:function(){var t=this.element.closest(".e-spreadsheet").data("ejSpreadsheet"),r=t.getActiveSheetIndex(),f=t._dataContainer,s=this.element.closest("td"),e=t._getCellIdx(s[0]),h=t._getRowIdx(e.rowIndex,r),c=e.colIndex,i=f.sheetCellType[f.sheets[r][h][c].cellType],u=i.dataSourceSheetIndex||r,o;t.getSheet(u)._isLoaded||t._initSheet(u);o=i.dataSource||t.getRangeData({range:t.getRangeIndices(i.dataSourceRange),sheetIdx:u});n("#"+i.id).ejDropDownList("instance").option("dataSource",o);n("#"+i.id).ejDropDownList("instance").option("selectedItemIndex",i.selectedIndex)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.cFormat=function(n){this.XLObj=n};t.spreadsheetFeatures.cFormat.prototype={getCFRule:function(n,t){var u=this.XLObj,h=u.getActiveSheetIndex(),f=u.XLEdit.getPropertyValue(n,t,["cFormatRule"]),e=[],s=u._dataContainer.cFormatData,i,r,o;if(f)for(r=0,o=f.length;r<o;r++)i=s[f[r]].split("_"),e.push({action:i[0],inputs:[i[2],i[3]],color:i[4],range:i[5],isApplied:JSON.parse(i[7])});return e},setCFRule:function(n){var t=this.XLObj,i,r;t.model.isReadOnly||t.model.allowConditionalFormats&&(i=n.inputs[0],r=n.inputs[1],this._cFormat(n.action,i,r,n.color,n.range,t.getActiveSheetIndex()))},_updateCFormatRule:function(n,t){return n.indexOf("true")>-1?n.replace("true",t):n.replace("false",t)},_getRuleIndex:function(n,i){if(t.isNullOrUndefined(i))return-1;for(var r=0,u=i.length;r<u;r++)if(i[r]===n)return r;return-1},_refreshCFormatFormula:function(n,t,i){var u=this.XLObj,f=u.getSheet(i)._cFormatFormula,r,e;u.isUndefined(f[n])||u.isUndefined(f[n][t])||(r=f[n][t][0].Formula,this._applyFormulaValues(r.referCell,r.cFColor,"formularule",r.addr,i,e,r.applyCell))},_applyFormulaValues:function(n,i,r,u,f,e,o,s,h){var c=this.XLObj,v,l,b,y,st,ht,ut=c.getSheet(f),p,k,d,tt,g,ct=!0,lt=-1,ft,a=[],it,w,nt,et,ot,o,n,rt;if(v=t.isNullOrUndefined(e)&&t.isNullOrUndefined(u)?ut._selectedCells:t.isNullOrUndefined(u)?c._getMultiRangeCells(e):c._getMultiRangeCells(u),u=c._getAlphaRange(f,v[0].rowIndex,v[0].colIndex,v[v.length-1].rowIndex,v[v.length-1].colIndex),c.isUndefined(r))w=c._calcEngine,rt=new ValueChangedArgs(-1,-1,n),w.valueChanged(ut.sheetInfo.value,rt),n=w.getFormulaInfoTable().getItem("!0!-1").getFormulaValue()==="TRUE"?!0:!1,g=c._isBool(n)?n:!1,tt="formularule_"+r+"_"+n+"__"+i+"_"+u+"_"+c.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:o.rowIndex,colIndex:o.colIndex},tt,lt,g,ct,i);else{if(d=["<=",">=","<",">","="],n.startsWith("=")&&(n=n.substr(1)),n.indexOf("==")>-1)return c._showAlertDlg("Alert","NewRuleAlert","",430),!0;for(l=0,y=d.length;l<y;l++)n.indexOf(d[l])>-1&&(a=n.split(d[l]),it=d[l]);if(a.length||(a[0]=n),st=a.slice(),s==="paste"){for(n="",l=0,y=a.length;l<y;l++)c._isvalidRange(a[l]+":"+a[l])&&(o=c._getMultiRangeCells(a[l]),et=e[0]-h.rowIndex,ot=e[1]-h.colIndex,a[l]=c._getAlphaRange(f,o[0].rowIndex+et,o[0].colIndex+ot,o[0].rowIndex+et,o[0].colIndex+ot));n=y===2?a[0]+it+a[1]:a[0]}for(ht=this._formulaCellRefer(a,v),l=0,y=v.length;l<y;l++){for(p=v[l].rowIndex,k=v[l].colIndex,nt=this._formulaCellRange({rowIndex:p,colIndex:k},ht,st,it,f),formula=nt.formula,w=c._calcEngine,rt=new ValueChangedArgs(-1,-1,formula),w.valueChanged(ut.sheetInfo.value,rt),ft=w.getFormulaInfoTable().getItem("!0!-1").getFormulaValue()==="TRUE"?!0:!1,g=c._isBool(ft)?ft:!1,tt="formularule_"+it+"_"+n+"/"+formula+"__"+i+"_"+u+"_"+c.getActiveSheetIndex(),b=0;b<c.getObjectLength(nt)-1;b++)this._formulaCellUpdate({rowIndex:nt["referCell"+b].rowIndex,colIndex:nt["referCell"+b].colIndex},{rowIndex:p,colIndex:k},n,formula,u,i,f);this._applyCFormatRule({rowIndex:p,colIndex:k},tt,lt,g,ct,i);!g&&c._isRowViewable(f,p)&&c.getCell(p,k,f).removeClass("e-redft e-yellowft e-greenft e-redf e-redt")}}},_formulaCellUpdate:function(n,t,i,r,u,f,e){var l=this.XLObj,h=l.getSheet(e)._cFormatFormula,o,c=n.rowIndex,s=n.colIndex;c in h?(o=h[c],s in o?o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}):(o[s]=[],o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}))):(o=h[c]={},o[s]=[],o[s].push({Formula:{applyCell:t,formula:i,referCell:r,addr:u,cFColor:f}}))},_formulaCellRange:function(n,t,i,r,u){for(var e=this.XLObj,y=0,c,l=[],p=0,w=e.getObjectLength(t),o,s,h,a={},v={},f=0;f<w;f++)e._isObject(t["range"+f])?(s=n.rowIndex+t["range"+f].rowIndex,h=n.colIndex+t["range"+f].colIndex,a["range"+f]=e._getAlphaRange(u,s,h,s,h)):(s=n.rowIndex,h=n.colIndex,a["range"+f]=t["range"+f]),v["referCell"+f]={rowIndex:s,colIndex:h};for(c=0;c<i.length;c++){for(o=e.XLDragFill._parseFormula("="+i[c]),f=0,len=o.length;f<len;f++)e._isvalidRange(o[f]+":"+o[f])&&(o[f]=a["range"+y],y++);l[p]=o.join("");p++}return formula=e.isUndefined(r)?"="+l[0]:"="+l[0]+r+l[1],v.formula=formula,v},_formulaCellRefer:function(n,t){for(var u=this.XLObj,i,c=0,e,l=[],r,a,o,s,v={},h,f=0;f<n.length;f++)if(u.isFormula("="+n[f]))for(e=u.XLDragFill._parseFormula(n[f]),i=0,len=e.length;i<len;i++)u._isvalidRange(e[i]+":"+e[i])&&(l[c]=e[i],c++);else l[c]=n[f],c++;for(n=l,i=0;i<n.length;i++){if(r=n[i].startsWith("=")?n[i].split("=")[1]:n[i],a=r.split("$").length,u._isvalidRange(n[i]+":"+n[i])){u._isvalidRange(r+":"+r)&&(r.indexOf("$")<0?h="RCRefer":r.startsWith("$")&&a===3?h="CellRefer":r.startsWith("$")&&a===2?h="RRefer":!r.startsWith("$")&&r.indexOf("$")>-1&&(h="CRefer"));n[i].indexOf("$")>-1&&(n[i]=n[i].split("$").join(""));formulaCell=u._getMultiRangeCells(n[i]);switch(h){case"RCRefer":o=formulaCell[0].rowIndex-t[0].rowIndex;s=formulaCell[0].colIndex-t[0].colIndex;break;case"RRefer":o=formulaCell[0].rowIndex-t[0].rowIndex;s=formulaCell[0].colIndex;break;case"CRefer":o=formulaCell[0].rowIndex;s=formulaCell[0].colIndex-t[0].colIndex;break;case"CellRefer":o=formulaCell[0].rowIndex;s=formulaCell[0].colIndex}n[i]={rowIndex:o,colIndex:s}}v["range"+i]=n[i]}return v},_clearCFormula:function(n,t,i){var u=this.XLObj,e=[],h=[],c=0,s,r,o,a=u.XLEdit.getPropertyValue(n,t,"cFormatRule"),f,l;if(sheetData=u.getSheet(i)._cFormatFormula,a&&a[0].split("_")[0]==="formularule"&&(input=a[0].split("_")[2].split("/")[1],input.startsWith("=")&&(input=input.substr(1)),u.isFormula("="+input))){for(l=["<=",">=","<",">","="],r=0,o=l.length;r<o;r++)input.indexOf(l[r])>-1&&(e=input.split(l[r]));for(e.length||(e[0]=input),r=0,o=e.length;r<o;r++)if(u.isFormula("="+e[r]))for(s=u.XLDragFill._parseFormula(e[r]),j=0;j<s.length;j++)u._isvalidRange(s[j]+":"+s[j])&&(h[c]=s[j],c++);else h[c]=e[r],c++;for(r=0,o=h.length;r<o;r++)f=u._getMultiRangeCells(h[r])[0],u.isUndefined(sheetData[f.rowIndex])||(u.isUndefined(sheetData[f.rowIndex][f.colIndex])||delete sheetData[f.rowIndex][f.colIndex],u.getObjectLength(sheetData[f.rowIndex])||delete sheetData[f.rowIndex])}},_cFormat:function(n,i,r,u,f,e,o,s,h){var c=this.XLObj,v,l;if(c.model.allowConditionalFormats){c.showWaitingPopUp();e=e?e:c.getActiveSheetIndex();t.isNullOrUndefined(n)&&(n="lessthan");var a=c.getSheet(e),y=o?c._getRangeArgs(o,"object"):c._getRangeArgs(f,"object"),p={cFAction:n,input1:i,input2:r,cFColor:u,sheetIndex:e,reqType:"cond-format",action:"add",range:f,data:y};switch(n){case"greaterthan":this._applyGLEValues(">",i,u,n,f,e,o);break;case"greaterequalto":this._applyGLEValues(">=",i,u,n,f,e,o);break;case"lessthan":this._applyGLEValues("<",i,u,n,f,e,o);break;case"lessequalto":this._applyGLEValues("<=",i,u,n,f,e,o);break;case"equalto":this._applyGLEValues("==",i,u,n,f,e,o);break;case"notequalto":this._applyGLEValues("!=",i,u,n,f,e,o);break;case"between":this._applyBetweenValues("=",i,r,u,n,f,e,o);break;case"notbetween":this._applyBetweenValues("!",i,r,u,n,f,e,o);break;case"textcontains":this._applyContainsValues(i,u,n,f,e,o);break;case"dateoccur":this._applyDateContainsValues(i,u,n,f,e,o);break;case"formularule":i.indexOf("/")>-1&&(i=i.split("/")[1]);l=this._applyFormulaValues(i,u,n,f,e,o,v,s,h)}a._isImported&&!a._isLoaded||c._isUndoRedo||s==="paste"||c._dupDetails||c._isExport||l||c._completeAction(p);c.hideWaitingPopUp()}},clearCF:function(n){var i=this.XLObj,e,a,h,s,c;if(!i.model.isReadOnly){var r=i.getActiveSheetIndex(),u,f,o={sheetIndex:r,reqType:"cond-format",action:"clear",rule:[]},l=i.getSheet(r);if(i.model.allowConditionalFormats){for(h=i._dataContainer.cFormatData,o.selection=!i.isUndefined(n),n=n?i._getRangeArgs(n,"object"):[0,0,l.rowCount-1,l.colCount-1],s=i._getSelectedCells(r,n).selCells,e=0,a=s.length;e<a;e++)u=s[e].rowIndex,f=s[e].colIndex,t.isNullOrUndefined(i._dataContainer.sheets[r][u])||t.isNullOrUndefined(i._dataContainer.sheets[r][u][f])||t.isNullOrUndefined(i._dataContainer.sheets[r][u][f].cFormatRule)||(o.rule.push(this.getCFRule(u,f)),this._clearCFormula(u,f,r),i.clearRangeData([u,f,u,f],["cFormatRule"]));c=o.selection?"clear_"+r+"_"+i._getSelectedItems()[1]:"clear_"+r+"_entire";h.indexOf(c)===-1&&h.push(c);i._isUndoRedo||i._dupDetails||i._completeAction(o)}}},_getValueForCFormat:function(n,t){var u=this.XLObj,i=n.rowIndex,r=n.colIndex,o=u.getRangeData({range:[i,r,i,r],sheetIdx:t}),f=u.XLEdit.getPropertyValue(i,r),e=u.XLEdit.getPropertyValue(i,r,"value2");return f=f?f.toString():"",(e&&typeof e=="string"&&!o.formatStr&&f[0]==="="||u.XLEdit.getPropertyValue(i,r,"type")==="datetime"||u.XLEdit.getPropertyValue(i,r,"type")==="shortdate"||u.XLEdit.getPropertyValue(i,r,"type")==="longdate"||u.XLEdit.getPropertyValue(i,r,"type")==="time")&&(f=e),f},_applyGLEValues:function(i,r,u,f,e,o,s){var h=this.XLObj,c,k,v,y,l,ft,rt,et,nt,tt=new RegExp(/[^.0-9]+/g),vt=new RegExp(/[^.-a-zA-Z 0-9]+/g),ot=h.getSheet(o),st=ot._startCell,ht=ot._endCell,d,p=r,w,ct,b=[],lt,g,a,it,ut,at;if(rangeData=s?h._getRangeArgs(s,"object"):h._getRangeArgs(e,"object"),k=h._getSelectedCells(o,rangeData).selCells,p.startsWith("=")){for(p=p.substr(1),g=["<=",">=","<",">","="],a=0,it=g.length;a<it;a++)p.indexOf(g[a])>-1&&(b=b.split(g[a]),lt=g[a]);b.length||(b[0]=p);ct=this._formulaCellRefer(b,k)}for(a=0,it=k.length;a<it;a++)if(v=k[a].rowIndex,y=k[a].colIndex,r.startsWith("=")&&(ut=h._calcEngine,w=this._formulaCellRange({rowIndex:v,colIndex:y},ct,b,lt,o),at=new ValueChangedArgs(-1,-1,w.formula),ut.valueChanged(h.getSheet(o).sheetInfo.value,at),r=ut.getFormulaInfoTable().getItem("!0!-1").getFormulaValue(),l=h._isBool(r)?r==="TRUE"?!0:!1:!1,t.isNullOrUndefined(r)&&(r="0")),!h.XLEdit.getPropertyValue(v,y,"isMHide")&&!h.XLEdit.getPropertyValue(v,y,"isFilterHide")){if(c=this._getValueForCFormat({rowIndex:v,colIndex:y},o),nt=h.XLEdit.getPropertyValue(v,y,"type")?h.XLEdit.getPropertyValue(v,y,"type"):"general",ft=!0,et=-1,t.isNullOrUndefined(c)||!c.length)n.isNumeric(r)&&(l=r>0?f==="lessthan"||f==="lessequalto"||f==="notequalto":r<0?f==="greaterthan"||f==="greaterequalto"||f==="notequalto":f==="equalto"||f==="lessequalto"||f==="greaterequalto");else if(n.isNumeric(r))if(n.isNumeric(c))c=parseFloat(c),l=h.operators[i](c,parseFloat(r.replace(vt,"")));else if(h._isValidDate(c))l=h.operators[i](h._dateToInt(c),parseFloat(r));else if(h._isValidTime(c))continue;else l=h.operators[i](c.toLowerCase(),r.toLowerCase());else r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(tt,""))?l=nt==="percentage"?h.operators[i](parseFloat(c),parseFloat(r.replace(tt,""))):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):r.indexOf("$")===0&&n.isNumeric(r.replace(tt,""))?l=nt==="accounting"||nt!=="currency"||n.isNumeric(c)?h.operators[i](parseFloat(c),parseFloat(r.replace(tt,""))):(h.operators[i](c.length,0)||h._isValidDate(c))&&!h._isValidTime(c):h._isValidDate(r)?h._isValidDate(c)?l=h.operators[i](h._dateToInt(new Date(c)),h._dateToInt(new Date(r))):h._isValidTime(c)||(l=n.isNumeric(c)?h.operators[i](parseFloat(c),h._dateToInt(r)):h.operators[i](c.length,h._dateToInt(r))):l=h._isValidTime(r)?h._isValidTime(c)?h.operators[i](h.parse.parseTime(c),h.parse.parseTime(r)):n.isNumeric(c)?h.operators[i](parseFloat(c),0):h.operators[i](c.length,0):h.operators[i](c.toLowerCase(),r.toLowerCase());if(t.isNullOrUndefined(e)&&(e=h._generateHeaderText(st.colIndex+1)+(st.rowIndex+1)+":"+h._generateHeaderText(ht.colIndex+1)+(ht.rowIndex+1)),rt=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex(),p.startsWith("="))for(r=p.substr(1),rt=f+"_"+i+"_"+r+"__"+u+"_"+e+"_"+h.getActiveSheetIndex(),d=0;d<h.getObjectLength(w)-1;d++)this._formulaCellUpdate({rowIndex:w["referCell"+d].rowIndex,colIndex:w["referCell"+d].colIndex},{rowIndex:v,colIndex:y},r,w.formula,e,u,o);this._applyCFormatRule({rowIndex:v,colIndex:y},rt,et,l,ft,u)}},_applyBetweenValues:function(i,r,u,f,e,o,s,h){var c=this.XLObj,l,w,k,a,d,g,nt,y,v=new RegExp(/[^.0-9]+/g),b=new RegExp(/[^.-a-zA-Z 0-9]+/g),et,tt=c.getSheet(s),it=tt._startCell,rt=tt._endCell,p,ut;for(c.operators["<"](r,u)||(k=u,u=r,r=k),w=t.isNullOrUndefined(h)&&t.isNullOrUndefined(o)?c.getSheet(s)._selectedCells:c._getSelectedCells(s,o).selCells,p=0,ut=w.length;p<ut;p++)if(rowIdx=w[p].rowIndex,colIdx=w[p].colIndex,!c.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")&&!c.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide")){if(l=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},s),y=c.XLEdit.getPropertyValue(rowIdx,colIdx,"type")?c.XLEdit.getPropertyValue(rowIdx,colIdx,"type"):"general",d=!0,nt=-1,t.isNullOrUndefined(l)||!l.length)n.isNumeric(r)&&n.isNumeric(u)&&(a=r>0&&u>0||r<0&&u<0?e==="notbetween":e==="between");else if(n.isNumeric(r.replace(b,""))&&n.isNumeric(u.replace(b,""))&&y!=="percentage"&&y!=="currency"&&y!=="accounting")if(r=r.replace(b,""),u=u.replace(b,""),n.isNumeric(l))a=c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u));else if(c._isValidDate(l))a=c.operators[i](c._dateToInt(l)>=parseFloat(r)&&et<=parseFloat(u));else if(c._isValidTime(l))continue;else a=c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());else if(r.lastIndexOf("%")===r.length-1&&n.isNumeric(r.replace(v,""))&&u.lastIndexOf("%")===u.length-1&&n.isNumeric(u.replace(v,""))&&y==="percentage")a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(r.indexOf("$")===0&&n.isNumeric(r.replace(v,""))&&u.indexOf("$")===0&&n.isNumeric(u.replace(v,""))&&(y==="accounting"||y!=="currency"))a=c.operators[i](parseFloat(l)>=parseFloat(r.replace(v,""))&&parseFloat(l)<=parseFloat(u.replace(v,"")));else if(c._isValidDate(r)&&c._isValidDate(u)){var ft=c._dateToInt(new Date(l)),ot=c._dateToInt(new Date(r)),st=c._dateToInt(new Date(u));a=c.operators[i](ft>=ot&&ft<=st)}else a=c._isValidTime(r)&&c._isValidTime(u)&&c._isValidTime(l)?c.operators[i](c.parse.parseTime(l)>=c.parse.parseTime(r)&&c.parse.parseTime(l)<=c.parse.parseTime(u)):n.isNumeric(l)?c.operators[i](parseFloat(l)>=parseFloat(r)&&parseFloat(l)<=parseFloat(u)):c.operators[i](l.toLowerCase()>=r.toLowerCase()&&l.toLowerCase()<=u.toLowerCase());t.isNullOrUndefined(o)&&(o=c._generateHeaderText(it.colIndex+1)+(it.rowIndex+1)+":"+c._generateHeaderText(rt.colIndex+1)+(rt.rowIndex+1));g=e+"_"+i+"_"+r+"_"+u+"_"+f+"_"+o+"_"+c.getActiveSheetIndex();this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},g,nt,a,d,f)}},_applyContainsValues:function(i,r,u,f,e,o){var s=this.XLObj,h,a,c,v,y,p,w=new RegExp(/[^.-a-zA-Z 0-9]+/g),b=s.getSheet(e),k=b._startCell,d=b._endCell,l,g;for(a=t.isNullOrUndefined(o)&&t.isNullOrUndefined(f)?s.getSheet(e)._selectedCells:s._getSelectedCells(e,f).selCells,l=0,g=a.length;l<g;l++)(rowIdx=a[l].rowIndex,colIdx=a[l].colIndex,s.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")||s.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide"))||(h=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},e),type=s.XLEdit.getPropertyValue(rowIdx,colIdx,"type")?s.XLEdit.getPropertyValue(rowIdx,colIdx,"type"):"general",v=!0,p=-1,t.isNullOrUndefined(h)||!h.length?c=!1:n.isNumeric(i.replace(w,""))?(i=i.replace(w,""),s._isValidDate(h)&&(h=s._dateToInt(h).toString()),c=h.indexOf(i)>-1):s._isValidDate(i)?(s._isValidDate(h)&&(h=s._dateToInt(h).toString()),c=h.indexOf(s._dateToInt(i))>-1):s._isValidTime(i)?(s._isValidTime(h)&&(h=s._dateToInt("01/01/1990 "+h).toString()),c=h.indexOf(s._dateToInt("01/01/1990 "+i))>-1):c=h.toLowerCase().indexOf(i.toLowerCase())>-1,t.isNullOrUndefined(f)&&(f=s._generateHeaderText(k.colIndex+1)+(k.rowIndex+1)+":"+s._generateHeaderText(d.colIndex+1)+(d.rowIndex+1)),y=u+"__"+i+"__"+r+"_"+f+"_"+s.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},y,p,c,v,r))},_applyDateContainsValues:function(n,i,r,u,f,e){var o=this.XLObj,h,l=!1,a,v,y=o.getSheet(f),p=y._startCell,w=y._endCell,c,s,b,k,d;for(c=t.isNullOrUndefined(e)&&t.isNullOrUndefined(u)?o.getSheet(f)._selectedCells:o._getSelectedCells(f,u).selCells,s=0,b=c.length;s<b;s++)(rowIdx=c[s].rowIndex,colIdx=c[s].colIndex,o.XLEdit.getPropertyValue(rowIdx,colIdx,"isMHide")||o.XLEdit.getPropertyValue(rowIdx,colIdx,"isFilterHide"))||(h=this._getValueForCFormat({rowIndex:rowIdx,colIndex:colIdx},f),v=-1,t.isNullOrUndefined(h)||!h.length?l=!1:o._isValidDate(n)&&(k=new Date(h),d=new Date(n),l=k-d==0),t.isNullOrUndefined(u)&&(u=o._generateHeaderText(p.colIndex+1)+(p.rowIndex+1)+":"+o._generateHeaderText(w.colIndex+1)+(w.rowIndex+1)),a=r+"__"+n+"__"+i+"_"+u+"_"+o.getActiveSheetIndex(),this._applyCFormatRule({rowIndex:rowIdx,colIndex:colIdx},a,v,l,!0,i))},refreshCFormat:function(n){var t=this.XLObj,v=t._dupDetails,u,i,o,c,f,s,r,a,l,e,h;if(!t.model.isReadOnly&&(t._dupDetails=!0,t.model.allowConditionalFormats)){for(o=[],c=t.getActiveSheetIndex(),s=t._getSelectedCells(c,n).selCells,u=0,a=s.length;u<a;u++){if(e=s[u].rowIndex,h=s[u].colIndex,r=t.XLEdit.getPropertyValue(e,h,"cFormatRule"),!t.isUndefined(r)&&r.length)for(i=0,l=r.length;i<l;i++)r[i]=r[i].replace("_true","").replace("_false",""),o.indexOf(r[i])<0&&o.push(r[i]);t._isRowViewable(c,e)&&t.getCell(e,h,c).removeClass("e-redft e-yellowft e-greenft e-redf e-redt");t.clearRangeData([e,h,e,h],["cFormatRule"],s[u])}for(i=0,l=o.length;i<l;i++)f=o[i].split("_"),this._cFormat(f[0],f[2],f[3],f[4],f[5]);t._dupDetails=v}},_applyCFormatRule:function(n,t,i,r,u,f){var o=this.XLObj,a=o.getActiveSheetIndex(),s=n.rowIndex,h=n.colIndex,v,y,e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),c,p,b=!0,l,k;if(this._getRuleIndex(t+"_true",e)>-1&&(i=this._getRuleIndex(t+"_true",e)),this._getRuleIndex(t+"_false",e)>-1&&(i=this._getRuleIndex(t+"_false",e)),i>-1&&(c=e[i],p=o._dataContainer.cFormatData.indexOf(this._updateCFormatRule(c,r)),p>-1?o._dataContainer.sheets[a][s][h].cFormatRule[i]=p:(o._dataContainer.cFormatData.push(this._updateCFormatRule(c,r)),o._dataContainer.sheets[a][s][h].cFormatRule[i]=o._dataContainer.cFormatData.length-1)),e=o.XLEdit.getPropertyValue(s,h,"cFormatRule"),o._isRowViewable(a,s)&&(v=!0,y=o.getCell(s,h)),!o.isUndefined(e)&&e.length>0&&(!(t+"_true"===e[i]||t+"_false"===e[i])||e.length>1)){for(l=0,k=e.length;l<k;l++)c=e[l].split("_");v&&r&&y.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f)}else v&&r&&y.removeClass("e-redft e-yellowft e-greenft e-redf e-redt").addClass("e-"+f);if(e&&e.length){var d=o.getRangeIndices(t.split("_")[5]),g=o.getRangeIndices(e[0].split("_")[5]),w=t.split("_");w.splice(6,1);w.splice(5,1);e[0].indexOf(w.join("_"))>-1&&o.inRange(g,d[0],d[1])&&(b=!1)}b&&this._getRuleIndex(t+"_true",e)<0&&this._getRuleIndex(t+"_false",e)<0&&o.XLEdit._updateDataContainer(n,{dataObj:{cFormatRule:[t+"_"+r]},skipCell:!r})}}}(jQuery,Syncfusion),function(n,t,i){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.clipboard=function(n){this.XLObj=n;this._cutCells=[];this._copyCells=[];this._copyBackup={};this._cData="";this._isCut=!1;this._copyRange=[];this._isSpecial=!n.isPasteValuesOnly;this._isShape=!1};t.spreadsheetFeatures.clipboard.prototype={copy:function(){this._triggerKeyDown(67,!0)},cut:function(){this.XLObj.model.isReadOnly||this._triggerKeyDown(88,!0)},paste:function(){this.XLObj.model.isReadOnly||this._triggerKeyDown(86,!0)},_initCopyPaste:function(){var i=this.XLObj._id,r=t.buildTag("div",{},{position:"fixed",top:-1e3,left:-1e3},{id:i+"_copyPaste"});n("body").append(r);r.append(t.buildTag("textarea ."+i+"_copyTxt",{},{width:1,height:1,overflow:"hidden",opacity:0,resize:"none",cursor:"default"},{id:i+"_hiddenTxt"}))},_copyPasteHandler:function(t){var f,i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u);if(i._isUndoRedo=!1,!i.model.allowEditing&&(t.keyCode===88||t.keyCode===86))return!1;if((t.keyCode===67||t.keyCode===88||t.keyCode===86)&&i._preventctrlkey){i._showAlertDlg("Alert","CtrlKeyErrorAlert","CtrlKeyErrorAction",450);return}if(t.ctrlKey){if(t.keyCode===67)this._getClipboard(t),this._cutCells=[],n.extend(!0,this._copyCells,r._selectedCells),this._copyCells.length||(this._copyCells=[i.XLShape._picCellIdx]),setTimeout(function(){i.setSheetFocus()},0);else if(t.keyCode===88){if(f=r._selectedCells,i.model.allowLockCell&&r.isSheetProtected&&i._isPropExists(r.selectedRange,"isLocked",u))return;if(i._isPropExists([r.selectedRange],"isReadOnly",u))return;this._copyCells=[];n.extend(!0,this._cutCells,f);this._cutCells.length||(this._cutCells=[i.XLShape._picCellIdx]);this._getClipboard(t);setTimeout(function(){i.setSheetFocus()},0)}else if(t.keyCode===86){if(i.isUndefined(t.bubbles)||(this._isSpecial=!i.isPasteValuesOnly),this._cData.length||this._copyBackup.elem)n("#"+i._id+"_hiddenTxt").val(this._cData);else if(t.originalEvent)n("#"+i._id+"_hiddenTxt").select();else{n("#"+i._id+"_hiddenTxt").val("");i._showAlertDlg("Alert","ClipboardAccessError","ClipboardAccessError",450);return}setTimeout(function(){i.XLClipboard._setClipboard()},0)}}else t.keyCode===27&&i.element.find(".e-cdata").length&&(i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n("#"+i._id+"_hiddenTxt").val(""),this._cData="",this._copyCells=[])},_triggerKeyDown:function(t,i){var u=this.XLObj,r;u.setSheetFocus();r=n.Event("keydown");r.keyCode=t;r.ctrlKey=i;n("#"+u._id).trigger(r)},_getClipboard:function(t){var i=this.XLObj,r=i.getActiveSheetIndex(),e=i.getSheet(r),o=e._startCell,s=e._endCell,f=i._getContent(r).find(".e-selected"),h=i.getActiveCellElem(r)[0],u;i.model.allowClipboard&&(i.XLClipboard._copyBackup.cells||!i.model.showRibbon||i.model.isReadOnly||(i.XLRibbon._enableButtons(["Home_Clipboard_Paste"],"ejButton"),i.XLRibbon._enableButtons(["Home_Clipboard_PasteOptions"],"ejSplitButton"),i.isPasteValuesOnly&&n("#"+i._id+"_Ribbon_Paste").data("ejMenu").disableItemByID("PasteSpecial")),f.length?(this._copyBackup={cells:[],border:i.model.allowCellFormatting&&i.XLFormat.getHashCodeClassAsArray(),table:[],filterRange:[]},u=this._getSelectedData(o,s),i.element.find(".e-cdata").length&&i.element.find("td.e-cutright, td.e-cutbottom").removeClass("e-cutright e-cutbottom"),n(f).addClass("e-cdata"),i.XLSelection._focusBorder(o,s,i._cutFocus),this._cData=f.length<2&&!u.length?u=" ":u,this._isCut=!1,n("#"+i._id+"_hiddenTxt").val(u).select(),navigator.platform.toLowerCase().indexOf("mac")>-1&&document.execCommand("copy"),this._copyBackup.actCellPos={top:h.offsetTop,left:h.offsetLeft},this._copyBackup.cells[0].cell.wrap&&(this._copyBackup.cells[0].cell.wrap=""),t.keyCode==67&&(this._copyBackup.copypaste=!0),this._isShape=!1):(this._isShape=!0,this._copyBackup={elem:i.getSheetElement(r).find(".e-ss-activeimg"),isCut:t.keyCode===88,sIdx:r}))},_getSelectedData:function(t,i){var u=this.XLObj,h="",f,r,e,c=u.getActiveSheetIndex(),v,s,b,a;for(t.rowIndex>=i.rowIndex&&(v=t,t=i,i=v),this._copyRange=[],this._copyRange.push(u.getActiveSheetIndex()),this._copyRange.push(u._getSelectedItems()[1]),f=t.rowIndex;f<=i.rowIndex;f++)if(f!==t.rowIndex&&(h+="\n"),t.colIndex<=i.colIndex)for(r=t.colIndex;r<=i.colIndex;r++)cData=u.getRangeData({range:[f,r,f,r],property:["type","value","value2"]})[0],e=u.getObjectLength(cData)?cData.type!=="general"?cData.value2:cData.value:"",this._updateCBackupData(f,r),h+=r!==i.colIndex?e+"\t":e;else for(r=i.colIndex;r<=t.colIndex;r++)cData=u.getRangeData({range:[f,r,f,r],property:["type","value","value2"]})[0],e=u.getObjectLength(cData)?cData.type!=="general"?cData.value2:cData.value:"",this._updateCBackupData(f,r),h+=r!==t.colIndex?e+"\t":e;var y=u.model.sheets[c].tableManager,o,l,p=[],w=u.model.sheets[c].selectedRange;for(s=1,b=u.getObjectLength(y);s<=b;s++)if(o=n.extend(!0,{},y[s]),l=o.range,this._compareRange(w,l)){p.push(o.name);o.header=!0;o.tblId=s;this._copyBackup.table.push({tblName:p,tblObj:o,range:l});break}return a=u.getRangeIndices(u.model.sheets[c].filterSettings.range),this._compareRange(w,a)&&(this._copyBackup.filterRange=a),h},_updateCBackupData:function(t,i){var e=this.XLObj,o=e.getActiveSheetIndex(),u,f=e._dataContainer.sheets[o],r,s=new RegExp("\\be-format.*?\\b","g");t in f&&i in f[t]?(r=n.extend(!0,{},f[t][i]),u=r.format?r.format:""):(r={},u="");this._copyBackup.cells.push({cell:r,format:u})},_setClipboard:function(){var r=this.XLObj,nr,ht,vt,yr,au,tr,hi,vu,gu,yu,ir,ci,wi,pu,s,e,rr,pr,wr,yt,tu,ur,lt,li,br,kr,dt,fr,bi;if(!r.model.isReadOnly){var et,vi,sr,tu,iu,ku,ru,f,ct,ot=[],l=[],rt,uu=new RegExp("\\be-format.*?\\b","g"),b,gt=!1,g,u=r.getActiveSheetIndex(),k={cSheetIndex:this._copyRange[0],pSheetIndex:u,sheetIndex:u},ni=[],ri=r.getSheet(u)._startCell,ui=r.getSheet(u)._endCell,y,nt,tt=0,h,ut,fi,hr,yi,a={},d,cr,ti,fu=new RegExp("\\be-shapebdr.*?\\b","g"),eu=["solid","dashed","dotted"],du,v=ri.rowIndex<ui.rowIndex?ri.rowIndex:ui.rowIndex,lr,pi,ki=this._copyBackup.table,wt,di,gi,p=ri.colIndex<ui.colIndex?ri.colIndex:ui.colIndex,c=r._dataContainer,o,bt,ar,ei,kt=this._copyCells.length,at=this._cutCells.length;if(this._copyRange.length){if(ct=r.swapRange(r.getRangeIndices(this._copyRange[1])),ei=r._getSelectedRange({rowIndex:ct[0],colIndex:ct[1]},{rowIndex:ct[2],colIndex:ct[3]}),et=[v,p,v+(ct[2]-ct[0]),p+(ct[3]-ct[1])],ar=r._getSelectedRange({rowIndex:et[0],colIndex:et[1]},{rowIndex:et[2],colIndex:et[3]}),r.model.allowLockCell&&r.getSheet(u).isSheetProtected&&r._isPropExists([et],"isLocked",u))return;if(r._isPropExists([et],"isReadOnly",u))return}if(v===0&&p===0&&kt===this.XLObj.model.rowCount*this.XLObj.model.columnCount||kt!==this.XLObj.model.rowCount*this.XLObj.model.columnCount){var ou=r.model.sheets[u],su=r.model.sheets[this._copyBackup.sIdx],oi=r.getSheetElement(u).find(".e-activecell"),st=r.getSheet(this._copyBackup.sIdx||this._copyRange[0]||u).shapeMngr,si,it,hu,cu,lu,vr,w=this._copyRange[0];if(this._isShape){if(!this._isSpecial)return!1;ht=r.XLShape._picCellIdx;vt=r.getActiveCell(u);d=this._copyBackup.elem;nr=d[0].id;rt=nr.indexOf("picture")>-1?"picture":"chart";k={sheetIndex:u,cSheetIndex:this._copyBackup.sIdx,pSheetIndex:u,operation:"shape",cShapeId:nr,reqType:this._copyBackup.isCut?"cut-paste":"copy-paste"};f=n.extend(!0,{},c.sheets[this._copyBackup.sIdx][ht.rowIndex][ht.colIndex]);l=r.getCell(vt.rowIndex,vt.colIndex);n.extend(!0,a,st[rt][nr]);k.cutCell={rowIndex:ht.rowIndex,colIndex:ht.colIndex,obj:f,shapeObj:n.extend(!0,{},a)};d=r.element.find("#"+a.id);rt==="picture"?(it=d[0].className,it.indexOf("e-shapebdr")>-1?(it=d[0].className.match(fu)[0],wt=it.replace("e-shapebdr","").split("N"),di=wt[2],r.XLShape._createPicture(u,vt,st.sharedPics[a.data],l[0].offsetTop,l[0].offsetLeft,a.width,a.height,null,"#"+di,eu[parseInt(wt[1])-1],wt[0]+"px"),r.model.showRibbon&&r.XLRibbon._formatTabUpdate()):(r.XLShape._createPicture(u,vt,st.sharedPics[a.data],l[0].offsetTop,l[0].offsetLeft,a.width,a.height),r.model.showRibbon&&r.XLRibbon._formatTabUpdate())):(o=a.range,o=r._getAlphaRange(u,o[0],o[1],o[2],o[3]),o.indexOf(":")===-1&&(o=o+":"+o),a.top=l[0].offsetTop,a.left=l[0].offsetLeft,r.XLChart.createChart(o,n.extend(!0,{},a)));this._isShape=this._copyBackup.isCut?!1:!0;this._cutCells=[];r._isUndoRedo||(f=n.extend(!0,{},c.sheets[u][vt.rowIndex][vt.colIndex]),a=n.extend(!0,{},ou.shapeMngr[rt][f[rt][0]]),k.pShapeId=f[rt][0],k.pasteCell={rowIndex:vt.rowIndex,colIndex:vt.colIndex,obj:f,shapeObj:a},r._completeAction(k),this._copyBackup.isCut&&(f=n.extend(!0,{},c.sheets[this._copyBackup.sIdx][ht.rowIndex][ht.colIndex]),f[rt].some(function(n,t){return d[0].id===su.shapeMngr[rt][f[rt][t]].id?(objIdx=t,!0):!1}),Object.keys(f).length<2&&f[rt].length<2?(delete c.sheets[this._copyBackup.sIdx][ht.rowIndex][ht.colIndex],r.getObjectLength(c.sheets[this._copyBackup.sIdx][ht.rowIndex])<1&&delete c.sheets[this._copyBackup.sIdx][ht.rowIndex]):f[rt].length<2?delete f[rt]:f[rt].splice(objIdx,1),delete su.shapeMngr[rt][k.cShapeId]));this._copyBackup.isCut&&d.remove()}else{if(gt=this._cData===n("#"+r._id+"_hiddenTxt").val()&&this._copyRange.length>0,gt){if(r.model.allowLockCell&&r.getSheet(u).isSheetProtected&&r._isPropExists([et],"isLocked",u))return;if(r._isPropExists([et],"isReadOnly",u))return}if(au=[],k.reqType=at>0?"cut-paste":"copy-paste",r.element.find(".e-selected").hasClass("e-readonly")){r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom");return}if(k.text=ot=n("#"+r._id+"_hiddenTxt").val().length?n("#"+r._id+"_hiddenTxt").val().split("\n"):[],this._cData.length<1&&k.text.length<1)return;if(gt||ot[ot.length-1]!==""||ot.splice(ot.length-1,1),yr=[],au=[],gt?(k.isSpecial=!r.isPasteValuesOnly,o=r.getRangeIndices(this._copyRange[1]),r.setActiveSheetIndex(this._copyRange[0]),k.cutBorder={range:o,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(o)},r.setActiveSheetIndex(u)):k.isSpecial=!1,at){for(vr=[],w=this._copyRange[0],ki.length||this._cutPasteBorder(ct,et),y=0;y<at;y++)e=this._cutCells[y].rowIndex,s=this._cutCells[y].colIndex,b=r.getCell(e,s,w),du=r.XLEdit.getPropertyValue(e,s,"tableName")||"",l={rowIndex:e,colIndex:s,prevObj:{},newObj:{},shapes:[]},t.isNullOrUndefined(c.sheets[w][e])?l.prevObj={}:n.extend(!0,l.prevObj,c.sheets[w][e][s]),f=t.isNullOrUndefined(c.sheets[w][e])?{}:n.extend(!0,{},c.sheets[w][e][s]),b&&b[0]?("merge"in l.prevObj||(r.XLEdit._updateCellValue({rowIndex:e,colIndex:s},"","",w),r._refreshRowHeight(w,e)),"wrap"in f&&(fi=r._generateHeaderText(s+1)+(e+1),r._dupDetails=!0,r.setWrapText("unwrap",fi+":"+fi),r._dupDetails=!1),"cellType"in f&&r.model.allowCellType&&r.XLCellType._removeControls(e,s,w,!0),b.removeClass("e-hyperlinks e-redft e-yellowft e-greenft e-redf e-redt"),b.find("a").remove(),b.hasClass("e-commentcell")&&r.XLComment.deleteComment([e,s,e,s],w),r.model.allowCellFormatting&&!r.XLRibbon._isDirtySelect&&(ki.length?r.XLFormat.removeStyle(o):r.XLFormat.removeStyle(o,{cellStyle:!0,tableStyle:!0,format:!0})),e in c.sheets[w]&&s in c.sheets[w][e]&&(t.isNullOrUndefined(c.sheets[w][e][s])||(ku=c.sheets[w][e][s].overflow),delete c.sheets[w][e][s],r._textClip(e,s,"delete")),b[0].className.match(uu)&&(b[0].className=b[0].className.replace(uu,"")),t.isNullOrUndefined(c.sheets[w][e])?l.newObj={}:n.extend(!0,l.newObj,c.sheets[w][e][s]),r._setRowHdrHeight(w,r._getCellIdx(b[0]).rowIndex)):r.getObjectLength(f)&&(ru=r.getObjectKeys(f),r.clearRangeData([e,s,e,s],ru),r.model.allowCellType&&"cellType"in f&&delete c.sheetCellType[c.sheets[w][e][s].cellType]),vr.push(l);for(h=0,ut=ki.length;h<ut;h++)yu=r.getActiveSheetIndex(),r.gotoPage(w,!1),lr=n.trim(ki[h].tblName),r.XLFormat.removeTable(r._getTableID(null,lr,w)),r.gotoPage(yu,!1);r.model.allowCellFormatting&&r.XLFormat.removeStyle(o,{cellStyle:!0,tableStyle:!0,format:!0});r.setActiveSheetIndex(w);r.setActiveSheetIndex(u);k.cutCells=vr;k.cfat={table:lr,range:o};lu=!0;r.element.find(".e-cdata").length&&r.element.find(".e-cutright, .e-cutbottom").removeClass("e-cutright e-cutbottom")}else{if(ir=[],r.isPasteValuesOnly)ir=this._copyCells;else for(y=0;y<kt;y++)e=this._copyCells[y].rowIndex,s=this._copyCells[y].colIndex,l={rowIndex:e,colIndex:s,prevObj:{},newObj:{}},t.isNullOrUndefined(c.sheets[u][e])||n.extend(!0,l.prevObj,c.sheets[u][e][s]),ir.push(l);k.cutCells=ir}if(ot.length?si=[v,p,v+ot.length-1,p+ot[0].split("\t").length-1]:(si=[v,p,v,p],y=nt=1),k.pasteBorder={range:si,prevBorder:r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(si)},kt)for(rr=[],r.XLFormat.removeStyle(et,{border:!0,cellStyle:!0,format:!0}),ci=0,pu=ar.length;ci<pu;ci++)wi=ar[ci],e=ei[ci].rowIndex,s=ei[ci].colIndex,rr=r.XLEdit.getPropertyValue(e,s,"borders",this._copyRange[0]),r.isUndefined(rr)||r.XLFormat.applyBorder(rr,[wi.rowIndex,wi.colIndex,wi.rowIndex,wi.colIndex]);for(tu=r._getContTBody(u).find("rows"),y=0,hu=ot.length;y<hu;y++){for(l=ot[y].split("\t"),nt=0,cu=l.length;nt<cu;nt++){if(b=tu[r._getRowIdx(v+y)]?r.getCell(v+y,p+nt)[0]:i,t.isNullOrUndefined(b)?(ou.colCount<=p+nt?r.XLScroll._createNewColumn(u,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"):r.model.scrollSettings.allowScrolling&&!r.model.scrollSettings.allowVirtualScrolling&&r.XLScroll._createNewRow(u,-1,-1,"insert"),r.XLScroll._refreshScroller(u,"refresh","all"),b=r.getCell(v+y,p+nt)):b=n(b),g={rowIndex:v+y,colIndex:p+nt},g.prevObj=t.isNullOrUndefined(c.sheets[u][v+y])?{}:n.extend(!0,{},c.sheets[u][v+y][p+nt]),t.isNullOrUndefined(g.prevObj)||(delete g.prevObj.isMHide,delete g.prevObj.mergeIdx),this._isCut&&gt)return;if(currentCellIdx={rowIndex:v+y,colIndex:p+nt},!r.isPasteValuesOnly&&gt)if(e=currentCellIdx.rowIndex,s=currentCellIdx.colIndex,vu=ei[tt].rowIndex,gu=ei[tt].colIndex,it=r._dataContainer.hashCode[this._copyBackup.cells[tt].format],"merge"in this._copyBackup.cells[tt].cell||t.isNullOrUndefined(it)||r.addClass(b,it),f=n.extend(!0,{},this._copyBackup.cells[tt].cell),e in c.sheets[u]||(c.sheets[u][e]={}),s in c.sheets[u][e]?"comment"in c.sheets[u][e][s]&&r.getCell(e,s).removeClass("e-commentcell"):c.sheets[u][e][s]={},f){if(dt=n.extend(!0,{},r.XLEdit.getPropertyValue(e,s,"merge")),pr=r.XLEdit.getPropertyValue(e,s,"isMHide"),wr=n.extend(!0,{},r.XLEdit.getPropertyValue(e,s,"mergeIdx")),delete f.overflow,delete f.isOverflow,delete f.tableName,n.extend(!0,c.sheets[u][e][s],f),yt=c.sheets[u][e][s],r.getObjectLength(dt)?yt.merge=dt:delete yt.merge,r.getObjectLength(wr)?yt.mergeIdx=wr:delete yt.mergeIdx,r.isUndefined(pr)?delete yt.isMHide:yt.isMHide=pr,r.XLEdit.getPropertyValue(e,s,"value2")&&(r._textClip(e,s,"delete"),r._textClip(e,s,"add")),hi=f.value2&&typeof f.value2=="string"&&!f.formatStr?c.sharedData[f.value][0]==="="?c.sharedData[f.value]:f.value2:c.sharedData[f.value],f.type===3&&(hi=this._getUpdatedCellFormula(hi,this._copyCells[tt],{rowIdx:e,colIdx:s})),"merge"in f||(r.XLEdit._updateCellValue(currentCellIdx,hi),cHeight=r.XLEdit.getPropertyValue(vu,0,k.reqType==="copy-paste"?"cHeight":"pHeight"),r.isUndefined(cHeight)||(r.XLEdit._updateDataContainer({rowIndex:currentCellIdx.rowIndex,colIndex:0},{dataObj:{pHeight:r.getSheet(u).rowsHeightCollection[currentCellIdx.rowIndex],cHeight:cHeight}}),r.getSheet(u).rowsHeightCollection[currentCellIdx.rowIndex]=cHeight,r._isRowViewable(u,currentCellIdx.rowIndex)&&(r.getRows(u)[1][r._getRowIdx(currentCellIdx.rowIndex)].style.height=cHeight+"px"))),"merge"in f){ur=0;dt=f.merge;o=r.getRangeIndices(dt.mRange);var dr=o[2]-o[0],gr=o[3]-o[1],nf=r.getSheet(u)._selectedCells,nu=r._getAlphaRange(u,g.rowIndex,g.colIndex,g.rowIndex+dr,g.colIndex+gr),ai,tf=ui.rowIndex-ri.rowIndex,rf=ui.colIndex-ri.colIndex;if(lt=r._getSelectedRange({rowIndex:g.rowIndex,colIndex:g.colIndex},{rowIndex:g.rowIndex+dr,colIndex:g.colIndex+gr}),ei.length>=nf.length||!((rf+1)%(gr+1)==0&&(tf+1)%(dr+1)==0)){for(h=0,ut=lt.length;h<ut;h++)t.isNullOrUndefined(r.XLEdit.getPropertyValue(lt[h].rowIndex,lt[h].colIndex,"isMHide"))&&(li=r.XLEdit.getPropertyValue(lt[h].rowIndex,lt[h].colIndex,"merge"),ur++,t.isNullOrUndefined(li)||(li&&(br=li.mSpan.rowSpan,kr=li.mSpan.colSpan),t.isNullOrUndefined(br)||t.isNullOrUndefined(kr)||(ur+=parseInt(br)*parseInt(kr)-1),li.isCenterAlign&&r._isRowViewable(u,lt[h].rowIndex)&&r.getCell(lt[h].rowIndex,lt[h].colIndex).addClass("e-calign").removeClass("e-ralign")));if(lt.length===ur&&at){for(var wu=!1,ai=r._getSelectedCells(w,dt.mRange).range,pt,ii=r._dataContainer.sheets[w],ft=ai[0];ft<=ai[2];ft++)for(pt=ai[1];pt<=ai[3];pt++)r._isRowViewable(w,ft)&&r.getCell(ft,pt,w).text(""),t.isNullOrUndefined(ii[ft])&&(ii[ft]={}),t.isNullOrUndefined(ii[ft][pt])&&(ii[ft][pt]={}),wu?(ii[ft][pt].isMHide=!0,ii[ft][pt].mergeIdx={rowIndex:o[0],colIndex:o[1]}):(ii[ft][pt].merge=dt,wu=!0);r.setActiveSheetIndex(w);r._unMergeAllCells(this._copyRange[0],0,r._getSelectedRange({rowIndex:o[0],colIndex:o[1]},{rowIndex:o[2],colIndex:o[3]}),[],0,0);r.setActiveSheetIndex(u)}r._paste=!0;r._dupDetails=!0;r.isUndefined(g.prevObj.merge)||r.unmergeCells(g.prevObj.merge.mRange);r.unmergeCells(nu);r._mergeCenter=dt.isCenterAlign;r.isUndefined(ai)||ai!=="1"?r.mergeCells(nu,!0):r.mergeAcrossCells(nu,!0);r._dupDetails=!1;r.XLEdit._updateCellValue(currentCellIdx,hi);t.isNullOrUndefined(it)||r.addClass(b,it)}else{fr=n.extend(!0,{},f);fr.value=fr.value2=hi;t.isNullOrUndefined(it)||r.getCell(o[0],o[1],this._copyRange[0]).addClass(it);r.XLEdit._updateDataContainer({rowIndex:o[0],colIndex:o[1]},{dataObj:fr});r._showAlertDlg("Alert","MergeAlert","",250);return}}if("hyperlink"in f&&(tr=f.hyperlink,b&&(tr&&!tr.webAddr?b.html(t.buildTag("a.e-hyperlinks",b.text(),"",{href:"#"})):b.html(t.buildTag("a.e-hyperlinks",b.text(),"",{href:tr.webAddr,target:"_blank"})))),"comment"in f&&(r._removeClass(b,"e-commentcell"),r.XLComment.setComment([e,s,e,s],null,!1)),"cFormatRule"in f)for(hr=n.extend(!0,[],f.cFormatRule),f.cFormatRule=[],h=0,ut=hr.length;h<ut;h++)yi=r._dataContainer.cFormatData[hr[h]].split("_"),r.XLCFormat._cFormat(yi[0],yi[2],yi[3],yi[4],null,null,[e,s,e,s],"paste",this._copyCells[tt]);if(r._isPaste=!0,"wrap"in f&&(r._dupDetails=!0,fi=r._generateHeaderText(s+1)+(e+1),r.setWrapText("wrap",fi+":"+fi),r._dupDetails=!1),"cellType"in f&&(sr=r._dataContainer.sheetCellType[f.cellType],sr.text="",r.model.allowCellType&&r.XLCellType._renderControls(e,s,u,sr,!at)),r._isPaste=!0,"picture"in f)for(delete yt.picture,h=0,ut=f.picture.length;h<ut;h++)l=kt?this._copyCells[tt]:this._cutCells[tt],bt=this._copyBackup.actCellPos,ti=r.getRangeData([l.rowIndex,l.colIndex,l.rowIndex,l.colIndex],"","",this._copyRange[0])[0],(!r.isUndefined(ti.picture)&&ti.picture.indexOf(f.picture[h])>-1||!kt)&&(n.extend(!0,a,st.picture[f.picture[h]]),d=r.element.find("#"+a.id),a.rowIndex===l.rowIndex&&a.colIndex===l.colIndex&&(d=r.element.find("#"+a.id),it=d[0].className,it.indexOf("e-shapebdr")>-1?(it=d[0].className.match(fu)[0],wt=it.replace("e-shapebdr","").split("N"),di=wt[2],r.XLShape._createPicture(u,currentCellIdx,st.sharedPics[a.data],parseInt(d.css("top"))-bt.top+oi[0].offsetTop,parseInt(d.css("left"))-bt.left+oi[0].offsetLeft,a.width,a.height,null,"#"+di,eu[parseInt(wt[1])-1],wt[0]+"px")):r.XLShape._createPicture(u,currentCellIdx,st.sharedPics[a.data],parseInt(d.css("top"))-bt.top+oi[0].offsetTop,parseInt(d.css("left"))-bt.left+oi[0].offsetLeft,a.width,a.height),this._copyRange[0]===u&&(c.sheets[u][v+y][p+nt].picture[h]=r.getObjectKeys(st.picture)[r.getObjectLength(st.picture)-1]),at&&d.remove()));if("chart"in f)for(delete yt.chart,ti=r.getRangeData([e,s,e,s]),h=0,ut=f.chart.length;h<ut;h++)l=kt?this._copyCells[tt]:this._cutCells[tt],bt=this._copyBackup.actCellPos,ti=r.getRangeData([l.rowIndex,l.colIndex,l.rowIndex,l.colIndex])[0],(!r.isUndefined(ti.chart)&&ti.chart.indexOf(f.chart[h])>-1||!kt)&&(n.extend(!0,a,st.chart[f.chart[h]]),d=r.element.find("#"+a.id),a.rowIndex===l.rowIndex&&a.colIndex===l.colIndex&&(o=a.range,o=r._getAlphaRange(u,o[0],o[1],o[2],o[3]),o.indexOf(":")<0&&(o=o+":"+o),a.top=parseInt(d.css("top"))-bt.top+oi[0].offsetTop,a.left=parseInt(d.css("left"))-bt.left+oi[0].offsetLeft,r.XLChart.createChart(o,a),c.sheets[u][v+y][p+nt].chart[h]=r.getObjectKeys(st.chart)[r.getObjectLength(st.chart)-1],at&&d.remove()));"rule"in f&&f.rule.type==="list"&&r._setddlCell();r._isPaste=!1}else r.XLEdit._updateCellValue(currentCellIdx,""),t.isNullOrUndefined(c.sheets[u][e])||delete c.sheets[u][e][s];else vi=r.XLEdit._parseValue(l[nt],currentCellIdx),vi.type=="time"||vi.type=="datetime"?(iu=r._dateToInt(vi.value),r.XLEdit._updateCellValue(currentCellIdx,iu)):r.XLEdit._updateCellValue(currentCellIdx,vi.value),l[nt].indexOf("=")>-1&&r.XLEdit._updateCellValue(currentCellIdx,b.html());tt++;g.newObj=t.isNullOrUndefined(c.sheets[u][v+y])?{}:n.extend(!0,{},c.sheets[u][v+y][p+nt]);t.isNullOrUndefined(g.newObj)&&(g.newObj={});yr.push(g)}t.isNullOrUndefined(b)||r._setRowHdrHeight(u,r._getCellIdx(b[0]).rowIndex)}if(ot.length<1&&(y=1),at&&(this._isCut=lu,this._cutCells=[],this._cData=""),!r.isPasteValuesOnly&&gt){var bu=this._copyBackup.table,er,or=r.getSheet(u).tableManager,tt=1;for(o=r.getRangeIndices(this._copyRange[1]),h=0,ut=bu.length;h<ut;h++){for(pi=this._copyBackup.table[h].range,er=n.extend(!0,{},this._copyBackup.table[h].tblObj),this._copyBackup.copypaste&&(er.name="Table"+r._tableCnt),r._dupDetails=!0,r.XLFormat.createTable(er,r._getAlphaRange(this._copyRange[0],pi[0]+v-o[0],pi[1]+p-o[1],v-o[0]+pi[2],p-o[1]+pi[3])),r._dupDetails=!1,ni.push(or[this._isCut?er.tblId:this.XLObj.getObjectLength(or)]);tt<=r.getObjectLength(or);)or[tt].name==ni[h].name&&(ni[h].id=tt),tt++;ni[h].totalRow&&r.XLFormat._updateTotalRow(u,ni[h].id,bu[0].tblObj.fnNumber,ni[h].range,!0)}si=[v,p,y+v-1,nt+p-1];at&&this._copyBackup.filterRange.length>0&&this._copyRange[0]===u&&(bi=this._copyBackup.filterRange,r.XLFilter.clearFilter(),cr=r._generateHeaderText(bi[1]+p-o[1]+1)+(bi[0]+v-o[0]+1)+":"+r._generateHeaderText(p-o[1]+bi[3]+1)+(v-o[0]+bi[2]+1),r.XLFilter.filter(cr));k.pasteBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(si);r.setActiveSheetIndex(this._copyRange[0]);k.cutBorder.newBorder=r.model.allowCellFormatting&&r.XLFormat.getHashCodeClassAsArray(o);r.setActiveSheetIndex(u)}k.pfat={table:this._copyBackup.table,range:o,minRowIdx:v,minColIdx:p,ptable:ni};k.pfilter=cr;k.pasteCells=yr;r.XLSelection.selectRange({rowIndex:v,colIndex:p},{rowIndex:y+v-1,colIndex:nt+p-1});r.getSheet(u)._startCell={rowIndex:v,colIndex:p};r.getSheet(u)._endCell={rowIndex:y+v-1,colIndex:nt+p-1};r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();k.sheetIndex=u;r.setSheetFocus();r.model.showRibbon&&r.XLRibbon._updateRibbonIcons();r._isUndoRedo||r._completeAction(k);gi=k.cutCells.length<1?v:k.cutCells[0].rowIndex;r.XLScroll._getRowHeights(u,v<gi?v>0?v-1:0:gi>0?gi-1:0)}r._isPaste=!1;this._isCut=!1;r.XLSelection._refreshBorder();r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement();r.getSheet(u)._isFreezed&&r.XLFreeze._refreshSelection()}else r._showAlertDlg("Alert","FullSheetCopyPasteAlert","",375)}},_getUpdatedCellFormula:function(n,t,i){for(var f=this.XLObj,c=/([A-Z].*?[0-9])/g,l=i.rowIdx-t.rowIndex,a=i.colIdx-t.colIndex,r=f.XLDragFill._parseFormula(n),e,o,s,u=0,h=r.length;u<h;u++)r[u].match(c)&&(e=r[u].trim().match(/(\d+|\D+)/g),o=f._generateColCount(e[0])+a,s=parseInt(e[1])+l,r[u]=s>0&&o>0?f._generateHeaderText(o)+s.toString():"#REF!");return r=r.join(""),"="+r},_compareRange:function(n,t){return n[0]<=t[0]&&n[1]<=t[1]&&n[2]>=t[2]&&n[3]>=t[3]},_cutPasteBorder:function(n,t){var r,u,s,h,c,i=this.XLObj,l=i.getActiveSheetIndex(),f=[],e=[],o=[];for(i.XLFormat.removeStyle(t,{cellStyle:!0,border:!0,format:!0,sheetIdx:l}),e=i._getSelectedRange({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]}),o=i._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]}),r=0,c=o.length;r<c;r++)u=o[r],h=e[r].rowIndex,s=e[r].colIndex,f=i.XLEdit.getPropertyValue(h,s,"borders",this._copyRange[0]),i.isUndefined(f)||i.XLFormat.applyBorder(f,[u.rowIndex,u.colIndex,u.rowIndex,u.colIndex]);i.setActiveSheetIndex(this._copyRange[0]);i.XLFormat.removeStyle(n,{cellStyle:!0,border:!0,format:!0});i.setActiveSheetIndex(l)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.comments=function(n){this.XLObj=n;this._isCommentEdit=!1;this._isShowAllComments=!1;this._curCommentHCell=null};t.spreadsheetFeatures.comments.prototype={setComment:function(n,i,r,u){var f=this.XLObj,l;if(f.model.allowComments&&f.model.allowEditing&&!f.model.isReadOnly){var g,p=!1,y,c,e,o,w,a,b,s,h,k,d=[],v={sheetIndex:f.getActiveSheetIndex(),reqType:"comment"};if(s=f.getActiveSheetIndex(),h=f.getSheet(s),f.model.allowLockCell&&h.isSheetProtected)return!1;if(n)rng=f._getRangeArgs(n,"object"),e=rng[0],o=rng[1],c={rowIndex:e,colIndex:o};else{if(!f.model.allowSelection)return;c=f.getActiveCell(s);e=c.rowIndex;o=c.colIndex}if(l={reqType:"beforeEditComment",cellIndex:c,value:i,sheetIdx:s,disable:!1},f._trigger("beforeEditComment",l)&&(l.disable=!0),i=l.value,!f._isCellProtected(e,o,!1)){if(!f.isUndefined(f.XLEdit.getPropertyValue(e,o,"cellType"))){f._showAlertDlg("Alert","CellTypeAlert","CellTypeAlert",372);return}f.model.showRibbon&&(f._isPaste?!f.XLClipboard._cutCells.length:!0)&&f._commentCount++;f._isRibbonClick||(v.action="add",d.push(c),v.selectedCell=d,v.selectedCell[0].prevComment=f.XLEdit.getPropertyValue(e,o,"comment"));f._isAutoWHMode||f.XLClipboard._copyCells.length||h._isFreezed||f.XLScroll._scrollSelectedPosition(s,c);e in h._commentColl||(h._commentColl[e]={});h._commentColl[e][o]={isComment:!0};r=t.isNullOrUndefined(r)?!0:r;u=t.isNullOrUndefined(u)?!0:u;b=(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n";g=f.XLEdit.getPropertyValue(e,o,"comment",s);t.isNullOrUndefined(i)?l.disable&&f.XLEdit._updateDataContainer(c,{dataObj:{comment:{value:b,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?r:f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible}}}):(u&&(i=b+i),f.XLEdit._updateDataContainer(c,{dataObj:{comment:{value:i,isVisible:t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?r:f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible}}}));w=t.isNullOrUndefined(f.XLEdit.getPropertyValue(e,o,"comment",s))?(f.model.userName.length>0?f.model.userName:f._getLocStr("UserName"))+":\n":f.XLEdit.getPropertyValue(e,o,"comment",s).value;!f.model.allowComments||f.XLEdit._isEdit||f._isSheetRename||(f._isRowViewable(s,e)&&(y=f.getCell(e,o),y.prepend(t.buildTag("span.e-comment",t.buildTag("span.e-celltoparrow")).append(t.buildTag("textarea.e-comment-txtarea",w,{"z-index":10}))).addClass("e-commentcell"),this._updateCmntArrowPos(y),a=y.find(".e-comment-txtarea"),this._updateCmtAreaPos(y,a),a.focus().setInputPos(a.val().length),p=!0,l.disable&&(a[0].disabled=!0)),(!h._isImported||h._isLoaded)&&(k=f.XLEdit.getPropertyValue(e,o,"comment",s),t.isNullOrUndefined(k)||(k.value=w)),r&&p?(a.focus(),!this._curCommentHCell||t.isNullOrUndefined(f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"))||f.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment").isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null),f.model.allowDragAndDrop&&!f.XLDragDrop._isDragAndDropped&&this._updateCurrentCell(e,o),l.disable?this._updateCmntRibIcons():(this._isCommentEdit=!0,f.model.showRibbon&&f.XLRibbon._disableRibbonIcons())):p&&(this._isShowAllComments||f.XLEdit.getPropertyValue(e,o,"comment",s).isVisible||a.hide(),f.model.showRibbon&&(!h._isImported||h._isLoaded)&&f.model.allowDragAndDrop&&!f.XLDragDrop._isDragAndDropped&&this._updateCmntRibIcons(f.XLClipboard._isSpecial?f.getActiveCell():{rowIndex:e,colIndex:o})),f._isRibbonClick||f._isUndoRedo||f._hasComment||f._isExport||f._dupDetails||(v.selectedCell[0].curComment=f.XLEdit.getPropertyValue(e,o,"comment"),v.showUserName=u,v.showEditPanel=r,f._completeAction(v)))}}},_updateCmtAreaPos:function(n,t){var r=this.XLObj,u=r.getActiveSheetIndex(),s=r._getContent(u).find("#hscrollBar").offset(),f=r._getContent(u).find("#vscrollBar").offset(),h=r._getJSSheetHeader(u).offset(),i=t.offset(),e=t.height(),o=t.width();r.model.scrollSettings.allowScrolling&&(i.top+e+5>s.top&&i.left+o<f.left?t.css({top:-77}):i.left+o>f.left&&i.top+e+5>s.top?t.css({left:-136,top:-81}):i.top+e>h.top&&i.left+o>f.left&&t.css({left:-137,top:n.height()+8}))},deleteComment:function(i,r,u,f){var e=this.XLObj,o;if(e.model.allowComments&&!e.model.isReadOnly){var v,l=[],a=[],h=r||e.getActiveSheetIndex(),s,c={sheetIndex:h,reqType:"comment",action:"delete",range:i};for(i=e._getRangeArgs(i,"object"),s=e._getSelectedCells(r,i).selCells,o=0;o<s.length;o++)e.XLEdit.getPropertyValue(s[o].rowIndex,s[o].colIndex,"comment",r)&&l.push(s[o]);if(e.model.allowComments){for(o=0;o<s.length;o++)if(rowIdx=s[o].rowIndex,colIdx=s[o].colIndex,cmnt=e.XLEdit.getPropertyValue(rowIdx,colIdx,"comment",r),!t.isNullOrUndefined(cmnt)){if(v=n(s[o]),u&&e._isHiddenRow(rowIdx)){s.splice(o,1);continue}e.model.showRibbon&&e._commentCount&&e._commentCount--;a.push({rowIndex:rowIdx,colIndex:colIdx,prevComment:cmnt,currComment:{}});e._isRowViewable(h,rowIdx)&&e.getCell(rowIdx,colIdx,h).removeClass("e-commentcell").find(".e-comment").remove();e.getSheet(h)._commentColl[rowIdx]&&delete e.getSheet(h)._commentColl[rowIdx][colIdx];delete e._dataContainer.sheets[h][rowIdx][colIdx].comment}c.selectedCell=a;e.model.showRibbon&&l.length&&e.model.allowDragAndDrop&&!e.XLDragDrop._isDragAndDropped&&e.XLComment._updateCmntRibIcons();c.reqType=t.isNullOrUndefined(f)?"comment":"clear-comment";e._isUndoRedo||e._dupDetails||e._completeAction(c)}}},editComment:function(n){var i=this.XLObj,r,f,u,e;if(i.model.allowComments&&!i.model.isReadOnly){if(u=i.getActiveSheetIndex(),i.model.allowLockCell&&i.getSheet(u).isSheetProtected)return!1;t.isNullOrUndefined(n)&&(n=i.getActiveCell());f=i.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment",u);r={reqType:"beforeEditComment",cellIndex:n,value:f.value,sheetIdx:u,disable:!1};i._trigger("beforeEditComment",r)&&(r.disable=!0);f.value=r.value;i.XLEdit._updateDataContainer(n,{dataObj:{comment:{value:f.value,isVisible:f.isVisible}}});i.XLEdit._isEdit||i._isSheetRename||(i.model.allowComments&&(t.isNullOrUndefined(i.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"comment"))||(i._isAutoWHMode||i.XLScroll._scrollSelectedPosition(u,n),i._isRowViewable(u,n.rowIndex)&&(e=i.getCell(n.rowIndex,n.colIndex).find(".e-comment-txtarea"),e.text(r.data),e.css("display","inline-table").focus().setInputPos(e.text().length)),r.disable||(this._isCommentEdit=!0))),i.model.showRibbon&&!r.disable&&i.XLRibbon._disableRibbonIcons())}},showHideComment:function(n){var i=this.XLObj;if(i.model.allowComments&&!i.model.isReadOnly){var s=i.getActiveSheetIndex(),r,u,e,o=!1,f=!1;r=t.isNullOrUndefined(n)?i.getActiveCell():i._getCellIdx(n[0]);u=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment");t.isNullOrUndefined(u)||(i._isRowViewable(s,r.rowIndex)&&(e=i.getCell(r.rowIndex,r.colIndex).find(".e-comment-txtarea"),o=!0),u.isVisible?(o&&e.hide(),f=!1):(o&&e.css("display","inline-table"),this._curCommentHCell=null,f=!0));i.isUndefined(f)||(u.isVisible=f)}},showAllComments:function(){var t=this.XLObj,r;if(t.model.allowComments){for(var h=t.getActiveSheetIndex(),u,f,e,o=n("#"+t._id+"_Ribbon_Review_Comments_ShowAllComments").data("ejToggleButton"),s=["Review_Comments_PreviousComment","Review_Comments_NextComment"],c=this._isShowAllComments?!1:!0,i=1;i<=t.model.sheetCount;i++)for(u=t.getSheet(i)._commentColl,rowKeys=t.getObjectKeys(u),j=0;j<rowKeys.length;j++){for(colKeys=t.getObjectKeys(u[rowKeys[j]]),r=0;r<colKeys.length;r++)t._isRowViewable(h,parseInt(rowKeys[j]))&&(f=t.getCell(parseInt(rowKeys[j]),parseInt(colKeys[r]),i).find(".e-comment-txtarea"),this._isShowAllComments?f.hide():f.css("display","inline-table")),t.XLEdit.getPropertyValue(rowKeys[j],colKeys[r],"comment",i).isVisible=!this._isShowAllComments;j==0&&(e=!0)}this._isShowAllComments=!this._isShowAllComments;t.model.showRibbon&&o&&o.model.toggleState?t.XLRibbon._disableButtons(s,"ejButton"):t.model.showRibbon&&e&&t.XLRibbon._enableButtons(s,"ejButton")}},findPrevComment:function(){var i=this.XLObj,s,r,y,c,l,a,u,f,o,e,p,h,v;if(i.model.allowComments&&!i.model.isReadOnly){for(s=i.getActiveSheetIndex(),p=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),u=s;u>0;u--)if(r=i.getSheet(u),i.getObjectLength(r._commentColl))for(u!==s&&i.gotoPage(u,!1),i.model.showRibbon&&(v=i.XLRibbon._getTabIndex("review"),v&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",v)),y=r.rowCount-1,c=r.colCount-1,u!==s&&this._updateCurrentCell(y-1,c-1),l=r._activeCell.rowIndex,a=r._activeCell.colIndex,f=l;f>=0;f--)for(f!==l&&(a=c-1),o=a;o>=0;o--)if(i._isRowViewable(s,f)){if(e=n(i.getCell(f,o)),h=n(e.find(".e-comment-txtarea")),r._activeCell.rowIndex!==f&&r._activeCell.colIndex!==o&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(e,"comment"))&&i.XLEdit.getPropertyValueByElem(e,"comment").isVisible&&h.hide(),e.hasClass("e-commentcell")&&!h.is(":visible"))return h.css("display","inline-table").focus()&&this._updateCurrentCell(f,o),this._updateCommentsBtns(p),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!e.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(e,"comment").isVisible||h.hide()}u===0&&i._showAlertDlg("","CommentFindEndAlert","findPrevComment",630)}},_updateCommentsBtns:function(n){var t=this.XLObj;t.model.showRibbon&&(t.XLRibbon._enableButtons(["Review_Comments_DeleteComment","Review_Comments_ShowHideComment"],"ejButton"),n.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),n.find(".e-btntxt").text(t._getLocStr("EditComment")))},findNextComment:function(){var i=this.XLObj,o,e,c,l,v,y,r,f,s,u,h,p,a;if(i.model.allowComments&&!i.model.isReadOnly){for(o=i.getActiveSheetIndex(),p=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),r=o;r<=i.model.sheetCount;r++)if(e=i.getSheet(r),i.getObjectLength(e._commentColl))for(r!==o&&i.gotoPage(r,!1),i.model.showRibbon&&(a=i.XLRibbon._getTabIndex("review"),a&&n("#"+i._id+"_Ribbon").ejRibbon("option","selectedItemIndex",a)),r!==o&&this._updateCurrentCell(0,0),c=e._activeCell.rowIndex,l=e._activeCell.colIndex,v=e.rowCount-1,y=e.colCount-1,f=c;f<v;f++)for(f!==c&&(l=0),s=l;s<y;s++){if(i._isRowViewable(o,f)&&(u=n(i.getCell(f,s)),h=n(u.find(".e-comment-txtarea")),i.getActiveCellElem()[0]!==u[0]&&!t.isNullOrUndefined(i.XLEdit.getPropertyValueByElem(u,"comment"))&&i.XLEdit.getPropertyValueByElem(u,"comment").isVisible&&h.hide(),u.hasClass("e-commentcell")&&!h.is(":visible")))return h.css("display","inline-table").focus(),this._updateCurrentCell(f,s),this._updateCommentsBtns(p),i.setSheetFocus(),!0;this._isShowAllComments||this._isCommentEdit||!u.hasClass("e-commentcell")||i.XLEdit.getPropertyValueByElem(u,"comment").isVisible||h.hide()}r===i.model.sheetCount+1&&i._showAlertDlg("","CommentFindEndAlert","findNextComment",630)}},_commentMouseMove:function(i){var e=this.XLObj,r,f,u;(r=i.target.tagName==="TD"?n(i.target):n(i.target).parent("td"),r.length)&&(f=r.find(".e-comment-txtarea"),this._isCommentEdit||(t.isNullOrUndefined(this._curCommentHCell)||r!==this._curCommentHCell&&(u=e.XLEdit.getPropertyValueByElem(this._curCommentHCell,"comment"),t.isNullOrUndefined(u)||u.isVisible||(this._curCommentHCell.find(".e-comment-txtarea").hide(),this._curCommentHCell=null)),r[0].tagName==="TD"&&r.hasClass("e-commentcell")&&(f.css("display","inline-table"),this._curCommentHCell=r)))},_commentMouseDownHandler:function(t){var i=this.XLObj,r=i.getActiveCell(),o=i.getActiveSheetIndex(),u,f,e;i._isRowViewable(o,r.rowIndex)&&(u=i.getCell(r.rowIndex,r.colIndex,o),e=n(u.find(".e-comment-txtarea")),u.hasClass("e-commentcell")&&e.get()[0]!==t.target&&(f=i.XLEdit.getPropertyValue(r.rowIndex,r.colIndex,"comment"),this._isCommentEdit&&this._updateCurCmntVal(r),this._isShowAllComments||i.isUndefined(f)||f.isVisible||e.hide()));i._hasClass(t.target,"e-comment-txtarea")&&!t.target.disabled&&(n(t.target).focus().css("z-index",10)&&(this._isCommentEdit=!0),this._updateCurrentCell(n(t.target).parents("td").parent().index(),n(t.target).parents("td").index()),i.model.showRibbon&&i.XLRibbon._disableRibbonIcons())},_updateCmntRibIcons:function(t){var f,i=this.XLObj,e=["Review_Comments_ShowHideComment","Review_Comments_DeleteComment"],u=i.getActiveSheetIndex(),l=i.getSheetElement(u),r=n("#"+i._id+"_Ribbon_Review_Comments_NewComment"),h=i.getActiveCell(),o=i.getSheet(u),c=o._selectedCells,s=o.selectedRange;t=i.model.allowDragAndDrop&&!i.XLDragDrop._isDragAndDropped?t?t:h:{rowIndex:i._dStartCell.rowIndex,colIndex:i._dStartCell.colIndex};i.XLRibbon._enableButtons(["Review_Comments_NewComment"],"ejButton");i.XLRibbon._enableButtons(i.XLRibbon._cmntTglBtnIds,"ejToggleButton");f=i.XLEdit.getPropertyValue(t.rowIndex,t.colIndex,"comment",u);f?(i.XLRibbon._enableButtons(e,"ejButton"),r.find(".e-icon").removeClass("e-ssr-newcmnt").addClass("e-ssr-editcmnt"),r.find(".e-btntxt").text(i._getLocStr("EditComment"))):(r.find(".e-icon").removeClass("e-ssr-editcmnt").addClass("e-ssr-newcmnt"),r.find(".e-btntxt").text(i._getLocStr("NewComment")),i.XLRibbon._disableButtons(e,"ejButton"));this._isShowAllComments||i._commentCount===0?i.XLRibbon._disableButtons(["Review_Comments_PreviousComment","Review_Comments_NextComment"],"ejButton"):i.XLRibbon._enableButtons(["Review_Comments_PreviousComment","Review_Comments_NextComment"],"ejButton");c.length&&i.inRange(s,t.rowIndex,t.colIndex)&&i.XLEdit._rangeHasProperty(s,"comment")&&i.XLRibbon._enableButtons(["Review_Comments_DeleteComment"],"ejButton")},_updateCurCmntVal:function(n,i){i=t.isNullOrUndefined(i)?"":i;var r=this.XLObj,h=t.isNullOrUndefined(n)?r.getActiveCell():n,o,c=[],l="User Name:",s=!1,e={sheetIndex:r.getActiveSheetIndex(),reqType:"comment"},u=h.rowIndex,f=h.colIndex;r._isRowViewable(e.sheetIndex,u)&&(o=r.getCell(u,f,r.getActiveSheetIndex()).find(".e-comment-txtarea"),s=!0,o.scrollTop(0));c.push({rowIndex:u,colIndex:f});e.action=t.isNullOrUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?"add":"edit";e.selectedCell=c;e.selectedCell[0].prevComment=r.XLEdit.getPropertyValue(u,f,"comment");s&&(l=o.css("z-index",9).val());r.XLEdit._updateDataContainer({rowIndex:u,colIndex:f},{dataObj:{comment:{value:l,isVisible:r.isUndefined(r.XLEdit.getPropertyValue(u,f,"comment"))?this._isShowAllComments:r.XLEdit.getPropertyValue(u,f,"comment").isVisible}}});!s||this._isShowAllComments||r.XLEdit.getPropertyValue(u,f,"comment").isVisible||o.hide();r.setSheetFocus();this._isCommentEdit=!1;r.XLCellNav._isNavigate=!0;r.model.showRibbon&&r.XLRibbon._enableRibbonIcons();r.XLEdit._updateUsedRange(u,f);e.selectedCell[0].curComment=r.XLEdit.getPropertyValue(u,f,"comment");r._isUndoRedo||i==="paste"||r._completeAction(e)},_updateCurrentCell:function(n,t,i){var r=this.XLObj,u={rowIndex:n,colIndex:t},f;i=i?i:r.model.activeSheetIndex;f=r.getSheet(i);f._activeCell=u;r.model.allowSelection&&r.XLSelection.selectRange(u,u,i);f._startCell=f._endCell=u;r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_visibleCmntCnt:function(n,t){n.find(".e-comment")[t?"show":"hide"]()},_updateCmntArrowPos:function(t,i,r){var o,l,u,c,e,s,f=this.XLObj,i=f._getSheetIndex(i),h=f.getSheet(i),a=t||f._getContent(i).find(".e-commentcell");if(r=r||{},f.model.allowComments)for(o=0,l=a.length;o<l;o++)if((s=n(a[o]),u=f._getCellIdx(s[0]),!(u.rowIndex<r.rowIndex)&&!(u.colIndex<r.colIndex))&&(e=s.find(".e-comment"),f._isInsdel&&(u.rowIndex in h._commentColl||(h._commentColl[u.rowIndex]={}),h._commentColl[u.rowIndex][u.colIndex]={isComment:!0}),e.length)){if(c=f._getCellInfo(u,i),h.columnsWidthCollection[u.colIndex]<5){e.hide();continue}e.is(":hidden")&&e.show();e.css({top:c.top+"px",left:c.left+s.width()+"px"})}},_updateCmntFrmCntnr:function(n,t){var i=this.XLObj;i.XLEdit.getPropertyValue(n,t,"comment")&&(i._isRowViewable(null,t)&&i.getCell(n,t).hasClass("e-commentcell")&&this.deleteComment([n,t,n,t]),this.setComment([n,t,n,t],null,!1))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.contextmenu=function(n){this.XLObj=n;this._clrFltrEnable=!1;this._isMenuOpened=!1;this._uniqueClass=n._id+"-cmenu";this._selColor="";this._changedDataSource=!1;this._rowCellMenuDataMobile=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"PasteSpecial",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,spriteCssClass:"e-icon e-ss-formatcells"},{id:"BackgroundColor",text:n._getLocStr("BackgroundColor"),parentId:null,spriteCssClass:"e-icon e-ss-backgroundcolor"},{id:"FontColor",text:n._getLocStr("FontColor"),parentId:null,spriteCssClass:"e-icon e-ss-fontcolor"},];this._headerMenuDataMobile=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"PasteSpecial",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},];this._rowCellMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert")+"...",parentId:null},{id:"Delete",text:n._getLocStr("Delete")+"...",parentId:null},{id:"Filter",text:n._getLocStr("Filter"),parentId:null,spriteCssClass:"e-icon e-ss-filter"},{id:"Sort",text:n._getLocStr("Sort"),parentId:null,spriteCssClass:"e-icon e-ss-sortatoz"},{id:"SortAtoZ",parentId:"Sort",text:n._getLocStr("SortAtoZ"),spriteCssClass:"e-icon e-ss-sortatoz"},{id:"SortZtoA",parentId:"Sort",text:n._getLocStr("SortZtoA"),spriteCssClass:"e-icon e-ss-sortztoa"},{id:"ctxComment",parentId:null,text:n._getLocStr("Comment")},{id:"ctxInsrtCmnt",text:n._getLocStr("InsertComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-newcmnt"},{id:"ctxEditCmnt",text:n._getLocStr("EditComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-editcmnt"},{id:"ctxDeleteCmnt",text:n._getLocStr("DeleteComment"),parentId:"ctxComment",spriteCssClass:"e-icon e-ss-deletecmnt"},{id:"ctxShwHdCmnt",text:n._getLocStr("ShowHide"),parentId:"ctxComment",spriteCssClass:"e-icon"},{id:"FormatCells",text:n._getLocStr("FormatCells")+"...",parentId:null,spriteCssClass:"e-icon e-ss-formatcells"},{id:"PutCellColor",parentId:"Sort",text:n._getLocStr("PutCellColor"),spriteCssClass:""},{id:"PutFontColor",parentId:"Sort",text:n._getLocStr("PutFontColor"),spriteCssClass:""},{id:"CmHyperLink",text:n._getLocStr("HyperLink"),parentId:null,spriteCssClass:"e-icon e-ss-hyperlink"},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,spriteCssClass:"e-icon e-ss-clear"},{id:"ClearFilter",parentId:"Filter",text:n._getLocStr("ClearFilter"),spriteCssClass:"e-icon e-ss-filternone"},{id:"FilterSelected",parentId:"Filter",text:n._getLocStr("FilterSelected"),spriteCssClass:"e-icon e-ss-filter"},{id:"HyperLink",text:n._getLocStr("HyperLink")+"...",parentId:"CmHyperLink",spriteCssClass:"e-icon e-ss-hyperlink"},{id:"EditLink",text:n._getLocStr("EditLink")+"...",parentId:"CmHyperLink"},{id:"OpenLink",text:n._getLocStr("OpenLink"),parentId:"CmHyperLink"},{id:"RemoveLink",text:n._getLocStr("RemoveLink"),parentId:"CmHyperLink",spriteCssClass:"e-icon e-ss-removelink"}];this._rowHeaderMenuData=this._columnHeaderMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"Paste",text:n._getLocStr("Paste"),parentId:null,spriteCssClass:"e-icon e-ss-paste"},{id:"Insert",text:n._getLocStr("Insert"),parentId:null},{id:"Delete",text:n._getLocStr("Delete"),parentId:null},{id:"ClearContents",text:n._getLocStr("ClearContents"),parentId:null,spriteCssClass:"e-icon e-ss-clear"},{id:"Hide",text:n._getLocStr("Hide"),parentId:null},{id:"Unhide",text:n._getLocStr("Unhide"),parentId:null},{id:"PasteSpecial",text:n._getLocStr("PasteSpecial"),parentId:"Paste"},{id:"PasteValues",text:n._getLocStr("PasteValues"),parentId:"Paste"}];this._footerMenuData=[{id:"InsertSheet",text:n._getLocStr("InsertSheet"),parentId:null},{id:"DeleteSheet",text:n._getLocStr("DeleteSheet"),parentId:null,spriteCssClass:"e-icon e-ss-delete"},{id:"RenameSheet",text:n._getLocStr("RenameSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"MoveorCopy",text:n._getLocStr("MoveorCopy")+"...",parentId:null,spriteCssClass:"e-icon "},{id:"HideSheet",text:n._getLocStr("HideSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"UnhideSheet",text:n._getLocStr("UnhideSheet"),parentId:null,spriteCssClass:"e-icon "},{id:"ProtectSheet",text:n._getLocStr("Protectsheet"),parentId:null,spriteCssClass:"e-icon e-ss-cmenuprotect"}];this._chartMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"ChartType",text:n._getLocStr("ChangeChartType")+"...",parentId:null},{id:"SelectData",text:n._getLocStr("SelectData")+"...",parentId:null}];this._imgMenuData=[{id:"Cut",text:n._getLocStr("Cut"),parentId:null,spriteCssClass:"e-icon e-ss-cut"},{id:"Copy",text:n._getLocStr("Copy"),parentId:null,spriteCssClass:"e-icon e-ss-copy"},{id:"ChangePicture",text:n._getLocStr("ChangePicture"),parentId:null}];this._pivotMenuData=[{id:"Refresh",text:n._getLocStr("Refresh"),parentId:null,spriteCssClass:"e-icon e-ss-pivotrefresh"}];this._protectRowMenuIds=["Insert","Delete","Filter","ctxComment","Sort","LockCells","CmHyperLink","FormatCells","ClearContents"];this._prtctHeaderIds=["Insert","Delete","Hide","Unhide","ClearContents"];this._footerIds=["InsertSheet","DeleteSheet","RenameSheet","MoveorCopy","HideSheet","UnhideSheet"]};t.Menu.prototype._calculateContextMenuPosition=function(t){var e=this.element.get(0).id,u=this.element.data("id"),f=n("#"+u).data("ejSpreadsheet"),i,r;return locationX=t.clientX+this.element.width()<n(window).width()?t.pageX:t.pageX-this.element.width(),i=f&&e.indexOf(u+"_contextMenuFooter")>-1?f.element.height():n(window).height(),locationY=t.clientY+this.element.height()<i?t.pageY:t.clientY>this.element.height()?t.pageY-this.element.height():i-this.element.outerHeight(),r=n("body").css("position")!="static"?n("body").offset():{left:0,top:0},locationX-=r.left,locationY-=r.top,{X:locationX,Y:locationY}};t.spreadsheetFeatures.contextmenu.prototype={_initContextMenu:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none",width:"auto"},{id:this.XLObj._id+"_contextMenuCell"});this._createMenu(n,this.XLObj._phoneMode||this.XLObj._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,"#"+this.XLObj._id+" .e-spreadsheetcontentcontainer");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuColumnHeader"});this._createMenu(n,this._columnHeaderMenuData,"#"+this.XLObj._id+" .e-spreadsheetheader .e-headercontent");n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuRowHeader"});this._createMenu(n,this._rowHeaderMenuData,"#"+this.XLObj._id+" .e-rowheadercontent")},_initCMenuFooter:function(){var n=t.buildTag("ul .e-spreadsheet e-"+this._uniqueClass," ",{display:"none"},{id:this.XLObj._id+"_contextMenuFooter"});n.data("id",this.XLObj._id);this._createMenu(n,this._footerMenuData,"#"+this.XLObj._id+" .e-pagercontainer")},_createMenu:function(i,r,u){i.ejMenu({fields:{dataSource:r,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"},menuType:t.MenuType.ContextMenu,openOnClick:!1,beforeOpen:n.proxy(this._beforeOpen,this),close:n.proxy(this._menuClose,this),click:n.proxy(this._menuClick,this),contextMenuTarget:u})},hideCMenu:function(){var t=this.XLObj;t.model.enableContextMenu&&(n("#"+t._id+"_contextMenuCell").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuColumnHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuRowHeader").data("ejMenu").element.hide(),n("#"+t._id+"_contextMenuFooter").data("ejMenu").element.hide())},_getCMenuObj:function(i){var r=this.XLObj;switch(i){case t.Spreadsheet.ContextMenu.Cell:return n("#"+r._id+"_contextMenuCell").data("ejMenu");case t.Spreadsheet.ContextMenu.RowHeader:return n("#"+r._id+"_contextMenuRowHeader").data("ejMenu");case t.Spreadsheet.ContextMenu.ColumnHeader:return n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu");case t.Spreadsheet.ContextMenu.Footer:return n("#"+r._id+"_contextMenuFooter").data("ejMenu")}},addItem:function(n,t,i){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n);switch(i){case"insert":r.insert(t,r.element);break;case"insertbefore":r.insertBefore(t,r.element);break;case"insertafter":r.insertAfter(t,r.element)}}},removeItem:function(n,t){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n),u=[],i;for(i=0,length=t.length;i<length;i++)u.push(r.element.find("li:eq("+(t[i]-1)+")"));r.remove(u)}},enableItem:function(n,t){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n),i;if(t&&t.length>0)for(i=0,length=t.length;i<length;i++)r.enableItemByID(r.element.find("li:eq("+(t[i]-1)+")")[0].id);else r.enable()}},disableItem:function(n,t){if(n&&!this.XLObj.model.isReadOnly){var r=this._getCMenuObj(n),i;if(t&&t.length>0)for(i=0,length=t.length;i<length;i++)r.disableItemByID(r.element.find("li:eq("+(t[i]-1)+")")[0].id);else r.disable()}},changeDataSource:function(n,i){if(n&&!this.XLObj.model.isReadOnly&&i){this._changedDataSource=!0;switch(n){case t.Spreadsheet.ContextMenu.Cell:this._rowCellMenuDataMobile=this._rowCellMenuData=i;break;case t.Spreadsheet.ContextMenu.RowHeader:this._headerMenuDataMobile=this._rowHeaderMenuData=i;break;case t.Spreadsheet.ContextMenu.ColumnHeader:this._headerMenuDataMobile=this._columnHeaderMenuData=i;break;case t.Spreadsheet.ContextMenu.Footer:this._footerMenuData=i}}},_updateContextMenuItems:function(i){var r=this.XLObj,d,g,ht=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),ct=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),ut,nt=i[0],h=r.getActiveSheetIndex(),v=r.getSheet(h),st=!t.isNullOrUndefined(r.getActiveCellElem())&&r.getActiveCellElem().length>0?r.getActiveCellElem():i,f=r._phoneMode||r._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,u=n("#"+r._id+"_contextMenuCell").data("ejMenu"),e=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),a=r.getActiveCell(h),ft,c,s,et,it,b,p,ot,k,rt,o;if(i.hasClass("e-rowcell")||i.hasClass("e-hyperlinks")){var l,y=[],lt=r._getJSSheetHeader(h).find("th"),at=r._getJSSheetRowHeader(h).find("td"),tt=r.XLEdit.getPropertyValue(v._activeCell.rowIndex,v._activeCell.colIndex),w=r._getCellIdx(r._hasClass(i,"e-hyperlinks")?i.parents("td")[0]:nt);if(this._isMenuOpened=!0,r.model.allowLockCell&&v.isSheetProtected&&r.XLEdit.getPropertyValue(w.rowIndex,w.colIndex,"isLocked",h))this._disableMenuOpt(this._protectRowMenuIds);else{if(i.hasClass("e-hyperlinks")&&(i=i.parents("td"),nt=i[0]),r.model.allowHyperlink?(this._enableMenuOpt(["CmHyperLink"]),et=r.XLEdit.getPropertyValue(w.rowIndex,w.colIndex,"hyperlink",h),it=["EditLink","OpenLink","RemoveLink"],t.isNullOrUndefined(et)?(this._disableMenuOpt(it),this._enableMenuOpt(["HyperLink"])):(this._enableMenuOpt(it),this._disableMenuOpt(["HyperLink"]))):this._disableMenuOpt(["CmHyperLink"]),r.model.allowFiltering){if(u.enableItemByID("Filter"),s=r.model.sheets[h].filterSettings.tableRange,b=r.getCell(a.rowIndex,a.colIndex,h)[0],s.length>0){for(ft=b.className.indexOf("e-table")>-1?b.className[b.className.indexOf("e-table")+7]:-1,p=0,ot=s.length;p<ot;p++)if(s[p].tableID===parseInt(ft)){c=p;break}!t.isNullOrUndefined(c)&&a.rowIndex<s[c].selectedRange.endRow+1&&a.rowIndex>s[c].selectedRange.startRow-2&&a.colIndex<s[c].multifilterIdx[s[c].multifilterIdx.length-1]+1&&a.colIndex>s[c].multifilterIdx[0]-1&&(d=r.getCell(s[c].selectedRange.startRow-1,a.colIndex,h).find("span"),d.length&&d[0].className.indexOf("e-ssfiltered")>-1&&(u.enableItemByID("ClearFilter"),this._clrFltrEnable=!0))}this._clrFltrEnable||u.disableItemByID("ClearFilter")}else u.disableItemByID("Filter");r.model.allowInsert&&r.model.scrollSettings.allowScrolling&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Normal?u.enableItemByID("Insert"):u.disableItemByID("Insert");r.model.allowDelete&&r.model.scrollSettings.allowScrolling&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Normal?u.enableItemByID("Delete"):u.disableItemByID("Delete");(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?(this._enableMenuOpt(["Paste"]),r.isPasteValuesOnly&&u.disableItemByID("PasteSpecial")):this._disableMenuOpt(["Paste"]);r.model.allowSorting?this._enableMenuOpt(["Sort"]):this._disableMenuOpt(["Sort"]);r.model.allowClear?this._enableMenuOpt(["ClearContents"]):this._disableMenuOpt(["ClearContents"]);r.model.allowCellFormatting?this._enableMenuOpt(["FormatCells"]):this._disableMenuOpt(["FormatCells"]);r._phoneMode||r._tabMode||(y=!t.isNullOrUndefined(tt)&&n.isNumeric(tt)?[r._getLocStr("SortSmallesttoLargest"),r._getLocStr("SortLargesttoSmallest")]:t.isNullOrUndefined(t.parseDate(tt))?[r._getLocStr("SortAtoZ"),r._getLocStr("SortZtoA")]:[r._getLocStr("SortOldesttoNewest"),r._getLocStr("SortNewesttoOldest")],r.model.allowComments?(u.element.find("#ctxComment").hasClass("e-disable-item")&&this._enableMenuOpt(["ctxComment"]),k=r.getSheetElement(r.getActiveSheetIndex()).find(".e-selected"),rt=k.length>1?st:i,rt.hasClass("e-commentcell")?(this._disableMenuOpt(["ctxInsrtCmnt"]),r.XLEdit.getPropertyValueByElem(rt,"comment").isVisible?(l=n.extend(f[13],{text:r._getLocStr("HideComment")}),u.remove(["#"+f[13].id]),u.insert([l],"#"+f[9].id)):(l=n.extend(f[13],{text:r._getLocStr("ShowHide")}),u.remove(["#"+f[13].id]),u.insert([l],"#"+f[9].id)),this._enableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])):(this._enableMenuOpt(["ctxInsrtCmnt"]),this._disableMenuOpt(["ctxEditCmnt","ctxDeleteCmnt","ctxShwHdCmnt"])),k.filter(nt).length>0&&k.filter(".e-commentcell").length>0&&this._enableMenuOpt(["ctxDeleteCmnt"])):this._disableMenuOpt(["ctxComment"]),f[7].text!==y[0]&&(l=n.extend(f[7],{text:y[0],spriteCssClass:f[7].sprite}),u.remove(["#"+f[7].id]),u.insertBefore([l],"#"+f[15].id)),f[8].text!==y[1]&&(l=n.extend(f[8],{text:y[1],spriteCssClass:f[8].sprite}),u.remove(["#"+f[8].id]),u.insertBefore([l],"#"+f[15].id)));r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected"))}r.model.allowInsert?e.enableItemByID("InsertSheet"):e.disableItemByID("InsertSheet");r.model.allowDelete?e.enableItemByID("DeleteSheet"):e.disableItemByID("DeleteSheet");r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"]):this._disableMenuOpt(["Cut","Copy"]);(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?this._enableMenuOpt(["Paste"],o):this._disableMenuOpt(["Paste"],o)}else if(i.hasClass("e-link")){if(g=e.model.fields.dataSource.slice(0),r._isSheetRename&&!r._updateSheetNames()){args.cancel=!0;return}ut=r.model.allowLockCell&&v.isSheetProtected?r._getLocStr("Unprotect"):r._getLocStr("Protectsheet");g[6].text=ut;e.option("fields",{id:"id",dataSource:g,parentId:"parentId"});this._isMenuOpened=!0;r._isCommentEdit&&r.XLComment._updateCurCmntVal();i.not("a.e-currentitem, a.e-PP, a.e-NP").hasClass("e-numericitem")&&r.gotoPage(i.data("index"));r.model.exportSettings.password?this._disableMenuOpt(this._footerIds,"contextMenuFooter"):(r._getSheetNames(!1).length>0?e.enableItemByID("UnhideSheet"):e.disableItemByID("UnhideSheet"),r._getSheetNames(!0).length>1?(e.enableItemByID("DeleteSheet"),e.enableItemByID("HideSheet"),e.enableItemByID("MoveorCopy")):(e.disableItemByID("DeleteSheet"),e.disableItemByID("HideSheet"),e.disableItemByID("MoveorCopy")));r.model.allowLockCell?e.enableItemByID("ProtectSheet"):e.disableItemByID("ProtectSheet")}else(i.hasClass("e-headercelldiv")||i.hasClass("e-headercell")||i.hasClass("e-rowheader"))&&(o=i.hasClass("e-rowheader")?"contextMenuRowHeader":"contextMenuColumnHeader",r.model.allowClipboard?this._enableMenuOpt(["Cut","Copy"],o):this._disableMenuOpt(["Cut","Copy"],o),(r.XLClipboard._copyBackup.cells||r.XLClipboard._copyBackup.elem)&&!r.model.isReadOnly?this._enableMenuOpt(["Paste"],o):this._disableMenuOpt(["Paste"],o),r.model.allowLockCell&&v.isSheetProtected?this._disableMenuOpt(this._prtctHeaderIds,o):(r.model.allowClear?this._enableMenuOpt(["ClearContents"],o):this._disableMenuOpt(["ClearContents"],o),r.model.allowInsert&&r.model.scrollSettings.allowScrolling&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Normal?this._enableMenuOpt(["Insert"],o):this._disableMenuOpt(["Insert"],o),r.model.allowDelete&&r.model.scrollSettings.allowScrolling&&r.model.scrollSettings.scrollMode!==t.Spreadsheet.scrollMode.Normal?this._enableMenuOpt(["Delete"],o):this._disableMenuOpt(["Delete"],o),this._enableMenuOpt(["Hide","Unhide"],o)),r.model.showRibbon&&r.XLRibbon._dirtySelect(r._getContent(r.getActiveSheetIndex()).find(".e-selected")));r.model.allowInsert&&t.isNullOrUndefined(r.model.exportSettings.password)?this._enableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter"):this._disableMenuOpt(["InsertSheet","MoveorCopy"],"contextMenuFooter");r.model.exportSettings.password?this._disableMenuOpt(["RenameSheet"]):this._enableMenuOpt(["RenameSheet"]);r.model.allowDelete&&r._getSheetNames(!0).length>1?this._enableMenuOpt(["DeleteSheet"],"contextMenuFooter"):this._disableMenuOpt(["DeleteSheet"],"contextMenuFooter");r.model.allowEditing?this._enableMenuOpt(["RenameSheet"],"contextMenuFooter"):this._disableMenuOpt(["RenameSheet"],"contextMenuFooter");r.model.isReadOnly&&(this._disableMenuOpt(["Cut","Insert","Delete","ClearContents"],"contextMenuColumnHeader"),this._disableMenuOpt(["Cut","Insert","Delete","ClearContents"],"contextMenuRowHeader"),this._disableMenuOpt(["Cut","Insert","Delete","Filter","Sort","ctxComment","FormatCells","CmHyperLink","ClearContents"],"contextMenuCell"))},_beforeOpen:function(i){var r=this.XLObj,s=r.XLResize,v,w,c,l;if(!r.model.enableContextMenu||i.events.type=="mousedown"&&i.target.id.indexOf("_picture")>-1||n(i.target).hasClass("e-numericitem")&&r.model.isReadOnly)return i.cancel=!0,!1;this._clrFltrEnable=!1;this.hideCMenu();var y=n("#"+r._id+"_contextMenuColumnHeader").data("ejMenu"),p=n("#"+r._id+"_contextMenuRowHeader").data("ejMenu"),a=i.target,b={target:a},u=n(a),o=r.getActiveSheetIndex(),h=r.getSheet(o),k=!t.isNullOrUndefined(r.getActiveCellElem())&&r.getActiveCellElem().length>0?r.getActiveCellElem():u,f=r._phoneMode||r._tabMode?this._rowCellMenuDataMobile:this._rowCellMenuData,e=n("#"+r._id+"_contextMenuCell").data("ejMenu"),d=n("#"+r._id+"_contextMenuFooter").data("ejMenu"),g=r.getActiveCell(o);r._trigger("beforeOpen",b)||((r.XLEdit._isEdit||r.model.allowComments&&r.XLComment._isCommentEdit||u.hasClass("e-filterspan")||i.events.which===1&&u.hasClass("e-hyperlinks")||u.parents("div").hasClass("e-vscroll")||u.parents("div").hasClass("e-hscroll")||n(a.parentNode).hasClass("e-pagercontainer")&&!u.hasClass("e-link")||!t.isNullOrUndefined(r.XLResize)&&r.XLResize._resizeStart||i.target.id.indexOf("Sheet_RenamePanel")>-1||u.parents().hasClass("e-grid")||u.hasClass("e-autofill"))&&(i.cancel=!0),s&&s._preventColResize(u.parent()[0].cellIndex,!0)&&u.hasClass("e-headercelldiv")&&(i.cancel=!0),s&&s._preventRowResize(parseInt(u.parent().attr("idx")),!0)&&u.hasClass("e-rowheader")&&(i.cancel=!0),u.hasClass("e-rowcell")||u.hasClass("e-hyperlinks")?(v=r._getJSSheetHeader(o).find("th"),w=r._getJSSheetRowHeader(o).find("td"),t.isNullOrUndefined(r.XLEdit.getPropertyValueByElem(r.getCell(h._activeCell.rowIndex,h._activeCell.colIndex),"range"))?n(v[u.index()]).hasClass("e-colselected")||n(w[u.parent().index()]).hasClass("e-rowselected")?(f=n(v[u.index()]).hasClass("e-colselected")?this._columnHeaderMenuData:this._rowHeaderMenuData,JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&this._changedDataSource&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})):JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"}):(c=r.model.sheets[o].rangeSettings[r.XLEdit.getPropertyValueByElem(r.getCell(h._activeCell.rowIndex,h._activeCell.colIndex),"range")],e.option("fields",{dataSource:c.contextMenuSettings.dataSource,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"}),e.option("width",c.contextMenuSettings.width),e.option("height",c.contextMenuSettings.height))):u.hasClass("e-ss-imgvisual")||u.hasClass("e-ss-object")||u.closest("div").hasClass("e-ss-object")?(l=n.extend(!0,[],this._chartMenuData),this._isMenuOpened=!0,l=this.XLObj.model.showRibbon?this._chartMenuData:l.splice(0,2),f=r.XLShape._shapeType==="chart"?l:this._imgMenuData,JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})):u.hasClass("e-ss-pivot")||u.closest("div").hasClass("e-ss-pivot")?(f=this._pivotMenuData,JSON.stringify(f)!==JSON.stringify(i.model.fields.dataSource)&&e.option("fields",{dataSource:f,id:"id",parentId:"parentId",text:"text",spriteCssClass:"spriteCssClass"})):(u.hasClass("e-headercelldiv")||u.hasClass("e-headercell")||u.hasClass("e-rowheader"))&&(r._phoneMode||r._tabMode?(y.option("fields",{dataSource:this._headerMenuDataMobile}),p.option("fields",{dataSource:this._headerMenuDataMobile})):this._changedDataSource&&(y.option("fields",{dataSource:this._columnHeaderMenuData}),p.option("fields",{dataSource:this._rowHeaderMenuData}))),this._changedDataSource||this._updateContextMenuItems(u),i.cancel&&(this._isMenuOpened=!1))},_menuClick:function(n){this.XLObj._trigger("contextMenuClick",n)||this._processCMenu(n.ID,n.events.element)},_menuClose:function(){this._isMenuOpened=!1},_processCMenu:function(i,r){var w,f,u=this.XLObj,e=u.getActiveSheetIndex(),s=u.getSheet(e),a,v,h,c,o=s._selectedCells,y,p,l;switch(i){case"Cut":u.XLClipboard.cut();break;case"Copy":u.XLClipboard.copy();break;case"PasteSpecial":case"PasteValues":u.XLClipboard._isSpecial=!(i==="PasteValues");u.XLClipboard.paste();break;case"Insert":u._insDelStatus="insert";s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.insertEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex)):s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),u.insertEntireRow(n(c[0]).parent().index(),n(c[c.length-1]).parent().index())):u._showDialog(u._id+"_Ribbon_Others_Cells_InsertCellOptions");break;case"Delete":h=n(u._getJSSheetHeader(e).find("tr")[0]).find(".e-colselected");c=n(u.getRows(e)[0]).find(".e-rowselected");r.parentElement.id.indexOf("ColumnHeader")>-1||s._isColSelected?(h=u._getJSSheetHeader(e).find(".e-colhighlight"),u.deleteEntireColumn(h[0].cellIndex,h[h.length-1].cellIndex,[])):r.parentElement.id.indexOf("RowHeader")>-1||s._isRowSelected?(c=u._getJSSheetRowHeader(e).find(".e-rowhighlight"),u.deleteEntireRow(n(c[0]).parent().index(),n(c[c.length-1]).parent().index(),[])):u._showDialog(u._id+"_Ribbon_Others_Cells_DeleteCellOptions");break;case"FilterSelected":u._showDialog(u._id+"_Ribbon_Data_SortFilter_Filter");u.XLFilter.filterByActiveCell();this._clrFltrEnable=!1;break;case"ClearFilter":a=u.getActiveCell(e);y=u.XLEdit.getPropertyValue(a.rowIndex,a.colIndex,"tableName");p=t.isNullOrUndefined(y)?-1:parseInt(y.replace("table",""));p>-1?(v=u.model.sheets[e].columns[a.colIndex].field,u.XLFilter._clearFilterColumn(v,"","","","","",p),delete u._excelFilter._predicates[e][v]):u.XLFilter.clearFilter("apply");this._clrFltrEnable=!1;break;case"SortAtoZ":case"SortZtoA":case"SortSmallesttoLargest":case"SortLargesttoSmallest":case"SortOldesttoNewest":case"SortNewesttoOldest":case"PutCellColor":case"PutFontColor":u.model.allowSorting&&u.XLSort._sortHandler(i);break;case"ClearContents":l=u.model.sheets[e].selectedRange;u.clearContents(u._getAlphaRange(e,l[0],l[1],l[2],l[3]));break;case"InsertSheet":u.insertSheet();break;case"DeleteSheet":u.deleteSheet(e);break;case"RenameSheet":u._renameSheet();break;case"MoveorCopy":u._showDialog(u._id+"_MoveorCopy");break;case"Hide":s._isColSelected&&u._hideColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._hideRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"Unhide":s._isColSelected&&u._showColumn(o[0].colIndex,o[o.length-1].colIndex);s._isRowSelected&&u._showRow(o[0].rowIndex,o[o.length-1].rowIndex,"isRHide");break;case"HyperLink":case"EditLink":u._showDialog(u._id+"_Ribbon_Insert_Links_Hyperlink");break;case"RemoveLink":u._removeHyperlink();break;case"OpenLink":u._openLink();break;case"ctxInsrtCmnt":u._dupDetails=!0;u.XLComment.setComment();u._dupDetails=!1;break;case"ctxEditCmnt":u.XLComment.editComment();break;case"ctxDeleteCmnt":u.XLComment.deleteComment();break;case"ctxShwHdCmnt":u.XLComment.showHideComment();break;case"ChangePicture":u._uploadImage=!0;u.XLShape._changePicture=!0;u.element.find("#"+u._id+"_file .e-uploadinput").click();break;case"ChartType":u._showDialog(u._id+"_Ribbon_ChartDesign_Type_ChangeChartType");u.XLRibbon._refreshChartTypeDlg();break;case"SelectData":u._showDialog(u._id+"_Ribbon_ChartDesign_Data_SelectData");w=document.getElementById(u._id+"_chart").value;f=u.XLChart._getShapeObj(w,"chart");n("#"+u._id+"_crxaxis").val(f.xRange?u._getAlphaRange(e,f.xRange[0],f.xRange[1],f.xRange[2],f.xRange[3]):"");n("#"+u._id+"_cryaxis").val(f.yRange?u._getAlphaRange(e,f.yRange[0],f.yRange[1],f.yRange[2],f.yRange[3]):"");n("#"+u._id+"_crlaxis").val(f.lRange?u._getAlphaRange(e,f.lRange[0],f.lRange[1],f.lRange[2],f.lRange[3]):"");u._selectDataval={xRange:n("#"+u._id+"_crxaxis").val(),yRange:n("#"+u._id+"_cryaxis").val(),lRange:n("#"+u._id+"_crlaxis").val()};n("#"+u._id+"_chartrangedlg").ejDialog("open");break;case"HideSheet":u.hideSheet();break;case"UnhideSheet":u._showDialog(u._id+"_UnhideSheet");break;case"ProtectSheet":u.protectSheet(!s.isSheetProtected);break;case"FormatCells":u._showDialog(u._id+"_FormatCells");break;case"Refresh":u.XLPivot.refreshDataSource();break;case"BackgroundColor":n("#"+this.XLObj._id+"_colordlg").ejDialog("open");this._selColor={action:"bg-color",color:""};break;case"FontColor":n("#"+this.XLObj._id+"_colordlg").ejDialog("open");this._selColor={action:"color",color:""}}},_disableMenuOpt:function(t,i){var e=i||"contextMenuCell",u=n("#"+this.XLObj._id+"_"+e).data("ejMenu"),r,f;if(u)for(r=0,f=t.length;r<f;r++)u.disableItemByID(t[r])},_enableMenuOpt:function(t,i){var e=i||"contextMenuCell",u=n("#"+this.XLObj._id+"_"+e).data("ejMenu"),r,f;if(u)for(r=0,f=t.length;r<f;r++)u.enableItemByID(t[r])},_initColorDialog:function(){var r=this.XLObj,i=r._id+"_colordlg";if(!n("#"+i).length){var u=t.buildTag("div#"+i+".e-colordlg e-"+r._id+"-dlg ","",{display:"none"}),f=t.buildTag("div#"+i+"_dlgcontent .e-colordlgcontent"),h=t.buildTag("input#"+i+"_cpicker"),c=t.buildTag("div#"+i+"_condiv .e-dlg-btnctnr"),e=t.buildTag("input#"+this._id+"_dialog_Ok"),o=t.buildTag("input#"+this._id+"_dialog_Can","",{"margin-left":10}),s=t.buildTag("div#"+i+"_dlgbtncontent .e-dlg-btnfields");f.append(h);u.append(f);r.element.append(u);u.ejDialog({showOnInit:!1,enableModal:!0,enableResize:!1,allowKeyboardNavigation:!1,title:r._getLocStr("ColorPicker"),width:"240",height:"auto",minHeight:0,cssClass:"e-ss-dialog e-"+r._id+"-dlg"});n("#"+i+"_cpicker").ejColorPicker({value:"#278787",modelType:"palette",presetType:"basic",cssClass:"e-ss-colorpicker e-ss-menuclrpkr",select:n.proxy(this._cpClickHandler,this),showApplyCancel:!1});n("#"+i+"_cpickerWrapper").hide();f.append(n("#"+i+"_cpicker_popup").css("display","block"));e.ejButton({text:r._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._colorOkClick,this),enabled:!0});o.ejButton({text:r._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._colorCanClick,this)});s.append(c.append(e,o));u.append(s)}},_cpClickHandler:function(n){this._selColor.color=n.value},_colorOkClick:function(){var t=this.XLObj;t.XLFormat.format({style:this._selColor.action==="bg-color"?{"background-color":this._selColor.color}:{color:this._selColor.color}});t.setSheetFocus();n("#"+t._id+"_colordlg").ejDialog("close")},_colorCanClick:function(){n("#"+this.XLObj._id+"_colordlg").ejDialog("close")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.sorting=function(n){this.XLObj=n;this._isSortByFilter=!1};t.spreadsheetFeatures.sorting.prototype={_sortHandler:function(n){var e,v,y,p,w,b,k,l,s,h,d,o,a={},g="",r={},i=this.XLObj,tt=i._formatRegx,c=i.getActiveSheetIndex(),u=i.getSheet(c),f=u._selectedCells,nt;if(g=u.columns[u._activeCell.colIndex].field,this._isSortByFilter=!1,n!="PutCellColor"&&n!="PutFontColor"){if(!i.model.allowSorting||!u._selectedCells.length)return;if(f.length===1&&i.selectAll(),b=n==="Ribbon_SortZtoA"||n==="SortZtoA"?t.sortOrder.Descending:t.sortOrder.Ascending,k=i.XLEdit.getPropertyValue(u._activeCell.rowIndex,u._activeCell.colIndex,"tableName",c)||"",l=i._getTableID(k),t.isNullOrUndefined(l)){if(r=u.selectedRange.slice(0),s=r[0],h=r[1],s===r[2])return;for(p=i.XLEdit.getPropertyValue(s,h),e=s+1;e<=r[2];e++)if(!i._isHiddenRow(e)){w=i.XLEdit.getPropertyValue(e,h);break}v=i.isNumber(p)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;y=i.isNumber(w)?t.Spreadsheet.CellType.Number:t.Spreadsheet.CellType.String;i.XLEdit.getPropertyValue(s,h,"merge")||i.XLEdit.getPropertyValue(e,h,"merge")||i.XLEdit.getPropertyValue(r[0],r[1],"calcValue")||(v!=y||i.XLEdit.getPropertyValue(r[0],r[1],"wrap")||i.XLEdit.getPropertyValue(r[0],r[1],"isFilterHeader"))&&r[0]++}else r=u.tableManager[l].range.slice(0),r[0]++;this.sortByRange(r,g,b)}else nt=f.length===1?this._selectSortRange(c,f[0]):u._startCell.rowIndex,d=i._getAlphaRange(c,nt,f[0].colIndex,f.length===1?f[0].rowIndex:u._endCell.rowIndex,f[0].colIndex),o=i.XLEdit.getPropertyValue(u._activeCell.rowIndex,u._activeCell.colIndex,"formats"),i.isUndefined(o)||(o["background-color"]&&(a["background-color"]=o["background-color"].toLowerCase()),o.color&&(a.color=o.color.toLowerCase()),this.sortByColor(n,a,d));f.length===1&&(i.XLSelection.selectRange(f[0],f[0],c),u._startCell=u._endCell=f[0],i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement())},_selectSortRange:function(n,t){for(var u=this.XLObj,r=u.getSheet(n).filterSettings.tableRange,i=0,f=r.length;i<f;i++)if(r[i].multifilterIdx.indexOf(t.colIndex)>-1&&t.rowIndex>r[i].startRow-1&&t.rowIndex<r[i].endRow+1)return r[i].startRow;return u.selectAll(),u.getSheet(n)._selectedCells[0].rowIndex},sortByColor:function(n,i,r){var f=this.XLObj;if(r=f._getRangeArgs(r,"object"),f.model.allowSorting&&!this._sortRangeAlert(r)&&!f.model.isReadOnly){var o=f.getActiveSheetIndex(),u={oprType:n},e,s,c=f.getSheet(o),h;h=c.columns[r[1]].field;t.isNullOrUndefined(i)||(n==="PutCellColor"?(i["background-color"]&&(i=i["background-color"]),u.operation="sortbgcolor",u.bgcolor=i):(i.color&&(i=i.color),u.operation="sortfgcolor",u.fgcolor=i),u.requestType=u.action="sortbycolor",u.sortColumn=h,u.selRange={startCell:{rowIndex:r[0],colIndex:r[1]},endCell:{rowIndex:r[2],colIndex:r[3]}},u.rangeData=f.getRangeDataAsObject(u.selRange.startCell,u.selRange.endCell,!0)[0],u.sortRange=r,e=r[0],t.isNullOrUndefined(e)||(s=f.XLFilter._createSelection(o,e,r[2],r[1],[]).endRowIndex,e=n==="PutCellColor"||n==="PutFontColor"?e:e,u.range=f.model.sheets[o]._selectedRange={startRow:e,endRow:s,dataSourceIndexes:[]},f._processBindings(u)))}},_getSortColorRange:function(n){var r=this.XLObj,i=r.getCell(n.rowIndex,n.colIndex),u=!1,s,t,e=0,h=!1,f=n.rowIndex,o=n.colIndex;if(i.text().length<1){for(t=f;t<f+2;t++)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length>0){u=!0;e=t;break}if(!u){for(t=f;t>f-2;t--)t>-1&&(i=r.getCell(t,o),i.text().length===0&&t>0&&(i=r.getCell(t-1,o),i.text().length==0&&(h=!0)));if(!h)for(t=f-2;t>0;t--)if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}}}else for(t=f;t>=0;t--){if(i=r.getCell(t,o),i.is(":visible")&&i.text().length===0){s=t+1;u=!0;e=s;break}u||t!=0||(e=t,u=!0)}if(u)return e;r._showAlertDlg("Alert","Alert",null,630)},_sortRangeAlert:function(n){for(var u,s,t=this.XLObj,i=i?i:t.getActiveSheetIndex(),e,o=t.getSheet(i)._mergeColl,n=t._getRangeArgs(n,"object"),f=t.getObjectKeys(o),r=0,h=f.length;r<h;r++)for(cKeys=t.getObjectKeys(o[f[r]]),u=0,s=cKeys.length;u<s;u++)if(e=t._dataContainer.sheets[i][f[r]][cKeys[u]].merge,mRange=t.getRangeIndices(e.mRange),n[0]<=mRange[0]&&n[2]>=mRange[2]||n[0]>=mRange[0]&&n[2]<mRange[2])return t._showAlertDlg("Alert","MergeSortAlert","",380),!0;return t.XLEdit._rangeHasProperty(n,"calcValue")?(t._showAlertDlg("Alert","FormulaSortAlert","",315),!0):!1},sortByRange:function(n,i,r){var u=this.XLObj;if(u.model.allowSorting&&!u.model.isReadOnly){var c,l=u.getActiveSheetIndex(),o=0,a=[],f={},v=[],e,y,s,h=u._getJSSheetHeader(l).find(".e-colselected").length;if(u.model.allowSorting){if(n=u._getRangeArgs(n,"object"),this._sortRangeAlert(n))return!0;if(this._isSortByFilter&&h<1){for(s=this._isSortByFilter?n[0]-1:n[0],y=u._getAlphaRange(l,s,n[1],s+1,n[3]),e=u._getAlphaRangeCells(y).find(".e-filterspan"),c=e.length;o<c;)v.push({colIndex:e[o].parentNode.cellIndex,rowIndex:e.eq(o).parents("tr").index()}),o++;e.length&&(n[0]=this._isSortByFilter?n[0]:n[0]+1)}return a=u.getRangeDataAsObject({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},!0)[0],f.requestType=t.Spreadsheet.Actions.Sorting,f.range=n,f.columnName=i,f.rangeData=a,f.action="sorting",f.sortDirection=r,f.filterIcon=v,f.isSortByFilter=this._isSortByFilter,f.colSelected=h,u._processBindings(f),h&&this._isSortByFilter&&u.XLFilter._changeSortIcon({rowIndex:n[0]-1,colIndex:n[1]},r),!1}}},_sortComplete:function(n){var t=this.XLObj,i=n.range,r=this._swapSortedDatas(n),u=r[1];t._dupDetails=!0;n.rangeData=r[0];t.model.allowComments&&t.XLComment.deleteComment(i,null,!0,"comment");t._removeHyperlink(null,null,!0,i);t.clearRangeData(i,["value","value2","type","formatStr","decimalPlaces","thousandSeparator","comment","hyperlink","format"],null,!0);t.model.allowCellFormatting&&t.XLFormat.removeStyle(i,{cellStyle:!0,tableStyle:!0,format:!0,skipHiddenRow:!0});t.XLEdit.updateCellWithContainer(u,i,null,!0);t._dupDetails=!1},_swapSortedDatas:function(t){var h,c,i,f=0,l=[],e=[],o=[],a=t.model.currentViewData,y=a.length,p=this.XLObj._generateColCount(t.columnName)-1,v,r=t.range,s=r[3]-r[1]+1,w=p-r[1],u=this.XLObj.getRangeData({range:r,property:["value","value2","type","formatStr","formats","decimalPlaces","thousandSeparator","range","format","comment","hyperlink","rule"],skipHiddenRow:!0});for(n.extend(!0,l,u),e.push(l);f<y;){for(h=a[f][t.columnName],i=w,v=u.length;i<v;){if(u[i].value===h){c=this._getMinIdx(i,s);o=o.concat(u.splice(c,s));break}i+=s}f++}return e.push(o),e},_getMinIdx:function(n,t){var i,r;if(i=r=t,n<t)return 0;while(i<=n){if(r+=t,r>n)return i;i+=t}}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.dragAndDrop=function(n){this.XLObj=n;this._isDragAndDropStart=!1;this._dragAndDropCell={rowIndex:0,colIndex:0};this._isDragAndDropped=!1;this._allowDragAndDrop=!1;this._target=null;this._cellIdx={}};t.spreadsheetFeatures.dragAndDrop.prototype={moveRangeTo:function(n,t){this._moveRangeTo(n,t)},_moveRangeTo:function(i,r,u){var f=this.XLObj,d,o;if(f.model.allowDragAndDrop&&!f.model.isReadOnly){var s,c,v,p,h,l,y,a,w,e,g,b=[],k=[],nt=[];for(s=f.getActiveSheetIndex(),c=f.getSheet(s),i=f.swapRange(f._toIntrnlRange(i,s)),r=f.swapRange(f._toIntrnlRange(r,s)),r[2]=r[0]+(i[2]-i[0]),r[3]=r[1]+(i[3]-i[1]),h={rowIndex:r[0],colIndex:r[1]},l={rowIndex:r[2],colIndex:r[3]},v=f.getRangeData({range:i,property:u||["value","value2","type","formatStr","decimalPlaces","thousandSeparator","range","format","border","borders","comment","hyperlink","picture","cFormatRule","rule","chart","isLocked","wrap","formats","tformats","tborders","isFilterHeader","filterState","isFilterVisible","tableName"]}),f.model.allowCellFormatting&&(p=f.XLFormat.getHashCodeClassAsArray(i)),f.model.allowConditionalFormats&&(a=f.XLEdit.getPropertyValue(i[0],i[1],"cFormatRule")),!f.isUndefined(a)&&a.length>0&&(e=a[0].split("_"),a={action:e[0],inputs:[e[2],e[3]],color:e[4],range:e[5]}),o=i[0];o<=i[2];o++)b.push({rowIndex:o,height:c.rowsHeightCollection[o]});if(details={sheetIndex:s,reqType:"reorder-cells",sourceData:n.extend(!0,[],v),sourceRange:i,destinationRange:r,sourceFormat:p,destinationFormat:f.model.allowCellFormatting&&f.XLFormat.getHashCodeClassAsArray(r),destinationData:f.getRangeData({range:r}),sourceCFormat:a,sourceHeight:b},f.model.allowFiltering&&(y=f.XLFilter._checkFilteredCells(s)),f._dupDetails=!0,f.model.allowComments&&f.XLComment.deleteComment(),isTable=f._checkTableRange(f._getAlphaRange(s,i[0],i[1],i[2],i[3])),isTable.status==="full")details.tblObj=isTable.tableObj,details.tblObj.tblId=isTable.tblId,details.tblObj.header=!0,f.XLFormat.removeTable(isTable.tblId),f.XLFormat.removeStyle(isTable.range);else if(isTable.status==="partial"){f.performSelection(i);return}for(y&&y.isApplied?f.XLFilter._moveFilteredCells(s,y):(f.clearRangeData(i,u||["value2","value","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","isFilterHeader","filterState","isFilterVisible","tableName","rule","wrap","comment"]),f.clearRangeData(r,u||["value2","value","type","formatStr","decimalPlaces","thousandSeparator","hyperlink","rule","wrap","comment"]),t.isNullOrUndefined(f._ddlCell)||(f.element.find("#"+f._id+"ddl").ejDropDownList("hidePopup"),f.element.find("#"+f._id+"ddlspan").remove(),f._ddlCell=null),f.model.allowCellFormatting&&!f.XLRibbon._isDirtySelect&&(f.XLFormat.removeStyle(i),f.XLFormat.removeStyle(r,{cellStyle:!0,format:!0,border:!0})),f.model.allowConditionalFormats&&f.XLCFormat.clearCF(i,!0),v[0].cFormatRule=[],details.tblObj&&(details.tblObj.destrange=f._getAlphaRange(s,r[0],r[1],r[2],r[3]),f.XLClipboard._isCut=!0,f.XLFormat.createTable(details.tblObj,details.tblObj.destrange),f.XLClipboard._isCut=!1),f.updateData(v,r),details.tblObj&&details.tblObj.totalRow&&f.XLFormat._updateTotalRow(s,details.tblObj.tblId,details.tblObj.fnNumber,r,!1),f.model.allowCellFormatting&&f.XLFormat.updateFormat(p,r),f.model.allowConditionalFormats&&!f.isUndefined(e)&&(g=f._getAlphaRange(1,r[0],r[1],r[2],r[3]),w={action:e[0],inputs:[e[2],e[3]],color:e[4],range:g},details.destinationCFormat=w,f.XLCFormat.setCFRule(w))),d=0,o=r[0];o<=r[2];o++)nt.push({rowIndex:o,height:c.rowsHeightCollection[o]}),k.push({rowIndex:f._getRowIdx(o),height:b[d].height}),d++;f.setHeightToRows(k);details.destHeight=k;details.prevDestRowHt=nt;f.setActiveCell(h.rowIndex,h.colIndex);f.model.allowSelection&&(h.rowIndex||l.rowIndex!==c.rowCount-1?h.colIndex||l.colIndex!==c.colCount-1?f.XLSelection.selectRange(h,l):f.XLSelection.selectRows(h.rowIndex,l.rowIndex):f.XLSelection.selectColumns(h.colIndex,l.colIndex),c._isFreezed&&f.XLFreeze._refreshSelection());f._dupDetails=!1;f._isUndoRedo||!f.XLFormat||f.XLFormat._isFAT||f._completeAction(details)}},_dMouseHover:function(n){var r,e,o,s,h,i,l,u,f,a=n.target,t=this.XLObj,v=t.getActiveSheetIndex(),c=t.getSheet(v).selectedRange;if(t._hasClass(a,"e-rowcell")&&(r=t._getCellIdx(a)),r&&t.inRange(c,r.rowIndex,r.colIndex)&&(r.rowIndex===c[0]||r.rowIndex===c[2]||r.colIndex===c[1]||r.colIndex===c[3])&&!t._isTouchEvt&&(i=n.target.getBoundingClientRect(),l=t._setXY(n),u=l[0],f=l[1],e=u-t.getFocusLeftElem().offset().left,e=e>=0&&e<=5,o=f-t.getFocusTopElem()[0].getBoundingClientRect().top,o=o>=0&&o<=5,s=t.getFocusRightElem().offset().left-u,s=s>=0&&s<=5,h=t.getFocusBottomElem()[0].getBoundingClientRect().top-f,h=h>=0&&h<=5,e&&u<=i.left+5&&u>=i.left||o&&f<=i.top+5&&f>=i.top||s&&u>=i.right-5&&u<=i.right||h&&f>=i.bottom-5&&f<=i.bottom)){t.addClass(a,"e-cursormove");this._isDragAndDropStart=!0;return}this._isDragAndDropStart&&!t._isTouchEvt&&(t._getContent(v).find(".e-cursormove").removeClass("e-cursormove"),this._isDragAndDropStart=!1)},_dragtouch:function(n,t){var r,u,f,e,i=this.XLObj;r=n-i.getFocusLeftElem().offset().left;u=t-i.getFocusTopElem().offset().top;f=i.getFocusRightElem().offset().left-n;e=i.getFocusBottomElem().offset().top-t;this._isDragAndDropStart=r>=-10&&r<=10||u>=-5&&u<=0||f>=-10&&f<=10||e>=-5&&e<=0?!0:!1},_dMouseDown:function(n){var t=this.XLObj,r,u,i;t.model.isReadOnly||(u=t.getActiveSheetIndex(),i=t.getSheet(u),n.preventDefault(),n.stopImmediatePropagation(),r=t.swapRange([i._startCell.rowIndex,i._startCell.colIndex,i._endCell.rowIndex,i._endCell.colIndex]),n.target.nodeName==="TD"&&(this._dragAndDropCell=t._getCellIdx(n.target)),t._dStartCell={rowIndex:r[0],colIndex:r[1]},t._dEndCell={rowIndex:r[2],colIndex:r[3]},t._trigger("dragStart",{sheetIndex:u,target:n.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:i._startCell,endCell:i._endCell}}))||(this._allowDragAndDrop=!0)},_dMouseMove:function(n){if(this._allowDragAndDrop){var i=this.XLObj,e=i.getActiveSheetIndex(),t=i.getSheet(e),u=n.target,r=i._getCellIdx(u),f;if(i._isTouchEvt&&(f=i._getOriginalEvt(n),u=document.elementFromPoint(f.clientX,f.clientY),u.parentNode&&u.parentNode.attributes.getNamedItem("idx")&&(r=i._getCellIdx(u))),i._trigger("drag",{sheetIndex:e,target:u,currentCell:r,dragAndDropRange:{startCell:t._startCell,endCell:t._endCell}}))return;i._isFrozen(t.frozenRows)&&this._isDragAndDropped&&t._frozenRows-1<t._ftopRowIdx&&t._startCell.rowIndex>t._frozenRows-1&&r.rowIndex<t._frozenRows-1&&(r.rowIndex=t._ftopRowIdx);i._isFrozen(t.frozenColumns)&&this._isDragAndDropped&&t._frozenColumns-1<t._fleftColIdx&&t._startCell.colIndex>t._frozenColumns-1&&r.colIndex<t._frozenColumns-1&&(r.colIndex=t._fleftColIdx);this._cellIdx=r;i.XLSelection._focusBorder(t._startCell,t._endCell,i._thinBorder);this._updateDCells(r);t._isFreezed?this._refreshFocusRange():i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder)}else this.XLObj._isTouchEvt||this._dMouseHover(n)},_refreshFocusRange:function(){var t=this.XLObj,n=t.getSheet(),u=t._dEndCell.colIndex,f=t._dEndCell.rowIndex,i=t._dStartCell.colIndex,r=t._dStartCell.rowIndex;n._frozenRows-1<n._ftopRowIdx&&(n._startCell.rowIndex<n._frozenRows-1?f>=n._frozenRows-1&&(f<n._ftopRowIdx?f=n._frozenRows-2:f>n._ftopRowIdx&&r<n._ftopRowIdx&&(r=n._ftopRowIdx)):r=r<n._ftopRowIdx&&r>n._frozenRows-1?n._ftopRowIdx:t._dStartCell.rowIndex);n._frozenColumns-1<n._fleftColIdx&&(n._startCell.colIndex<n._frozenColumns-1?u>=n._frozenColumns-1&&(u<n._fleftColIdx?u=n._frozenColumns-2:u>n._fleftColIdx&&i<n._fleftColIdx&&(i=n._fleftColIdx)):i=i<n._fleftColIdx&&i>n._frozenColumns-1?n._fleftColIdx:t._dStartCell.colIndex);t.XLSelection._focusRange({rowIndex:r,colIndex:i},{rowIndex:f,colIndex:u},t._autofillBorder)},_dMouseUp:function(t){var f,s;if(this._isDragAndDropped){var i=this.XLObj,o=!0,u=i.getActiveSheetIndex(),r=i.getSheet(u),h=n("#vscrollBar").data("ejScrollBar"),c=n("#hscrollBar").data("ejScrollBar"),l=!1,e=[i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex],a={rowIndex:-1,colIndex:-1},v={sheetIndex:u,preventAlert:!1,target:t.target,currentCell:this._dragAndDropCell,dragAndDropRange:{startCell:r._startCell,endCell:r._endCell}},y=i._arrayAsString(i._thinBorder);if(i.model.scrollSettings.allowScrolling&&i._dEndCell.rowIndex>r.rowCount){for(f=0,s=i._dEndCell.rowIndex-i._dStartCell.rowIndex;f<s;f++)i.XLScroll._createNewRow(u,-1,-1,"insert");h._scrollData.step=1;h.scroll(r._scrollTop+(i._dEndCell.rowIndex-i._dStartCell.rowIndex)*r.rowHeight)}if(i._dEndCell.colIndex>r.colCount){for(f=0,s=i._dEndCell.colIndex-i._dStartCell.colIndex;f<s;f++)i.XLScroll._createNewColumn(u,a,a,"insert");c._scrollData.step=1;c.scroll(r._scrollLeft+(i._dEndCell.colIndex-i._dStartCell.colIndex)*r.columnWidth)}if(this._target=t.target,i._isUniqueRange(r.selectedRange,i.swapRange(e)))this._preventDrop(r);else{if(i.model.allowLockCell&&r.isSheetProtected&&i._isPropExists([e,r.selectedRange],"isLocked",u)&&(o=!1),o&&i._isPropExists([e,r.selectedRange],"isReadOnly",u)&&(o=!1),!o){this._preventDrop(r);i.XLSelection._clearBorder(y);this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1;return}l=i._trigger("beforeDrop",v);v.preventAlert||l||!i._rangeHasData(e)?i._rangeHasData(e)?this._preventDrop(r):(this.moveRangeTo([r._startCell.rowIndex,r._startCell.colIndex,r._endCell.rowIndex,r._endCell.colIndex],[i._dStartCell.rowIndex,i._dStartCell.colIndex,i._dEndCell.rowIndex,i._dEndCell.colIndex]),r._startCell=i._dStartCell,r._endCell=i._dEndCell,r._isFreezed&&i.XLFreeze._refreshSelection()):i._showAlertDlg("","DropAlert","Drop",498)}i.XLSelection._clearBorder(y);i.model.allowAutoFill&&i.XLDragFill.positionAutoFillElement()}this._allowDragAndDrop=this._isDragAndDropStart=this._isDragAndDropped=!1},_scrollHover:function(t){var u,f,s,i=this.XLObj,h=i.getActiveSheetIndex(),r=i.getSheet(h),c=this._cellIdx.colIndex,l=this._cellIdx.rowIndex,a=i.XLScroll,e=a._vScroller(h),o=a._hScroller(h);n(t.target).parents(".e-vscrollbar").length>0?f=setInterval(function(){u=r._scrollLeft+(i._isFrozen(r.frozenColumns)?r.columnsWidthCollection[r._fleftColIdx]:r.columnWidth);o._scrollData.step=1;o.scroll(u);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:l,colIndex:r._rightCol.idx-1});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-rowheader")>-1?f=setInterval(function(){u=r._scrollLeft-r.columnWidth;o._scrollData.step=-1;u>-1?o.scroll(u):o.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:l,colIndex:r._leftCol.idx});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):n(t.target).parents(".e-spreadsheetfooter").length>0||t.target.className.indexOf("e-spreadsheetfooter")>-1||n(t.target).parents(".e-hscrollbar").length>0?f=setInterval(function(){i.model.scrollSettings.allowVirtualScrolling?r._isVirtualEndReached?e.scroll(r._scrollTop):e.scroll(r._scrollTop+(i._isFrozen(r.frozenRows)?r.rowsHeightCollection[r._ftopRowIdx]:r.rowHeight)):(e._scrollData.step=1,e.scroll(r._scrollTop+(i._isFrozen(r.frozenRows)?r.rowsHeightCollection[r._ftopRowIdx]:r.rowHeight)));i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._bottomRow.idx-1,colIndex:c});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-headercell")>-1?f=setInterval(function(){u=r._scrollTop-r.rowHeight;e._scrollData.step=-1;u>-1?e.scroll(u):e.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._topRow.idx,colIndex:c});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);return},200):t.target.className.indexOf("e-rowcell")>-1&&(s=i._getCellIdx(t.target),i._isFrozen(r.frozenRows)&&s.rowIndex<r._frozenRows-1&&r._startCell.rowIndex>=r._frozenRows-1&&(f=setInterval(function(){if(i._dStartCell.rowIndex>r._ftopRowIdx||!i.XLDragDrop._isDragAndDropped||r._frozenRows-1===r._ftopRowIdx){(i._dStartCell.colIndex>r._fleftColIdx||!i.XLDragDrop._isDragAndDropped||r._frozenColumns-1===r._fleftColIdx)&&clearInterval(f);return}u=r._scrollTop-r.rowHeight;e._scrollData.step=-1;u>-1?e.scroll(u):e.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:r._ftopRowIdx,colIndex:i.XLDragDrop._cellIdx.colIndex});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);i.XLDragDrop._refreshFocusRange();return},200)),i._isFrozen(r.frozenColumns)&&s.colIndex<r._frozenColumns-1&&r._startCell.colIndex>=r._frozenColumns-1&&(f=setInterval(function(){if(i._dStartCell.colIndex>r._fleftColIdx||!i.XLDragDrop._isDragAndDropped||r._frozenColumns-1===r._fleftColIdx){(i._dStartCell.rowIndex>r._ftopRowIdx||!i.XLDragDrop._isDragAndDropped||r._frozenRows-1===r._ftopRowIdx)&&clearInterval(f);return}u=r._scrollLeft-r.columnWidth;o._scrollData.step=-1;u>-1?o.scroll(u):o.scroll(0);i.XLSelection._focusBorder(r._startCell,r._endCell,i._thinBorder);i.XLDragDrop._updateDCells({rowIndex:i.XLDragDrop._cellIdx.rowIndex,colIndex:r._fleftColIdx});i.XLSelection._focusRange(i._dStartCell,i._dEndCell,i._autofillBorder);i.XLDragDrop._refreshFocusRange();return},200)));i._browserDetails.name==="msie"&&i._browserDetails.version==="8.0"?(t.target.attachEvent("onmouseleave",function(){clearInterval(f);return}),document.attachEvent("onmouseleave",function(){clearInterval(f);return}),t.target.attachEvent("onmouseup",function(){clearInterval(f);return})):(t.target.addEventListener("mouseleave",function(){clearInterval(f);return}),document.addEventListener("mouseleave",function(){clearInterval(f);return}),t.target.addEventListener("mouseup",function(){clearInterval(f);i.XLDragDrop._dMouseUp(t);return}))},_preventDrop:function(n){var t=this.XLObj;t.XLSelection._focusRange(n._startCell,n._endCell,t._selectionBorder);t._dStartCell=n._startCell;t._dEndCell=n._endCell},_updateDCells:function(n){var t=this.XLObj,u=t.getActiveSheetIndex(),i=t.getSheet(u),r=t.isRange(i.selectedRange);i._isColSelected&&t.inRange(i.selectedRange,0,i._startCell.colIndex)||(n.rowIndex<this._dragAndDropCell.rowIndex&&t._dStartCell.rowIndex?(t._dStartCell.rowIndex=t._dStartCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex-(this._dragAndDropCell.rowIndex-n.rowIndex):t._dStartCell.rowIndex):n.rowIndex>this._dragAndDropCell.rowIndex&&(t._dStartCell.rowIndex=t._dStartCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex),t._dEndCell.rowIndex=r?t._dEndCell.rowIndex+(n.rowIndex-this._dragAndDropCell.rowIndex):t._dStartCell.rowIndex));i._isRowSelected&&t.inRange(i.selectedRange,i._startCell.rowIndex,0)||(n.colIndex<this._dragAndDropCell.colIndex&&t._dStartCell.colIndex?(t._dStartCell.colIndex=t._dStartCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex-(this._dragAndDropCell.colIndex-n.colIndex):t._dStartCell.colIndex):n.colIndex>this._dragAndDropCell.colIndex&&(t._dStartCell.colIndex=t._dStartCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex),t._dEndCell.colIndex=r?t._dEndCell.colIndex+(n.colIndex-this._dragAndDropCell.colIndex):t._dStartCell.colIndex));this._dragAndDropCell=n;this._isDragAndDropped=!0}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.exporting=function(n){this.XLObj=n};t.spreadsheetFeatures.exporting.prototype={"export":function(i){var r=this.XLObj,u,y,s,f,e,h,c,l,p,a,o,v;if(r.model.exportSettings.allowExporting&&!r.model.isReadOnly)if(r._isExport=!0,this._renderAll(),r._isExport=!1,u=r.model.exportSettings,h=i===t.Spreadsheet.exportType.Excel?u.excelUrl:i===t.Spreadsheet.exportType.Csv?u.csvUrl:u.pdfUrl,c=this.getExportProps(),o={exportType:i,url:h,customParams:{}},l=t.raiseWebFormsServerEvents?i.toLowerCase()+"Exporting":"",t.raiseWebFormsServerEvents&&r.model.serverEvents&&r.model.serverEvents.indexOf(l)>-1){if(p={model:n.extend(!0,{},r.model),originalEventType:l},a={sheetModel:c.model,sheetData:c.data,password:u.password?r._encrypt(u.password):""},r._trigger("onExport",o))return;r.getObjectLength(o.customParams)&&n.extend(a,o.customParams);t.raiseWebFormsServerEvents(l,p,a);setTimeout(function(){t.isOnWebForms=!0},1e3)}else{if(t.isNullOrUndefined(h)){r._showAlertDlg("Alert","ImportExportUrl","",266);return}if(!u.allowExporting||r.isUndefined(h))return;if(r._trigger("onExport",o))return;h=o.url;y={action:h,method:"post"};s=t.buildTag("form","",null,y);f={name:"sheetData",type:"hidden",value:c.data};e=t.buildTag("input","",null,f);s.append(e);f={name:"sheetModel",type:"hidden",value:c.model};e=t.buildTag("input","",null,f);s.append(e);f={name:"Password",type:"hidden",value:r._encrypt(u.password)};e=t.buildTag("input","",null,f);s.append(e);for(v in o.customParams)f={name:v,type:"hidden",value:o.customParams[v]},e=t.buildTag("input","",null,f),s.append(e);n("body").append(s);s.submit()}},_dropElements:function(n){var r=n.sheets,f=["_spreadSheetPager","dataSource","rangeSettings"],u,t,i;n.undoCollection=[];for(u in r){i=r[u];for(t in i)f.indexOf(t)>-1&&(i[t]=null)}return n},_getRequriedProp:function(n){for(var f=this.XLObj,r={},u,i=["sheetCount","activeSheetIndex","nameManager"],s,o,h,t=0,e=i.length;t<e;t++)r[i[t]]=n[i[t]];f.model.allowCellFormatting&&f.getObjectLength(f.XLFormat._customFontFamily)>0&&(r.customFontFamily=f.XLFormat._customFontFamily);o=n.sheets;r.sheets=[];i=["_activeCell","_endCell","_startCell","colCount","columnsWidthCollection","rowsHeightCollection","rowCount","frozenColumns","frozenRows","usedRange","dataAttribute","filterSettings","tableManager","sheetInfo","hideColsCollection","hideRowsCollection","showGridlines","showHeadings","isSheetProtected","shapeMngr","chart","pivotMngr","topLeftCell","paneTopLeftCell"];for(t in o)for(r.sheets[t]={},h=r.sheets[t],s=o[t],u=0,e=i.length;u<e;u++)h[i[u]]=s[i[u]];return r},getExportProps:function(){var s=this.XLObj,r,e,u,l,y,a,v,o,p=n.extend(!0,{},s._dataContainer),i={},h=[],t,f={},c;for(s._refreshHashCode(p.hashCode),i=JSON.parse(JSON.stringify(s.model)),r=1;r<i.sheets.length;r++){for(f={},pivot={},n.extend(!0,f,i.sheets[r].shapeMngr.chart),h=s.getObjectKeys(f),i.sheets[r].shapeMngr.chart={},e=0,l=h.length;e<l;e++)if(t=f[h[e]].id,a=n("#"+t).data("ejChart"),a){for(a.model.event=null,v=JSON.parse(JSON.stringify(a.model)),o=v.series,u=0,y=o.length;u<y;u++)delete o[u].dataSource,delete o[u].query,o[u].fill=jQuery.type(o[u].fill)=="array"?o[u].fill[0].color:o[u].fill;i.sheets[r].shapeMngr.chart[t]=v;c=f[t].range;i.sheets[r].shapeMngr.chart[t].range=s._generateHeaderText(c[1]+1)+(c[0]+1)+":"+s._generateHeaderText(c[3]+1)+(c[2]+1);i.sheets[r].shapeMngr.chart[t].top=f[t].top;i.sheets[r].shapeMngr.chart[t].left=f[t].left;i.sheets[r].shapeMngr.chart[t].height=f[t].height;i.sheets[r].shapeMngr.chart[t].width=f[t].width}for(h=s.getObjectKeys(i.sheets[r].pivotMngr.pivot),e=0,l=h.length;e<l;e++)t=h[e],pivotObj=n("#"+t).data("ejPivotGrid"),pivotObj&&(i.sheets[r].pivotMngr.pivot[t].rows=pivotObj.getOlapReport().rows,i.sheets[r].pivotMngr.pivot[t].columns=pivotObj.getOlapReport().columns,i.sheets[r].pivotMngr.pivot[t].filters=pivotObj.getOlapReport().filters,i.sheets[r].pivotMngr.pivot[t].values=pivotObj.getOlapReport().values)}return i.sheets.shift(),{model:JSON.stringify(this._getRequriedProp(i)),data:JSON.stringify(p)}},_renderAll:function(){for(var r,i,u,n=this.XLObj,f=n.getSheets(),e=n.getActiveSheetIndex(),t=1;t<f.length;t++)if(i=f[t],n.model.importSettings.allowSheetOnDemand&&i._isImported&&!i._isRequested&&n._importSheet(t,!1),i._isLoaded||n.gotoPage(t),n.model.scrollSettings.allowVirtualScrolling&&!i._isImported&&i._hasDataSrc)for(r=1;r<=i._virtualBlockCnt;r++)i._virtualDataLoadedBlks.indexOf(r)===-1&&(i._virtualDataLoadedBlks.push(r),u=this._getRange(r,t),n._refreshDataSrc(u,t),n._refreshCellData(u,t));n.hideWaitingPopUp();n.gotoPage(e)},_getRange:function(n,t){var u=this.XLObj,i=u.getSheet(t),r=[0,0,0,i.colCount-1];return r[0]=i._virtualBlockRowCnt*(n-1),r[2]=i._virtualBlockRowCnt*n-1,r}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.findnreplace=function(n){this.XLObj=n;this._findCount=0;this.caseSen={"true":function(n){return n.toString()},"false":function(n){return n.toString().toLowerCase()}};this.isEMatch={"true":function(n,t){return n==t},"false":function(n,t){if(!n.length||t.length)return n.indexOf(t)>-1}}};t.spreadsheetFeatures.findnreplace.prototype={replaceAllBySheet:function(n,t,i,r){this.XLObj.model.allowSearching&&this.XLObj.model.allowEditing&&!this.XLObj.model.isReadOnly&&this._replaceAllData(n,t,i,r,"value","sheet")},replaceAllByBook:function(n,t,i,r){this.XLObj.model.allowSearching&&this.XLObj.model.allowEditing&&!this.XLObj.model.isReadOnly&&this._replaceAllData(n,t,i,r,"value","workbook")},findNext:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.XLObj.getActiveSheetIndex());this._findNext(n,r,i.isCSen,i.isEMatch,i.type,i.mode,i.searchBy)},findPrevious:function(n,i,r){t.isNullOrUndefined(r)&&(r=this.XLObj.getActiveSheetIndex());this._findPrev(n,r,i.isCSen,i.isEMatch,i.type,i.mode,i.searchBy)},_findNext:function(n,t,i,r,u,f,e){var o,s,y,ct,tt,w,b,a,p,ot,it,rt,v,k,d,ut,ft,g=[],c=e==="rows",h=this.XLObj,st=!1,nt=t?t:h.getActiveSheetIndex(),ht=h.getSheet(nt),et=ht._activeCell,l={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findNext"};if(!h._intrnlReq&&h._trigActionBegin(l))return!0;if(h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell(),n=l.value,t=l.sheetIndex,i=l.isCaseSensitive,r=l.isEntireMatch,u=l.findType,f=l.mode,e=l.searchBy,w=ht._selectedCells,ot=w.length,p=ht.usedRange,ot===1||f==="workbook"?g=[et.rowIndex,et.colIndex,p.rowIndex+1,p.colIndex+1]:(st=!0,b=w[ot-1],g=[et.rowIndex,et.colIndex,b.rowIndex+1,b.colIndex+1]),a=g[0],v=g[1],k=g[2],d=g[3],c||(tt=a,a=v,v=tt,tt=k,k=d,d=tt),f==="sheet"){for(o=a;o<k;o++)for(o!==a&&(b=w[0],v=st?c?b.colIndex:b.rowIndex:0),s=v;s<d;s++)if(ut=this._compareValues(c?o:s,c?s:o,nt,n,i,r,u),ut&&!(o===a&&s===v))return(this._updateSelection(c?o:s,c?s:o),this._findCount++,l={reqType:"findNext",activeCell:h.getActiveCellElem()},h._trigActionComplete(l))?void 0:!0}else for(y=nt,ct=h.model.sheetCount;y<=ct;y++)for(p=h.model.sheets[y].usedRange,y!==nt&&(v=0,a=0,k=c?p.rowIndex:p.colIndex,d=c?p.colIndex:p.rowIndex),o=a;o<k+1;o++)for(o!==a&&(v=0),s=v;s<d+1;s++)if(ut=this._compareValues(c?o:s,c?s:o,y,n,i,r,u),ut&&!(y===nt&&o===a&&s===v))return(this._updateSelection(c?o:s,c?s:o,y),this._findCount++,h._intrnlReq=!1,l={reqType:"findNext",activeCell:h.getActiveCellElem()},h._trigActionComplete(l))?void 0:!0;return this._findCount?!1:(it=0,rt=0,ft=f==="sheet"?nt:1,st&&(b=w[0],rt=w[0].rowIndex,it=w[0].colIndex),this._updateSelection(rt,it,ft),this._findCount++,this._compareValues(rt,it,ft,n,i,r,u)?!0:(h._intrnlReq=!0,this._findNext(n,ft,i,r,u,f,e)))},_findPrev:function(n,t,i,r,u,f,e){var o,s,p,it,k,a,nt,rt,ut,ft,v,y,tt,w,st=!1,d=[],ct=0,lt=0,c=e==="rows",et,h=this.XLObj,g=t?t:h.getActiveSheetIndex(),ht=h.getSheet(g),b=ht.usedRange,ot=ht._activeCell,l={sheetIndex:t,value:n,isCaseSensitive:i,isEntireMatch:r,searchBy:e,mode:f,findType:u,reqType:"findPrevious"};if(h._trigActionBegin(l))return!0;if(h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell(),n=l.value,t=l.sheetIndex,i=l.isCaseSensitive,r=l.isEntireMatch,u=l.findType,f=l.mode,e=l.searchBy,nt=ht._selectedCells,rt=nt.length,rt===1||f==="workbook"?d=[ot.rowIndex,ot.colIndex,b.rowIndex+1,b.colIndex+1]:(a=nt[rt-1],d=[ot.rowIndex,ot.colIndex,a.rowIndex,a.colIndex],st=!0),v=d[0],y=d[1],tt=d[2],w=d[3],c||(et=v,v=y,y=et,et=tt,tt=w,w=et),f==="sheet"){for(st&&(a=nt[0],ct=c?a.rowIndex:a.colIndex,lt=c?a.colIndex:a.rowIndex),o=v;o>=ct;o--)for(o!==v&&(y=w),s=y;s>=lt;s--)if(it=this._compareValues(c?o:s,c?s:o,g,n,i,r,u),it&&!(o===v&&s===y))return(this._updateSelection(c?o:s,c?s:o),this._findCount++,l={reqType:"findPrevious",activeCell:h.getActiveCellElem()},h._trigActionComplete(l))?void 0:!0}else for(p=g;p>=1;p--)for(b=h.model.sheets[p].usedRange,p!==g&&(tt=c?b.rowIndex:b.colIndex,w=c?b.colIndex:b.rowIndex,y=w,v=tt),o=v;o>=0;o--)for(o!==v&&(y=w+1),s=y;s>=0;s--)if(it=this._compareValues(c?o:s,c?s:o,p,n,i,r,u),it&&!(p===g&&o===v&&s===y))return(this._updateSelection(c?o:s,c?s:o,p),this._findCount++,l={reqType:"findPrevious",activeCell:h.getActiveCellElem()},h._trigActionComplete(l))?void 0:!0;return this._findCount?!1:(k=f==="sheet"?g:h.model.sheetCount,ft=h.model.sheets[k].usedRange.rowIndex,ut=h.model.sheets[k].usedRange.colIndex,st&&(a=nt[rt-1],ft=a.rowIndex,ut=a.colIndex),this._updateSelection(ft,ut,k),this._findCount++,this._compareValues(ft,ut,k,n,i,r,u)?!0:this._findPrev(n,k,i,r,u,f,e))},_compareValues:function(n,t,i,r,u,f,e){var s=this.XLObj,o=s.XLEdit.getPropertyValue(n,t,null,i)?s.XLEdit.getPropertyValue(n,t,null,i).toString():"",h=s.isFormula(o)||e==="formula"&&o==="=";return o=e==="value"?o&&!h?this.caseSen[u](o):"":e==="formula"?h?this.caseSen[u](o):"":s.XLEdit.getPropertyValue(n,t,"comment",i)?this.caseSen[u](s.XLEdit.getPropertyValue(n,t,"comment",i).value):"",r=this.caseSen[u](r),this.isEMatch[f](o,r)},_replace:function(n,t,i,r,u){var f=this.XLObj,o=f.getActiveSheetIndex();if(f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,"isLocked",o))return!1;var e=f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t)?f.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,null,t).toString():"",s=new RegExp(i.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"ig"),h=e!==""&&i!==""?u?e.replace(i,r):e.replace(s,r):r;t===o||f.gotoPage(t);f.XLEdit._updateCellValue(n,h)},_replaceData:function(n,t,i,r,u,f,e,o,s){var v,y,h=this.XLObj,c=i?i:h.model.activeSheetIndex,p=h.getSheet(c),l=p._activeCell.rowIndex,a=p._activeCell.colIndex,w;if(!h.model.allowEditing)return!1;if(h.model.allowLockCell&&h.XLEdit.getPropertyValue(l,a,"isLocked",c)){h._popUplockCellAlert();return}h.model.allowEditing&&h.XLEdit._isEdit&&h.XLEdit.saveCell();this._compareValues(l,a,c,n,r,u,f)?(y=f==="formula"?"value":"value2",v={sheetIndex:c,reqType:"find-replace",operation:"replace",rowIndex:l,colIndex:a,sIndex:i},v.prevData={value:h.XLEdit.getPropertyValue(l,a,y)},this._replace({rowIndex:l,colIndex:a},i,n,t,r),v.newData={value:h.XLEdit.getPropertyValue(l,a,y)},this._findCount=0,w=e==="up"?this._findPrev(n,c,r,u,f,o,s):this._findNext(n,c,r,u,f,o,s),w||this._updateSelection(l,a,c),h._isUndoRedo||h._completeAction(v)):h._showAlertDlg("Alert","ReplaceNotFound","")},_replaceAllData:function(t,i,r,u,f,e){var d,a,l,g=[],it=0,rt=!1,nt,o=this.XLObj,ut=o.model.sheetCount,v=o.model.activeSheetIndex,w=o.getSheet(v),y=w.usedRange,ft=w._activeCell.rowIndex,et=w._activeCell.colIndex,s,h,c,b,k,tt=0,p;if(d={sheetIndex:v,reqType:"find-replace",operation:"replaceAll",isCSen:r,isEMatch:u},a=f==="formula"?"value":"value2",!o.model.allowEditing)return!1;if(o._dupDetails=!0,o.model.allowEditing&&o.XLEdit._isEdit&&o.XLEdit.saveCell(),e==="sheet")if(o.model.allowLockCell&&w.isSheetProtected)rt=!0;else for(s=0,b=y.rowIndex+1;s<b;s++)for(h=0,k=y.colIndex+1;h<k;h++)this._compareValues(s,h,v,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a)},sheetIndex:v},this._replace({rowIndex:s,colIndex:h},v,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l));else for(c=1;c<=ut;c++){if(nt=o.model.sheets[c],o.model.allowLockCell&&nt.isSheetProtected){it++;continue}for(y=nt.usedRange,s=0,b=y.rowIndex+1;s<b;s++)for(h=0,k=y.colIndex+1;h<k;h++)this._compareValues(s,h,c,t,r,u,f)&&(l={rowIndex:s,colIndex:h,prevData:{value:o.XLEdit.getPropertyValue(s,h,a,c)},sheetIndex:c},this._replace({rowIndex:s,colIndex:h},c,t,i,r),tt++,l.newData={value:o.XLEdit.getPropertyValue(s,h,a)},g.push(l))}if(rt||it===ut){o._popUplockCellAlert();return}o._dupDetails=!1;d.selectedCell=g;this._updateSelection(ft,et);o._isUndoRedo||o._completeAction(d);o.hideWaitingPopUp();p=o._getLocStr("ReplaceData").split("/");p="T-"+p[0]+tt+" "+p[1];n("#"+o._id+"_FRDialog").ejDialog("close");o._showAlertDlg("Alert",p,"",325)},_updateSelection:function(n,t,i){var u={rowIndex:n,colIndex:t},r=this.XLObj,f=r.getActiveSheetIndex(),e=r.getSheet(f);i||(i=f);i&&i!==f&&r.gotoPage(i,!1);r.getSheetElement(f).find(".e-selected:visible").length<2||!r.inRange(e.selectedRange,n,t)?(r.setActiveCell(u.rowIndex,u.colIndex,i),r.XLSelection.selectRange(u,u),e._startCell=u,e._endCell=u):r.XLCellNav._updateActiveCell(n,t);r.model.scrollSettings.allowScrolling&&r.XLScroll._scrollSelectedPosition(i,r.getActiveCell(i));r.model.allowAutoFill&&r.XLDragFill.positionAutoFillElement()},_getSelRangeDetails:function(n){var t=n[n.length-1].rowIndex-n[0].rowIndex,i=n[n.length-1].colIndex-n[0].colIndex,r=n[0].rowIndex,u=n[0].colIndex;return[t,i,r,u]},goTo:function(t){var i=this.XLObj;if(!i.model.isReadOnly){t.startsWith("=")&&(t=t.split("=")[1]);var h,u,c=i.getActiveSheetIndex(),f=i.getSheet(c),r,e,o=i._getDollarAlphaRange(f.selectedRange),s=i.XLRibbon._getAddrFromDollarAddr(t);t=s[1];s[0]&&i.gotoPage(s[0],!1);t=i.getRangeIndices(t);rangeCells=i._getSelectedRange({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]});r=rangeCells[0];e=rangeCells[rangeCells.length-1];i.setActiveCell(r.rowIndex,r.colIndex);i.model.allowSelection&&i.XLSelection.selectRange(r,e);i.XLScroll._scrollSelectedPosition(i.getActiveSheetIndex(),r);i.XLDragFill.positionAutoFillElement();f._startCell=r;f._endCell=e;i.setSheetFocus();h=n.grep(i.XLRibbon._addrList,function(n){return n.value===o});h.length<1&&(i.XLRibbon._addrList.push({value:o,text:o}),u=n("#"+i._id+"_GotoAddr").data("ejListBox"),i.XLRibbon._addrList=JSON.parse(JSON.stringify(i.XLRibbon._addrList)),u.model.dataSource=i.XLRibbon._addrList,u.option("fields",{dataSource:i.XLRibbon._addrList}))}},goToSpecial:function(n,t){this._applyGoToRule(n,t.isNumber,t.isText,t.isLogical,t.isError)},_applyGoToRule:function(n,t,i,r,u){var e=this.XLObj,o,f;e.showWaitingPopUp();switch(n){case"blanks":this._applyGotoBlanks();break;case"formulas":this._applyGotoFormulas(t,i,r,u);break;case"comments":this._applyGotoComments();break;case"datavalidation":this._applyGotoValidation();break;case"cformat":this._applyGotoCFormat();break;case"lastcell":o=e.getActiveSheetIndex();f=e.model.sheets[o].usedRange;e.XLSelection.selectRange({rowIndex:f.rowIndex,colIndex:f.colIndex},{rowIndex:f.rowIndex,colIndex:f.colIndex});this._updateSelection(f.rowIndex,f.colIndex,o);break;case"constants":this._applyGotoConstants(t,i,r,u);break;case"rowdiff":this._applyGotoRowDiff();break;case"coldiff":this._applyGotoColDiff()}e.hideWaitingPopUp()},_applyGotoBlanks:function(){var r,u,o,f=!1,s=[],t,n=this.XLObj,i=n.getActiveSheetIndex(),h=n.model.sheets[i].usedRange,c,l=h.rowIndex,a=h.colIndex,e=n.getSheet(i),v=e._selectedCells,y=0,p=0,w={sheetIndex:i,reqType:"find-replace",operation:"blanks"};for(e._goToCollection={multiple:!1,selected:[]},v.length>1&&(t=this._getSelRangeDetails(v),l=t[0],a=t[1],y=t[2],p=t[3],e._goToCollection.multiple=!0),r=0;r<=l;r++){for(u=0;u<=a;u++)rIdx=r+y,cIdx=u+p,c=n.XLEdit.getPropertyValue(rIdx,cIdx)?n.XLEdit.getPropertyValue(rIdx,cIdx).toString():"",n._isRowViewable(i,rIdx)&&(o=n.getCell(rIdx,cIdx,i),f=!0),c.length?f&&o.removeClass("e-selected"):(s.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&e._goToCollection.selected.push(rIdx+":"+cIdx),f&&o.addClass("e-selected"));f=!1}w.selectedCell=s;n._isUndoRedo||n._completeAction(w)},_applyGotoComments:function(){var u,f,s,e=!1,h=[],i,n=this.XLObj,r=n.getActiveSheetIndex(),c=n.getSheet(r).usedRange,l=!1,a,v=c.rowIndex,y=c.colIndex,o=n.getSheet(r),p=o._selectedCells,w=0,b=0,k={sheetIndex:r,reqType:"find-replace",operation:"comments"};for(o._goToCollection={multiple:!1,selected:[]},p.length>1&&(i=this._getSelRangeDetails(p),v=i[0],y=i[1],w=i[2],b=i[3],o._goToCollection.multiple=!0),u=0;u<=v;u++){for(f=0;f<=y;f++)rIdx=u+w,cIdx=f+b,a=n.XLEdit.getPropertyValue(rIdx,cIdx,"comment"),n._isRowViewable(r,rIdx)&&(s=n.getCell(rIdx,cIdx,r),e=!0),t.isNullOrUndefined(a)?e&&s.removeClass("e-selected"):(h.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&o._goToCollection.selected.push(rIdx+":"+cIdx),e&&(s.addClass("e-selected"),l=!0));e=!1}l||n._showAlertDlg("Alert","NoCellFound","",200);k.selectedCell=h;n._isUndoRedo||n._completeAction(k)},_applyGotoFormulas:function(i,r,u,f){var v,c,w,s,h,y=!1,k=[],l,o=this.XLObj,a=o.getActiveSheetIndex(),d=!1,g,e,nt,tt=o.model.sheets[a].usedRange,it=tt.rowIndex,rt=tt.colIndex,p=o.getSheet(a),ut=p._selectedCells,ft=0,b=0,et={sheetIndex:a,reqType:"find-replace",operation:"formulas"};for(p._goToCollection={multiple:!1,selected:[]},ut.length>1&&(l=this._getSelRangeDetails(ut),it=l[0],rt=l[1],ft=l[2],b=l[3],p._goToCollection.multiple=!0),v=0;v<=it;v++){for(c=0;c<=rt;c++)s=v+ft,h=c+b,g=t.isNullOrUndefined(o.XLEdit.getPropertyValue(s,h))?"":o.XLEdit.getPropertyValue(s,c+b).toString(),e=t.isNullOrUndefined(o.XLEdit.getPropertyValue(s,h,"value2"))?"":o.XLEdit.getPropertyValue(s,h,"value2").toString(),nt=g.charAt(0)==="="&&typeof e=="string",o._isRowViewable(a,s)&&(w=o.getCell(s,h,a),y=!0),nt&&(i&&n.isNumeric(e)||r&&!(e.toLowerCase()==="true"||e.toLowerCase()==="false")&&!n.isNumeric(e)&&!(e.length!==0&&e.indexOf("#")===0&&e.lastIndexOf("?")===e.length-1&&e.length>0)||u&&(e.toLowerCase()==="true"||e.toLowerCase()==="false")||f&&e.length!==0&&o._calcEngine.getErrorStrings().indexOf(e)>-1)?(k.push({rowIndex:s,colIndex:h,isApply:!0}),o.model.scrollSettings.allowVirtualScrolling&&p._goToCollection.selected.push(s+":"+h),y&&(w.addClass("e-selected"),d=!0)):y&&w.removeClass("e-selected");y=!1}d||o._showAlertDlg("Alert","NoCellFound","",200);et.selectedCell=k;o._isUndoRedo||o._completeAction(et)},_applyGotoValidation:function(){var e,o,c,i,r,s=!1,l=[],u,n=this.XLObj,f=n.getActiveSheetIndex(),a=!1,v=n.model.sheets[f].usedRange,y,p=v.rowIndex,w=v.colIndex,h=n.getSheet(f),b=h._selectedCells,k=0,d=0,g={sheetIndex:f,reqType:"find-replace",operation:"validations"};for(h._goToCollection={multiple:!1,selected:[]},b.length>1&&(u=this._getSelRangeDetails(b),p=u[0],w=u[1],k=u[2],d=u[3],h._goToCollection.multiple=!0),e=0;e<=p;e++){for(o=0;o<=w;o++)i=e+k,r=o+d,y=n.XLEdit.getPropertyValue(i,r,"rule"),n._isRowViewable(f,i)&&(c=n.getCell(i,r,f),s=!0),t.isNullOrUndefined(y)?s&&c.removeClass("e-selected"):(l.push({rowIndex:i,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&h._goToCollection.selected.push(i+":"+r),s&&(c.addClass("e-selected"),a=!0));s=!1}a||n._showAlertDlg("Alert","NoCellFound","",200);g.selectedCell=l;n._isUndoRedo||n._completeAction(g)},_applyGotoCFormat:function(){var e,o,c,i,r,s=!1,a=[],u,n=this.XLObj,f=n.getActiveSheetIndex(),v=!1,y=n.model.sheets[f].usedRange,l,p=y.rowIndex,w=y.colIndex,h=n.getSheet(f),b=h._selectedCells,k=0,d=0,g={sheetIndex:f,reqType:"find-replace",operation:"conditions"};for(h._goToCollection={multiple:!1,selected:[]},b.length>1&&(u=this._getSelRangeDetails(b),p=u[0],w=u[1],k=u[2],d=u[3],h._goToCollection.multiple=!0),e=0;e<=p;e++){for(o=0;o<=w;o++)i=e+k,r=o+d,l=n.XLEdit.getPropertyValue(i,r,"cFormatRule"),n._isRowViewable(f,i)&&(c=n.getCell(i,r,f),s=!0),!t.isNullOrUndefined(l)&&l.length?(a.push({rowIndex:i,colIndex:r,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&h._goToCollection.selected.push(i+":"+r),s&&(c.addClass("e-selected"),v=!0)):s&&c.removeClass("e-selected");s=!1}v||n._showAlertDlg("Alert","NoCellFound","",200);g.selectedCell=a;n._isUndoRedo||n._completeAction(g)},_applyGotoConstants:function(i,r,u,f){var l,a,b,o,h,v=!1,ft=[],k,c,e=this.XLObj,y=e.getActiveSheetIndex(),d=!1,s,p,g=e.model.sheets[y].usedRange,nt=g.rowIndex,tt=g.colIndex,w=e.getSheet(y),it=w._selectedCells,rt=0,ut=0;for(w._goToCollection={multiple:!1,selected:[]},it.length>1&&(c=this._getSelRangeDetails(it),nt=c[0],tt=c[1],rt=c[2],ut=c[3],w._goToCollection.multiple=!0),l=0;l<=nt;l++){for(a=0;a<=tt;a++)o=l+rt,h=a+ut,s=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,h))?"":e.XLEdit.getPropertyValue(o,h).toString(),p=t.isNullOrUndefined(e.XLEdit.getPropertyValue(o,h,"value2"))?"":e.XLEdit.getPropertyValue(o,h,"value2").toString(),k=s.charAt(0)==="="&&typeof p=="string",e._isRowViewable(y,o)&&(b=e.getCell(o,h,y),v=!0),!k&&(i&&n.isNumeric(s)||r&&!(s.toLowerCase()==="true"||s.toLowerCase()==="false")&&!n.isNumeric(s)&&s.length>0||u&&(s.toLowerCase()==="true"||s.toLowerCase()==="false")||f&&p.length!==0&&p.indexOf("#")===0)?(ft.push({rowIndex:o,colIndex:h,isApply:!0}),e.model.scrollSettings.allowVirtualScrolling&&w._goToCollection.selected.push(o+":"+h),v&&(b.addClass("e-selected"),d=!0)):v&&b.removeClass("e-selected");v=!1}d||e._showAlertDlg("Alert","NoCellFound","",200)},_applyGotoColDiff:function(){var f,e,c,t,i,o=!1,l=[],r,n=this.XLObj,u=n.getActiveSheetIndex(),a=!1,v=n.model.sheets[u].usedRange,y,p=v.rowIndex,w=v.colIndex,s=n.getSheet(u),b=s._selectedCells,h=0,k=0,d={sheetIndex:u,reqType:"find-replace",operation:"coldiff"},g;if(s._goToCollection={multiple:!1,selected:[]},b.length>1)for(r=this._getSelRangeDetails(b),p=r[0],w=r[1],h=r[2],k=r[3],s._goToCollection.multiple=!0,f=0;f<=w;f++){for(t=f+k,g=n.XLEdit.getPropertyValue(h,t)?n.XLEdit.getPropertyValue(h,t).toString():"",e=0;e<=p;e++)i=e+h,y=n.XLEdit.getPropertyValue(i,t)?n.XLEdit.getPropertyValue(i,t).toString():"",n._isRowViewable(u,i)&&(c=n.getCell(i,t,u),o=!0),y===g?o&&c.removeClass("e-selected"):(l.push({rowIndex:i,colIndex:t,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&s._goToCollection.selected.push(i+":"+t),o&&(c.addClass("e-selected"),a=!0));o=!1}a||n._showAlertDlg("Alert","NoCellFound","",200);d.selectedCell=l;n._isUndoRedo||n._completeAction(d)},_applyGotoRowDiff:function(){var r,u,s,f=!1,h=[],t,n=this.XLObj,i=n.getActiveSheetIndex(),c=!1,l=n.model.sheets[i].usedRange,a,v=l.rowIndex,y=l.colIndex,e=n.getSheet(i),p=e._selectedCells,w=0,o=0,b,k={sheetIndex:i,reqType:"find-replace",operation:"rowdiff"};if(e._goToCollection={multiple:!1,selected:[]},p.length>1)for(t=this._getSelRangeDetails(p),v=t[0],y=t[1],w=t[2],o=t[3],e._goToCollection.multiple=!0,r=0;r<=v;r++){for(rIdx=r+w,b=n.XLEdit.getPropertyValue(rIdx,o)?n.XLEdit.getPropertyValue(rIdx,o).toString():"",u=0;u<=y;u++)cIdx=u+o,a=n.XLEdit.getPropertyValue(rIdx,cIdx)?n.XLEdit.getPropertyValue(rIdx,cIdx).toString():"",n._isRowViewable(i,rIdx)&&(s=n.getCell(rIdx,cIdx,i),f=!0),a===b?f&&s.removeClass("e-selected"):(h.push({rowIndex:rIdx,colIndex:cIdx,isApply:!0}),n.model.scrollSettings.allowVirtualScrolling&&e._goToCollection.selected.push(rIdx+":"+cIdx),f&&(s.addClass("e-selected"),c=!0));f=!1}c||n._showAlertDlg("Alert","NoCellFound","",200);k.selectedCell=h;n._isUndoRedo||n._completeAction(k)}}}(jQuery,Syncfusion);$.fn.setInputPos=function(n,t){return t||(t=n),$(this).is(":visible")?this.each(function(){if(this.setSelectionRange)this.focus(),this.setSelectionRange(n,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0);i.moveEnd("character",t);i.moveStart("character",n);i.select()}}):void 0},function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.formatCellDialog=function(n){this.XLObj=n;this._categories=[{value:"General",text:n._getLocStr("LGeneral")},{value:"Number",text:n._getLocStr("NumberTab")},{value:"Currency",text:n._getLocStr("LCurrency")},{value:"Accounting",text:n._getLocStr("LAccounting")},{value:"Date",text:n._getLocStr("LDate")},{value:"Time",text:n._getLocStr("LTime")},{value:"Percentage",text:n._getLocStr("LPercentage")},{value:"Fraction",text:n._getLocStr("LFraction")},{value:"Scientific",text:n._getLocStr("LScientific")},{value:"Text",text:n._getLocStr("LText")},{value:"Custom",text:n._getLocStr("LCustom")}];this._selValue="General"};t.spreadsheetFeatures.formatCellDialog.prototype={_renderCellFrmtDlg:function(){var i=this.XLObj,g=i._id,r=g+"_formatdlg",h,u,s,c,p,w,l,b,a,v,k,f,e,d,y=0,o;f=i._dlgHeight>440&&!i._phoneMode?440:i._dlgHeight<380?i._responsiveHeight-2:i._dlgHeight;k=i._dlgWidth>617?510:i._dlgWidth<430?i._responsiveWidth-2:i._dlgWidth;f=i._isMaterial?i._dlgHeight+150:i._dlgHeight;h=t.buildTag("div#"+r);u=t.buildTag("div#"+r+"_formattab");s=t.buildTag("div.e-dlg-fields e-dlgctndiv");c=t.buildTag("ul .e-ul");p=t.buildTag("a",i._getLocStr("NumberTab"),{},{href:"#"+r+"_number"});w=t.buildTag("li",p);c.append(w);u.append(c);s.append(u);l=t.buildTag("div.e-dlg-btnfields");b=t.buildTag("div.e-dlg-btnctnr");a=t.buildTag("input#"+r+"_okbtn");v=t.buildTag("input#"+r+"_cantn");a.ejButton({text:i._getLocStr("Ok"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFOk,this)});v.ejButton({text:i._getLocStr("Cancel"),showRoundedCorner:!0,width:60,click:t.proxy(this._dlgCFCancel,this)});l.append(b.append(a,v));s.append(t.buildTag("div#"+r+"_format_dataMnger","",{display:"none"}));i.element.append(h.append(s,l));h.ejDialog({enableModal:!0,showOnInit:!1,enableResize:!1,allowKeyboardNavigation:!1,title:i._getLocStr("Formatcells"),width:k,height:f,cssClass:"e-ss-dialog e-ss-mattab e-ss-fcdlg e-"+i._id+"-dlg",open:function(){n("#"+i._id+"_formatdlg_okbtn").focus()}});o=n("#"+i._id+"_formatdlg_okbtn").outerHeight(!0)+11;o<40&&(o+=4);e=f-(46+o);i._isMaterial&&(e=f-(89+o));u.ejTab({width:"100%",height:e,cssClass:"e-ss-dlgtab",allowKeyboardNavigation:!1});i._phoneMode&&(y=3);u.find(".e-content").height(e-(i._isMaterial?66+y:41+y));d=e-44;this._renderNumberTab(d)},_renderNumberTab:function(i){var u=this.XLObj,r=u._id+"_fdlg_nTab",ft=this._categories,d,g,nt,c,a,tt,l,s,o,e,f,v,y,p,w,b,k,it,rt,ut,h;d=[{text:"Wednesday, March 14, 2012",value:"{0:dddd, MMMM dd, yyyy}"},{text:"3/14/2012",value:"{0:M/d/yyyy}"},{text:"March 03",value:"{0:MMMM dd}"},{text:"2012 March",value:"{0:yyyy MMMM}"},{text:"3/14/12 1:30 PM",value:"{0:dd/MM/yyyy h:mm tt}"}];g=[{text:"0",type:"default"},{text:"0.00",type:"default"},{text:"#,##0",type:"default"},{text:"#,##00.00",type:"default"},{text:"0%",type:"default"},{text:"0.00%",type:"default"},{text:"MM/dd/yyyy",type:"default"},{text:"d-MMM",type:"default"},{text:"h:mm",type:"default"},{text:"mm:ss",type:"default"}];nt=[{text:"1:30:55 PM",value:"{0:h:mm:ss tt}"},{text:"1:30 PM",value:"{0:h:mm tt}"},{text:"13:30:55",value:"{0:h:mm:ss}"},{text:"1:30",value:"{0:hh:mm}"}];c=t.buildTag("table#"+r+"_table","",{},{cellspacing:"0",cellpadding:"0"});a=t.buildTag("tr");l=t.buildTag("td","",{width:"25%","padding-right":16});c.append(a.append(l));l=t.buildTag("td","",{"vertical-align":"top","padding-bottom":0});$table1=t.buildTag("table","",{"white-space":"normal"},{cellspacing:"0",cellpadding:"0"});$tr1=t.buildTag("tr");$td1=t.buildTag("td","",{"vertical-align":"top","padding-bottom":0});s=t.buildTag("input#"+r+"_sinput.ejinputtext","",{},{disabled:"disabled"});tt=t.buildTag("label.e-dlg-fields",u._getLocStr("FormatSample"));ut=t.buildTag("div#div"+r,"",{height:i-(40+(u._isMaterial?140:64))});$table1.append($tr1.append(tt,s));$tr1=t.buildTag("tr");v=t.buildTag("td","",{"vertical-align":"top","padding-top":9});$tr1.append(v);a.append(l.append($table1.append($tr1)));o=t.buildTag("table","",{"white-space":"normal"});e=t.buildTag("tr#"+r+"_decimal.e-fdlg-num-options");f=t.buildTag("td",t.buildTag("label.e-dlg-fields",u._getLocStr("DecimalPlacesTxt"),{"padding-right":7,"padding-top":5}),"",{width:"103px"});e.append(f);f=t.buildTag("td");s=t.buildTag("input#"+r+"_decimalplace","");v.append(ut.append(o.append(e.append(f.append(s)))));e=t.buildTag("tr#"+r+"_tseparator.e-fdlg-num-options");f=t.buildTag("td","","",{colspan:"2"});$chkelem=t.buildTag("input#"+r+"_kseptr");o.append(e.append(f.append($chkelem)));e=t.buildTag("tr#"+r+"_dtypes.e-fdlg-num-options");f=t.buildTag("td",t.buildTag("label.e-dlg-fields",u._getLocStr("Type")));y=t.buildTag("ul#"+r+"_datetypes");o.append(e.append(f.append(y)));e=t.buildTag("tr#"+r+"_ttypes.e-fdlg-num-options");f=t.buildTag("td",t.buildTag("label.e-dlg-fields",u._getLocStr("Type")));p=t.buildTag("ul#"+r+"_timetypes");o.append(e.append(f.append(p)));e=t.buildTag("tr#"+r+"_custom.e-fdlg-num-options");f=t.buildTag("td",t.buildTag("label.e-dlg-fields",u._getLocStr("Type")));w=t.buildTag("input#"+r+"_custominput.ejinputtext");b=t.buildTag("ul#"+r+"_customtypes");k=t.buildTag("button#"+r+"_delBtn",u._getLocStr("Delete"),{},{type:"button"});it=t.buildTag("div",k,{"text-align":"right","padding-top":3});o.append(e.append(f.append(w,b,it)));u._on(w,"keydown",this._validateCustomFormat);rt=t.buildTag("div#"+r+"_typeinfo.e-ss-fcgdiv","",{});n("#"+u._id+"_formatdlg_number").append(c,rt);o.find(".e-fdlg-num-options").hide();i=this._createNumList(ft,c);s.ejNumericTextbox({name:"numeric",value:2,height:27,width:"100%",minValue:0,maxValue:30,change:n.proxy(this._refreshFrmtPropChanges,this)});$chkelem.ejCheckBox({change:n.proxy(this._refreshFrmtPropChanges,this)});$chkelem.parent().append(t.buildTag("label.e-dlg-fields",u._getLocStr("ThousandSeparatorTxt"),{"margin-left":6}));h=i-130;y.ejListBox({selectedItemIndex:"0",dataSource:d,fields:{text:"text",value:"value"},width:"100%",height:u._isMaterial?"100":h>150?"155":h.toString(),selected:n.proxy(this._refreshFrmtPropChanges,this)});p.ejListBox({selectedItemIndex:"0",dataSource:nt,fields:{text:"text",value:"value"},width:"100%",height:u._isMaterial?"100":h>150?"155":h.toString(),selected:n.proxy(this._refreshFrmtPropChanges,this)});b.ejListBox({selectedItemIndex:"0",dataSource:g,fields:{text:"text",value:"value"},width:"100%",height:(i-((u._phoneMode?45:10)+50+110+(u._isMaterial?70:0))).toString(),selected:n.proxy(this._refreshFrmtPropChanges,this)});k.ejButton({showRoundedCorner:!0,width:60,click:n.proxy(this._customFormatDelete,this)})},_initFormatCellDlg:function(){var t=this.XLObj;if(!t.model.allowCellFormatting)return!1;this._refreshFormatDlg();n("#"+t._id+"_formatdlg").ejDialog("open");this._updateFormtdata();n("#"+t._id+"_formatdlg_format_dataMnger").removeData()},_updateFormtdata:function(){var i=this.XLObj,s=i.getActiveCell(),r=n("#"+i._id+"_fdlg_nTab_list").data("ejListBox"),w=n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),a=n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox"),v=n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox"),b=n("#"+i._id+"_fdlg_nTab_input").data("ejDropDownList"),u=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),t,y,p,f,e,o,h,c,l;r&&r._refreshScroller();t=i.getRangeData({range:[s.rowIndex,s.colIndex,s.rowIndex,s.colIndex]})[0];y="decimalPlaces"in t?t.decimalPlaces:2;p="thousandSeparator"in t?t.thousandSeparator:!1;f="type"in t?t.type.indexOf("date")>-1?"date":t.type:"general";"formatStr"in t?(e=a.getIndexByValue(t.formatStr),o=v.getIndexByValue(t.formatStr),i.isUndefined(e)&&i.isUndefined(o)&&["date"].indexOf(f)>-1&&(h=u.model.dataSource,c=t.formatStr.replace(/^\{0\:|\}$/g,""),i._isValueAlreadyExist(h,"text",c)||(h.push({text:c,type:"custom"}),u._setModel({dataSource:h})),l=u.getIndexByText(c),f="custom")):e=o=0;r&&r.selectItemByValue(n.camelCase("-"+f));a.selectItemByIndex(e>-1?e:0);v.selectItemByIndex(o>-1?o:0);u.selectItemByIndex(l>-1?l:0);f==="string"&&(r.selectItemByIndex(10),u.selectItemByText(t.formatStr));w.option("value",y);n("#"+i._id+"_fdlg_nTab_kseptr").ejCheckBox({checked:p});this._onNumFormatSelect({value:r?r.model.value:b.model.value})},_onNumFormatSelect:function(t){var i=this.XLObj,r="#"+i._id+"_fdlg_nTab_",f=n("#"+i._id+"_fdlg_nTab_typeinfo"),u;n("#"+i._id+"_formatdlg_number").find(".e-fdlg-num-options").hide();value=t.value;switch(value){case"Number":i.model.formatSettings.allowDecimalPlaces&&n(r+"decimal, "+r+"tseparator").show();break;case"Currency":case"Accounting":case"Percentage":case"Scientific":n(r+"decimal").show();break;case"Date":n(r+"dtypes").show();n("#"+i._id+"_fdlg_nTab_datetypes").data("ejListBox")._refreshScroller();break;case"Time":n(r+"ttypes").show();n("#"+i._id+"_fdlg_nTab_timetypes").data("ejListBox")._refreshScroller();break;case"Custom":n(r+"custom").show();n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox")._refreshScroller()}u=this._getFormattedText(value);n("#"+i._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox").option("maxValue",value==="Scientific"?20:30);n("#"+i._id+"_fdlg_nTab_sinput").val(u);f.text(i._getLocStr(value));this._selValue=value},_getFormattedText:function(i){var f,o,r,e=0,u=this.XLObj,c=u.getActiveCell(),v=n("#"+u._id+"_fdlg_nTab_decimalplace").data("ejNumericTextbox"),y=n("#"+u._id+"_fdlg_nTab_datetypes").data("ejListBox"),l={Number:"0:N",Currency:"0:C",Accounting:"0:C",Percentage:"0:P",Scientific:"0:N"},p=n("#"+u._id+"_fdlg_nTab_timetypes").data("ejListBox"),h=t.Spreadsheet.CellType,a=t.Spreadsheet.CellFormat,s=n("#"+u._id+"_fdlg_nTab_customtypes").data("ejListBox");u.model.formatSettings.allowDecimalPlaces&&(e=v.getValue());r=u.XLEdit.getPropertyValue(c.rowIndex,c.colIndex)||"";o=n("#"+u._id+"_fdlg_nTab_kseptr").ejCheckBox("checked");switch(i){case"Number":case"Currency":case"Accounting":case"Percentage":f="{"+l[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:h[i],decimalPlaces:e}));break;case"Date":f=y.getSelectedItems()[0].value;i=f===a.longdate?"longdate":f===a.shortdate?"shortdate":"date";r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:i}));break;case"Time":f=p.getSelectedItems()[0].value;r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,type:h[i]}));e=0;break;case"Scientific":f="{"+l[i]+e+"}";u._isDateTime(r)&&(r=u._dateToInt(r));r=u.XLFormat._format(r,u.XLFormat._getFormatObj({formatStr:f,thousandSeparator:o,type:h[i],decimalPlaces:e}));break;case"Fraction":u._isDateTime(r)&&(r=u._dateToInt(r));r=u.toFraction(r);r&&(r=t.isNullOrUndefined(r.numerator)?r.integer:r.integer+" "+r.numerator+"/"+r.denominator);break;case"General":case"Text":u._isDateTime(r)&&(r=u._dateToInt(r));break;case"Custom":cValue=s.getSelectedItems()[0].text;formatObj=u.XLFormat.customFormatParser(cValue);n("#"+u._id+"_fdlg_nTab_custominput").val(cValue);r=u.XLFormat._format(r,formatObj);s.getSelectedItems()[0].index>-1&&n("#"+u._id+"_fdlg_nTab_delBtn").data("ejButton")._setModel({enabled:s.model.dataSource[s.getSelectedItems()[0].index].type==="custom"})}return n("#"+u._id+"_formatdlg_format_dataMnger").data("NumFormat",i==="Custom"?formatObj:{type:i.toLowerCase(),decimalPlaces:e,thousandSeparator:o,formatStr:f}),r},_refreshFrmtPropChanges:function(){var i=this.XLObj,t;t=this._getFormattedText(this._selValue);n("#"+i._id+"_fdlg_nTab_sinput").val(t)},_dlgCFCancel:function(){var t=this.XLObj;n("#"+t._id+"_formatdlg").ejDialog("close");t.model.showRibbon&&t.XLRibbon._updateRibbonIcons();t.setSheetFocus()},_dlgCFOk:function(t){var i=this.XLObj,r=n("#"+i._id+"_formatdlg_format_dataMnger").data();t&&this._selValue==="Custom"&&this._validateCustomFormat()||(i.getObjectLength(r.NumFormat)&&i.XLFormat.format(r.NumFormat),i.model.showRibbon&&i.XLRibbon._updateRibbonIcons(),n("#"+i._id+"_formatdlg").ejDialog("close"),i.setSheetFocus())},_customFormatDelete:function(){var t=n("#"+this.XLObj._id+"_fdlg_nTab_customtypes").data("ejListBox"),i=t.model.dataSource;i.splice(t.model.selectedItemIndex,1);t._setModel({dataSource:i});t.selectItemByIndex(0);this._refreshFrmtPropChanges()},_validateCustomFormat:function(t){var i=t?this:this.XLObj,u,r,f,e=n("#"+i._id+"_fdlg_nTab_custominput").val(),o=i.XLFormat.customFormatParser(e);if(!t||t.keyCode===13)if(i.getObjectLength(o))u=n("#"+i._id+"_fdlg_nTab_customtypes").data("ejListBox"),r=u.model.dataSource,i._isValueAlreadyExist(r,"text",e)||(r.push({text:e,type:"custom"}),u._setModel({dataSource:r})),n("#"+i._id+"_formatdlg_format_dataMnger").data("NumFormat",o),t&&i.XLCellFrmtDlg._dlgCFOk();else return f=n("#"+i._id+"_alertdlg"),i._renderAlertDlgContent(f,"Alert",i._getLocStr("CustomFormatAlert")),f.ejDialog("open"),!0},_refreshFormatDlg:function(){var t=this.XLObj,f=n.extend(!0,[],this._categories);if(t._isFDlgChanged){t._isFDlgChanged=!1;var i,s,h=0,e,u=t._id+"_fdlg_nTab",c=t._id+"_formatdlg",l=n("#"+c+"_formattab"),r,o=n("#"+t._id+"_formatdlg_okbtn").outerHeight(!0)+11;i=t._dlgHeight>440&&!t._phoneMode?440:t._dlgHeight<380?t._responsiveHeight-2:t._dlgHeight;s=t._dlgWidth>617?510:t._dlgWidth<430?t._responsiveWidth-2:t._dlgWidth;o<40&&(o+=4);dlgContHt=i-(46+o);e=dlgContHt-44;r=e-160;n("#"+u+"_datetypes").ejListBox("option",{height:r>150?"155":r.toString()});n("#"+u+"_timetypes").ejListBox("option",{height:r>120?"125":r.toString()});n("#"+u+"_customtypes").ejListBox("option",{height:(r-(t._phoneMode?45:10)).toString()});n("#div"+u).height(e-(40+(t._isMaterial?134:64)));i<365?f.splice(10,1):f=this._categories;l.height(dlgContHt);t._phoneMode&&(h=3);l.find(".e-content:eq(0)").height(dlgContHt-(41+h));this._createNumList(f,n("#"+u+"_table"));n("#"+c).ejDialog("option",{height:i,width:s});n("#"+t._id+"_formatdlg_wrapper").find(".e-dialog-scroller").height(i-36);n("#"+t._id+"_formatdlg").height(i-50)}},_createNumList:function(i,r){var e=this.XLObj,u=e._id+"_fdlg_nTab",h,c,o,f,s=n("#"+e._id+"_formatdlg_number").height();return e._phoneMode?(c=r.find("td:eq(0)").hide(),document.getElementById(u+"_clabel")&&(f=n("#"+u+"_list"),f.ejListBox("destroy"),n("#"+u+"_clabel").remove(),f.remove()),document.getElementById(u+"_input")||(o=t.buildTag("input#"+u+"_input"),n("#"+e._id+"_formatdlg_number").prepend(o),o.ejDropDownList({dataSource:i,width:"100%",fields:{id:"value",text:"text",value:"text"},select:n.proxy(this._onNumFormatSelect,this),selectedItemIndex:0}))):(document.getElementById(u+"_input")&&(o=n("#"+u+"_input"),o.ejDropDownList("destroy"),o.remove()),document.getElementById(u+"_clabel")?(f=n("#"+u+"_list"),f.ejListBox("option",{height:(s-((e._isMaterial?30:40)+25)).toString()})):(h=t.buildTag("label#"+u+"_clabel.e-dlg-fields",e._getLocStr("Category"),{"padding-bottom":7}),f=t.buildTag("ul#"+u+"_list"),r.find("td:eq(0)").show().append(h,f),f.ejListBox({selectedItemIndex:"0",width:"120",height:(s-(e._isMaterial?120:65)).toString(),dataSource:i,fields:{text:"text",value:"value"},select:n.proxy(this._onNumFormatSelect,this),allowMultiSelection:!1}))),s}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.shape=function(n){this.XLObj=n;this._imgX=0;this._imgY=0;this._imgOffsetleft=0;this._imgOffsetTop=0;this._shapeType="img";this._shapeROStart=!1;this._shapeRSStart=!1;this._imgRSWStart=!1;this._imgRSEStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1;this._changePicture=!1;this._picCellIdx={};this._insertShape=!1};t.spreadsheetFeatures.shape.prototype={_insertPicture:function(n){var i=this.XLObj,u=i._browserDetails.name==="msie"&&parseInt(i._browserDetails.version)<10?n.responseText:n.xhr.response,f,e,s,h,o,l;if(u.startsWith("Invalid"))i._showAlertDlg("Alert","ImageValAlert");else if(f=i.getActiveSheetIndex(),e=i.getSheet(f),this._changePicture)this.changePicture(null,u);else{var r=i.getActiveCell(),c=i.model.pictureSettings,a=c.height,v=c.width;t.isNullOrUndefined(r)&&(o=i.element.find(".e-ss-activeimg").get(0),l=this._getCellIndexFromOffset(o.offsetTop,o.offsetLeft));s=e._colWidthCollection[r.colIndex];h=e._rowHeightCollection[r.rowIndex];this._insertShape=!0;this._createPicture(f,r,u,h,s,v,a)}},changePicture:function(t,i){var f=this.XLObj,o=f.getActiveSheetIndex(),a=f.getSheet(o),r,h,c,l,u,e,s;r=t?n("#"+t).get(0):f.getSheetElement(o).find(".e-ss-activeimg").get(0);h=r.offsetLeft;c=r.offsetTop;l=this._getCellIndexFromOffset(c,h);u=a.shapeMngr;n(r).css("background-image","url('"+i+"')");e=u.picture[r.id];s={sheetIndex:o,reqType:"shape",shapeType:"picture",action:"changepicture",id:n(r).attr("id"),cell:l,prev:{img:u.sharedPics[e.data],data:e.data,pcIdx:r.id},cur:{img:i,pcIdx:r.id}};u.sharedPics.indexOf(i)===-1&&u.sharedPics.push(i);e.data=u.sharedPics.indexOf(i);s.cur.data=e.data;this._changePicture=!1;f.setSheetFocus();f._completeAction(s)},setPicture:function(n,t,i,r,u,f){var e=this.XLObj,o,s,h,c,l;if(e.model.pictureSettings.allowPictures&&!e.model.isReadOnly)return(n=e._getRangeArgs(n,"object"),o=n[0],s=n[1],e.model.allowLockCell&&e._isCellProtected(o,s,!1))?void 0:(h=e.getActiveSheetIndex(),l=e.model.pictureSettings,r=r?r:l.height,i=i?i:l.width,e._isRowViewable(h,o)?(c=e.getCell(o,s)[0],u=u?u:c.offsetTop,f=f?f:c.offsetLeft):(u=u?u:0,f=f?f:0),this._createPicture(h,{rowIndex:o,colIndex:s},t,u,f,i,r))},resetPicture:function(i,r){var f=this.XLObj,u,s,e,o;u=i?n("#"+i):f.element.find(".e-ss-activeimg");s=new RegExp("\\be-shapebdr.*?\\b","g");e={sheetIndex:f.getActiveSheetIndex(),reqType:"shape",shapeType:"picture",action:"resetpicture",id:n(u).attr("id"),actionType:r};f._dupDetails=!0;t.isNullOrUndefined(u[0].className.match(s))||(o=f.XLShape._getImgStyleFromHashCode(u[0].className.match(s)[0]));e.prev=o?{bcolor:o["border-color"],bstyle:o["border-style"],bwidth:o["border-width"]}:{};u[0].className=u[0].className.replace(s,"");e.cur={bcolor:u.css("border-color"),bstyle:u.css("border-style"),bwidth:u.css("border-width")};r!="resetpicture"&&(e.prev.width=u.css("width"),e.prev.height=u.css("height"),u.css({width:f.model.pictureSettings.width,height:f.model.pictureSettings.height}),e.cur.width=u.css("width"),e.cur.height=u.css("height"),f.XLShape._updateShapeObj(u[0]),f._hasClass(u[0],"e-ss-activeimg")&&f.XLRibbon._formatTabUpdate());f._dupDetails=!1;f._completeAction(e)},_createPicture:function(n,i,r,u,f,e,o,s,h,c,l,a){var b,k,d;h=h?h:"transparent";c=c?c:"solid";l=l?l:"1px";var v=this.XLObj,w=v.getSheet(n),y={sheetIndex:n,targetCell:i,top:u,left:f,width:e,height:o,bcolor:h,bstyle:c,bwidth:l,reqType:"picture",add:"add"},p;if(!v._trigActionBegin(y))return w._isImported||(this._insertShape=!0),u=y.top,f=y.left,e=y.width,o=y.height,s=t.isNullOrUndefined(s)?v.model.allowCharts&&v.XLChart._shapeCnt:s,v._isExport&&(a.cnt=s),p=v._id+"_picture"+s,i||(i=this._getCellIndexFromOffset(u,f,n)),k=i.rowIndex,d=i.colIndex,!v._isUndoRedo&&v.model.allowCharts&&v.XLChart._shapeCnt++,this._updateShapeMngr(i,{picture:{data:r,id:p,height:o,width:e,left:f,top:u,rowIndex:k,colIndex:d,borderWidth:l,borderColor:h,borderStyle:c}},"picture"),v._isExport||this._refreshPictureElement({top:u,left:f,width:e,height:o,bcolor:h,bstyle:c,bwidth:l,imgData:r,cnt:s,sheetIdx:n}),v.setSheetFocus(),w._isImported&&!w._isLoaded||v._isUndoRedo||v._isPaste||v.XLClipboard._isShape||v._isExport||(b={sheetIndex:n,reqType:"shape",shapeType:"picture",action:"remove",id:p,actCell:i,img:r,cnt:s},b.position={top:u,left:f,height:o,width:e},v._completeAction(b)),v.model.showRibbon&&v.XLRibbon._formatTabUpdate(),p},_refreshPictureElement:function(i){var r=this.XLObj,u,f,e;r._getJSSheetContent(i.sheetIdx).find(".e-spreadsheetcontentcontainer > .e-content").append(t.buildTag("div.e-ss-object","","",{id:r._id+"_picture"+i.cnt}));u=n("#"+r._id+"_picture"+i.cnt);u.data("parentID",r._id);u.css({"background-image":"url('"+i.imgData+"')",height:i.height,width:i.width,left:i.left,top:i.top});f=i.bwidth+" "+i.bstyle+" "+i.bcolor;e=this._getImgBorderHashCode({"border-color":i.bcolor,"border-style":i.bstyle,"border-width":i.bwidth});r.model.allowCellFormatting&&r.XLFormat._writeCssRules(e,r.XLFormat._getCssPropertyAsString({border:{left:f,right:f,top:f,bottom:f}}));u.addClass(e);this._selectImg(u)},_shapeMouseDown:function(t){var i,f;t.preventDefault();i=this.XLObj;f=document.activeElement.id;i._isTouchEvt&&this._imgMouseMove(t);(f.indexOf("PictureHeight")>-1||f.indexOf("PictureWidth")>-1)&&i.setSheetFocus();var u,s=t.target.id,r=n(t.target),h=r.get(0),e=h.offsetLeft,o=h.offsetTop,c=i._setXY(t);this._selectImg(r);this._picCellIdx=this._getCellIndexFromOffset(o,e);this._imgOffsetleft=e;this._imgOffsetTop=o;this._imgX=c[0];this._imgY=c[1];this._shapeType=s.indexOf("chart")>-1?"chart":"img";r.css("cursor")==="move"?this._shapeROStart=!0:(r.css("cursor")==="col-resize"||r.css("cursor")==="row-resize")&&(this._shapeRSStart=!0,i._getContent(i.getActiveSheetIndex()).find(".e-ss-imgvisual").css({left:e,top:o,height:r.height(),width:r.width()}));this._shapeType==="chart"&&(u=i.XLChart._getShapeObj(s,this._shapeType),i.getActiveSheetIndex()===u.dataSheetIdx&&i.XLChart._focusChartRange(u.xAxis.range,u.yAxis.range,u.legend.range));i.model.enableContextMenu&&i.XLCMenu._isMenuOpened&&i.XLCMenu.hideCMenu()},_imgKeyDown:function(n){var r=this.XLObj,s=r.getActiveSheetIndex(),t=r._getContent(s).find(".e-ss-activeimg"),i=t.get(0),e=i.offsetLeft,o=i.offsetTop,u,f,h;if(this._shapeType=t[0].id.indexOf("chart")>-1?"chart":"img",this._picCellIdx=this._getCellIndexFromOffset(o,e),n.shiftKey||n.ctrlKey)n.shiftKey&&!n.ctrlKey&&(n.keyCode===39||n.keyCode===38?(n.preventDefault(),u=t.height()+2,f=t.width()+2,u<400&&f<600&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()):(n.keyCode===37||n.keyCode===40)&&(n.preventDefault(),u=t.height()-2,f=t.width()-2,u>40&&f>60&&t.css({width:f,height:u}),this._updateShapeObj(i),r.XLRibbon._formatTabUpdate()));else{switch(n.keyCode){case 39:n.preventDefault();t.css({left:e+2});this._updateShapeObj(i);break;case 37:n.preventDefault();e>1&&t.css({left:e-2});this._updateShapeObj(i);break;case 38:n.preventDefault();o>1&&t.css({top:o-2});this._updateShapeObj(i);break;case 40:n.preventDefault();t.css({top:o+2});this._updateShapeObj(i)}this._onKeyscrollShape(s,t,n)}n.keyCode===46&&(n.preventDefault(),h=!1,r.XLClipboard._isShape&&(r.XLClipboard._isShape=!1,h=!0),this._deleteShape(s,t),h&&(r.XLClipboard._isShape=!0))},_shapeMouseUp:function(t){var r=this.XLObj,o={};if(!r._isExport){var c="chart",f,h=r.getActiveSheetIndex(),a=r._getContent(h),u=a.find(".e-ss-activeimg"),s=a.find(".e-ss-imgvisual"),l,e=n(t.target),i=e.get(0);if((e.hasClass("e-ss-picture")||e[0].id.indexOf(r._id+"_picture")>-1)&&r.model.showRibbon&&r.XLRibbon._formatTabUpdate(),i.id.indexOf(c)>-1&&i.id.indexOf("Ribbon")<0&&(i=i.id.indexOf("_svg")>-1?n(i).parents(".e-ss-object").get(0):i),u.length<1&&(this._shapeROStart=!1),i.className.indexOf("e-ss-imgvisual")>-1||i.className.indexOf("e-ss-object")>-1||(this._shapeROStart&&(i=u[0]),this._shapeRSStart&&(i=s[0])),this._shapeROStart)r._isTouchEvt&&(l=r._getOriginalEvt(t),i=document.elementFromPoint(l.clientX,l.clientY)),r._isUndoRedo||(parseInt(u.css("top"))!==i.offsetTop||parseInt(u.css("left"))!==i.offsetLeft)&&(f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"edit",actionType:"reorder",id:n(u).attr("id"),visualImg:s,trgt:e},f.prev={top:parseInt(u.css("top")),left:parseInt(u.css("left")),height:parseInt(u.css("height")),width:parseInt(u.css("width"))},f.cur={top:i.offsetTop,left:i.offsetLeft,height:e.height(),width:e.width()}),r._isUndoRedo||(parseInt(u.css("top"))!==i.offsetTop||parseInt(u.css("left"))!==i.offsetLeft)&&r._checkIndicesInContainer(h,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f.obj=n.extend(!0,{},r._dataContainer.sheets[h][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f)),u.css({left:i.offsetLeft,top:i.offsetTop}),this._updateShapeObj(i),s.removeClass("e-ss-picture").hide();else if(this._shapeRSStart&&(r._isUndoRedo||(r._isTouchEvt&&(i=s[0]),i.className.indexOf("e-ss-imgvisual")<0&&s.length>0&&this._shapeROStart&&(i=s[0]),e=n(i),(parseInt(u.css("height"))!==e.height()||parseInt(u.css("width"))!==e.width())&&r._checkIndicesInContainer(h,this._picCellIdx.rowIndex,this._picCellIdx.colIndex)&&(f={sheetIndex:h,reqType:"shape",shapeType:"chart",action:"edit",actionType:"resize",id:n(u).attr("id"),visualImg:s,trgt:e},f.prev={top:parseInt(u.css("top")),left:parseInt(u.css("left")),height:parseInt(u.css("height")),width:parseInt(u.css("width"))},f.cur={top:i.offsetTop,left:i.offsetLeft,height:e.height(),width:e.width()},f.obj=n.extend(!0,{},r._dataContainer.sheets[h][this._picCellIdx.rowIndex][this._picCellIdx.colIndex]),r._completeAction(f))),f&&u.css({left:i.offsetLeft,top:i.offsetTop,height:e.height(),width:e.width()}),this._updateShapeObj(i),s.removeClass("e-ss-picture").hide(),this._shapeType==="img"&&r.model.showRibbon&&r.XLRibbon._formatTabUpdate(),this._shapeType===c&&(r.XLChart.resizeChart(u.attr("id"),e.height(),e.width()),r.model.showRibbon&&r.XLRibbon._chartDesignTabUpdate(n("#"+u.attr("id")))),o.event=t,o.target=t.target,f&&f.cur&&f.prev&&(o.newHeight=f.cur.height,o.newWidth=f.cur.width,o.oldHeight=f.prev.height,o.oldWidth=f.prev.width),o.reqType=i.id.indexOf(c)>-1?"chart-resize":"picture-resize",this.XLObj._trigger("resizeEnd",o))){this._refreshImgResizing();this._shapeRSStart=!1;return}this._refreshImgResizing();this._shapeROStart=this._shapeRSStart=!1}},_imgMouseMove:function(n){var i=this.XLObj,s={};if(i._getContent(i.getActiveSheetIndex()).find(".e-ss-activeimg").length){n.preventDefault();var p=i.getActiveSheetIndex(),h=i._getContent(p),u=h.find(".e-ss-activeimg"),t=h.find(".e-ss-imgvisual"),c=u.get(0),o=c.getBoundingClientRect(),w=i._setXY(n),f=w[0],e=w[1],r,l,a;if(this._shapeROStart){if(this.XLObj._trigger("dragShape",n))return;t.show();c.id.indexOf("picture")>-1&&t.addClass("e-ss-picture");l=f-(this._imgX-this._imgOffsetleft);a=e-(this._imgY-this._imgOffsetTop);l>-1&&a>-1&&t.css({left:l,top:a,height:u.height(),width:u.width()})}else{var v=t.width(),y=t.height(),b=c.offsetWidth,k=c.offsetHeight,d=i._getJSSheetContent(p).find(".e-spreadsheetcontentcontainer > .e-content"),g=h.find(".e-hscrollbar").data("ejScrollBar"),nt=h.find(".e-vscrollbar").data("ejScrollBar");if(this._shapeRSStart){if(s.event=n,s.target=n.target,s.height=u.height(),s.width=u.width(),s.reqType=c.id.indexOf("chart")>-1?"chart-resize":"picture-resize",this.XLObj._trigger("resizeStart",s)){this._shapeRSStart=!1;return}if(t.show(),c.id.indexOf("picture")>-1&&t.addClass("e-ss-picture"),u.css("cursor")==="col-resize"||u.css("cursor")==="row-resize")switch(!0){case this._imgRSWStart:r=this._imgX-f;l=t[0].offsetLeft-r;l>-1&&(t.css({width:v+r,left:l}),this._imgX=f);break;case this._imgRSEStart:r=this._imgX-f;i.model.scrollSettings.allowScrolling&&v-r+t[0].offsetLeft+5<d.width()+g.value()&&(t.css({width:v-r}),this._imgX=f);break;case this._imgRSNStart:r=this._imgY-e;a=t[0].offsetTop-r;a>-1&&(t.css({height:y+r,top:a}),this._imgY=e);break;case this._imgRSSStart:r=this._imgY-e;i.model.scrollSettings.allowScrolling&&y-r+t[0].offsetTop+5<d.height()+nt.value()&&(t.css({height:y-r}),this._imgY=e)}}else this._refreshImgResizing(),f<=o.left+(i._isTouchEvt?20:4)&&f>=o.left?(u.addClass("e-ss-imgcresize"),this._imgRSWStart=!0):f<=o.left+b&&f>=o.left+b-(i._isTouchEvt?20:4)?(u.addClass("e-ss-imgcresize"),this._imgRSEStart=!0):h.find(".e-ss-imgcresize").removeClass("e-ss-imgcresize"),e<=o.top+(i._isTouchEvt?20:4)&&e>=o.top?(u.addClass("e-ss-imgrresize"),this._imgRSNStart=!0):e<=o.top+k&&e>=o.top+k-(i._isTouchEvt?20:4)?(u.addClass("e-ss-imgrresize"),this._imgRSSStart=!0):h.find(".e-ss-imgrresize").removeClass("e-ss-imgrresize")}}},_deleteShape:function(n,t){var l,i=this.XLObj,r=this._picCellIdx,s=i._dataContainer,a=i.getSheet(n),h=a.shapeMngr,f=s.sheets[n][r.rowIndex][r.colIndex],o,p=t.data("parentID"),v=t.get(0).id.replace(p+"_",""),u=v.replace(/[0-9]/g,""),c=t.get(0),y,e=h[u][f[u][0]];i._isUndoRedo||i._isPaste||i.XLClipboard._isShape||(o={sheetIndex:n,id:c.id,picIndex:c.id,reqType:"shape",shapeType:u,action:"create",options:e,range:e.range,img:h.sharedPics[e.data]},o.actCell={rowIndex:r.rowIndex,colIndex:r.colIndex},o.position={height:e.height,width:e.width,top:e.top,left:e.left},o.cnt=v.replace(/[a-z]/g,""),i._completeAction(o));f[u].some(function(n,t){return c.id===h[u][f[u][t]].id?(y=t,!0):!1});Object.keys(f).length<2&&f[u].length<2?(delete s.sheets[n][r.rowIndex][r.colIndex],i.getObjectLength(s.sheets[n][r.rowIndex])<1&&delete s.sheets[n][r.rowIndex]):f[u].length<2?delete f[u]:f[u].splice(y,1);delete h[u][c.id];l={rowIndex:r.rowIndex,colIndex:r.colIndex};n===i._getSheetIndex()&&(i.setActiveCell(r.rowIndex,r.colIndex),i.performSelection(l,l));t.remove();i.model.allowFormulaBar&&i.updateFormulaBar();i.model.showRibbon&&(u==="picture"?i.XLRibbon._toggleFormatTab():i.XLRibbon._toggleChartDesignTab());a._isChartBorderDrawn&&i.XLChart._clearChartRange(i._arrayAsString(i._chartBorder))},_selectImg:function(n){this.XLObj._getContent(this.XLObj.getActiveSheetIndex()).find(".e-ss-activeimg").removeClass("e-ss-activeimg");n.addClass("e-ss-activeimg");this.XLObj.XLSelection._cleanUp(!0);this.XLObj.model.allowFormulaBar&&this.XLObj.updateFormulaBar()},_refreshImgResizing:function(){this._imgRSEStart=!1;this._imgRSWStart=!1;this._imgRSNStart=!1;this._imgRSSStart=!1},_getShapePropeties:function(n,t,i){for(var r,u=this.XLObj.XLEdit.getPropertyValue(n.rowIndex,n.colIndex,i);r in u;)return u[r].id===t?u[r]:void 0},_updateShapeMngr:function(t,i,r,u){var s,h={},f=this.XLObj,o=u||f.getActiveSheetIndex(),e=f.getSheet(o).shapeMngr,c=e[r];c[i[r].id]=n.extend(!0,{},i[r]);r==="picture"&&(e.sharedPics.indexOf(i[r].data)<0&&e.sharedPics.push(i[r].data),s=e.sharedPics.indexOf(i[r].data),c[i[r].id].data=s);(f._isPaste||this._insertShape||f.XLClipboard._isShape||f.isImport||!f.getSheet(o)._isUpdated)&&(h[r]=i[r].id,f.XLEdit._updateDataContainer(t,{dataObj:h,sheetIdx:o}),this._insertShape=!1)},_updateShapeObj:function(t){var f,e=this.XLObj,s=e.getActiveSheetIndex(),h=e._dataContainer,o,u,r=this._shapeType==="img"?"picture":"chart",i=this._picCellIdx,l=e.getSheet(s).shapeMngr,c,a={},v=e._getContent(s).find(".e-ss-activeimg");(e.getObjectLength(this._picCellIdx)||(i=this._picCellIdx=this._getCellIndexFromOffset(t.offsetTop,t.offsetLeft)),f=v.length?v:n("#"+t.id),u=h.sheets[s][i.rowIndex][i.colIndex],u&&u[r])&&(o=l[r][f[0].id],u[r].some(function(n,t){return f[0].id===l[r][u[r][t]].id?(c=t,!0):!1}),a[r]=u[r][c],e.getObjectLength(u)<2&&u[r].length<2?delete h.sheets[s][i.rowIndex][i.colIndex]:u[r].length<2?delete h.sheets[s][i.rowIndex][i.colIndex][r]:h.sheets[s][i.rowIndex][i.colIndex][r].splice(c,1),this._picCellIdx=i=this._getCellIndexFromOffset(t.offsetTop,t.offsetLeft),o.height=f.height(),o.width=f.width(),o.left=f[0].offsetLeft,o.top=f[0].offsetTop,o.rowIndex=i.rowIndex,o.colIndex=i.colIndex,e.XLEdit._updateDataContainer({rowIndex:i.rowIndex,colIndex:i.colIndex},{dataObj:a}))},changePictureBorder:function(i,r,u,f){var o=this.XLObj,v=o.getActiveSheetIndex(),e=n("#"+i)[0],y=e.offsetLeft,p=e.offsetTop,c,w=this._getCellIndexFromOffset(p,y),b=o.getSheet(v).shapeMngr,l,k,a=new RegExp("\\be-shapebdr.*?\\b","g"),s,h;l=b.picture[e.id];c={sheetIndex:v,reqType:"shape",shapeType:"picture",action:"border",id:n(o.getSheetElement(v).find(".e-ss-activeimg")).attr("id"),prevClass:t.isNullOrUndefined(e.className.match(a))?e.className:e.className.match(a)[0],picIdx:k,cellIdx:w};s=r+" "+u+" "+f;h=this._getImgBorderHashCode({"border-color":f,"border-style":u,"border-width":r});o.model.allowCellFormatting&&o.XLFormat._writeCssRules(h,o.XLFormat._getCssPropertyAsString({border:{left:s,right:s,top:s,bottom:s}}));l.bcolor=f;l.bstyle=u;l.bwidth=r;e.className.match(a)&&(e.className=e.className.replace(a,""));n(e).addClass(h);c.curClass=h;c.borderProp=this._getImgStyleFromHashCode(h);o._dupDetails||o._isUndoRedo||o._completeAction(c)},_getCellIndexFromOffset:function(n,i,r,u){var f,h,o=0,s={},c=this.XLObj,e=c.getSheet(c._getSheetIndex(r));if(!t.isNullOrUndefined(n))for(s.rowIndex=c._getMinRowIdx(e),f=0,h=e._rowHeightCollection.length;f<h;f++)if(o=e._rowHeightCollection[f],o>n){s.rowIndex=f-1;break}if(!t.isNullOrUndefined(i))for(s.colIndex=0,f=0,o=0,h=e.columnsWidthCollection.length;f<h;f++)if(o+=e.columnsWidthCollection[f]===0&&u?e.hideColsCollection[f]:e.columnsWidthCollection[f],o>i){s.colIndex=f;break}return s},_getImgBorderHashCode:function(n){var i=this.XLObj,t="";return"border-width"in n&&(t=parseInt(n["border-width"])+"N"),i.model.allowCellFormatting&&"border-style"in n&&(t=t+i.XLFormat._getStyleCode("BorderStyle",n["border-style"])+"N"),"border-color"in n&&(t=t+n["border-color"].replace("#","")),"e-shapebdr"+t},_getImgStyleFromHashCode:function(n){var i=this.XLObj,t={};return n=n||"",n=n.replace("e-shapebdr","").split("N"),n.length>1&&(t["border-width"]=n[0]+"px",t["border-style"]=["","solid","dashed","dotted"][n[1]],t["border-color"]="#"+n[2]),t},_scrollShape:function(n,t,i,r){var f={position:"none",action:"none"},u=this.XLObj,e=u._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content");parseInt(t.css("width"))+(t.offset().left-u._getContent(n).find(".e-content").offset().left)>u._getContent(n).find(".e-content").width()&&this._imgX<=i?f={position:"horizontal",action:"Increment"}:t.offset().left-e.offset().left<=0?f={position:"horizontal",action:"Decrement"}:parseInt(t.css("height"))+(t.offset().top-u._getContent(n).find(".e-content").offset().top)>u._getContent(n).find(".e-content").height()&&this._imgY<=r?f={position:"vertical",action:"Increment"}:t.offset().top-e.offset().top<=0&&(f={position:"vertical",action:"Decrement"});u.XLSelection._scrollCalculation(n,t.get(0),f)},_onKeyscrollShape:function(n,t,i){var r=this.XLObj,u=r._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content"),f=r._getContent(n).find("#hscrollBar").ejScrollBar("instance"),e=r._getContent(n).find("#vscrollBar").ejScrollBar("instance");u.offset().top+u[0].offsetHeight<=t.offset().top+t[0].offsetHeight&&(i.keyCode===40||i.keyCode===13&&!i.shiftKey)?e.scroll(e.value()+2,!0):t.offset().top-r.model.sheets[n]._frozenHeight<=u.offset().top&&(i.keyCode===38||i.keyCode===13&&i.shiftKey)&&e.value()-2>=0&&e.scroll(e.value()-2,!0);u[0].offsetWidth<=t.offset().left+t[0].offsetWidth&&(i.keyCode===39||i.keyCode===9&&!i.shiftKey)?f.scroll(f.value()+2,!0):t.offset().left-r.model.sheets[n]._frozenWidth<=u.offset().left&&(i.keyCode===37||i.keyCode===9&&i.shiftKey)&&f.value()-2>=0&&f.scroll(f.value()-2,!0)}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.chart=function(n){this.XLObj=n;this._shapeCnt=1};t.spreadsheetFeatures.chart.prototype={createChart:function(n,i){var r=this.XLObj;if(r.model.allowCharts&&!r.model.isReadOnly){i=i||{};var o,e,f,p,c,u,s,l="chart",a,v=r._getSheetIndex(i.sheetIdx),h=r.getSheet(v),y;if(r._isUndoRedo&&(y=i.id.split("_"),o=y[y.length-1].replace(/[a-z]/g,"")),n=r._getRangeArgs(n,"object"),t.isNullOrUndefined(i.top)||t.isNullOrUndefined(i.left)||(i.activeCell=r.XLShape._getCellIndexFromOffset(i.top,i.left)),i.activeCell||(i.activeCell=h._activeCell),r.isRange(n)&&i.activeCell)return c=r._getCellInfo(i.activeCell),i.id=o?r._id+"_"+l+o:r._id+"_"+l+this._shapeCnt,i.type=i.type?i.type:"column",i.animation=i.animation?i.animation:!1,i.range=n,i.dataSheetIdx=i.dataSheetIdx?i.dataSheetIdx:v,i.height=i.height?i.height:r.model.chartSettings.height,i.width=i.width?i.width:r.model.chartSettings.width,i.top=i.top?i.top:c.top+2,i.left=i.left?i.left:c.left+2,i.isRowColSwitched=i.isRowColSwitched?i.isRowColSwitched:!1,a=r.XLShape._getCellIndexFromOffset(i.top,i.left),i.rowIndex=a.rowIndex,i.colIndex=a.colIndex,i.isResponsive=!1,i.canResize=!1,r.isUndefined(i.xRange)&&(s=this._processChartRange(n,i.dataSheetIdx),i.xRange=s.xRange,i.yRange=s.yRange,i.lRange=s.lRange),f=this._processChartSeries(i),i.xRange=f.xRange,i.yRange=f.yRange,i.lRange=f.lRange,r.getActiveSheetIndex()===i.dataSheetIdx&&this._focusChartRange(f.xRange,f.yRange,f.lRange),e=this._renderBaseElem(l,i.top,i.left,o),e.ejChart(this._processChartOptions(i,f.series)),this._afterChartRefresh(),u=e.ejChart("model"),i.theme=u.theme,i.title={text:u.title.text.length?u.title.text:"",align:u.title.textAlignment},i.xAxis={min:u.primaryXAxis.range.min,max:u.primaryXAxis.range.max,interval:u.primaryXAxis.range.interval,title:{text:u.primaryXAxis.title.text.length?u.primaryXAxis.title.text:""},range:f.xRange},i.yAxis={min:u.primaryYAxis.range.min,max:u.primaryYAxis.range.max,interval:u.primaryYAxis.range.interval,title:{text:u.primaryYAxis.title.text.length?u.primaryYAxis.title.text:""},range:f.yRange},i.legend={visible:u.legend.visible,range:f.lRange,position:u.legend.position},h._isImported||(r.XLShape._insertShape=!0),r.XLShape._updateShapeMngr(i.activeCell,{chart:i},"chart"),i.theme.indexOf("dark")>-1&&e.addClass("e-ss-charttheme"),r.model.showRibbon&&!i.hideTab&&r.XLRibbon._chartDesignTabUpdate(e),r._on(e,t.eventType.mouseDown,r._mouseDownHandler),r._on(e,t.eventType.mouseMove,r._mouseMove),r.setSheetFocus(),r._isSheetNavigate||h._isImported&&!h._isLoaded||r._isUndoRedo||r._isPaste||r.XLClipboard._isShape||(p={sheetIndex:v,reqType:"shape",shapeType:"chart",action:"remove",options:i,range:i.range,id:i.id,position:{top:i.top,left:i.left}},r._completeAction(p)),i.id}},resizeChart:function(i,r,u){var f={},e=n("#"+i);this.XLObj.model.isReadOnly||e.length&&(f.height=!t.isNullOrUndefined(r)&&r>180?r.toString():"180",f.width=!t.isNullOrUndefined(u)&&u>180?u.toString():"180",e.ejChart("option",{size:f}),this._afterChartRefresh())},refreshChart:function(t,i){var e=this.XLObj,r,u,f;if(e.model.allowCharts&&!e.model.isReadOnly&&(u="marker",f=this._getShapeObj(t,"chart"),f)){for(r in i)f[r]=i[r];i.type&&(i.commonSeriesOptions={type:i.type},delete i.type);u in i&&(i.commonSeriesOptions?i.commonSeriesOptions.marker={visible:i.marker.visible}:i.commonSeriesOptions={marker:i.marker},delete i[u]);n("#"+t).ejChart("option",i)}},_processChartOptions:function(n,t){var r=yVisiblity=!1,i={commonSeriesOptions:{type:n.type,enableAnimation:n.animation},series:t,canResize:n.canResize,size:{height:n.height.toString(),width:n.width.toString()},enableRotation:!1,depth:100,wallSize:2,tilt:0,rotation:34,perspectiveAngle:90,sideBySideSeriesPlacement:!0,seriesRendering:this.XLObj.model.seriesRendering};return n.enable3D&&(i.enable3D=!0),n.marker&&(i.commonSeriesOptions.marker=n.marker),n.theme&&(i.theme=n.theme),i.title=n.title||{},this.XLObj.getObjectLength(i.title)>0&&(i.title.textAlignment=n.title.align,delete i.title.align),i.legend=n.legend||{},n.xAxis&&n.xAxis.minorGridLines&&(r=n.xAxis.minorGridLines.visible),n.yAxis&&n.yAxis.minorGridLines&&(yVisiblity=n.yAxis.minorGridLines.visible),i.primaryYAxis=n.primaryYAxis||{labelFormat:this._chartYAxisFormat(n.yRange),minorTicksPerInterval:5,minorGridLines:{visible:yVisiblity},minorTickLines:{visible:!1}},i.primaryXAxis=n.primaryXAxis||{labelFormat:this._chartYAxisFormat(n.xRange),minorTicksPerInterval:5,minorGridLines:{visible:r},minorTickLines:{visible:!1},valueType:"category"},i},_chartYAxisFormat:function(n){if(!t.isNullOrUndefined(n)){var u=this.XLObj,i,r=t.globalize.preferredCulture().numberFormat.currency.symbol;return i=u.XLEdit.getPropertyValue(n[0],n[1],"type"),i==="accounting"?r+" {value}":i==="currency"?r+"{value}":i==="percentage"?"{value}%":"{value}"}},_processChartRange:function(n,i){var s=this.XLObj,l,f,h,r=n[0],u=n[1],o=n[2],e=n[3],c=s.XLEdit.getPropertyValue(r,e,null,i),y=s.XLEdit.getPropertyValue(o,u,null,i),p=s.XLEdit.getPropertyValue(r,u,null,i),a=r===o,v=u===e;return!s.isUndefined(p)||a||v?t.isNullOrUndefined(y)||s.isNumber(y)||a||v?(f=[r,u,o,e],t.isNullOrUndefined(c)||s.isNumber(c)||s._isDateTime(c)?t.isNullOrUndefined(p)&&(a||v)&&(h=[r,u,r,e],a?(f[1]=f[1]+1,h[3]=h[1]):f[0]=f[0]+1):(h=[r,u,r,e],f[0]=f[0]+1)):t.isNullOrUndefined(c)||s.isNumber(c)?(l=[r,u,o,u],f=[r,u+1,o,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]):(l=[r+1,u,o,u],f=[r+1,u+1,o,e],h=[r,u+1,r,e]),{xRange:l,yRange:f,lRange:h}},_processChartSeries:function(n){n=n||{};var t=this.XLObj,a,b,i=n.xRange,r=n.yRange,u=n.lRange,f,k,e,o,v,y,p,w,s,d,h=0,c=0,g=[],l=["value2"];for(k=t.getRangeData({range:r,valueOnly:!0,sheetIdx:n.dataSheetIdx,skipFormula:!0}),v=r[2]-r[0]+1,y=r[3]-r[1]+1,n.isRowColSwitched?(f=u?t._toArrayData(t.getRangeData({range:u,property:l,sheetIdx:n.dataSheetIdx})):this._getVirtualXValues(y+1),i&&(e=t._toArrayData(t.getRangeData({range:i,property:l,sheetIdx:n.dataSheetIdx}))),o=v):(f=i?t._toArrayData(t.getRangeData({range:i,property:l,sheetIdx:n.dataSheetIdx})):this._getVirtualXValues(v+1),u&&(e=t._toArrayData(t.getRangeData({range:u,property:l,sheetIdx:n.dataSheetIdx}))),o=y),b=f.length,d=n.isRowColSwitched?1:o;h<o;){for(s=0,p=[],c=n.isRowColSwitched?c:h;s<b;)a=k[c],p.push({x:f[s],y:t.isNumber(a)?Number(a):0}),c+=d,s++;w={points:p};e&&(w.name=e[h]);g.push(w);h++}return{series:g,xRange:n.isRowColSwitched?u:i,yRange:r,lRange:n.isRowColSwitched?i:u}},_getVirtualXValues:function(n){for(var t=1,i=[];t<n;)i.push(t.toString()),t++;return i},_focusChartRange:function(n,t,i){var r=this.XLObj,u=r._chartBorder;this._clearChartRange(r._arrayAsString(u));i&&r.XLSelection._focusBorder({rowIndex:i[0],colIndex:i[1]},{rowIndex:i[2],colIndex:i[3]},u[0]);n&&r.XLSelection._focusBorder({rowIndex:n[0],colIndex:n[1]},{rowIndex:n[2],colIndex:n[3]},u[1]);r.XLSelection._focusBorder({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},u[2]);r.getSheet(r.getActiveSheetIndex())._isChartBorderDrawn=!0},_clearChartRange:function(n){var t=this.XLObj;t.XLSelection._clearBorder(n);t.getSheet(t.getActiveSheetIndex())._isChartBorderDrawn=!1},_renderBaseElem:function(i,r,u,f){f=t.isNullOrUndefined(f)?this._shapeCnt:f;var e=this.XLObj,o=n("<div id='"+e._id+"_"+i+f+"' class='e-ss-object' style='top:"+r+"px;left:"+u+"px; min-height:180px; min-width:180px' ><\/div>");return o.data("parentID",e._id),e._getContent(e.getActiveSheetIndex()).find(".e-content").first().append(o),e.XLShape._selectImg(o),e._isUndoRedo||this._shapeCnt++,o},_refreshChartElements:function(n,t,i){for(var u,f,r,e=this.XLObj,o=1,s=e.model.sheetCount+1;o<s;){if(u=e.getSheet(o).shapeMngr.chart,f=e.getObjectLength(u),f)while(f--)r=u[e.getObjectKeys(u)[f]],r.dataSheetIdx===i&&(this.XLObj.inRange(r.range,n,t)||this.XLObj._inRow(r.range,n)||this.XLObj._inColumn(r.range,t))&&this._refreshChart(r);o++}},_refreshChart:function(t){if(n("#"+t.id).length!==0){var i=n("#"+t.id).data("ejChart"),u={xRange:t.xRange,yRange:t.yRange,lRange:t.lRange,isRowColSwitched:t.isRowColSwitched,dataSheetIdx:t.dataSheetIdx},r;i.model.series.length=0;r=this._processChartSeries(u);i.option({series:r.series,primaryXAxis:{labelFormat:this._chartYAxisFormat(t.xRange)},primaryYAxis:{labelFormat:this._chartYAxisFormat(t.yRange)}})}},switchRowColumn:function(t){var r=this.XLObj;if(!r.model.isReadOnly){var u,f=t||document.getElementById(r._id+"_chart").value,e=n("#"+f).ejChart("instance"),i=r.XLChart._getShapeObj(f,"chart"),o={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"srcolumn",cid:f,rowIndex:r.XLShape._picCellIdx.rowIndex,colIndex:r.XLShape._picCellIdx.colIndex};e.model.series.length=0;i.isRowColSwitched=!i.isRowColSwitched;obj={xRange:i.xRange,yRange:i.yRange,lRange:i.lRange,isRowColSwitched:i.isRowColSwitched,dataSheetIdx:i.dataSheetIdx};u=r.XLChart._processChartSeries(obj);e.option({series:u.series});r.getActiveSheetIndex()===i.dataSheetIdx&&r.XLChart._focusChartRange(u.xRange,u.yRange,u.lRange);i.xAxis.range=u.xRange;i.yAxis.range=u.yRange;i.legend.range=u.lRange;r._completeAction(o)}},updateChartElement:function(r,u,f){var o=this.XLObj;if(!o.model.isReadOnly){o._showDialog(o._id+"_chartname");var a,c=r||document.getElementById(o._id+"_chart").value,h,s,e=n("#"+c).ejChart("instance"),l=o.getActiveSheetIndex();details={sheetIndex:l,reqType:"shape",shapeType:"chart",cid:c,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex};dataVal=o.getSheet(l).shapeMngr.chart[o.XLEdit.getPropertyValue(o.XLShape._picCellIdx.rowIndex,o.XLShape._picCellIdx.colIndex,"chart")[0]];f?h={model:{text:o._getLocStr("Ok")}}:f="";switch(u){case"PHAxis":details.visibility=!e.model.primaryXAxis.visible;e.option("primaryXAxis",{visible:details.visibility});dataVal.xAxis.visible=details.visibility;details.action=u;break;case"PVAxis":details.visibility=!e.model.primaryYAxis.visible;e.option("primaryYAxis",{visible:details.visibility});dataVal.yAxis.visible=details.visibility;details.action=u;break;case"PHAxisTitle":o._cOpt.prev={text:dataVal.xAxis.title.text};e.model.primaryXAxis.title.text.length!=0?(e.option("primaryXAxis",{title:{text:""}}),dataVal.xAxis.title.text="",details={sheetIndex:l,reqType:"shape",shapeType:"chart",action:"PX",cid:c,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(details)):(o._hasTitle="PX",document.getElementById(o._id+"_chartname").value=dataVal.xAxis.title.text,f.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(dataVal.xAxis.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(h,f),o._cOpt={prevText:dataVal.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"PVAxisTitle":o._cOpt.prev={text:dataVal.yAxis.title.text};e.model.primaryYAxis.title.text.length!=0?(e.option("primaryYAxis",{title:{text:""}}),dataVal.yAxis.title.text="",details={sheetIndex:l,reqType:"shape",shapeType:"chart",action:"PY",cid:c,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(details)):(o._hasTitle="PY",document.getElementById(o._id+"_chartname").value=dataVal.yAxis.title.text,f.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(dataVal.yAxis.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(h,f),o._cOpt={prevText:dataVal.title.text,prevAlign:e.model.title.textAlignment,curAlign:e.model.title.textAlignment});break;case"CTNone":o._cOpt.prev={text:dataVal.title.text};e.model.title.text.length&&(e.option("title",{text:""}),dataVal.title.text="",details={sheetIndex:l,reqType:"shape",shapeType:"chart",action:"CT",cid:c,rowIndex:o.XLShape._picCellIdx.rowIndex,colIndex:o.XLShape._picCellIdx.colIndex,prev:{text:o._cOpt.prev.text},cur:{text:""}},o._completeAction(details));break;case"CTCenter":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=dataVal.title.text;f.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(dataVal.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(h,f);e.option("title",{textAlignment:"center"});o._cOpt.curAlign=e.model.title.textAlignment;dataVal.title.align="center";break;case"CTFar":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=dataVal.title.text;f.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(dataVal.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(h,f);e.option("title",{textAlignment:"far"});o._cOpt.curAlign=e.model.title.textAlignment;dataVal.title.align="far";break;case"CTNear":o._hasTitle="CT";o._cOpt={prevText:e.model.title.text,prevAlign:e.model.title.textAlignment};document.getElementById(o._id+"_chartname").value=dataVal.title.text;f.length<1?(n("#"+o._id+"_chartnamedlg").ejDialog("open"),n("#"+o._id+"_chartname").focus().setInputPos(dataVal.title.text.length)):o.XLRibbon._chartNameDlgBtnClick(h,f);e.option("title",{textAlignment:"near"});o._cOpt.curAlign=e.model.title.textAlignment;dataVal.title.align="near";break;case"DLNone":for(s=[],details.action="DL",details.prev={series:n.extend(!0,[],e.model.series)},a=e.model.series[0].marker.dataLabel.visible?!1:!0,i=0;i<e.model.series.length;i++)s.push({marker:{dataLabel:{visible:a,verticalTextAlignment:"far",textPosition:"top"}}});e.option({series:s});details.cur={series:n.extend(!0,[],e.model.series)};dataVal.dataLabel={visible:a};break;case"DLCenter":for(s=[],details.action="DL",details.prev={series:n.extend(!0,[],e.model.series)},i=0;i<e.model.series.length;i++)s.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"center",textPosition:"middle",offset:{y:0}}}});e.option({series:s});details.cur={series:n.extend(!0,[],e.model.series)};dataVal.dataLabel={visible:!0,vAlign:"center",tPosn:"middle"};break;case"DLIBase":for(s=[],details.action="DL",details.prev={series:n.extend(!0,[],e.model.series)},i=0;i<e.model.series.length;i++)s.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"far",textPosition:"bottom",offset:{y:0}}}});e.option({series:s});details.cur={series:n.extend(!0,[],e.model.series)};dataVal.dataLabel={visible:!0,vAlign:"far",tPosn:"bottom"};break;case"DLIEnd":for(s=[],details.action="DL",details.prev={series:n.extend(!0,[],e.model.series)},i=0;i<e.model.series.length;i++)s.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:-10}}}});e.option({series:s});details.cur={series:n.extend(!0,[],e.model.series)};dataVal.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"DLOEnd":for(s=[],details.action="DL",details.prev={series:n.extend(!0,[],e.model.series)},i=0;i<e.model.series.length;i++)s.push({marker:{dataLabel:{visible:!0,verticalTextAlignment:"near",textPosition:"top",offset:{y:0}}}});e.option({series:s});details.cur={series:n.extend(!0,[],e.model.series)};dataVal.dataLabel={visible:!0,vAlign:"near",tPosn:"top"};break;case"PMajorH":details.visibility=!e.model.primaryYAxis.majorGridLines.visible;e.option("primaryYAxis",{majorGridLines:{visible:details.visibility}});dataVal.yAxis.majorGridLines={visible:details.visibility};details.action=u;break;case"PMajorV":details.visibility=!e.model.primaryXAxis.majorGridLines.visible;e.option("primaryXAxis",{majorGridLines:{visible:details.visibility}});dataVal.xAxis.majorGridLines={visible:details.visibility};details.action=u;break;case"PMinorH":details.visibility=!e.model.primaryYAxis.minorGridLines.visible;e.option("primaryYAxis",{minorGridLines:{visible:details.visibility},minorTicksPerInterval:5,minorTickLines:{visible:details.visibility}});dataVal.yAxis.minorGridLines={visible:details.visibility};details.action=u;break;case"PMinorV":details.visibility=!e.model.primaryXAxis.minorGridLines.visible;e.option("primaryXAxis",{minorGridLines:{visible:details.visibility},minorTicksPerInterval:5,minorTickLines:{visible:details.visibility}});dataVal.xAxis.minorGridLines={visible:details.visibility};details.action=u;break;case"LNone":details.visibility=!e.model.legend.visible;e.option("legend",{visible:details.visibility});dataVal.legend.visible=details.visibility;details.action=u;break;case"LLeft":details.prev={position:e.model.legend.position};e.option("legend",{position:"left",visible:!0});dataVal.legend.position="left";details.cur={position:e.model.legend.position};details.action="Legend";break;case"LRight":details.prev={position:e.model.legend.position};e.option("legend",{position:"right",visible:!0});dataVal.legend.position="right";details.cur={position:e.model.legend.position};details.action="Legend";break;case"LBottom":details.prev={position:e.model.legend.position};e.option("legend",{position:"bottom",visible:!0});dataVal.legend.position="bottom";details.cur={position:e.model.legend.position};details.action="Legend";break;case"LTop":details.prev={position:e.model.legend.position};e.option("legend",{position:"top"});dataVal.legend.position="top";details.cur={position:e.model.legend.position};details.action="Legend"}t.isNullOrUndefined(details.action)||o._completeAction(details)}},changeTheme:function(t,i){var r=this.XLObj,t=t||r.element.find("#"+r._id+"_chart").val(),u;u={sheetIndex:r.getActiveSheetIndex(),reqType:"shape",action:"chartTheme",chartId:t};u.prev={theme:n("#"+t).data("ejChart").model.theme};i&&i.indexOf("dark")>-1?n("#"+t).addClass("e-ss-charttheme"):n("#"+t).removeClass("e-ss-charttheme");r.XLChart.refreshChart(t,{theme:i});u.cur={theme:i};r._completeAction(u)},changeType:function(t,i){var u=this.XLObj,r=n("#"+t).data("ejChart"),f={sheetIndex:u.getActiveSheetIndex(),reqType:"shape",shapeType:"chart",action:"chartType",chartId:t};f.prev={chartType:r.model.series[0].type,enable3D:r.model.enable3D,marker:r.model.series[0].marker.visible};u.XLChart.refreshChart(t,i);f.cur={chartType:r.model.series[0].type,enable3D:r.model.enable3D,marker:r.model.series[0].marker.visible};n("#"+u._id+"_charttypedlg").ejDialog("close");u._completeAction(f)},_getShapeObj:function(n,t){var i=this.XLObj,r=i.getSheet(i.getActiveSheetIndex()).shapeMngr[t],u=i.getObjectLength(r);if(u)return r[n]},_validateChartRange:function(n,t,i,r){var u=this.XLObj;if(!i)return{msg:u._getLocStr("YAxisMissing")};if(!(u.inRange(n,i[0],i[1])||u.inRange(n,i[2],i[3])))return{msg:u._getLocStr("InvalidYAxis")};if(t)if(u.inRange(n,t[0],t[1])||u.inRange(n,n[2],n[3])){if(t[3]-t[1]!=0)return{msg:u._getLocStr("InvalidXAxisColumns")}}else return{msg:u._getLocStr("InvalidXAxis")};return r&&!(u.inRange(n,r[0],r[1])||u.inRange(n,r[2],r[3]))?{msg:u._getLocStr("InvalidLegend")}:{status:!0}},_renderChartRangeDialog:function(){var t=this.XLObj,i={width:"25%",showRoundedCorner:!0,click:n.proxy(this._chartRangeDlgBtnClick,this)},r=n("<div id='"+t._id+"_chartrangedlg'><div class='e-dlgctndiv e-dlg-fields'><table cellpadding='0' cellspacing='0'><tr class='e-dlgtd-fields'><td>"+t._getLocStr("XAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crxaxis'/><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("YAxisRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_cryaxis' /><\/td><\/tr><tr class='e-dlgtd-fields'><td>"+t._getLocStr("LegendRange")+"<\/td><td><input type='text' class='ejinputtext' id='"+t._id+"_crlaxis'/><\/td><\/tr><\/table><\/div><div class='e-dlg-btnfields' ><div class='e-dlg-btnctnr'><button id='"+t._id+"_crok' >"+t._getLocStr("Ok")+"<\/button><button id='"+t._id+"_crcancel'>"+t._getLocStr("Cancel")+"<\/button><\/div><\/div><\/div>");t.element.append(r);r.ejDialog({width:310,height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"e-ss-dialog e-"+t._id+"-dlg",title:t._getLocStr("ChartRange")});n("#"+t._id+"_crok").ejButton(i);n("#"+t._id+"_crcancel").ejButton(i)},_chartRangeDlgBtnClick:function(t){var r,u,f,e,i=this.XLObj;t.model.text===i._getLocStr("Ok")&&(r=document.getElementById(i._id+"_chart").value,u=n("#"+i._id+"_crxaxis").val(),f=n("#"+i._id+"_cryaxis").val(),e=n("#"+i._id+"_crlaxis").val(),this.changeDataRange(r,u,f,e));!0&&n("#"+i._id+"_chartrangedlg").ejDialog("close")},changeDataRange:function(t,i,r,u){var l,o,f=this.XLObj,w,s,h,c,a=f._getSheetIndex(f.getActiveSheetIndex()),v=f.getSheet(a),y,p,e;o=this._getShapeObj(t,"chart");i.length&&(s=f.getRangeIndices(i));r.length&&(h=f.getRangeIndices(r));u.length&&(c=f.getRangeIndices(u));p={xRange:i,yRange:r,lRange:u};l=this._validateChartRange(o.range,s,h,c);l.status?(o.xRange=s,o.yRange=h,o.lRange=c,this._refreshChart(o),e=n("#"+t).ejChart("model"),o.xAxis={min:e.primaryXAxis.range.min,max:e.primaryXAxis.range.max,interval:e.primaryXAxis.range.interval,title:{text:e.primaryXAxis.title.text.length?e.primaryXAxis.title.text:""},range:s},o.yAxis={min:e.primaryYAxis.range.min,max:e.primaryYAxis.range.max,interval:e.primaryYAxis.range.interval,title:{text:e.primaryYAxis.title.text.length?e.primaryYAxis.title.text:""},range:h},o.legend={visible:e.legend.visible,range:c},f.getActiveSheetIndex()===o.dataSheetIdx&&this._focusChartRange(s,h,c)):(w=!1,f._showAlertDlg("Alert","T-"+l.msg,"",400));v._isImported&&!v._isLoaded||f._isUndoRedo||f._isExport||(y={sheetIndex:a,reqType:"shape",shapeType:"chart",action:"selectData",id:t,prev:f._selectDataval,cur:p},f._completeAction(y))},_afterChartRefresh:function(){var t=this.XLObj,n,i;t.model.allowFormulaBar&&(n=t.element.find(".e-formulabar")[0],i=parseInt(n.style.width)-1,n.style.width="0px",n.style.width=i+"px")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.print=function(n){this.XLObj=n;this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;this._printRowLabels=!1;this._isPrintSelection=!1;this._stRow=0;this._stColumn=0};t.spreadsheetFeatures.print.prototype={_printSetting:function(n){this.XLObj.model.pageSize=n;switch(n){case t.Spreadsheet.pageSize.A4:this._printHeight=950;this._pageHeight=970;this._pageWidth=750;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.A3:this._printHeight=1350;this._pageHeight=1330;this._pageWidth=860;this._marginTop=30;this._marginBottom=150;break;case t.Spreadsheet.pageSize.Letter:this._printHeight=1040;this._pageHeight=920;this._pageWidth=860;this._marginTop=30;this._marginBottom=60}},printSelection:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting&&!i.model.isReadOnly){var e,h,u=i.getActiveSheetIndex(),s=i.getSheet(u)._selectedCells,r=s[0],o=s[s.length-1],c=o.colIndex-r.colIndex,f=t.buildTag("table"),l=t.buildTag("colgroup"),v=i._getContent(u).find("col"),a=t.buildTag("div#printDiv");for(i._refreshTemplates(u,!0,r.colIndex,r.colIndex+c+1),i._isPrint=!0,e=r.colIndex;e<o.colIndex;e++)n(v[e].outerHTML).attr("id","cc").appendTo(l);h=i.getRangeData({range:[r.rowIndex,r.colIndex,o.rowIndex,o.colIndex],property:["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink","cFormatRule","rule"],sheetIdx:u,withRowIdx:!0});f.html(i._renderData(h,u,r.colIndex,c+1,!0));l.insertBefore(f.find("tbody"));this._stRow=r.rowIndex;this._stCol=r.colIndex;this._isPrintSelection=!0;i._isPrint=!1;this._printRowLabels?this._calculateTabCount(a,u,f):this._constructSheet(a,u,f,f[0].rows);i._refreshTemplates(u,!0)}},printSheet:function(){var i=this.XLObj;if(i.model.printSettings.allowPrinting&&!i.model.isReadOnly){var e,o,s,h=t.buildTag("div#printDiv"),r=i.getActiveSheetIndex(),u=i.getSheet(r),l=u.columnsWidthCollection,a=i._getContent(r).find("col"),f=t.buildTag("table"),c=t.buildTag("colgroup");for(i._refreshTemplates(r,!0,0,u.usedRange.colIndex+1),i._isPrint=!0,e=0,o=l.length;e<o;e++)n(a[e].outerHTML).attr("id","cc").appendTo(c);s=i.getRangeData({range:[0,0,u.usedRange.rowIndex,u.usedRange.colIndex],property:["value","value2","format","border","type","isFilterHide","isRHide","isFHide","isMHide","merge","hRow","wrap","overflow","align","hyperlink","cFormatRule","rule"],sheetIdx:r,withRowIdx:!0});f.html(i._renderData(s,r,0,u.usedRange.colIndex+1,!0));c.insertBefore(f.find("tbody"));this._printRowLabels?this._calculateTabCount(h,r,f):this._constructSheet(h,r,f,f[0].rows);i._isPrint=!1;i._refreshTemplates(r,!0)}},_calculateTabCount:function(n,t,i){for(var s,u=this.XLObj,e=[],f=0,o=u.getSheet(u.getActiveSheetIndex()).columnsWidthCollection,r=0,h=o.length;r<h;r++)f+=o[r],f>=this._pageWidth&&(e.push({tCount:1,cellCount:r}),f=0);s={xlObj:u,element:e,table:i,printDiv:n,Index:t};this.XLObj._trigger("beforePrint",s)},_calculateCellRowCount:function(n,t,i){for(var o=this.XLObj,b=o.getActiveSheetIndex(),s=o.getSheet(b),h=s.columnsWidthCollection,c=s.rowsHeightCollection,f,l=0,a=0,v=12,y=40,p=0,w=0,u,r=t,e=h.length;r<e;r++)if(l+=h[r],l>=this._pageWidth){w=v=r;break}else f=Math.floor((this._pageWidth-l)/s.columnWidth),w=v=h.length+f;for(u=i,e=c.length;u<e;u++)if(a+=c[u],a>=this._pageHeight){p=y=u;break}else f=Math.floor((this._pageHeight-a)/o.model.rowHeight),p=y=c.length+f;return{startCell:t,endCell:w,startRow:i,endRow:p,cellCount:v,rowCount:y}},_constructSheet:function(n,i,r,u){var o=t.buildTag("div .e-spreadsheet","",{}),c=t.buildTag("div .e-spreadsheetmainpanel","",{}),e=0,f=this._calculateCellRowCount(u,0,0),s=u[0].cells.length,h=u.length;e=Math.ceil(s/f.cellCount);e=e*Math.ceil(h/f.rowCount);e==1&&(f.rowCount=u.length);o.append(c);this._constructPrintableElement(i,n,o.find(".e-spreadsheetmainpanel"),r,u,h,s,e,f.cellCount,f.rowCount,f.startRow,f.startCell,f.endRow,f.endCell)},_constructPrintableElement:function(i,r,u,f,e,o,s,h,c,l,a,v,y,p){for(var ft,ct,d,lt,et=!1,ut,k=this.XLObj,g=k.getSheet(i),at=t.buildTag("div"),nt,kt,ot=!1,st,ht=!0,vt=!1,yt=!1,pt=0,tt,w,it,rt,wt,b,gt=k._getContent(i).find("col"),ni=g.columnsWidthCollection,dt=g.rowsHeightCollection,bt=h;bt>0;bt--){for(nt=this._calculateCellRowCount(e,v,a),v=nt.startCell,p=nt.endCell,a=nt.startRow,y=nt.endRow,c=nt.cellCount,l=nt.rowCount,ut=this._constructTable(i,v,p),g.showHeadings&&this._constructHeaders(v,p,y,ut),kt=this._isPrintSelection?a<this._stRow?this._stRow:a:a,w=a;w<y;w++){for(t.isNullOrUndefined(f[0].rows[w])?(ht=!1,d=t.buildTag("tr","",{height:k.model.rowHeight})):(st=dt[w],ht=!0,d=st>0?t.buildTag("tr","",{height:st}):t.buildTag("tr","",{height:k.model.rowHeight})),ht&&(vt=k.XLEdit.getPropertyValue(w,0,"isRHide"),t.isNullOrUndefined(vt)||k.addClass(d[0],"e-r-hide")),it=v;it<p;it++)g.showHeadings&&!et&&(lt='<td class="{0}">{1}<\/td>',n(String.format(lt,"e-rowcell e-header",w+1)).appendTo(d),et=!0),n(e[w]).length>0&&n(e[w].cells[it]).length>0?(rt=n(e[w].cells[it].outerHTML).attr("id","ss"),rt.appendTo(d)):(rt=t.buildTag("td.e-rowcell"),rt.appendTo(d)),yt=k.XLEdit.getPropertyValue(0,it,"isCHide"),t.isNullOrUndefined(yt)||k.addClass(rt[0],"e-col-hide");et=!1;ut.append(d)}if(r.append(ut),y<o)a=y,y=y+l;else if(y>=o){if(p>=s)break;a=0;y=l;v=p;p=p+c}}for(w=r.find("table").length-1;w>=0;--w)tt=n(r.find("table")[w]),ot||this._checkEmptyRow(i,tt,"first"),pt=g.showHeadings?tt.find("tr.empty").length+1:tt.find("tr.empty").length,(tt.find("tr").length!==pt||ot)&&(n(tt.get(0).outerHTML).attr("id","cc").appendTo(at),ot=!0);for(b=at.find("table"),w=b.length-1;w>=0;--w)b.length-1!==w?(k.model.pageSize===t.Spreadsheet.pageSize.A4&&b.eq(w).css({"margin-top":300,"margin-bottom":300}),k.model.pageSize===t.Spreadsheet.pageSize.A3&&b.eq(w).css({"margin-top":120,"margin-bottom":110}),k.model.pageSize===t.Spreadsheet.pageSize.Letter&&(g.showHeadings?b.eq(w).css({"margin-top":70,"margin-bottom":50}):b.eq(w).css({"margin-top":0,"margin-bottom":50}))):b.length-1===w&&b.eq(w).css({"margin-top":30,"margin-bottom":g.showHeadings?20:0}),w||(b.length>1&&b.eq(w).css({"margin-top":120,"margin-bottom":0}),this._checkEmptyRow(i,b.eq(w),"last")),n(b[w].outerHTML).attr("id","cc").appendTo(u);for(ft=n("head").find("link"),ct=[],w=0,wt=ft.length;w<wt;w++)if(ft[w].href.indexOf("ej.pivotintegration.css")>-1){ct.push(ft[w]);break}u=u.parent();k._trigger("_pivotPrint",{element:u});this._isPrintSelection=!1;this.print(u,ct,i)},_checkEmptyRow:function(t,i,r){for(var o,e,f=i.find("tr"),s,h,c,u=f.length-1;u>=0;--u)if(o=n(f[u]).find(".e-rowcell").length,e=n(f[u]).find(".e-rowcell:empty").length,e=this.XLObj.getSheet(t).showHeadings?e+1:e,s=n(f[u]).find('td[class *= "e-format"]').length,h=n(f[u]).find('td[class *= "e-border"]').length,c=n(f[u]).find('td[class *= "e-mc-hide"]').length,e===o&&s<1&&h<1&&c<1)n(f[u]).addClass("empty");else{n(f[u]).addClass("nonempty");break}r==="last"&&(i.find("tr.empty").find("td").removeClass("e-rowcell"),i.find("tr.empty").find("td.e-header").text(""))},_constructTable:function(i,r,u){var e=t.buildTag("colgroup"),s=this.XLObj,l=t.buildTag("div","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),h=t.buildTag("table.e-table","",{height:this._printHeight,"margin-top":this._marginTop,"margin-bottom":this._marginBottom}),c=s._getContent(s.getActiveSheetIndex()).find("col"),o,f;for(s.getSheet(i).showHeadings&&(o='<col class="{0}" style= "width: 30px;" >{1}<\/col>',n(o).appendTo(e)),f=r;f<u;f++)n(c[f]).length>0?n(c[f].outerHTML).attr("id","cc").appendTo(e):(o='<col style= "width: 64px;" ><\/col>',n(o).appendTo(e));return h.append(e),l.append(h),h},_constructHeaders:function(i,r,u,f){var o=this.XLObj,w=o.getActiveSheetIndex(),h=t.buildTag("tr","",{height:30}),c,l,s,a,v,y=!1,b=o._getContent(w).find("col"),p="e-rowcell",e;for(this._isPrintSelection&&i<this._stCol&&(r=r+(this._stCol-i),i=this._stCol),c='<td class="{0}">{1}<\/td>',l='<div class = "{0}" > {1}<\/div>',e=i;e<=r;e++)y?(s=o._generateHeaderText(e),p=t.isNullOrUndefined(o.XLEdit.getPropertyValue(0,e-1,"isCHide"))?"e-rowcell e-headercell":"e-rowcell e-col-hide"):(s="",y=!0),a=String.format(l,"e-headercelldiv",s),v=String.format(c,p,a),n(h[0]).append(v);f.append(h)},print:function(i,r,u){var o=this.XLObj,f,e,c,s,h,l;o.model.printSettings.allowPrinting&&!o.model.isReadOnly&&((f=window.open("","print","'height=452,width=1024,tabbar=no"),o.isUndefined(f))||(h=t.buildTag("div"),l=i.clone(),h.append(l),f.document.write("<!DOCTYPE html>"),o._browserDetails.name==="msie"?(s="",r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);s+=i.outerHTML}),f.document.write("<html><head><\/head><body>"+s+h[0].innerHTML+"<\/body><\/html>")):(s="",f.document.write("<html><head>"),r.length>0&&n(r).each(function(t,i){n(i).attr("href",i.href);s+=i.outerHTML}),f.document.writeln(s+"<\/head><body>"),f.document.writeln(h[0].innerHTML+"<\/body><\/html>")),n(f.document.head).append("<style><\/style>"),e=o.model.sheets[u].showGridlines?".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {border: 1px solid #000000;line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}":".e-spreadsheet .e-table{table-layout: fixed; width: 100%;}.e-spreadsheet .e-rowcell {line-height: 14px;overflow: hidden;white-space: pre;vertical-align: bottom;}.e-spreadsheet .e-table{border-collapse: collapse}",e=e.concat(n(document).find("style#"+this.XLObj._id+"_sscustomformat").text()),c=n(f.document.head).find("style"),e=e.concat(".e-spreadsheet .e-fr-hide { display: none !important;}.e-spreadsheet .e-fc-hide { display: none !important;}.e-spreadsheet .e-sswraptext {word-break: break-all; white-space: normal;}.e-spreadsheet .e-headercell{text-align:center;}.e-spreadsheet .e-ralign{text-align:right;}.e-spreadsheet .e-calign{text-align:center;}"),e=e.concat(".e-spreadsheet .e-hyperlinks { text-decoration: underline;}"),c.append(e),f.focus(),n("#print").remove(),setTimeout(function(){(o._browserDetails.name==="msie"?!o.getObjectLength(f)||t.isNullOrUndefined(f.window)||t.isNullOrUndefined(f.location):t.isNullOrUndefined(f.window)||t.isNullOrUndefined(f.location))||(f.print(),f.location.reload());setTimeout(function(){f.close()},2e3)},2e3)))}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.scroller=function(n){this.XLObj=n;this._isIntrnlScroll=!1};t.spreadsheetFeatures.scroller.prototype={_getColWidths:function(n,t){var i,s=this.XLObj,r=s.getSheet(n),u=r.columnsWidthCollection,f=r._colWidthCollection,e,o=r._ofColWidthColl;for(t||(t=1),i=t,len=u.length;i<len;i++)f[i]=f[i-1]+u[i-1],e=u[i-1]===0?r.hideColsCollection[i-1]:u[i-1],o[i]=o[i-1]+e},_getRowHeights:function(n,t,i){var r,e=this.XLObj,o=e.getSheet(n),f=o.rowsHeightCollection,u=o._rowHeightCollection,s=o.hideRowsCollection;for(t||(t=1),r=t,len=f.length;r<len;r++)u[r]=u[r-1]+(s.indexOf(r-1)>-1?0:f[r-1]);u[u.length-1]=u[u.length-2]+(s.indexOf(f.length-1)===-1?f[f.length-1]:0);!i&&e.model.scrollSettings.allowScrolling&&(e.model.scrollSettings.allowVirtualScrolling&&e._refreshVrtlBlocks(n),this._refreshScroller(n,"refresh","vertical"))},_createScroller:function(i,r,u){var f=this.XLObj,e=!0,l=f._getContent(i),h=t.buildTag("div#vscrollBar"),o=t.buildTag("div#hscrollBar"),s=f.getSheet(i),c=f.model.scrollSettings.isResponsive?r.width-2:r.width;s._contWidth=c-18;f.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal&&(s._contWidth>f._getEntireColWidth(i)&&(e=!1),o[0].style.display=e?"block":"none");l.append(h).append(o);f._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").width(s._contWidth).height(r.height-(e?18:0));h.ejScrollBar({orientation:"vertical",height:r.height-(e?18:0),minimum:0,viewportsize:r.height,infiniteScrolling:!0,scroll:n.proxy(this._scrollSpreadY,this)});o.ejScrollBar({orientation:"horizontal",width:c-17,minimum:0,infiniteScrolling:!0,viewportsize:r.width,scroll:n.proxy(this._scrollSpreadX,this)});u!="initial"&&this._refreshScroller(i,"initial","all")},_hScroller:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n)).find("#hscrollBar").data("ejScrollBar")},_vScroller:function(n){return this.XLObj._getContent(this.XLObj._getSheetIndex(n)).find("#vscrollBar").data("ejScrollBar")},_refreshScroller:function(n,i,r){var c,s,l,h,b,k,nt,a=0,e=this.XLObj,n=e._getSheetIndex(n),o=e.getSheet(n),u=this._hScroller(n),y=o.columnWidth,p=o.rowHeight,f=this._vScroller(n),w=e.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Normal,d=e._getContent(n),g=d.find(".e-content")[0],v;if(w&&u&&f&&d.find("table").length&&(this._refreshContHgt(n),r=r==="horizontal"?"all":r),u&&(r==="all"||r==="horizontal")){if(c=g.offsetWidth,s=e._getWidth(0,o.colCount-1,n)-o._frozenWidth,s<c+2*y&&!w)for(b=Math.floor((c+y*5-s)/y),v=0;v<b;v++)this._createNewColumn(n,{rowIndex:-1,colIndex:-1},{rowIndex:-1,colIndex:-1},"insert"),s=s+y;u._scrollData.handleSpace=c-2*u.model.buttonSize;a=e._isFrozen(e.getFrozenColumns())?e._getColOffsetLeft(o,e.getFrozenColumns())-o._contScrollLeft:0;u._scrollData.handle=Math.floor((c-a)/s*u._scrollData.handleSpace);u._scrollData.handle<15&&(u._scrollData.handle=15);u._scrollData.scrollable=u.model.maximum=s-(c-a);u._scrollData.onePx=u._scrollData.scrollable/(u._scrollData.handleSpace-u._scrollData.handle)||1;u["e-hhandle"].width(u._scrollData.handle);u.model.scrollLeft=u._scrollData.handleSpace-u._scrollData.handle}if(f&&(r==="all"||r==="vertical")){if(l=g.offsetHeight,h=e._getMaxHgt(n,!0,!0)-o._frozenHeight,!w&&h<l+2*p)for(k=Math.floor((l+p*5-h)/p),v=0;v<k;v++)this._createNewRow(n,-1,-1,"insert"),h=h+p;nt=u.element[0].style.display==="none"?0:u.model.buttonSize;f._scrollData.handleSpace=l-2*f.model.buttonSize;a=e._isFrozen(e.getFrozenRows())?e._getRowOffsetTop(o,e.getFrozenRows())-o._contScrollTop:0;f._scrollData.handle=Math.floor((l-a)/h*f._scrollData.handleSpace);f._scrollData.handle<15&&(f._scrollData.handle=15);f._scrollData.scrollable=f.model.maximum=h-(l-a);f._scrollData.onePx=f._scrollData.scrollable/(f._scrollData.handleSpace-f._scrollData.handle);f["e-vhandle"].height(f._scrollData.handle);f.model.scrollTop=f._scrollData.handleSpace-f._scrollData.handle}},_refreshContHgt:function(n){var t,i,e,l,o="px",a="none",v="block",y="width",f="height",r=this.XLObj,p=r.getSheet(n),u=r._getEntireColWidth(n),s=r._getContent(n),h=s.find(".e-content"),c=s.find("#hscrollBar")[0].style;t=h[0].offsetHeight;i=c.display===a&&p._contWidth<u;(i||c.display===v&&p._contWidth>u)&&(c.display=i?v:a,t=i?t-18:t+19,i=!0);i&&(l=t-2*this._vScroller(n).model.buttonSize+o,t+=o,e=s.find("#vscrollBar"),h[0].style[f]=t,r._getJSSheetRowHeaderContent(n)[0].style[f]=t,e[0].style[f]=t,e.find(".e-vhandlespace")[0].style[f]=l);u+=o;h.find("table")[0].style[y]=u;r._getJSSheetHeader(n).find("table")[0].style[y]=u},_changeTopSpread:function(n,t,i,r){var f=n.value(),u=f+i;t.step=i;(t.enableRTL?u<t.scrollable:u>t.scrollable)&&(u=t.scrollable);(t.enableRTL?u>0:u<0)&&(u=0);n.scroll(u,r)},_spreadMouseWheel:function(i){var r=this.XLObj,e,f=this._vScroller(r.getActiveSheetIndex()),u,o;t.isNullOrUndefined(f)||(r._filterClose(i.target),i.stopImmediatePropagation(),i.preventDefault(),r.element.find(".e-excelfilter.e-dlgcontainer").is(":visible")||r._isSubMenuOpen()||r._isSheetRename)||(r.model.allowComments&&r.XLComment._isCommentEdit&&(e=r.getActiveCell(),t.isNullOrUndefined(e)||r.XLComment._updateCurCmntVal({rowIndex:e.rowIndex,colIndex:e.colIndex})),r.model.allowDataValidation&&n("#"+r._id+"ddl").ejDropDownList("hidePopup"),u=0,o=i,i=i.originalEvent,i.wheelDelta?(u=-i.wheelDelta/120,window.opera&&parseFloat(window.opera.version,10)<10&&(u=-u)):i.detail&&(u=i.detail/3),u)&&(this._changeTopSpread(f,f._scrollData,u*f._scrollData.scrollOneStepBy,"wheel")&&(i.preventDefault?i.preventDefault():o.preventDefault()),n.data(this,"timer",setTimeout(function(){r._trigger("scrollStop",{originalEvent:i,scrollData:f._scrollData,reqType:"vertical",position:f.model.value})},250)))},_scrollSpreadX:function(n){var t=this.XLObj;t.getSheet()._isFreezed&&t._isFrozen(t.getFrozenColumns())?(t.XLFreeze._frozenScrollHandler(n),this._getFirstColumn(t.getActiveSheetIndex())):this._spreadHS(n)},_scrollDirection:function(n,t){var i=this.XLObj,n=i._getContent(i.getActiveSheetIndex()).find("#"+n).ejScrollBar("instance");n.value()<t?n._scrollData.step=1:n.value()>t&&(n._scrollData.step=-1);n.scroll(t)},_spreadHS:function(n){var e,i=this.XLObj,u=i.getActiveSheetIndex(),r=i.getSheet(u),f=this._hScroller(u),o=i._getContent(u),s=o.find(".e-content"),c=o.find("col"),r=i.getSheet(u),h=(n.scrollLeft-r._scrollLeft)/r.columnWidth;if(n.reachedEnd=Math.ceil(parseFloat(f.element.find(".e-hhandle").css("left")))+Math.ceil(parseFloat(f.element.find(".e-hhandle").width()))>=i.element.find(".e-hhandlespace").width()-2,e=n.scrollLeft,i.model.enableContextMenu&&i.XLCMenu.hideCMenu(),i.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.scrollData.step>-1&&!i._scrollReverse)if(n.reachedEnd&&r._leftCol.idx+h<=r.colCount)n.cancel=!0,this._scrollRight(u),e=(f._scrollData.handleSpace-f._scrollData.handle)*f._scrollData.onePx,this._refreshScroller(u,"refresh","horizontal"),f.element.find(".e-hhandle").css("left",f._scrollData.handleSpace-(f._scrollData.handle+1)),f.value(e);else if(r._leftCol.idx+h>r.colCount&&n.scrollLeft>=r._scrollLeft&&n.scrollLeft>0&&r.colCount<i._maxColCnt){while(n.scrollLeft>r._colWidthCollection[r._colWidthCollection.length-1])this._scrollRight(u);this._refreshScroller(u,"refresh","horizontal")}r._scrollLeft=n.scrollLeft=e;i._scrollReverse=!1;s.scrollLeft(n.scrollLeft);r._scrollLeft=s.scrollLeft();f.value(n.scrollLeft);this._getFirstColumn(u);i._refreshViewVar(null,n.scrollLeft,u)},_scrollSpreadY:function(n){var u,f,h,c,e,s=0,i=this.XLObj,r=i.getActiveSheetIndex(),o=i.getSheet(r);o._isFreezed&&i._isFrozen(i.getFrozenRows())?(i.XLFreeze._frozenScrollHandler(n),this._getFirstRow(i.getActiveSheetIndex())):(c=i.getDigits(o._bottomRow.idx),this.XLObj.model.scrollSettings.allowVirtualScrolling?this._scrollHandler(n):this._spreadVS(n),this.XLObj.model.allowComments&&this.XLObj.XLComment._isCommentEdit&&(e=this.XLObj.getActiveCell(),t.isNullOrUndefined(e)||this.XLObj.XLComment._updateCurCmntVal({rowIndex:e.rowIndex,colIndex:e.colIndex})),u=i.getDigits(o._bottomRow.idx),h=u-c,h&&(u>3&&(s=(u-3)*10),f=i._rowHeaderWidth+s,i._getJSSheetRowHeaderContent(r).find("col").width(f),i._getJSSheetRowHeader(r).width(f),i._getJSSheetHeader(r).find(".e-spreadsheetcolumnheader").width(f-1),i._getJSSheetContent(r).find(".e-spreadsheetcontentcontainer > .e-content").width(o._contWidth-s)))},_scrollHandler:function(n){var y,c,s,h,p,f,l,k,w,b,d,a,e=hgt=height=0,o=isRefreshed=!1,r=this.XLObj,u=r.getActiveSheetIndex(),i=r.getSheet(u),tt=r.getActiveCell(u),g=n.scrollTop>=i._scrollTop,it=this._vScroller(u),nt=(n.scrollTop-i._scrollTop)/i.rowHeight+1,v=r._getContent(u).find(".e-content");if(n.scrollTop===i._scrollTop||i._bottomRow.idx+nt>i.rowCount){if(g&&n.scrollTop>0&&r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&i.rowCount<r._maxRowCnt){s=i.rowCount;do{i._virtualBlockCnt++;i.rowCount+=i._virtualBlockRowCnt;for(y in i._columnStyles)for(c=i._virtualBlockRowCnt;c<i.rowCount;)r.XLEdit._updateDataContainer({rowIndex:c,colIndex:parseInt(y)},{dataObj:i._columnStyles[y]}),c++;while(e<i._virtualBlockRowCnt)i.rowsHeightCollection.push(i.rowHeight),i.hideRowsCollection.indexOf(s)===-1&&i._hiddenFreezeRows.indexOf(s)===-1?(i._rowIdxColl.push(s),hgt=i._rowHeightCollection[i._rowHeightCollection.length-1]+i.rowHeight,i._virtualTBodyHgt+=i.rowHeight):hgt=i._rowHeightCollection[i._rowHeightCollection.length-1],i._rowHeightCollection.push(hgt),s++,e++;e=0}while(n.scrollTop+i._virtualBlockRowCnt*i.rowHeight>i._rowHeightCollection[i._rowHeightCollection.length-1]);this._refreshScroller(u,"refresh","vertical");i._scrollTop=n.scrollTop;r._refreshViewport(n.scrollTop,u);v.scrollTop(n.scrollTop);i._scrollTop=v.scrollTop();o=!0}}else prop=["value","value2","comment","hyperlink","format","border","type","isFilterHide","filterState","isMHide","isFHide","merge","isFilterHeader","isFilterVisible","text","general","cFormatRule","wrap","wrapRow","rule","align","isOverflow","isOfBrdr","altTxt"],p=r._getRowHdrTBody(u),h=r._getContTBody(u),g?(n.scrollTop>=i._virtualContTBodyOffset.bottom&&n.scrollTop<=i._virtualBottomTBodyOffset.bottom?(height=i._virtualTopTBodyOffset.bottom-i._virtualTopTBodyOffset.top,i._virtualTopTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualBottomTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualBottomTBodyOffset.bottom,i._virtualContBlockIdx++,i._virtualContBlockIdx===i._virtualBlockCnt?(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom=0,i._isVirtualEndReached=!0):(i._virtualBottomTBodyOffset.top=i._virtualBottomTBodyOffset.bottom,k=r._getRowIdx(i._virtualContBlockIdx*i._virtualBlockRowCnt,u,!0),w=r._getRowIdx(i._virtualContBlockIdx*i._virtualBlockRowCnt+(i._virtualBlockRowCnt-1),u,!0),i._virtualBottomTBodyOffset.bottom=r._getRowOffsetBottom(w,u),a=i._rowIdxColl.slice(i._rowIdxColl.indexOf(k),i._rowIdxColl.indexOf(w)+1),f=r.getRangeData({property:prop,sheetIdx:u,rowIdxs:a,withRowIdx:!0}),p.append(r._renderRowHdr(f.rowIdx,u)),h.append(r._renderData(f,u)),i._virtualRowIdx=i._virtualRowIdx.concat(f.rowIdx),o=!0),i._isVirtualTopReached||(r._removeRange(0,i._virtualBlockRowCnt),i._virtualRowIdx.splice(0,i._virtualBlockRowCnt),i._virtualTopTBodyHgt+=height),i._virtualBottomTBodyHgt=i._virtualTBodyHgt-(i._virtualTopTBodyHgt+h.height()),r._refreshTBodiesHgt(),i._isVirtualTopReached=!1):!i._isVirtualEndReached&&n.scrollTop>=i._virtualBottomTBodyOffset.bottom&&(r._refreshViewport(n.scrollTop,u),o=isRefreshed=!0),r.model.allowCellType&&r.XLCellType._rangeCellTypes(i.cellTypes,u)):n.scrollTop+n.model.viewportsize<i._virtualContTBodyOffset.top&&n.scrollTop+n.model.viewportsize>=i._virtualTopTBodyOffset.top?(height=i._virtualBottomTBodyOffset.bottom-i._virtualBottomTBodyOffset.top,i._virtualBottomTBodyOffset.top=i._virtualContTBodyOffset.top,i._virtualBottomTBodyOffset.bottom=i._virtualContTBodyOffset.bottom,i._virtualContTBodyOffset.top=i._virtualTopTBodyOffset.top,i._virtualContTBodyOffset.bottom=i._virtualTopTBodyOffset.bottom,i._virtualContBlockIdx--,i._virtualTopTBodyOffset.bottom=i._virtualContTBodyOffset.top,i._virtualContBlockIdx===1?(i._virtualTopTBodyOffset.top=0,i._isVirtualTopReached=!0):(b=r._getRowIdx((i._virtualContBlockIdx-2)*i._virtualBlockRowCnt,u,!0),d=r._getRowIdx((i._virtualContBlockIdx-2)*i._virtualBlockRowCnt+(i._virtualBlockRowCnt-1),u,!0),i._virtualTopTBodyOffset.top=r._getRowOffsetTop(i,b),a=i._rowIdxColl.slice(i._rowIdxColl.indexOf(b),i._rowIdxColl.indexOf(d)+1),f=r.getRangeData({property:prop,sheetIdx:u,rowIdxs:a,withRowIdx:!0}),p.prepend(r._renderRowHdr(f.rowIdx,u)),h.prepend(r._renderData(f,u)),i._virtualRowIdx=f.rowIdx.concat(i._virtualRowIdx),o=!0),i._isVirtualEndReached||(r._removeRange(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualRowIdx.splice(i._virtualContBlockIdx===1?2*i._virtualBlockRowCnt:3*i._virtualBlockRowCnt,i._virtualBlockRowCnt),i._virtualBottomTBodyHgt+=height),i._virtualTopTBodyHgt=i._virtualTBodyHgt-(i._virtualBottomTBodyHgt+h.height()),r._refreshTBodiesHgt(),i._isVirtualEndReached=!1,r.model.allowCellType&&r.XLCellType._rangeCellTypes(i.cellTypes,u)):!i._isVirtualTopReached&&n.scrollTop+n.model.viewportsize<=i._virtualTopTBodyOffset.top&&(r._refreshViewport(n.scrollTop,u),o=isRefreshed=!0),isRefreshed||r._refreshViewVar(n.scrollTop,null,u),i._scrollTop=n.scrollTop;if(v.scrollTop(n.scrollTop),i._scrollTop=v.scrollTop(),this._getFirstRow(u),r.model.allowSelection&&(i._isRowSelected||i._isColSelected||i._isSheetSelected)&&(r.XLSelection.refreshSelection(),r.XLDragFill.positionAutoFillElement()),o){for(r.XLComment&&r.XLComment._updateCmntArrowPos(r._getContent(u).find(".e-commentcell")),l=r.getObjectKeys(r._dataContainer.sheets[u][0]),r._dupDetails=!0,e=0,len=l.length;e<len;e++)fitWidth=r.XLEdit.getPropertyValue(0,l[e],"isFitWidth"),t.isNullOrUndefined(fitWidth)||r.XLResize._fitWidth(l[e]);r._dupDetails=!1}},_spreadVS:function(n){var e,r=this.XLObj,f=r.getActiveSheetIndex(),u=r.getSheet(f),i=this._vScroller(f),h=r._getJSSheetContent(f).find(".e-spreadsheetcontentcontainer > .e-content"),c=(n.scrollTop-u._scrollTop)/u.rowHeight;if(n.reachedEnd=Math.ceil(parseFloat(i.element.find(".e-vhandle").css("top")))+Math.ceil(parseFloat(i.element.find(".e-vhandle").height()))>=i.element.find(".e-vhandlespace").height()-2,e=n.scrollTop,r.model.enableContextMenu&&r.XLCMenu.hideCMenu(),r.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&n.scrollData.step>-1&&!r._scrollReverse)if(n.reachedEnd&&u._bottomRow.idx+c<=u.rowCount){var l=!1,a=!1,s=this,o;!r.isUndefined(n.scrollData.target)&&r._hasClass(n.scrollData.target,"e-vdown")&&(o=setInterval(function(){l=!0;for(var n=0;n<20;n++)s._scrollBottom(f);e=(i._scrollData.handleSpace-i._scrollData.handle)*i._scrollData.onePx;s._refreshScroller(f,"refresh","vertical");i.element.find(".e-vhandle").css("top",i._scrollData.handleSpace-i._scrollData.handle);i.scroll(e);clearInterval(o);return},1e3),r._browserDetails.name==="msie"&&r._browserDetails.version==="8.0"?(i.element.find(".e-vdown")[0].attachEvent("onmouseup",function(){clearInterval(o);return}),document.attachEvent("onmouseup",function(){clearInterval(o);return})):(i.element.find(".e-vdown")[0].addEventListener("mouseup",function(){clearInterval(o);return}),document.addEventListener("mouseup",function(){clearInterval(o);return})),a=!0);n.cancel=!0;l&&a||(this._scrollBottom(f,(n.scrollTop-u._scrollTop)/20+1),e=(i._scrollData.handleSpace-i._scrollData.handle)*i._scrollData.onePx,s._refreshScroller(f,"refresh","vertical"),i.element.find(".e-vhandle").css("top",i._scrollData.handleSpace-i._scrollData.handle),i.value(e))}else u._bottomRow.idx+c>u.rowCount-1&&n.scrollTop>=u._scrollTop&&n.scrollTop>0&&u.rowCount<r._maxRowCnt&&(this._scrollBottom(f,(n.scrollTop-u._scrollTop)/20+1),this._refreshScroller(f,"refresh","vertical"));n.scrollTop=u._scrollTop=e;r._scrollReverse=!1;h.scrollTop(n.scrollTop);u._scrollTop=h.scrollTop();this._getFirstRow(f)},_scrollX:function(i){var f,u=this.XLObj,r=this._hScroller(i),e,o=[1],h=u._getContent(i).find("colgroup"),s=u.getSheet(i);for(u.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollRight(i),r.model.maximum=r.model.maximum+s.columnWidth,r._scrollData.scrollable=r._scrollData.scrollable+s.columnWidth,this._refreshScroller(i,"refresh","horizontal"),r.element.find(".e-hhandle").css("left",r._scrollData.handleSpace-(r._scrollData.handle+1)),e=(r._scrollData.handleSpace-r._scrollData.handle)*r._scrollData.onePx,r.value(e),f=0,len=u.model.sheets[i]._fCol;f<len;f++)o.push(o[o.length-1]+n(h.find("col")[f]).width());u._scrollContent({x:e});s._scrollLeft=e;this._getFirstColumn(i)},_scrollY:function(i){var f,u=this.XLObj,r=this._vScroller(i),e,o=[1],s=u.getRows(i)[1];for(u.model.scrollSettings.scrollMode===t.Spreadsheet.scrollMode.Infinite&&this._scrollBottom(i),r.model.maximum=r.model.maximum+u.model.rowHeight,r._scrollData.scrollable=r._scrollData.scrollable+u.model.rowHeight,this._refreshScroller(i,"refresh","vertical"),r.element.find(".e-vhandle").css("top",r._scrollData.handleSpace-(r._scrollData.handle+1)),e=(r._scrollData.handleSpace-r._scrollData.handle)*r._scrollData.onePx,r.value(e),f=0,len=u.model.sheets[i]._fRow;f<len;f++)o.push(o[o.length-1]+n(s[f]).height());u._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer > .e-content").scrollTop(e,r._scrollData.onePx);this._getFirstRow(i)},_sortProcess:function(n,i){for(var u=0,f=n.length-1,r,e;u<=f;){if(r=(u+f)/2|0,e=n[r],e<i){if(n[r+1]>=i)return r+1;u=r+1}else if(e>i){if(n[r-1]<i)return r;f=r-1}else return r;if(t.isNullOrUndefined(n[r+1]))return r-2}},_getFirstRow:function(n){var i=this.XLObj,t=i.getSheet(n),r,u,f,e=t._rowHeightCollection;r=i._getContent(n).find(".e-content").scrollTop();u=this._sortProcess(e,r);t._topRow={idx:u,value:e[u]};f=i._getIdxWithOffset(r+t._vPortHgt,null,!0,null,n).rowIdx||t.rowCount-1;t._bottomRow={idx:f,value:e[f]};t.topLeftCell=i.getAlphaRange(t._topRow.idx,t._leftCol.idx)},_getFirstColumn:function(n){var i=this.XLObj,t=i.getSheet(n),r,u,f,e=t._colWidthCollection;r=i._getContent(n).find(".e-content").scrollLeft();u=this._sortProcess(e,r);t._leftCol={idx:u,value:e[u]};f=i._getIdxWithOffset(null,r+t._vPortWth,!0,null,n).colIdx||t.colCount-1;t._rightCol={idx:f,value:e[f]};t.topLeftCell=i.getAlphaRange(t._topRow.idx,t._leftCol.idx)},scrollToCell:function(n){var t=this.XLObj,r=t.getRangeIndices(n),i=t.getSheet(t.getActiveSheetIndex()),u=i.rowHeight,f=i.columnWidth;t._scrollContent({x:r[1]*f-i._scrollLeft,y:r[0]*u-i._scrollTop})},_scrollSelectedPosition:function(n,t){if(!this.XLObj._isExport){var s,h,c=0,u=this.XLObj,r=this._hScroller(n),f=this._vScroller(n),i=u._getCellInfo(t),e=u.getSheet(n),o=u._getJSSheetContent(n).find(".e-spreadsheetcontentcontainer > .e-content"),l=u._dupDetails,a=Math.ceil(parseFloat(f.element.find(".e-vhandle").css("top")))+f._scrollData.handle>=f._scrollData.handleSpace,v=Math.ceil(parseFloat(r.element.find(".e-hhandle").css("left")))+r._scrollData.handle>=r._scrollData.handleSpace;u.isUndefined(r)||(s=i.left-(r._scrollData.handleSpace+r.model.buttonSize),s<0?r.scroll(0):(v&&(u._scrollReverse=!0),(parseInt(i.width)+i.left>r._scrollData.handleSpace+r.model.buttonSize*2||i.left-o.offset().left<=0)&&s!=0&&r.scroll(i.left+i.width+1-(r._scrollData.handleSpace+r.model.buttonSize*2)),u._scrollReverse=!1));u.isUndefined(f)||(parseInt(i.height)+(i.top-o.offset().top)>o.height()||i.top-o.offset().top<=0)&&(t.rowIndex<e._topRow.idx||t.rowIndex>e._bottomRow.idx)&&(!t.rowIndex<e._bottomRow.idx&&t.rowIndex<e.rowCount-1&&(c=i.height),h=i.top+c-(f._scrollData.handleSpace+f.model.buttonSize),h<0?f.scroll(0):(a&&(u._scrollReverse=!0),f.scroll(i.top+i.height+1-(f._scrollData.handleSpace+f.model.buttonSize*2)),u._scrollReverse=!1));u._dupDetails=l}},_rowTemplate:function(n,t){for(var i,e="",u=this.XLObj,o=u.getSheet(n),r=0,f=u.model.sheets[n].colCount;r<f;r++)i="e-rowcell",o.showGridlines||(i=i.concat(" e-hborder")),o._hiddenFreezeCols.indexOf(r)>-1&&(i+=" e-fcol-hide"),e+=String.format('<td class="{0}" style="{2}"  >{1}<\/td>',i,"");return String.format("<tr style='{0}' idx=\"{1}\">"+e+"<\/tr>","height:"+u.model.rowHeight+"px;",t-1)},_rowHeaderTemplate:function(n,t){var i,t=t?t:this.XLObj.model.rowHeight;return i=String.format('<td class="{0}"  >{1}<\/td>',"e-rowheader",n),String.format("<tr style='{0}' idx=\"{1}\">"+i+"<\/tr>","height:"+t+"px;",n-1)},_columnTemplate:function(){var n="e-rowcell e-wrapword",t=this.XLObj,i=t.getActiveSheetIndex();return t.getSheet(i).showGridlines||(n=n.concat(" e-hborder")),String.format('<td class="{0}" style="{2}" >{1}<\/td>',n,"")},_colGroupTemplate:function(n,t){var t=t?t:this.XLObj.getSheet(n).columnWidth;return String.format("<col style = '{0}'><\/col>","width:"+t+"px;")},_columnHeaderTemplate:function(n){var t,i;return t=this.XLObj._generateHeaderText(n),i=String.format('<div class = "{0}" > {1}<\/div>',"e-headercelldiv",t),String.format('<th class="{0}"  >{1}<\/th>',"e-headercell",i)},_createNewRow:function(t,i,r,u){var s,h,l,e,a,f=this.XLObj,y=f.model.scrollSettings.allowVirtualScrolling,p=f.XLSelection,o=f.getSheet(t),c,v;if(y?(s=f._getContent(t).find("tbody")[1],e=f._getJSSheetRowHeaderContent(t).find("tbody")[1]):(s=f._getContent(t).find("tbody")[0],e=f._getJSSheetRowHeaderContent(t).find("tbody")[0]),l=this._rowTemplate(t,parseInt(e.lastChild.textContent)+1),i===-1||r>-1&&i>-1&&u==="shift"?(n(e).append(this._rowHeaderTemplate(parseInt(e.lastChild.textContent)+1)),n(s).append(l),u=="shift"&&(n(s).find("tr:last td:last").remove(),n(s).find("tr: eq(' + rowIdx + ') td:eq(' + (colIdx - 1) + ')").after(this._columnTemplate()))):(h=s.insertRow(i),n(h).height(f.model.rowHeight),n(h).append(n(l)[0].innerHTML),h=e.insertRow(i),n(h).height(f.model.rowHeight),n(h).append("<td class='e-rowheader'><\/td>")),o.rowCount=f.model.sheets[t].rowCount+1,o.rowsHeightCollection.push(f.model.rowHeight),i>-1){for(a=n(e).find("td"),c=0,v=a.length;c<v;c++)n(a[c]).text(c+1);f.XLScroll._getRowHeights(t,i+1)}o._rowHeightCollection.push(o._rowHeightCollection[o._rowHeightCollection.length-1]+f.model.rowHeight);f.model.allowSelection&&(o._isColSelected||o._isSheetSelected)&&p.refreshSelection();f._refreshRows(t)},_createNewColumn:function(i,r,u,f){var e,o,l,h=this.XLObj,s=h.getSheet(i),st=h.XLSelection,c,d,nt,tt,ft,v,a,p,it,et,ot,rt,w=!1,b,y,ht=s.columnsWidthCollection,ut,k,g;for(c=h._getContTBody(i)[0],d=h._getJSSheetHeader(i).find("tr")[0],nt=h._getJSSheetContent(i).find(".e-spreadsheetcontentcontainer colgroup"),tt=h._getJSSheetHeader(i).find("colgroup"),ft=s.colCount,y=s.filterSettings.tableRange,e=0,l=y.length;e<l;e++)if(rt=y[e].multifilterIdx,r.colIndex>rt[0]&&u.colIndex<rt[rt.length-1]){w=!0;b=y[e].startRow-1;y=y[e];break}if(r.colIndex===-1||r.colIndex>-1&&r.rowIndex>-1&&f==="shift"){if(r.colIndex===-1&&f==="insert"){for(p=this._columnHeaderTemplate(ft+1,i),n(d).append(p),v=this._colGroupTemplate(i),tt.append(v),e=0,l=c.rows.length;e<l;e++)a=this._columnTemplate(e),n(c.rows[e]).append(a);nt.append(v)}if(f==="shift"){for(ut=ft,e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(ut+1,i),n(d).append(p),v=this._colGroupTemplate(i),tt.append(v),nt.append(v),ut=ut+1;for(e=0,l=c.rows.length;e<l;e++)for(o=r.colIndex;o<=u.colIndex;o++)a=this._columnTemplate(e),n(c.rows[e]).append(a);if(h._insDelStatus.indexOf("insert")>-1)for(e=r.rowIndex;e<=u.rowIndex;e++)for(o=r.colIndex;o<=u.colIndex;o++)n(c).find("tr:eq("+e+") td:last").remove(),a=this._columnTemplate(e),n(c).find("tr").eq(e).find("td:eq("+o+")").before(a),w&&e===b&&h.model.allowFiltering&&h.XLFilter._insertFilterIcon(e,o,y,b,w);else for(e=r.rowIndex;e<=u.rowIndex;e++)for(o=u.colIndex;o>=r.colIndex;o--)n(c).find("tr:eq("+e+") td:eq("+o+")").remove(),a=this._columnTemplate(e),n(c).find("tr:eq("+e+")").append(a),w&&e===b&&h.model.allowFiltering&&h.XLFilter._insertFilterIcon(e,o,y,b,w)}s.colCount=s.colCount+1;s.columnsWidthCollection.push(s.columnWidth)}else{if(s._isTemplate&&(r.colIndex<s._templateColCount||u.colIndex<s._templateColCount))return;if(g=n.extend(!0,[],h.getSheet(i).columnsWidthCollection),h._insDelStatus.indexOf("insert")>-1){for(k=g.splice(0,r.colIndex),e=r.colIndex;e<=u.colIndex;e++)p=this._columnHeaderTemplate(e+1,i),n(d).find("th:eq("+e+")").before(p),v=this._colGroupTemplate(i),k.push(s.columnWidth),tt.find("col:eq("+e+")").before(v),nt.find("col:eq("+e+")").before(v);for(t.merge(k,g),s.columnsWidthCollection=k,e=0,l=c.rows.length;e<l;e++)for(o=r.colIndex;o<=u.colIndex;o++)a=this._columnTemplate(e),n(c.rows[e]).find("td:eq("+o+")").before(a),w&&e===b&&h.model.allowFiltering&&h.XLFilter._insertFilterIcon(e,o,y,b,w);s.colCount=s.colCount+1}else{for(k=g.splice(0,r.colIndex),e=u.colIndex;e>=r.colIndex;e--)n(d).find("th:eq("+e+")").remove(),tt.find("col:eq("+e+")").remove(),nt.find("col:eq("+e+")").remove();for(g.splice(0,u.colIndex-r.colIndex+1),t.merge(k,g),s.columnsWidthCollection=k,e=0,l=c.rows.length;e<l;e++)for(o=u.colIndex;o>=r.colIndex;o--)n(c.rows[e]).find("td:eq("+o+")").remove();s.colCount=s.colCount-1}for(et=n(d).find("th>.e-headercelldiv"),e=0,l=et.length;e<l;e++)n(et[e]).text(h._generateHeaderText(e+1))}ot=n.trim(n(p).text());it=n(a).text();s.columns.push({field:ot,type:it!=null?it.getDay?"date":typeof it:null,width:n(a).width()});h.XLScroll._getColWidths(i,r.colIndex>-1?r.colIndex:s.colCount-2);h.model.allowSelection&&(s._isRowSelected||s._isSheetSelected)&&st.refreshSelection();h._refreshTemplates(i,!0)},_insertColHeaders:function(t,i,r){var f=this._columnHeaderTemplate(i+1,t),u;n(r).append(f);u=this._colGroupTemplate(t);n(r.parentNode.previousSibling).append(u)},_scrollBottom:function(n,t){var i=this.XLObj.getSheet(n),r,u;if(t)this._createRows(i.rowCount-1,i.rowCount+t,n);else{this._createNewRow(n,-1,-1,"insert");for(r in i._columnStyles)u=parseInt(r),this.XLObj.XLEdit._updateDataContainer({rowIndex:i.rowCount-1,colIndex:u},{dataObj:i._columnStyles[r]})}},_createRows:function(n,t,i){for(var r=this.XLObj,i=i||r.getActiveSheetIndex(),e=r.getSheet(i),o=r.getSheetElement(i),u=n,f=t;u<f;u++)this._createNewRow(i,-1,-1,"insert")},_scrollRight:function(n){var r={rowIndex:-1,colIndex:-1},t,u,i;this._createNewColumn(n,r,r,"insert");t=this.XLObj.getSheet(n);for(i in t._rowStyles)u=parseInt(i),this.XLObj.XLEdit._updateDataContainer({rowIndex:u,colIndex:t.colCount-1},{dataObj:t._rowStyles[i]})},_refreshRowCol:function(n,t){t=this.XLObj._getSheetIndex(t);var i,r=this.XLObj.getSheet(t),u=!1;if(r.colCount<n[3]+1){for(i=n[3]-(r.colCount-1);i--;)this._scrollRight(t);u=!0}if(r.rowCount<n[2]+1){for(i=n[2]-(r.rowCount-1);i--;)this._scrollBottom(t);u=!0}u&&this._refreshScroller(t,"refresh","all")}}}(jQuery,Syncfusion),function(n,t){t.spreadsheetFeatures=t.spreadsheetFeatures||{};t.spreadsheetFeatures.pivot=function(n){this.XLObj=n;this._pivotCnt=1;this._hasPvtField=!1;this._displayActPanel=!0;this.names={}};t.spreadsheetFeatures.pivot.prototype={createPivotTable:function(t,i,r,u,f){var e=this.XLObj,c;if(e.model.enablePivotTable&&!e.model.isReadOnly){var l=e.XLRibbon,h=e.getActiveSheetIndex(),s=[],a,v,o,y=0,p=0,w;if(e._showDialog(e._id+"_Ribbon_Insert_Tables_PivotTable"),o=l._getAddrFromDollarAddr(t),a=e.model.sheets[o[0]].sheetInfo.text,t=e.getRangeIndices(o[1]),v=e.getRangeDataAsJSON({rowIndex:t[0],colIndex:t[1]},{rowIndex:t[2],colIndex:t[3]},!1,o[0]),n("#"+e._id+"_dlg_existsheet").data("ejRadioButton").model.checked||e.isImport||!e.getSheet(h)._isLoaded?(o=l._getAddrFromDollarAddr(i),s=e.getRangeIndices(o[1]),e._isExport||h===o[0]||(e.gotoPage(o[0],!1),h=o[0])):(e.insertSheet(),h=e.getActiveSheetIndex(),s=[2,0]),e.isUndefined(f)&&(f={}),p=e.model.sheets[o[0]]._rowHeightCollection[s[0]],y=e.model.sheets[o[0]]._colWidthCollection[s[1]],e.hideActivationPanel(),r&&r.length){if(e.getObjectKeys(this.names).indexOf(r)>-1)do r=r+this._pivotCnt,this._pivotCnt++;while(e.getObjectKeys(this.names).indexOf(r)>-1)}else do r="PivotTable"+this._pivotCnt,this._pivotCnt++;while(e.getObjectKeys(this.names).indexOf(r)>-1);return c=e._id+"_"+r,this.names[c]=r,f.pvtRange=s,f.sheetIdx=h,f.temp=o[0],f.datasource=v,e.getSheet(h)._isUpdated||this._updatePivotMngr({},{pivot:{id:c,top:p,left:y,rowIndex:s[0],colIndex:s[1],dataRange:t,dataSheetName:a,sheetIdx:h}}),this._refreshPivotElement(t,i,r,u,f),w=e.element.find("#"+c).data("ejPivotGrid"),this._refreshRowColumn(s,w),e.showActivationPanel(),c}},_refreshRowColumn:function(n,t){var u=this.XLObj,f=[],r,t,i,e;for(r=t._rowCount,e=t.calculateCellWidths().rowHeight,f=t.calculateCellWidths().columnWidths,colCount=f.length,r||(r=4),i=n[0];i<r+n[0];i++)u.XLResize.setRowHeight(i,e);if(colCount>0)for(i=0;i<colCount+n[1];i++)u.XLResize.setColWidth(i+n[1],f[i]);else for(i=0;i<3+n[1];i++)u.XLResize.setColWidth(i+n[1],81)},_refreshPivotElement:function(i,r,u,f,e){var o=this.XLObj,s,h,c,l,a;l=o.model.sheets[e.sheetIdx]._rowHeightCollection[e.pvtRange[0]];a=o.model.sheets[e.sheetIdx]._colWidthCollection[e.pvtRange[1]];c={dataSource:{data:e.datasource},enableToolTipAnimation:!1,cellDoubleClick:n.proxy(this._cellDblClick,this),enableCellDoubleClick:!0,renderSuccess:n.proxy(this._renderSuccess,this),drillSuccess:n.proxy(this._renderSuccess,this)};t.isNullOrUndefined(f)||(c.dataSource={data:e.datasource,rows:f.rows,columns:f.columns,values:f.values,filters:f.filters});o.getSheetElement(o.getActiveSheetIndex()).find(".e-ss-activepivot").removeClass("e-ss-activepivot");s=t.buildTag("div.e-ss-pivot","","",{id:o._id+"_"+u});s.css({left:a-2,top:l-2}).addClass("e-ss-activepivot");o._getContent(e.sheetIdx).find(".e-content").append(s);this._hasPvtField||o.getActivationPanel().append(t.buildTag("div","",{overflow:"hidden"},{id:o._id+"_PivotField"}));o.element.find("#"+o._id+"_PivotField").append(t.buildTag("div.e-ss-pivotfield","","",{id:o._id+"_PivotTableSchema_"+o._id+"_"+u}));h=o.element.find("#"+o._id+"_PivotTableSchema_"+o._id+"_"+u);o.getActivationPanel().find("#"+h[0].id).show();s.ejPivotGrid(c);h.find("#schemaFieldTree").data("ejTreeView").option("allowDragAndDrop",!1);h.css({float:"left",width:o.model.activationPanelWidth-20});h.find(".schemaFieldList").css({height:150});this._hasPvtField||(o.getActivationPanel().ejScroller({width:o.model.activationPanelWidth,height:o._getContent(e.sheetIdx).height(),scroll:n.proxy(this._pivotScroll,this)}),this._hasPvtField=!0);this._clearBackgroundData(s.data("ejPivotGrid"),o.getSheet(e.sheetIdx).pivotMngr.pivot[s[0].id],e.sheetIdx,"update");o.XLRibbon&&o.XLRibbon._analyzeTabUpdate();o.XLSelection._cleanUp(!0);o.getActivationPanel().data("ejScroller").refresh()},deletePivotTable:function(n){var u=this._getPivotIDFromName(n),t=this.XLObj,f,e=t._dataContainer,r,i;if(t.model.enablePivotTable&&!t.model.isReadOnly)for(i=1,len=t.model.sheetCount;i<=len;i++)t._getContent(i).find("#"+u).length&&(r=t.getSheet(i).pivotMngr.pivot[u],f=e.sheets[i][r.rowIndex][r.colIndex],t.getObjectLength(f)<2&&f.pivot.length<2?delete e.sheets[i][r.rowIndex][r.colIndex]:f.pivot.length<2&&delete e.sheets[i][r.rowIndex][r.colIndex].pivot,delete t.getSheet(i).pivotMngr.pivot[u],t._getContent(i).find("#"+u).remove(),t.hideActivationPanel(),t.getActivationPanel().find("#"+t._id+"_PivotTableSchema_"+u).remove(),t.XLRibbon._toggleAnalyzeTab())},refreshDataSource:function(n,t){var i=this.XLObj,r,f,e,u,o;i.model.enablePivotTable&&!i.model.isReadOnly&&(n&&t?(r=i.element.find("#"+i._id+"_"+n),r&&(f=r[0].id)):(t=i.getActiveSheetIndex(),r=i._getContent(t).find(".e-ss-activepivot"),f=r[0].id),e=r.data("ejPivotGrid"),e&&(u=i.getSheet(t).pivotMngr.pivot[f].dataRange,o=i.getRangeDataAsJSON({rowIndex:u[0],colIndex:u[1]},{rowIndex:u[2],colIndex:u[3]},!1,i._getSheetIndexByName(i.getSheet(t).pivotMngr.pivot[f].dataSheetName)),e.model.dataSource.data=o,e.refreshPivotGrid()))},clearPivotFieldList:function(n){var t=this.XLObj,i=this._getPivotIDFromName(n);t.model.enablePivotTable&&!t.model.isReadOnly&&this._clearFilters(t.element.find("#"+i).data("ejPivotGrid"),t.getActivationPanel().find("#"+t._id+"_PivotTableSchema_"+i).data("ejPivotSchemaDesigner"))},_cellDblClick:function(n){if(n.selectedData.length){var t=this.XLObj,i=t.XLFormat,r;t.insertSheet();r=t.getActiveSheetIndex();t.updateRange(r,{dataSource:n.selectedData,startCell:"A1",showHeader:!0});i.createTable({header:!0,name:"Table"+t._tableCnt,format:i._getTableLayoutFromName("TableStyleMedium9").format,formatName:"TableStyleMedium9"},"A1:"+t._generateHeaderText(t.getObjectLength(n.selectedData[0]))+(n.selectedData.length+1))}},_dragMove:function(){var i=this.XLObj,t,r=i.getActivationPanel().data("ejScroller"),f=i.element.find(".e-spreadsheetactpanel"),u=f.offset().top;f.height()+u-45<n(".e-dragedNode").offset().top?t=setInterval(function(){f.height()+u-45<n(".e-dragedNode").offset().top&&r.scrollY(r.model.scrollTop+25)},300):u+45>n(".e-dragedNode").offset().top&&(t=setInterval(function(){u+45>n(".e-dragedNode").offset().top&&r.scrollY(r.model.scrollTop-25)},300));i._browserDetails.name==="msie"&&i._browserDetails.version==="8.0"?(n(".e-dragedNode")[0].attachEvent("onmouseup",function(){clearInterval(t)}),document.attachEvent("onmouseup",function(){clearInterval(t)})):(n(".e-dragedNode")[0].addEventListener("mouseup",function(){clearInterval(t)}),document.addEventListener("mouseup",function(){clearInterval(t)}))},_renderSuccess:function(i){i.type==="drillSuccess"&&(i=i.gridObj);var r=this.XLObj,e=r.getActiveSheetIndex(),o,s,u,f=i,h=[];r._isExport||this._clearBackgroundData(i,r.getSheet(e).pivotMngr.pivot[i._id],e,"update");r.element.find("#"+r._id+"_PivotTableSchema_"+i._id).ejPivotSchemaDesigner({pivotControl:i,layout:t.PivotSchemaDesigner.Layouts.Excel,dragMove:n.proxy(this._dragMove,this),fieldItemDropped:n.proxy(this._fieldItemDropped,this)});u=r.getSheet(e).pivotMngr.pivot[i._id];s=f._rowCount;o=f.getJSONRecords().length/f._rowCount;h=[u.rowIndex,u.colIndex,u.rowIndex+s,u.colIndex+o];this._refreshRowColumn(h,f);n(".e-spreadsheet .e-pivotgrid th[role='columnheader'").addClass("e-ss-pivottableheader");n(".e-spreadsheet .e-pivotgrid tr:last th.rgtot").addClass("e-ss-pivottableheader");r.XLDragFill.hideAutoFillElement()},_clearBackgroundData:function(n,t,i,r){var u=this.XLObj,f,e,o,s;f=n.getJSONRecords().length/n._rowCount;e=n._rowCount;o=!e||isNaN(e)?t.rowIndex+17:t.rowIndex+e;s=!f||isNaN(f)?t.colIndex+2:t.colIndex+f-1;r&&r!=="update"?u.getRange([t.rowIndex,t.colIndex,o,s],i).removeClass("e-readOnly"):u.getRange([t.rowIndex,t.colIndex,o,s],i).removeClass("e-readOnly").addClass("e-readonly");u._dupDetails=!0;u.clearRangeData([t.rowIndex,t.colIndex,o,s],["value","value2","hyperlink","cFormatRule","comment","format","formats"],"",!1);u._dupDetails=!1},_fieldItemDropped:function(n){if(n.axis==="filter"){var t=this.XLObj,u=t.getActiveSheetIndex(),r,i;for(i=t._getContent(u).find(".e-ss-activepivot").data("ejPivotGrid"),pivot=t.getSheet(u).pivotMngr.pivot[i._id];pivot.rowIndex<=i.getOlapReport().filters.length;)pivot.rowIndex=pivot.rowIndex+1,r=t.getCell(pivot.rowIndex,pivot.colIndex)[0],i.element.css({left:r.offsetLeft-2,top:r.offsetTop-2})}},_updatePivotMngr:function(t,i){var r=this.XLObj,u=r.getSheet(r.getActiveSheetIndex()).pivotMngr,f=u.pivot;f[i.pivot.id]=n.extend(!0,{},i.pivot);r.XLEdit._updateDataContainer({rowIndex:i.pivot.rowIndex,colIndex:i.pivot.colIndex},{dataObj:{pivot:i.pivot.id}})},_pivotMouseDown:function(t){var i=this.XLObj;t.preventDefault();i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+t.target.id).show();i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").removeClass("e-ss-activepivot");n(t.target).hasClass("e-ss-pivot")?n(t.target).addClass("e-ss-activepivot"):n(t.target).parents("e-ss-object").addClass("e-ss-activepivot");i.XLSelection._cleanUp(!0);i.showActivationPanel()},_pivotScroll:function(t){var i=this.XLObj,r=i.getActivationPanel().find("#"+i._id+"_PivotTableSchema_"+i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id).data("ejPivotSchemaDesigner");t.source==="thumb"&&(n(".e-dragedNode").length||r._isDragging||this.XLObj.XLResize._allowStart)&&(t.cancel=!0)},_pivotMouseUp:function(t){var i=this.XLObj,r=n(t.target),u=n("#"+i._id+"_Ribbon").data("ejRibbon");i.model.showRibbon&&(i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").length&&(r.hasClass("e-ss-pivot")||r.parents(".e-ss-pivot").length)?i.XLRibbon._analyzeTabUpdate():!i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot").length&&(u.model.selectedItemIndex===i.XLRibbon._getTabIndex("analyze")||u.isVisible("Analyze"))&&i.XLRibbon._toggleAnalyzeTab())},_changePvtName:function(){var n=this.XLObj;this.names[n._getContent(n.getActiveSheetIndex()).find(".e-ss-activepivot")[0].id]=n.element.find("#"+n._id+"_Ribbon_Analyze_PivotTable_PivotTableName").val()},_checkRange:function(n,t){var i=this.XLObj,d=i.getActiveCell(),v,y=d.rowIndex,p=d.colIndex,w,r=[],b=i._getContent(i.getActiveSheetIndex()).find(".e-ss-activepivot"),e,u,h,c={isHeader:!1,isRows:!1},k,s,o,g,l,a,nt,tt,f;if(e=i.XLRibbon._getAddrFromDollarAddr(n),v=e[0],r=i.getRangeIndices(e[1]),y=r[0],p=r[1],n.length)for(u=0,h=r[3]-p+1;u<h;u++)w=i.XLEdit.getPropertyValue(y,p+u,"value",v),(i.isUndefined(w)||w=="")&&(c.isHeader=!0);if(y===r[2]&&(c.isRows=!0),t.length)for(e=i.XLRibbon._getAddrFromDollarAddr(t),v=e[0],r=i.getRangeIndices(e[1]),u=1,h=i.model.sheetCount;u<=h;u++)for(k=i.model.sheets[u].pivotMngr.pivot,s=i.getObjectKeys(k),o=0,g=s.length;o<g;o++)if((!b.length||b.length&&s[o]!==b[0].id)&&(l=i.element.find("#"+s[o]).data("ejPivotGrid"),f=k[s[o]],colCount=l.getJSONRecords().length/l.rowCount,a=l.rowCount,nt=!a||isNaN(a)?f.rowIndex+17:f.rowIndex+a-1,tt=!colCount||isNaN(colCount)?f.colIndex+2:f.colIndex+colCount-1,r[0]>=f.rowIndex&&r[0]<=nt&&r[1]>=f.colIndex&&r[1]<=tt)){c.isOverlap=!0;break}return c},_updateSheetName:function(n){for(var t=this.XLObj,r,u,e,o=t.getSheet(t.getActiveSheetIndex()).sheetInfo.text,i=1,f=t.model.sheetCount;i<=f;i++)for(r=t.getSheet(i).pivotMngr.pivot,u=t.getObjectKeys(r),j=0,e=u.length;j<e;j++)r[u[j]].dataSheetName===o&&(r[u[j]].dataSheetName=n)},_getSheetIdxFromName:function(n){for(var i=this.XLObj,t=1,r=i.model.sheetCount;t<=r;t++)if(i.model.sheets[t].sheetInfo.text==n)return t},_changeDataSource:function(){var t=this.XLObj,h=t.getActiveSheetIndex(),r=t._getContent(h).find(".e-ss-activepivot")[0].id,u=n("#"+r).data("ejPivotGrid"),o,i,s,f,e;i=t.XLRibbon._getAddrFromDollarAddr(n("#"+t._id+"_Ribbon_PvtRange").val());s=t.model.sheets[i[0]].sheetInfo.text;range=t.getRangeIndices(i[1]);e=t.getSheet(t.getActiveSheetIndex()).pivotMngr.pivot[r];e.dataRange=range;e.dataSheetName=s;f=t.getRangeDataAsJSON({rowIndex:range[0],colIndex:range[1]},{rowIndex:range[2],colIndex:range[3]},!1,i[0]);u.getOlapReport().data=f;o=n("#"+t._id+"_PivotTableSchema_"+r).data("ejPivotSchemaDesigner");u.model.dataSource.data=f;this._clearFilters(u,o)},_getPivotIDFromName:function(n){for(var t in this.names)if(n===this.names[t])return t},_clearFilters:function(t,i){var u=this.XLObj,r=t.getOlapReport();r.rows=[];r.columns=[];r.values=[];r.filters=[];t.refreshPivotGrid();i.model.pivotControl=t;n(i.element).html("");i._load();u._refreshActivationPanel()},_movePivotTable:function(){var t=this.XLObj,u=t.getActiveSheetIndex(),f=t._getContent(u).find(".e-ss-activepivot"),s=f[0].id,r,o=f.data("ejPivotGrid"),a,h,e,c,i,l,v=!0,p,w,b,y;if(r=t.getSheet(u).pivotMngr.pivot[s],n("#"+t._id+"_dlg_existsheet").data("ejRadioButton").model.checked?(v=!1,a=n("#"+t._id+"_Ribbon_PvtLocation").val().split("!"),h=this._getSheetIdxFromName(a[0]),i=t.getRangeIndices(t.XLRibbon._getAddrFromDollarAddr(a[1])[1]),u!==h&&(t._getContent(h).find(".e-content").append(f),t.gotoPage(h,!1),t.XLSelection._cleanUp(!0),v=!0),r.rowIndex=i[0],r.colIndex=i[1]):(t.insertSheet(),u=t.getActiveSheetIndex(),t._getContent(u).find(".e-content").append(f),i=[2,0]),v&&(l=t.getActiveSheetIndex(),t.getSheet(l).pivotMngr.pivot[s]={},n.extend(!0,t.getSheet(l).pivotMngr.pivot[s],r),l!==u&&delete t.getSheet(u).pivotMngr.pivot[s]),c=t.getCell(i[0],i[1]),!c&&t.model.scrollSettings.allowVirtualScrolling&&(y=t.getSheet(t.getActiveSheetIndex()),t._scrollContent({y:y._rowHeightCollection[i[0]+1]-y._scrollTop}),c=t.getCell(i[0],i[1])),e=c[0],f.css({left:e.offsetLeft-2,top:e.offsetTop-2}),o.getOlapReport().filters.length)while(r.rowIndex<=o.getOlapReport().filters.length)r.rowIndex=r.rowIndex+1,e=t.getCell(r.rowIndex,r.colIndex)[0],f.css({left:e.offsetLeft-2,top:e.offsetTop-2});b=o._rowCount;w=o.calculateCellWidths().columnWidths.length;p=[i[0],i[1],i[0]+b,i[1]+w];this._refreshRowColumn(p,o)}}}(jQuery,Syncfusion)});
