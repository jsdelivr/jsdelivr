(function(a){a.fn.storage=function(b){var d={onStart:function(){},onExit:function(){},beforeSave:function(){},afterSave:function(){},storageKey:"storageKey",revert:false,store:true},c=a.extend({},d,b);return this.each(function(){var g=a(this),e=g.text(),f="orig"+c.storageKey;g.attr("data-orig-text",e);if(c.store){localStorage.setItem(f,e);cookie.set(f,e)}g.attr("contenteditable","");if(c.store){if(c.revert){g.text(localStorage.getItem(f));g.text(cookie.get(f));if(g.text()==""||g.text()=="null"){g.text(g.data("orig-text"))}}else{g.text(localStorage.getItem(c.storageKey));g.text(cookie.get(c.storageKey));if(g.text()==""||g.text()=="null"){g.text(g.data("orig-text"))}}}g.focus(function(){var h=g.text();g.addClass("sf-focus");c.onStart.apply(this,[a(this),h])});g.blur(function(){var h=g.text();g.removeClass("sf-focus");g.addClass("sf-blur");c.onExit.apply(this,[a(this),h]);if(c.store){c.beforeSave.apply(this,[a(this),h]);localStorage.setItem(c.storageKey,g.text());cookie.set(c.storageKey,g.text());c.afterSave.apply(this,[a(this),h])}g.attr("data-orig-text",g.text());g.removeClass("sf-blur")})})}})(jQuery);