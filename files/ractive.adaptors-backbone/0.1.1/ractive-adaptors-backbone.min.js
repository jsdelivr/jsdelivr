!function(a,b){"use strict";if("undefined"!=typeof module&&module.exports&&"function"==typeof require)b(require("ractive"),require("backbone"));else if("function"==typeof define&&define.amd)define(["ractive","backbone"],b);else{if(!a.Ractive||!a.Backbone)throw new Error("Could not find Ractive or Backbone! Both must be loaded before the ractive-adaptors-backbone plugin");b(a.Ractive,a.Backbone)}}("undefined"!=typeof window?window:this,function(a,b){"use strict";var c,d;if(!a||!b)throw new Error("Could not find Ractive or Backbone! Check your paths config");a.adaptors.Backbone={filter:function(a){return a instanceof b.Model||a instanceof b.Collection},wrap:function(a,e,f,g){return e instanceof b.Model?new c(a,e,f,g):new d(a,e,f,g)}},c=function(a,b,c,d){var e=this;this.value=b,b.on("change",this.modelChangeHandler=function(){e.setting=!0,a.set(d(b.changed)),e.setting=!1})},c.prototype={teardown:function(){this.value.off("change",this.modelChangeHandler)},get:function(){return this.value.attributes},set:function(a,b){this.setting||-1!==a.indexOf(".")||this.value.set(a,b)},reset:function(a){return a instanceof b.Model||!(a instanceof Object)?!1:void this.value.reset(a)}},d=function(a,b,c){var d=this;this.value=b,b.on("add remove reset sort",this.changeHandler=function(){d.setting=!0,a.set(c,b.models),d.setting=!1})},d.prototype={teardown:function(){this.value.off("add remove reset sort",this.changeHandler)},get:function(){return this.value.models},reset:function(a){return this.setting?void 0:a instanceof b.Collection||"[object Array]"!==Object.prototype.toString.call(a)?!1:void this.value.reset(a)}}});