/*! dustjs-helpers - v1.6.0
* https://github.com/linkedin/dustjs-helpers
* Copyright (c) 2015 Aleksander Williams; Released under the MIT License */
!function(a,b){"function"==typeof define&&define.amd&&define.amd.dust===!0?define(["dust.core"],b):"object"==typeof exports?module.exports=b(require("dustjs-linkedin")):b(a.dust)}(this,function(dust){function a(a){i[a]||(h("Deprecation warning: "+a+" is deprecated and will be removed in a future version of dustjs-helpers","WARN"),h("For help and a deprecation timeline, see https://github.com/linkedin/dustjs-helpers/wiki/Deprecated-Features#"+a.replace(/\W+/g,""),"WARN"),i[a]=!0)}function b(a){return a.stack.tail&&"undefined"!=typeof a.stack.tail.head.__select__}function c(a){return a.get("__select__")}function d(a,b){var c=a.stack.head;return a.rebase(a.stack.tail).push({__select__:{isResolved:!1,isDefaulted:!1,isDeferredComplete:!1,deferreds:[],key:b}}).push(c)}function e(a,b){return"function"==typeof b?b.toString().replace(/(^\s+|\s+$)/gm,"").replace(/\n/gm,"").replace(/,\s*/gm,", ").replace(/\)\{/gm,") {"):b}function f(a,d,e,f,i){f=f||{};var j,k,l,m=e.block,n=f.filterOpType||"";if(f.hasOwnProperty("key"))j=dust.helpers.tap(f.key,a,d);else{if(!b(d))return h("No key specified for filter in {@"+n+"}"),a;l=c(d),j=l.key,l.isResolved&&(i=function(){return!1})}return k=dust.helpers.tap(f.value,a,d),i(g(k,f.type,d),g(j,f.type,d))?(b(d)&&("default"===n&&(l.isDefaulted=!0),l.isResolved=!0),m?a.render(m,d):a):e["else"]?a.render(e["else"],d):a}function g(a,b,c){if("undefined"!=typeof a)switch(b||typeof a){case"number":return+a;case"string":return String(a);case"boolean":return a="false"===a?!1:a,Boolean(a);case"date":return new Date(a);case"context":return c.get(a)}return a}var h=dust.log?function(a,b){b=b||"INFO",dust.log(a,b)}:function(){},i={},j={tap:function(a,b,c){if("function"!=typeof a)return a;var d,e="";return d=b.tap(function(a){return e+=a,""}).render(a,c),b.untap(),d.constructor!==b.constructor?d:""===e?!1:e},sep:function(a,b,c){var d=c.block;return b.stack.index===b.stack.of-1?a:d?d(a,b):a},first:function(a,b,c){return 0===b.stack.index?c.block(a,b):a},last:function(a,b,c){return b.stack.index===b.stack.of-1?c.block(a,b):a},contextDump:function(a,b,c,d){var f,g=d||{},i=g.to||"output",j=g.key||"current";return i=dust.helpers.tap(i,a,b),j=dust.helpers.tap(j,a,b),f="full"===j?JSON.stringify(b.stack,e,2):JSON.stringify(b.stack.head,e,2),"console"===i?(h(f),a):(f=f.replace(/</g,"\\u003c"),a.write(f))},math:function(a,b,c,e){if(e&&"undefined"!=typeof e.key&&e.method){var f=e.key,g=e.method,i=e.operand,j=e.round,k=null;switch(f=dust.helpers.tap(f,a,b),i=dust.helpers.tap(i,a,b),g){case"mod":(0===i||i===-0)&&h("operand for divide operation is 0/-0: expect Nan!"),k=parseFloat(f)%parseFloat(i);break;case"add":k=parseFloat(f)+parseFloat(i);break;case"subtract":k=parseFloat(f)-parseFloat(i);break;case"multiply":k=parseFloat(f)*parseFloat(i);break;case"divide":(0===i||i===-0)&&h("operand for divide operation is 0/-0: expect Nan/Infinity!"),k=parseFloat(f)/parseFloat(i);break;case"ceil":k=Math.ceil(parseFloat(f));break;case"floor":k=Math.floor(parseFloat(f));break;case"round":k=Math.round(parseFloat(f));break;case"abs":k=Math.abs(parseFloat(f));break;default:h("method passed is not supported")}return null!==k?(j&&(k=Math.round(k)),c&&c.block?(b=d(b,k),a.render(c.block,b)):a.write(k)):a}return h("Key is a required parameter for math helper along with method/operand!"),a},select:function(a,b,e,f){var g,i,j,k,l=e.block;if(f.hasOwnProperty("key"))if(i=dust.helpers.tap(f.key,a,b),l){if(b=d(b,i),g=c(b),a=a.render(l,b),g.deferreds.length)for(g.isDeferredComplete=!0,k=0,j=g.deferreds.length;j>k;k++)g.deferreds[k]()}else h("Missing body block in {@select}");else h("No key provided for {@select}");return a},eq:function(a,b,c,d){return d.filterOpType="eq",f(a,b,c,d,function(a,b){return b===a})},ne:function(a,b,c,d){return d.filterOpType="ne",f(a,b,c,d,function(a,b){return b!==a})},lt:function(a,b,c,d){return d.filterOpType="lt",f(a,b,c,d,function(a,b){return a>b})},lte:function(a,b,c,d){return d.filterOpType="lte",f(a,b,c,d,function(a,b){return a>=b})},gt:function(a,b,c,d){return d.filterOpType="gt",f(a,b,c,d,function(a,b){return b>a})},gte:function(a,b,c,d){return d.filterOpType="gte",f(a,b,c,d,function(a,b){return b>=a})},any:function(a,d,e){var f;return b(d)?(f=c(d),f.isDeferredComplete?h("{@any} nested inside {@any} or {@none} block. It needs its own {@select} block","WARN"):a=a.map(function(a){f.deferreds.push(function(){f.isResolved&&!f.isDefaulted&&(a=a.render(e.block,d)),a.end()})})):h("{@any} used outside of a {@select} block","WARN"),a},none:function(a,d,e){var f;return b(d)?(f=c(d),f.isDeferredComplete?h("{@none} nested inside {@any} or {@none} block. It needs its own {@select} block","WARN"):a=a.map(function(a){f.deferreds.push(function(){f.isResolved||(a=a.render(e.block,d)),a.end()})})):h("{@none} used outside of a {@select} block","WARN"),a},"default":function(c,d,e,g){return g.filterOpType="default",a("{@default}"),b(d)?f(c,d,e,g,function(){return!0}):(h("{@default} used outside of a {@select} block","WARN"),c)},size:function(a,b,c,d){var e,f,g,h=0;if(d=d||{},e=d.key,e&&e!==!0)if(dust.isArray(e))h=e.length;else if(!isNaN(parseFloat(e))&&isFinite(e))h=e;else if("object"==typeof e){f=0;for(g in e)Object.hasOwnProperty.call(e,g)&&f++;h=f}else h=(e+"").length;else h=0;return a.write(h)}};for(var k in j)dust.helpers[k]=j[k];return dust});