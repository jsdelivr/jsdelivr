!function(e){if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.appstax=e()}}(function(){var define,module,exports;return function e(t,n,r){function o(s,u){if(!n[s]){if(!t[s]){var a="function"==typeof require&&require;if(!u&&a)return a(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=n[s]={exports:{}};t[s][0].call(c.exports,function(e){var n=t[s][1][e];return o(n?n:e)},c,c.exports,e,t,n,r)}return n[s].exports}for(var i="function"==typeof require&&require,s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t){var n,r=Object.prototype.hasOwnProperty,o=Object.prototype.toString,i=function(e){"use strict";if(!e||"[object Object]"!==o.call(e)||e.nodeType||e.setInterval)return!1;var t=r.call(e,"constructor"),i=e.constructor&&e.constructor.prototype&&r.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!t&&!i)return!1;var s;for(s in e);return s===n||r.call(e,s)};t.exports=function s(){"use strict";var e,t,r,o,u,a,c=arguments[0],f=1,l=arguments.length,p=!1;for("boolean"==typeof c?(p=c,c=arguments[1]||{},f=2):("object"!=typeof c&&"function"!=typeof c||c==n)&&(c={});l>f;++f)if(null!=(e=arguments[f]))for(t in e)r=c[t],o=e[t],c!==o&&(p&&o&&(i(o)||(u=Array.isArray(o)))?(u?(u=!1,a=r&&Array.isArray(r)?r:[]):a=r&&i(r)?r:{},c[t]=s(p,a,o)):o!==n&&(c[t]=o));return c}},{}],2:[function(){},{}],3:[function(e,t){function n(){}var r=t.exports={};r.nextTick=function(){var e="undefined"!=typeof window&&window.setImmediate,t="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(e)return function(e){return window.setImmediate(e)};if(t){var n=[];return window.addEventListener("message",function(e){var t=e.source;if((t===window||null===t)&&"process-tick"===e.data&&(e.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(e){n.push(e),window.postMessage("process-tick","*")}}return function(e){setTimeout(e,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.on=n,r.addListener=n,r.once=n,r.off=n,r.removeListener=n,r.removeAllListeners=n,r.emit=n,r.binding=function(){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(){throw new Error("process.chdir is not supported")}},{}],4:[function(e,t,n){(function(e){!function(e){"use strict";if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof n&&"object"==typeof t)t.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var r="undefined"!=typeof window?window:self,o=r.Q;r.Q=e(),r.Q.noConflict=function(){return r.Q=o,this}}}(function(){"use strict";function t(e){return function(){return J.apply(e,arguments)}}function n(e){return e===Object(e)}function r(e){return"[object StopIteration]"===rt(e)||e instanceof K}function o(e,t){if(L&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ot)){for(var n=[],r=t;r;r=r.source)r.stack&&n.unshift(r.stack);n.unshift(e.stack);var o=n.join("\n"+ot+"\n");e.stack=i(o)}}function i(e){for(var t=e.split("\n"),n=[],r=0;r<t.length;++r){var o=t[r];a(o)||s(o)||!o||n.push(o)}return n.join("\n")}function s(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function u(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var r=/.*@(.+):(\d+)$/.exec(e);return r?[r[1],Number(r[2])]:void 0}function a(e){var t=u(e);if(!t)return!1;var n=t[0],r=t[1];return n===X&&r>=$&&ct>=r}function c(){if(L)try{throw new Error}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],r=u(n);if(!r)return;return X=r[0],r[1]}}function f(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",new Error("").stack),e.apply(e,arguments)}}function l(e){return e instanceof h?e:b(e)?T(e):S(e)}function p(){function e(e){t=e,i.source=e,G(n,function(t,n){l.nextTick(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,r=void 0}var t,n=[],r=[],o=et(p.prototype),i=et(h.prototype);if(i.promiseDispatch=function(e,o,i){var s=W(arguments);n?(n.push(s),"when"===o&&i[1]&&r.push(i[1])):l.nextTick(function(){t.promiseDispatch.apply(t,s)})},i.valueOf=function(){if(n)return i;var e=m(t);return g(e)&&(t=e),e},i.inspect=function(){return t?t.inspect():{state:"pending"}},l.longStackSupport&&L)try{throw new Error}catch(s){i.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return o.promise=i,o.resolve=function(n){t||e(l(n))},o.fulfill=function(n){t||e(S(n))},o.reject=function(n){t||e(E(n))},o.notify=function(e){t||G(r,function(t,n){l.nextTick(function(){n(e)})},void 0)},o}function d(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=p();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function y(e){return d(function(t,n){for(var r=0,o=e.length;o>r;r++)l(e[r]).then(t,n)})}function h(e,t,n){void 0===t&&(t=function(e){return E(new Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var r=et(h.prototype);if(r.promiseDispatch=function(n,o,i){var s;try{s=e[o]?e[o].apply(r,i):t.call(r,o,i)}catch(u){s=E(u)}n&&n(s)},r.inspect=n,n){var o=n();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var e=n();return"pending"===e.state||"rejected"===e.state?r:e.value}}return r}function v(e,t,n,r){return l(e).then(t,n,r)}function m(e){if(g(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function g(e){return e instanceof h}function b(e){return n(e)&&"function"==typeof e.then}function j(e){return g(e)&&"pending"===e.inspect().state}function x(e){return!g(e)||"fulfilled"===e.inspect().state}function w(e){return g(e)&&"rejected"===e.inspect().state}function k(){it.length=0,st.length=0,at||(at=!0)}function O(t,n){at&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){-1!==Z(st,t)&&(e.emit("unhandledRejection",n,t),ut.push(t))}),st.push(t),it.push(n&&"undefined"!=typeof n.stack?n.stack:"(no stack) "+n))}function q(t){if(at){var n=Z(st,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&l.nextTick.runAfter(function(){var r=Z(ut,t);-1!==r&&(e.emit("rejectionHandled",it[n],t),ut.splice(r,1))}),st.splice(n,1),it.splice(n,1))}}function E(e){var t=h({when:function(t){return t&&q(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return O(t,e),t}function S(e){return h({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return nt(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function T(e){var t=p();return l.nextTick(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function R(e){return h({isDef:function(){}},function(t,n){return P(e,t,n)},function(){return l(e).inspect()})}function A(e,t,n){return l(e).spread(t,n)}function N(e){return function(){function t(e,t){var s;if("undefined"==typeof StopIteration){try{s=n[e](t)}catch(u){return E(u)}return s.done?l(s.value):v(s.value,o,i)}try{s=n[e](t)}catch(u){return r(u)?l(u.value):E(u)}return v(s,o,i)}var n=e.apply(this,arguments),o=t.bind(t,"next"),i=t.bind(t,"throw");return o()}}function C(e){l.done(l.async(e)())}function _(e){throw new K(e)}function I(e){return function(){return A([this,H(arguments)],function(t,n){return e.apply(t,n)})}}function P(e,t,n){return l(e).dispatch(t,n)}function H(e){return v(e,function(e){var t=0,n=p();return G(e,function(r,o,i){var s;g(o)&&"fulfilled"===(s=o.inspect()).state?e[i]=s.value:(++t,v(o,function(r){e[i]=r,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:i,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function F(e){if(0===e.length)return l.resolve();var t=l.defer(),n=0;return G(e,function(r,o,i){function s(e){t.resolve(e)}function u(){n--,0===n&&t.reject(new Error("Can't get fulfillment value from any promise, all promises were rejected."))}function a(e){t.notify({index:i,value:e})}var c=e[i];n++,v(c,s,u,a)},void 0),t.promise}function D(e){return v(e,function(e){return e=Y(e,l),v(H(Y(e,function(e){return v(e,B,B)})),function(){return e})})}function U(e){return l(e).allSettled()}function M(e,t){return l(e).then(void 0,void 0,t)}function V(e,t){return l(e).nodeify(t)}var L=!1;try{throw new Error}catch(z){L=!!z.stack}var X,K,$=c(),B=function(){},Q=function(){function t(){for(var e,t;r.next;)r=r.next,e=r.task,r.task=void 0,t=r.domain,t&&(r.domain=void 0,t.enter()),n(e,t);for(;a.length;)e=a.pop(),n(e);i=!1}function n(e,n){try{e()}catch(r){if(u)throw n&&n.exit(),setTimeout(t,0),n&&n.enter(),r;setTimeout(function(){throw r},0)}n&&n.exit()}var r={task:void 0,next:null},o=r,i=!1,s=void 0,u=!1,a=[];if(Q=function(t){o=o.next={task:t,domain:u&&e.domain,next:null},i||(i=!0,s())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)u=!0,s=function(){e.nextTick(t)};else if("function"==typeof setImmediate)s="undefined"!=typeof window?setImmediate.bind(window,t):function(){setImmediate(t)};else if("undefined"!=typeof MessageChannel){var c=new MessageChannel;c.port1.onmessage=function(){s=f,c.port1.onmessage=t,t()};var f=function(){c.port2.postMessage(0)};s=function(){setTimeout(t,0),f()}}else s=function(){setTimeout(t,0)};return Q.runAfter=function(e){a.push(e),i||(i=!0,s())},Q}(),J=Function.call,W=t(Array.prototype.slice),G=t(Array.prototype.reduce||function(e,t){var n=0,r=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=r)throw new TypeError}for(;r>n;n++)n in this&&(t=e(t,this[n],n));return t}),Z=t(Array.prototype.indexOf||function(e){for(var t=0;t<this.length;t++)if(this[t]===e)return t;return-1}),Y=t(Array.prototype.map||function(e,t){var n=this,r=[];return G(n,function(o,i,s){r.push(e.call(t,i,s,n))},void 0),r}),et=Object.create||function(e){function t(){}return t.prototype=e,new t},tt=t(Object.prototype.hasOwnProperty),nt=Object.keys||function(e){var t=[];for(var n in e)tt(e,n)&&t.push(n);return t},rt=t(Object.prototype.toString);K="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var ot="From previous event:";l.resolve=l,l.nextTick=Q,l.longStackSupport=!1,"object"==typeof e&&e&&e.env&&e.env.Q_DEBUG&&(l.longStackSupport=!0),l.defer=p,p.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):e.resolve(arguments.length>2?W(arguments,1):n)}},l.Promise=d,l.promise=d,d.race=y,d.all=H,d.reject=E,d.resolve=l,l.passByCopy=function(e){return e},h.prototype.passByCopy=function(){return this},l.join=function(e,t){return l(e).join(t)},h.prototype.join=function(e){return l([this,e]).spread(function(e,t){if(e===t)return e;throw new Error("Can't join: not the same: "+e+" "+t)})},l.race=y,h.prototype.race=function(){return this.then(l.race)},l.makePromise=h,h.prototype.toString=function(){return"[object Promise]"},h.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(n){return E(n)}}function i(e){if("function"==typeof t){o(e,u);try{return t(e)}catch(n){return E(n)}}return E(e)}function s(e){return"function"==typeof n?n(e):e}var u=this,a=p(),c=!1;return l.nextTick(function(){u.promiseDispatch(function(e){c||(c=!0,a.resolve(r(e)))},"when",[function(e){c||(c=!0,a.resolve(i(e)))}])}),u.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(r){if(n=!0,!l.onerror)throw r;l.onerror(r)}n||a.notify(t)}]),a.promise},l.tap=function(e,t){return l(e).tap(t)},h.prototype.tap=function(e){return e=l(e),this.then(function(t){return e.fcall(t).thenResolve(t)})},l.when=v,h.prototype.thenResolve=function(e){return this.then(function(){return e})},l.thenResolve=function(e,t){return l(e).thenResolve(t)},h.prototype.thenReject=function(e){return this.then(function(){throw e})},l.thenReject=function(e,t){return l(e).thenReject(t)},l.nearer=m,l.isPromise=g,l.isPromiseAlike=b,l.isPending=j,h.prototype.isPending=function(){return"pending"===this.inspect().state},l.isFulfilled=x,h.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},l.isRejected=w,h.prototype.isRejected=function(){return"rejected"===this.inspect().state};var it=[],st=[],ut=[],at=!0;l.resetUnhandledRejections=k,l.getUnhandledReasons=function(){return it.slice()},l.stopUnhandledRejectionTracking=function(){k(),at=!1},k(),l.reject=E,l.fulfill=S,l.master=R,l.spread=A,h.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},l.async=N,l.spawn=C,l["return"]=_,l.promised=I,l.dispatch=P,h.prototype.dispatch=function(e,t){var n=this,r=p();return l.nextTick(function(){n.promiseDispatch(r.resolve,e,t)}),r.promise},l.get=function(e,t){return l(e).dispatch("get",[t])},h.prototype.get=function(e){return this.dispatch("get",[e])},l.set=function(e,t,n){return l(e).dispatch("set",[t,n])},h.prototype.set=function(e,t){return this.dispatch("set",[e,t])},l.del=l["delete"]=function(e,t){return l(e).dispatch("delete",[t])},h.prototype.del=h.prototype["delete"]=function(e){return this.dispatch("delete",[e])},l.mapply=l.post=function(e,t,n){return l(e).dispatch("post",[t,n])},h.prototype.mapply=h.prototype.post=function(e,t){return this.dispatch("post",[e,t])},l.send=l.mcall=l.invoke=function(e,t){return l(e).dispatch("post",[t,W(arguments,2)])},h.prototype.send=h.prototype.mcall=h.prototype.invoke=function(e){return this.dispatch("post",[e,W(arguments,1)])},l.fapply=function(e,t){return l(e).dispatch("apply",[void 0,t])},h.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},l["try"]=l.fcall=function(e){return l(e).dispatch("apply",[void 0,W(arguments,1)])},h.prototype.fcall=function(){return this.dispatch("apply",[void 0,W(arguments)])},l.fbind=function(e){var t=l(e),n=W(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(W(arguments))])}},h.prototype.fbind=function(){var e=this,t=W(arguments);return function(){return e.dispatch("apply",[this,t.concat(W(arguments))])}},l.keys=function(e){return l(e).dispatch("keys",[])},h.prototype.keys=function(){return this.dispatch("keys",[])},l.all=H,h.prototype.all=function(){return H(this)},l.any=F,h.prototype.any=function(){return F(this)},l.allResolved=f(D,"allResolved","allSettled"),h.prototype.allResolved=function(){return D(this)},l.allSettled=U,h.prototype.allSettled=function(){return this.then(function(e){return H(Y(e,function(e){function t(){return e.inspect()}return e=l(e),e.then(t,t)}))})},l.fail=l["catch"]=function(e,t){return l(e).then(void 0,t)},h.prototype.fail=h.prototype["catch"]=function(e){return this.then(void 0,e)},l.progress=M,h.prototype.progress=function(e){return this.then(void 0,void 0,e)},l.fin=l["finally"]=function(e,t){return l(e)["finally"](t)},h.prototype.fin=h.prototype["finally"]=function(e){return e=l(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},l.done=function(e,t,n,r){return l(e).done(t,n,r)},h.prototype.done=function(t,n,r){var i=function(e){l.nextTick(function(){if(o(e,s),!l.onerror)throw e;l.onerror(e)})},s=t||n||r?this.then(t,n,r):this;"object"==typeof e&&e&&e.domain&&(i=e.domain.bind(i)),s.then(void 0,i)},l.timeout=function(e,t,n){return l(e).timeout(t,n)},h.prototype.timeout=function(e,t){var n=p(),r=setTimeout(function(){t&&"string"!=typeof t||(t=new Error(t||"Timed out after "+e+" ms"),t.code="ETIMEDOUT"),n.reject(t)},e);return this.then(function(e){clearTimeout(r),n.resolve(e)},function(e){clearTimeout(r),n.reject(e)},n.notify),n.promise},l.delay=function(e,t){return void 0===t&&(t=e,e=void 0),l(e).delay(t)},h.prototype.delay=function(e){return this.then(function(t){var n=p();return setTimeout(function(){n.resolve(t)},e),n.promise})},l.nfapply=function(e,t){return l(e).nfapply(t)},h.prototype.nfapply=function(e){var t=p(),n=W(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},l.nfcall=function(e){var t=W(arguments,1);return l(e).nfapply(t)},h.prototype.nfcall=function(){var e=W(arguments),t=p();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},l.nfbind=l.denodeify=function(e){var t=W(arguments,1);return function(){var n=t.concat(W(arguments)),r=p();return n.push(r.makeNodeResolver()),l(e).fapply(n).fail(r.reject),r.promise}},h.prototype.nfbind=h.prototype.denodeify=function(){var e=W(arguments);return e.unshift(this),l.denodeify.apply(void 0,e)},l.nbind=function(e,t){var n=W(arguments,2);return function(){function r(){return e.apply(t,arguments)}var o=n.concat(W(arguments)),i=p();return o.push(i.makeNodeResolver()),l(r).fapply(o).fail(i.reject),i.promise}},h.prototype.nbind=function(){var e=W(arguments,0);return e.unshift(this),l.nbind.apply(void 0,e)},l.nmapply=l.npost=function(e,t,n){return l(e).npost(t,n)},h.prototype.nmapply=h.prototype.npost=function(e,t){var n=W(t||[]),r=p();return n.push(r.makeNodeResolver()),this.dispatch("post",[e,n]).fail(r.reject),r.promise},l.nsend=l.nmcall=l.ninvoke=function(e,t){var n=W(arguments,2),r=p();return n.push(r.makeNodeResolver()),l(e).dispatch("post",[t,n]).fail(r.reject),r.promise},h.prototype.nsend=h.prototype.nmcall=h.prototype.ninvoke=function(e){var t=W(arguments,1),n=p();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},l.nodeify=V,h.prototype.nodeify=function(e){return e?void this.then(function(t){l.nextTick(function(){e(null,t)})},function(t){l.nextTick(function(){e(t)})}):this},l.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var ct=c();return l})}).call(this,e("1YiZ5S"))},{"1YiZ5S":3}],5:[function(_dereq_,module,exports){!function(e,t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define(n):t[e]=n()}("reqwest",this,function(){function succeed(e){var t=protocolRe.exec(e.url);return t=t&&t[1]||context.location.protocol,httpsRe.test(t)?twoHundo.test(e.request.status):!!e.request.response}function handleReadyState(e,t,n){return function(){return e._aborted?n(e.request):e._timedOut?n(e.request,"Request is aborted: timeout"):void(e.request&&4==e.request[readyState]&&(e.request.onreadystatechange=noop,succeed(e)?t(e.request):n(e.request)))}}function setHeaders(e,t){var n,r=t.headers||{};r.Accept=r.Accept||defaultHeaders.accept[t.type]||defaultHeaders.accept["*"];var o="undefined"!=typeof FormData&&t.data instanceof FormData;t.crossOrigin||r[requestedWith]||(r[requestedWith]=defaultHeaders.requestedWith),r[contentType]||o||(r[contentType]=t.contentType||defaultHeaders.contentType);for(n in r)r.hasOwnProperty(n)&&"setRequestHeader"in e&&e.setRequestHeader(n,r[n])}function setCredentials(e,t){"undefined"!=typeof t.withCredentials&&"undefined"!=typeof e.withCredentials&&(e.withCredentials=!!t.withCredentials)}function generalCallback(e){lastValue=e}function urlappend(e,t){return e+(/\?/.test(e)?"&":"?")+t}function handleJsonp(e,t,n,r){var o=uniqid++,i=e.jsonpCallback||"callback",s=e.jsonpCallbackName||reqwest.getcallbackPrefix(o),u=new RegExp("((^|\\?|&)"+i+")=([^&]+)"),a=r.match(u),c=doc.createElement("script"),f=0,l=-1!==navigator.userAgent.indexOf("MSIE 10.0");return a?"?"===a[3]?r=r.replace(u,"$1="+s):s=a[3]:r=urlappend(r,i+"="+s),context[s]=generalCallback,c.type="text/javascript",c.src=r,c.async=!0,"undefined"==typeof c.onreadystatechange||l||(c.htmlFor=c.id="_reqwest_"+o),c.onload=c.onreadystatechange=function(){return c[readyState]&&"complete"!==c[readyState]&&"loaded"!==c[readyState]||f?!1:(c.onload=c.onreadystatechange=null,c.onclick&&c.onclick(),t(lastValue),lastValue=void 0,head.removeChild(c),void(f=1))},head.appendChild(c),{abort:function(){c.onload=c.onreadystatechange=null,n({},"Request is aborted: timeout",{}),lastValue=void 0,head.removeChild(c),f=1}}}function getRequest(e,t){var n,r=this.o,o=(r.method||"GET").toUpperCase(),i="string"==typeof r?r:r.url,s=r.processData!==!1&&r.data&&"string"!=typeof r.data?reqwest.toQueryString(r.data):r.data||null,u=!1;return"jsonp"!=r.type&&"GET"!=o||!s||(i=urlappend(i,s),s=null),"jsonp"==r.type?handleJsonp(r,e,t,i):(n=r.xhr&&r.xhr(r)||xhr(r),n.open(o,i,r.async===!1?!1:!0),setHeaders(n,r),setCredentials(n,r),context[xDomainRequest]&&n instanceof context[xDomainRequest]?(n.onload=e,n.onerror=t,n.onprogress=function(){},u=!0):n.onreadystatechange=handleReadyState(this,e,t),r.before&&r.before(n),u?setTimeout(function(){n.send(s)},200):n.send(s),n)}function Reqwest(e,t){this.o=e,this.fn=t,init.apply(this,arguments)}function setType(e){return null===e?void 0:e.match("json")?"json":e.match("javascript")?"js":e.match("text")?"html":e.match("xml")?"xml":void 0}function init(o,fn){function complete(e){for(o.timeout&&clearTimeout(self.timeout),self.timeout=null;self._completeHandlers.length>0;)self._completeHandlers.shift()(e)}function success(resp){var type=o.type||resp&&setType(resp.getResponseHeader("Content-Type"));resp="jsonp"!==type?self.request:resp;var filteredResponse=globalSetupOptions.dataFilter(resp.responseText,type),r=filteredResponse;try{resp.responseText=r}catch(e){}if(r)switch(type){case"json":try{resp=context.JSON?context.JSON.parse(r):eval("("+r+")")}catch(err){return error(resp,"Could not parse JSON in response",err)}break;case"js":resp=eval(r);break;case"html":resp=r;break;case"xml":resp=resp.responseXML&&resp.responseXML.parseError&&resp.responseXML.parseError.errorCode&&resp.responseXML.parseError.reason?null:resp.responseXML}for(self._responseArgs.resp=resp,self._fulfilled=!0,fn(resp),self._successHandler(resp);self._fulfillmentHandlers.length>0;)resp=self._fulfillmentHandlers.shift()(resp);complete(resp)}function timedOut(){self._timedOut=!0,self.request.abort()}function error(e,t,n){for(e=self.request,self._responseArgs.resp=e,self._responseArgs.msg=t,self._responseArgs.t=n,self._erred=!0;self._errorHandlers.length>0;)self._errorHandlers.shift()(e,t,n);complete(e)}this.url="string"==typeof o?o:o.url,this.timeout=null,this._fulfilled=!1,this._successHandler=function(){},this._fulfillmentHandlers=[],this._errorHandlers=[],this._completeHandlers=[],this._erred=!1,this._responseArgs={};var self=this;fn=fn||function(){},o.timeout&&(this.timeout=setTimeout(function(){timedOut()},o.timeout)),o.success&&(this._successHandler=function(){o.success.apply(o,arguments)}),o.error&&this._errorHandlers.push(function(){o.error.apply(o,arguments)}),o.complete&&this._completeHandlers.push(function(){o.complete.apply(o,arguments)}),this.request=getRequest.call(this,success,error)}function reqwest(e,t){return new Reqwest(e,t)}function normalize(e){return e?e.replace(/\r?\n/g,"\r\n"):""}function serial(e,t){var n,r,o,i,s=e.name,u=e.tagName.toLowerCase(),a=function(e){e&&!e.disabled&&t(s,normalize(e.attributes.value&&e.attributes.value.specified?e.value:e.text))};if(!e.disabled&&s)switch(u){case"input":/reset|button|image|file/i.test(e.type)||(n=/checkbox/i.test(e.type),r=/radio/i.test(e.type),o=e.value,(!(n||r)||e.checked)&&t(s,normalize(n&&""===o?"on":o)));break;case"textarea":t(s,normalize(e.value));break;case"select":if("select-one"===e.type.toLowerCase())a(e.selectedIndex>=0?e.options[e.selectedIndex]:null);else for(i=0;e.length&&i<e.length;i++)e.options[i].selected&&a(e.options[i])}}function eachFormElement(){var e,t,n=this,r=function(e,t){var r,o,i;for(r=0;r<t.length;r++)for(i=e[byTag](t[r]),o=0;o<i.length;o++)serial(i[o],n)};for(t=0;t<arguments.length;t++)e=arguments[t],/input|select|textarea/i.test(e.tagName)&&serial(e,n),r(e,["input","select","textarea"])}function serializeQueryString(){return reqwest.toQueryString(reqwest.serializeArray.apply(null,arguments))}function serializeHash(){var e={};return eachFormElement.apply(function(t,n){t in e?(e[t]&&!isArray(e[t])&&(e[t]=[e[t]]),e[t].push(n)):e[t]=n},arguments),e}function buildParams(e,t,n,r){var o,i,s,u=/\[\]$/;if(isArray(t))for(i=0;t&&i<t.length;i++)s=t[i],n||u.test(e)?r(e,s):buildParams(e+"["+("object"==typeof s?i:"")+"]",s,n,r);else if(t&&"[object Object]"===t.toString())for(o in t)buildParams(e+"["+o+"]",t[o],n,r);else r(e,t)}var context=this;if("document"in context)var doc=document,byTag="getElementsByTagName",head=doc[byTag]("head")[0];else{var XHR2;try{XHR2=_dereq_("xhr2")}catch(ex){throw new Error("Peer dependency `xhr2` required! Please npm install xhr2")}}var httpsRe=/^http/,protocolRe=/(^\w+):\/\//,twoHundo=/^(20\d|1223)$/,readyState="readyState",contentType="Content-Type",requestedWith="X-Requested-With",uniqid=0,callbackPrefix="reqwest_"+ +new Date,lastValue,xmlHttpRequest="XMLHttpRequest",xDomainRequest="XDomainRequest",noop=function(){},isArray="function"==typeof Array.isArray?Array.isArray:function(e){return e instanceof Array},defaultHeaders={contentType:"application/x-www-form-urlencoded",requestedWith:xmlHttpRequest,accept:{"*":"text/javascript, text/html, application/xml, text/xml, */*",xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript",js:"application/javascript, text/javascript"}},xhr=function(e){if(e.crossOrigin===!0){var t=context[xmlHttpRequest]?new XMLHttpRequest:null;if(t&&"withCredentials"in t)return t;if(context[xDomainRequest])return new XDomainRequest;throw new Error("Browser does not support cross-origin requests")}return context[xmlHttpRequest]?new XMLHttpRequest:XHR2?new XHR2:new ActiveXObject("Microsoft.XMLHTTP")},globalSetupOptions={dataFilter:function(e){return e}};return Reqwest.prototype={abort:function(){this._aborted=!0,this.request.abort()},retry:function(){init.call(this,this.o,this.fn)},then:function(e,t){return e=e||function(){},t=t||function(){},this._fulfilled?this._responseArgs.resp=e(this._responseArgs.resp):this._erred?t(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):(this._fulfillmentHandlers.push(e),this._errorHandlers.push(t)),this},always:function(e){return this._fulfilled||this._erred?e(this._responseArgs.resp):this._completeHandlers.push(e),this},fail:function(e){return this._erred?e(this._responseArgs.resp,this._responseArgs.msg,this._responseArgs.t):this._errorHandlers.push(e),this},"catch":function(e){return this.fail(e)}},reqwest.serializeArray=function(){var e=[];return eachFormElement.apply(function(t,n){e.push({name:t,value:n})},arguments),e},reqwest.serialize=function(){if(0===arguments.length)return"";var e,t,n=Array.prototype.slice.call(arguments,0);return e=n.pop(),e&&e.nodeType&&n.push(e)&&(e=null),e&&(e=e.type),t="map"==e?serializeHash:"array"==e?reqwest.serializeArray:serializeQueryString,t.apply(null,n)},reqwest.toQueryString=function(e,t){var n,r,o=t||!1,i=[],s=encodeURIComponent,u=function(e,t){t="function"==typeof t?t():null==t?"":t,i[i.length]=s(e)+"="+s(t)};if(isArray(e))for(r=0;e&&r<e.length;r++)u(e[r].name,e[r].value);else for(n in e)e.hasOwnProperty(n)&&buildParams(n,e[n],o,u);return i.join("&").replace(/%20/g,"+")},reqwest.getcallbackPrefix=function(){return callbackPrefix},reqwest.compat=function(e,t){return e&&(e.type&&(e.method=e.type)&&delete e.type,e.dataType&&(e.type=e.dataType),e.jsonpCallback&&(e.jsonpCallbackName=e.jsonpCallback)&&delete e.jsonpCallback,e.jsonp&&(e.jsonpCallback=e.jsonp)),new Reqwest(e,t)},reqwest.ajaxSetup=function(e){e=e||{};for(var t in e)globalSetupOptions[t]=e[t]},reqwest})},{xhr2:2}],6:[function(e,t){function n(e,t){var n;return n=t?new o(e,t):new o(e)}var r=function(){return this}(),o=r.WebSocket||r.MozWebSocket;t.exports=o?n:null,o&&(n.prototype=o.prototype)},{}],7:[function(e,t){function n(e){function t(){g=r({},g,e),n();try{g.appKeyBase32=i.base32.encode(g.appKey)}catch(t){}}function n(){var e=g.baseUrl;"string"==typeof e&&e.lastIndexOf("/")!=e.length-1&&(g.baseUrl=e+"/")}function a(e,t,n){var r=e,o="";return 0==r.indexOf("/")&&(r=r.substr(1)),"object"==typeof t&&Object.keys(t).forEach(function(e){r=r.replace(":"+e,c(t[e]))}),"object"==typeof n&&(o=Object.keys(n).map(function(e){return e+"="+c(n[e])}).join("&")),""!=o&&(r+=(-1==r.indexOf("?")?"?":"&")+o),g.baseUrl+r}function c(e){return encodeURIComponent(e).replace(/'/g,"%27")}function f(e,t,n){var r={};r.url=t,r.method=e,r.contentType="application/json",r.headers=l(),r.processData=!0,r.data=n,"undefined"!=typeof FormData&&n instanceof FormData?(r.contentType=!1,r.processData=!1):"object"==typeof n&&(r.data=JSON.stringify(n));var i=o.defer();return u.request(r).progress(function(e){i.notify(e)}).fail(function(e){g.log&&g.log("error","Appstax Error: "+e.message),i.reject(e)}).then(function(e){if("undefined"!=typeof e.request){var t=e.request.getResponseHeader("x-appstax-urltoken");"string"==typeof t&&(x=t)}i.resolve(e.response)}),i.promise}function l(){function e(e){"string"==typeof g.appKey&&(e["x-appstax-appkey"]=g.appKey)}function t(e){p()&&(e["x-appstax-sessionid"]=y())}function n(e){var t=["x-appstax-x",p()?"u":"n",g.appKeyBase32].join("");e[t]=t}function r(e){e["x-appstax-urltoken"]="_"}var o={};return e(o),t(o),n(o),r(o),o}function p(){var e=y();return null!==e&&void 0!==e}function d(e){switch(typeof e){case"string":case"object":b=e;break;case"function":j=e}}function y(){return j()}function h(){return m||(m=s(w)),m}function v(){return"undefined"!=typeof FormData?new FormData:null}var m,g={},b=null,j=function(){return b},x="";t();var w={request:f,url:a,formData:v,sessionId:function(e){return d(e),y()},urlToken:function(e){return x=arguments.length>0?e:x},appKey:function(){return g.appKey},baseUrl:function(){return g.baseUrl},socket:h};return w}var r=e("extend"),o=e("q"),i=e("./encoding"),s=e("./socket"),u=e("./http");t.exports=n},{"./encoding":10,"./http":14,"./socket":21,extend:1,q:4}],8:[function(e,t){function n(e,t){function n(){e.on("open",p),e.on("error",d),e.on("message",y),h={},v=[]}function r(e,t){var n=e.split("/"),r=f(e,t),i=h[r]={type:n[0],key:r,created:!1,wildcard:-1!=e.indexOf("*"),on:function(t,n){l(e,t,n)},send:function(t){u({channel:e,command:"publish",message:t})},grant:function(t,n){o(e,"grant",[t],n)},revoke:function(t,n){o(e,"revoke",[t],n)}};switch(i.type){case"private":if(u({channel:e,command:"subscribe"}),void 0!=t){var s=t;o(e,"grant",s,["read","write"])}break;case"objects":u({channel:e,command:"subscribe",filter:t||""});break;default:u({channel:e,command:"subscribe"})}return i}function o(e,t,n,r){i(e),r.forEach(function(r){u({channel:e,command:t+"."+r,data:n})})}function i(e){var t=s(e);t.created||(t.created=!0,u({channel:e,command:"channel.create"}))}function s(e,t){var n=f(e,t);return h[n]||r(e,t),h[n]}function u(t){t.id=String(m++),e.send(t)}function a(e,t,n){c(e,t).forEach(function(e){e(n)})}function c(e,t){var n=[];return n=v.filter("*"==e?function(e){return"*"==e.eventName||e.eventName==t}:function(n){return("*"==n.eventName||n.eventName==t)&&n.regexp.test(e)}),n.map(function(e){return e.fn})}function f(e,t){var n=e.split("/"),r=n[0];return"objects"==r?e+"$"+t:e}function l(e,t,n){var r;r=new RegExp(e.lastIndexOf("*")==e.length-1?"^"+e.replace("*",""):"^"+e+"$"),v.push({regexp:r,eventName:t,fn:n})}function p(){a("*","open",{type:"open"})}function d(){a("*","error",{type:"error",error:new Error("Error connecting to realtime service")})}function y(e){var n={};try{n=JSON.parse(e.data)}catch(r){}if("string"==typeof n.channel&&"string"==typeof n.event){if(n.type=n.event,0==n.type.indexOf("object.")){var o=n.channel.split("/")[1];n.object=t.createObject(o,n.data)}a(n.channel,n.type,n)}}var h,v,m=0;return n(),{getChannel:s}}t.exports=n},{}],9:[function(e,t){function n(){function e(e,n){collection=t(n),i["$"+e]=collection}function t(e){var t={};return Object.keys(e).forEach(function(n){var r=e[n],o={};
"string"==typeof r?o.type=r:"object"==typeof r&&"string"==typeof r.type&&(o.type=r.type),"relation"===o.type&&(o.relation=r.relation),t[n]=o}),t}function n(e){return i["$"+e]}function r(e){var t=n(e),r={};return t&&Object.keys(t).forEach(function(e){r[e]=o(t[e])}),r}function o(e){switch(e.type){case"string":return"";case"number":return 0;case"array":return[];case"file":return{sysDatatype:"file",filename:"",url:""};case"relation":return{sysDatatype:"relation",sysRelationType:e.relation,sysObjectIds:[]}}return void 0}var i={};return{defaultValues:r,get:n,collection:function(t,r){return e(t,r),n(t)}}}t.exports=n},{}],10:[function(e,t){var n=e("./nibbler"),r=n.create({dataBits:8,codeBits:6,keyString:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",pad:"-"}),o=n.create({dataBits:8,codeBits:5,keyString:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",pad:"-"});t.exports={base64:r,base32:o,base64ToBase32:function(e){return o.encode(r.decode(e))}}},{"./nibbler":17}],11:[function(e,t){t.exports={log:function(e){throw console&&console.error&&(e&&e.message?console.error("Appstax Error: "+e.message,e):console.error("Appstax Error"),e&&e.stack&&console.error(e.stack)),e}}},{}],12:[function(e,t){function n(e){function t(e){null!=e&&("string"==typeof e&&(e={appKey:e}),r=o({},y,r,e),r.log===!1&&(r.log=function(){}),n.apiClient=c({baseUrl:r.baseUrl,appKey:r.appKey,log:r.log}),n.files=u(n.apiClient),n.collections=a(),n.objects=i(n.apiClient,n.files,n.collections),n.users=s(n.apiClient,n.objects,h),n.request=f(n.apiClient),n.channels=l(n.apiClient.socket(),n.objects),n.models=p(n.objects,n.users,n.channels,n.apiClient.socket(),h),n.object=n.objects.createObject,n.status=n.objects.getObjectStatus,n.findAll=n.objects.findAll,n.find=n.objects.find,n.search=n.objects.search,n.signup=n.users.signup,n.login=n.users.login,n.logout=n.users.logout,n.currentUser=n.users.currentUser,n.collection=n.collections.collection,n.file=n.files.createFile,n.sessionId=n.apiClient.sessionId,n.channel=n.channels.getChannel,n.model=n.models.create)}var n={init:t},r={},h=d();return t(e),n}function r(e){console&&console[e]&&console[e].apply(console,Array.prototype.slice.call(arguments,1))}var o=e("extend"),i=e("./objects"),s=e("./users"),u=e("./files"),a=e("./collections"),c=e("./apiclient"),f=e("./request"),l=e("./channels"),p=e("./models"),d=e("./hub"),y={baseUrl:"https://appstax.com/api/latest/",log:r},h=n(y);t.exports=h,t.exports.app=n},{"./apiclient":7,"./channels":8,"./collections":9,"./files":13,"./hub":15,"./models":16,"./objects":18,"./request":20,"./users":22,extend:1}],13:[function(e,t){function n(e){function t(e){var t,r=Object.create({});if(e instanceof Blob){var o=e;t=n(r,{filename:o.name,nativeFile:o})}else if(l(e)){if(0==e.files.length)return void 0;var o=e.files[0];t=n(r,{filename:o.name,nativeFile:o})}else t=n(r,e),t.status="saved";if(!r||!t)throw new Error("Invalid file options");return Object.defineProperty(r,"filename",{get:function(){return t.filename},enumerable:!0}),Object.defineProperty(r,"url",{get:function(){return t.url},enumerable:!0}),Object.defineProperty(r,"preview",{value:function(){return i(t)}}),Object.defineProperty(r,"imageUrl",{value:function(e,n){return s(t,e,n)}}),Object.defineProperty(r,"internalFile",{value:t,enumerable:!1,writable:!1}),r}function n(e,t){var n={file:e,filename:t.filename,nativeFile:t.nativeFile,url:t.url||"",status:"new"};return n}function i(e){if(!e.previewPromise){var t=r.defer(),n=new FileReader;n.onload=function(n){e.url=n.target.result,t.resolve(e.file)},n.readAsDataURL(e.nativeFile),e.previewPromise=t.promise}return e.previewPromise}function s(e,t,n){var r=o({width:"-",height:"-"},n);return e.url.replace("/files/","/images/"+t+"/"+r.width+"/"+r.height+"/")}function u(t,n,o,i){var s=r.defer(),u=i.internalFile;u.status="saving";var c=a(t,n,o,i.filename),f=new FormData;return f.append("file",u.nativeFile),e.request("put",c,f).progress(function(e){s.notify(e)}).then(function(){u.status="saved",u.url=c,s.resolve(i)}),s.promise}function a(t,n,r,o){if(!o)return"";var i="token",s=e.urlToken();return s.length<2&&(i="appkey",s=e.appKey()),e.url("/files/:collectionName/:objectId/:propertyName/:filename?:tokenKey=:tokenValue",{collectionName:t,objectId:n,propertyName:r,filename:o,tokenKey:i,tokenValue:s})}function c(e){var t=null,n=e.internalFile;return null!=n&&(t=n.nativeFile),t}function f(e){return null!=e&&void 0!=e&&null!=e.internalFile}function l(e){return"undefined"!=typeof e&&"INPUT"==e.nodeName&&"file"==e.type}function p(e,t){return"string"==typeof t&&(e.internalFile.status=t),e.internalFile.status}function d(e,t){var n=e.internalFile;n&&(n.url=t)}return{create:t,isFile:f,saveFile:u,status:p,setUrl:d,urlForFile:a,nativeFile:c,createFile:t}}var r=e("q"),o=e("extend");t.exports=n},{extend:1,q:4}],14:[function(e,t){function n(e){try{var t=JSON.parse(e.responseText);return"string"==typeof t.errorMessage?new Error(t.errorMessage):t}catch(n){}return new Error(e.responseText)}var r=e("extend"),o=e("q"),i=e("reqwest");t.exports={request:function(e){var t=o.defer(),s=i(r({contentType:"application/json",crossOrigin:"object"==typeof document,before:function(e){function n(e){t.notify({percent:100*e.loaded/e.total,loaded:e.loaded,total:e.total})}e&&e.upload&&(e.upload.addEventListener?e.upload.addEventListener("progress",n):e.upload.onprogress=n)}},e)).then(function(e){e&&"string"==typeof e.responseText&&(e=e.responseText);try{e=JSON.parse(e)}catch(n){}t.notify({percent:100}),t.resolve({response:e,request:s.request})}).fail(function(e){t.reject(n(e))});return t.promise}}},{extend:1,q:4,reqwest:5}],15:[function(e,t){function n(){function e(e,t){n.push({type:e,handler:t})}function t(e,t){var o=r({},t,{type:e});n.forEach(function(t){t.type==e&&t.handler(o)})}var n=[];return{on:e,pub:t}}var r=e("extend");t.exports=n},{extend:1}],16:[function(e,t){function n(e,t,n,o,i){return{create:function(){return r(e,t,n,o,i)}}}function r(e,t,n,r,u){function a(a,c){c=c||{};var f;f="currentUser"==a?i(m,e,t,n,u):"status"==a?s(m,r):o(a,c,m,e,n),d.push(f),f.load(),f.connect()}function c(e,t){y.push({event:e,handler:t})}function f(e,t){y.forEach(function(n){n.event==e&&n.handler(t)})}function l(t,n){if(!t)return t;var n=n||0,r=t.id,o=h[r];return"undefined"==typeof o?o=h[r]=t:e.copy(t,o),n>=0&&Object.keys(t).forEach(function(e){var r=t[e];"undefined"!=typeof r&&"undefined"!=typeof r.collectionName?o[e]=l(r,n-1):Array.isArray(r)&&r.forEach(function(t,r){"undefined"!=typeof t.collectionName&&(o[e][r]=l(t,n-1))})}),o}function p(e,t){l(e,t),d.forEach(function(e){e.sort&&e.sort()}),f("change")}var d=[],y=[],h={},v={watch:a,on:c},m={root:v,normalize:l,notifyHandlers:f,updateObject:p};return v}function o(e,t,n,r,o){function i(e){e.map(function(e){return e=n.normalize(e,m.expand),h(e),e}),v(e),n.root[m.name]=e,l(),n.notifyHandlers("change")}function s(){return n.root[m.name]}function u(e){e=n.normalize(e),h(e),s().push(e),m.sort(),n.notifyHandlers("change")}function a(e){function t(){n.updateObject(e,r),h(e)}var r=b[e.id];"undefined"!=typeof r&&r>0?e.expand(r).then(t):t()}function c(e){s().splice(f(e),1),n.notifyHandlers("change")}function f(e){var t=-1;return s().some(function(n,r){return n.id==e.id?(t=r,!0):!1}),t}function l(){r.sort(s(),m.order)}function p(){var e={expand:m.expand};"string"==typeof m.filter?r.find(m.collection,m.filter,e).then(i):r.findAll(m.collection,e).then(i)}function d(){var e=o.getChannel("objects/"+m.collection,m.filter);e.on("object.created",function(e){u(e.object)}),e.on("object.deleted",function(e){c(e.object)}),e.on("object.updated",function(e){a(e.object)})}function y(e){if(!g[e]){g[e]=!0;var t=o.getChannel("objects/"+e);t.on("object.updated",function(e){a(e.object)})}}function h(e,t){var t="undefined"!=typeof t?t:m.expand||0;b[e.id]=t,t>0&&r.getRelatedObjects(e).forEach(function(e){y(e.collectionName),h(e,t-1)})}function v(e){function t(t,n){var r=e.filter(function(e){var r=[].concat(n),o=[].concat(e[t]);return r.some(function(e){return o.some(function(t){return(e.id||e)==(t.id||t)})})});return v(r),r}e.has=t}var m={};m.name=e,m.collection=t.collection||e,m.order=t.order||"-created",m.filter=t.filter,m.expand=t.expand+0||void 0,m.sort=l,m.load=p,m.connect=d;var g={},b={};return i([]),m}function i(e,t,n,r,o){function i(){e.root[c.name]=null,o.on("users.login",function(e){s(e.user)}),o.on("users.signup",function(e){s(e.user)}),o.on("users.logout",function(){s(null)})}function s(t){t=e.normalize(t),e.root[c.name]=t,e.notifyHandlers("change")}function u(){var e=n.currentUser();e&&e.refresh().then(s)}function a(){var t=r.getChannel("objects/users");t.on("object.updated",function(t){e.updateObject(t.object)})}var c={};return c.name="currentUser",c.load=u,c.connect=a,i(),c}function s(e,t){function n(){r(t.status()),t.on("status",function(){r(t.status())})}function r(t){e.root[s.name]=t,e.notifyHandlers("change")}function o(){}function i(){}var s={};return s.name="status",s.load=o,s.connect=i,n(),s}t.exports=n},{}],17:[function(e,t){t.exports={create:function(e){return new n(e)}};var n=function(e){"use strict";var t,n,r,o,i,s,u,a,c,f,l,p,d;t=function(){var t,l,p;for(n=e.pad||"",r=e.dataBits,o=e.codeBits,i=e.keyString,s=e.arrayData,l=Math.max(r,o),p=0,u=[],t=0;l>t;t+=1)u.push(p),p+=p+1;c=p,a=r/f(r,o)},f=function(e,t){for(var n;0!==t;)n=t,t=e%t,e=n;return e},l=function(e,t,r,o){var f,l,p,d,y,h,v,m;for(m=function(e){v.push(o?s?e:String.fromCharCode(e):i.charAt(e))},y=0,h=0,v=[],l=e.length,f=0;l>f;f+=1){if(h+=t,o){if(p=e.charAt(f),d=i.indexOf(p),p===n)break;if(0>d)throw'the character "'+p+'" is not a member of '+i}else if(d=s?e[f]:e.charCodeAt(f),(d|c)!==c)throw d+" is outside the range 0-"+c;for(y=y<<t|d;h>=r;)h-=r,m(y>>h),y&=u[h]}if(!o&&h>0)for(m(y<<r-h);v.length%a>0;)v.push(n);return s&&o?v:v.join("")},p=function(e){return l(e,r,o,!1)},d=function(e){return l(e,o,r,!0)},this.encode=p,this.decode=d,t()}},{}],18:[function(e,t){function n(e){var t=["collectionName","id","internalId","created","updated","permissions","save","saveAll","remove","grant","revoke","sysCreated","sysUpdated","sysPermissions"];return"users"==e&&t.push("username"),t}function r(e,t,r){function c(e,t,n){var i=p(e),s=Object.create(G);return Object.defineProperty(s,"id",{get:function(){return i.id},enumerable:!0}),Object.defineProperty(s,"internalId",{writable:!1,value:i.internalId,enumerable:!0}),Object.defineProperty(s,"internalObject",{writable:!1,value:i,enumerable:!1}),Object.defineProperty(s,"collectionName",{get:function(){return i.collectionName},enumerable:!0}),Object.defineProperty(s,"created",{get:function(){return new Date(i.sysValues.sysCreated)},enumerable:!0}),Object.defineProperty(s,"updated",{get:function(){return new Date(i.sysValues.sysUpdated)},enumerable:!0}),Object.defineProperty(s,"permissions",{get:function(){return i.sysValues.sysPermissions},enumerable:!0}),"users"==e&&Object.defineProperty(s,"username",{get:function(){return i.sysValues.sysUsername},enumerable:!0}),t=o({},r.defaultValues(e),t),f(s,t,n||c),null!==s.id&&(i.status="saved"),s}function f(e,t,n){var r=e.internalObject,i={};if("object"==typeof t){var s=r.sysValues;r.setId(t.sysObjectId),Object.keys(t).forEach(function(o){var u=t[o];0===o.indexOf("sys")?s[o]=u:"string"==typeof u.sysDatatype?(i[o]=l(o,u,e,n),"relation"==u.sysDatatype&&(r.relations[o]={type:u.sysRelationType,ids:(u.sysObjects||[]).map(function(e){return e.sysObjectId||e})})):i[o]=u})}o(e,i)}function l(e,n,r,o){function i(e,t){var n=[];return"undefined"!=typeof e.sysObjects&&(n=e.sysObjects.map(function(n){return"string"==typeof n?n:t(e.sysCollection,n,t)})),"single"===e.sysRelationType?n[0]:n}switch(n.sysDatatype){case"relation":return i(n,o);case"file":return t.create({filename:n.filename,url:t.urlForFile(r.collectionName,r.id,e,n.filename)})}return null}function p(e){var t={id:null,internalId:C(),collectionName:e,sysValues:{},initialValues:{},created:new Date,updated:new Date,status:"new",grants:[],revokes:[],relations:{},setId:function(e){e&&(this.id=e)},resetPermissions:function(){this.grants=[],this.revokes=[]}};return t}function d(e){var t=u.defer(),r=e.internalObject,o=n(e.collectionName);return"new"===r.status?t.resolve(e):H(e.collectionName,e.id).then(function(n){Object.keys(n).filter(function(e){return-1==o.indexOf(e)}).forEach(function(t){e[t]=n[t]}),t.resolve(e)}),t.promise}function y(t,n){var r=t.internalObject,n="object"==typeof n?n:u.defer();if("saving"===r.status)return setTimeout(function(){y(t,n)},100),n.promise;var o,i,s,a;return null==t.id?(o=e.url("/objects/:collection",{collection:t.collectionName}),i="post",a=R(t),s=A(t)):(o=e.url("/objects/:collection/:id",{collection:t.collectionName,id:t.id}),i="put",s=A(t)),r.status="saving",e.request(i,o,a||s).progress(function(e){"undefined"!=typeof a&&n.notify(e)}).then(function(e){r.setId(e.sysObjectId),r.status="saved",q(t,s),"undefined"!=typeof FormData&&a instanceof FormData&&m(t),n.resolve(t)}).fail(function(e){r.status="error",n.reject(e)}),n.promise}function h(t){var n=u.defer(),r=e.url("/objects/:collection/:id",{collection:t.collectionName,id:t.id});return e.request("DELETE",r).then(function(){n.resolve()}).fail(function(e){n.reject(e)}),n.promise}function v(e,t){if(K(e))throw new Error("Error calling expand() on unsaved object.");var n=1;return"number"==typeof t&&(n=t),H(e.collectionName,e.id,{expand:n}).then(function(t){var n=e.internalObject,r=Object.keys(n.relations);return r.forEach(function(n){e[n]=t[n]}),u.resolve(e)})}function m(e){var n=N(e);return Object.keys(n).map(function(r){var o=n[r],i=t.urlForFile(e.collectionName,e.id,r,o.filename);t.status(o,"saved"),t.setUrl(o,i)})}function g(e){var n=N(e),r=Object.keys(n),o=[],i=[];r.forEach(function(r){var s=n[r];if("saved"!==t.status(s)){var u=t.saveFile(e.collectionName,e.id,r,s);o.push(u),i.push(0)}});var s=u.defer();return u.all(o).progress(function(e){i[e.index]=e.value.percent;var t=i.reduce(function(e,t,n,r){return e+t/r.length},0);s.notify({percent:Math.round(t)})}).then(function(){s.resolve(e)}).fail(function(e){s.reject(e)}),s.promise}function b(t){function n(e){return{sysObjectId:t.id,username:e.username,permissions:e.permissions}}var r=u.defer(),o=e.url("/permissions"),i=t.internalObject,s=i.grants.map(n),a=i.revokes.map(n);if(i.resetPermissions(),s.length+a.length===0)r.resolve(t);else{var c={grants:s,revokes:a};e.request("POST",o,c).then(function(){r.resolve(t)}).fail(function(e){r.reject(e)})}return r.promise}function j(e){E(e);var t=k(e);if(t.some(K))throw new Error("Error saving object. Found unsaved related objects. Save related objects first or consider using saveAll().");var n=u.defer();return n.fulfill(e),n.promise}function x(e){function t(){return u.all(i.map(y))}function n(){return u.all(s.map(y))}function r(){return u.all(a.map(y))}var o=w(e),i=o.inbound.filter(K),s=o.outbound,a=o.inbound.filter(function(e){return!K(e)});return 0==s.length+i.length+a.length?e.save():t().then(n).then(r)}function w(e){function t(e){return Object.keys(e).map(n)}function n(e){return o[e]}for(var r=[e],o={},i={},s={};r.length>0;){var u=r.shift();if(E(u),null==o[u.internalId]){o[u.internalId]=u;var a=k(u).filter(function(e){return"object"==typeof e});a.forEach(function(e){i[e.internalId]=e}),a.length>0&&(s[u.internalId]=u,r=r.concat(a))}}return{all:t(o),inbound:t(i),outbound:t(s)}}function k(e){var t=[],n=e.internalObject;return Object.keys(n.relations).forEach(function(n){var r=e[n];null!=r&&(t=t.concat(r))}),t}function O(e,t){var n=e.internalObject,r=n.relations[t],o={additions:[],removals:[]};if(r){var i=e[t],s=[];i&&(s="array"==r.type?i:[i]);var u=s.map(function(e){return e.id||e}).filter(function(e){return"string"==typeof e});o.additions=u.filter(function(e){return null!=e&&-1==r.ids.indexOf(e)}),o.removals=r.ids.filter(function(e){return null!=e&&-1==u.indexOf(e)})}return o}function q(e,t){var n=e.internalObject;Object.keys(n.relations).forEach(function(e){var r=n.relations[e],o=t[e].sysRelationChanges;r.ids=r.ids.concat(o.additions).filter(function(e){return-1==o.removals.indexOf(e)})})}function E(e){var t=(r.get(e.collectionName),e.internalObject.relations),n=T(e);Object.keys(n).forEach(function(e){if(!t[e]){var r=n[e],o="";null!==r&&"object"==typeof r&&("undefined"==typeof r.length?"string"==typeof r.collectionName&&(o="single"):r.some(function(e){return"string"==typeof e.collectionName?(o="array",!0):!1})),""!==o&&(t[e]={type:o,ids:[]})}})}function S(e){var t=n(e.collectionName),r=Object.keys(e);return r.filter(function(e){return-1==t.indexOf(e)})}function T(e){if(!$(e))return{};var t={};S(e).forEach(function(n){/^[a-zA-Z]/.test(n)&&(t[n]=e[n])});var r=e.internalObject.sysValues,o=n(e.collectionName);return Object.keys(r).forEach(function(e){-1==o.indexOf(e)&&(t[e]=r[e])}),t}function R(n){var r=A(n),o=N(n),i=!1,s=e.formData();return Object.keys(o).forEach(function(e){var n=o[e],r=t.nativeFile(n);r&&"saved"!==t.status(n)&&(i=!0,s.append(e,r))}),i?(s.append("sysObjectData",JSON.stringify(r)),s):r}function A(e){var n=e.internalObject,r=T(e);return Object.keys(r).forEach(function(o){var i=r[o];t.isFile(i)?r[o]={sysDatatype:"file",filename:i.filename}:"object"==typeof n.relations[o]&&(r[o]={sysRelationChanges:O(e,o)})}),r}function N(e){var n=T(e),r={};return Object.keys(n).forEach(function(e){var o=n[e];t.isFile(o)&&(r[e]=o)}),r}function C(){var e="internal-id-"+J+"-"+W;return W++,e}function _(e){if(e){var t={};return"number"==typeof e.expand?t.expanddepth=e.expand:e.expand===!0&&(t.expanddepth=1),t}}function I(t,n){var r=e.url("/objects/:collection",{collection:t},_(n));return L(r,t,n)}function P(e){if(!(arguments.length<2)){var t=arguments[1],n=arguments[2];return"string"==typeof t&&-1==t.indexOf("=")&&-1==t.indexOf(" ")?H(e,t,n):"string"==typeof t?F(e,t,n):"object"==typeof t&&"function"==typeof t.queryString?D(e,t,n):"object"==typeof t?M(e,t,n):"function"==typeof t?U(e,t,n):void 0}}function H(t,n,r){var o=e.url("/objects/:collection/:id",{collection:t,id:n},_(r));return L(o,t,r)}function F(t,n,r){var o=e.url("/objects/:collection?filter=:queryString",{collection:t,queryString:n},_(r));return L(o,t,r)}function D(e,t,n){return F(e,t.queryString(),n)}function U(e,t,n){var r=z();return t(r),F(e,r.queryString(),n)}function M(e,t,n){return U(e,function(e){Object.keys(t).forEach(function(n){var r=t[n];"object"==typeof r&&"string"==typeof r.id?e.relation(n).has(r):e.string(n).equals(r)})},n)}function V(e){var t=arguments[1],n=arguments[2];if(arguments.length>=3&&"string"==typeof arguments[1]){t={};var r=arguments[1];Array.prototype.forEach.call(arguments[2],function(e){t[e]=r}),4==arguments.length&&(n=arguments[3])}return P(e,function(e){e.operator("or"),Object.keys(t).forEach(function(n){var r=t[n];e.string(n).contains(r)})},n)}function L(t,n,r){var o=c;r&&r.factory?o=r.factory:r&&r.plain&&(o=function(e,t){return t});var i=u.defer();return e.request("get",t).then(function(e){if(Array.isArray(e.objects)){var t=e.objects.map(function(e){return o(n,e,o)});i.resolve(t)}else i.resolve(o(n,e,o))}).fail(function(e){i.reject(e)}),i.promise}function z(e){return i(e)}function X(e){var t=e.internalObject;return t?t.status:void 0}function K(e){return"new"===X(e)}function $(e){return void 0!==e&&null!==e}function B(e,t){if(null!=e&&null!=t){var r=n(e.collectionName);Object.keys(e).filter(function(e){return-1==r.indexOf(e)}).forEach(function(n){t[n]=e[n]}),Object.keys(e.internalObject.sysValues).forEach(function(n){t.internalObject.sysValues[n]=e.internalObject.sysValues[n]})}}function Q(e,t){t=t||"";var n=1,r=t;0==t.indexOf("-")&&(n=-1,r=t.substr(1)),"function"==typeof e.sort&&e.sort(function(e,t){var o=e[r],i=t[r];return"undefined"==typeof o&&(o=0),"undefined"==typeof i&&(i=0),o.getTime&&(o=o.getTime()),i.getTime&&(i=i.getTime()),o>i?n:i>o?-n:0})}var J=a++,W=0,G={save:function(){return j(this).then(y).then(b).then(g).fail(s.log)},saveAll:function(){return x(this).fail(s.log)},remove:function(){return h(this).fail(s.log)},refresh:function(){return d(this).fail(s.log)},expand:function(e){return v(this,e).fail(s.log)},grant:function(e,t){"string"==typeof e&&(e=[e]);var n=this.internalObject;e.forEach(function(e){n.grants.push({username:e,permissions:t})})},revoke:function(e,t){"string"==typeof e&&(e=[e]);var n=this.internalObject;e.forEach(function(e){n.revokes.push({username:e,permissions:t})})},grantPublic:function(e){this.grant("*",e)},revokePublic:function(e){this.revoke("*",e)},hasPermission:function(e){return-1!=this.permissions.indexOf(e)}};return{create:c,createQuery:z,getProperties:T,createObject:c,getObjectStatus:X,getRelatedObjects:k,findAll:I,find:P,search:V,sort:Q,copy:B}}var o=e("extend"),i=e("./query"),s=e("./faillogger"),u=e("q");t.exports=r;var a=0},{"./faillogger":11,"./query":19,extend:1,q:4}],19:[function(e,t){t.exports=function(e){function t(){"string"==typeof e&&n(e)}function n(e){a.push(e)}function r(e){return{equals:function(t){n(s("$='$'",e,t))},contains:function(t){n(s("$ like '%$%'",e,t))}}}function o(e){function t(e){return[].concat(e).map(function(e){return"'"+(e.id||e)+"'"})}return{has:function(r){var o=t(r);n(s("$ has ($)",e,o.join(",")))}}}function i(){return a.join(s(" $ ",u))}function s(e){var t=Array.prototype.slice.call(arguments,1),n=e;return t.forEach(function(e){n=n.replace("$",e)}),n}var u="and",a=[];return t(),{queryString:i,string:r,relation:o,operator:function(e){u=e}}}},{}],20:[function(e,t){function n(e){function t(t,n,r){return n=e.url("/server"+n),e.request(t,n,r)}return t}t.exports=n},{}],21:[function(e,t){function n(e){function t(e){"object"==typeof e&&(e=JSON.stringify(e)),j&&1==j.readyState?(n(),j.send(e)):(m.push(e),u())}function n(){for(;m.length>0;){if(!j||1!=j.readyState){u();break}var e=m.shift();j.send(e)}}function i(e,t){k[e].push(t)}function s(){clearInterval(x),j&&j.close(),g=null}function u(){g||a(),x||(x=setInterval(function(){(!j||j.readyState>1)&&(v("connecting"),g.then(c))},100))}function a(){v("connecting");var t=r.defer();g=t.promise;var n=e.url("/messaging/realtime/sessions",{},{unique:(Math.random()*Date.now()).toString(16)});return e.request("post",n,{}).then(function(e){b=e.realtimeSessionId,t.resolve()}).fail(function(e){h("error",{error:e})}),g}function c(){var t=e.url("/messaging/realtime",{},{rsession:b});t=t.replace("http","ws"),j=f(t),j.onopen=l,j.onerror=p,j.onmessage=d,j.onclose=y}function f(e){return"undefined"!=typeof WebSocket?new WebSocket(e):"undefined"!=typeof o?new o(e):void 0}function l(e){h("open",e),v("connected"),n()}function p(e){h("error",e)}function d(e){h("message",e)}function y(e){h("close",e),v("disconnected")}function h(e,t){k[e].forEach(function(e){e(t)})}function v(e){var t=w;w=e,e!=t&&h("status",{type:"status",status:w})}var m=[],g=null,b="",j=null,x=null,w="disconnected",k={open:[],message:[],error:[],close:[],status:[]};return{connect:u,disconnect:s,status:function(){return w},send:t,on:i}}var r=e("q"),o=e("ws");t.exports=n},{q:4,ws:6}],22:[function(e,t){function n(e,t,n){function i(){p()}function s(e,n){var o=r({},n,{sysUsername:e}),i=t.create("users",o);return i}function u(t,i,u,a){var f=o.defer(),l={},p=!0;"boolean"==typeof u&&(p=u),"object"==typeof u?l=u:"object"==typeof a&&(l=a);var y=e.url("/users",{},{login:p}),h=r({sysUsername:t,sysPassword:i},l);return e.request("post",y,h).then(function(e){var r=s(t,e.user);p&&(r=c(t,e)),f.resolve(r),n.pub("users.signup",{user:d})}).fail(function(e){f.reject(e)}),f.promise}function a(t,r){var i=o.defer(),s=e.url("/sessions");return e.request("post",s,{sysUsername:t,sysPassword:r}).then(function(e){c(t,e),i.resolve(d),n.pub("users.login",{user:d})}).fail(function(e){i.reject(e)}),i.promise}function c(e,t){var n=t.user?t.user.sysObjectId:null;return l(t.sysSessionId,e,n),d=s(e,t.user)}function f(){d=null,e.sessionId(null),"undefined"!=typeof localStorage&&localStorage.removeItem("appstax_session_"+e.appKey()),n.pub("users.logout")}function l(t,n,r){e.sessionId(t),"undefined"!=typeof localStorage&&localStorage.setItem("appstax_session_"+e.appKey(),JSON.stringify({username:n,sessionId:t,userId:r}))}function p(){if("undefined"!=typeof localStorage){var t=localStorage.getItem("appstax_session_"+e.appKey());if(t){var n=JSON.parse(t);e.sessionId(n.sessionId),d=s(n.username,{sysObjectId:n.userId})}}}var d=null;return i(),{restoreSession:p,signup:u,login:a,logout:f,currentUser:function(){return d}}}var r=e("extend"),o=e("q");t.exports=n},{extend:1,q:4}]},{},[12])(12)});