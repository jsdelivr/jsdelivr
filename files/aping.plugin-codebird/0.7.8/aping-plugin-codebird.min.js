/**
    @name: aping-plugin-codebird 
    @version: 0.7.8 (28-01-2016) 
    @author: Jonathan Hornung <jonathan.hornung@gmail.com> 
    @url: https://github.com/JohnnyTheTank/apiNG-plugin-codebird 
    @license: MIT
*/
"use strict";angular.module("jtt_aping_codebird",[]).directive("apingCodebird",["apingCodebirdHelper","apingUtilityHelper",function(a,b){return{require:"?aping",restrict:"A",replace:"false",link:function(c,d,e,f,g){var h=f.getAppSettings(),i=b.parseJsonFromAttributes(e.apingCodebird,a.getThisPlattformString(),h),j=new Codebird;j.setBearerToken(b.getApiCredentials(a.getThisPlattformString(),"bearer_token")),i.forEach(function(b){var c={model:h.model,showAvatar:b.showAvatar||!1};"undefined"!=typeof h.getNativeData?c.getNativeData=h.getNativeData:c.getNativeData=!1;var d={};if("undefined"!=typeof b.items?d.count=b.items:d.count=h.items,0===d.count||"0"===d.count)return!1;if((d.count<0||isNaN(d.count))&&(d.count=void 0),d.count>100&&(d.count=100),b.search)d.q=b.search,d.result_type=b.result_type||"mixed","undefined"!=typeof b.lat&&"undefined"!=typeof b.lng&&(d.geocode=b.lat+","+b.lng+","+(b.distance||"1")+"km"),"undefined"!=typeof b.language&&(d.lang=b.language),j.__call("search_tweets",d,function(b){f.concatToResults(a.getObjectByJsonData(b,c)),f.apply()},!0);else{if(!b.user)return!1;d.screen_name=b.user,d.contributor_details=!0,(b.exclude_replies===!0||"true"===b.exclude_replies)&&(d.exclude_replies=!0),(b.include_rts===!1||"false"===b.include_rts)&&(d.include_rts=!1),j.__call("statuses_userTimeline",d,function(b,d,e){f.concatToResults(a.getObjectByJsonData(b,c)),f.apply()},!0)}})}}}]),angular.module("jtt_aping_codebird").service("apingCodebirdHelper",["apingModels","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getThisPlattformString=function(){return"twitter"},this.getThisPlattformLink=function(){return"https://twitter.com/"},this.getBigImageUrlFromSmallImageUrl=function(a){return a.replace("_normal","")},this.getImageUrlFromMediaObject=function(a){if(a){if(a.media_url_https)return this.getBigImageUrlFromSmallImageUrl(a.media_url_https);if(a.media_url)return this.getBigImageUrlFromSmallImageUrl(a.media_url)}},this.getImageUrlFromUserObject=function(a){if(a){if(a.profile_image_url_https)return this.getBigImageUrlFromSmallImageUrl(a.profile_image_url_https);if(a.profile_image_url)return this.getBigImageUrlFromSmallImageUrl(a.profile_image_url)}},this.getImagesObjectFromMediaObject=function(a){var b={thumb_url:void 0,thumb_width:void 0,thumb_height:void 0,img_url:void 0,img_width:void 0,img_height:void 0,native_url:void 0,native_width:void 0,native_height:void 0},c=this.getImageUrlFromMediaObject(a);return a.sizes&&("undefined"!=typeof a.sizes.small?(b.thumb_url=c+":small",b.thumb_width=a.sizes.small.w||void 0,b.thumb_height=a.sizes.small.h||void 0):b.thumb_url=c,"undefined"!=typeof a.sizes.medium?(b.img_url=c+":medium",b.img_width=a.sizes.medium.w||void 0,b.img_height=a.sizes.medium.h||void 0):b.img_url=c,"undefined"!=typeof a.sizes.large?(b.native_url=c+":large",b.native_width=a.sizes.large.w||void 0,b.native_height=a.sizes.large.h||void 0):b.native_url=c),b},this.getObjectByJsonData=function(a,b){var c=[];if(a){var d=this;a.statuses?angular.forEach(a.statuses,function(a,e){var f=d.getItemByJsonData(a,b);f&&c.push(f)}):a.length>0&&angular.forEach(a,function(a,e){var f=d.getItemByJsonData(a,b);f&&c.push(f)})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b.model)if(b.getNativeData===!0||"true"===b.getNativeData)c=this.getNativeItemByJsonData(a,b.model);else switch(b.model){case"social":c=this.getSocialItemByJsonData(a,b);break;case"image":c=this.getImageItemByJsonData(a,b);break;default:return!1}return c},this.getSocialItemByJsonData=function(b,c){var d=a.getNew("social",this.getThisPlattformString());if(angular.extend(d,{blog_name:b.user.screen_name,blog_id:b.user.id_str,blog_link:this.getThisPlattformLink()+b.user.screen_name+"/",intern_id:b.id_str,timestamp:new Date(Date.parse(b.created_at.replace(/^\w+ (\w+) (\d+) ([\d:]+) \+0000 (\d+)$/,"$1 $2 $4 $3 UTC"))).getTime(),text:b.text,shares:b.retweet_count,likes:b.favorite_count}),d.timestamp&&(d.date_time=new Date(d.timestamp)),b.entities&&b.entities.media&&b.entities.media.length>0){d.source=b.entities.media;var e=this.getImagesObjectFromMediaObject(b.entities.media[0]);angular.extend(d,e),d.img_url||(d.img_url=this.getImageUrlFromMediaObject(b.entities.media[0]))}return d.img_url?d.type="image":(d.type="tweet",!b.user||c.showAvatar!==!0&&"true"!==c.showAvatar||(d.img_url=this.getImageUrlFromUserObject(b.user))),d.post_url=d.blog_link+"status/"+d.intern_id,d},this.getImageItemByJsonData=function(b){var c=a.getNew("image",this.getThisPlattformString());if(angular.extend(c,{blog_name:b.user.screen_name,blog_id:b.user.id_str,blog_link:this.getThisPlattformLink()+b.user.screen_name+"/",intern_id:b.id_str,timestamp:new Date(Date.parse(b.created_at.replace(/^\w+ (\w+) (\d+) ([\d:]+) \+0000 (\d+)$/,"$1 $2 $4 $3 UTC"))).getTime(),text:b.text,shares:b.retweet_count,likes:b.favorite_count}),c.timestamp&&(c.date_time=new Date(c.timestamp)),b.entities&&b.entities.media&&b.entities.media.length>0){c.source=b.entities.media;var d=this.getImagesObjectFromMediaObject(b.entities.media[0]);angular.extend(c,d),c.img_url||(c.img_url=this.getImageUrlFromMediaObject(b.entities.media[0]))}return c.img_url?(c.post_url=c.blog_link+"status/"+c.intern_id,c):!1},this.getNativeItemByJsonData=function(a,b){var c={};switch(b){case"image":if(!a.entities||!a.entities.media||!a.entities.media.length>0||!this.getImageUrlFromMediaObject(a.entities.media[0]))return!1;c=a}return c=a}}]),function(undefined){Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0;c<this.length;c++)if(this[c]===a)return c;return-1});var Codebird=function(){var _oauth_consumer_key=null,_oauth_consumer_secret=null,_oauth_bearer_token=null,_endpoint_base="https://api.twitter.com/",_endpoint_base_media="https://upload.twitter.com/",_endpoint=_endpoint_base+"1.1/",_endpoint_media=_endpoint_base_media+"1.1/",_endpoint_oauth=_endpoint_base,_endpoint_proxy="https://api.jublo.net/codebird/",_endpoint_old=_endpoint_base+"1/",_use_jsonp="undefined"!=typeof navigator&&"undefined"!=typeof navigator.userAgent&&(navigator.userAgent.indexOf("Trident/4")>-1||navigator.userAgent.indexOf("Trident/5")>-1||navigator.userAgent.indexOf("MSIE 7.0")>-1),_use_proxy="undefined"!=typeof navigator&&"undefined"!=typeof navigator.userAgent,_oauth_token=null,_oauth_token_secret=null,_version="2.6.0",setConsumerKey=function(a,b){_oauth_consumer_key=a,_oauth_consumer_secret=b},setBearerToken=function(a){_oauth_bearer_token=a},getVersion=function(){return _version},setToken=function(a,b){_oauth_token=a,_oauth_token_secret=b},setUseProxy=function(a){_use_proxy=!!a},setProxy=function(a){a.match(/\/$/)||(a+="/"),_endpoint_proxy=a},_parse_str=function(str,array){var glue1="=",glue2="&",array2=String(str).replace(/^&?([\s\S]*?)&?$/,"$1").split(glue2),i,j,chr,tmp,key,value,bracket,keys,evalStr,fixStr=function(a){return decodeURIComponent(a).replace(/([\\"'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r")};for(array||(array=this.window),i=0;i<array2.length;i++){for(tmp=array2[i].split(glue1),tmp.length<2&&(tmp=[tmp,""]),key=fixStr(tmp[0]),value=fixStr(tmp[1]);" "===key.charAt(0);)key=key.substr(1);if(-1!==key.indexOf("\x00")&&(key=key.substr(0,key.indexOf("\x00"))),key&&"["!==key.charAt(0)){for(keys=[],bracket=0,j=0;j<key.length;j++)if("["!==key.charAt(j)||bracket){if("]"===key.charAt(j)&&bracket&&(keys.length||keys.push(key.substr(0,bracket-1)),keys.push(key.substr(bracket,j-bracket)),bracket=0,"["!==key.charAt(j+1)))break}else bracket=j+1;for(keys.length||(keys=[key]),j=0;j<keys[0].length&&(chr=keys[0].charAt(j),(" "===chr||"."===chr||"["===chr)&&(keys[0]=keys[0].substr(0,j)+"_"+keys[0].substr(j+1)),"["!==chr);j++);for(evalStr="array",j=0;j<keys.length;j++)key=keys[j],key=""!==key&&" "!==key||0===j?"'"+key+"'":eval(evalStr+".push([]);")-1,evalStr+="["+key+"]",j!==keys.length-1&&"undefined"===eval("typeof "+evalStr)&&eval(evalStr+" = [];");evalStr+=" = '"+value+"';\n",eval(evalStr)}}},getApiMethods=function(){var a={GET:["account/settings","account/verify_credentials","application/rate_limit_status","blocks/ids","blocks/list","direct_messages","direct_messages/sent","direct_messages/show","favorites/list","followers/ids","followers/list","friends/ids","friends/list","friendships/incoming","friendships/lookup","friendships/lookup","friendships/no_retweets/ids","friendships/outgoing","friendships/show","geo/id/:place_id","geo/reverse_geocode","geo/search","geo/similar_places","help/configuration","help/languages","help/privacy","help/tos","lists/list","lists/members","lists/members/show","lists/memberships","lists/ownerships","lists/show","lists/statuses","lists/subscribers","lists/subscribers/show","lists/subscriptions","mutes/users/ids","mutes/users/list","oauth/authenticate","oauth/authorize","saved_searches/list","saved_searches/show/:id","search/tweets","statuses/home_timeline","statuses/mentions_timeline","statuses/oembed","statuses/retweeters/ids","statuses/retweets/:id","statuses/retweets_of_me","statuses/show/:id","statuses/user_timeline","trends/available","trends/closest","trends/place","users/contributees","users/contributors","users/profile_banner","users/search","users/show","users/suggestions","users/suggestions/:slug","users/suggestions/:slug/members","users/recommendations","account/push_destinations/device","activity/about_me","activity/by_friends","statuses/media_timeline","timeline/home","help/experiments","search/typeahead","search/universal","discover/universal","conversation/show","statuses/:id/activity/summary","account/login_verification_enrollment","account/login_verification_request","prompts/suggest","beta/timelines/custom/list","beta/timelines/timeline","beta/timelines/custom/show"],POST:["account/remove_profile_banner","account/settings__post","account/update_delivery_device","account/update_profile","account/update_profile_background_image","account/update_profile_banner","account/update_profile_colors","account/update_profile_image","blocks/create","blocks/destroy","direct_messages/destroy","direct_messages/new","favorites/create","favorites/destroy","friendships/create","friendships/destroy","friendships/update","lists/create","lists/destroy","lists/members/create","lists/members/create_all","lists/members/destroy","lists/members/destroy_all","lists/subscribers/create","lists/subscribers/destroy","lists/update","media/upload","mutes/users/create","mutes/users/destroy","oauth/access_token","oauth/request_token","oauth2/invalidate_token","oauth2/token","saved_searches/create","saved_searches/destroy/:id","statuses/destroy/:id","statuses/lookup","statuses/retweet/:id","statuses/update","statuses/update_with_media","users/lookup","users/report_spam","direct_messages/read","account/login_verification_enrollment__post","push_destinations/enable_login_verification","account/login_verification_request__post","beta/timelines/custom/create","beta/timelines/custom/update","beta/timelines/custom/destroy","beta/timelines/custom/add","beta/timelines/custom/remove"]};return a},__call=function(a,b,c,d){switch("undefined"==typeof b&&(b={}),"undefined"==typeof d&&(d=!1),"function"!=typeof c&&"function"==typeof b?(c=b,b={},"boolean"==typeof c&&(d=c)):"undefined"==typeof c&&(c=function(){}),a){case"oauth_authenticate":case"oauth_authorize":return this[a](b,c);case"oauth2_token":return this[a](c)}"oauth_requestToken"===a&&setToken(null,null);var e={};"object"==typeof b?e=b:_parse_str(b,e);var f,g,h,i="",j=a.split("_");for(g=0;g<j.length;g++)g>0&&(i+="/"),i+=j[g];var k=["screen_name","place_id"];for(g=0;g<k.length;g++){f=k[g].toUpperCase();var l=f.split("_").join("/");i=i.split(l).join(f)}var m=i,n=i.match(/[A-Z_]{2,}/);if(n)for(g=0;g<n.length;g++){f=n[g];var o=f.toLowerCase();if(m=m.split(f).join(":"+o),"undefined"==typeof e[o]){for(h=0;26>h;h++)m=m.split(String.fromCharCode(65+h)).join("_"+String.fromCharCode(97+h));console.warn('To call the templated method "'+m+'", specify the parameter value for "'+o+'".')}i=i.split(f).join(e[o]),delete e[o]}for(g=0;26>g;g++)i=i.split(String.fromCharCode(65+g)).join("_"+String.fromCharCode(97+g)),m=m.split(String.fromCharCode(65+g)).join("_"+String.fromCharCode(97+g));var p=_detectMethod(m,e),q=_detectMultipart(m),r=_detectInternal(m);return _callApi(p,i,e,q,d,r,c)},oauth_authenticate=function(a,b){"undefined"==typeof a.force_login&&(a.force_login=null),"undefined"==typeof a.screen_name&&(a.screen_name=null),null===_oauth_token&&console.warn("To get the authenticate URL, the OAuth token must be set.");var c=_endpoint_oauth+"oauth/authenticate?oauth_token="+_url(_oauth_token);return a.force_login===!0&&(c+="&force_login=1",null!==a.screen_name&&(c+="&screen_name="+a.screen_name)),b(c),!0},oauth_authorize=function(a,b){"undefined"==typeof a.force_login&&(a.force_login=null),"undefined"==typeof a.screen_name&&(a.screen_name=null),null===_oauth_token&&console.warn("To get the authorize URL, the OAuth token must be set.");var c=_endpoint_oauth+"oauth/authorize?oauth_token="+_url(_oauth_token);return a.force_login===!0&&(c+="&force_login=1",null!==a.screen_name&&(c+="&screen_name="+a.screen_name)),b(c),!0},oauth2_token=function(a){null===_oauth_consumer_key&&console.warn("To obtain a bearer token, the consumer key must be set."),"undefined"==typeof a&&(a=function(){});var b="grant_type=client_credentials",c=_endpoint_oauth+"oauth2/token";_use_proxy&&(c=c.replace(_endpoint_base,_endpoint_proxy));var d=_getXmlRequestObject();null!==d&&(d.open("POST",c,!0),d.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.setRequestHeader((_use_proxy?"X-":"")+"Authorization","Basic "+_base64_encode(_oauth_consumer_key+":"+_oauth_consumer_secret)),d.onreadystatechange=function(){if(d.readyState>=4){var b=12027;try{b=d.status}catch(c){}var e="";try{e=d.responseText}catch(c){}var f=_parseApiReply(e);f.httpstatus=b,200===b&&setBearerToken(f.access_token),a(f)}},d.send(b))},_url=function(a){return/boolean|number|string/.test(typeof a)?encodeURIComponent(a).replace(/!/g,"%21").replace(/'/g,"%27").replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/\*/g,"%2A"):""},_sha1=function(){function a(a,c){a[c>>5]|=128<<24-c%32,a[(c+64>>9<<4)+15]=c;for(var d=new Array(80),e=1732584193,f=-271733879,g=-1732584194,h=271733878,i=-1009589776,j=0;j<a.length;j+=16){for(var k=e,l=f,m=g,n=h,o=i,p=0;80>p;p++){var q;16>p?q=a[j+p]:(q=d[p-3]^d[p-8]^d[p-14]^d[p-16],q=q<<1|q>>>31),d[p]=q,q=b(b(e<<5|e>>>27,20>p?f&g|~f&h:40>p?f^g^h:60>p?f&g|f&h|g&h:f^g^h),b(b(i,d[p]),20>p?1518500249:40>p?1859775393:60>p?-1894007588:-899497514)),i=h,h=g,g=f<<30|f>>>2,f=e,e=q}e=b(e,k),f=b(f,l),g=b(g,m),h=b(h,n),i=b(i,o)}return[e,f,g,h,i]}function b(a,b){var c=(65535&a)+(65535&b);return(a>>16)+(b>>16)+(c>>16)<<16|65535&c}function c(a){for(var b=[],c=(1<<d)-1,e=0;e<a.length*d;e+=d)b[e>>5]|=(a.charCodeAt(e/d)&c)<<24-e%32;return b}var d=8;return function(b){var e=_oauth_consumer_secret+"&"+(null!==_oauth_token_secret?_oauth_token_secret:"");null===_oauth_consumer_secret&&console.warn("To generate a hash, the consumer secret must be set.");var f=c(e);f.length>16&&(f=a(f,e.length*d)),e=new Array(16);for(var g=new Array(16),h=0;16>h;h++)g[h]=909522486^f[h],e[h]=1549556828^f[h];for(f=a(g.concat(c(b)),512+b.length*d),e=a(e.concat(f),672),f="",g=0;g<4*e.length;g+=3)for(h=(e[g>>2]>>8*(3-g%4)&255)<<16|(e[g+1>>2]>>8*(3-(g+1)%4)&255)<<8|e[g+2>>2]>>8*(3-(g+2)%4)&255,b=0;4>b;b++)f=8*g+6*b>32*e.length?f+"=":f+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(h>>6*(3-b)&63);return f}}(),_base64_encode=function(a){var b,c,d,e,f=0,g=0,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",i=[];if(!a)return a;do b=a.charCodeAt(f++),c=a.charCodeAt(f++),d=a.charCodeAt(f++),e=b<<16|c<<8|d,b=e>>18&63,c=e>>12&63,d=e>>6&63,e&=63,i[g++]=h.charAt(b)+h.charAt(c)+h.charAt(d)+h.charAt(e);while(f<a.length);return i=i.join(""),a=a.length%3,(a?i.slice(0,a-3):i)+"===".slice(a||3)},_http_build_query=function(a,b,c){function d(a,b,c){var e,f=[];if(b===!0?b="1":b===!1&&(b="0"),null===b)return"";if("object"==typeof b){for(e in b)null!==b[e]&&f.push(d(a+"["+e+"]",b[e],c));return f.join(c)}return"function"!=typeof b?_url(a)+"="+_url(b):void console.warn("There was an error processing for http_build_query().")}var e,f,g=[];c||(c="&");for(f in a)e=a[f],b&&!isNaN(f)&&(f=String(b)+f),e=d(f,e,c),""!==e&&g.push(e);return g.join(c)},_nonce=function(a){"undefined"==typeof a&&(a=8),1>a&&console.warn("Invalid nonce length.");for(var b="",c=0;a>c;c++){var d=Math.floor(61*Math.random());b+="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".substring(d,d+1)}return b},_ksort=function(a){var b,c,d=[];b=function(a,b){var c=parseFloat(a),d=parseFloat(b),e=c+""===a,f=d+""===b;return e&&f?c>d?1:d>c?-1:0:e&&!f?1:!e&&f?-1:a>b?1:b>a?-1:0};for(c in a)a.hasOwnProperty(c)&&d.push(c);return d.sort(b),d},_clone=function(a){var b={};for(var c in a)"object"==typeof a[c]?b[c]=_clone(a[c]):b[c]=a[c];return b},_sign=function(a,b,c,d){"undefined"==typeof c&&(c={}),"undefined"==typeof d&&(d=!1),null===_oauth_consumer_key&&console.warn("To generate a signature, the consumer key must be set.");var e,f={consumer_key:_oauth_consumer_key,version:"1.0",timestamp:Math.round((new Date).getTime()/1e3),nonce:_nonce(),signature_method:"HMAC-SHA1"},g={};for(var h in f)e=f[h],g["oauth_"+h]=_url(e);null!==_oauth_token&&(g.oauth_token=_url(_oauth_token));var i=_clone(g);for(h in c)e=c[h],g[h]=e;for(var j=_ksort(g),k="",l=0;l<j.length;l++)h=j[l],e=g[h],k+=h+"="+_url(e)+"&";k=k.substring(0,k.length-1);var m=_sha1(a+"&"+_url(b)+"&"+_url(k));c=d?g:i,c.oauth_signature=m,j=_ksort(c);var n="";if(d){for(l=0;l<j.length;l++)h=j[l],e=c[h],n+=h+"="+_url(e)+"&";return n.substring(0,n.length-1)}for(n="OAuth ",l=0;l<j.length;l++)h=j[l],e=c[h],n+=h+'="'+_url(e)+'", ';return n.substring(0,n.length-2)},_detectMethod=function(a,b){switch(a){case"account/settings":case"account/login_verification_enrollment":case"account/login_verification_request":a=b.length?a+"__post":a}var c=getApiMethods();for(var d in c)if(c[d].indexOf(a)>-1)return d;console.warn("Can't find HTTP method to use for \""+a+'".')},_detectMultipart=function(a){var b=["statuses/update_with_media","account/update_profile_background_image","account/update_profile_image","account/update_profile_banner"];return b.indexOf(a)>-1},_buildMultipart=function(a,b){if(_detectMultipart(a)){var c=["statuses/update_with_media","account/update_profile_background_image","account/update_profile_image","account/update_profile_banner"],d={"statuses/update_with_media":"media[]","account/update_profile_background_image":"image","account/update_profile_image":"image","account/update_profile_banner":"banner"};if(-1!==c.indexOf(a)){d=d[a].split(" ");var e="--------------------"+_nonce(),f="";for(var g in b)f+="--"+e+'\r\nContent-Disposition: form-data; name="'+g+'"',d.indexOf(g)>-1&&(f+="\r\nContent-Transfer-Encoding: base64"),f+="\r\n\r\n"+b[g]+"\r\n";return f+="--"+e+"--"}}},_detectInternal=function(a){var b=["users/recommendations"];return b.join(" ").indexOf(a)>-1},_detectMedia=function(a){var b=["media/upload"];return b.join(" ").indexOf(a)>-1},_detectOld=function(a){var b=["account/push_destinations/device"];return b.join(" ").indexOf(a)>-1},_getEndpoint=function(a){var b;return b="oauth"===a.substring(0,5)?_endpoint_oauth+a:_detectMedia(a)?_endpoint_media+a+".json":_detectOld(a)?_endpoint_old+a+".json":_endpoint+a+".json"},_getXmlRequestObject=function(){var a=null;if("object"==typeof window&&window&&"undefined"!=typeof window.XMLHttpRequest)a=new window.XMLHttpRequest;else if("object"==typeof Ti&&Ti&&"undefined"!=typeof Ti.Network.createHTTPClient)a=Ti.Network.createHTTPClient();else if("undefined"!=typeof ActiveXObject)try{a=new ActiveXObject("Microsoft.XMLHTTP")}catch(b){console.error("ActiveXObject object not defined.")}else if("function"==typeof require&&require)try{var c=require("xmlhttprequest").XMLHttpRequest;a=new c}catch(d){try{var c=require("xhr2");a=new c}catch(e){console.error("xhr2 object not defined, cancelling.")}}return a},_callApi=function(a,b,c,d,e,f,g){"undefined"==typeof c&&(c={}),"undefined"==typeof d&&(d=!1),"undefined"==typeof e&&(e=!1),"function"!=typeof g&&(g=function(){}),f&&(c.adc="phone",c.application_id=333903271);var h=_getEndpoint(b),i=null,j=_getXmlRequestObject();if(null!==j){var k;if("GET"===a){var l=h;if("{}"!==JSON.stringify(c)&&(l+="?"+_http_build_query(c)),e||(i=_sign(a,h,c)),_use_jsonp){l+="{}"!==JSON.stringify(c)?"&":"?";var m=_nonce();window[m]=function(a){a.httpstatus=200;var b=null;"undefined"!=typeof j.getResponseHeader&&""!==j.getResponseHeader("x-rate-limit-limit")&&(b={limit:j.getResponseHeader("x-rate-limit-limit"),remaining:j.getResponseHeader("x-rate-limit-remaining"),reset:j.getResponseHeader("x-rate-limit-reset")}),g(a,b)},c.callback=m,l=h+"?"+_sign(a,h,c,!0);var n=document.createElement("script");n.type="text/javascript",n.src=l;var o=document.getElementsByTagName("body")[0];return void o.appendChild(n)}_use_proxy&&(l=l.replace(_endpoint_base,_endpoint_proxy).replace(_endpoint_base_media,_endpoint_proxy)),j.open(a,l,!0)}else{if(_use_jsonp)return void console.warn("Sending POST requests is not supported for IE7-9.");d?(e||(i=_sign(a,h,{})),c=_buildMultipart(b,c)):(e||(i=_sign(a,h,c)),c=_http_build_query(c)),k=c,(_use_proxy||d)&&(h=h.replace(_endpoint_base,_endpoint_proxy).replace(_endpoint_base_media,_endpoint_proxy)),j.open(a,h,!0),d?j.setRequestHeader("Content-Type","multipart/form-data; boundary="+k.split("\r\n")[0].substring(2)):j.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}if(e){if(null===_oauth_consumer_key&&null===_oauth_bearer_token&&console.warn("To make an app-only auth API request, consumer key or bearer token must be set."),null===_oauth_bearer_token)return oauth2_token(function(){_callApi(a,b,c,d,e,!1,g)});i="Bearer "+_oauth_bearer_token}return null!==i&&j.setRequestHeader((_use_proxy?"X-":"")+"Authorization",i),j.onreadystatechange=function(){if(j.readyState>=4){var a=12027;try{a=j.status}catch(b){}var c="";try{c=j.responseText}catch(b){}var d=_parseApiReply(c);d.httpstatus=a;var e=null;"undefined"!=typeof j.getResponseHeader&&""!==j.getResponseHeader("x-rate-limit-limit")&&(e={limit:j.getResponseHeader("x-rate-limit-limit"),remaining:j.getResponseHeader("x-rate-limit-remaining"),reset:j.getResponseHeader("x-rate-limit-reset")}),g(d,e)}},j.send("GET"===a?null:k),!0}},_parseApiReply=function(a){if("string"!=typeof a||""===a)return{};if("[]"===a)return[];var b;try{b=JSON.parse(a)}catch(c){if(b={},0===a.indexOf('<?xml version="1.0" encoding="UTF-8"?>'))b.request=a.match(/<request>(.*)<\/request>/)[1],b.error=a.match(/<error>(.*)<\/error>/)[1];else for(var d=a.split("&"),e=0;e<d.length;e++){var f=d[e].split("=",2);f.length>1?b[f[0]]=decodeURIComponent(f[1]):b[f[0]]=null}}return b};return{setConsumerKey:setConsumerKey,getVersion:getVersion,setToken:setToken,setBearerToken:setBearerToken,setUseProxy:setUseProxy,setProxy:setProxy,getApiMethods:getApiMethods,__call:__call,oauth_authenticate:oauth_authenticate,oauth_authorize:oauth_authorize,oauth2_token:oauth2_token}};"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=Codebird:("object"==typeof window&&window&&(window.Codebird=Codebird),"function"==typeof define&&define.amd&&define("codebird",[],function(){return Codebird}))}();