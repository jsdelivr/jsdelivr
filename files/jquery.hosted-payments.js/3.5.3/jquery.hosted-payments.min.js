!function(){function e(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(t,n){return e("round",t,n)}),Math.floor10||(Math.floor10=function(t,n){return e("floor",t,n)}),Math.ceil10||(Math.ceil10=function(t,n){return e("ceil",t,n)})}(),function(e,t,n){function r(t,n){if(e.isArray(t)){for(var r=t.length-1;r>=0;r--){var a=t[r];"string"===e.type(a)&&c.transports[a]||(n.log("Invalid transport: "+a+", removing it from the transports list."),t.splice(r,1))}0===t.length&&(n.log("No transports remain within the specified transport array."),t=null)}else if(c.transports[t]||"auto"===t){if("auto"===t&&c._.ieVersion<=8)return["longPolling"]}else n.log("Invalid transport: "+t.toString()+"."),t=null;return t}function a(e){return"http:"===e?80:"https:"===e?443:void 0}function i(e,t){return t.match(/:\d+$/)?t:t+":"+a(e)}function o(t,n){var r=this,a=[];r.tryBuffer=function(n){return t.state===e.signalR.connectionState.connecting?(a.push(n),!0):!1},r.drain=function(){if(t.state===e.signalR.connectionState.connected)for(;a.length>0;)n(a.shift())},r.clear=function(){a=[]}}var s={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",errorDuringStartRequest:"Error during start request. Stopping the connection.",stoppedDuringStartRequest:"The connection was stopped during the start request.",errorParsingStartResponse:"Error parsing start response: '{0}'. Stopping the connection.",invalidStartResponse:"Invalid start response: '{0}'. Stopping the connection.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active.",webSocketsInvalidState:"The Web Socket transport is in an invalid state, transitioning into reconnecting.",reconnectTimeout:"Couldn't reconnect within the configured timeout of {0} ms, disconnecting.",reconnectWindowTimeout:"The client has been inactive since {0} and it has exceeded the inactivity timeout of {1} ms. Stopping the connection."};if("function"!=typeof e)throw new Error(s.nojQuery);var c,l,p="complete"===t.document.readyState,u=e(t),d="__Negotiate Aborted__",h={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},f={processData:!0,timeout:null,async:!0,global:!1,cache:!1},m=function(e,n){if(n!==!1){var r;"undefined"!=typeof t.console&&(r="["+(new Date).toTimeString()+"] SignalR: "+e,t.console.debug?t.console.debug(r):t.console.log&&t.console.log(r))}},g=function(t,n,r){return n===t.state?(t.state=r,e(t).triggerHandler(h.onStateChanged,[{oldState:n,newState:r}]),!0):!1},v=function(e){return e.state===c.connectionState.disconnected},y=function(e){return e._.keepAliveData.activated&&e.transport.supportsKeepAlive(e)},b=function(n){var r,a;n._.configuredStopReconnectingTimeout||(a=function(t){var n=c._.format(c.resources.reconnectTimeout,t.disconnectTimeout);t.log(n),e(t).triggerHandler(h.onError,[c._.error(n,"TimeoutException")]),t.stop(!1,!1)},n.reconnecting(function(){var e=this;e.state===c.connectionState.reconnecting&&(r=t.setTimeout(function(){a(e)},e.disconnectTimeout))}),n.stateChanged(function(e){e.oldState===c.connectionState.reconnecting&&t.clearTimeout(r)}),n._.configuredStopReconnectingTimeout=!0)};c=function(e,t,n){return new c.fn.init(e,t,n)},c._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:function(){var e,n;return"Microsoft Internet Explorer"===t.navigator.appName&&(n=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent),n&&(e=t.parseFloat(n[1]))),e}(),error:function(e,t,n){var r=new Error(e);return r.source=t,"undefined"!=typeof n&&(r.context=n),r},transportError:function(e,t,r,a){var i=this.error(e,r,a);return i.transport=t?t.name:n,i},format:function(){for(var e=arguments[0],t=0;t<arguments.length-1;t++)e=e.replace("{"+t+"}",arguments[t+1]);return e},firefoxMajorVersion:function(e){var t=e.match(/Firefox\/(\d+)/);return!t||!t.length||t.length<2?0:parseInt(t[1],10)},configurePingInterval:function(n){var r=n._.config,a=function(t){e(n).triggerHandler(h.onError,[t])};r&&!n._.pingIntervalId&&r.pingInterval&&(n._.pingIntervalId=t.setInterval(function(){c.transports._logic.pingServer(n).fail(a)},r.pingInterval))}},c.events=h,c.resources=s,c.ajaxDefaults=f,c.changeState=g,c.isDisconnecting=v,c.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4},c.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")}},u.load(function(){p=!0}),c.fn=c.prototype={init:function(t,n,r){var a=e(this);this.url=t,this.qs=n,this.lastError=null,this._={keepAliveData:{},connectingMessageBuffer:new o(this,function(e){a.triggerHandler(h.onReceived,[e])}),lastMessageAt:(new Date).getTime(),lastActiveAt:(new Date).getTime(),beatInterval:5e3,beatHandle:null,totalTransportConnectTimeout:0},"boolean"==typeof r&&(this.logging=r)},_parseResponse:function(e){var t=this;return e&&"string"==typeof e?t.json.parse(e):e},_originalJson:t.JSON,json:t.JSON,isCrossDomain:function(n,r){var a;return n=e.trim(n),r=r||t.location,0!==n.indexOf("http")?!1:(a=t.document.createElement("a"),a.href=n,a.protocol+i(a.protocol,a.host)!==r.protocol+i(r.protocol,r.host))},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:!1,state:c.connectionState.disconnected,clientProtocol:"1.5",reconnectDelay:2e3,transportConnectTimeout:0,disconnectTimeout:3e4,reconnectWindow:3e4,keepAliveWarnAt:2/3,start:function(n,a){var i,o=this,l={pingInterval:3e5,waitForPageLoad:!0,transport:"auto",jsonp:!1},f=o._deferral||e.Deferred(),m=t.document.createElement("a");if(o.lastError=null,o._deferral=f,!o.json)throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");if("function"===e.type(n)?a=n:"object"===e.type(n)&&(e.extend(l,n),"function"===e.type(l.callback)&&(a=l.callback)),l.transport=r(l.transport,o),!l.transport)throw new Error("SignalR: Invalid transport(s) specified, aborting start.");if(o._.config=l,!p&&l.waitForPageLoad===!0)return o._.deferredStartHandler=function(){o.start(n,a)},u.bind("load",o._.deferredStartHandler),f.promise();if(o.state===c.connectionState.connecting)return f.promise();if(g(o,c.connectionState.disconnected,c.connectionState.connecting)===!1)return f.resolve(o),f.promise();b(o),m.href=o.url,m.protocol&&":"!==m.protocol?(o.protocol=m.protocol,o.host=m.host):(o.protocol=t.document.location.protocol,o.host=m.host||t.document.location.host),o.baseUrl=o.protocol+"//"+o.host,o.wsProtocol="https:"===o.protocol?"wss://":"ws://","auto"===l.transport&&l.jsonp===!0&&(l.transport="longPolling"),0===o.url.indexOf("//")&&(o.url=t.location.protocol+o.url,o.log("Protocol relative URL detected, normalizing it to '"+o.url+"'.")),this.isCrossDomain(o.url)&&(o.log("Auto detected cross domain url."),"auto"===l.transport&&(l.transport=["webSockets","serverSentEvents","longPolling"]),"undefined"==typeof l.withCredentials&&(l.withCredentials=!0),l.jsonp||(l.jsonp=!e.support.cors,l.jsonp&&o.log("Using jsonp because this browser doesn't support CORS.")),o.contentType=c._.defaultContentType),o.withCredentials=l.withCredentials,o.ajaxDataType=l.jsonp?"jsonp":"text",e(o).bind(h.onStart,function(t,n){"function"===e.type(a)&&a.call(o),f.resolve(o)}),o._.initHandler=c.transports._logic.initHandler(o),i=function(n,r){var a=c._.error(s.noTransportOnInit);if(r=r||0,r>=n.length)return 0===r?o.log("No transports supported by the server were selected."):1===r?o.log("No fallback transports were selected."):o.log("Fallback transports exhausted."),e(o).triggerHandler(h.onError,[a]),f.reject(a),void o.stop();if(o.state!==c.connectionState.disconnected){var l=n[r],p=c.transports[l],d=function(){i(n,r+1)};o.transport=p;try{o._.initHandler.start(p,function(){var n=c._.firefoxMajorVersion(t.navigator.userAgent)>=11,r=!!o.withCredentials&&n;o.log("The start request succeeded. Transitioning to the connected state."),y(o)&&c.transports._logic.monitorKeepAlive(o),c.transports._logic.startHeartbeat(o),c._.configurePingInterval(o),g(o,c.connectionState.connecting,c.connectionState.connected)||o.log("WARNING! The connection was not in the connecting state."),o._.connectingMessageBuffer.drain(),e(o).triggerHandler(h.onStart),u.bind("unload",function(){o.log("Window unloading, stopping the connection."),o.stop(r)}),n&&u.bind("beforeunload",function(){t.setTimeout(function(){o.stop(r)},0)})},d)}catch(m){o.log(p.name+" transport threw '"+m.message+"' when attempting to start."),d()}}};var v=o.url+"/negotiate",C=function(t,n){var r=c._.error(s.errorOnNegotiate,t,n._.negotiateRequest);e(n).triggerHandler(h.onError,r),f.reject(r),n.stop()};return e(o).triggerHandler(h.onStarting),v=c.transports._logic.prepareQueryString(o,v),o.log("Negotiating with '"+v+"'."),o._.negotiateRequest=c.transports._logic.ajax(o,{url:v,error:function(e,t){t!==d?C(e,o):f.reject(c._.error(s.stoppedWhileNegotiating,null,o._.negotiateRequest))},success:function(t){var n,r,a,p=[],u=[];try{n=o._parseResponse(t)}catch(d){return void C(c._.error(s.errorParsingNegotiateResponse,d),o)}return r=o._.keepAliveData,o.appRelativeUrl=n.Url,o.id=n.ConnectionId,o.token=n.ConnectionToken,o.webSocketServerUrl=n.WebSocketServerUrl,o._.pollTimeout=1e3*n.ConnectionTimeout+1e4,o.disconnectTimeout=1e3*n.DisconnectTimeout,o._.totalTransportConnectTimeout=o.transportConnectTimeout+1e3*n.TransportConnectTimeout,n.KeepAliveTimeout?(r.activated=!0,r.timeout=1e3*n.KeepAliveTimeout,r.timeoutWarning=r.timeout*o.keepAliveWarnAt,o._.beatInterval=(r.timeout-r.timeoutWarning)/3):r.activated=!1,o.reconnectWindow=o.disconnectTimeout+(r.timeout||0),n.ProtocolVersion&&n.ProtocolVersion===o.clientProtocol?(e.each(c.transports,function(e){return 0===e.indexOf("_")||"webSockets"===e&&!n.TryWebSockets?!0:void u.push(e)}),e.isArray(l.transport)?e.each(l.transport,function(t,n){e.inArray(n,u)>=0&&p.push(n)}):"auto"===l.transport?p=u:e.inArray(l.transport,u)>=0&&p.push(l.transport),void i(p)):(a=c._.error(c._.format(s.protocolIncompatible,o.clientProtocol,n.ProtocolVersion)),e(o).triggerHandler(h.onError,[a]),void f.reject(a))}}),f.promise()},starting:function(t){var n=this;return e(n).bind(h.onStarting,function(e,r){t.call(n)}),n},send:function(e){var t=this;if(t.state===c.connectionState.disconnected)throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");if(t.state===c.connectionState.connecting)throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");return t.transport.send(t,e),t},received:function(t){var n=this;return e(n).bind(h.onReceived,function(e,r){t.call(n,r)}),n},stateChanged:function(t){var n=this;return e(n).bind(h.onStateChanged,function(e,r){t.call(n,r)}),n},error:function(t){var n=this;return e(n).bind(h.onError,function(e,r,a){n.lastError=r,t.call(n,r,a)}),n},disconnected:function(t){var n=this;return e(n).bind(h.onDisconnect,function(e,r){t.call(n)}),n},connectionSlow:function(t){var n=this;return e(n).bind(h.onConnectionSlow,function(e,r){t.call(n)}),n},reconnecting:function(t){var n=this;return e(n).bind(h.onReconnecting,function(e,r){t.call(n)}),n},reconnected:function(t){var n=this;return e(n).bind(h.onReconnect,function(e,r){t.call(n)}),n},stop:function(n,r){var a=this,i=a._deferral;return a._.deferredStartHandler&&u.unbind("load",a._.deferredStartHandler),delete a._.config,delete a._.deferredStartHandler,p||a._.config&&a._.config.waitForPageLoad!==!0?a.state!==c.connectionState.disconnected?(a.log("Stopping connection."),g(a,a.state,c.connectionState.disconnected),t.clearTimeout(a._.beatHandle),t.clearInterval(a._.pingIntervalId),a.transport&&(a.transport.stop(a),r!==!1&&a.transport.abort(a,n),y(a)&&c.transports._logic.stopMonitoringKeepAlive(a),a.transport=null),a._.negotiateRequest&&(a._.negotiateRequest.abort(d),delete a._.negotiateRequest),a._.initHandler&&a._.initHandler.stop(),e(a).triggerHandler(h.onDisconnect),delete a._deferral,delete a.messageId,delete a.groupsToken,delete a.id,delete a._.pingIntervalId,delete a._.lastMessageAt,delete a._.lastActiveAt,a._.connectingMessageBuffer.clear(),a):void 0:(a.log("Stopping connection prior to negotiate."),void(i&&i.reject(c._.error(s.stoppedWhileLoading))))},log:function(e){m(e,this.logging)}},c.fn.init.prototype=c.fn,c.noConflict=function(){return e.connection===c&&(e.connection=l),c},e.connection&&(l=e.connection),e.connection=e.signalR=c}(window.jQuery,window),function(e,t,n){function r(e){e._.keepAliveData.monitoring&&a(e),s.markActive(e)&&(e._.beatHandle=t.setTimeout(function(){r(e)},e._.beatInterval))}function a(t){var n,r=t._.keepAliveData;t.state===c.connectionState.connected&&(n=(new Date).getTime()-t._.lastMessageAt,n>=r.timeout?(t.log("Keep alive timed out.  Notifying transport that connection has been lost."),t.transport.lostConnection(t)):n>=r.timeoutWarning?r.userNotified||(t.log("Keep alive has been missed, connection may be dead/slow."),e(t).triggerHandler(l.onConnectionSlow),r.userNotified=!0):r.userNotified=!1)}function i(e,t){var n=e.url+t;return e.transport&&(n+="?transport="+e.transport.name),s.prepareQueryString(e,n)}function o(e){this.connection=e,this.startRequested=!1,this.startCompleted=!1,this.connectionStopped=!1}var s,c=e.signalR,l=e.signalR.events,p=e.signalR.changeState,u="__Start Aborted__";c.transports={},o.prototype={start:function(e,r,a){var i=this,o=i.connection,s=!1;return i.startRequested||i.connectionStopped?void o.log("WARNING! "+e.name+" transport cannot be started. Initialization ongoing or completed."):(o.log(e.name+" transport starting."),i.transportTimeoutHandle=t.setTimeout(function(){s||(s=!0,o.log(e.name+" transport timed out when trying to connect."),i.transportFailed(e,n,a))},o._.totalTransportConnectTimeout),void e.start(o,function(){s||i.initReceived(e,r)},function(t){return s||(s=!0,i.transportFailed(e,t,a)),!i.startCompleted||i.connectionStopped}))},stop:function(){this.connectionStopped=!0,t.clearTimeout(this.transportTimeoutHandle),c.transports._logic.tryAbortStartRequest(this.connection)},initReceived:function(e,n){var r=this,a=r.connection;return r.startRequested?void a.log("WARNING! The client received multiple init messages."):void(r.connectionStopped||(r.startRequested=!0,t.clearTimeout(r.transportTimeoutHandle),a.log(e.name+" transport connected. Initiating start request."),c.transports._logic.ajaxStart(a,function(){r.startCompleted=!0,n()})))},transportFailed:function(n,r,a){var i,o=this.connection,s=o._deferral;this.connectionStopped||(t.clearTimeout(this.transportTimeoutHandle),this.startRequested?this.startCompleted||(i=c._.error(c.resources.errorDuringStartRequest,r),o.log(n.name+" transport failed during the start request. Stopping the connection."),e(o).triggerHandler(l.onError,[i]),s&&s.reject(i),o.stop()):(n.stop(o),o.log(n.name+" transport failed to connect. Attempting to fall back."),a()))}},s=c.transports._logic={ajax:function(t,n){return e.ajax(e.extend(!0,{},e.signalR.ajaxDefaults,{type:"GET",data:{},xhrFields:{withCredentials:t.withCredentials},contentType:t.contentType,dataType:t.ajaxDataType},n))},pingServer:function(t){var n,r,a=e.Deferred();return t.transport?(n=t.url+"/ping",n=s.addQs(n,t.qs),r=s.ajax(t,{url:n,success:function(e){var n;try{n=t._parseResponse(e)}catch(i){return a.reject(c._.transportError(c.resources.pingServerFailedParse,t.transport,i,r)),void t.stop()}"pong"===n.Response?a.resolve():a.reject(c._.transportError(c._.format(c.resources.pingServerFailedInvalidResponse,e),t.transport,null,r))},error:function(e){401===e.status||403===e.status?(a.reject(c._.transportError(c._.format(c.resources.pingServerFailedStatusCode,e.status),t.transport,e,r)),t.stop()):a.reject(c._.transportError(c.resources.pingServerFailed,t.transport,e,r))}})):a.reject(c._.transportError(c.resources.noConnectionTransport,t.transport)),a.promise()},prepareQueryString:function(e,n){var r;return r=s.addQs(n,"clientProtocol="+e.clientProtocol),r=s.addQs(r,e.qs),e.token&&(r+="&connectionToken="+t.encodeURIComponent(e.token)),e.data&&(r+="&connectionData="+t.encodeURIComponent(e.data)),r},addQs:function(t,n){var r,a=-1!==t.indexOf("?")?"&":"?";if(!n)return t;if("object"==typeof n)return t+a+e.param(n);if("string"==typeof n)return r=n.charAt(0),("?"===r||"&"===r)&&(a=""),t+a+n;throw new Error("Query string property must be either a string or object.")},getUrl:function(e,n,r,a,i){var o="webSockets"===n?"":e.baseUrl,c=o+e.appRelativeUrl,l="transport="+n;return!i&&e.groupsToken&&(l+="&groupsToken="+t.encodeURIComponent(e.groupsToken)),r?(c+=a?"/poll":"/reconnect",!i&&e.messageId&&(l+="&messageId="+t.encodeURIComponent(e.messageId))):c+="/connect",c+="?"+l,c=s.prepareQueryString(e,c),i||(c+="&tid="+Math.floor(11*Math.random())),c},maximizePersistentResponse:function(e){return{MessageId:e.C,Messages:e.M,Initialized:"undefined"!=typeof e.S?!0:!1,ShouldReconnect:"undefined"!=typeof e.T?!0:!1,LongPollDelay:e.L,GroupsToken:e.G}},updateGroups:function(e,t){t&&(e.groupsToken=t)},stringifySend:function(e,t){return"string"==typeof t||"undefined"==typeof t||null===t?t:e.json.stringify(t)},ajaxSend:function(t,n){var r,a=s.stringifySend(t,n),o=i(t,"/send"),p=function(t,a){e(a).triggerHandler(l.onError,[c._.transportError(c.resources.sendFailed,a.transport,t,r),n])};return r=s.ajax(t,{url:o,type:"jsonp"===t.ajaxDataType?"GET":"POST",contentType:c._.defaultContentType,data:{data:a},success:function(e){var n;if(e){try{n=t._parseResponse(e)}catch(r){return p(r,t),void t.stop()}s.triggerReceived(t,n)}},error:function(e,n){"abort"!==n&&"parsererror"!==n&&p(e,t)}})},ajaxAbort:function(e,t){if("undefined"!=typeof e.transport){t="undefined"==typeof t?!0:t;var n=i(e,"/abort");s.ajax(e,{url:n,async:t,timeout:1e3,type:"POST"}),e.log("Fired ajax abort async = "+t+".")}},ajaxStart:function(t,n){var r=function(e){var n=t._deferral;n&&n.reject(e)},a=function(n){t.log("The start request failed. Stopping the connection."),e(t).triggerHandler(l.onError,[n]),r(n),t.stop()};t._.startRequest=s.ajax(t,{url:i(t,"/start"),success:function(e,r,i){var o;try{o=t._parseResponse(e)}catch(s){return void a(c._.error(c._.format(c.resources.errorParsingStartResponse,e),s,i))}"started"===o.Response?n():a(c._.error(c._.format(c.resources.invalidStartResponse,e),null,i))},error:function(e,n,i){n!==u?a(c._.error(c.resources.errorDuringStartRequest,i,e)):(t.log("The start request aborted because connection.stop() was called."),r(c._.error(c.resources.stoppedDuringStartRequest,null,e)))}})},tryAbortStartRequest:function(e){e._.startRequest&&(e._.startRequest.abort(u),delete e._.startRequest)},tryInitialize:function(e,t){e.Initialized&&t()},triggerReceived:function(t,n){t._.connectingMessageBuffer.tryBuffer(n)||e(t).triggerHandler(l.onReceived,[n])},processMessages:function(t,n,r){var a;s.markLastMessage(t),n&&(a=s.maximizePersistentResponse(n),s.updateGroups(t,a.GroupsToken),a.MessageId&&(t.messageId=a.MessageId),a.Messages&&(e.each(a.Messages,function(e,n){s.triggerReceived(t,n)}),s.tryInitialize(a,r)))},monitorKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring?t.log("Tried to monitor keep alive but it's already being monitored."):(n.monitoring=!0,s.markLastMessage(t),t._.keepAliveData.reconnectKeepAliveUpdate=function(){s.markLastMessage(t)},e(t).bind(l.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t.log("Now monitoring keep alive with a warning timeout of "+n.timeoutWarning+", keep alive timeout of "+n.timeout+" and disconnecting timeout of "+t.disconnectTimeout))},stopMonitoringKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring&&(n.monitoring=!1,e(t).unbind(l.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t._.keepAliveData={},t.log("Stopping the monitoring of the keep alive."))},startHeartbeat:function(e){e._.lastActiveAt=(new Date).getTime(),r(e)},markLastMessage:function(e){e._.lastMessageAt=(new Date).getTime()},markActive:function(e){return s.verifyLastActive(e)?(e._.lastActiveAt=(new Date).getTime(),!0):!1},isConnectedOrReconnecting:function(e){return e.state===c.connectionState.connected||e.state===c.connectionState.reconnecting},ensureReconnectingState:function(t){return p(t,c.connectionState.connected,c.connectionState.reconnecting)===!0&&e(t).triggerHandler(l.onReconnecting),t.state===c.connectionState.reconnecting},clearReconnectTimeout:function(e){e&&e._.reconnectTimeout&&(t.clearTimeout(e._.reconnectTimeout),delete e._.reconnectTimeout)},verifyLastActive:function(t){if((new Date).getTime()-t._.lastActiveAt>=t.reconnectWindow){var n=c._.format(c.resources.reconnectWindowTimeout,new Date(t._.lastActiveAt),t.reconnectWindow);return t.log(n),e(t).triggerHandler(l.onError,[c._.error(n,"TimeoutException")]),t.stop(!1,!1),!1}return!0},reconnect:function(e,n){var r=c.transports[n];if(s.isConnectedOrReconnecting(e)&&!e._.reconnectTimeout){if(!s.verifyLastActive(e))return;e._.reconnectTimeout=t.setTimeout(function(){s.verifyLastActive(e)&&(r.stop(e),s.ensureReconnectingState(e)&&(e.log(n+" reconnecting."),r.start(e)))},e.reconnectDelay)}},handleParseFailure:function(t,n,r,a,i){var o=c._.transportError(c._.format(c.resources.parseFailed,n),t.transport,r,i);a&&a(o)?t.log("Failed to parse server response while attempting to connect."):(e(t).triggerHandler(l.onError,[o]),t.stop())},initHandler:function(e){return new o(e)},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic;r.transports.webSockets={name:"webSockets",supportsKeepAlive:function(){return!0},send:function(t,n){var i=o.stringifySend(t,n);try{t.socket.send(i)}catch(s){e(t).triggerHandler(a.onError,[r._.transportError(r.resources.webSocketsInvalidState,t.transport,s,t.socket),n])}},start:function(n,s,c){var l,p=!1,u=this,d=!s,h=e(n);return t.WebSocket?void(n.socket||(l=n.webSocketServerUrl?n.webSocketServerUrl:n.wsProtocol+n.host,l+=o.getUrl(n,this.name,d),n.log("Connecting to websocket endpoint '"+l+"'."),n.socket=new t.WebSocket(l),n.socket.onopen=function(){p=!0,n.log("Websocket opened."),o.clearReconnectTimeout(n),i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&h.triggerHandler(a.onReconnect)},n.socket.onclose=function(t){var i;this===n.socket&&(p&&"undefined"!=typeof t.wasClean&&t.wasClean===!1?(i=r._.transportError(r.resources.webSocketClosed,n.transport,t),n.log("Unclean disconnect from websocket: "+(t.reason||"[no reason given]."))):n.log("Websocket closed."),c&&c(i)||(i&&e(n).triggerHandler(a.onError,[i]),u.reconnect(n)))},n.socket.onmessage=function(t){var r;try{r=n._parseResponse(t.data)}catch(a){return void o.handleParseFailure(n,t.data,a,c,t)}r&&(e.isEmptyObject(r)||r.M?o.processMessages(n,r,s):o.triggerReceived(n,r))})):void c()},reconnect:function(e){o.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},stop:function(e){o.clearReconnectTimeout(e),e.socket&&(e.log("Closing the Websocket."),e.socket.close(),e.socket=null)},abort:function(e,t){o.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic,s=function(e){t.clearTimeout(e._.reconnectAttemptTimeoutHandle),delete e._.reconnectAttemptTimeoutHandle};r.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:function(){return!0},timeOut:3e3,start:function(n,c,l){var p,u=this,d=!1,h=e(n),f=!c;if(n.eventSource&&(n.log("The connection already has an event source. Stopping it."),n.stop()),!t.EventSource)return void(l&&(n.log("This browser doesn't support SSE."),l()));p=o.getUrl(n,this.name,f);try{n.log("Attempting to connect to SSE endpoint '"+p+"'."),n.eventSource=new t.EventSource(p,{withCredentials:n.withCredentials})}catch(m){return n.log("EventSource failed trying to connect with error "+m.Message+"."),void(l?l():(h.triggerHandler(a.onError,[r._.transportError(r.resources.eventSourceFailedToConnect,n.transport,m)]),f&&u.reconnect(n)))}f&&(n._.reconnectAttemptTimeoutHandle=t.setTimeout(function(){d===!1&&n.eventSource.readyState!==t.EventSource.OPEN&&u.reconnect(n)},u.timeOut)),n.eventSource.addEventListener("open",function(e){n.log("EventSource connected."),s(n),o.clearReconnectTimeout(n),d===!1&&(d=!0,i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&h.triggerHandler(a.onReconnect))},!1),n.eventSource.addEventListener("message",function(e){var t;if("initialized"!==e.data){try{t=n._parseResponse(e.data)}catch(r){return void o.handleParseFailure(n,e.data,r,l,e)}o.processMessages(n,t,c)}},!1),n.eventSource.addEventListener("error",function(e){var i=r._.transportError(r.resources.eventSourceError,n.transport,e);this===n.eventSource&&(l&&l(i)||(n.log("EventSource readyState: "+n.eventSource.readyState+"."),e.eventPhase===t.EventSource.CLOSED?(n.log("EventSource reconnecting due to the server connection ending."),u.reconnect(n)):(n.log("EventSource error."),h.triggerHandler(a.onError,[i]))))},!1)},reconnect:function(e){o.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){o.ajaxSend(e,t)},stop:function(e){s(e),o.clearReconnectTimeout(e),e&&e.eventSource&&(e.log("EventSource calling close()."),e.eventSource.close(),e.eventSource=null,delete e.eventSource)},abort:function(e,t){o.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic,s=function(){var e=t.document.createElement("iframe");return e.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),e},c=function(){var e=null,n=1e3,a=0;return{prevent:function(){r._.ieVersion<=8&&(0===a&&(e=t.setInterval(function(){var e=s();t.document.body.appendChild(e),t.document.body.removeChild(e),e=null},n)),a++)},cancel:function(){1===a&&t.clearInterval(e),a>0&&a--}}}();r.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:function(){return!0},iframeClearThreshold:50,start:function(e,n,r){var a,i=this,l=o.foreverFrame.count+=1,p=s(),u=function(){e.log("Forever frame iframe finished loading and is no longer receiving messages."),r&&r()||i.reconnect(e)};return t.EventSource?void(r&&(e.log("Forever Frame is not supported by SignalR on browsers with SSE support."),r())):(p.setAttribute("data-signalr-connection-id",e.id),c.prevent(),a=o.getUrl(e,this.name),a+="&frameId="+l,t.document.documentElement.appendChild(p),e.log("Binding to iframe's load event."),p.addEventListener?p.addEventListener("load",u,!1):p.attachEvent&&p.attachEvent("onload",u),p.src=a,o.foreverFrame.connections[l]=e,e.frame=p,e.frameId=l,void(n&&(e.onSuccess=function(){e.log("Iframe transport started."),n()})))},reconnect:function(e){var n=this;o.isConnectedOrReconnecting(e)&&o.verifyLastActive(e)&&t.setTimeout(function(){if(o.verifyLastActive(e)&&e.frame&&o.ensureReconnectingState(e)){var t=e.frame,r=o.getUrl(e,n.name,!0)+"&frameId="+e.frameId;e.log("Updating iframe src to '"+r+"'."),t.src=r}},e.reconnectDelay)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){o.ajaxSend(e,t)},receive:function(t,n){var a,i,s;if(t.json!==t._originalJson&&(n=t._originalJson.stringify(n)),s=t._parseResponse(n),o.processMessages(t,s,t.onSuccess),t.state===e.signalR.connectionState.connected&&(t.frameMessageCount=(t.frameMessageCount||0)+1,t.frameMessageCount>r.transports.foreverFrame.iframeClearThreshold&&(t.frameMessageCount=0,a=t.frame.contentWindow||t.frame.contentDocument,a&&a.document&&a.document.body)))for(i=a.document.body;i.firstChild;)i.removeChild(i.firstChild)},stop:function(e){var n=null;if(c.cancel(),e.frame){if(e.frame.stop)e.frame.stop();else try{n=e.frame.contentWindow||e.frame.contentDocument,n.document&&n.document.execCommand&&n.document.execCommand("Stop")}catch(r){e.log("Error occured when stopping foreverFrame transport. Message = "+r.message+".")}e.frame.parentNode===t.document.body&&t.document.body.removeChild(e.frame),delete o.foreverFrame.connections[e.frameId],e.frame=null,e.frameId=null,delete e.frame,delete e.frameId,delete e.onSuccess,delete e.frameMessageCount,e.log("Stopping forever frame.")}},abort:function(e,t){o.ajaxAbort(e,t)},getConnection:function(e){return o.foreverFrame.connections[e]},started:function(t){i(t,r.connectionState.reconnecting,r.connectionState.connected)===!0&&e(t).triggerHandler(a.onReconnect)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=e.signalR.isDisconnecting,s=r.transports._logic;r.transports.longPolling={name:"longPolling",supportsKeepAlive:function(){return!1},reconnectDelay:3e3,start:function(n,c,l){var p=this,u=function(){u=e.noop,n.log("LongPolling connected."),c()},d=function(e){return l(e)?(n.log("LongPolling failed to connect."),!0):!1},h=n._,f=0,m=function(n){t.clearTimeout(h.reconnectTimeoutId),h.reconnectTimeoutId=null,i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&(n.log("Raising the reconnect event"),e(n).triggerHandler(a.onReconnect))},g=36e5;n.pollXhr&&(n.log("Polling xhr requests already exists, aborting."),n.stop()),n.messageId=null,h.reconnectTimeoutId=null,h.pollTimeoutId=t.setTimeout(function(){!function i(c,l){var v=c.messageId,y=null===v,b=!y,C=!l,S=s.getUrl(c,p.name,b,C,!0),T={};c.messageId&&(T.messageId=c.messageId),c.groupsToken&&(T.groupsToken=c.groupsToken),o(c)!==!0&&(n.log("Opening long polling request to '"+S+"'."),c.pollXhr=s.ajax(n,{xhrFields:{onprogress:function(){s.markLastMessage(n)}},url:S,type:"POST",contentType:r._.defaultContentType,data:T,timeout:n._.pollTimeout,success:function(r){var a,l,p,g=0;n.log("Long poll complete."),f=0;try{a=n._parseResponse(r)}catch(v){return void s.handleParseFailure(c,r,v,d,c.pollXhr)}null!==h.reconnectTimeoutId&&m(c),a&&(l=s.maximizePersistentResponse(a)),s.processMessages(c,a,u),l&&"number"===e.type(l.LongPollDelay)&&(g=l.LongPollDelay),o(c)!==!0&&(p=l&&l.ShouldReconnect,(!p||s.ensureReconnectingState(c))&&(g>0?h.pollTimeoutId=t.setTimeout(function(){i(c,p)},g):i(c,p)))},error:function(o,l){var u=r._.transportError(r.resources.longPollFailed,n.transport,o,c.pollXhr);if(t.clearTimeout(h.reconnectTimeoutId),h.reconnectTimeoutId=null,"abort"===l)return void n.log("Aborted xhr request.");if(!d(u)){if(f++,n.state!==r.connectionState.reconnecting&&(n.log("An error occurred using longPolling. Status = "+l+".  Response = "+o.responseText+"."),
e(c).triggerHandler(a.onError,[u])),(n.state===r.connectionState.connected||n.state===r.connectionState.reconnecting)&&!s.verifyLastActive(n))return;if(!s.ensureReconnectingState(c))return;h.pollTimeoutId=t.setTimeout(function(){i(c,!0)},p.reconnectDelay)}}}),b&&l===!0&&(h.reconnectTimeoutId=t.setTimeout(function(){m(c)},Math.min(1e3*(Math.pow(2,f)-1),g))))}(n)},250)},lostConnection:function(e){e.pollXhr&&e.pollXhr.abort("lostConnection")},send:function(e,t){s.ajaxSend(e,t)},stop:function(e){t.clearTimeout(e._.pollTimeoutId),t.clearTimeout(e._.reconnectTimeoutId),delete e._.pollTimeoutId,delete e._.reconnectTimeoutId,e.pollXhr&&(e.pollXhr.abort(),e.pollXhr=null,delete e.pollXhr)},abort:function(e,t){s.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){function r(e){return e+p}function a(e,t,n){var r,a=e.length,i=[];for(r=0;a>r;r+=1)e.hasOwnProperty(r)&&(i[r]=t.call(n,e[r],r,e));return i}function i(t){return e.isFunction(t)?null:"undefined"===e.type(t)?null:t}function o(e){for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}function s(e,t){var n,r=e._.invocationCallbacks;o(r)&&e.log("Clearing hub invocation callbacks with error: "+t+"."),e._.invocationCallbackId=0,delete e._.invocationCallbacks,e._.invocationCallbacks={};for(var a in r)n=r[a],n.method.call(n.scope,{E:t})}function c(e,t){return new c.fn.init(e,t)}function l(t,n){var r={qs:null,logging:!1,useDefaultPath:!0};return e.extend(r,n),(!t||r.useDefaultPath)&&(t=(t||"")+"/signalr"),new l.fn.init(t,r)}var p=".hubProxy",u=e.signalR;c.fn=c.prototype={init:function(e,t){this.state={},this.connection=e,this.hubName=t,this._={callbackMap:{}}},constructor:c,hasSubscriptions:function(){return o(this._.callbackMap)},on:function(t,n){var a=this,i=a._.callbackMap;return t=t.toLowerCase(),i[t]||(i[t]={}),i[t][n]=function(e,t){n.apply(a,t)},e(a).bind(r(t),i[t][n]),a},off:function(t,n){var a,i=this,s=i._.callbackMap;return t=t.toLowerCase(),a=s[t],a&&(a[n]?(e(i).unbind(r(t),a[n]),delete a[n],o(a)||delete s[t]):n||(e(i).unbind(r(t)),delete s[t])),i},invoke:function(t){var n=this,r=n.connection,o=e.makeArray(arguments).slice(1),s=a(o,i),c={H:n.hubName,M:t,A:s,I:r._.invocationCallbackId},l=e.Deferred(),p=function(a){var i,o,s=n._maximizeHubResponse(a);e.extend(n.state,s.State),s.Progress?l.notifyWith?l.notifyWith(n,[s.Progress.Data]):r._.progressjQueryVersionLogged||(r.log("A hub method invocation progress update was received but the version of jQuery in use ("+e.prototype.jquery+") does not support progress updates. Upgrade to jQuery 1.7+ to receive progress notifications."),r._.progressjQueryVersionLogged=!0):s.Error?(s.StackTrace&&r.log(s.Error+"\n"+s.StackTrace+"."),i=s.IsHubException?"HubException":"Exception",o=u._.error(s.Error,i),o.data=s.ErrorData,r.log(n.hubName+"."+t+" failed to execute. Error: "+o.message),l.rejectWith(n,[o])):(r.log("Invoked "+n.hubName+"."+t),l.resolveWith(n,[s.Result]))};return r._.invocationCallbacks[r._.invocationCallbackId.toString()]={scope:n,method:p},r._.invocationCallbackId+=1,e.isEmptyObject(n.state)||(c.S=n.state),r.log("Invoking "+n.hubName+"."+t),r.send(c),l.promise()},_maximizeHubResponse:function(e){return{State:e.S,Result:e.R,Progress:e.P?{Id:e.P.I,Data:e.P.D}:null,Id:e.I,IsHubException:e.H,Error:e.E,StackTrace:e.T,ErrorData:e.D}}},c.fn.init.prototype=c.fn,l.fn=l.prototype=e.connection(),l.fn.init=function(t,n){var a={qs:null,logging:!1,useDefaultPath:!0},i=this;e.extend(a,n),e.signalR.fn.init.call(i,t,a.qs,a.logging),i.proxies={},i._.invocationCallbackId=0,i._.invocationCallbacks={},i.received(function(t){var n,a,o,s,c,l;t&&("undefined"!=typeof t.P?(o=t.P.I.toString(),s=i._.invocationCallbacks[o],s&&s.method.call(s.scope,t)):"undefined"!=typeof t.I?(o=t.I.toString(),s=i._.invocationCallbacks[o],s&&(i._.invocationCallbacks[o]=null,delete i._.invocationCallbacks[o],s.method.call(s.scope,t))):(n=this._maximizeClientHubInvocation(t),i.log("Triggering client hub event '"+n.Method+"' on hub '"+n.Hub+"'."),c=n.Hub.toLowerCase(),l=n.Method.toLowerCase(),a=this.proxies[c],e.extend(a.state,n.State),e(a).triggerHandler(r(l),[n.Args])))}),i.error(function(e,t){var n,r;t&&(n=t.I,r=i._.invocationCallbacks[n],r&&(i._.invocationCallbacks[n]=null,delete i._.invocationCallbacks[n],r.method.call(r.scope,{E:e})))}),i.reconnecting(function(){i.transport&&"webSockets"===i.transport.name&&s(i,"Connection started reconnecting before invocation result was received.")}),i.disconnected(function(){s(i,"Connection was disconnected before invocation result was received.")})},l.fn._maximizeClientHubInvocation=function(e){return{Hub:e.H,Method:e.M,Args:e.A,State:e.S}},l.fn._registerSubscribedHubs=function(){var t=this;t._subscribedToHubs||(t._subscribedToHubs=!0,t.starting(function(){var n=[];e.each(t.proxies,function(e){this.hasSubscriptions()&&(n.push({name:e}),t.log("Client subscribed to hub '"+e+"'."))}),0===n.length&&t.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to."),t.data=t.json.stringify(n)}))},l.fn.createHubProxy=function(e){e=e.toLowerCase();var t=this.proxies[e];return t||(t=c(this,e),this.proxies[e]=t),this._registerSubscribedHubs(),t},l.fn.init.prototype=l.fn,e.hubConnection=l}(window.jQuery,window),function(e,t){e.signalR.version="2.2.0"}(window.jQuery),function(e,t,n){"use strict";function r(t,n){return function(){n.apply(t,e.makeArray(arguments))}}function a(t,n){var a,i,o,s,c;for(a in t)if(t.hasOwnProperty(a)){if(i=t[a],!i.hubName)continue;c=n?i.on:i.off;for(o in i.client)if(i.client.hasOwnProperty(o)){if(s=i.client[o],!e.isFunction(s))continue;c.call(i,o,r(i,s))}}}if("function"!=typeof e.signalR)throw new Error("SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.");var i=e.signalR;e.hubConnection.prototype.createHubProxies=function(){var t={};return this.starting(function(){a(t,!0),this._registerSubscribedHubs()}).disconnected(function(){a(t,!1)}),t.transvaultHub=this.createHubProxy("transvaultHub"),t.transvaultHub.client={},t.transvaultHub.server={cancelTransaction:function(n,r){return t.transvaultHub.invoke.apply(t.transvaultHub,e.merge(["CancelTransaction"],e.makeArray(arguments)))},registerClientWithApiKey:function(n){return t.transvaultHub.invoke.apply(t.transvaultHub,e.merge(["RegisterClientWithApiKey"],e.makeArray(arguments)))}},t},i.hub=e.hubConnection("/hp/v3/adapters/transvault",{useDefaultPath:!1}),e.extend(i,i.hub.createHubProxies())}(window.jQuery,window),function(){"use strict";var e={};e.isNumber="[0-9]+",e.isNotEmpty="S+",e.isEmail=".+@.+..+";var t=function(e,t,n){if("undefined"==typeof e)throw new TypeError("Property cannot be undefined.");e+="";var r=new RegExp(t);if(!r.test(e))throw new Error(n)},n=0,r=jQuery.Deferred(),a=function(e){return e.nodeType?(r.resolve(e),r):document.getElementById(e)?(r.resolve(document.getElementById(e)),r):(setTimeout(function(){25>n?(n++,a(e)):r.reject()},25),r)},i=function(e){var t=[],n="";for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n="&"+t.join("&")};window.hp={},hp.types={},hp.types.Event="Event",hp.types.Product="Product",hp.types.Adapter="Adapter",hp.models={},hp.models.Item=function(e,t){this.label=e,this.price=parseFloat(t,2)},hp.models.Options=function(n,r,a,i,o,s,c,l){this.name=c||"Checkout",this.CID=n,this.email=r,t(this.CID,e.isNumber,"Client ID should be digits only."),t(this.email,e.isEmail,"Primary email should be a valid email address."),"undefined"!=typeof o&&(this.ga=o),"undefined"!=typeof l&&(this.subject=l),"undefined"!=typeof a&&(this.repoEmail=a,t(this.repoEmail,e.isEmail,"Secondary email should be a valid email address.")),"undefined"!=typeof i&&(this.showMemoField="true"===i.toString().toLowerCase()?"True":"False"),"undefined"!=typeof s&&(this.orderId=s,t(this.orderId,e.isNumber,"Customer order Id must be a valid number."))},hp.Setup=function(e,t){if(!(e in hp.types))throw new Error("Please specify type. 'hp.Types.Event' or 'hp.Types.Product'");this.type=e,this.options=t,this.hasItems=!1,this.items={priceLabels:"",price:""}},hp.Setup.prototype.addItem=function(e){return this.items.priceLabels+=(""===this.items.price?"":",")+e.label,this.items.price+=(""===this.items.price?"":",")+e.price,this.hasItems=!0,this},hp.Setup.prototype.createForm=function(e,t){var n=jQuery.Deferred(),r=document.createElement("iframe"),o=document.createElement("a");o.href=t,r.setAttribute("seamless","seamless"),r.setAttribute("marginheight","0"),r.setAttribute("marginwidth","0"),r.setAttribute("frameborder","0"),r.setAttribute("horizontalscrolling","no"),r.setAttribute("verticalscrolling","no"),r.style.overflowY="hidden",r.style.border="none",r.width="640",r.className="inactive",r.style.opacity="0",r.style.transition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.webkitTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.mozTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.msTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.oTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)";var s=o.protocol+"//"+o.host;return this.type==hp.types.Event&&(s+="/hp/v1/event",r.height="1311"),this.type==hp.types.Product&&(s+="/hp/v1/item",r.height="1220"),s=s+"?"+i(this.options),s+=this.hasItems?i(this.items):"&price=0",r.src=s.replace("item?&","item?").replace("event?&","event?").toString(),r.onload=function(){n.resolve(r),r.className="active",r.style.opacity="1"},a(e).then(function(e){e.appendChild(r)}),n},$(function(){$("[data-inventory], [data-event]").hp()})}(),function(e,t,n,r){"use strict";Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,a;if(null===this)throw new TypeError(" this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=new Array(o),a=0;o>a;){var s,c;a in i&&(s=i[a],c=e.call(n,s,a,i),r[a]=c),a++}return r}),Function.prototype.clone||(Function.prototype.clone=function(){var e=this;this.__isClone&&(e=this.__clonedFrom);var t=function(){return e.apply(this,arguments)};for(var n in this)t[n]=this[n];return t.__isClone=!0,t.__clonedFrom=e,t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.includes||(String.prototype.includes=function(){return-1!==String.prototype.indexOf.apply(this,arguments)}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),Date.prototype.toISOString||!function(){function e(e){var t=String(e);return 1===t.length&&(t="0"+t),t}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+e(this.getUTCMonth()+1)+"-"+e(this.getUTCDate())+"T"+e(this.getUTCHours())+":"+e(this.getUTCMinutes())+":"+e(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}(),t.hp=hp||{},t.hp.Utils=hp.Utils||{},hp.Utils.defaults={},hp.Utils.plugins={},hp.EntryType={},hp.EntryType.DEVICE_CAPTURED="DEVICE_CAPTURED",hp.EntryType.KEYED_CARD_PRESENT="KEYED_CARD_PRESENT",hp.EntryType.KEYED_CARD_NOT_PRESENT="KEYED_CARD_NOT_PRESENT",hp.PaymentType={},hp.PaymentType.CHARGE="CHARGE",hp.PaymentType.REFUND="REFUND",hp.PaymentType.CREATE_INSTRUMENT="CREATE_INSTRUMENT",hp.PaymentType.CANCEL="CANCEL",hp.PaymentType.ISSUE="ISSUE",hp.PaymentType.ADD_FUNDS="ADD_FUNDS",hp.Utils.payments=[],hp.Utils.hasPaymentInstrument=!1;var a=function(e,t){var n="hp-content-active",r="hp-form-"+e,a=t.find(".hp"),i=a.removeClass("hp-form-emoney hp-form-transvault hp-form-bank hp-form-code hp-form-cc hp-form-gc hp-form-success hp-form-error").addClass("hp hp-form").addClass(r);i.find(".hp-content").removeClass(n);var o=i.find(".hp-content-"+e).addClass(n);return setTimeout(function(){t.find(".hp").addClass("hp-active")},0),{parent:i,content:o}},i=function(e){var t=hp.EntryType.KEYED_CARD_NOT_PRESENT;switch(e=e.toString().toLowerCase().replace(/_/gi,"")){case"devicecaptured":t=hp.EntryType.DEVICE_CAPTURED;break;case"keyedcardpresent":t=hp.EntryType.KEYED_CARD_PRESENT;break;case"keyedcardnotpresent":t=hp.EntryType.KEYED_CARD_NOT_PRESENT;break;default:t=hp.EntryType.KEYED_CARD_NOT_PRESENT}return t},o=function(e){var t=hp.PaymentType.CHARGE;switch(e=e.toString().toLowerCase().replace(/_/gi,"")){case"charge":t=hp.PaymentType.CHARGE;break;case"refund":t=hp.PaymentType.REFUND;break;default:t=hp.PaymentType.CHARGE}return t},s=function(){if("undefined"!=typeof console&&"undefined"!=typeof console.log){for(var e=Array.prototype.slice.call(arguments),t=0;t<e.length;t++){var n=e[t];"string"==typeof n&&(e[t]="Hosted Payments v3 (debug): "+n)}return void console.log.apply(console,e)}},c=function(){return hp.Utils.defaults.version},l=function(e){hp.Utils.defaults.version=e},p=function(){return"undefined"!=typeof hp.Utils.defaults.instrumentId&&""!==hp.Utils.defaults.instrumentId?void(hp.Utils.hasPaymentInstrument=!0):void(hp.Utils.hasPaymentInstrument=!1)},u=function(){var e=null;e=t.performance&&t.performance.now?t.performance.now():Date.now?Date.now():(new Date).getTime();var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return n},d=function(e,t){"undefined"==typeof t&&(t=""),"undefined"==typeof e&&(e=""),hp.Utils.defaults.billingAddress.addressLine1=e,hp.Utils.defaults.billingAddress.postalCode=t},h=function(){e(".hp-error-container").is(":visible")&&g(),e(".hp-loading-container").addClass("hp-loading-container-active")},f=function(){e(".hp-loading-container").removeClass("hp-loading-container-active")},m=function(t){e(".hp-loading-container").is(":visible")&&f(),e(".hp-error-container").addClass("hp-error-container-active");var n=e(".hp-error-container .hp-error-message"),r="undefined"!=typeof t&&"undefined"!=typeof t.push,a='<p>Please review the following errors: </p><ul class="hp-error-message-list">{{errors}}</ul>';if(r){for(var i="",o=0;o<t.length;o++)i+="<li>"+t[o]+"</li>";a=a.replace("{{errors}}",i),n.html(a)}else n.text(t);e(".hp-error-container .hp-error-disclaimer a").on("click",g)},g=function(){e(".hp-error-container").removeClass("hp-error-container-active"),e(".hp-error-container .hp-error-disclaimer a").off("click"),hp.Utils.defaults.onErrorDismissCallback()},v=function(t,n){var r=['<div class="hp hp-form">','<div class="hp-loading-container">','<span class="hp-loading-text">Loading</span>','<div class="hp-loading"><span></span><span></span><span></span><span></span></div>',"</div>",'<div class="hp-error-container">','<span class="hp-error-text">{{error}} </span>','<div class="hp-error-message"></div>',"<hr />",'<div class="hp-error-disclaimer">If you feel that the above error was made by a mistake please contact our support at {{phone}}. <br /><br /><a href="javascript:;">&times; Dismiss error</a></div>',"</div>",'<div class="hp-row">','<div class="hp-col hp-col-left">','<ul class="hp-nav">',"{{nav}}","</ul>",'<div class="hp-support">',"<strong>Help &amp; support</strong>","<p>Having issues with your payments? Call us at {{phone}}.</p>","</div>",'<div class="hp-secure">','<div class="hp-cards">','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/106383645ba54667a82be0a6af599d8c/raw/18bfa3c78067a3104ce0025911900b2813442da2/amex-card-icon.svg" alt="AMEX" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/6928189390fabc35274fb4c5e050d97a/raw/5ace5093fbd78be1f2ec1b1b3a98cf8a9ae847b8/diners-card-icon.svg" alt="Diners" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/97bdce0c2be41b5e3e7d42f665d7e579/raw/94e5724101103c8c427192cdf5e5e04581240b1f/discover-card-icon.svg" alt="Discover" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/4df8161921e2349011bd7129a647be60/raw/cd7984e257825f010ebd38448bcad762b353f216/jcb-card-icon.svg" alt="JCB" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/25c8538814ffa61a43cb86bd71601f92/raw/cd7c9ff69acd3cb77be6dca4e9ff65aa5e3b8d36/mastercard-card-icon.svg" alt="Master Card" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/8f367f38b7ffb77b1a1a7e13de9c2731/raw/086944f18033f96996e18aa03e1393565b0b16dc/visa-card-icon.svg" alt="VISA" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/c2568c3f7343be79032ac7a717fa80de/raw/7923fdf2aacffbc6baf62454cc4213b46b943596/emoney-card-icon.svg" alt="EMoney" />','<img class="hp-cards-icons" src="https://cdn.rawgit.com/etsms/cd2abb29142a84bb16fbeb3d07a7aefa/raw/a17760bdd23cf1d90c22c8a2235f8d6e6753663e/gift-card-icon.svg" alt="Gift Cards" />',"</div>",'<a class="hp-secure-icon" href="https://www.etsms.com/" target="_blank" title="ETS - Electronic Transaction Systems">','<img src="https://cdn.rawgit.com/etsms/a5b6be8ebd898748ec829538bd4b603e/raw/df1b8a1e296ea12b90742328d036848af19fef1f/secure-icon.svg" alt="Secured by ETS" />',"</a>",'<small class="hp-version">','<span class="'+(0===hp.Utils.getAmount()||hp.Utils.defaults.ignoreSubmission===!0?"hide ":"")+(hp.Utils.defaults.paymentType===hp.PaymentType.CHARGE?"hp-version-charge":"hp-version-refund")+'">'+(hp.Utils.defaults.paymentType===hp.PaymentType.CHARGE?"Charge":"Refund")+' amount: <span class="hp-version-amount">'+hp.Utils.formatCurrency(hp.Utils.getAmount())+"</span></span><br />","Hosted Payments "+hp.Utils.getVersion(),"</small>","</div>","</div>",'<div class="hp-col hp-col-right">',"{{order}}",'<div class="hp-content hp-content-success">{{success}}</div>',"</div>","</div>","</div>"].join("");hp.Utils.plugins.CreditCard=new hp.CreditCard(t),hp.Utils.plugins.BankAccount=new hp.BankAccount(t),hp.Utils.plugins.Code=new hp.Code(t),hp.Utils.plugins.Success=new hp.Success(t),hp.Utils.plugins.Transvault=new hp.Transvault(t),hp.Utils.plugins.GiftCard=new hp.GiftCard(t),t.html(r.replace("{{success}}",hp.Utils.plugins.Success.createTemplate().replace("{{redirectLabel}}",hp.Utils.defaults.defaultRedirectLabel).replace("{{successLabel}}",hp.Utils.defaults.defaultSuccessLabel)).replace(/{{phone}}/gi,hp.Utils.defaults.defaultPhone).replace("{{error}}",hp.Utils.defaults.defaultErrorLabel).replace("{{order}}",hp.Utils.createOrder()).replace("{{nav}}",hp.Utils.createNav()));var a=t.find(".hp"),i=a.find(".hp-type"),o="hp-active";if(!a.length)throw new Error("hosted-payments.js : Could not locate template.");if(!i.length)throw new Error("hosted-payments.js : Could not locate template.");i.off("click").on("click",function(t){t.preventDefault();var r=e(this),a=r.index();i.removeClass(o).eq(a).addClass(o),e(function(){r.attr("class").match(/hp-cc/gi)&&n(hp.Utils.plugins.CreditCard),r.attr("class").match(/hp-bank/gi)&&n(hp.Utils.plugins.BankAccount),r.attr("class").match(/hp-emoney/gi)&&n(hp.Utils.plugins.EMoney),r.attr("class").match(/hp-code/gi)&&(r.find("a").blur(),n(hp.Utils.plugins.Code)),r.attr("class").match(/hp-transvault/gi)&&n(hp.Utils.plugins.Transvault),r.attr("class").match(/hp-gc/gi)&&n(hp.Utils.plugins.GiftCard)})}).eq(0).trigger("click")},y=function(t){var n=jQuery.Deferred(),r="undefined"==typeof t?0:t;return setTimeout(function(){hp.Utils.hideError(),hp.Utils.hideLoader(),hp.Utils.plugins.Success.init(),e(".hp-col-left .hp-type").off("click").removeClass("hp-active"),n.resolve()},r),n},b=function(t){hp.Utils.defaults.amount=Math.abs(Math.round10(parseFloat(t),-2)),e(".hp.hp-form .hp-version-amount").text(I(hp.Utils.defaults.amount))},C=function(){return hp.Utils.defaults.amount},S=function(){var e=hp.Utils.defaults.paymentTypeOrder,t="",n="",r="",a="",i="",o="";e.indexOf(0)>=0&&(n='<li class="hp-type hp-cc"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/9e2e4c55564ca8eba12f9fa3e7064299/raw/93965040e6e421e1851bfe7a15af92bdc722fa43/credt-card-icon.svg" alt="Credit Card" /> <span>Credit Card</span></a></li>'),e.indexOf(1)>=0&&(r='<li class="hp-type hp-bank"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/af49afe3c1c1cb41cb3204a45492bd47/raw/78e935c7e5290923dba15e8b595aef7c95b2292e/ach-icon.svg" alt="ACH and Bank Account" /> <span>Bank (ACH)</span></a></li>'),e.indexOf(2)>=0&&(a='<li class="hp-type hp-code"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/c70317acba59d3d5b60e5999d5feeab8/raw/764478d2660f97d002eb3bd3177b725a410f694d/swipe-icon.svg" alt="Swipe or Scan" /> <span>Swipe\\Scan</span></a></li>'),e.indexOf(3)>=0&&(i='<li class="hp-type hp-transvault"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/5363122967f20bd31d6630529cb17c3f/raw/0a0ae6a30247ced8ed5c0c85f2b42072b59b8fba/transvault-icon.svg" alt="Hosted Transvault" /> <span>Transvault</span></a></li>'),e.indexOf(4)>=0&&(o='<li class="hp-type hp-gc"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/2e9f0f3bb754a7910ffbdbd16ea9926a/raw/27ce16494e375ff8d04deb918ffd76d743397488/gift-icon.svg" alt="Gift Card" /> <span>Gift Card</span></a></li>');for(var s=0;s<e.length;s++)0===e[s]&&(t+=n),1===e[s]&&(t+=r),2===e[s]&&(t+=a),3===e[s]&&(t+=i),4===e[s]&&(t+=o);return t},T=function(){var e=hp.Utils.defaults.paymentTypeOrder,t="",n="",r="",a="",i="",o="";e.indexOf(0)>=0&&(n='<div class="hp-content hp-content-cc">{{creditCard}}</div>'.replace("{{creditCard}}",hp.Utils.plugins.CreditCard.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardName,hp.Utils.defaults.defaultDateCharacters))),e.indexOf(1)>=0&&(r='<div class="hp-content hp-content-bank">{{bankAccount}}</div>'.replace("{{bankAccount}}",hp.Utils.plugins.BankAccount.createTemplate(hp.Utils.defaults.defaultName,hp.Utils.defaults.defaultAccountNumberCharacters,hp.Utils.defaults.defaultRoutingNumberCharacters))),e.indexOf(2)>=0&&(a='<div class="hp-content hp-content-code">{{code}}</div>'.replace("{{code}}",hp.Utils.plugins.Code.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardNameSwipe,hp.Utils.defaults.defaultDateCharacters))),e.indexOf(3)>=0&&(i='<div class="hp-content hp-content-transvault">{{transvault}}</div>'.replace("{{transvault}}",hp.Utils.plugins.Transvault.createTemplate())),e.indexOf(4)>=0&&(o='<div class="hp-content hp-content-gc">{{giftcard}}</div>'.replace("{{giftcard}}",hp.Utils.plugins.GiftCard.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardName,+(new Date).getFullYear().toString().substring(2,4)+3)));for(var s=0;s<e.length;s++)0===e[s]&&(t+=n),1===e[s]&&(t+=r),2===e[s]&&(t+=a),3===e[s]&&(t+=i),4===e[s]&&(t+=o);return t},_=function(e,t){var n=E();e.length<=36&&!t&&(n.sessionToken=e),t&&(n.apiKey=e),hp.Utils.defaults.session=n},E=function(){var e={};return e.sessionToken="",e.apiKey="",e.sessionToken=hp.Utils.defaults.session&&hp.Utils.defaults.session.sessionToken?hp.Utils.defaults.session.sessionToken:"",e.apiKey=hp.Utils.defaults.session&&hp.Utils.defaults.session.apiKey?hp.Utils.defaults.session.apiKey:"",e},U=function(t){var n=jQuery.Deferred(),a=function(e){var t=!1;return"undefined"!=typeof e.properties&&"undefined"!=typeof e.properties.accountNumber&&(t=!0),t},i=function(e){return a(e)?!1:"undefined"==typeof e.type||"emoney"!==e.type.toLowerCase()&&"creditcard"!==e.type.toLowerCase()&&"ach"!==e.type.toLowerCase()?!1:!0},o=function(e){return a(e)?!1:i(e)?!1:"undefined"!=typeof e.properties&&"undefined"!=typeof e.properties.cardNumber?!0:!1},s=function(e){return a(e)?!1:i(e)?!1:o(e)?!1:"undefined"==typeof e.properties||"undefined"==typeof e.properties.trackOne&&"undefined"==typeof e.properties.trackTwo&&"undefined"==typeof e.properties.trackThree?!1:!0};if("function"!=typeof t.splice){var c=[];return c.push(t),U(c)}for(var l=[],p=0===hp.Utils.getAmount(),u=0;u<t.length;u++){var d=t[u],h=(new Date).toISOString(),f=d.request,m="Transaction processed.",g=E(),v="",y="",b="",C="",S=d.isException?!0:!1,T="Success",_=f.__request,w=f.__request.__swipe,k=a(_),A=i(_),D=o(_),R=s(_),N="undefined"!=typeof w;if(k&&(m="Transaction pending.",v=_.properties.accountNumber.substr(_.properties.accountNumber.length-4)+"",y=_.name,b="ACH"),A){var I=_.type.toLowerCase();"ach"===I?(y=_.bankName,v=_.accountNumber.replace(/\*/gi,"")):"creditcard"===I?(y=_.nameOnCard,v=_.cardNumber.substr(_.cardNumber.length-4)+"",C=_.properties.expirationDate):(y=_.email,v=_.cardNumber.substr(_.cardNumber.length-4)+""),b="EMONEY"}D&&(v=_.properties.cardNumber.substr(_.properties.cardNumber.length-4)+"",y=_.properties.nameOnCard,b=e.payment.cardType(_.properties.cardNumber).toUpperCase(),C=_.properties.expirationDate),S&&(T="Error"),N&&(v=w.cardNumber.substr(w.cardNumber.length-4),y=w.nameOnCard,b=e.payment.cardType(w.cardNumber).toUpperCase(),C=w.expMonth+"/"+w.expYear),p?m="Payment instrumented created.":hp.Utils.defaults.PaymentType===hp.PaymentType.REFUND&&(m="Transaction refunded.");var x={status:T,amount:f.amount,message:S?d.description:m,token:g.sessionToken,transaction_id:d.transactionId,transaction_approval_code:"",transaction_avs_street_passed:!1,transaction_avs_postal_code_passed:!1,transaction_currency:"USD$",transaction_status_indicator:"",transaction_type:hp.Utils.defaults.paymentType,transaction_tax:0,transaction_surcharge:0,transaction_gratuity:0,transaction_cashback:0,transaction_total:f.amount,correlation_id:G(),instrument_id:f.instrumentId,instrument_type:b,instrument_last_four:v,instrument_expiration_date:C,instrument_verification_method:"",instrument_entry_type:hp.Utils.defaults.entryType,instrument_entry_type_description:R?"MAGNETIC_SWIPE":"KEY_ENTRY",instrument_verification_results:"",created_on:h,customer_name:y,customer_signature:"https://images.pmoney.com/00000000",anti_forgery_token:hp.Utils.defaults.antiForgeryToken,application_identifier:"Hosted Payments",application_response_code:"",application_issuer_data:""};l.push(x)}if(p)n.resolve(l);else{var F=l.length||0,P=0;e.each(l,function(e){var t={status:{statusRequest:{token:hp.Utils.getSession().sessionToken,transactionId:l[e].transaction_id}}};hp.Utils.makeRequest(t).then(function(e){if("Transaction"===e.type&&"undefined"!=typeof e.properties){var t="BankAccount"===e.properties.accountType;l[P].transaction_approval_code=t?"":e.properties.approvalCode,l[P].transaction_avs_postal_code_passed=t?!0:e.properties.postalCodeCheck,l[P].transaction_avs_street_passed=t?!0:e.properties.addressLine1Check,l[P].customer_signature=null===e.properties.signatureRef||e.properties.signatureRef===r||""===e.properties.signatureRef?"https://images.pmoney.com/00000000":e.properties.signatureRef,l[P].message=(l[P].message+" "+(e.properties.message+".")).toLowerCase().replace(" .",""),l[P].instrument_verification_results=t?!1:!0,l[P].instrument_verification_method=t?"":"SIGNATURE"}P+=1,P===F&&n.resolve(l)})})}return n},w={};w.SIGN_IN="signIn",w.SIGN_IN_REQUEST="signInRequest",w.SIGN_IN_RESPONSE="signInResponse",w.CHARGE="charge",w.CHARGE_REQUEST="chargeRequest",w.CHARGE_RESPONSE="chargeResponse",w.REFUND="refund",w.REFUND_REQUEST="refundRequest",w.REFUND_RESPONSE="refundResponse",w.TRANSVAULT="transvault",w.TRANSVAULT_REQUEST="transvaultRequest",w.TRANSVAULT_RESPONSE="transvaultResponse",w.CREATE_PAYMENT_INSTRUMENT="createPaymentInstrument",w.CREATE_PAYMENT_INSTRUMENT_REQUEST="createPaymentInstrumentRequest",w.CREATE_PAYMENT_INSTRUMENT_RESPONSE="createPaymentInstrumentResponse",w.WALLET="wallet",w.WALLET_REQUEST="walletRequest",w.WALLET_RESPONSE="walletResponse",w.STATUS="status",w.STATUS_REQUEST="statusRequest",w.STATUS_RESPONSE="statusResponse";var k=function(e){var t="",n="",r="",a={},i=!1;if(w.SIGN_IN in e&&(t=w.SIGN_IN,n=w.SIGN_IN_REQUEST,r=w.SIGN_IN_RESPONSE),w.CHARGE in e&&(t=w.CHARGE,n=w.CHARGE_REQUEST,r=w.CHARGE_RESPONSE),w.REFUND in e&&(t=w.REFUND,n=w.REFUND_REQUEST,r=w.REFUND_RESPONSE),w.TRANSVAULT in e&&(t=w.TRANSVAULT,n=w.TRANSVAULT_REQUEST,r=w.TRANSVAULT_RESPONSE),w.CREATE_PAYMENT_INSTRUMENT in e&&(t=w.CREATE_PAYMENT_INSTRUMENT,n=w.CREATE_PAYMENT_INSTRUMENT_REQUEST,r=w.CREATE_PAYMENT_INSTRUMENT_RESPONSE),w.WALLET in e&&(t=w.WALLET,n=w.WALLET_REQUEST,r=w.WALLET_RESPONSE),w.STATUS in e&&(t=w.STATUS,n=w.STATUS_REQUEST,r=w.STATUS_RESPONSE),w.CHARGE_RESPONSE in e&&(t=w.CHARGE_RESPONSE,i=!0),w.REFUND_RESPONSE in e&&(t=w.REFUND_RESPONSE,i=!0),w.TRANSVAULT_RESPONSE in e&&(t=w.TRANSVAULT_RESPONSE,i=!0),w.SIGN_IN_RESPONSE in e&&(t=w.SIGN_IN_RESPONSE,i=!0),w.CREATE_PAYMENT_INSTRUMENT_RESPONSE in e&&(t=w.CREATE_PAYMENT_INSTRUMENT_RESPONSE,i=!0),w.WALLET_RESPONSE in e&&(t=w.WALLET_RESPONSE,i=!0),w.STATUS_RESPONSE in e&&(t=w.STATUS_RESPONSE,i=!0),""===t)throw new Error("hosted-payments.utils.js - Could not parse data from response/request object.");if(i)a=e[t];else if("undefined"!=typeof e[t][r])a=e[t][r];else{if("undefined"==typeof e[t][n])throw new Error("hosted-payments.utils.js - Could not parse data from response/request object.");a=e[t][n]}return a},A=function(t){var n=jQuery.Deferred();return hp.Utils.defaults.promptForAvs?("undefined"==typeof t&&(t=e(".hp-form")),t.find(".hp-avs-prompt").length&&t.find(".hp-avs-prompt").remove(),setTimeout(function(){var r=['<div class="hp-avs-prompt">','<div class="hp-avs-prompt-container">',"<p>Billing Address</p>",'<div class="hp-avs-prompt-left">','<label class="hp-label-avs" for="avsStreet">Address <span class="hp-avs-required">*</span></label>','<div class="hp-input hp-input-avs hp-input-avs-street">','<input placeholder="Street Address" value="'+hp.Utils.defaults.billingAddress.addressLine1+'" name="avsStreet" id="avsStreet" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>",'<div class="hp-avs-prompt-right">','<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">City</label>','<div class="hp-input hp-input-avs hp-input-avs-city">','<input placeholder="City" autocomplete="on" type="text">',"</div>","</div>",'<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">State</label>','<div class="hp-input hp-input-avs hp-input-avs-state">','<input placeholder="State" autocomplete="on" type="text">',"</div>","</div>",'<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">Zip <span class="hp-avs-required">*</span></label>','<div class="hp-input hp-input-avs hp-input-avs-zip">','<input placeholder="Zipcode" value="'+hp.Utils.defaults.billingAddress.postalCode+'" name="avsZip" id="avsZip" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>","</div>",'<br class="hp-break" />',"<hr>",'<button class="hp-submit hp-avs-submit">Submit Payment</button>',hp.Utils.defaults.allowAvsSkip?'<a class="hp-avs-skip" href="javascript:;">Skip \'Address Verification\'</a>':"","</div>","</div>"].join("");t.prepend(r);var a=t.find(".hp-avs-prompt"),i="",o="",s=function(e){e.preventDefault(),hp.Utils.updateAvsInfo(o,i),t.removeClass("hp-avs-active"),a.removeClass("active"),n.resolve(),setTimeout(function(){t.find(".hp-avs-prompt").remove()},0)};a.find(".hp-input-avs input").on("focus blur keyup",function(t){t.preventDefault(),"avsStreet"===e(this).attr("name")&&(o=e(this).val()),"avsZip"===e(this).attr("name")&&(i=e(this).val());var n=t.keyCode?t.keyCode:t.which;13===n&&s(t)}),a.find(".hp-avs-submit").on("click",s),hp.Utils.defaults.allowAvsSkip&&a.find(".hp-avs-skip").on("click",function(e){e.preventDefault(),t.removeClass("hp-avs-active"),a.removeClass("active"),n.resolve(),setTimeout(function(){t.find(".hp-avs-prompt").remove()},0),hp.Utils.defaults.onAvsDismissCallback()}),t.addClass("hp-avs-active"),a.addClass("active")},0),t.find(".hp-input-avs-street input").focus(),n):(n.resolve(),n)},D=function(t,n){var r=jQuery.Deferred(),a={url:hp.Utils.defaults.baseUrl+encodeURI("?dt="+(new Date).getTime()),type:"POST",dataType:"json",contentType:"application/json",crossDomain:!0,data:JSON.stringify(t)};return"emoney"===hp.Utils.defaults.paymentService.toLowerCase()&&(a.headers={"X-EMoney-Manager":u()}),n&&(a.async=!1),e.ajax(a).success(function(e){var n=k(t);if(e.error)return e.error.request=n,
void r.resolve(e.error);var a=k(e);a.request=n,r.resolve(a)}).error(r.reject),r},R=function(t){var n=hp.Utils.__instance.element;try{e.connection.hub.stop()}catch(r){}e(n).empty(),hp.Utils.__instance.element=n,"undefined"!=typeof t.entryType&&(t.entryType=hp.Utils.setEntryType(t.entryType)),"undefined"!=typeof t.paymentType&&(t.paymentType=hp.Utils.setPaymentType(t.paymentType)),hp.Utils.defaults=jQuery.extend({},hp.Utils.defaults,t),hp.Utils.__instance.init(),hp.Utils.__instance=hp.Utils.__instance},N=function(){var e=jQuery.Deferred(),t=(new Date).toISOString(),n=E().sessionToken,r=E().apiKey;return hp.Utils.makeRequest({signIn:{signInRequest:{apiKey:r}}}).then(function(t){hp.Utils.setSession(t.token),e.resolve(t)},function(r){var a={status:"Error",message:"We're sorry. Payments cannot accepted at this time. Please try again later.",created_on:t,token:n};hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(a).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(a.message),hp.Utils.defaults.errorCallback(a)),e.reject()}),e},I=function(e){var t=e.toFixed(2).split(".");return t[0]=t[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1,").split("").reverse().join(""),"$"+t.join(".")},x=!1,F=function(){x||"localhost"!==location.hostname&&""!==location.hostname||(x=!0),"https:"===location.protocol||x||hp.Utils.showError("This connection is untrusted. Make sure you're visting this website using 'HTTPS'!")},P=function(t,n){var r=0,a={url:hp.Utils.defaults.baseUrl+encodeURI("?dt="+(new Date).getTime()),type:"POST",dataType:"json",contentType:"application/json",crossDomain:!0,data:JSON.stringify({balance:{balanceRequest:{token:t,cardNumber:n}}}),async:!1};return"emoney"===hp.Utils.defaults.paymentService.toString().toLowerCase()&&(a.headers={"X-EMoney-Manager":u()}),e.ajax(a).success(function(e){e.balanceResponse&&(r=e.balanceResponse.balance)}).error(function(){r=0}),r},$=function(e){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},O=function(e,t){var n=[];return("undefined"==typeof e.email||""===e.email)&&n.push({type:"email",message:"Please provide an email address."}),"undefined"==typeof e.email||$(e.email)||n.push({type:"email",message:"The email provided did not validate."}),("undefined"==typeof e.password||""===e.password)&&n.push({type:"password",message:"Please provide a password."}),"undefined"!=typeof e.password&&e.password.length<=6&&n.push({type:"password",message:"Please provide a valid password."}),n.length?t(n,e):t(null,e)},M=function(e,t){var n=[];return("undefined"==typeof e.accountNumber||""===e.accountNumber)&&n.push({type:"accountNumber",message:"Account number on card cannot be empty."}),"undefined"!=typeof e.accountNumber&&e.accountNumber.length<=8&&n.push({type:"accountNumber",message:"The account number must be atleast 8 characters."}),("undefined"==typeof e.routingNumber||""===e.routingNumber)&&n.push({type:"routingNumber",message:"Routing number be empty."}),"undefined"!=typeof e.routingNumber&&9!==e.routingNumber.length&&n.push({type:"routingNumber",message:"Routing number must be 9 characters."}),("undefined"==typeof e.name||""===e.name)&&n.push({type:"name",message:"Name cannot be empty."}),"undefined"!=typeof e.name&&e.name.length<=1&&n.push({type:"name",message:"Name must be greater than one character."}),n.length?t(n,e):t(null,e)},j=function(){var e=hp.Utils.defaults;return"function"!=typeof e.errorCallback&&"undefined"!=typeof e.errorCallback?!0:!1},L=function(){var e=hp.Utils.defaults;return"function"!=typeof e.successCallback&&"undefined"!=typeof e.successCallback?!0:!1},H=function(t,n){var r=[];return e.payment.validateCardNumber(t.cardNumber)||r.push({type:"cc",message:"Card number is invalid."}),e.payment.validateCardExpiry(t._expiryMonth,t._expiryYear)||r.push({type:"date",message:"Expiration date is invalid."}),e.payment.validateCardCVC(t.cvv,t.cardType)||r.push({type:"cvv",message:"CVV is not valid for this card type."}),("undefined"==typeof t.name||""===t.name)&&r.push({type:"name",message:"Name on card cannot be empty."}),"undefined"!=typeof t.name&&t.name.length<=1&&r.push({type:"name",message:"Name on card must be greater than one character."}),r.length?n(r,t):n(null,t)},q=function(){var t="";return""===hp.Utils.defaults.antiForgeryToken||""===hp.Utils.defaults.antiForgeryName?null:(t=hp.Utils.defaults.antiForgeryToken.startsWith(".")||hp.Utils.defaults.antiForgeryToken.startsWith("#")||hp.Utils.defaults.antiForgeryToken.includes("[")?e(hp.Utils.defaults.antiForgeryToken).eq(0).val()||e(hp.Utils.defaults.antiForgeryToken).eq(0).text():hp.Utils.defaults.antiForgeryToken,"undefined"==typeof t||""===t?null:e("<input />",{type:"hidden",name:hp.Utils.defaults.antiForgeryName,value:t}))},V=function(t){var r=jQuery.Deferred(),a=q();return setTimeout(function(){var i="FRM"+(new Date).getTime().toString(),o=e("<form />",{method:"POST",id:i});if(!e.isEmptyObject(t)){if("function"==typeof t.push)for(var s=t.length-1;s>=0;s--){var c=t[s];for(var l in c)o.append(e("<input />",{type:"hidden",name:l+"["+s+"]",value:c[l]}))}else for(var p in t)o.append(e("<input />",{type:"hidden",name:p,value:t[p]}));return a&&o.append(a),e(n.body).prepend(o),r.resolve(e("#"+i))}return r.reject()},0),r},W=function(){return hp.Utils.defaults.terminalId||""},G=function(){return hp.Utils.defaults.correlationId.length?hp.Utils.defaults.correlationId:u()},Q=function(e){var t="hp-form-mobile",n="hp-form-tablet",r="hp-form-desktop",a=e.outerWidth(!0,!0),i=e.find(".hp");i.removeClass(t).removeClass(n).removeClass(r),setTimeout(function(){return a>=615?void i.addClass(r):a>=420?void i.addClass(n):a>=320?void i.addClass(t):void 0},0)},B=function(e){var t={status:"Error",message:"Your session is no longer valid. Please refresh your page and try again.",created_on:(new Date).toISOString(),token:E().sessionToken};if("undefined"==typeof e)return void(hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t)));var n="";n="undefined"!=typeof e.message?e.message:"undefined"!=typeof e.description?e.description:"undefined"!=typeof e.error&&"undefined"!=typeof e.error.description?e.error.description:e,t.message=n,hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t))},Y=function(e){var t={status:"Error",message:"Your session is no longer valid. Please refresh your page and try again.",created_on:(new Date).toISOString(),token:E().sessionToken};if("undefined"==typeof e)return void(hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t)));var n=e.length>1?e:e[0];hp.Utils.shouldSuccessPostBack()?hp.Utils.buildFormFromObject(n).then(function(e){e.attr("action",hp.Utils.defaults.successCallback).submit()}):hp.Utils.defaults.successCallback(n)},K=function(t){var n=jQuery.Deferred();return hp.Utils.createInstance(t,function(r){var a=t;a.find(".hp-submit"),a.find(".hp-input"),e.noop();hp.Utils.checkHttpsConnection(),r.init(),r.attachEvents(),r.isTransvault()&&a.off().on("hp.transvaultSuccess",function(e,t){var n=t;r.showSuccess(),hp.Utils.hideLoader(),hp.Utils.shouldSuccessPostBack()?hp.Utils.buildFormFromObject(n).then(function(e){e.attr("action",hp.Utils.defaults.successCallback).submit()}):hp.Utils.defaults.successCallback(n)}).on("hp.transvaultError",function(t,n){var r="",a=!1;"undefined"!=typeof n&&"undefined"!=typeof n.error?r=n.error.description:"undefined"!=typeof n&&"undefined"==typeof n.error?r=n:(r="Unable to parse message from server. Most likely an unhandled event.",a=!0);var i={status:a?"Warning":"Error",message:r,created_on:createdOn,token:sessionId};if(a)return console.warn(i),void console.dir(n);hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(i).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(i.message),hp.Utils.defaults.errorCallback(i));try{e.connection.hub.stop()}catch(t){}}),(r.isCode()||r.isBankAccount()||r.isCreditCard()||r.isGiftCard())&&a.off().on("hp.submit",function(e,t){t.type===r.requestTypes.charge&&(r.handleSuccess(t.res),hp.Utils.hideLoader()),t.type===r.requestTypes.error&&(r.handleError(t.res),hp.Utils.hideLoader()),r.clearInputs()}),n.resolve()}),n};hp.Utils.handleLegacyCssClassApplication=a,hp.Utils.makeRequest=D,hp.Utils.validateCreditCardData=H,hp.Utils.validateBankAccountData=M,hp.Utils.validateEMoneyData=O,hp.Utils.buildFormFromObject=V,hp.Utils.buildAntiForgeryInput=q,hp.Utils.createInstance=v,hp.Utils.showSuccessPage=y,hp.Utils.getAmount=C,hp.Utils.setAmount=b,hp.Utils.getSession=E,hp.Utils.setSession=_,hp.Utils.getBalance=P,hp.Utils.formatCurrency=I,hp.Utils.buildResultObjectByType=U,hp.Utils.generateGuild=u,hp.Utils.createOrder=T,hp.Utils.createNav=S,hp.Utils.getCorrelationId=G,hp.Utils.setContainerClass=Q,hp.Utils.shouldSuccessPostBack=L,hp.Utils.shouldErrorPostBack=j,hp.Utils.getTerminalId=W,hp.Utils.getVersion=c,hp.Utils.setVersion=l,hp.Utils.showLoader=h,hp.Utils.hideLoader=f,hp.Utils.showError=m,hp.Utils.hideError=g,hp.Utils.setPaymentInstrument=p,hp.Utils.log=s,hp.Utils.setEntryType=i,hp.Utils.setPaymentType=o,hp.Utils.updateAvsInfo=d,hp.Utils.promptAvs=A,hp.Utils.checkHttpsConnection=F,hp.Utils.handleError=B,hp.Utils.handleSuccess=Y,hp.Utils.signIn=N,hp.Utils.setupPluginInstances=K,hp.Utils.reset=R}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.formData={_isValid:!1}}t.hp=hp||{},a.prototype.init=function(){var e=hp.Utils.handleLegacyCssClassApplication("success",this.$element),t=e.parent,n=e.content;t.find(".icon.success").addClass("animate").show(),this.context=e,this.$parent=t,this.$content=n},a.prototype.createTemplate=function(){var e=['<div class="hp-success-visual"></div>','<h2 class="hp-success-label">{{successLabel}}</h2>','<p class="text-muted">{{redirectLabel}}</p>'].join("");return e},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!0},a.prototype.isCode=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.Success=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$loader=null,this.$element=e,this.formData={_isValid:!1},this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9,this.instrumentId="",this.transactionId=""}t.hp=hp||{};var i=null,o=null,s=null,c=null,l=null,p=null,u=null,d=null,h=null,f=null,m=null,g=null,v=null,y="";(new Date).toISOString();a.prototype.init=function(){y=hp.Utils.getSession().sessionToken;var t=hp.Utils.handleLegacyCssClassApplication("cc",this.$element),n=t.parent,r=t.content;n.removeClass("hp-back").trigger("hp.notify"),this.context=t,this.$parent=n,this.$content=r,this.$loader=n.find(".hp-img-loading").eq(0),this.wasOnceEMoney=!1,i=this.$content.find(".hp-input-cc input"),o=this.$content.find(".hp-input-cvv input"),s=this.$content.find(".hp-input-month select"),c=this.$content.find(".hp-input-year select"),l=this.$content.find(".hp-input-name input"),p=this.$content.find(".hp-submit"),u=this.$content.find(".hp-card-visual-number"),d=this.$content.find(".hp-card-visual-expiry-month"),h=this.$content.find(".hp-card-visual-expiry-year"),f=this.$content.find(".hp-card-visual-name"),m=this.$content.find(".hp-card-visual"),m=this.$content.find(".hp-card-visual"),g=this.$content.find(".hp-input"),v=e([s,c]),v.fancySelect({includeBlank:!0})},a.prototype.clearInputs=function(){this.formData={_isValid:!1},u.html(hp.Utils.defaults.defaultCardCharacters),d.html(hp.Utils.defaults.defaultDateCharacters),h.html(hp.Utils.defaults.defaultDateCharacters),f.text(hp.Utils.defaults.defaultNameOnCardName),m.parent().removeClass().addClass("hp-content hp-content-cc hp-content-active"),l.removeAttr("disabled").val(""),s.removeAttr("disabled"),c.removeAttr("disabled"),o.removeAttr("disabled").val(""),i.removeAttr("disabled").val(""),p.removeAttr("disabled"),p.text("Submit Payment")},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(0)<0)return"";if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof n)throw new Error("hosted-payments.credit-card.js : Cannot create template. Arguments are null or undefined.");var r=function(e){for(var t=(new Date).getFullYear(),n=(new Date).getFullYear()+10,r="",a=t;n>=a;a++)r+=a===t?'<option selected="selected">':"<option>",r+=a.toString(),r+="</option>";return r},a=function(e){for(var t=1,n="",r=t;12>=r;r++)n+=r===(new Date).getMonth()+1?'<option selected="selected">':"<option>",n+=10>r?"0"+r.toString():r.toString(),n+="</option>";return n},i=function(e){return e.replace("{{monthList}}",a()).replace("{{yearList}}",r())},o=['<div class="hp-card-visual">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">'+n+'</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input hp-input-cc">','<input placeholder="Enter Card Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<div class="hp-input hp-input-name">','<input placeholder="Enter Full Name" value="'+hp.Utils.defaults.customerName+'" autocomplete="on" type="text">',"</div>",'<br class="hp-break" />','<div class="hp-input-container hp-input-container-date">','<div class="hp-input hp-input-month">','<select autocomplete="on">',"{{monthList}}","</select>","</div>",'<div class="hp-input hp-input-year">','<select autocomplete="on">',"{{yearList}}","</select>","</div>","</div>",'<div class="hp-input hp-input-third hp-input-cvv">','<input placeholder="Enter CVV" autocomplete="off" type="text" pattern="\\d*">','<span class="hp-input-cvv-image"></span>',"</div>",'<br class="hp-break" />','<button class="hp-submit">'+(hp.Utils.defaults.promptForAvs?"Verify Billing Address &#10144;":"Submit Payment")+"</button>","</div>"].join("");return i(o)},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.detachEvents=function(){i.off().val(""),o.off().val(""),l.off().val(hp.Utils.defaults.customerName),p.off(),s.off("focus"),c.off("focus"),v.trigger("disable.fs"),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleCreditCardInput=function(t){if(""===t)return void u.html(hp.Utils.defaults.defaultCardCharacters);var n=e.payment.cardType(t);if(null===n&&this.wasOnceEMoney){var r=new Date;l.val("").trigger("keyup").removeAttr("readonly"),s.removeAttr("readonly").val(r.getMonth()<=9?"0"+r.getMonth():r.getMonth()).trigger("change"),c.removeAttr("readonly").val(r.getFullYear()).trigger("change"),v.trigger("enable.fs"),o.val("").trigger("keyup").removeAttr("readonly")}"emoney"===n&&(l.val("EMoney Card").trigger("keyup").attr("readonly","readonly"),s.val("12").trigger("change").attr("readonly","readonly"),c.val("2025").trigger("change").attr("readonly","readonly"),o.val("999").trigger("keyup").attr("readonly","readonly"),v.trigger("disable.fs"),this.wasOnceEMoney=!0),this.formData.cardNumber=t.replace(/\s/gi,""),this.formData.cardType=n,u.text(t)},a.prototype.handleMonthInput=function(t){return""===t?void d.html(hp.Utils.defaults.defaultDateCharacters):(this.formData._expiryMonth=e.trim(t),d.text(t),void setTimeout(function(){s.next().text(t)},0))},a.prototype.handleYearInput=function(t){return""===t?void h.html(hp.Utils.defaults.defaultDateCharacters):(this.formData._expiryYear=e.trim(t),h.text(t.substring(2)),void setTimeout(function(){c.next().text(t)},0))},a.prototype.handleNameInput=function(t){return""===t?void f.text(hp.Utils.defaults.defaultNameOnCardName):(this.formData.name=e.trim(t),void f.text(t))},a.prototype.handleCVVInput=function(t){this.formData.cvv=e.trim(t)},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{token:hp.Utils.getSession().sessionToken,transactionId:this.transactionId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,instrumentId:this.instrumentId,correlationId:hp.Utils.getCorrelationId(),__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{token:hp.Utils.getSession().sessionToken,transactionId:this.transactionId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,instrumentId:this.instrumentId,correlationId:hp.Utils.getCorrelationId(),__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(){var e=this;return e.formData._isValid?(p.attr("disabled","disabled").text("Submitting..."),void hp.Utils.promptAvs().then(function(){return hp.Utils.showLoader(),hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{cardNumber:e.formData.cardNumber,expirationDate:e.formData._expiryMonth+"/"+e.formData._expiryYear,cvv:e.formData.cvv,nameOnCard:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}})}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId=t.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})})):(m.addClass("hp-card-invalid"),void setTimeout(function(){m.removeClass("hp-card-invalid")},2e3))},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),"function"!=typeof hp.Utils.defaults.successCallback&&this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.attachEvents=function(){this.detachEvents();var t=this;v.trigger("enable.fs"),hp.Utils.setContainerClass(t.$element),i.payment("formatCardNumber").on("keyup",function(){var n=e(this).val(),r=e.payment.cardType(n);t.$parent.removeClass("hp-back"),r&&t.$content.removeClass().addClass("hp-content hp-content-cc hp-content-active").addClass("hp-content-card-"+r),t.handleCreditCardInput(n),t.$parent.trigger("hp.cc",n),t.$parent.trigger("hp.notify"),t.handleNotify()}),o.payment("formatCardCVC").on("focus",function(){t.$parent.addClass("hp-back"),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("keyup",function(n){var r=e(this).val();t.handleCVVInput(r),t.$parent.trigger("hp.cvv",r),t.$parent.trigger("hp.notify"),t.handleNotify()}),l.on("focus",function(){t.$parent.trigger("hp.notify"),t.handleNotify(),t.$parent.removeClass("hp-back")}).on("keyup",function(n){var r=e(this).val();t.handleNameInput(r),t.$parent.trigger("hp.name",r),t.$parent.trigger("hp.notify"),t.handleNotify()}),""!==hp.Utils.defaults.customerName&&l.trigger("keyup"),s.on("focus",function(t){e(".hp-input-active").removeClass("hp-input-active"),e(this).parents(".hp-input").addClass("hp-input-active")}).on("change.fs",function(n){var r=e(this).val();t.handleMonthInput(r),t.$parent.removeClass("hp-back"),t.$parent.trigger("hp.expiryMonth",r),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("blur",function(t){e(".hp-input-active").removeClass("hp-input-active")}).trigger("change.fs"),c.on("focus",function(t){e(".hp-input-active").removeClass("hp-input-active"),e(this).parents(".hp-input").addClass("hp-input-active")}).on("change.fs",function(n){var r=e(this).val();t.handleYearInput(r),t.$parent.removeClass("hp-back"),t.$parent.trigger("hp.expiryYear",r),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("blur",function(t){e(".hp-input-active").removeClass("hp-input-active")}).trigger("change.fs"),p.on("click",function(e){e.preventDefault(),t.handleSubmit(),t.$parent.trigger("hp.notify"),t.handleNotify()}),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleNotify=function(){"undefined"!=typeof this.formData._expiryYear&&"undefined"!=typeof this.formData._expiryMonth&&(this.formData.expirationDate=e.trim(this.formData._expiryMonth+this.formData._expiryYear.substring(2)));var t=this;hp.Utils.validateCreditCardData(this.formData,function(e,n){if(g.removeClass("hp-error"),!e)return void(t.formData._isValid=!0);for(var r in e)"cc"===e[r].type&&""!==i.val()&&i.parent().addClass("hp-error"),"cvv"===e[r].type&&""!==o.val()&&o.parent().addClass("hp-error"),"date"===e[r].type&&""!==c.val()&&""!==s.val()&&(c.parent().addClass("hp-error"),s.parent().addClass("hp-error")),"name"===e[r].type&&""!==l.val()&&l.parent().addClass("hp-error")})},a.prototype.isCreditCard=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.CreditCard=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$loader=null,this.$element=e,this.formData={_isValid:!1}}t.hp=hp||{};var i="";(new Date).toISOString();a.prototype.init=function(){i=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("gc",this.$element),t=e.parent,n=e.content;t.removeClass("hp-back").trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,this.totalPages=n.find(".hp-page").length,this.currrentPage=0},a.prototype.clearInputs=function(){this.formData={_isValid:!1}},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(4)<0)return"";var r=['<div class="hp-page hp-page-0 hp-page-active">',"<h2>Swipe, scan, or manually<br /> enter a gift card.</h2><br />",'<div class="hp-card-visual">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">12</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input-group hp-clearfix">','<div class="hp-input hp-input-gc hp-pull-left">','<input placeholder="Enter Card Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<button class="hp-submit hp-pull-left">Submit</button>',"</div>","<hr />",'<button class="hp-submit hp-submit-success">Issue a new Gift Card</button>',"</div>","</div>",'<div class="hp-page hp-page-1">',"<h2>Page 1.</h2><br />","</div>",'<div class="hp-page hp-page-2">',"<h2>Page 2.</h2><br />","</div>",'<div class="hp-page hp-page-3">',"<h2>Page 3.</h2><br />","</div>",'<div class="hp-page hp-page-4">',"<h2>Page 4.</h2><br />","</div>",'<div class="hp-page hp-page-5">',"<h2>Page 5.</h2><br />","</div>","<br />"].join("");return r},a.prototype.goTo=function(e){"first"===e&&(e=0),"last"===e&&(e=this.totalPages-1);var t=+e;0>t&&(t=0),t>this.totalPages&&(t=this.totalPages),this.$content.find(".hp-page").removeClass("hp-page-active").filter(".hp-page-"+t).addClass("hp-page-active"),this.currrentPage=t,this.$parent.trigger("hp.notify",{type:"page",value:t})},a.prototype.next=function(){var e=this.currrentPage+1;this.goTo(e===this.totalPages?"first":e)},a.prototype.prev=function(){this.goTo(0===this.currrentPage?"last":this.currrentPage-1)},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.detachEvents=function(){this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleCharge=function(e){var t=this;hp.Utils.makeRequest({charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:this.transactionId,instrumentId:this.instrumentId,entryType:hp.Utils.defaults.entryType,amount:hp.Utils.getAmount(),__request:e.request}}}).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(){var e=this;e.formData._isValid&&($submit.attr("disabled","disabled").text("Submitting..."),hp.Utils.promptAvs().then(function(){return hp.Utils.showLoader(),hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{cardNumber:e.formData.cardNumber,expirationDate:e.formData._expiryMonth+"/"+e.formData._expiryYear,cvv:e.formData.cvv,nameOnCard:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}})}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId=t.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})}))},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.attachEvents=function(){this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleNotify=function(){var e=this;hp.Utils.validateCreditCardData(this.formData,function(t,n){if(!t)return void(e.formData._isValid=!0);for(var r in t);})},a.prototype.isCreditCard=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!0},hp.GiftCard=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.formData={_isValid:!1},this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9}t.hp=hp||{};var i,o=null,s=null,c=null,l=null,p=null,u=null,d=null,h=null,f="";(new Date).toISOString();a.prototype.init=function(){f=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("bank",this.$element),t=e.parent,n=e.content;t.trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,o=this.$content.find(".hp-input-fullname input"),s=this.$content.find(".hp-input-account input"),c=this.$content.find(".hp-input-routing input"),l=this.$content.find(".hp-bank-visual-account"),p=this.$content.find(".hp-bank-visual"),u=this.$content.find(".hp-bank-visual-routing"),d=this.$content.find(".hp-bank-visual-name"),i=this.$content.find(".hp-submit"),h=this.$content.find(".hp-input")},a.prototype.clearInputs=function(){this.formData={_isValid:!1},h.each(function(){e(this).find("input").val("")}),d.html(hp.Utils.defaults.defaultName),l.html(hp.Utils.defaults.defaultAccountNumberCharacters),u.html(hp.Utils.defaults.defaultRoutingNumberCharacters),p.parent().removeClass().addClass("hp-content hp-content-bank hp-content-active")},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(1)<0)return"";if("undefined"==typeof t||"undefined"==typeof n||"undefined"==typeof e)throw new Error("hosted-payments.bank-account.js : Cannot create template. Arguments are null or undefined.");var r=['<div class="hp-bank-visual">','<div class="hp-bank-visual-image"></div>','<div class="hp-bank-visual-logo"></div>','<div class="hp-bank-visual-name">'+e+"</div>",'<div class="hp-bank-visual-account">'+t+"</div>",'<div class="hp-bank-visual-routing">'+n+"</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input hp-input-fullname">','<input placeholder="Enter Full Name" value="'+hp.Utils.defaults.customerName+'" autocomplete="on" type="text">',"</div>",'<div class="hp-break" >','<div class="hp-input hp-input-account">','<input placeholder="Account Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<div class="hp-input hp-input-routing">','<input placeholder="Routing Number" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>",'<button class="hp-submit">Submit Payment</button>','<p class="info">* Please note that bank account (ACH) transactions may take up to 3 days to process. This time period varies depending on the your issuing bank. For more information please visit us at <a href="https://www.etsms.com/" target="_blank">https://etsms.com</a>.</p>',"</div>"].join("");return r},a.prototype.detachEvents=function(){this.$content.find(".hp-input-account input").off().val(""),this.$content.find(".hp-input-fullname input").off().val(hp.Utils.defaults.customerName),this.$content.find(".hp-input-routing input").off().val(""),this.$content.find(".hp-submit").off(),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleRoutingInput=function(t){return""===t?u.html(hp.Utils.defaults.defaultRoutingNumberCharacters):(this.formData.routingNumber=e.trim(t),void u.text(t))},a.prototype.handleAccountInput=function(t){return""===t?l.html(hp.Utils.defaults.defaultAccountNumberCharacters):(this.formData.accountNumber=e.trim(t),void l.text(t))},a.prototype.handleNameInput=function(t){return""===t?d.html(hp.Utils.defaults.defaultName):(this.formData.name=e.trim(t),void d.text(t))},a.prototype.attachEvents=function(){this.detachEvents();var t=this;t.$content.find(".hp-input-account input").payment("restrictNumeric").on("keyup, keydown, keypress, change, input",function(){var n=e(this),r=n.val().length;if(r>16){var a=n.val().substr(0,16);n.val(a)}var i=e(this).val();t.$parent.removeClass("hp-back"),t.$content.removeClass().addClass("hp-content hp-content-bank hp-content-active"),
t.handleAccountInput(i),t.$parent.trigger("hp.account",i),t.$parent.trigger("hp.notify"),t.handleNotify()}),t.$content.find(".hp-input-fullname input").on("keyup, keydown, keypress, change, input",function(){var n=e(this).val();t.$parent.removeClass("hp-back"),t.handleNameInput(n),t.$parent.trigger("hp.name",n),t.$parent.trigger("hp.notify"),t.handleNotify()}),""!==hp.Utils.defaults.customerName&&setTimeout(function(){t.$content.find(".hp-input-fullname input").val(hp.Utils.defaults.customerName),t.$content.find(".hp-input-fullname input").trigger("keyup"),t.$parent.trigger("hp.name",hp.Utils.defaults.customerName),t.handleNameInput(hp.Utils.defaults.customerName),t.handleNotify()},0),t.$content.find(".hp-input-routing input").payment("restrictNumeric").on("keyup, keydown, keypress, change, input",function(n){var r=e(this),a=r.val().length;if(a>9){var i=r.val().substr(0,9);r.val(i)}var o=e(this).val();t.$parent.removeClass("hp-back"),t.handleRoutingInput(o),t.$parent.trigger("hp.routing",o),t.$parent.trigger("hp.notify"),t.handleNotify()}),t.$content.find(".hp-submit").on("click",function(e){e.preventDefault(),t.handleSubmit(),t.$parent.trigger("hp.notify"),t.handleNotify()}),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleNotify=function(){var e=this;hp.Utils.validateBankAccountData(this.formData,function(t,n){if(h.removeClass("hp-error"),!t)return void(e.formData._isValid=!0);for(var r in t)"accountNumber"===t[r].type&&""!==s.val()&&s.parent().addClass("hp-error"),"routingNumber"===t[r].type&&""!==c.val()&&c.parent().addClass("hp-error"),"name"===t[r].type&&""!==o.val()&&o.parent().addClass("hp-error")})},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:t.transactionId,instrumentId:t.instrumentId,amount:hp.Utils.getAmount(),__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:t.transactionId,instrumentId:t.instrumentId,amount:hp.Utils.getAmount(),__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),"function"!=typeof hp.Utils.defaults.successCallback&&this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.handleSubmit=function(){var e=this;return e.formData._isValid?(i.attr("disabled","disabled").text("Submitting..."),hp.Utils.showLoader(),i.attr("disabled","disabled").text("Processing payment..."),void hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{accountNumber:e.formData.accountNumber,routingNumber:e.formData.routingNumber,bankName:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId=t.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})})):(p.addClass("hp-bank-invalid"),void setTimeout(function(){p.removeClass("hp-bank-invalid")},2e3))},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!0},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.BankAccount=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9,this.instrumentId="",this.transactionId="",this.formData={_isValid:!1}}t.hp=hp||{};var i=null,o=null,s=null,c=null,l=null,p=null,u="";(new Date).toISOString();a.prototype.init=function(){u=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("code",this.$element),t=e.parent,n=e.content;t.trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,i=this.$content.find(".hp-card-visual-number"),o=this.$content.find(".hp-card-visual-expiry-month"),s=this.$content.find(".hp-card-visual-expiry-year"),c=this.$content.find(".hp-card-visual-name"),l=this.$content.find(".hp-card-visual.hp-card-visual-flat"),p=this.$content.find(".hp-input")},a.prototype.clearInputs=function(){this.formData={_isValid:!1},l.removeClass("hp-card-visual-flat-active"),i.html(hp.Utils.defaults.defaultCardCharacters),o.html(hp.Utils.defaults.defaultDateCharacters),s.html(hp.Utils.defaults.defaultDateCharacters),c.html(hp.Utils.defaults.defaultNameOnCardNameSwipe)},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(2)<0)return"";if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof n)throw new Error("hosted-payments.code.js : Cannot create template. Arguments are null or undefined.");var r=['<div class="hp-code-title">To begin: Swipe a card or scan a barcode.</div>','<div class="hp-code-image"></div>','<div class="hp-card-visual hp-card-visual-flat">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">'+n+'</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>"].join("");return r},a.prototype.detachEvents=function(){this.$content.find(".hp-submit").off(),this.$parent.off("hp.swipped"),this.$parent.trigger("hp.notify"),e(n).off("hp.global_swipped"),e(t).off("keydown")},a.prototype.attachEvents=function(){this.detachEvents();var r=this;e(n).pos(),e(n).on("hp.global_swipped_start",function(e,t){hp.Utils.defaults.onSwipeStartCallback()}),e(n).on("hp.global_swipped_end",function(e,t){hp.Utils.defaults.onSwipeEndCallback(t),hp.Utils.defaults.ignoreSubmission||r.handleSubmit(t)}),e(t).on("keydown",function(e){return 32!=e.keyCode})},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:e.transactionId,instrumentId:e.instrumentId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:e.transactionId,instrumentId:e.instrumentId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(t){var n=this;if(!t.is_valid)return void n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:"Bad swipe. Please try again."});t.name_on_card&&(n.formData.nameOnCard=t.name_on_card),t.card_exp_date_year&&(n.formData.expYear=t.current_year+t.card_exp_date_year),t.card_exp_date_month&&(n.formData.expMonth=t.card_exp_date_month),t.card_number&&(n.formData.cardNumber=e.payment.formatCardNumber(t.card_number),n.formData.cardType=e.payment.cardType(t.card_number)),c.text(n.formData.nameOnCard),i.text(n.formData.cardNumber),s.text(n.formData.expYear.substring(n.formData.expYear.length-2)),o.text(n.formData.expMonth),n.formData.trackOne=t.track_one,n.formData.trackTwo=t.track_two,n.formData.trackThree=t.track_three,n.formData.ksn=t.ksn,l.addClass("hp-card-visual-flat-active"),n.formData._isValid=t.is_valid,n.formData._isEMoney=t.is_emoney;var r={};n.formData._isValid&&""!==n.formData.ksn&&!n.formData._isEMoney&&(r={trackOne:n.formData.trackOne,trackTwo:n.formData.trackTwo,trackThree:n.formData.trackThree,ksn:n.formData.ksn}),this.formData._isValid&&""===n.formData.ksn&&!n.formData._isEMoney&&(r={trackOne:n.formData.trackOne,trackTwo:n.formData.trackTwo,trackThree:"",ksn:""}),this.formData._isValid&&n.formData._isEMoney&&(r={cardNumber:n.formData.cardNumber.replace(/\s/gi,""),cvv:"999",expirationDate:n.formData.expMonth+"/"+n.formData.expYear,nameOnCard:n.formData.nameOnCard}),hp.Utils.promptAvs().then(function(){return hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,name:n.formData.nameOnCard,properties:r,billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode},__swipe:n.formData}}})}).then(function(e){return e.isException?void n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:e}):(n.instrumentId=e.instrumentId,n.transactionId=e.transactionId,hp.Utils.showLoader(),n.$parent.trigger("hp.submit",{type:0,res:e}),void n.handleCharge(e))}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:e})})},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),"function"!=typeof hp.Utils.defaults.successCallback&&this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isCode=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.Code=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.formData={_isValid:!1}}t.hp=hp||{};var i={AuthorizationResponse:"Authorizing",BeginSale:"Terminal active",LoginSuccess:"Terminal active",ExecuteCommand:"Terminal active",DisplayAmount:"Waiting for customer",DisplayForm:"Waiting for customer",FindTermsAndConditions:"Waiting for customer",Idle:"Waiting for customer",Offline:"Terminal offline",ProcessingError:"Declined",ReadCardRequest:"Waiting for customer",SetEmvPaymentType:"Checking EMV card type",Gratuity:"Waiting for tip/gratuity",CardInserted:"Perfoming EMV",CardRemoved:"EMV Complete",WaitingForSignature:"Waiting for signature",DownloadingSignature:"Waiting for signature",Signature:"Waiting for signature",SignatureBlocks:"Waiting for signature",StopTransaction:"Authorizing",TermsAndConditions:"Waiting for TOC acceptance","Operation Cancelled by User":"Transaction cancelled!"},o=function(e){"undefined"==typeof e&&(e="Idle");var t=i[e];return null!==t&&"undefined"!=typeof message&&(t=i.Idle),t};a.prototype.init=function(){var t=hp.Utils.handleLegacyCssClassApplication("transvault",this.$element),n=t.parent,r=t.content;n.trigger("hp.notify"),this.context=t,this.$parent=n,this.$content=r,this.transvaultHub=e.connection.transvaultHub,this.shouldConnect=!0,this.$btn=null,this.terminalId=hp.Utils.getTerminalId(),this.connectionId="0",this.correlationId="",this.transactionId=hp.Utils.generateGuild()},a.prototype.createTemplate=function(){if(hp.Utils.defaults.paymentTypeOrder.indexOf(3)<0)return"";var e=['<div class="hp-transvault-visual">','<div class="hp-transvault-visual-image {{isAlt}}">','<img class="event event-default" src="https://cdn.rawgit.com/etsms/786cb7bdd1d077acc10d7d7e08a4241f/raw/58a2ec726610c18c21716ae6023f7c6d776b5a71/terminal-loading.svg" alt="Status" />',"</div>",'<p class="hp-input-transvault-message {{isAlt}}">',"Disconnected <span></span>","</p>",'<button class="hp-submit hp-submit-danger">Cancel Request</button>',"</div>"].join("");return e=e.replace(/{{isAlt}}/gi,hp.Utils.getTerminalId().startsWith("1")||hp.Utils.getTerminalId().startsWith("3")?"alt":"")},a.prototype.detachEvents=function(){this.$parent.off("hp.transvaultSuccess"),this.$parent.off("hp.transvaultError"),this.$parent.off("hp.transvaultProgress"),this.$parent.find(".hp-submit").off(),this.$parent.trigger("hp.notify")},a.prototype.attachEvents=function(){this.detachEvents();var t=this;t.transvaultHub.connection.url=hp.Utils.defaults.baseUrl+"/transvault",t.setupWebockets(),t.$parent.find(".hp-submit").on("click",function(n){n.preventDefault(),t.cancelTransaction(),e(this).attr("disabled","disabled").text("Canceling..."),t.setMessage("Canceling transaction")})},a.prototype.onSuccess=function(t){var n=this,r=t.Properties;if(r.ACCT||(r.ACCT=""),r.AN||(r.AN=""),r.AC||(r.AC=""),r.SD?r.SD=r.SD.toLowerCase():r.SD="https://images.pmoney.com/00000000",r.CRDT?r.CRDT=r.CRDT.toUpperCase().replace("ETS",""):r.CRDT="",r.RD||(r.RD=""),r.CEM?r.CEM=r.CEM.replace(/\s/gi,"_").toUpperCase():r.CEM="",r.EMV_APAN||(r.EMV_APAN=""),r.EMV_APN||(r.EMV_APN=""),r.CHN||(r.CHN=""),r.EMV_AID||(r.EMV_AID=""),r.EMV_TVR||(r.EMV_TVR=""),r.EMV_IAD||(r.EMV_IAD=""),r.EMV_TSI||(r.EMV_TSI=""),r.EMV_ARC||(r.EMV_ARC=""),r.EMV_TA||(r.EMV_TA=""),r.TCCT||(r.TCCT="USD$"),r.EMD?r.EMD=r.EMD.replace(/\s/gi,"_").toUpperCase():r.EMD="",r.CVMD||(r.CVMD=""),r.TT||(r.TT="PURCHASE"),r.VA?"string"==typeof r.VA?r.VA=+r.VA.replace("$",""):r.VA=+r.VA:r.VA=0,r.GA?"string"==typeof r.GA?r.GA=+r.GA.replace("$",""):r.GA=+r.GA:r.GA=0,r.TAX?"string"==typeof r.TAX?r.TAX=+r.TAX.replace("$",""):r.TAX=+r.TAX:r.TAX=0,r.CBA?"string"==typeof r.CBA?r.CBA=+r.CBA.replace("$",""):r.CBA=+r.CBA:r.CBA=0,r.SA?"string"==typeof r.SA?r.SA=+r.SA.replace("$",""):r.SA=+r.SA:r.SA=0,r.ED){var a=(new Date).getFullYear().toString().substring(0,2)+r.ED.substr(2),i=r.ED.substr(0,2);r.ED=i+"/"+a}else r.ED="";""===r.AN&&""!==r.EMV_APAN&&(r.AN=r.EMV_APAN),""!==r.AN&&(r.AN=r.AN.replace(/\*|\X|\x/gi,"")),r.AN.length>4&&(r.AN=r.AN.substr(r.AN.length-4)),""!==r.EMV_APN&&(r.CHN=r.EMV_APN);var o={status:"Success",message:e.trim(r.RD),amount:r.TA,token:hp.Utils.getSession().sessionToken,anti_forgery_token:hp.Utils.defaults.antiForgeryToken,transaction_id:r.ETT,transaction_approval_code:r.AC,transaction_avs_street_passed:!0,transaction_avs_postal_code_passed:!0,transaction_currency:r.TCCT,transaction_status_indicator:r.EMV_TSI,transaction_type:r.TT,transaction_tax:r.TAX,transaction_surcharge:r.SA,transaction_gratuity:r.GA,transaction_cashback:r.CBA,transaction_total:r.VA,instrument_id:r.ACCT,instrument_type:r.CRDT,instrument_last_four:r.AN,instrument_expiration_date:r.ED,instrument_verification_method:r.CVMD,instrument_entry_type:r.CEM,instrument_entry_type_description:r.EMD,instrument_verification_results:r.EMV_TVR,created_on:(new Date).toISOString(),customer_name:r.CHN,customer_signature:r.SD,correlation_id:n.correlationId,application_identifier:r.EMV_AID,application_response_code:r.EMV_ARC,application_issuer_data:r.EMV_IAD};n.$parent.trigger("hp.transvaultSuccess",o)},a.prototype.onError=function(e){var t=this;t.$parent.trigger("hp.transvaultError",e)},a.prototype.setMessage=function(e){this.$parent.find(".hp-input-transvault-message").text(e)},a.prototype.onEvent=function(e){var t=this,n=o(e);t.setMessage(n),t.$parent.trigger("hp.transvaultEvent",n),"DownloadingSignature"===e&&hp.Utils.showLoader()},a.prototype.cancelTransaction=function(){var e=hp.Utils.getSession().sessionToken,t=hp.Utils.getCorrelationId();this.transvaultHub&&this.transvaultHub.server&&this.transvaultHub.server.cancelTransaction&&this.transvaultHub.server.cancelTransaction(e,t)},a.prototype.onCancelled=function(){this.$parent.find(".event-default").hide(),this.$parent.find(".hp-submit").hide()},a.prototype.setupWebockets=function(e){var t=this,n=t.$parent.find(".hp-input-transvault-message");e=e||hp.Utils.getAmount(),t.correlationId=hp.Utils.getCorrelationId(),t.shouldConnect&&(n.off("click").removeClass("hp-input-transvault-message-btn").text("Connecting"),setTimeout(function(){t.transvaultHub.client.onSuccess=function(e){t.onSuccess(e)},t.transvaultHub.client.onError=function(e){return"Operation Cancelled by User"===e?(t.onEvent(e),void t.onCancelled()):void t.onError(e)},t.transvaultHub.client.onEvent=function(e){t.onEvent(e)},t.transvaultHub.connection.start({withCredentials:!1,jsonp:!0}).done(function(){var r=hp.Utils.getSession().sessionToken;t.transvaultHub.server.registerClientWithApiKey(r),hp.Utils.makeRequest({transvault:{transvaultRequest:{token:r,amount:e,transactionId:t.transactionId,correlationId:t.correlationId,entryType:hp.Utils.defaults.entryType,terminalId:t.terminalId,action:hp.Utils.defaults.paymentType}}}).then(function(e){t.$parent.trigger("hp.transvaultProgress")},function(e){t.$parent.trigger("hp.transvaultError",e.responseJSON),n.css("color","#FC5F45").text("Could not connect!")})}).fail(function(e){n.css("color","#FC5F45").text("Could not connect!")})},0),t.$parent.trigger("hp.notify"))},a.prototype.showSuccess=function(e){"function"!=typeof hp.Utils.defaults.successCallback&&hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isTransvault=function(){return!0},a.prototype.isGiftCard=function(){return!1},hp.Transvault=a}(jQuery,window,document),function(){var e,t,n,r,a,i,o,s,c,l,p,u,d,h,f,m,g,v,y,b,C=[].slice,S=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=jQuery,e.payment={},e.payment.fn={},e.fn.payment=function(){var t,n;return n=arguments[0],t=2<=arguments.length?C.call(arguments,1):[],e.payment.fn[n].apply(this,t)},a=/(\d{1,4})/g,r=[{type:"visaelectron",pattern:/^4(026|17500|405|508|844|91[37])/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",pattern:/^(5(018|0[23]|[68])|6(39|7))/,format:a,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",pattern:/^600/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",pattern:/^5019/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"visa",pattern:/^4/,format:a,length:[13,16],cvcLength:[3],luhn:!0},{type:"mastercard",pattern:/^5[0-5]/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"amex",pattern:/^3[47]/,format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",pattern:/^3[0689]/,format:a,length:[14],cvcLength:[3],luhn:!0},{type:"discover",pattern:/^6([045]|22)/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"jcb",pattern:/^35/,format:a,length:[16],cvcLength:[3],luhn:!0},{type:"emoney",pattern:/^627571/,format:a,length:[16],cvcLength:[3],luhn:!0}],t=function(e){var t,n,a;for(e=(e+"").replace(/\D/g,""),n=0,a=r.length;a>n;n++)if(t=r[n],t.pattern.test(e))return t},n=function(e){var t,n,a;for(n=0,a=r.length;a>n;n++)if(t=r[n],t.type===e)return t},d=function(e){var t,n,r,a,i,o;for(r=!0,a=0,n=(e+"").split("").reverse(),i=0,o=n.length;o>i;i++)t=n[i],t=parseInt(t,10),(r=!r)&&(t*=2),t>9&&(t-=9),a+=t;return a%10===0},u=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")?!0:("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)&&"function"==typeof t.createRange?t.createRange().text:void 0)?!0:!1},h=function(t){return setTimeout(function(){var n,r;return n=e(t.currentTarget),r=n.val(),r=e.payment.formatCardNumber(r),n.val(r)})},s=function(n){var r,a,i,o,s,c,l;return i=String.fromCharCode(n.which),!/^\d+$/.test(i)||(r=e(n.currentTarget),l=r.val(),a=t(l+i),o=(l.replace(/\D/g,"")+i).length,c=16,a&&(c=a.length[a.length.length-1]),o>=c||null!=r.prop("selectionStart")&&r.prop("selectionStart")!==l.length)?void 0:(s=a&&"amex"===a.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,s.test(l)?(n.preventDefault(),setTimeout(function(){return r.val(l+" "+i)})):s.test(l+i)?(n.preventDefault(),setTimeout(function(){return r.val(l+i+" ")})):void 0)},i=function(t){var n,r;return n=e(t.currentTarget),r=n.val(),8!==t.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==r.length?void 0:/\d\s$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d\s$/,""))})):/\s\d?$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\s\d?$/,""))})):void 0},f=function(t){return setTimeout(function(){var n,r;return n=e(t.currentTarget),r=n.val(),r=e.payment.formatExpiry(r),n.val(r)})},c=function(t){var n,r,a;return r=String.fromCharCode(t.which),/^\d+$/.test(r)?(n=e(t.currentTarget),a=n.val()+r,/^\d$/.test(a)&&"0"!==a&&"1"!==a?(t.preventDefault(),setTimeout(function(){return n.val("0"+a+" / ")})):/^\d\d$/.test(a)?(t.preventDefault(),setTimeout(function(){return n.val(""+a+" / ")})):void 0):void 0},l=function(t){var n,r,a;return r=String.fromCharCode(t.which),/^\d+$/.test(r)?(n=e(t.currentTarget),a=n.val(),/^\d\d$/.test(a)?n.val(""+a+" / "):void 0):void 0},p=function(t){var n,r,a;return a=String.fromCharCode(t.which),"/"===a||" "===a?(n=e(t.currentTarget),r=n.val(),/^\d$/.test(r)&&"0"!==r?n.val("0"+r+" / "):void 0):void 0},o=function(t){var n,r;return n=e(t.currentTarget),r=n.val(),8!==t.which||null!=n.prop("selectionStart")&&n.prop("selectionStart")!==r.length?void 0:/\s\/\s\d?$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\s\/\s\d?$/,""))})):void 0},y=function(e){var t;return e.metaKey||e.ctrlKey?!0:32===e.which?!1:0===e.which?!0:e.which<33?!0:(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))},g=function(n){var r,a,i,o;return r=e(n.currentTarget),i=String.fromCharCode(n.which),/^\d+$/.test(i)&&!u(r)?(o=(r.val()+i).replace(/\D/g,""),a=t(o),a?o.length<=a.length[a.length.length-1]:o.length<=16):void 0},v=function(t){var n,r,a;return n=e(t.currentTarget),r=String.fromCharCode(t.which),/^\d+$/.test(r)&&!u(n)?(a=n.val()+r,a=a.replace(/\D/g,""),a.length>6?!1:void 0):void 0},m=function(t){var n,r,a;return n=e(t.currentTarget),r=String.fromCharCode(t.which),/^\d+$/.test(r)&&!u(n)?(a=n.val()+r,a.length<=4):void 0},b=function(t){var n,a,i,o,s;return n=e(t.currentTarget),s=n.val(),o=e.payment.cardType(s)||"unknown",n.hasClass(o)?void 0:(a=function(){var e,t,n;for(n=[],e=0,t=r.length;t>e;e++)i=r[e],n.push(i.type);return n}(),n.removeClass("unknown"),n.removeClass(a.join(" ")),n.addClass(o),n.toggleClass("identified","unknown"!==o),n.trigger("payment.cardType",o))},e.payment.fn.formatCardCVC=function(){return this.payment("restrictNumeric"),this.on("keypress",m),this},e.payment.fn.formatCardExpiry=function(){return this.payment("restrictNumeric"),this.on("keypress",v),this.on("keypress",c),this.on("keypress",p),this.on("keypress",l),this.on("keydown",o),this.on("change",f),this.on("input",f),this},e.payment.fn.formatCardNumber=function(){return this.payment("restrictNumeric"),this.on("keypress",g),this.on("keypress",s),this.on("keydown",i),this.on("keyup",b),this.on("paste",h),this.on("change",h),this.on("input",h),this.on("input",b),this},e.payment.fn.restrictNumeric=function(){return this.on("keypress",y),this},e.payment.fn.cardExpiryVal=function(){return e.payment.cardExpiryVal(e(this).val())},e.payment.cardExpiryVal=function(e){var t,n,r,a;return e=e.replace(/\s/g,""),a=e.split("/",2),t=a[0],r=a[1],2===(null!=r?r.length:void 0)&&/^\d+$/.test(r)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),r=n+r),t=parseInt(t,10),r=parseInt(r,10),{month:t,year:r}},e.payment.validateCardNumber=function(e){var n,r;return e=(e+"").replace(/\s+|-/g,""),/^\d+$/.test(e)?(n=t(e),n?(r=e.length,S.call(n.length,r)>=0&&(n.luhn===!1||d(e))):!1):!1},e.payment.validateCardExpiry=function(t,n){var r,a,i;return"object"==typeof t&&"month"in t&&(i=t,t=i.month,n=i.year),t&&n?(t=e.trim(t),n=e.trim(n),/^\d+$/.test(t)&&/^\d+$/.test(n)&&t>=1&&12>=t?(2===n.length&&(n=70>n?"20"+n:"19"+n),4!==n.length?!1:(a=new Date(n,t),r=new Date,a.setMonth(a.getMonth()-1),a.setMonth(a.getMonth()+1,1),a>r)):!1):!1},e.payment.validateCardCVC=function(t,r){var a,i;return t=e.trim(t),/^\d+$/.test(t)?(a=n(r),null!=a?(i=t.length,S.call(a.cvcLength,i)>=0):t.length>=3&&t.length<=4):!1},e.payment.cardType=function(e){var n;return e?(null!=(n=t(e))?n.type:void 0)||null:null},e.payment.formatCardNumber=function(n){var r,a,i,o;return(r=t(n))?(i=r.length[r.length.length-1],n=n.replace(/\D/g,""),n=n.slice(0,i),r.format.global?null!=(o=n.match(r.format))?o.join(" "):void 0:(a=r.format.exec(n),null!=a?(a.shift(),a=e.grep(a,function(e){return e}),a.join(" ")):void 0)):n},e.payment.formatExpiry=function(e){var t,n,r,a;return(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",r=n[2]||"",a=n[3]||"",(a.length>0||r.length>0&&!/\ \/?\ ?/.test(r))&&(r=" / "),1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,r=" / "),t+r+a):""}}.call(this),function(e){var t={};e.fn.pos=function(n){var r=e(this),a=new RegExp(/^(?:%B|\;)([0-9]+)/gi),i=new RegExp(/(?:\^(.*)\^)/gi),o=new RegExp(/(?:\^(?:.*)\^|=)(\d{4})/gi),s=new RegExp(/\|([A-Z0-9]+)(?=\|)/gi),c=new RegExp(/^(.*?\?)(;.*)/gi),l={swipe:""};t={swipe:!0};var p=function(e,t){var n=!1;try{n="undefined"!=typeof e[t]}catch(r){}return n};r.options=e.extend(!0,{},t,n),r.off("keypress").on("keypress",function(t){if(r.options.swipe){if(13!=t.which)return l.swipe+=String.fromCharCode(t.which),void(2==l.swipe.length&&"%B"==l.swipe&&r.trigger("hp.global_swipped_start"));var n={track_one:"",track_two:"",track_three:"",ksn:"",card_number:"",name_on_card:"",card_exp_date_month:"",card_exp_date_year:"",is_valid:!0,is_emoney:!1,current_year:(new Date).getFullYear().toString().substring(0,2)},u=a.exec(l.swipe),d=i.exec(l.swipe),h=o.exec(l.swipe),f=l.swipe.match(s),m=c.exec(l.swipe);if(null!=u&&u.length&&(n.card_number=u[1]),null!=d&&d.length){var g=d[1];g=-1===g.indexOf(",")?g.replace(/\/+|\d+/gi," "):e.trim(g.replace(/\//gi," ").replace(/\W+/gi," ")),g=g.split(" ").length>2?g.split(" ")[1]+" "+g.split(" ")[2]+" "+g.split(" ")[0]:g.split(" ")[1]+" "+g.split(" ")[0],n.name_on_card=g}if(null!=h&&h.length){var v=h[1],y=v.substring(0,2),b=v.substring(2);n.card_exp_date_year=y,n.card_exp_date_month=b}null!=f&&f.length?(f=f.map(function(e){return e.replace("|","")}),p(f,1)&&(n.track_one=f[1]),p(f,2)&&(n.track_two=f[2]),f.length>=10&&p(f,3)&&(n.track_three=f[3]),f.length>=10&&p(f,8)?n.ksn=f[8]:9===f.length&&(n.ksn=f[7])):null!=m&&m.length>=3?(n.track_one=m[1],n.track_two=m[2]):n.is_valid=!1,13==t.which&&(n.is_valid||-1===n.card_number.indexOf("627571")||(n.is_valid=!0,n.is_emoney=!0,n.name_on_card="EMoney Card",n.card_exp_date_year=(+(new Date).getFullYear().toString().substring(2)+9).toString(),n.card_exp_date_month="12"),(-1!==l.swipe.indexOf("%E?")||-1!==l.swipe.indexOf("+E?")||-1!==l.swipe.indexOf(";E?"))&&(n.is_valid=!1),""===n.name_on_card&&(n.name_on_card="Unknown Card"),n.name_on_card=e.trim(n.name_on_card.replace("undefined","")),r.trigger("hp.global_swipped_end",n),l.swipe="")}})}}(jQuery),function(){var e;e=window.jQuery||window.Zepto||window.$,e.fn.fancySelect=function(t){var n,r;return null==t&&(t={}),r=e.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(e){return e.text()},triggerTemplate:function(e){return e.text()}},t),n=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var t,a,i,o,s,c,l;return o=e(this),o.hasClass("fancified")||"SELECT"!==o[0].tagName?void 0:(o.addClass("fancified"),o.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),o.wrap('<div class="fancy-select">'),l=o.parent(),o.data("class")&&l.addClass(o.data("class")),l.append('<div class="trigger">'),(!n||r.forceiOS)&&l.append('<ul class="options">'),s=l.find(".trigger"),i=l.find(".options"),a=o.prop("disabled"),a&&l.addClass("disabled"),c=function(){var e;return e=r.triggerTemplate(o.find(":selected")),s.html(e)},o.on("blur.fs",function(){return s.hasClass("open")?setTimeout(function(){return s.trigger("close.fs")},120):void 0}),s.on("close.fs",function(){return s.removeClass("open"),i.removeClass("open")}),s.on("click.fs",function(){var t,c;if(!a)if(s.toggleClass("open"),n&&!r.forceiOS){if(s.hasClass("open"))return o.focus()}else if(s.hasClass("open")&&(c=s.parent(),t=c.offsetParent(),c.offset().top+c.outerHeight()+i.outerHeight()+20>e(window).height()+e(window).scrollTop()?i.addClass("overflowing"):i.removeClass("overflowing")),i.toggleClass("open"),!n)return o.focus()}),o.on("enable",function(){return o.prop("disabled",!1),l.removeClass("disabled"),a=!1,t()}),o.on("disable",function(){return o.prop("disabled",!0),l.addClass("disabled"),a=!0}),o.on("change.fs",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():c()}),o.on("keydown",function(e){var t,n,r;if(r=e.which,t=i.find(".hover"),t.removeClass("hover"),i.hasClass("open")){if(38===r?(e.preventDefault(),t.length&&t.index()>0?t.prev().addClass("hover"):i.find("li:last-child").addClass("hover")):40===r?(e.preventDefault(),t.length&&t.index()<i.find("li").length-1?t.next().addClass("hover"):i.find("li:first-child").addClass("hover")):27===r?(e.preventDefault(),s.trigger("click.fs")):13===r||32===r?(e.preventDefault(),t.trigger("mousedown.fs")):9===r&&s.hasClass("open")&&s.trigger("close.fs"),n=i.find(".hover"),n.length)return i.scrollTop(0),i.scrollTop(n.position().top-12)}else if(13===r||32===r||38===r||40===r)return e.preventDefault(),s.trigger("click.fs")}),i.on("mousedown.fs","li",function(t){var r;return r=e(this),o.val(r.data("raw-value")),n||o.trigger("blur.fs").trigger("focus.fs"),i.find(".selected").removeClass("selected"),r.addClass("selected"),s.addClass("selected"),o.val(r.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),i.on("mouseenter.fs","li",function(){var t,n;return n=e(this),t=i.find(".hover"),t.removeClass("hover"),n.addClass("hover")}),i.on("mouseleave.fs","li",function(){return i.find(".hover").removeClass("hover")}),t=function(){var t;return c(),!n||r.forceiOS?(t=o.find("option"),o.find("option").each(function(t,n){var a;return n=e(n),n.prop("disabled")||!n.val()&&!r.includeBlank?void 0:(a=r.optionTemplate(n),n.prop("selected")?i.append('<li data-raw-value="'+n.val()+'" class="selected">'+a+"</li>"):i.append('<li data-raw-value="'+n.val()+'">'+a+"</li>"))})):void 0},o.on("update.fs",function(){return l.find(".options").empty(),t()}),t())})}}.call(this),function(e,t,n,r){function a(e,t){this._name=i,this.element=e,"undefined"!=typeof t.entryType&&(t.entryType=hp.Utils.setEntryType(t.entryType)),"undefined"!=typeof t.paymentType&&(t.paymentType=hp.Utils.setPaymentType(t.paymentType)),hp.Utils.defaults=jQuery.extend({},o,t),this.init(),hp.Utils.__instance=this}var i="hp",o={};o.version="v3",o.amount=0,o.baseUrl="https://www.etsemoney.com/hp/v3/adapters",o.defaultCardCharacters="&middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot;",o.defaultDateCharacters="&middot;&middot;",o.defaultNameOnCardName="Name On Card",o.defaultNameOnCardNameSwipe="Swipe/Scan Card",o.defaultName="Full Name",o.defaultPhone="800-834-7790",o.defaultErrorLabel="Declined",
o.defaultRedirectLabel="You are being redirected...",o.defaultSuccessLabel="Transaction Complete!",o.paymentTypeOrder=[0,1],o.paymentService="EFT",o.defaultAccountNumberCharacters="&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;",o.defaultRoutingNumberCharacters="&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;",o.correlationId="",o.successCallback=e.noop,o.errorCallback=e.noop,o.onSwipeStartCallback=e.noop,o.onSwipeEndCallback=e.noop,o.onAvsDismissCallback=e.noop,o.onErrorDismissCallback=e.noop,o.ignoreSubmission=!1,o.terminalId="",o.instrumentId="",o.apiKey="",o.paymentType=hp.PaymentType.CHARGE,o.entryType=hp.EntryType.KEYED_CARD_NOT_PRESENT,o.billingAddress={},o.billingAddress.addressLine1="",o.billingAddress.postalCode="",o.antiForgeryToken="",o.antiForgeryName="__RequestVerificationToken",o.customerName="",o.promptForAvs=!1,o.allowAvsSkip=!0;var s=function(){var t=this,n=e(t.element),r="";(new Date).toISOString();""===hp.Utils.getSession().apiKey&&("undefined"!=typeof n.data("etsKey")?(r=n.data("etsKey").toString(),hp.Utils.defaults.apiKey=r):r=hp.Utils.defaults.apiKey,hp.Utils.setSession(r,!0)),"undefined"!=typeof n.data("avsStreet")&&(hp.Utils.defaults.billingAddress.addressLine1=n.data("avsStreet").toString()),"undefined"!=typeof n.data("avsZip")&&(hp.Utils.defaults.billingAddress.postalCode=n.data("avsZip").toString()),"undefined"!=typeof n.data("entryType")&&(hp.Utils.defaults.entryType=hp.Utils.setEntryType(n.data("entryType"))),"undefined"!=typeof n.data("paymentType")&&(hp.Utils.defaults.paymentType=hp.Utils.setPaymentType(n.data("paymentType"))),"undefined"!=typeof n.data("promptForAvs")&&(hp.Utils.defaults.promptForAvs="false"==n.data("promptForAvs").toString().toLowerCase()?!1:!0),"undefined"!=typeof n.data("allowAvsSkip")&&(hp.Utils.defaults.allowAvsSkip="false"==n.data("allowAvsSkip").toString().toLowerCase()?!1:!0),"undefined"!=typeof n.data("correlationId")&&(hp.Utils.defaults.correlationId=n.data("correlationId").toString()),"undefined"!=typeof n.data("terminalId")&&(hp.Utils.defaults.terminalId=n.data("terminalId").toString()),"undefined"!=typeof n.data("instrumentId")&&(hp.Utils.defaults.instrumentId=n.data("instrumentId").toString()),"undefined"!=typeof n.data("baseUrl")&&(hp.Utils.defaults.baseUrl=n.data("baseUrl").toString()),"undefined"!=typeof n.data("customerName")&&(hp.Utils.defaults.customerName=n.data("customerName").toString()),"undefined"!=typeof n.data("defaultPhone")&&(hp.Utils.defaults.defaultPhone=n.data("defaultPhone").toString()),"undefined"!=typeof n.data("errorLabel")&&(hp.Utils.defaults.defaultErrorLabel=n.data("errorLabel").toString()),"undefined"!=typeof n.data("redirectLabel")&&(hp.Utils.defaults.defaultRedirectLabel=n.data("redirectLabel").toString()),"undefined"!=typeof n.data("successLabel")&&(hp.Utils.defaults.defaultSuccessLabel=n.data("successLabel").toString()),"undefined"!=typeof n.data("ignoreSubmission")&&(hp.Utils.defaults.ignoreSubmission="true"===n.data("ignoreSubmission").toString().toLowerCase()),"undefined"!=typeof n.data("paymentTypeOrder")&&(hp.Utils.defaults.paymentTypeOrder=e.trim(n.data("paymentTypeOrder").toString().replace(" ","")).split(",").map(function(e){return+e})),"undefined"!=typeof n.data("amount")&&hp.Utils.setAmount(n.data("amount")),"undefined"!=typeof n.data("antiForgeryToken")?hp.Utils.defaults.antiForgeryToken=n.data("antiForgeryToken").toString():hp.Utils.defaults.antiForgeryToken=hp.Utils.generateGuild(),"undefined"!=typeof n.data("antiForgeryName")&&(hp.Utils.defaults.antiForgeryName=n.data("antiForgeryName").toString()),n.attr("data-ets-key",hp.Utils.generateGuild()),hp.Utils.setPaymentInstrument(),hp.Utils.signIn(),hp.Utils.setupPluginInstances(n)};e.extend(a.prototype,{init:function(){var t=e(this.element),n="",r=hp.types.Adapter;if(null!==t.data("event")&&"undefined"!=typeof t.data("event")&&(r=hp.types.Event,n=t.data("event")),null!==t.data("inventory")&&"undefined"!=typeof t.data("inventory")&&(r=hp.types.Product,n=t.data("inventory")),hp.Utils.setContainerClass(t),r===hp.types.Event)n=t.data("event");else if(r===hp.types.Product)n=t.data("inventory");else if(r===hp.types.Adapter)return void s.call(this);var a=t.data("email"),i=t.data("bcc"),o=t.data("client"),c="undefined"==typeof t.data("memo")?!1:!0,l=t.data("ga"),p=t.data("order"),u=t.data("subject"),d=new hp.Setup(r,new hp.models.Options(o,a,i,c,l,p,n,u));t.find("[data-item]").each(function(){var t=new hp.models.Item(e(this).data("item"),e(this).data("price"));d.addItem(t)}),t.empty(),d.createForm(this.element,hp.Utils.defaults.baseUrl).then(function(e){t.width(e.width).height(e.height).css("margin","0 auto")})}}),e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new a(this,t))}),this}}(jQuery,window,document);