!function(){function e(e,t,n){return"undefined"==typeof n||0===+n?Math[e](t):(t=+t,n=+n,isNaN(t)||"number"!=typeof n||n%1!==0?NaN:(t=t.toString().split("e"),t=Math[e](+(t[0]+"e"+(t[1]?+t[1]-n:-n))),t=t.toString().split("e"),+(t[0]+"e"+(t[1]?+t[1]+n:n))))}Math.round10||(Math.round10=function(t,n){return e("round",t,n)}),Math.floor10||(Math.floor10=function(t,n){return e("floor",t,n)}),Math.ceil10||(Math.ceil10=function(t,n){return e("ceil",t,n)})}(),function(e,t,n){function r(t,n){if(e.isArray(t)){for(var r=t.length-1;r>=0;r--){var a=t[r];"string"===e.type(a)&&l.transports[a]||(n.log("Invalid transport: "+a+", removing it from the transports list."),t.splice(r,1))}0===t.length&&(n.log("No transports remain within the specified transport array."),t=null)}else if(l.transports[t]||"auto"===t){if("auto"===t&&l._.ieVersion<=8)return["longPolling"]}else n.log("Invalid transport: "+t.toString()+"."),t=null;return t}function a(e){return"http:"===e?80:"https:"===e?443:void 0}function i(e,t){return t.match(/:\d+$/)?t:t+":"+a(e)}function o(t,n){var r=this,a=[];r.tryBuffer=function(n){return t.state===e.signalR.connectionState.connecting&&(a.push(n),!0)},r.drain=function(){if(t.state===e.signalR.connectionState.connected)for(;a.length>0;)n(a.shift())},r.clear=function(){a=[]}}var s={nojQuery:"jQuery was not found. Please ensure jQuery is referenced before the SignalR client JavaScript file.",noTransportOnInit:"No transport could be initialized successfully. Try specifying a different transport or none at all for auto initialization.",errorOnNegotiate:"Error during negotiation request.",stoppedWhileLoading:"The connection was stopped during page load.",stoppedWhileNegotiating:"The connection was stopped during the negotiate request.",errorParsingNegotiateResponse:"Error parsing negotiate response.",errorDuringStartRequest:"Error during start request. Stopping the connection.",stoppedDuringStartRequest:"The connection was stopped during the start request.",errorParsingStartResponse:"Error parsing start response: '{0}'. Stopping the connection.",invalidStartResponse:"Invalid start response: '{0}'. Stopping the connection.",protocolIncompatible:"You are using a version of the client that isn't compatible with the server. Client version {0}, server version {1}.",sendFailed:"Send failed.",parseFailed:"Failed at parsing response: {0}",longPollFailed:"Long polling request failed.",eventSourceFailedToConnect:"EventSource failed to connect.",eventSourceError:"Error raised by EventSource",webSocketClosed:"WebSocket closed.",pingServerFailedInvalidResponse:"Invalid ping response when pinging server: '{0}'.",pingServerFailed:"Failed to ping server.",pingServerFailedStatusCode:"Failed to ping server.  Server responded with status code {0}, stopping the connection.",pingServerFailedParse:"Failed to parse ping server response, stopping the connection.",noConnectionTransport:"Connection is in an invalid state, there is no transport active.",webSocketsInvalidState:"The Web Socket transport is in an invalid state, transitioning into reconnecting.",reconnectTimeout:"Couldn't reconnect within the configured timeout of {0} ms, disconnecting.",reconnectWindowTimeout:"The client has been inactive since {0} and it has exceeded the inactivity timeout of {1} ms. Stopping the connection."};if("function"!=typeof e)throw new Error(s.nojQuery);var l,c,p="complete"===t.document.readyState,u=e(t),d="__Negotiate Aborted__",h={onStart:"onStart",onStarting:"onStarting",onReceived:"onReceived",onError:"onError",onConnectionSlow:"onConnectionSlow",onReconnecting:"onReconnecting",onReconnect:"onReconnect",onStateChanged:"onStateChanged",onDisconnect:"onDisconnect"},f={processData:!0,timeout:null,async:!0,global:!1,cache:!1},m=function(e,n){if(n!==!1){var r;"undefined"!=typeof t.console&&(r="["+(new Date).toTimeString()+"] SignalR: "+e,t.console.debug?t.console.debug(r):t.console.log&&t.console.log(r))}},g=function(t,n,r){return n===t.state&&(t.state=r,e(t).triggerHandler(h.onStateChanged,[{oldState:n,newState:r}]),!0)},v=function(e){return e.state===l.connectionState.disconnected},y=function(e){return e._.keepAliveData.activated&&e.transport.supportsKeepAlive(e)},b=function(n){var r,a;n._.configuredStopReconnectingTimeout||(a=function(t){var n=l._.format(l.resources.reconnectTimeout,t.disconnectTimeout);t.log(n),e(t).triggerHandler(h.onError,[l._.error(n,"TimeoutException")]),t.stop(!1,!1)},n.reconnecting(function(){var e=this;e.state===l.connectionState.reconnecting&&(r=t.setTimeout(function(){a(e)},e.disconnectTimeout))}),n.stateChanged(function(e){e.oldState===l.connectionState.reconnecting&&t.clearTimeout(r)}),n._.configuredStopReconnectingTimeout=!0)};l=function(e,t,n){return new l.fn.init(e,t,n)},l._={defaultContentType:"application/x-www-form-urlencoded; charset=UTF-8",ieVersion:function(){var e,n;return"Microsoft Internet Explorer"===t.navigator.appName&&(n=/MSIE ([0-9]+\.[0-9]+)/.exec(t.navigator.userAgent),n&&(e=t.parseFloat(n[1]))),e}(),error:function(e,t,n){var r=new Error(e);return r.source=t,"undefined"!=typeof n&&(r.context=n),r},transportError:function(e,t,r,a){var i=this.error(e,r,a);return i.transport=t?t.name:n,i},format:function(){for(var e=arguments[0],t=0;t<arguments.length-1;t++)e=e.replace("{"+t+"}",arguments[t+1]);return e},firefoxMajorVersion:function(e){var t=e.match(/Firefox\/(\d+)/);return!t||!t.length||t.length<2?0:parseInt(t[1],10)},configurePingInterval:function(n){var r=n._.config,a=function(t){e(n).triggerHandler(h.onError,[t])};r&&!n._.pingIntervalId&&r.pingInterval&&(n._.pingIntervalId=t.setInterval(function(){l.transports._logic.pingServer(n).fail(a)},r.pingInterval))}},l.events=h,l.resources=s,l.ajaxDefaults=f,l.changeState=g,l.isDisconnecting=v,l.connectionState={connecting:0,connected:1,reconnecting:2,disconnected:4},l.hub={start:function(){throw new Error("SignalR: Error loading hubs. Ensure your hubs reference is correct, e.g. <script src='/signalr/js'></script>.")}},"function"==typeof u.on?u.on("load",function(){p=!0}):u.load(function(){p=!0}),l.fn=l.prototype={init:function(t,n,r){var a=e(this);this.url=t,this.qs=n,this.lastError=null,this._={keepAliveData:{},connectingMessageBuffer:new o(this,function(e){a.triggerHandler(h.onReceived,[e])}),lastMessageAt:(new Date).getTime(),lastActiveAt:(new Date).getTime(),beatInterval:5e3,beatHandle:null,totalTransportConnectTimeout:0},"boolean"==typeof r&&(this.logging=r)},_parseResponse:function(e){var t=this;return e&&"string"==typeof e?t.json.parse(e):e},_originalJson:t.JSON,json:t.JSON,isCrossDomain:function(n,r){var a;return n=e.trim(n),r=r||t.location,0===n.indexOf("http")&&(a=t.document.createElement("a"),a.href=n,a.protocol+i(a.protocol,a.host)!==r.protocol+i(r.protocol,r.host))},ajaxDataType:"text",contentType:"application/json; charset=UTF-8",logging:!1,state:l.connectionState.disconnected,clientProtocol:"1.5",reconnectDelay:2e3,transportConnectTimeout:0,disconnectTimeout:3e4,reconnectWindow:3e4,keepAliveWarnAt:2/3,start:function(n,a){var i,o=this,c={pingInterval:3e5,waitForPageLoad:!0,transport:"auto",jsonp:!1},f=o._deferral||e.Deferred(),m=t.document.createElement("a");if(o.lastError=null,o._deferral=f,!o.json)throw new Error("SignalR: No JSON parser found. Please ensure json2.js is referenced before the SignalR.js file if you need to support clients without native JSON parsing support, e.g. IE<8.");if("function"===e.type(n)?a=n:"object"===e.type(n)&&(e.extend(c,n),"function"===e.type(c.callback)&&(a=c.callback)),c.transport=r(c.transport,o),!c.transport)throw new Error("SignalR: Invalid transport(s) specified, aborting start.");if(o._.config=c,!p&&c.waitForPageLoad===!0)return o._.deferredStartHandler=function(){o.start(n,a)},u.bind("load",o._.deferredStartHandler),f.promise();if(o.state===l.connectionState.connecting)return f.promise();if(g(o,l.connectionState.disconnected,l.connectionState.connecting)===!1)return f.resolve(o),f.promise();b(o),m.href=o.url,m.protocol&&":"!==m.protocol?(o.protocol=m.protocol,o.host=m.host):(o.protocol=t.document.location.protocol,o.host=m.host||t.document.location.host),o.baseUrl=o.protocol+"//"+o.host,o.wsProtocol="https:"===o.protocol?"wss://":"ws://","auto"===c.transport&&c.jsonp===!0&&(c.transport="longPolling"),0===o.url.indexOf("//")&&(o.url=t.location.protocol+o.url,o.log("Protocol relative URL detected, normalizing it to '"+o.url+"'.")),this.isCrossDomain(o.url)&&(o.log("Auto detected cross domain url."),"auto"===c.transport&&(c.transport=["webSockets","serverSentEvents","longPolling"]),"undefined"==typeof c.withCredentials&&(c.withCredentials=!0),c.jsonp||(c.jsonp=!e.support.cors,c.jsonp&&o.log("Using jsonp because this browser doesn't support CORS.")),o.contentType=l._.defaultContentType),o.withCredentials=c.withCredentials,o.ajaxDataType=c.jsonp?"jsonp":"text",e(o).bind(h.onStart,function(t,n){"function"===e.type(a)&&a.call(o),f.resolve(o)}),o._.initHandler=l.transports._logic.initHandler(o),i=function(n,r){var a=l._.error(s.noTransportOnInit);if(r=r||0,r>=n.length)return 0===r?o.log("No transports supported by the server were selected."):1===r?o.log("No fallback transports were selected."):o.log("Fallback transports exhausted."),e(o).triggerHandler(h.onError,[a]),f.reject(a),void o.stop();if(o.state!==l.connectionState.disconnected){var c=n[r],p=l.transports[c],d=function(){i(n,r+1)};o.transport=p;try{o._.initHandler.start(p,function(){var n=l._.firefoxMajorVersion(t.navigator.userAgent)>=11,r=!!o.withCredentials&&n;o.log("The start request succeeded. Transitioning to the connected state."),y(o)&&l.transports._logic.monitorKeepAlive(o),l.transports._logic.startHeartbeat(o),l._.configurePingInterval(o),g(o,l.connectionState.connecting,l.connectionState.connected)||o.log("WARNING! The connection was not in the connecting state."),o._.connectingMessageBuffer.drain(),e(o).triggerHandler(h.onStart),u.bind("unload",function(){o.log("Window unloading, stopping the connection."),o.stop(r)}),n&&u.bind("beforeunload",function(){t.setTimeout(function(){o.stop(r)},0)})},d)}catch(m){o.log(p.name+" transport threw '"+m.message+"' when attempting to start."),d()}}};var v=o.url+"/negotiate",S=function(t,n){var r=l._.error(s.errorOnNegotiate,t,n._.negotiateRequest);e(n).triggerHandler(h.onError,r),f.reject(r),n.stop()};return e(o).triggerHandler(h.onStarting),v=l.transports._logic.prepareQueryString(o,v),o.log("Negotiating with '"+v+"'."),o._.negotiateRequest=l.transports._logic.ajax(o,{url:v,error:function(e,t){t!==d?S(e,o):f.reject(l._.error(s.stoppedWhileNegotiating,null,o._.negotiateRequest))},success:function(t){var n,r,a,p=[],u=[];try{n=o._parseResponse(t)}catch(d){return void S(l._.error(s.errorParsingNegotiateResponse,d),o)}return r=o._.keepAliveData,o.appRelativeUrl=n.Url,o.id=n.ConnectionId,o.token=n.ConnectionToken,o.webSocketServerUrl=n.WebSocketServerUrl,o._.pollTimeout=1e3*n.ConnectionTimeout+1e4,o.disconnectTimeout=1e3*n.DisconnectTimeout,o._.totalTransportConnectTimeout=o.transportConnectTimeout+1e3*n.TransportConnectTimeout,n.KeepAliveTimeout?(r.activated=!0,r.timeout=1e3*n.KeepAliveTimeout,r.timeoutWarning=r.timeout*o.keepAliveWarnAt,o._.beatInterval=(r.timeout-r.timeoutWarning)/3):r.activated=!1,o.reconnectWindow=o.disconnectTimeout+(r.timeout||0),n.ProtocolVersion&&n.ProtocolVersion===o.clientProtocol?(e.each(l.transports,function(e){return 0===e.indexOf("_")||"webSockets"===e&&!n.TryWebSockets||void u.push(e)}),e.isArray(c.transport)?e.each(c.transport,function(t,n){e.inArray(n,u)>=0&&p.push(n)}):"auto"===c.transport?p=u:e.inArray(c.transport,u)>=0&&p.push(c.transport),void i(p)):(a=l._.error(l._.format(s.protocolIncompatible,o.clientProtocol,n.ProtocolVersion)),e(o).triggerHandler(h.onError,[a]),void f.reject(a))}}),f.promise()},starting:function(t){var n=this;return e(n).bind(h.onStarting,function(e,r){t.call(n)}),n},send:function(e){var t=this;if(t.state===l.connectionState.disconnected)throw new Error("SignalR: Connection must be started before data can be sent. Call .start() before .send()");if(t.state===l.connectionState.connecting)throw new Error("SignalR: Connection has not been fully initialized. Use .start().done() or .start().fail() to run logic after the connection has started.");return t.transport.send(t,e),t},received:function(t){var n=this;return e(n).bind(h.onReceived,function(e,r){t.call(n,r)}),n},stateChanged:function(t){var n=this;return e(n).bind(h.onStateChanged,function(e,r){t.call(n,r)}),n},error:function(t){var n=this;return e(n).bind(h.onError,function(e,r,a){n.lastError=r,t.call(n,r,a)}),n},disconnected:function(t){var n=this;return e(n).bind(h.onDisconnect,function(e,r){t.call(n)}),n},connectionSlow:function(t){var n=this;return e(n).bind(h.onConnectionSlow,function(e,r){t.call(n)}),n},reconnecting:function(t){var n=this;return e(n).bind(h.onReconnecting,function(e,r){t.call(n)}),n},reconnected:function(t){var n=this;return e(n).bind(h.onReconnect,function(e,r){t.call(n)}),n},stop:function(n,r){var a=this,i=a._deferral;return a._.deferredStartHandler&&u.unbind("load",a._.deferredStartHandler),delete a._.config,delete a._.deferredStartHandler,p||a._.config&&a._.config.waitForPageLoad!==!0?a.state!==l.connectionState.disconnected?(a.log("Stopping connection."),t.clearTimeout(a._.beatHandle),t.clearInterval(a._.pingIntervalId),a.transport&&(a.transport.stop(a),r!==!1&&a.transport.abort(a,n),y(a)&&l.transports._logic.stopMonitoringKeepAlive(a),a.transport=null),a._.negotiateRequest&&(a._.negotiateRequest.abort(d),delete a._.negotiateRequest),a._.initHandler&&a._.initHandler.stop(),delete a._deferral,delete a.messageId,delete a.groupsToken,delete a.id,delete a._.pingIntervalId,delete a._.lastMessageAt,delete a._.lastActiveAt,a._.connectingMessageBuffer.clear(),g(a,a.state,l.connectionState.disconnected),e(a).triggerHandler(h.onDisconnect),a):void 0:(a.log("Stopping connection prior to negotiate."),void(i&&i.reject(l._.error(s.stoppedWhileLoading))))},log:function(e){m(e,this.logging)}},l.fn.init.prototype=l.fn,l.noConflict=function(){return e.connection===l&&(e.connection=c),l},e.connection&&(c=e.connection),e.connection=e.signalR=l}(window.jQuery,window),function(e,t,n){function r(e){e._.keepAliveData.monitoring&&a(e),s.markActive(e)&&(e._.beatHandle=t.setTimeout(function(){r(e)},e._.beatInterval))}function a(t){var n,r=t._.keepAliveData;t.state===l.connectionState.connected&&(n=(new Date).getTime()-t._.lastMessageAt,n>=r.timeout?(t.log("Keep alive timed out.  Notifying transport that connection has been lost."),t.transport.lostConnection(t)):n>=r.timeoutWarning?r.userNotified||(t.log("Keep alive has been missed, connection may be dead/slow."),e(t).triggerHandler(c.onConnectionSlow),r.userNotified=!0):r.userNotified=!1)}function i(e,t){var n=e.url+t;return e.transport&&(n+="?transport="+e.transport.name),s.prepareQueryString(e,n)}function o(e){this.connection=e,this.startRequested=!1,this.startCompleted=!1,this.connectionStopped=!1}var s,l=e.signalR,c=e.signalR.events,p=e.signalR.changeState,u="__Start Aborted__";l.transports={},o.prototype={start:function(e,r,a){var i=this,o=i.connection,s=!1;return i.startRequested||i.connectionStopped?void o.log("WARNING! "+e.name+" transport cannot be started. Initialization ongoing or completed."):(o.log(e.name+" transport starting."),e.start(o,function(){s||i.initReceived(e,r)},function(t){return s||(s=!0,i.transportFailed(e,t,a)),!i.startCompleted||i.connectionStopped}),void(i.transportTimeoutHandle=t.setTimeout(function(){s||(s=!0,o.log(e.name+" transport timed out when trying to connect."),i.transportFailed(e,n,a))},o._.totalTransportConnectTimeout)))},stop:function(){this.connectionStopped=!0,t.clearTimeout(this.transportTimeoutHandle),l.transports._logic.tryAbortStartRequest(this.connection)},initReceived:function(e,n){var r=this,a=r.connection;return r.startRequested?void a.log("WARNING! The client received multiple init messages."):void(r.connectionStopped||(r.startRequested=!0,t.clearTimeout(r.transportTimeoutHandle),a.log(e.name+" transport connected. Initiating start request."),l.transports._logic.ajaxStart(a,function(){r.startCompleted=!0,n()})))},transportFailed:function(n,r,a){var i,o=this.connection,s=o._deferral;this.connectionStopped||(t.clearTimeout(this.transportTimeoutHandle),this.startRequested?this.startCompleted||(i=l._.error(l.resources.errorDuringStartRequest,r),o.log(n.name+" transport failed during the start request. Stopping the connection."),e(o).triggerHandler(c.onError,[i]),s&&s.reject(i),o.stop()):(n.stop(o),o.log(n.name+" transport failed to connect. Attempting to fall back."),a()))}},s=l.transports._logic={ajax:function(t,n){return e.ajax(e.extend(!0,{},e.signalR.ajaxDefaults,{type:"GET",data:{},xhrFields:{withCredentials:t.withCredentials},contentType:t.contentType,dataType:t.ajaxDataType},n))},pingServer:function(t){var n,r,a=e.Deferred();return t.transport?(n=t.url+"/ping",n=s.addQs(n,t.qs),r=s.ajax(t,{url:n,success:function(e){var n;try{n=t._parseResponse(e)}catch(i){return a.reject(l._.transportError(l.resources.pingServerFailedParse,t.transport,i,r)),void t.stop()}"pong"===n.Response?a.resolve():a.reject(l._.transportError(l._.format(l.resources.pingServerFailedInvalidResponse,e),t.transport,null,r))},error:function(e){401===e.status||403===e.status?(a.reject(l._.transportError(l._.format(l.resources.pingServerFailedStatusCode,e.status),t.transport,e,r)),t.stop()):a.reject(l._.transportError(l.resources.pingServerFailed,t.transport,e,r))}})):a.reject(l._.transportError(l.resources.noConnectionTransport,t.transport)),a.promise()},prepareQueryString:function(e,n){var r;return r=s.addQs(n,"clientProtocol="+e.clientProtocol),r=s.addQs(r,e.qs),e.token&&(r+="&connectionToken="+t.encodeURIComponent(e.token)),e.data&&(r+="&connectionData="+t.encodeURIComponent(e.data)),r},addQs:function(t,n){var r,a=t.indexOf("?")!==-1?"&":"?";if(!n)return t;if("object"==typeof n)return t+a+e.param(n);if("string"==typeof n)return r=n.charAt(0),"?"!==r&&"&"!==r||(a=""),t+a+n;throw new Error("Query string property must be either a string or object.")},getUrl:function(e,n,r,a,i){var o="webSockets"===n?"":e.baseUrl,l=o+e.appRelativeUrl,c="transport="+n;return!i&&e.groupsToken&&(c+="&groupsToken="+t.encodeURIComponent(e.groupsToken)),r?(l+=a?"/poll":"/reconnect",!i&&e.messageId&&(c+="&messageId="+t.encodeURIComponent(e.messageId))):l+="/connect",l+="?"+c,l=s.prepareQueryString(e,l),i||(l+="&tid="+Math.floor(11*Math.random())),l},maximizePersistentResponse:function(e){return{MessageId:e.C,Messages:e.M,Initialized:"undefined"!=typeof e.S,ShouldReconnect:"undefined"!=typeof e.T,LongPollDelay:e.L,GroupsToken:e.G}},updateGroups:function(e,t){t&&(e.groupsToken=t)},stringifySend:function(e,t){return"string"==typeof t||"undefined"==typeof t||null===t?t:e.json.stringify(t)},ajaxSend:function(t,n){var r,a=s.stringifySend(t,n),o=i(t,"/send"),p=function(t,a){e(a).triggerHandler(c.onError,[l._.transportError(l.resources.sendFailed,a.transport,t,r),n])};return r=s.ajax(t,{url:o,type:"jsonp"===t.ajaxDataType?"GET":"POST",contentType:l._.defaultContentType,data:{data:a},success:function(e){var n;if(e){try{n=t._parseResponse(e)}catch(r){return p(r,t),void t.stop()}s.triggerReceived(t,n)}},error:function(e,n){"abort"!==n&&"parsererror"!==n&&p(e,t)}})},ajaxAbort:function(e,t){if("undefined"!=typeof e.transport){t="undefined"==typeof t||t;var n=i(e,"/abort");s.ajax(e,{url:n,async:t,timeout:1e3,type:"POST"}),e.log("Fired ajax abort async = "+t+".")}},ajaxStart:function(t,n){var r=function(e){var n=t._deferral;n&&n.reject(e)},a=function(n){t.log("The start request failed. Stopping the connection."),e(t).triggerHandler(c.onError,[n]),r(n),t.stop()};t._.startRequest=s.ajax(t,{url:i(t,"/start"),success:function(e,r,i){var o;try{o=t._parseResponse(e)}catch(s){return void a(l._.error(l._.format(l.resources.errorParsingStartResponse,e),s,i))}"started"===o.Response?n():a(l._.error(l._.format(l.resources.invalidStartResponse,e),null,i))},error:function(e,n,i){n!==u?a(l._.error(l.resources.errorDuringStartRequest,i,e)):(t.log("The start request aborted because connection.stop() was called."),r(l._.error(l.resources.stoppedDuringStartRequest,null,e)))}})},tryAbortStartRequest:function(e){e._.startRequest&&(e._.startRequest.abort(u),delete e._.startRequest)},tryInitialize:function(e,t,n){t.Initialized&&n?n():t.Initialized&&e.log("WARNING! The client received an init message after reconnecting.")},triggerReceived:function(t,n){t._.connectingMessageBuffer.tryBuffer(n)||e(t).triggerHandler(c.onReceived,[n])},processMessages:function(t,n,r){var a;s.markLastMessage(t),n&&(a=s.maximizePersistentResponse(n),s.updateGroups(t,a.GroupsToken),a.MessageId&&(t.messageId=a.MessageId),a.Messages&&(e.each(a.Messages,function(e,n){s.triggerReceived(t,n)}),s.tryInitialize(t,a,r)))},monitorKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring?t.log("Tried to monitor keep alive but it's already being monitored."):(n.monitoring=!0,s.markLastMessage(t),t._.keepAliveData.reconnectKeepAliveUpdate=function(){s.markLastMessage(t)},e(t).bind(c.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t.log("Now monitoring keep alive with a warning timeout of "+n.timeoutWarning+", keep alive timeout of "+n.timeout+" and disconnecting timeout of "+t.disconnectTimeout))},stopMonitoringKeepAlive:function(t){var n=t._.keepAliveData;n.monitoring&&(n.monitoring=!1,e(t).unbind(c.onReconnect,t._.keepAliveData.reconnectKeepAliveUpdate),t._.keepAliveData={},t.log("Stopping the monitoring of the keep alive."))},startHeartbeat:function(e){e._.lastActiveAt=(new Date).getTime(),r(e)},markLastMessage:function(e){e._.lastMessageAt=(new Date).getTime()},markActive:function(e){return!!s.verifyLastActive(e)&&(e._.lastActiveAt=(new Date).getTime(),!0)},isConnectedOrReconnecting:function(e){return e.state===l.connectionState.connected||e.state===l.connectionState.reconnecting},ensureReconnectingState:function(t){return p(t,l.connectionState.connected,l.connectionState.reconnecting)===!0&&e(t).triggerHandler(c.onReconnecting),t.state===l.connectionState.reconnecting},clearReconnectTimeout:function(e){e&&e._.reconnectTimeout&&(t.clearTimeout(e._.reconnectTimeout),delete e._.reconnectTimeout)},verifyLastActive:function(t){if((new Date).getTime()-t._.lastActiveAt>=t.reconnectWindow){var n=l._.format(l.resources.reconnectWindowTimeout,new Date(t._.lastActiveAt),t.reconnectWindow);return t.log(n),e(t).triggerHandler(c.onError,[l._.error(n,"TimeoutException")]),t.stop(!1,!1),!1}return!0},reconnect:function(e,n){var r=l.transports[n];if(s.isConnectedOrReconnecting(e)&&!e._.reconnectTimeout){if(!s.verifyLastActive(e))return;e._.reconnectTimeout=t.setTimeout(function(){s.verifyLastActive(e)&&(r.stop(e),s.ensureReconnectingState(e)&&(e.log(n+" reconnecting."),r.start(e)))},e.reconnectDelay)}},handleParseFailure:function(t,n,r,a,i){var o=l._.transportError(l._.format(l.resources.parseFailed,n),t.transport,r,i);a&&a(o)?t.log("Failed to parse server response while attempting to connect."):(e(t).triggerHandler(c.onError,[o]),t.stop())},initHandler:function(e){return new o(e)},foreverFrame:{count:0,connections:{}}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic;r.transports.webSockets={name:"webSockets",supportsKeepAlive:function(){return!0},send:function(t,n){var i=o.stringifySend(t,n);try{t.socket.send(i)}catch(s){e(t).triggerHandler(a.onError,[r._.transportError(r.resources.webSocketsInvalidState,t.transport,s,t.socket),n])}},start:function(n,s,l){var c,p=!1,u=this,d=!s,h=e(n);return t.WebSocket?void(n.socket||(c=n.webSocketServerUrl?n.webSocketServerUrl:n.wsProtocol+n.host,c+=o.getUrl(n,this.name,d),n.log("Connecting to websocket endpoint '"+c+"'."),n.socket=new t.WebSocket(c),n.socket.onopen=function(){p=!0,n.log("Websocket opened."),o.clearReconnectTimeout(n),i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&h.triggerHandler(a.onReconnect)},n.socket.onclose=function(t){var i;this===n.socket&&(p&&"undefined"!=typeof t.wasClean&&t.wasClean===!1?(i=r._.transportError(r.resources.webSocketClosed,n.transport,t),n.log("Unclean disconnect from websocket: "+(t.reason||"[no reason given]."))):n.log("Websocket closed."),l&&l(i)||(i&&e(n).triggerHandler(a.onError,[i]),u.reconnect(n)))},n.socket.onmessage=function(t){var r;try{r=n._parseResponse(t.data)}catch(a){return void o.handleParseFailure(n,t.data,a,l,t)}r&&(e.isEmptyObject(r)||r.M?o.processMessages(n,r,s):o.triggerReceived(n,r))})):void l()},reconnect:function(e){o.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},stop:function(e){o.clearReconnectTimeout(e),e.socket&&(e.log("Closing the Websocket."),e.socket.close(),e.socket=null)},abort:function(e,t){o.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic,s=function(e){t.clearTimeout(e._.reconnectAttemptTimeoutHandle),delete e._.reconnectAttemptTimeoutHandle};r.transports.serverSentEvents={name:"serverSentEvents",supportsKeepAlive:function(){return!0},timeOut:3e3,start:function(n,l,c){var p,u=this,d=!1,h=e(n),f=!l;if(n.eventSource&&(n.log("The connection already has an event source. Stopping it."),n.stop()),!t.EventSource)return void(c&&(n.log("This browser doesn't support SSE."),c()));p=o.getUrl(n,this.name,f);try{n.log("Attempting to connect to SSE endpoint '"+p+"'."),n.eventSource=new t.EventSource(p,{withCredentials:n.withCredentials})}catch(m){return n.log("EventSource failed trying to connect with error "+m.Message+"."),void(c?c():(h.triggerHandler(a.onError,[r._.transportError(r.resources.eventSourceFailedToConnect,n.transport,m)]),f&&u.reconnect(n)))}f&&(n._.reconnectAttemptTimeoutHandle=t.setTimeout(function(){d===!1&&n.eventSource.readyState!==t.EventSource.OPEN&&u.reconnect(n)},u.timeOut)),n.eventSource.addEventListener("open",function(e){n.log("EventSource connected."),s(n),o.clearReconnectTimeout(n),d===!1&&(d=!0,i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&h.triggerHandler(a.onReconnect))},!1),n.eventSource.addEventListener("message",function(e){var t;if("initialized"!==e.data){try{t=n._parseResponse(e.data)}catch(r){return void o.handleParseFailure(n,e.data,r,c,e)}o.processMessages(n,t,l)}},!1),n.eventSource.addEventListener("error",function(e){var i=r._.transportError(r.resources.eventSourceError,n.transport,e);this===n.eventSource&&(c&&c(i)||(n.log("EventSource readyState: "+n.eventSource.readyState+"."),e.eventPhase===t.EventSource.CLOSED?(n.log("EventSource reconnecting due to the server connection ending."),u.reconnect(n)):(n.log("EventSource error."),h.triggerHandler(a.onError,[i]))))},!1)},reconnect:function(e){o.reconnect(e,this.name)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){o.ajaxSend(e,t)},stop:function(e){s(e),o.clearReconnectTimeout(e),e&&e.eventSource&&(e.log("EventSource calling close()."),e.eventSource.close(),e.eventSource=null,delete e.eventSource)},abort:function(e,t){o.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=r.transports._logic,s=function(){var e=t.document.createElement("iframe");return e.setAttribute("style","position:absolute;top:0;left:0;width:0;height:0;visibility:hidden;"),e},l=function(){var e=null,n=1e3,a=0;return{prevent:function(){r._.ieVersion<=8&&(0===a&&(e=t.setInterval(function(){var e=s();t.document.body.appendChild(e),t.document.body.removeChild(e),e=null},n)),a++)},cancel:function(){1===a&&t.clearInterval(e),a>0&&a--}}}();r.transports.foreverFrame={name:"foreverFrame",supportsKeepAlive:function(){return!0},iframeClearThreshold:50,start:function(e,n,r){var a,i=this,c=o.foreverFrame.count+=1,p=s(),u=function(){e.log("Forever frame iframe finished loading and is no longer receiving messages."),r&&r()||i.reconnect(e)};return t.EventSource?void(r&&(e.log("Forever Frame is not supported by SignalR on browsers with SSE support."),r())):(p.setAttribute("data-signalr-connection-id",e.id),l.prevent(),a=o.getUrl(e,this.name),a+="&frameId="+c,t.document.documentElement.appendChild(p),e.log("Binding to iframe's load event."),p.addEventListener?p.addEventListener("load",u,!1):p.attachEvent&&p.attachEvent("onload",u),p.src=a,o.foreverFrame.connections[c]=e,e.frame=p,e.frameId=c,void(n&&(e.onSuccess=function(){e.log("Iframe transport started."),n()})))},reconnect:function(e){var n=this;o.isConnectedOrReconnecting(e)&&o.verifyLastActive(e)&&t.setTimeout(function(){if(o.verifyLastActive(e)&&e.frame&&o.ensureReconnectingState(e)){var t=e.frame,r=o.getUrl(e,n.name,!0)+"&frameId="+e.frameId;e.log("Updating iframe src to '"+r+"'."),t.src=r}},e.reconnectDelay)},lostConnection:function(e){this.reconnect(e)},send:function(e,t){o.ajaxSend(e,t)},receive:function(t,n){var a,i,s;if(t.json!==t._originalJson&&(n=t._originalJson.stringify(n)),s=t._parseResponse(n),o.processMessages(t,s,t.onSuccess),t.state===e.signalR.connectionState.connected&&(t.frameMessageCount=(t.frameMessageCount||0)+1,t.frameMessageCount>r.transports.foreverFrame.iframeClearThreshold&&(t.frameMessageCount=0,a=t.frame.contentWindow||t.frame.contentDocument,a&&a.document&&a.document.body)))for(i=a.document.body;i.firstChild;)i.removeChild(i.firstChild)},stop:function(e){var n=null;if(l.cancel(),e.frame){if(e.frame.stop)e.frame.stop();else try{n=e.frame.contentWindow||e.frame.contentDocument,n.document&&n.document.execCommand&&n.document.execCommand("Stop")}catch(r){e.log("Error occurred when stopping foreverFrame transport. Message = "+r.message+".")}e.frame.parentNode===t.document.body&&t.document.body.removeChild(e.frame),delete o.foreverFrame.connections[e.frameId],e.frame=null,e.frameId=null,delete e.frame,delete e.frameId,delete e.onSuccess,delete e.frameMessageCount,e.log("Stopping forever frame.")}},abort:function(e,t){o.ajaxAbort(e,t)},getConnection:function(e){return o.foreverFrame.connections[e]},started:function(t){i(t,r.connectionState.reconnecting,r.connectionState.connected)===!0&&e(t).triggerHandler(a.onReconnect)}}}(window.jQuery,window),function(e,t,n){var r=e.signalR,a=e.signalR.events,i=e.signalR.changeState,o=e.signalR.isDisconnecting,s=r.transports._logic;r.transports.longPolling={name:"longPolling",supportsKeepAlive:function(){return!1},reconnectDelay:3e3,start:function(n,l,c){var p=this,u=function(){u=e.noop,n.log("LongPolling connected."),l?l():n.log("WARNING! The client received an init message after reconnecting.")},d=function(e){return!!c(e)&&(n.log("LongPolling failed to connect."),!0)},h=n._,f=0,m=function(n){t.clearTimeout(h.reconnectTimeoutId),h.reconnectTimeoutId=null,i(n,r.connectionState.reconnecting,r.connectionState.connected)===!0&&(n.log("Raising the reconnect event"),e(n).triggerHandler(a.onReconnect))},g=36e5;n.pollXhr&&(n.log("Polling xhr requests already exists, aborting."),n.stop()),n.messageId=null,h.reconnectTimeoutId=null,h.pollTimeoutId=t.setTimeout(function(){!function i(l,c){var v=l.messageId,y=null===v,b=!y,S=!c,C=s.getUrl(l,p.name,b,S,!0),T={};l.messageId&&(T.messageId=l.messageId),l.groupsToken&&(T.groupsToken=l.groupsToken),o(l)!==!0&&(n.log("Opening long polling request to '"+C+"'."),l.pollXhr=s.ajax(n,{xhrFields:{onprogress:function(){s.markLastMessage(n)}},url:C,type:"POST",contentType:r._.defaultContentType,data:T,timeout:n._.pollTimeout,success:function(r){var a,c,p,g=0;n.log("Long poll complete."),f=0;try{a=n._parseResponse(r)}catch(v){return void s.handleParseFailure(l,r,v,d,l.pollXhr)}null!==h.reconnectTimeoutId&&m(l),a&&(c=s.maximizePersistentResponse(a)),s.processMessages(l,a,u),c&&"number"===e.type(c.LongPollDelay)&&(g=c.LongPollDelay),o(l)!==!0&&(p=c&&c.ShouldReconnect,p&&!s.ensureReconnectingState(l)||(g>0?h.pollTimeoutId=t.setTimeout(function(){i(l,p)},g):i(l,p)))},error:function(o,c){var u=r._.transportError(r.resources.longPollFailed,n.transport,o,l.pollXhr);if(t.clearTimeout(h.reconnectTimeoutId),h.reconnectTimeoutId=null,"abort"===c)return void n.log("Aborted xhr request.");
if(!d(u)){if(f++,n.state!==r.connectionState.reconnecting&&(n.log("An error occurred using longPolling. Status = "+c+".  Response = "+o.responseText+"."),e(l).triggerHandler(a.onError,[u])),(n.state===r.connectionState.connected||n.state===r.connectionState.reconnecting)&&!s.verifyLastActive(n))return;if(!s.ensureReconnectingState(l))return;h.pollTimeoutId=t.setTimeout(function(){i(l,!0)},p.reconnectDelay)}}}),b&&c===!0&&(h.reconnectTimeoutId=t.setTimeout(function(){m(l)},Math.min(1e3*(Math.pow(2,f)-1),g))))}(n)},250)},lostConnection:function(e){e.pollXhr&&e.pollXhr.abort("lostConnection")},send:function(e,t){s.ajaxSend(e,t)},stop:function(e){t.clearTimeout(e._.pollTimeoutId),t.clearTimeout(e._.reconnectTimeoutId),delete e._.pollTimeoutId,delete e._.reconnectTimeoutId,e.pollXhr&&(e.pollXhr.abort(),e.pollXhr=null,delete e.pollXhr)},abort:function(e,t){s.ajaxAbort(e,t)}}}(window.jQuery,window),function(e,t,n){function r(e){return e+p}function a(e,t,n){var r,a=e.length,i=[];for(r=0;r<a;r+=1)e.hasOwnProperty(r)&&(i[r]=t.call(n,e[r],r,e));return i}function i(t){return e.isFunction(t)?null:"undefined"===e.type(t)?null:t}function o(e){for(var t in e)if(e.hasOwnProperty(t))return!0;return!1}function s(e,t){var n,r=e._.invocationCallbacks;o(r)&&e.log("Clearing hub invocation callbacks with error: "+t+"."),e._.invocationCallbackId=0,delete e._.invocationCallbacks,e._.invocationCallbacks={};for(var a in r)n=r[a],n.method.call(n.scope,{E:t})}function l(e,t){return new l.fn.init(e,t)}function c(t,n){var r={qs:null,logging:!1,useDefaultPath:!0};return e.extend(r,n),t&&!r.useDefaultPath||(t=(t||"")+"/signalr"),new c.fn.init(t,r)}var p=".hubProxy",u=e.signalR;l.fn=l.prototype={init:function(e,t){this.state={},this.connection=e,this.hubName=t,this._={callbackMap:{}}},constructor:l,hasSubscriptions:function(){return o(this._.callbackMap)},on:function(t,n){var a=this,i=a._.callbackMap;return t=t.toLowerCase(),i[t]||(i[t]={}),i[t][n]=function(e,t){n.apply(a,t)},e(a).bind(r(t),i[t][n]),a},off:function(t,n){var a,i=this,s=i._.callbackMap;return t=t.toLowerCase(),a=s[t],a&&(a[n]?(e(i).unbind(r(t),a[n]),delete a[n],o(a)||delete s[t]):n||(e(i).unbind(r(t)),delete s[t])),i},invoke:function(t){var n=this,r=n.connection,o=e.makeArray(arguments).slice(1),s=a(o,i),l={H:n.hubName,M:t,A:s,I:r._.invocationCallbackId},c=e.Deferred(),p=function(a){var i,o,s=n._maximizeHubResponse(a);e.extend(n.state,s.State),s.Progress?c.notifyWith?c.notifyWith(n,[s.Progress.Data]):r._.progressjQueryVersionLogged||(r.log("A hub method invocation progress update was received but the version of jQuery in use ("+e.prototype.jquery+") does not support progress updates. Upgrade to jQuery 1.7+ to receive progress notifications."),r._.progressjQueryVersionLogged=!0):s.Error?(s.StackTrace&&r.log(s.Error+"\n"+s.StackTrace+"."),i=s.IsHubException?"HubException":"Exception",o=u._.error(s.Error,i),o.data=s.ErrorData,r.log(n.hubName+"."+t+" failed to execute. Error: "+o.message),c.rejectWith(n,[o])):(r.log("Invoked "+n.hubName+"."+t),c.resolveWith(n,[s.Result]))};return r._.invocationCallbacks[r._.invocationCallbackId.toString()]={scope:n,method:p},r._.invocationCallbackId+=1,e.isEmptyObject(n.state)||(l.S=n.state),r.log("Invoking "+n.hubName+"."+t),r.send(l),c.promise()},_maximizeHubResponse:function(e){return{State:e.S,Result:e.R,Progress:e.P?{Id:e.P.I,Data:e.P.D}:null,Id:e.I,IsHubException:e.H,Error:e.E,StackTrace:e.T,ErrorData:e.D}}},l.fn.init.prototype=l.fn,c.fn=c.prototype=e.connection(),c.fn.init=function(t,n){var a={qs:null,logging:!1,useDefaultPath:!0},i=this;e.extend(a,n),e.signalR.fn.init.call(i,t,a.qs,a.logging),i.proxies={},i._.invocationCallbackId=0,i._.invocationCallbacks={},i.received(function(t){var n,a,o,s,l,c;t&&("undefined"!=typeof t.P?(o=t.P.I.toString(),s=i._.invocationCallbacks[o],s&&s.method.call(s.scope,t)):"undefined"!=typeof t.I?(o=t.I.toString(),s=i._.invocationCallbacks[o],s&&(i._.invocationCallbacks[o]=null,delete i._.invocationCallbacks[o],s.method.call(s.scope,t))):(n=this._maximizeClientHubInvocation(t),i.log("Triggering client hub event '"+n.Method+"' on hub '"+n.Hub+"'."),l=n.Hub.toLowerCase(),c=n.Method.toLowerCase(),a=this.proxies[l],e.extend(a.state,n.State),e(a).triggerHandler(r(c),[n.Args])))}),i.error(function(e,t){var n,r;t&&(n=t.I,r=i._.invocationCallbacks[n],r&&(i._.invocationCallbacks[n]=null,delete i._.invocationCallbacks[n],r.method.call(r.scope,{E:e})))}),i.reconnecting(function(){i.transport&&"webSockets"===i.transport.name&&s(i,"Connection started reconnecting before invocation result was received.")}),i.disconnected(function(){s(i,"Connection was disconnected before invocation result was received.")})},c.fn._maximizeClientHubInvocation=function(e){return{Hub:e.H,Method:e.M,Args:e.A,State:e.S}},c.fn._registerSubscribedHubs=function(){var t=this;t._subscribedToHubs||(t._subscribedToHubs=!0,t.starting(function(){var n=[];e.each(t.proxies,function(e){this.hasSubscriptions()&&(n.push({name:e}),t.log("Client subscribed to hub '"+e+"'."))}),0===n.length&&t.log("No hubs have been subscribed to.  The client will not receive data from hubs.  To fix, declare at least one client side function prior to connection start for each hub you wish to subscribe to."),t.data=t.json.stringify(n)}))},c.fn.createHubProxy=function(e){e=e.toLowerCase();var t=this.proxies[e];return t||(t=l(this,e),this.proxies[e]=t),this._registerSubscribedHubs(),t},c.fn.init.prototype=c.fn,e.hubConnection=c}(window.jQuery,window),function(e,t){e.signalR.version="2.2.1"}(window.jQuery),function(e,t,n){"use strict";function r(t,n){return function(){n.apply(t,e.makeArray(arguments))}}function a(t,n){var a,i,o,s,l;for(a in t)if(t.hasOwnProperty(a)){if(i=t[a],!i.hubName)continue;l=n?i.on:i.off;for(o in i.client)if(i.client.hasOwnProperty(o)){if(s=i.client[o],!e.isFunction(s))continue;l.call(i,o,r(i,s))}}}if("function"!=typeof e.signalR)throw new Error("SignalR: SignalR is not loaded. Please ensure jquery.signalR-x.js is referenced before ~/signalr/js.");var i=e.signalR;e.hubConnection.prototype.createHubProxies=function(){var t={};return this.starting(function(){a(t,!0),this._registerSubscribedHubs()}).disconnected(function(){a(t,!1)}),t.transvaultHub=this.createHubProxy("transvaultHub"),t.transvaultHub.client={},t.transvaultHub.server={sendMessage:function(n){return t.transvaultHub.invoke.apply(t.transvaultHub,e.merge(["SendMessage"],e.makeArray(arguments)))}},t},i.hub=e.hubConnection("/hp/v3/adapters/transvault",{useDefaultPath:!1}),e.extend(i,i.hub.createHubProxies())}(window.jQuery,window),function(){"use strict";var e={};e.isNumber="[0-9]+",e.isNotEmpty="S+",e.isEmail=".+@.+..+";var t=function(e,t,n){if("undefined"==typeof e)throw new TypeError("Property cannot be undefined.");e+="";var r=new RegExp(t);if(!r.test(e))throw new Error(n)},n=0,r=jQuery.Deferred(),a=function(e){return e.nodeType?(r.resolve(e),r):document.getElementById(e)?(r.resolve(document.getElementById(e)),r):(setTimeout(function(){n<25?(n++,a(e)):r.reject()},25),r)},i=function(e){var t=[],n="";for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return n="&"+t.join("&")};window.hp={},hp.types={},hp.types.Event="Event",hp.types.Product="Product",hp.types.Adapter="Adapter",hp.models={},hp.models.Item=function(e,t){this.label=e,this.price=parseFloat(t,2)},hp.models.Options=function(n,r,a,i,o,s,l,c){this.name=l||"Checkout",this.CID=n,this.email=r,t(this.CID,e.isNumber,"Client ID should be digits only."),t(this.email,e.isEmail,"Primary email should be a valid email address."),"undefined"!=typeof o&&(this.ga=o),"undefined"!=typeof c&&(this.subject=c),"undefined"!=typeof a&&(this.repoEmail=a,t(this.repoEmail,e.isEmail,"Secondary email should be a valid email address.")),"undefined"!=typeof i&&(this.showMemoField="true"===i.toString().toLowerCase()?"True":"False"),"undefined"!=typeof s&&(this.orderId=s,t(this.orderId,e.isNumber,"Customer order Id must be a valid number."))},hp.Setup=function(e,t){if(!(e in hp.types))throw new Error("Please specify type. 'hp.Types.Event' or 'hp.Types.Product'");this.type=e,this.options=t,this.hasItems=!1,this.items={priceLabels:"",price:""}},hp.Setup.prototype.addItem=function(e){return this.items.priceLabels+=(""===this.items.price?"":",")+e.label,this.items.price+=(""===this.items.price?"":",")+e.price,this.hasItems=!0,this},hp.Setup.prototype.createForm=function(e,t){var n=jQuery.Deferred(),r=document.createElement("iframe"),o=document.createElement("a");o.href=t,r.setAttribute("seamless","seamless"),r.setAttribute("marginheight","0"),r.setAttribute("marginwidth","0"),r.setAttribute("frameborder","0"),r.setAttribute("horizontalscrolling","no"),r.setAttribute("verticalscrolling","no"),r.style.overflowY="hidden",r.style.border="none",r.width="640",r.className="inactive",r.style.opacity="0",r.style.transition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.webkitTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.mozTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.msTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)",r.style.oTransition="all 450ms 25ms cubic-bezier(0.175, 0.885, 0.320, 1)";var s=o.protocol+"//"+o.host;return this.type==hp.types.Event&&(s+="/hp/v1/event",r.height="1311"),this.type==hp.types.Product&&(s+="/hp/v1/item",r.height="1220"),s=s+"?"+i(this.options),s+=this.hasItems?i(this.items):"&price=0",r.src=s.replace("item?&","item?").replace("event?&","event?").toString(),r.onload=function(){n.resolve(r),r.className="active",r.style.opacity="1"},a(e).then(function(e){e.appendChild(r)}),n},$(function(){$("[data-inventory], [data-event]").hp()})}(),function(e,t,n,r){"use strict";if("undefined"==typeof jQuery)throw new Error("jQuery not found. 'jquery.hosted-payments.js' requires jQuery version 3 or greater. For more details, please visit http://jquery.com/.");var a=function(){var t=jQuery.Deferred();if(+e.fn.jquery[0]>=3)return t.resolve(),t;var r=e("<script />",{src:"https://code.jquery.com/jquery-3.1.1.min.js"});return hp.Utils.log("An invalid version of 'jQuery' was found. Attempting to load new version."),e(n.head).append(r),function a(){return+jQuery.fn.jquery[0]>=3?void setTimeout(function(){jQuery=jQuery.noConflict(),e=jQuery,t.resolve()},100):void setTimeout(a,250)}(),t};if(Array.prototype.map||(Array.prototype.map=function(e,t){var n,r,a;if(null===this)throw new TypeError(" this is null or not defined");var i=Object(this),o=i.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(n=t),r=new Array(o),a=0;a<o;){var s,l;a in i&&(s=i[a],l=e.call(n,s,a,i),r[a]=l),a++}return r}),Function.prototype.clone||(Function.prototype.clone=function(){var e=this;this.__isClone&&(e=this.__clonedFrom);var t=function(){return e.apply(this,arguments)};for(var n in this)t[n]=this[n];return t.__isClone=!0,t.__clonedFrom=e,t}),String.prototype.startsWith||(String.prototype.startsWith=function(e,t){return t=t||0,this.indexOf(e,t)===t}),String.prototype.includes||(String.prototype.includes=function(){return String.prototype.indexOf.apply(this,arguments)!==-1}),!Date.prototype.toISOString){var i=function(e){var t=String(e);return 1===t.length&&(t="0"+t),t};Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+i(this.getUTCMonth()+1)+"-"+i(this.getUTCDate())+"T"+i(this.getUTCHours())+":"+i(this.getUTCMinutes())+":"+i(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}if(!t.Base64)var o={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t,n,r,a,i,s,l,c="",p=0;for(e=o._utf8_encode(e);p<e.length;)t=e.charCodeAt(p++),n=e.charCodeAt(p++),r=e.charCodeAt(p++),a=t>>2,i=(3&t)<<4|n>>4,s=(15&n)<<2|r>>6,l=63&r,isNaN(n)?s=l=64:isNaN(r)&&(l=64),c=c+this._keyStr.charAt(a)+this._keyStr.charAt(i)+this._keyStr.charAt(s)+this._keyStr.charAt(l);return c},decode:function(e){var t,n,r,a,i,s,l,c="",p=0;for(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");p<e.length;)a=this._keyStr.indexOf(e.charAt(p++)),i=this._keyStr.indexOf(e.charAt(p++)),s=this._keyStr.indexOf(e.charAt(p++)),l=this._keyStr.indexOf(e.charAt(p++)),t=a<<2|i>>4,n=(15&i)<<4|s>>2,r=(3&s)<<6|l,c+=String.fromCharCode(t),64!=s&&(c+=String.fromCharCode(n)),64!=l&&(c+=String.fromCharCode(r));return c=o._utf8_decode(c)},_utf8_encode:function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t},_utf8_decode:function(e){for(var t="",n=0,r=a,a=i,i=0;n<e.length;)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(i=e.charCodeAt(n+1),t+=String.fromCharCode((31&r)<<6|63&i),n+=2):(i=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((15&r)<<12|(63&i)<<6|63&c3),n+=3);return t}};t.sessionStorage||(t.sessionStorage={length:0,setItem:function(e,t){n.cookie=e+"="+t+"; path=/",this.length++},getItem:function(e){for(var t=e+"=",r=n.cookie.split(";"),a=0,i=r.length;a<i;a++){for(var o=r[a];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return null},removeItem:function(e){this.setItem(e,"",-1),this.length--},clear:function(){for(var e=n.cookie.split(";"),t=0,r=e.length;t<r;t++){for(var a=e[t];" "===a.charAt(0);)a=a.substring(1,a.length);var i=a.substring(0,a.indexOf("="));this.removeItem(i)}this.length=0},key:function(e){var t=n.cookie.split(";");if(e>=t.length||isNaN(parseFloat(e))||!isFinite(e))return null;for(var r=t[e];" "===r.charAt(0);)r=r.substring(1,r.length);return r.substring(0,r.indexOf("="))}}),t.hp=hp||{},t.hp.Utils=hp.Utils||{},hp.Utils.defaults={},hp.Utils.plugins={},hp.PaymentService={},hp.PaymentService.EFT="EFT",hp.PaymentService.EMONEY="EMONEY",hp.PaymentService.TEST="TEST",hp.EntryType={},hp.EntryType.DEVICE_CAPTURED="DEVICE_CAPTURED",hp.EntryType.KEYED_CARD_PRESENT="KEYED_CARD_PRESENT",hp.EntryType.KEYED_CARD_NOT_PRESENT="KEYED_CARD_NOT_PRESENT",hp.PaymentType={},hp.PaymentType.CHARGE="CHARGE",hp.PaymentType.REFUND="REFUND",hp.PaymentType.CREATE_INSTRUMENT="CREATE_INSTRUMENT",hp.PaymentType.CANCEL="CANCEL",hp.PaymentType.ISSUE="ISSUE",hp.PaymentType.ADD_FUNDS="ADD_FUNDS",hp.Utils.payments=[],hp.Utils.hasPaymentInstrument=!1;var s=function(e,t){var n="hp-content-active",r="hp-form-"+e,a=t.find(".hp"),i=a.removeClass("hp-form-emoney hp-form-transvault hp-form-bank hp-form-code hp-form-cc hp-form-gc hp-form-success hp-form-error").addClass("hp hp-form").addClass(r);i.find(".hp-content").removeClass(n);var o=i.find(".hp-content-"+e).addClass(n);return setTimeout(function(){t.find(".hp").addClass("hp-active")},0),{parent:i,content:o}},l=function(e){var t=hp.PaymentService.EFT;switch(e=e.toString().toLowerCase().replace(/_/gi,"")){case"emoney":t=hp.PaymentService.EMONEY;break;case"eft":t=hp.PaymentService.EFT;break;case"test":t=hp.PaymentService.TEST;break;default:t=hp.PaymentService.EFT}return hp.Utils.defaults.paymentService=t,u("Payment service: "+t),t},c=function(e){var t=hp.EntryType.KEYED_CARD_NOT_PRESENT;switch(e=e.toString().toLowerCase().replace(/_/gi,"")){case"devicecaptured":t=hp.EntryType.DEVICE_CAPTURED;break;case"keyedcardpresent":t=hp.EntryType.KEYED_CARD_PRESENT;break;case"keyedcardnotpresent":t=hp.EntryType.KEYED_CARD_NOT_PRESENT;break;default:t=hp.EntryType.KEYED_CARD_NOT_PRESENT}return hp.Utils.defaults.entryType=t,u("Entry type: "+t),t},p=function(e){var t=hp.PaymentType.CHARGE;switch(e=e.toString().toLowerCase().replace(/_/gi,"")){case"charge":t=hp.PaymentType.CHARGE;break;case"refund":t=hp.PaymentType.REFUND;break;case"createinstrument":t=hp.PaymentType.CREATE_INSTRUMENT;break;default:t=hp.PaymentType.CHARGE}return hp.Utils.defaults.paymentType=t,u("Payment type: "+t),t},u=function(e){var t=Error;t.prototype.write=function(e){var t="@("+(this.lineNumber?this.fileName+":"+this.lineNumber+":1":n(this.stack));e=e.concat([t]),console&&console.log&&(console.log.apply?console.log.apply(console,e):console.log(e))};var n=function(e){var t=e.split("\n")[3];return t=t.indexOf(" (")>=0?t.split(" (")[1].substring(0,t.length-1):t.split("at ")[1]};return function(e){hp.Utils.defaults.debug&&t().write(Array.prototype.slice.call(arguments,0))}}(),d=function(){return hp.Utils.defaults.version},h=function(){return"undefined"!=typeof hp.Utils.defaults.instrumentId&&""!==hp.Utils.defaults.instrumentId?void(hp.Utils.hasPaymentInstrument=!0):void(hp.Utils.hasPaymentInstrument=!1)},f=function(){var e=null;e=t.performance&&t.performance.now?t.performance.now():Date.now?Date.now():(new Date).getTime();var n="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"==t?n:3&n|8).toString(16)});return n},m=function(e,t){"undefined"==typeof t&&(t=""),"undefined"==typeof e&&(e=""),hp.Utils.defaults.billingAddress.addressLine1=e,hp.Utils.defaults.billingAddress.postalCode=t},g=function(){e(".hp-error-container").is(":visible")&&b(),e(".hp-loading-container").addClass("hp-loading-container-active")},v=function(){e(".hp-loading-container").removeClass("hp-loading-container-active")},y=function(t,n){e(".hp-loading-container").is(":visible")&&v(),e(".hp-error-container").addClass("hp-error-container-active");var r=e(".hp-error-container .hp-error-message"),a="undefined"!=typeof t&&"undefined"!=typeof t.push,i='<p>Please review the following errors: </p><ul class="hp-error-message-list">{{errors}}</ul>';if(a){for(var o="",s=0;s<t.length;s++)o+="<li>"+t[s]+"</li>";i=i.replace("{{errors}}",o),r.html(i)}else r.text(t);e(".hp-error-container .hp-error-disclaimer a").show().on("click",b),hp.Utils.log("Sign In: Session cleared."),sessionStorage.clear(),"undefined"==typeof n||n||e(".hp-error-container .hp-error-disclaimer a").hide()},b=function(t){e(".hp-error-container").removeClass("hp-error-container-active"),e(".hp-error-container .hp-error-disclaimer a").off("click"),hp.Utils.defaults.eventCallback(),"undefined"==typeof t&&(t=!0),t&&hp.Utils.reset()},S=function(t,n){var r=['<div class="hp hp-form">','<div class="hp-loading-container">','<span class="hp-loading-text">Loading</span>','<div class="hp-loading"><span></span><span></span><span></span><span></span></div>',"</div>",'<div class="hp-error-container">','<span class="hp-error-text">{{error}} </span>','<div class="hp-error-message"></div>',"<hr />",'<div class="hp-error-disclaimer">If you feel that the above error was made by a mistake please contact our support at {{phone}}. <br /><br /><a href="javascript:;">&times; Dismiss error</a></div>',"</div>",'<div class="hp-row">','<div class="hp-col hp-col-left">','<ul class="hp-nav">',"{{nav}}","</ul>",'<div class="hp-secure">','<div class="hp-support">',"<strong>Help &amp; support</strong>",'<p>Having issues with your payments? Call us at <a href="tel:{{phone}}">{{phone}}</a>.</p>',"<br />","</div>",'<div class="hp-cards">','<img class="hp-cards-icons'+(hp.Utils.defaults.showAmex?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/amex.svg" alt="AMEX" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showDiners?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/diners.svg" alt="Diners" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showDiscover?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/discover.svg" alt="Discover" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showJcb?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/jcb.svg" alt="JCB" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showMasterCard?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/mastercard.svg" alt="Master Card" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showVisa?"":" hide")+'" src="https://cdn.rawgit.com/etsms/payment-icons/master/svg/flat/visa.svg" alt="VISA" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showEMoney?"":" hide")+'" src="https://cdn.rawgit.com/etsms/c2568c3f7343be79032ac7a717fa80de/raw/7923fdf2aacffbc6baf62454cc4213b46b943596/emoney-card-icon.svg" alt="EMoney" />','<img class="hp-cards-icons'+(hp.Utils.defaults.showGift?"":" hide")+'" src="https://cdn.rawgit.com/etsms/cd2abb29142a84bb16fbeb3d07a7aefa/raw/a17760bdd23cf1d90c22c8a2235f8d6e6753663e/gift-card-icon.svg" alt="Gift Cards" />',"</div>",'<a class="hp-secure-icon" href="https://www.etsms.com/" target="_blank" title="ETS - Electronic Transaction Systems">','<img src="https://cdn.rawgit.com/etsms/a5b6be8ebd898748ec829538bd4b603e/raw/9691ef92d11b5a1608a73f5f46c427c4c494d0b9/secure-icon.svg" alt="Secured by ETS" />',"<span>Secured by <br />ETS Corporation</span>","</a>",'<div class="hp-secure-bottom">','<div class="hp-secure-bottom-left">','<span class="'+(0===hp.Utils.getAmount()?"hide ":"")+(hp.Utils.defaults.paymentType===hp.PaymentType.REFUND?"hp-version-refund":"hp-version-charge")+'">'+(hp.Utils.defaults.paymentType===hp.PaymentType.REFUND?"Refund":"Charge")+': <span class="hp-version-amount">'+hp.Utils.formatCurrency(hp.Utils.getAmount())+"</span></span><br />","</div>",'<div class="hp-secure-bottom-right">',hp.Utils.getVersion(),"</div>","</div>","</div>","</div>",'<div class="hp-col hp-col-right">',"{{order}}",'<div class="hp-content hp-content-success">{{success}}</div>',"</div>","</div>","</div>"].join("");hp.Utils.plugins.CreditCard=new hp.CreditCard(t),hp.Utils.plugins.BankAccount=new hp.BankAccount(t),hp.Utils.plugins.Code=new hp.Code(t),hp.Utils.plugins.Success=new hp.Success(t),hp.Utils.plugins.Transvault=new hp.Transvault(t),hp.Utils.plugins.GiftCard=new hp.GiftCard(t),t.html(r.replace("{{success}}",hp.Utils.plugins.Success.createTemplate().replace("{{redirectLabel}}",hp.Utils.defaults.defaultRedirectLabel).replace("{{successLabel}}",hp.Utils.defaults.defaultSuccessLabel)).replace(/{{phone}}/gi,hp.Utils.defaults.defaultPhone).replace("{{error}}",hp.Utils.defaults.defaultErrorLabel).replace("{{order}}",hp.Utils.createOrder()).replace("{{nav}}",hp.Utils.createNav()));var a=t.find(".hp"),i=a.find(".hp-type"),o="hp-active";if(!a.length)throw new Error("hosted-payments.js : Could not locate template.");if(!i.length)throw new Error("hosted-payments.js : Could not locate template.");i.off("click").on("click",function(t){t.preventDefault();var r=e(this),a=r.index();i.removeClass(o).eq(a).addClass(o),e(function(){r.attr("class").match(/hp-cc/gi)&&n(hp.Utils.plugins.CreditCard),r.attr("class").match(/hp-bank/gi)&&n(hp.Utils.plugins.BankAccount),r.attr("class").match(/hp-emoney/gi)&&n(hp.Utils.plugins.EMoney),r.attr("class").match(/hp-code/gi)&&(r.find("a").blur(),n(hp.Utils.plugins.Code)),r.attr("class").match(/hp-transvault/gi)&&n(hp.Utils.plugins.Transvault),r.attr("class").match(/hp-gc/gi)&&n(hp.Utils.plugins.GiftCard)})}).eq(0).trigger("click")},C=function(t){var n=jQuery.Deferred(),r="undefined"==typeof t?0:t;return setTimeout(function(){hp.Utils.plugins.Success.init(),e(".hp-col-left .hp-type").off("click").removeClass("hp-active"),n.resolve()},r),n},T=function(t){return hp.Utils.defaults.amount=Math.abs(Math.round10(parseFloat(t),-2)),e(".hp.hp-form .hp-version-amount").text($(hp.Utils.defaults.amount)),hp.Utils.defaults.amount},_=function(){return hp.Utils.defaults.amount},U=function(){var e=hp.Utils.defaults.paymentTypeOrder,t="",n="",r="",a="",i="",o="";e.indexOf(0)>=0&&(n='<li class="hp-type hp-cc"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/9e2e4c55564ca8eba12f9fa3e7064299/raw/93965040e6e421e1851bfe7a15af92bdc722fa43/credt-card-icon.svg" alt="Credit Card" /> <span>Credit Card</span></a></li>'),e.indexOf(1)>=0&&(r='<li class="hp-type hp-bank"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/af49afe3c1c1cb41cb3204a45492bd47/raw/78e935c7e5290923dba15e8b595aef7c95b2292e/ach-icon.svg" alt="ACH and Bank Account" /> <span>Bank (ACH)</span></a></li>'),e.indexOf(2)>=0&&(a='<li class="hp-type hp-code"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/c70317acba59d3d5b60e5999d5feeab8/raw/764478d2660f97d002eb3bd3177b725a410f694d/swipe-icon.svg" alt="Swipe or Scan" /> <span>Swipe\\Scan</span></a></li>'),e.indexOf(3)>=0&&(i='<li class="hp-type hp-transvault"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/5363122967f20bd31d6630529cb17c3f/raw/0a0ae6a30247ced8ed5c0c85f2b42072b59b8fba/transvault-icon.svg" alt="Hosted Transvault" /> <span>Transvault</span></a></li>'),e.indexOf(4)>=0&&(o='<li class="hp-type hp-gc"><a href="javascript:void(0);"><img src="https://cdn.rawgit.com/etsms/2e9f0f3bb754a7910ffbdbd16ea9926a/raw/27ce16494e375ff8d04deb918ffd76d743397488/gift-icon.svg" alt="Gift Card" /> <span>Gift Card</span></a></li>');for(var s=0;s<e.length;s++)0===e[s]&&(t+=n),1===e[s]&&(t+=r),2===e[s]&&(t+=a),3===e[s]&&(t+=i),4===e[s]&&(t+=o);return t},E=function(){var e=hp.Utils.defaults.paymentTypeOrder,t="",n="",r="",a="",i="",o="";e.indexOf(0)>=0&&(n='<div class="hp-content hp-content-cc">{{creditCard}}</div>'.replace("{{creditCard}}",hp.Utils.plugins.CreditCard.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardName,hp.Utils.defaults.defaultDateCharacters))),e.indexOf(1)>=0&&(r='<div class="hp-content hp-content-bank">{{bankAccount}}</div>'.replace("{{bankAccount}}",hp.Utils.plugins.BankAccount.createTemplate(hp.Utils.defaults.defaultName,hp.Utils.defaults.defaultAccountNumberCharacters,hp.Utils.defaults.defaultRoutingNumberCharacters))),e.indexOf(2)>=0&&(a='<div class="hp-content hp-content-code">{{code}}</div>'.replace("{{code}}",hp.Utils.plugins.Code.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardNameSwipe,hp.Utils.defaults.defaultDateCharacters))),e.indexOf(3)>=0&&(i='<div class="hp-content hp-content-transvault">{{transvault}}</div>'.replace("{{transvault}}",hp.Utils.plugins.Transvault.createTemplate())),e.indexOf(4)>=0&&(o='<div class="hp-content hp-content-gc">{{giftcard}}</div>'.replace("{{giftcard}}",hp.Utils.plugins.GiftCard.createTemplate(hp.Utils.defaults.defaultCardCharacters,hp.Utils.defaults.defaultNameOnCardName,+(new Date).getFullYear().toString().substring(2,4)+3)));for(var s=0;s<e.length;s++)0===e[s]&&(t+=n),1===e[s]&&(t+=r),2===e[s]&&(t+=a),3===e[s]&&(t+=i),4===e[s]&&(t+=o);return t},w=function(e,t){var n=k();e.length<=36&&!t&&(n.sessionToken=e),t&&(n.apiKey=e),hp.Utils.defaults.session=n},k=function(){var e={};return e.sessionToken="",e.apiKey="",e.sessionToken=hp.Utils.defaults.session&&hp.Utils.defaults.session.sessionToken?hp.Utils.defaults.session.sessionToken:"",e.apiKey=hp.Utils.defaults.session&&hp.Utils.defaults.session.apiKey?hp.Utils.defaults.session.apiKey:"",e},A=function(){return{status:"Success",amount:_(),message:"Transaction processed",token:k().sessionToken,transaction_id:"",transaction_approval_code:"",transaction_avs_street_passed:!1,transaction_avs_postal_code_passed:!1,transaction_currency:"USD$",transaction_status_indicator:"",transaction_type:hp.Utils.defaults.paymentType,transaction_tax:0,transaction_surcharge:0,transaction_gratuity:0,transaction_cashback:0,transaction_total:_(),correlation_id:z(),instrument_id:"",instrument_type:"",instrument_method:"Other",instrument_last_four:"",instrument_routing_last_four:"",instrument_expiration_date:"",instrument_verification_method:"",instrument_entry_type:hp.Utils.defaults.entryType,instrument_entry_type_description:"KEY_ENTRY",instrument_verification_results:"",created_on:(new Date).toISOString(),customer_name:"",customer_signature:"https://images.pmoney.com/00000000",anti_forgery_token:hp.Utils.defaults.antiForgeryToken,application_identifier:"Hosted Payments",application_response_code:"",application_issuer_data:""}},I=function(t){var n=jQuery.Deferred(),a=function(e){var t=!1;return"undefined"!=typeof e.properties&&"undefined"!=typeof e.properties.accountNumber&&(t=!0),t},i=function(e){return!a(e)&&("undefined"!=typeof e.type&&("emoney"===e.type.toLowerCase()||"creditcard"===e.type.toLowerCase()||"ach"===e.type.toLowerCase()))},o=function(e){return!a(e)&&(!i(e)&&("undefined"!=typeof e.properties&&"undefined"!=typeof e.properties.cardNumber))},s=function(e){return!a(e)&&(!i(e)&&(!o(e)&&("undefined"!=typeof e.properties&&("undefined"!=typeof e.properties.trackOne||"undefined"!=typeof e.properties.trackTwo||"undefined"!=typeof e.properties.trackThree))))};if("function"!=typeof t.splice){var l=[];return l.push(t),I(l)}for(var c=[],p=0===hp.Utils.getAmount(),u=0;u<t.length;u++){var d=t[u],h=((new Date).toISOString(),d.request),f="Transaction processed.",m=(k(),""),g="",v="",y="",b="",S=!!d.isException,C="Success",T=h.__request,_=T?T.__swipe:r,U=a(T),E=i(T),w=o(T),D=s(T),R="undefined"!=typeof _;if(U&&(f="Transaction pending.",m=T.properties.accountNumber.substr(T.properties.accountNumber.length-4)+"",g=T.properties.routingNumber.substr(T.properties.routingNumber.length-4)+"",v=T.name,y="ACH"),E){var N=T.type.toLowerCase();"ach"===N?(v=T.bankName,m=T.accountNumber.replace(/\*/gi,"")):"creditcard"===N?(v=T.nameOnCard,m=T.cardNumber.substr(T.cardNumber.length-4)+"",b=T.properties.expirationDate):(v=T.email,m=T.cardNumber.substr(T.cardNumber.length-4)+""),y="EMONEY"}w&&(m=T.properties.cardNumber.substr(T.properties.cardNumber.length-4)+"",v=T.properties.nameOnCard,y=e.payment.cardType(T.properties.cardNumber).toUpperCase(),b=T.properties.expirationDate),S&&(C="Error"),R&&(m=_.cardNumber.substr(_.cardNumber.length-4),v=_.nameOnCard,y=e.payment.cardType(_.cardNumber).toUpperCase(),b=_.expMonth+"/"+_.expYear),p?f="Payment instrumented created.":hp.Utils.defaults.PaymentType===hp.PaymentType.REFUND&&(f="Transaction refunded.");var x=A();x.status=C,x.amount=h.amount,x.message=S?d.description:f,x.transaction_id=d.transactionId,x.transaction_total=h.amount,x.instrument_id=h.instrumentId,x.instrument_type=y,x.instrument_last_four=m,x.instrument_routing_last_four=g,x.instrument_expiration_date=b,x.instrument_entry_type_description=D?"MAGNETIC_SWIPE":"KEY_ENTRY",x.customer_name=v,c.push(x)}if(p)n.resolve(c);else{var P=c.length||0,F=0;e.each(c,function(e){var t={status:{statusRequest:{token:hp.Utils.getSession().sessionToken,transactionId:c[e].transaction_id}}};hp.Utils.makeRequest(t).then(function(e){if("Transaction"===e.type&&"undefined"!=typeof e.properties){var t="BankAccount"===e.properties.accountType;c[F].transaction_approval_code=t?"":e.properties.approvalCode,c[F].transaction_avs_postal_code_passed=!!t||e.properties.postalCodeCheck,c[F].transaction_avs_street_passed=!!t||e.properties.addressLine1Check,c[F].customer_signature=null===e.properties.signatureRef||e.properties.signatureRef===r||""===e.properties.signatureRef?"https://images.pmoney.com/00000000":e.properties.signatureRef,c[F].message=(c[F].message+" "+(e.properties.message+".")).toLowerCase().replace(" .",""),c[F].instrument_verification_results=!t,c[F].instrument_verification_method=t?"":"SIGNATURE",c[F].instrument_method="undefined"!=typeof e.properties.accountType?e.properties.accountType:"CreditCard"}F+=1,F===P&&n.resolve(c)})})}return n},D=function(e){var t=jQuery.Deferred(),n=A(),a={status:{statusRequest:{token:k().sessionToken,transactionId:e}}};return hp.Utils.makeRequest(a).then(function(a){if("Transaction"===a.type&&"undefined"!=typeof a.properties){var i="BankAccount"===a.properties.accountType;n.transaction_approval_code=i?"":a.properties.approvalCode,n.transaction_avs_postal_code_passed=!!i||a.properties.postalCodeCheck,n.transaction_avs_street_passed=!!i||a.properties.addressLine1Check,n.customer_signature=null===a.properties.signatureRef||a.properties.signatureRef===r||""===a.properties.signatureRef?"https://images.pmoney.com/00000000":a.properties.signatureRef,n.message=(n.message+" "+(a.properties.message+".")).toLowerCase().replace(" .",""),n.instrument_verification_results=!i,
n.instrument_verification_method=i?"":"SIGNATURE",n.instrument_method="undefined"!=typeof a.properties.accountType?a.properties.accountType:"CreditCard",n.customer_name=a.properties.nameOnAccount,n.instrument_id=a.properties.instrumentId,n.instrument_last_four=a.properties.accountNumber,n.instrument_type=a.properties.cardType,n.transaction_id=e,n.transaction_avs_postal_code_passed=a.properties.postalCodeCheck,n.transaction_avs_street_passed=a.properties.addressLine1Check}t.resolve(n)},t.reject),t},R={};R.SIGN_IN="signIn",R.SIGN_IN_REQUEST="signInRequest",R.SIGN_IN_RESPONSE="signInResponse",R.CHARGE="charge",R.CHARGE_REQUEST="chargeRequest",R.CHARGE_RESPONSE="chargeResponse",R.REFUND="refund",R.REFUND_REQUEST="refundRequest",R.REFUND_RESPONSE="refundResponse",R.TRANSVAULT="transvault",R.TRANSVAULT_REQUEST="transvaultRequest",R.TRANSVAULT_RESPONSE="transvaultResponse",R.CREATE_PAYMENT_INSTRUMENT="createPaymentInstrument",R.CREATE_PAYMENT_INSTRUMENT_REQUEST="createPaymentInstrumentRequest",R.CREATE_PAYMENT_INSTRUMENT_RESPONSE="createPaymentInstrumentResponse",R.WALLET="wallet",R.WALLET_REQUEST="walletRequest",R.WALLET_RESPONSE="walletResponse",R.STATUS="status",R.STATUS_REQUEST="statusRequest",R.STATUS_RESPONSE="statusResponse";var N=function(e){var t="",n="",r="",a={},i=!1;if(R.SIGN_IN in e&&(t=R.SIGN_IN,n=R.SIGN_IN_REQUEST,r=R.SIGN_IN_RESPONSE),R.CHARGE in e&&(t=R.CHARGE,n=R.CHARGE_REQUEST,r=R.CHARGE_RESPONSE),R.REFUND in e&&(t=R.REFUND,n=R.REFUND_REQUEST,r=R.REFUND_RESPONSE),R.TRANSVAULT in e&&(t=R.TRANSVAULT,n=R.TRANSVAULT_REQUEST,r=R.TRANSVAULT_RESPONSE),R.CREATE_PAYMENT_INSTRUMENT in e&&(t=R.CREATE_PAYMENT_INSTRUMENT,n=R.CREATE_PAYMENT_INSTRUMENT_REQUEST,r=R.CREATE_PAYMENT_INSTRUMENT_RESPONSE),R.WALLET in e&&(t=R.WALLET,n=R.WALLET_REQUEST,r=R.WALLET_RESPONSE),R.STATUS in e&&(t=R.STATUS,n=R.STATUS_REQUEST,r=R.STATUS_RESPONSE),R.CHARGE_RESPONSE in e&&(t=R.CHARGE_RESPONSE,i=!0),R.REFUND_RESPONSE in e&&(t=R.REFUND_RESPONSE,i=!0),R.TRANSVAULT_RESPONSE in e&&(t=R.TRANSVAULT_RESPONSE,i=!0),R.SIGN_IN_RESPONSE in e&&(t=R.SIGN_IN_RESPONSE,i=!0),R.CREATE_PAYMENT_INSTRUMENT_RESPONSE in e&&(t=R.CREATE_PAYMENT_INSTRUMENT_RESPONSE,i=!0),R.WALLET_RESPONSE in e&&(t=R.WALLET_RESPONSE,i=!0),R.STATUS_RESPONSE in e&&(t=R.STATUS_RESPONSE,i=!0),""===t)throw new Error("hosted-payments.utils.js - Could not parse data from response/request object.");if(i)a=e[t];else if("undefined"!=typeof e[t][r])a=e[t][r];else{if("undefined"==typeof e[t][n])throw new Error("hosted-payments.utils.js - Could not parse data from response/request object.");a=e[t][n]}return a},x=function(t){var n=jQuery.Deferred();return hp.Utils.defaults.promptForAvs?("undefined"==typeof t&&(t=e(".hp-form")),t.find(".hp-avs-prompt").length&&t.find(".hp-avs-prompt").remove(),setTimeout(function(){var r=['<div class="hp-avs-prompt">','<div class="hp-avs-prompt-container">',"<p>Billing Address</p>",'<div class="hp-avs-prompt-left">','<label class="hp-label-avs" for="avsStreet">Address <span class="hp-avs-required">*</span></label>','<div class="hp-input hp-input-avs hp-input-avs-street">','<input placeholder="Street Address" value="'+hp.Utils.defaults.billingAddress.addressLine1+'" name="avsStreet" id="avsStreet" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>",'<div class="hp-avs-prompt-right">','<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">City</label>','<div class="hp-input hp-input-avs hp-input-avs-city">','<input placeholder="City" autocomplete="on" type="text">',"</div>","</div>",'<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">State</label>','<div class="hp-input hp-input-avs hp-input-avs-state">','<input placeholder="State" autocomplete="on" type="text">',"</div>","</div>",'<div class="hp-pull-left">','<label class="hp-label-avs" for="avsZip">Zip <span class="hp-avs-required">*</span></label>','<div class="hp-input hp-input-avs hp-input-avs-zip">','<input placeholder="Zipcode" value="'+hp.Utils.defaults.billingAddress.postalCode+'" name="avsZip" id="avsZip" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>","</div>",'<br class="hp-break" />',"<hr>",'<button class="hp-submit hp-avs-submit">Submit Payment</button>',hp.Utils.defaults.allowAvsSkip?'<a class="hp-avs-skip" href="javascript:;">Skip \'Address Verification\'</a>':"","</div>","</div>"].join("");t.prepend(r);var a=t.find(".hp-avs-prompt"),i="",o="",s=function(e){e.preventDefault(),hp.Utils.updateAvsInfo(o,i),t.removeClass("hp-avs-active"),a.removeClass("active"),n.resolve(),setTimeout(function(){t.find(".hp-avs-prompt").remove()},0)};a.find(".hp-input-avs input").on("focus blur keyup",function(t){t.preventDefault(),"avsStreet"===e(this).attr("name")&&(o=e(this).val()),"avsZip"===e(this).attr("name")&&(i=e(this).val());var n=t.keyCode?t.keyCode:t.which;13===n&&s(t)}),a.find(".hp-avs-submit").on("click",s),hp.Utils.defaults.allowAvsSkip&&a.find(".hp-avs-skip").on("click",function(e){e.preventDefault(),t.removeClass("hp-avs-active"),a.removeClass("active"),n.resolve(),setTimeout(function(){t.find(".hp-avs-prompt").remove()},0),hp.Utils.defaults.eventCallback(e)}),t.addClass("hp-avs-active"),a.addClass("active")},0),t.find(".hp-input-avs-street input").focus(),n):(n.resolve(),n)},P=function(t,n){var r=jQuery.Deferred(),a={url:hp.Utils.defaults.baseUrl+encodeURI("?dt="+(new Date).getTime()),type:"POST",dataType:"json",contentType:"application/json",crossDomain:!0,data:JSON.stringify(t)};return n&&(a.async=!1),e.ajax(a).done(function(e){var n=N(t);if(e.error)return e.error.request=n,void r.resolve(e.error);var a=N(e);a.request=n,r.resolve(a)}).fail(r.reject)["catch"](r.reject),r},F=function(t){hp.Utils.log("Checking options to reset with...",t),"undefined"==typeof t&&(t={}),null===t&&(t={}),hp.Utils.log("Getting instance element...",hp.Utils.__instance.element);var n=e(hp.Utils.__instance.element);hp.Utils.log("Emptying the container element..."),n.empty(),hp.Utils.__instance.element=n.get(),hp.Utils.log("Handle special option types..."),"undefined"!=typeof t.entryType&&(t.entryType=hp.Utils.setEntryType(t.entryType)),"undefined"!=typeof t.paymentType&&(t.paymentType=hp.Utils.setPaymentType(t.paymentType)),"undefined"!=typeof t.paymentService&&(t.paymentService=hp.Utils.setPaymentService(t.paymentService)),"undefined"!=typeof t.amount&&(t.amount=hp.Utils.setAmount(t.amount)),hp.Utils.log("Merging plugin defaults with newly provided options..."),hp.Utils.defaults=jQuery.extend({},hp.Utils.defaults,t),n.data(t),setTimeout(function(){hp.Utils.log("Reinitialized plugin with new options!"),hp.Utils.__instance.init(),hp.Utils.__instance=hp.Utils.__instance})},O=function(){var e=jQuery.Deferred(),t=(new Date).toISOString(),n=k().sessionToken,r=k().apiKey,i=1800,s="undefined"==typeof hp.Utils.defaults.bypassSessionStorage||hp.Utils.defaults.bypassSessionStorage;if(hp.Utils.defaults.paymentService===hp.PaymentService.TEST)return hp.Utils.log("Sign In: Bypassed."),hp.Utils.setSession(r),e.resolve(r),e;if(!s&&null!==sessionStorage.getItem("hp.sessionToken")&&null!==sessionStorage.getItem("hp.sessionTokenTS")){var l=new Date(sessionStorage.getItem("hp.sessionTokenTS")),c=new Date(t),p=Math.floor((c.getTime()-l.getTime())/1e3);if(p<i){var u=sessionStorage.getItem("hp.sessionToken"),d=o.decode(u),h=d.split("|")[0],f=d.split("|")[1],m=d.split("|")[2];if(f===location.href&&m===hp.Utils.defaults.baseUrl)return hp.Utils.log("Sign In: Total time span "+p+"."),hp.Utils.log("Sign In: Retrieved from sessionStorage.",h),hp.Utils.setSession(h),e.resolve(h),e}else hp.Utils.log("Sign In: Session expired. Generating new session."),sessionStorage.clear()}return a().then(function(){hp.Utils.makeRequest({signIn:{signInRequest:{apiKey:r}}}).then(function(n){hp.Utils.setSession(n.token),e.resolve(n),s||(sessionStorage.setItem("hp.sessionToken",o.encode(n.token+"|"+location.href+"|"+hp.Utils.defaults.baseUrl)),sessionStorage.setItem("hp.sessionTokenTS",t)),hp.Utils.log("Sign In: Retrieved from server.")},function(r){if("undefined"==typeof r||null===r||""===r)return void hp.Utils.reset();var a={status:"Error",message:"We're sorry. Payments cannot accepted at this time. Please try again later.",created_on:t,token:n};hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(a).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(a.message),hp.Utils.defaults.errorCallback(a)),e.reject()})}),e},$=function(e){var t=e.toFixed(2).split(".");return t[0]=t[0].split("").reverse().join("").replace(/(\d{3})(?=\d)/g,"$1,").split("").reverse().join(""),"$"+t.join(".")},j=!1,M=function(){j||"localhost"!==location.hostname&&""!==location.hostname||(j=!0),hp.Utils.defaults.allowHttpsSkip||"https:"===location.protocol||j||hp.Utils.showError("This connection is untrusted. Make sure you're visting this website using 'HTTPS'!",!1)},L=function(t,n){var r=0,a={url:hp.Utils.defaults.baseUrl+encodeURI("?dt="+(new Date).getTime()),type:"POST",dataType:"json",contentType:"application/json",crossDomain:!0,data:JSON.stringify({balance:{balanceRequest:{token:t,cardNumber:n}}}),async:!1};return e.ajax(a).done(function(e){e.balanceResponse&&(r=e.balanceResponse.balance)}).fail(function(){r=0}),r},q=function(e){return/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))$/i.test(e)},H=function(e,t){var n=[];return"undefined"!=typeof e.email&&""!==e.email||n.push({type:"email",message:"Please provide an email address."}),"undefined"==typeof e.email||q(e.email)||n.push({type:"email",message:"The email provided did not validate."}),"undefined"!=typeof e.password&&""!==e.password||n.push({type:"password",message:"Please provide a password."}),"undefined"!=typeof e.password&&e.password.length<=6&&n.push({type:"password",message:"Please provide a valid password."}),n.length?t(n,e):t(null,e)},V=function(e,t){var n=[];return"undefined"!=typeof e.accountNumber&&""!==e.accountNumber||n.push({type:"accountNumber",message:"Account number on card cannot be empty."}),"undefined"!=typeof e.accountNumber&&e.accountNumber.length<=8&&n.push({type:"accountNumber",message:"The account number must be atleast 8 characters."}),"undefined"!=typeof e.routingNumber&&""!==e.routingNumber||n.push({type:"routingNumber",message:"Routing number be empty."}),"undefined"!=typeof e.routingNumber&&9!==e.routingNumber.length&&n.push({type:"routingNumber",message:"Routing number must be 9 characters."}),"undefined"!=typeof e.name&&""!==e.name||n.push({type:"name",message:"Name cannot be empty."}),"undefined"!=typeof e.name&&e.name.length<=1&&n.push({type:"name",message:"Name must be greater than one character."}),n.length?t(n,e):t(null,e)},G=function(){var e=hp.Utils.defaults;return"function"!=typeof e.errorCallback&&"undefined"!=typeof e.errorCallback},Q=function(){var e=hp.Utils.defaults;return"function"!=typeof e.successCallback&&"undefined"!=typeof e.successCallback},B=function(t,n){var r=[];return e.payment.validateCardNumber(t.cardNumber)||r.push({type:"cc",message:"Card number is invalid."}),e.payment.validateCardExpiry(t._expiryMonth,t._expiryYear)||r.push({type:"date",message:"Expiration date is invalid."}),e.payment.validateCardCVC(t.cvv,t.cardType)||r.push({type:"cvv",message:"CVV is not valid for this card type."}),"undefined"!=typeof t.name&&""!==t.name||r.push({type:"name",message:"Name on card cannot be empty."}),"undefined"!=typeof t.name&&t.name.length<=1&&r.push({type:"name",message:"Name on card must be greater than one character."}),r.length?n(r,t):n(null,t)},W=function(){var t="";return""===hp.Utils.defaults.antiForgeryToken||""===hp.Utils.defaults.antiForgeryName?null:(t=hp.Utils.defaults.antiForgeryToken.startsWith(".")||hp.Utils.defaults.antiForgeryToken.startsWith("#")||hp.Utils.defaults.antiForgeryToken.includes("[")?e(hp.Utils.defaults.antiForgeryToken).eq(0).val()||e(hp.Utils.defaults.antiForgeryToken).eq(0).text():hp.Utils.defaults.antiForgeryToken,"undefined"==typeof t||""===t?null:e("<input />",{type:"hidden",name:hp.Utils.defaults.antiForgeryName,value:t}))},Y=function(t){var r=jQuery.Deferred(),a=W();return setTimeout(function(){var i="FRM"+(new Date).getTime().toString(),o=e("<form />",{method:"POST",id:i});if(!e.isEmptyObject(t)){if("function"==typeof t.push)for(var s=t.length-1;s>=0;s--){var l=t[s];for(var c in l)o.append(e("<input />",{type:"hidden",name:c+"["+s+"]",value:l[c]}))}else for(var p in t)o.append(e("<input />",{type:"hidden",name:p,value:t[p]}));return a&&o.append(a),e(n.body).prepend(o),r.resolve(e("#"+i))}return r.reject()},0),r},K=function(){return hp.Utils.defaults.terminalId||""},z=function(){return hp.Utils.defaults.correlationId.length?hp.Utils.defaults.correlationId:f()},J=function(e){var t="hp-form-mobile",n="hp-form-tablet",r="hp-form-desktop",a=e.outerWidth(!0,!0),i=e.find(".hp");i.removeClass(t).removeClass(n).removeClass(r),setTimeout(function(){return a>=615?void i.addClass(r):a>=420?void i.addClass(n):a>=320?void i.addClass(t):void 0},0)},X=function(e){var t={status:"Error",message:"Your session is no longer valid. Please refresh your page and try again.",created_on:(new Date).toISOString(),token:k().sessionToken};if("undefined"==typeof e)return void(hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t)));var n="";n="undefined"!=typeof e.message?e.message:"undefined"!=typeof e.description?e.description:"undefined"!=typeof e.error&&"undefined"!=typeof e.error.description?e.error.description:e,t.message=n,hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t))},Z=function(e){var t={status:"Error",message:"Your session is no longer valid. Please refresh your page and try again.",created_on:(new Date).toISOString(),token:k().sessionToken};if("undefined"==typeof e)return void(hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(t).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):(hp.Utils.showError(t.message),hp.Utils.defaults.errorCallback(t)));var n=e.length>1?e:e[0];hp.Utils.shouldSuccessPostBack()?hp.Utils.buildFormFromObject(n).then(function(e){e.attr("action",hp.Utils.defaults.successCallback).submit()}):hp.Utils.defaults.successCallback(n)},ee=function(t){var n=jQuery.Deferred();return hp.Utils.createInstance(t,function(r){var a=t;a.find(".hp-submit"),a.find(".hp-input"),e.noop();if(hp.Utils.checkHttpsConnection(),r.init(),r.attachEvents(),r.isTransvault()&&a.off().on("hp.notify",hp.Utils.defaults.eventCallback).on("hp.transvaultSuccess",function(e,t){var n=t;r.showSuccess(),hp.Utils.hideLoader(),hp.Utils.shouldSuccessPostBack()?hp.Utils.buildFormFromObject(n).then(function(e){e.attr("action",hp.Utils.defaults.successCallback).submit()}):hp.Utils.defaults.successCallback(n)}),r.isCode()||r.isBankAccount()||r.isCreditCard()||r.isGiftCard()){if("undefined"!=typeof hp.Utils.plugins.Transvault)try{var i=hp.Utils.plugins.Transvault;i.wasCancelled=!0,i.detachEvents(),"undefined"!=typeof i.transvaultHub&&"undefined"!=typeof i.transvaultHub.connection&&i.transvaultHub.connection.stop()}catch(o){hp.Utils.log(o)}a.off().on("hp.notify",hp.Utils.defaults.eventCallback).on("hp.submit",function(e,t){t.type===r.requestTypes.charge&&(r.handleSuccess(t.res),hp.Utils.hideLoader()),t.type===r.requestTypes.error&&(r.handleError(t.res),hp.Utils.hideLoader()),r.clearInputs()})}n.resolve()}),n},te=function(){return hp.Utils.defaults.appUrlScheme+""},ne=function(){setTimeout(function(){location.href=te(),setTimeout(function(){location.href="https://itunes.apple.com/us/app/myapp/id563976053?ls=1&mt=8"},500)},0)};hp.Utils.handleLegacyCssClassApplication=s,hp.Utils.makeRequest=P,hp.Utils.validateCreditCardData=B,hp.Utils.validateBankAccountData=V,hp.Utils.validateEMoneyData=H,hp.Utils.buildFormFromObject=Y,hp.Utils.buildAntiForgeryInput=W,hp.Utils.createInstance=S,hp.Utils.showSuccessPage=C,hp.Utils.getAmount=_,hp.Utils.setAmount=T,hp.Utils.getSession=k,hp.Utils.setSession=w,hp.Utils.getBalance=L,hp.Utils.formatCurrency=$,hp.Utils.buildResultObjectByType=I,hp.Utils.generateGuild=f,hp.Utils.createOrder=E,hp.Utils.createNav=U,hp.Utils.getCorrelationId=z,hp.Utils.setContainerClass=J,hp.Utils.shouldSuccessPostBack=Q,hp.Utils.shouldErrorPostBack=G,hp.Utils.getTerminalId=K,hp.Utils.showLoader=g,hp.Utils.hideLoader=v,hp.Utils.showError=y,hp.Utils.hideError=b,hp.Utils.setPaymentInstrument=h,hp.Utils.log=u,hp.Utils.getVersion=d,hp.Utils.setEntryType=c,hp.Utils.setPaymentType=p,hp.Utils.updateAvsInfo=m,hp.Utils.promptAvs=x,hp.Utils.checkHttpsConnection=M,hp.Utils.handleError=X,hp.Utils.handleSuccess=Z,hp.Utils.signIn=O,hp.Utils.setupPluginInstances=ee,hp.Utils.reset=F,hp.Utils.setPaymentService=l,hp.Utils.retrieveTransactionStatus=D,hp.Utils.getAppSchemeUrl=te,hp.Utils.goToAppSchemeUrl=ne}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.formData={_isValid:!1}}t.hp=hp||{},a.prototype.init=function(){var e=hp.Utils.handleLegacyCssClassApplication("success",this.$element),t=e.parent,n=e.content;t.find(".icon.success").addClass("animate").show(),this.context=e,this.$parent=t,this.$content=n},a.prototype.createTemplate=function(){var e=['<div class="hp-success-visual"></div>','<h2 class="hp-success-label">{{successLabel}}</h2>','<p class="text-muted">{{redirectLabel}}</p>'].join("");return e},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!0},a.prototype.isCode=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.Success=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$loader=null,this.$element=e,this.formData={_isValid:!1},this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9,this.instrumentId="",this.transactionId=""}t.hp=hp||{};var i=null,o=null,s=null,l=null,c=null,p=null,u=null,d=null,h=null,f=null,m=null,g=null,v=null,y="";(new Date).toISOString();a.prototype.init=function(){y=hp.Utils.getSession().sessionToken;var t=hp.Utils.handleLegacyCssClassApplication("cc",this.$element),n=t.parent,r=t.content;n.removeClass("hp-back").trigger("hp.notify"),this.context=t,this.$parent=n,this.$content=r,this.$loader=n.find(".hp-img-loading").eq(0),this.wasOnceEMoney=!1,i=this.$content.find(".hp-input-cc input"),o=this.$content.find(".hp-input-cvv input"),s=this.$content.find(".hp-input-month select"),l=this.$content.find(".hp-input-year select"),c=this.$content.find(".hp-input-name input"),p=this.$content.find(".hp-submit"),u=this.$content.find(".hp-card-visual-number"),d=this.$content.find(".hp-card-visual-expiry-month"),h=this.$content.find(".hp-card-visual-expiry-year"),f=this.$content.find(".hp-card-visual-name"),m=this.$content.find(".hp-card-visual"),m=this.$content.find(".hp-card-visual"),g=this.$content.find(".hp-input"),v=e([s,l]),v.fancySelect({includeBlank:!0}),this.transactionId=hp.Utils.defaults.transactionId},a.prototype.clearInputs=function(){this.formData={_isValid:!1},u.html(hp.Utils.defaults.defaultCardCharacters),d.html(hp.Utils.defaults.defaultDateCharacters),h.html(hp.Utils.defaults.defaultDateCharacters),f.text(hp.Utils.defaults.defaultNameOnCardName),m.parent().removeClass().addClass("hp-content hp-content-cc hp-content-active"),c.removeAttr("disabled").val(""),s.removeAttr("disabled"),l.removeAttr("disabled"),o.removeAttr("disabled").val(""),i.removeAttr("disabled").val(""),p.removeAttr("disabled"),p.text("Submit Payment")},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(0)<0)return"";if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof n)throw new Error("hosted-payments.credit-card.js : Cannot create template. Arguments are null or undefined.");var r=function(e){for(var t=(new Date).getFullYear(),n=(new Date).getFullYear()+10,r="",a=t;a<=n;a++)r+=a===t?'<option selected="selected">':"<option>",r+=a.toString(),r+="</option>";return r},a=function(e){for(var t=1,n="",r=t;r<=12;r++)n+=r===(new Date).getMonth()+1?'<option selected="selected">':"<option>",n+=r<10?"0"+r.toString():r.toString(),n+="</option>";return n},i=function(e){return e.replace("{{monthList}}",a()).replace("{{yearList}}",r())},o=['<div class="hp-card-visual">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">'+n+'</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input hp-input-cc">','<input placeholder="Enter Card Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<div class="hp-input hp-input-name">','<input placeholder="Enter Full Name" value="'+hp.Utils.defaults.customerName+'" autocomplete="on" type="text">',"</div>",'<br class="hp-break" />','<div class="hp-input-container hp-input-container-date">','<div class="hp-input hp-input-month">','<select autocomplete="on">',"{{monthList}}","</select>","</div>",'<div class="hp-input hp-input-year">','<select autocomplete="on">',"{{yearList}}","</select>","</div>","</div>",'<div class="hp-input hp-input-third hp-input-cvv">','<input placeholder="Enter CVV" autocomplete="off" type="text" pattern="\\d*">','<span class="hp-input-cvv-image"></span>',"</div>",'<br class="hp-break" />','<button class="hp-submit">'+(hp.Utils.defaults.promptForAvs?"Verify Billing Address &#10144;":"Submit Payment")+"</button>","</div>"].join("");return i(o)},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.detachEvents=function(){i.off().val(""),o.off().val(""),c.off().val(hp.Utils.defaults.customerName),p.off(),s.off("focus"),l.off("focus"),v.trigger("disable.fs"),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleCreditCardInput=function(t){if(""===t)return void u.html(hp.Utils.defaults.defaultCardCharacters);var n=e.payment.cardType(t);if((null===n||"emoney"!==n)&&this.wasOnceEMoney){var r=new Date;c.val("").trigger("keyup").removeAttr("readonly"),s.removeAttr("readonly").val(r.getMonth()<=9?"0"+r.getMonth():r.getMonth()).trigger("change"),l.removeAttr("readonly").val(r.getFullYear()).trigger("change"),v.trigger("enable.fs"),o.val("").trigger("keyup").removeAttr("readonly")}"emoney"===n&&(c.val("EMoney Card").trigger("keyup").attr("readonly","readonly"),s.val("12").trigger("change").attr("readonly","readonly"),l.val("2025").trigger("change").attr("readonly","readonly"),o.val("999").trigger("keyup").attr("readonly","readonly"),v.trigger("disable.fs"),this.wasOnceEMoney=!0),this.formData.cardNumber=t.replace(/\s/gi,""),this.formData.cardType=n,u.text(t)},a.prototype.handleMonthInput=function(t){return""===t?void d.html(hp.Utils.defaults.defaultDateCharacters):(this.formData._expiryMonth=e.trim(t),d.text(t),void setTimeout(function(){s.next().text(t)},0))},a.prototype.handleYearInput=function(t){return""===t?void h.html(hp.Utils.defaults.defaultDateCharacters):(this.formData._expiryYear=e.trim(t),h.text(t.substring(2)),void setTimeout(function(){l.next().text(t)},0))},a.prototype.handleNameInput=function(t){return""===t?void f.text(hp.Utils.defaults.defaultNameOnCardName):(this.formData.name=e.trim(t),void f.text(t))},a.prototype.handleCVVInput=function(t){this.formData.cvv=e.trim(t)},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{token:hp.Utils.getSession().sessionToken,transactionId:this.transactionId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,instrumentId:this.instrumentId,correlationId:hp.Utils.getCorrelationId(),__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{token:hp.Utils.getSession().sessionToken,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,instrumentId:this.instrumentId,correlationId:hp.Utils.getCorrelationId(),__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(){var e=this;return e.formData._isValid?(p.attr("disabled","disabled").text("Submitting..."),void hp.Utils.promptAvs().then(function(){return hp.Utils.showLoader(),hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),transactionId:e.transactionId,token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{cardNumber:e.formData.cardNumber,expirationDate:e.formData._expiryMonth+"/"+e.formData._expiryYear,cvv:e.formData.cvv,nameOnCard:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}})}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId="undefined"!=typeof t.transactionId?t.transactionId:e.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})})):(m.addClass("hp-card-invalid"),void setTimeout(function(){m.removeClass("hp-card-invalid")},2e3))},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.attachEvents=function(){this.detachEvents();var t=this;v.trigger("enable.fs"),hp.Utils.setContainerClass(t.$element),i.payment("formatCardNumber").on("keyup",function(){var n=e(this).val(),r=e.payment.cardType(n);t.$parent.removeClass("hp-back"),r&&t.$content.removeClass().addClass("hp-content hp-content-cc hp-content-active").addClass("hp-content-card-"+r),t.handleCreditCardInput(n),t.$parent.trigger("hp.cc",n),t.$parent.trigger("hp.notify"),t.handleNotify()}),o.payment("formatCardCVC").on("focus",function(){t.$parent.addClass("hp-back"),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("keyup",function(n){var r=e(this).val();t.handleCVVInput(r),t.$parent.trigger("hp.cvv",r),t.$parent.trigger("hp.notify"),t.handleNotify()}),c.on("focus",function(){t.$parent.trigger("hp.notify"),t.handleNotify(),t.$parent.removeClass("hp-back")}).on("keyup",function(n){var r=e(this).val();t.handleNameInput(r),t.$parent.trigger("hp.name",r),t.$parent.trigger("hp.notify"),t.handleNotify()}),""!==hp.Utils.defaults.customerName&&c.trigger("keyup"),s.on("focus",function(t){e(".hp-input-active").removeClass("hp-input-active"),e(this).parents(".hp-input").addClass("hp-input-active")}).on("change.fs",function(n){var r=e(this).val();t.handleMonthInput(r),t.$parent.removeClass("hp-back"),t.$parent.trigger("hp.expiryMonth",r),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("blur",function(t){e(".hp-input-active").removeClass("hp-input-active")}).trigger("change.fs"),l.on("focus",function(t){e(".hp-input-active").removeClass("hp-input-active"),e(this).parents(".hp-input").addClass("hp-input-active")}).on("change.fs",function(n){var r=e(this).val();t.handleYearInput(r),t.$parent.removeClass("hp-back"),t.$parent.trigger("hp.expiryYear",r),t.$parent.trigger("hp.notify"),t.handleNotify()}).on("blur",function(t){e(".hp-input-active").removeClass("hp-input-active")}).trigger("change.fs"),p.on("click",function(e){e.preventDefault(),t.handleSubmit(),t.$parent.trigger("hp.notify"),t.handleNotify()}),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleNotify=function(){"undefined"!=typeof this.formData._expiryYear&&"undefined"!=typeof this.formData._expiryMonth&&(this.formData.expirationDate=e.trim(this.formData._expiryMonth+this.formData._expiryYear.substring(2)));var t=this;hp.Utils.validateCreditCardData(this.formData,function(e,n){if(g.removeClass("hp-error"),!e)return void(t.formData._isValid=!0);for(var r in e)"cc"===e[r].type&&""!==i.val()&&i.parent().addClass("hp-error"),"cvv"===e[r].type&&""!==o.val()&&o.parent().addClass("hp-error"),"date"===e[r].type&&""!==l.val()&&""!==s.val()&&(l.parent().addClass("hp-error"),s.parent().addClass("hp-error")),"name"===e[r].type&&""!==c.val()&&c.parent().addClass("hp-error")})},a.prototype.isCreditCard=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.CreditCard=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$loader=null,this.$element=e,this.formData={_isValid:!1},this.currrentPage=0,this.transactionId=""}t.hp=hp||{};var i="";(new Date).toISOString();a.prototype.init=function(){i=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("gc",this.$element),t=e.parent,n=e.content;t.removeClass("hp-back").trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,this.totalPages=n.find(".hp-page").length,this.currrentPage=0,this.transactionId=hp.Utils.defaults.transactionId},a.prototype.clearInputs=function(){this.formData={_isValid:!1}},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(4)<0)return"";var r=['<div class="hp-page hp-page-0 hp-page-active">',"<h2>Swipe, scan, or manually<br /> enter a gift card.</h2><br />",'<div class="hp-card-visual">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">12</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input-group hp-clearfix">','<div class="hp-input hp-input-gc hp-pull-left">','<input placeholder="Enter Card Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<button class="hp-submit hp-pull-left">Submit</button>',"</div>","<hr />",'<button class="hp-submit hp-submit-success">Issue a new Gift Card</button>',"</div>","</div>",'<div class="hp-page hp-page-1">',"<h2>Page 1.</h2><br />","</div>",'<div class="hp-page hp-page-2">',"<h2>Page 2.</h2><br />","</div>",'<div class="hp-page hp-page-3">',"<h2>Page 3.</h2><br />","</div>",'<div class="hp-page hp-page-4">',"<h2>Page 4.</h2><br />","</div>",'<div class="hp-page hp-page-5">',"<h2>Page 5.</h2><br />","</div>","<br />"].join("");
return r},a.prototype.getCurrentPageElement=function(){return this.$content.find(".hp-page-active").eq(0)},a.prototype.goTo=function(e){"first"===e&&(e=0),"last"===e&&(e=this.totalPages-1);var t=+e;t<0&&(t=0),t>this.totalPages&&(t=this.totalPages),this.$content.find(".hp-page").removeClass("hp-page-active").filter(".hp-page-"+t).addClass("hp-page-active"),this.currrentPage=t,this.$parent.trigger("hp.notify",{type:"page",value:t})},a.prototype.next=function(){var e=this.currrentPage+1;this.goTo(e===this.totalPages?"first":e)},a.prototype.prev=function(){this.goTo(0===this.currrentPage?"last":this.currrentPage-1)},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.detachEvents=function(){this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleCharge=function(e){var t=this;hp.Utils.makeRequest({charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:this.transactionId,instrumentId:this.instrumentId,entryType:hp.Utils.defaults.entryType,amount:hp.Utils.getAmount(),__request:e.request}}}).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(){var e=this;e.formData._isValid&&($submit.attr("disabled","disabled").text("Submitting..."),hp.Utils.promptAvs().then(function(){return hp.Utils.showLoader(),hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{cardNumber:e.formData.cardNumber,expirationDate:e.formData._expiryMonth+"/"+e.formData._expiryYear,cvv:e.formData.cvv,nameOnCard:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}})}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId="undefined"!=typeof t.transactionId?t.transactionId:e.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})}))},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.addScanSwipeListener=function(t){var r=this;e(n).pos({onEventName:"hp.global_giftcard_start",offEventName:"hp.global_giftcard_end",onSwipeScan:function(e){r.handleSubmit(data)}})},a.prototype.attachEvents=function(){var e=this;e.$parent.on("hp.notify",function(t,n){if("undefined"!=typeof n&&"undefined"!=typeof n.type&&"page"===n.type){var r=n.value,a="handlePage"+r+"Events";"undefined"!=typeof e[a]&&e[a](e.getCurrentPageElement())}}),e.handlePage0Events(e.getCurrentPageElement()),e.handleNotify()},a.prototype.handlePage0Events=function(e){this.addScanSwipeListener(),e.find(".hp-input-gc input").payment("formatCardNumber"),e.find(".hp-input-gc .hp-submit").off().on("click",function(e){}),console.log("handlePage0Events",e)},a.prototype.handlePage1Events=function(e){console.log("handlePage1Events",e)},a.prototype.handlePage2Events=function(e){console.log("handlePage2Events",e)},a.prototype.handlePage3Events=function(e){console.log("handlePage3Events",e)},a.prototype.handlePage4Events=function(e){console.log("handlePage4Events",e)},a.prototype.handlePage5Events=function(e){console.log("handlePage5Events",e)},a.prototype.handleNotify=function(){var e=this;hp.Utils.validateCreditCardData(this.formData,function(t,n){if(!t)return void(e.formData._isValid=!0);for(var r in t);})},a.prototype.isCreditCard=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!0},hp.GiftCard=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.formData={_isValid:!1},this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9,this.transactionId=""}t.hp=hp||{};var i,o=null,s=null,l=null,c=null,p=null,u=null,d=null,h=null,f="";(new Date).toISOString();a.prototype.init=function(){f=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("bank",this.$element),t=e.parent,n=e.content;t.trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,o=this.$content.find(".hp-input-fullname input"),s=this.$content.find(".hp-input-account input"),l=this.$content.find(".hp-input-routing input"),c=this.$content.find(".hp-bank-visual-account"),p=this.$content.find(".hp-bank-visual"),u=this.$content.find(".hp-bank-visual-routing"),d=this.$content.find(".hp-bank-visual-name"),i=this.$content.find(".hp-submit"),h=this.$content.find(".hp-input"),this.transactionId=hp.Utils.defaults.transactionId},a.prototype.clearInputs=function(){this.formData={_isValid:!1},h.each(function(){e(this).find("input").val("")}),d.html(hp.Utils.defaults.defaultName),c.html(hp.Utils.defaults.defaultAccountNumberCharacters),u.html(hp.Utils.defaults.defaultRoutingNumberCharacters),p.parent().removeClass().addClass("hp-content hp-content-bank hp-content-active")},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(1)<0)return"";if("undefined"==typeof t||"undefined"==typeof n||"undefined"==typeof e)throw new Error("hosted-payments.bank-account.js : Cannot create template. Arguments are null or undefined.");var r=['<div class="hp-bank-visual">','<div class="hp-bank-visual-image"></div>','<div class="hp-bank-visual-logo"></div>','<div class="hp-bank-visual-name">'+e+"</div>",'<div class="hp-bank-visual-account">'+t+"</div>",'<div class="hp-bank-visual-routing">'+n+"</div>","</div>",'<div class="hp-input-wrapper">','<div class="hp-input hp-input-fullname">','<input placeholder="Enter Full Name" value="'+hp.Utils.defaults.customerName+'" autocomplete="on" type="text">',"</div>",'<div class="hp-break" >','<div class="hp-input hp-input-account">','<input placeholder="Account Number" autocomplete="on" type="text" pattern="\\d*">',"</div>",'<div class="hp-input hp-input-routing">','<input placeholder="Routing Number" autocomplete="on" type="text" pattern="\\d*">',"</div>","</div>",'<button class="hp-submit">Submit Payment</button>','<p class="info">* Please note that bank account (ACH) transactions may take up to 3 days to process. This time period varies depending on the your issuing bank. For more information please visit us at <a href="https://www.etsms.com/" target="_blank">https://etsms.com</a>.</p>',"</div>"].join("");return r},a.prototype.detachEvents=function(){this.$content.find(".hp-input-account input").off().val(""),this.$content.find(".hp-input-fullname input").off().val(hp.Utils.defaults.customerName),this.$content.find(".hp-input-routing input").off().val(""),this.$content.find(".hp-submit").off(),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleRoutingInput=function(t){return""===t?u.html(hp.Utils.defaults.defaultRoutingNumberCharacters):(this.formData.routingNumber=e.trim(t),void u.text(t))},a.prototype.handleAccountInput=function(t){return""===t?c.html(hp.Utils.defaults.defaultAccountNumberCharacters):(this.formData.accountNumber=e.trim(t),void c.text(t))},a.prototype.handleNameInput=function(t){return""===t?d.html(hp.Utils.defaults.defaultName):(this.formData.name=e.trim(t),void d.text(t))},a.prototype.attachEvents=function(){this.detachEvents();var t=this;t.$content.find(".hp-input-account input").payment("restrictNumeric").on("keyup, keydown, keypress, change, input",function(){var n=e(this),r=n.val().length;if(r>16){var a=n.val().substr(0,16);n.val(a)}var i=e(this).val();t.$parent.removeClass("hp-back"),t.$content.removeClass().addClass("hp-content hp-content-bank hp-content-active"),t.handleAccountInput(i),t.$parent.trigger("hp.account",i),t.$parent.trigger("hp.notify"),t.handleNotify()}),t.$content.find(".hp-input-fullname input").on("keyup, keydown, keypress, change, input",function(){var n=e(this).val();t.$parent.removeClass("hp-back"),t.handleNameInput(n),t.$parent.trigger("hp.name",n),t.$parent.trigger("hp.notify"),t.handleNotify()}),""!==hp.Utils.defaults.customerName&&setTimeout(function(){t.$content.find(".hp-input-fullname input").val(hp.Utils.defaults.customerName),t.$content.find(".hp-input-fullname input").trigger("keyup"),t.$parent.trigger("hp.name",hp.Utils.defaults.customerName),t.handleNameInput(hp.Utils.defaults.customerName),t.handleNotify()},0),t.$content.find(".hp-input-routing input").payment("restrictNumeric").on("keyup, keydown, keypress, change, input",function(n){var r=e(this),a=r.val().length;if(a>9){var i=r.val().substr(0,9);r.val(i)}var o=e(this).val();t.$parent.removeClass("hp-back"),t.handleRoutingInput(o),t.$parent.trigger("hp.routing",o),t.$parent.trigger("hp.notify"),t.handleNotify()}),t.$content.find(".hp-submit").on("click",function(e){e.preventDefault(),t.handleSubmit(),t.$parent.trigger("hp.notify"),t.handleNotify()}),this.$parent.trigger("hp.notify"),this.handleNotify()},a.prototype.handleNotify=function(){var e=this;hp.Utils.validateBankAccountData(this.formData,function(t,n){if(h.removeClass("hp-error"),!t)return void(e.formData._isValid=!0);for(var r in t)"accountNumber"===t[r].type&&""!==s.val()&&s.parent().addClass("hp-error"),"routingNumber"===t[r].type&&""!==l.val()&&l.parent().addClass("hp-error"),"name"===t[r].type&&""!==o.val()&&o.parent().addClass("hp-error")})},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:t.transactionId,instrumentId:t.instrumentId,amount:hp.Utils.getAmount(),__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:t.transactionId,instrumentId:t.instrumentId,amount:hp.Utils.getAmount(),__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.handleSubmit=function(){var e=this;return e.formData._isValid?(i.attr("disabled","disabled").text("Submitting..."),hp.Utils.showLoader(),i.attr("disabled","disabled").text("Processing payment..."),void hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),transactionId:e.transactionId,token:hp.Utils.getSession().sessionToken,name:e.formData.name,properties:{accountNumber:e.formData.accountNumber,routingNumber:e.formData.routingNumber,bankName:e.formData.name},billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode}}}}).then(function(t){return t.isException?void e.$parent.trigger("hp.submit",{type:9,res:t}):(e.instrumentId=t.instrumentId,e.transactionId="undefined"!=typeof t.transactionId?t.transactionId:e.transactionId,e.$parent.trigger("hp.submit",{type:0,res:t}),void e.handleCharge(t))}).fail(function(t){"undefined"!=typeof t.responseJSON&&(t=t.responseJSON),e.$parent.trigger("hp.submit",{type:9,res:t})})):(p.addClass("hp-bank-invalid"),void setTimeout(function(){p.removeClass("hp-bank-invalid")},2e3))},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!0},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.BankAccount=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.requestTypes={},this.requestTypes.createPaymentInstrument=0,this.requestTypes.charge=1,this.requestTypes.error=9,this.instrumentId="",this.transactionId="",this.formData={_isValid:!1}}t.hp=hp||{};var i=null,o=null,s=null,l=null,c=null,p=null,u="";(new Date).toISOString();a.prototype.init=function(){u=hp.Utils.getSession().sessionToken;var e=hp.Utils.handleLegacyCssClassApplication("code",this.$element),t=e.parent,n=e.content;t.trigger("hp.notify"),this.context=e,this.$parent=t,this.$content=n,i=this.$content.find(".hp-card-visual-number"),o=this.$content.find(".hp-card-visual-expiry-month"),s=this.$content.find(".hp-card-visual-expiry-year"),l=this.$content.find(".hp-card-visual-name"),c=this.$content.find(".hp-card-visual.hp-card-visual-flat"),p=this.$content.find(".hp-input"),this.transactionId=hp.Utils.defaults.transactionId},a.prototype.clearInputs=function(){this.formData={_isValid:!1},c.removeClass("hp-card-visual-flat-active"),i.html(hp.Utils.defaults.defaultCardCharacters),o.html(hp.Utils.defaults.defaultDateCharacters),s.html(hp.Utils.defaults.defaultDateCharacters),l.html(hp.Utils.defaults.defaultNameOnCardNameSwipe)},a.prototype.createTemplate=function(e,t,n){if(hp.Utils.defaults.paymentTypeOrder.indexOf(2)<0)return"";if("undefined"==typeof e||"undefined"==typeof t||"undefined"==typeof n)throw new Error("hosted-payments.code.js : Cannot create template. Arguments are null or undefined.");var r=['<div class="hp-code-title">To begin: Swipe a card or scan a barcode.</div>','<div class="hp-code-image"></div>','<div class="hp-card-visual hp-card-visual-flat">','<div class="hp-card-visual-number">'+e+"</div>",'<div class="hp-card-visual-name">'+t+"</div>",'<div class="hp-card-visual-expiry">','<span class="hp-card-visual-expiry-label">Month/Year</span>','<span class="hp-card-visual-expiry-label-alt">Valid Thru</span>','<span class="hp-card-visual-expiry-value"><span class="hp-card-visual-expiry-month">'+n+'</span><span>/</span><span class="hp-card-visual-expiry-year">'+n+"</span></span>","</div>","</div>"].join("");return r},a.prototype.detachEvents=function(){this.$content.find(".hp-submit").off(),this.$parent.off("hp.swipped"),this.$parent.trigger("hp.notify"),e(n).off("hp.global_swipped"),e(n).off("hp.global_swipped_start"),e(n).off("hp.global_swipped_end"),e(t).off("keydown")},a.prototype.attachEvents=function(){this.detachEvents();var r=this;e(n).pos(),e(n).on("hp.global_swipped_start",function(e,t){hp.Utils.showLoader(),hp.Utils.defaults.eventCallback(t)}),e(n).on("hp.global_swipped_end",function(e,t){hp.Utils.defaults.eventCallback(t),r.handleSubmit(t)}),e(t).on("keydown",function(e){if(e.target==n.body)return 32!=e.keyCode})},a.prototype.handleCharge=function(e){var t=this,n={};hp.Utils.defaults.paymentType==hp.PaymentType.CHARGE&&(n={charge:{chargeRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:e.transactionId,instrumentId:e.instrumentId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,__request:e.request}}}),hp.Utils.defaults.paymentType==hp.PaymentType.REFUND&&(n={refund:{refundRequest:{correlationId:hp.Utils.getCorrelationId(),token:hp.Utils.getSession().sessionToken,transactionId:e.transactionId,instrumentId:e.instrumentId,amount:hp.Utils.getAmount(),entryType:hp.Utils.defaults.entryType,__request:e.request}}}),hp.Utils.makeRequest(n).then(hp.Utils.buildResultObjectByType).then(function(e){t.$parent.trigger("hp.submit",{type:t.requestTypes.charge,res:e})}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),t.$parent.trigger("hp.submit",{type:t.requestTypes.error,res:e})})},a.prototype.handleSubmit=function(t){var n=this;if(!t.is_valid)return void n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:"Bad swipe. Please try again."});t.name_on_card&&(n.formData.nameOnCard=t.name_on_card),t.card_exp_date_year&&(n.formData.expYear=t.current_year+t.card_exp_date_year),t.card_exp_date_month&&(n.formData.expMonth=t.card_exp_date_month),t.card_number&&(n.formData.cardNumber=e.payment.formatCardNumber(t.card_number),n.formData.cardType=e.payment.cardType(t.card_number)),l.text(n.formData.nameOnCard),i.text(n.formData.cardNumber),s.text(n.formData.expYear.substring(n.formData.expYear.length-2)),o.text(n.formData.expMonth),n.formData.trackOne=t.track_one,n.formData.trackTwo=t.track_two,n.formData.trackThree=t.track_three,n.formData.ksn=t.ksn,c.addClass("hp-card-visual-flat-active"),n.formData._isValid=t.is_valid,n.formData._isEMoney=t.is_emoney;var r={};n.formData._isValid&&""!==n.formData.ksn&&!n.formData._isEMoney&&(r={trackOne:n.formData.trackOne,trackTwo:n.formData.trackTwo,trackThree:n.formData.trackThree,ksn:n.formData.ksn}),this.formData._isValid&&""===n.formData.ksn&&!n.formData._isEMoney&&(r={trackOne:n.formData.trackOne,trackTwo:n.formData.trackTwo,trackThree:"",ksn:""}),this.formData._isValid&&n.formData._isEMoney&&(r={cardNumber:n.formData.cardNumber.replace(/\s/gi,""),cvv:"999",expirationDate:n.formData.expMonth+"/"+n.formData.expYear,nameOnCard:n.formData.nameOnCard}),hp.Utils.promptAvs().then(function(){return hp.Utils.makeRequest({createPaymentInstrument:{createPaymentInstrumentRequest:{correlationId:hp.Utils.getCorrelationId(),transactionId:n.transactionId,token:hp.Utils.getSession().sessionToken,name:n.formData.nameOnCard,properties:r,billingAddress:{addressLine1:hp.Utils.defaults.billingAddress.addressLine1,postalCode:hp.Utils.defaults.billingAddress.postalCode},__swipe:n.formData}}})}).then(function(e){return e.isException?void n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:e}):(n.instrumentId=e.instrumentId,n.transactionId="undefined"!=typeof e.transactionId?e.transactionId:n.transactionId,hp.Utils.showLoader(),n.$parent.trigger("hp.submit",{type:0,res:e}),void n.handleCharge(e))}).fail(function(e){"undefined"!=typeof e.responseJSON&&(e=e.responseJSON),n.$parent.trigger("hp.submit",{type:n.requestTypes.error,res:e})})},a.prototype.handleSuccess=function(e){hp.Utils.handleSuccess(e),this.showSuccess()},a.prototype.handleError=function(e){hp.Utils.handleError(e),this.clearInputs()},a.prototype.showSuccess=function(e){return hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isCode=function(){return!0},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isTransvault=function(){return!1},a.prototype.isGiftCard=function(){return!1},hp.Code=a}(jQuery,window,document),function(e,t,n,r){"use strict";function a(e){this.context=null,this.$parent=null,this.$content=null,this.$element=e,this.hasSuccess=!1,this.browserId=null,this.transactionId="",this.formData={_isValid:!1}}t.hp=hp||{};var i="Transaction in progress... Don't refresh!",o="Authorization in progress... Don't refresh!",s="Terminal active... Don't refresh!",l="Waiting for signature... Don't refresh!",c="Declined... Please try again.",p="Cancelled... Please try again.",u={Success:o,BeginSale:i,Login:s,LoginSuccess:s,ExecuteCommand:s,DisplayAmount:i,DisplayForm:i,FindTermsAndConditions:i,InsertOrSwipe:i,Idle:i,Offline:c,ProcessingError:c,ReadCardRequest:i,SetEmvPaymentType:o,Gratuity:l,CardInserted:o,CardRemoved:o,WaitingForSignature:l,DownloadingSignature:l,Signature:l,SignatureBlocks:l,StopTransaction:o,TermsAndConditions:o,Cancelled:p,Connected:s,Declined:c,Error:c},d=function(e){var t="Idle",n="",a="";e!==r&&null!==e&&(e.STATE!==r&&null!==e.STATE&&(t=e.STATE),e.INFO!==r&&null!==e.INFO&&(t=e.INFO),e.Message!==r&&null!==e.Message&&(t=e.Message),e.GA!==r&&null!==e.GA&&(t="Gratuity"),e.OR!==r&&null!==e.OR&&(t=e.OR,"SUCCESS"!==t&&"Success"!==t||(t="Success"),"DECLINED"!==t&&"Declined"!==t||(t="Declined"),"CANCELLED"!==t&&"Cancelled"!==t||(t="Cancelled"),"ERROR"!==t&&"Error"!==t||(t="Error"),"HOLDCALL"!==t&&"HoldCall"!==t||(t="HoldCall")),e.RD!==r&&null!==e.RD&&(a=e.RD),e.RC!==r&&null!==e.RC&&(n=e.RC)),t=t.replace(/\s/gi,""),""===a&&(n=u[t]);var i={key:t,value:n,message:a};return hp.Utils.log("Raw message: ",e),hp.Utils.log("Parsed message: ",i),i},h=function(e){var t="";switch(e){case i:t="#ED4958";break;case o:t="#ED4958";break;case s:t="#0062CC";break;case l:t="#0062CC";break;case c:t="#ED4958";break;default:t="#000000"}return t};a.prototype.init=function(){var t=hp.Utils.handleLegacyCssClassApplication("transvault",this.$element),n=t.parent,r=t.content;this.context=t,this.$parent=n,this.$content=r,this.transvaultHub=e.connection.transvaultHub,this.$btn=null,this.terminalId=hp.Utils.getTerminalId(),this.connectionId="0",this.correlationId="",this.transactionId=hp.Utils.defaults.transactionId,this.wasCancelled=!1},a.prototype.showError=function(t,n,r){setTimeout(function(){var a=(new Date).toISOString(),i=hp.Utils.getSession().sessionId;if(t="undefined"==typeof t?"Transaction Cancelled.":t,hp.Utils.showError(t,!1),"undefined"!=typeof n&&"undefined"!=typeof r){var o=e(".hp-error-container-active");if(o.is(":visible")){var s=o.find(".hp-error-text"),l=o.find(".hp-error-message");s.empty(),l.empty(),s.text(n),l.html(t+" <br />"+r),t=s.text()+" - "+l.text()}}var c={status:"Error",message:t,created_on:a,token:i};hp.Utils.shouldErrorPostBack()?hp.Utils.buildFormFromObject(c).then(function(e){e.attr("action",hp.Utils.defaults.errorCallback).submit()}):hp.Utils.defaults.errorCallback(c)},0)},a.prototype.createTemplate=function(){if(hp.Utils.defaults.paymentTypeOrder.indexOf(3)<0)return"";var e=['<div class="hp-transvault-visual">','<a class="hp-submit-refresh" href="javascript:;" title="Refresh Transvault">','<img class="hp-submit-refresh-img" src="https://cdn.rawgit.com/etsms/0f62d83b5d3bf18ba57cb14648d913ac/raw/c5f48f7882ad1f48196450fa296caf05f674f48b/refresh-icon.svg" alt="Refresh Transvault Button" />',"</a>",'<div class="hp-transvault-visual-image {{isAlt}}">','<img class="event event-default" src="https://cdn.rawgit.com/etsms/786cb7bdd1d077acc10d7d7e08a4241f/raw/58a2ec726610c18c21716ae6023f7c6d776b5a71/terminal-loading.svg" alt="Status" />',"</div>",'<p class="hp-input-transvault-message {{isAlt}}">',"Disconnected <span></span>","</p>",'<button class="hp-submit hp-submit-danger">Cancel Request</button>',"</div>"].join("");return e=e.replace(/{{isAlt}}/gi,hp.Utils.getTerminalId().startsWith("1")||hp.Utils.getTerminalId().startsWith("3")?"alt":"")},a.prototype.detachEvents=function(){this.$parent.off("hp.transvaultSuccess"),this.$parent.off("hp.transvaultError"),this.$parent.off("hp.transvaultProgress"),this.$parent.find(".hp-submit").off(),this.$parent.find(".hp-submit-refresh").off(),this.$parent.off("hp.notify"),this.transvaultHub.off("onMessage")},a.prototype.attachEvents=function(){this.detachEvents();var t=this;t.transvaultHub.connection.url=hp.Utils.defaults.baseUrl+"/transvault",t.setupWebockets(),t.$parent.find(".hp-submit-refresh").on("click",hp.Utils.reset),t.$parent.find(".hp-submit").on("click",function(n){n.preventDefault(),t.cancelTransaction(),e(this).attr("disabled","disabled").text("Canceling..."),t.setMessage("Canceling transaction")})},a.prototype.onMessage=function(e){var t=d(e),n=t.key,r=t.value,a=this.setMessage(r),i=this;return i.$parent.trigger("hp.notify",t),"Thecredentialsprovidedwereinvalid."===n?(hp.Utils.showError("Reauthenticating. Please wait..."),void setTimeout(function(){i.cancelTransaction(!1).then(function(){setTimeout(hp.Utils.reset,5e3)})},1e3)):(a.css("color",h(r)),"Success"===n?void i.onSuccess(e):"Cancelled"===n||r===p?void i.onCancelled():r===l?void hp.Utils.showLoader():"Declined"===n||"Error"===n?void i.onError(t):"HoldCall"===n?(t.message="Transaction voided.",void i.onError(t)):void 0)},a.prototype.onSuccess=function(t){var n=this,r=t;if(r.ACCT||(r.ACCT=""),r.AN||(r.AN=""),r.AC||(r.AC=""),r.PM||(r.PM="Other"),r.SD?r.SD=r.SD.toLowerCase():r.SD="https://images.pmoney.com/00000000",r.CRDT?r.CRDT=r.CRDT.toUpperCase().replace("ETS",""):r.CRDT="",r.RD||(r.RD=""),r.CEM?r.CEM=r.CEM.replace(/\s/gi,"_").toUpperCase():r.CEM="",r.APAN||(r.APAN=""),r.APN||(r.APN=""),r.CHN||(r.CHN=""),r.AID||(r.AID=""),r.TVR||(r.TVR=""),r.IAD||(r.IAD=""),r.TSI||(r.TSI=""),r.ARC||(r.ARC=""),r.TA||(r.TA=""),r.TCCT||(r.TCCT="USD$"),r.EMD?r.EMD=r.EMD.replace(/\s/gi,"_").toUpperCase():r.EMD="",r.CVMD||(r.CVMD=""),r.TT||(r.TT="PURCHASE"),r.VA?"string"==typeof r.VA?r.VA=+r.VA.replace("$",""):r.VA=+r.VA:r.VA=0,r.GA?"string"==typeof r.GA?r.GA=+r.GA.replace("$",""):r.GA=+r.GA:r.GA=0,r.TAX?"string"==typeof r.TAX?r.TAX=+r.TAX.replace("$",""):r.TAX=+r.TAX:r.TAX=0,r.CBA?"string"==typeof r.CBA?r.CBA=+r.CBA.replace("$",""):r.CBA=+r.CBA:r.CBA=0,r.SA?"string"==typeof r.SA?r.SA=+r.SA.replace("$",""):r.SA=+r.SA:r.SA=0,r.ED){var a=(new Date).getFullYear().toString().substring(0,2)+r.ED.substr(2),i=r.ED.substr(0,2);r.ED=i+"/"+a}else r.ED="";""===r.AN&&""!==r.APAN&&(r.AN=r.APAN),""!==r.AN&&(r.AN=r.AN.replace(/\*|\X|\x/gi,"")),r.AN.length>4&&(r.AN=r.AN.substr(r.AN.length-4)),""!==r.APN&&(r.CHN=r.APN);var o={status:"Success",message:e.trim(r.RD),amount:r.TA,token:hp.Utils.getSession().sessionToken,anti_forgery_token:hp.Utils.defaults.antiForgeryToken,transaction_id:r.ETT,transaction_approval_code:r.AC,transaction_avs_street_passed:!0,transaction_avs_postal_code_passed:!0,transaction_currency:r.TCCT,transaction_status_indicator:r.TSI,transaction_type:r.TT,transaction_tax:r.TAX,transaction_surcharge:r.SA,transaction_gratuity:r.GA,transaction_cashback:r.CBA,transaction_total:r.VA,instrument_id:r.ACCT,instrument_type:r.CRDT,instrument_method:r.PM,instrument_last_four:r.AN,instrument_routing_last_four:"",instrument_expiration_date:r.ED,instrument_verification_method:r.CVMD,instrument_entry_type:r.CEM,instrument_entry_type_description:r.EMD,instrument_verification_results:r.TVR,created_on:(new Date).toISOString(),customer_name:r.CHN,customer_signature:r.SD,correlation_id:n.correlationId,application_identifier:r.AID,application_response_code:r.ARC,application_issuer_data:r.IAD};n.$parent.trigger("hp.transvaultSuccess",o),n.hasSuccess=!0,sessionStorage.clear()},a.prototype.setMessage=function(e){var t=this.$parent.find(".hp-input-transvault-message");return t.text(e),t},a.prototype.cancelTransaction=function(e){var t=hp.Utils.getSession().sessionToken,n=(hp.Utils.getCorrelationId(),jQuery.Deferred()),r=hp.Utils.getAmount();"undefined"!=typeof e&&(e=!0);var a=this;return null===a.browserId?(e||a.onCancelled(),void n.resolve()):(a.sendMessage({transvault:{transvaultRequest:{token:t,amount:r,transactionId:a.transactionId,correlationId:"HP:FROM-GUI",terminalId:a.terminalId,action:"CANCEL",browserId:a.browserId}}}),e||a.onCancelled(),n.resolve(),n)},a.prototype.onCancelled=function(){this.$parent.find(".event-default").hide(),this.$parent.find(".hp-submit").hide();this.showError("Transaction cancelled.");try{this.transvaultHub.connection.stop()}catch(e){}},a.prototype.onError=function(e){this.$parent.find(".event-default").hide(),this.$parent.find(".hp-submit").hide();var t=this;t.showError(e.message,e.key,e.value);try{"HoldCall"===e.key&&hp.Utils.makeRequest({"void":{voidRequest:{token:hp.Utils.getSession().sessionToken,transactionId:t.transactionId,amount:hp.Utils.getAmount()}}}).then(hp.Utils.log,hp.Utils.log),t.transvaultHub.connection.stop()}catch(n){}},a.prototype.sendMessage=function(e){var t=JSON.stringify(e);this.transvaultHub.server.sendMessage(t)},a.prototype.setupWebockets=function(t){var n=this,r=n.$parent.find(".hp-input-transvault-message"),a=hp.Utils.getSession().sessionToken;t=t||hp.Utils.getAmount(),n.correlationId=hp.Utils.getCorrelationId();var i=function(e){n.onMessage(e)},o=function(e){return e&&e.message&&e.message.startsWith("No transport")?(r.hide(),n.$parent.find(".event-default").hide(),n.$parent.find(".hp-submit").hide(),void n.showError("This browser does not yet support WebSockets.")):(hp.Utils.log("Transvault: Connection error!"),void setTimeout(function(){hp.Utils.log("Transvault: Connection reconnecting..."),r.css("color","#FDFDFD").text("Reconnecting in 5 seconds..."),hp.Utils.reset()},15e3))},s=function(e){return e?void r.css("color","#FC5F45").text(e):(r.css("color","#FC5F45").text("Could not connect!"),void o(e))};r.off("click").removeClass("hp-input-transvault-message-btn").text("Connecting"),hp.Utils.log("Transvault: Addding events..."),n.transvaultHub.off("onMessage").on("onMessage",i);try{n.transvaultHub.connection.start({withCredentials:!1,jsonp:!1,transport:["webSockets"],waitForPageLoad:!0}).done(function(){e(".hp-input-transvault-message").text("Connected (listening)...").css("color","#F4854A"),hp.Utils.log("Your connection ID: "+e.connection.hub.id),n.browserId=e.connection.hub.id,setTimeout(function(){n.sendMessage({transvault:{transvaultRequest:{token:a,amount:t,transactionId:n.transactionId,correlationId:n.correlationId,entryType:hp.Utils.defaults.entryType,terminalId:n.terminalId,action:hp.Utils.defaults.paymentType,browserId:n.browserId}}})},50)}).fail(s),n.transvaultHub.connection.error(o),n.transvaultHub.connection.disconnected(function(t){setTimeout(function(){n.wasCancelled||e(".hp-error-container-active").is(":visible")||n.showError("You've been disconnected!")},1e3)})}catch(l){o("An unknown exception occurred. Reconnecting...")}n.$parent.trigger("hp.notify")},a.prototype.showSuccess=function(e){hp.Utils.showSuccessPage(e)},a.prototype.isCreditCard=function(){return!1},a.prototype.isBankAccount=function(){return!1},a.prototype.isEMoney=function(){return!1},a.prototype.isSuccessPage=function(){return!1},a.prototype.isCode=function(){return!1},a.prototype.isTransvault=function(){return!0},a.prototype.isGiftCard=function(){return!1},hp.Transvault=a}(jQuery,window,document),function(){var e,t,n,r,a,i,o,s,l,c,p,u,d,h,f,m,g,v,y,b,S,C,T,_,U=[].slice,E=[].indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1};e=window.jQuery||window.Zepto||window.$,e.payment={},e.payment.fn={},e.fn.payment=function(){var t,n;return n=arguments[0],t=2<=arguments.length?U.call(arguments,1):[],e.payment.fn[n].apply(this,t)},a=/(\d{1,4})/g,e.payment.cards=r=[{type:"elo",patterns:[401178,401179,431274,438935,451416,457393,457631,457632,504175,506699,5067,509,627780,636297,636368,650,6516,6550],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"maestro",patterns:[5018,502,503,506,56,58,639,6220,67],format:a,length:[12,13,14,15,16,17,18,19],cvcLength:[3],luhn:!0},{type:"forbrugsforeningen",patterns:[600],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"dankort",patterns:[5019],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"visa",patterns:[4],format:a,length:[13,16],cvcLength:[3],luhn:!0},{type:"emoney",patterns:[627571],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"mastercard",patterns:[51,52,53,54,55,22,23,24,25,26,27],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"amex",patterns:[34,37],format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,length:[15],cvcLength:[3,4],luhn:!0},{type:"dinersclub",patterns:[30,36,38,39],format:/(\d{1,4})(\d{1,6})?(\d{1,4})?/,length:[14],cvcLength:[3],luhn:!0},{type:"discover",patterns:[60,64,65,622],format:a,length:[16],cvcLength:[3],luhn:!0},{type:"unionpay",patterns:[62,88],format:a,length:[16,17,18,19],cvcLength:[3],luhn:!1},{type:"jcb",patterns:[35],format:a,length:[16],cvcLength:[3],
luhn:!0}],t=function(e){var t,n,a,i,o,s,l,c;for(e=(e+"").replace(/\D/g,""),i=0,s=r.length;i<s;i++)for(t=r[i],c=t.patterns,o=0,l=c.length;o<l;o++)if(a=c[o],n=a+"",e.substr(0,n.length)===n)return t},n=function(e){var t,n,a;for(n=0,a=r.length;n<a;n++)if(t=r[n],t.type===e)return t},d=function(e){var t,n,r,a,i,o;for(r=!0,a=0,n=(e+"").split("").reverse(),i=0,o=n.length;i<o;i++)t=n[i],t=parseInt(t,10),(r=!r)&&(t*=2),t>9&&(t-=9),a+=t;return a%10===0},u=function(e){var t;return null!=e.prop("selectionStart")&&e.prop("selectionStart")!==e.prop("selectionEnd")||!(null==("undefined"!=typeof document&&null!==document&&null!=(t=document.selection)?t.createRange:void 0)||!document.selection.createRange().text)},T=function(e,t){var n,r,a,i,o,s;try{r=t.prop("selectionStart")}catch(l){i=l,r=null}if(o=t.val(),t.val(e),null!==r&&t.is(":focus"))return r===o.length&&(r=e.length),o!==e&&(s=o.slice(r-1,+r+1||9e9),n=e.slice(r-1,+r+1||9e9),a=e[r],/\d/.test(a)&&s===""+a+" "&&n===" "+a&&(r+=1)),t.prop("selectionStart",r),t.prop("selectionEnd",r)},v=function(e){var t,n,r,a,i,o,s,l;for(null==e&&(e=""),r="",a="0123456789",o="",t=e.split(""),s=0,l=t.length;s<l;s++)n=t[s],i=r.indexOf(n),i>-1&&(n=a[i]),o+=n;return o},g=function(t){var n;return n=e(t.currentTarget),setTimeout(function(){var e;return e=n.val(),e=v(e),e=e.replace(/\D/g,""),T(e,n)})},f=function(t){var n;return n=e(t.currentTarget),setTimeout(function(){var t;return t=n.val(),t=v(t),t=e.payment.formatCardNumber(t),T(t,n)})},s=function(n){var r,a,i,o,s,l,c;if(i=String.fromCharCode(n.which),/^\d+$/.test(i)&&(r=e(n.currentTarget),c=r.val(),a=t(c+i),o=(c.replace(/\D/g,"")+i).length,l=16,a&&(l=a.length[a.length.length-1]),!(o>=l||null!=r.prop("selectionStart")&&r.prop("selectionStart")!==c.length)))return s=a&&"amex"===a.type?/^(\d{4}|\d{4}\s\d{6})$/:/(?:^|\s)(\d{4})$/,s.test(c)?(n.preventDefault(),setTimeout(function(){return r.val(c+" "+i)})):s.test(c+i)?(n.preventDefault(),setTimeout(function(){return r.val(c+i+" ")})):void 0},i=function(t){var n,r;if(n=e(t.currentTarget),r=n.val(),8===t.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===r.length))return/\d\s$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d\s$/,""))})):/\s\d?$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d$/,""))})):void 0},m=function(t){var n;return n=e(t.currentTarget),setTimeout(function(){var t;return t=n.val(),t=v(t),t=e.payment.formatExpiry(t),T(t,n)})},l=function(t){var n,r,a;if(r=String.fromCharCode(t.which),/^\d+$/.test(r))return n=e(t.currentTarget),a=n.val()+r,/^\d$/.test(a)&&"0"!==a&&"1"!==a?(t.preventDefault(),setTimeout(function(){return n.val("0"+a+" / ")})):/^\d\d$/.test(a)?(t.preventDefault(),setTimeout(function(){var e,t;return e=parseInt(a[0],10),t=parseInt(a[1],10),t>2&&0!==e?n.val("0"+e+" / "+t):n.val(""+a+" / ")})):void 0},c=function(t){var n,r,a;if(r=String.fromCharCode(t.which),/^\d+$/.test(r))return n=e(t.currentTarget),a=n.val(),/^\d\d$/.test(a)?n.val(""+a+" / "):void 0},p=function(t){var n,r,a;if(a=String.fromCharCode(t.which),"/"===a||" "===a)return n=e(t.currentTarget),r=n.val(),/^\d$/.test(r)&&"0"!==r?n.val("0"+r+" / "):void 0},o=function(t){var n,r;if(n=e(t.currentTarget),r=n.val(),8===t.which&&(null==n.prop("selectionStart")||n.prop("selectionStart")===r.length))return/\d\s\/\s$/.test(r)?(t.preventDefault(),setTimeout(function(){return n.val(r.replace(/\d\s\/\s$/,""))})):void 0},h=function(t){var n;return n=e(t.currentTarget),setTimeout(function(){var e;return e=n.val(),e=v(e),e=e.replace(/\D/g,"").slice(0,4),T(e,n)})},C=function(e){var t;return!(!e.metaKey&&!e.ctrlKey)||32!==e.which&&(0===e.which||(e.which<33||(t=String.fromCharCode(e.which),!!/[\d\s]/.test(t))))},b=function(n){var r,a,i,o;if(r=e(n.currentTarget),i=String.fromCharCode(n.which),/^\d+$/.test(i)&&!u(r))return o=(r.val()+i).replace(/\D/g,""),a=t(o),a?o.length<=a.length[a.length.length-1]:o.length<=16},S=function(t){var n,r,a;if(n=e(t.currentTarget),r=String.fromCharCode(t.which),/^\d+$/.test(r)&&!u(n))return a=n.val()+r,a=a.replace(/\D/g,""),!(a.length>6)&&void 0},y=function(t){var n,r,a;if(n=e(t.currentTarget),r=String.fromCharCode(t.which),/^\d+$/.test(r)&&!u(n))return a=n.val()+r,a.length<=4},_=function(t){var n,a,i,o,s;if(n=e(t.currentTarget),s=n.val(),o=e.payment.cardType(s)||"unknown",!n.hasClass(o))return a=function(){var e,t,n;for(n=[],e=0,t=r.length;e<t;e++)i=r[e],n.push(i.type);return n}(),n.removeClass("unknown"),n.removeClass(a.join(" ")),n.addClass(o),n.toggleClass("identified","unknown"!==o),n.trigger("payment.cardType",o)},e.payment.fn.formatCardCVC=function(){return this.on("keypress",C),this.on("keypress",y),this.on("paste",h),this.on("change",h),this.on("input",h),this},e.payment.fn.formatCardExpiry=function(){return this.on("keypress",C),this.on("keypress",S),this.on("keypress",l),this.on("keypress",p),this.on("keypress",c),this.on("keydown",o),this.on("change",m),this.on("input",m),this},e.payment.fn.formatCardNumber=function(){return this.on("keypress",C),this.on("keypress",b),this.on("keypress",s),this.on("keydown",i),this.on("keyup",_),this.on("paste",f),this.on("change",f),this.on("input",f),this.on("input",_),this},e.payment.fn.restrictNumeric=function(){return this.on("keypress",C),this.on("paste",g),this.on("change",g),this.on("input",g),this},e.payment.fn.cardExpiryVal=function(){return e.payment.cardExpiryVal(e(this).val())},e.payment.cardExpiryVal=function(e){var t,n,r,a;return a=e.split(/[\s\/]+/,2),t=a[0],r=a[1],2===(null!=r?r.length:void 0)&&/^\d+$/.test(r)&&(n=(new Date).getFullYear(),n=n.toString().slice(0,2),r=n+r),t=parseInt(t,10),r=parseInt(r,10),{month:t,year:r}},e.payment.validateCardNumber=function(e){var n,r;return e=(e+"").replace(/\s+|-/g,""),!!/^\d+$/.test(e)&&(n=t(e),!!n&&(r=e.length,E.call(n.length,r)>=0&&(n.luhn===!1||d(e))))},e.payment.validateCardExpiry=function(t,n){var r,a,i;return"object"==typeof t&&"month"in t&&(i=t,t=i.month,n=i.year),!(!t||!n)&&(t=e.trim(t),n=e.trim(n),!!/^\d+$/.test(t)&&(!!/^\d+$/.test(n)&&(1<=t&&t<=12&&(2===n.length&&(n=n<70?"20"+n:"19"+n),4===n.length&&(a=new Date(n,t),r=new Date,a.setMonth(a.getMonth()-1),a.setMonth(a.getMonth()+1,1),a>r)))))},e.payment.validateCardCVC=function(t,r){var a,i;return t=e.trim(t),!!/^\d+$/.test(t)&&(a=n(r),null!=a?(i=t.length,E.call(a.cvcLength,i)>=0):t.length>=3&&t.length<=4)},e.payment.cardType=function(e){var n;return e?(null!=(n=t(e))?n.type:void 0)||null:null},e.payment.formatCardNumber=function(n){var r,a,i,o;return n=n.replace(/\D/g,""),(r=t(n))?(i=r.length[r.length.length-1],n=n.slice(0,i),r.format.global?null!=(o=n.match(r.format))?o.join(" "):void 0:(a=r.format.exec(n),null!=a?(a.shift(),a=e.grep(a,function(e){return e}),a.join(" ")):void 0)):n},e.payment.formatExpiry=function(e){var t,n,r,a;return(n=e.match(/^\D*(\d{1,2})(\D+)?(\d{1,4})?/))?(t=n[1]||"",r=n[2]||"",a=n[3]||"",a.length>0?r=" / ":" /"===r?(t=t.substring(0,1),r=""):2===t.length||r.length>0?r=" / ":1===t.length&&"0"!==t&&"1"!==t&&(t="0"+t,r=" / "),t+r+a):""}}.call(this),function(e){var t={};e.fn.pos=function(n){var r=e(this),a=new RegExp(/^(?:%B|\;)([0-9]+)/gi),i=new RegExp(/(?:\^(.*)\^)/gi),o=new RegExp(/(?:\^(?:.*)\^|=)(\d{4})/gi),s=new RegExp(/\|([A-Z0-9]+)(?=\|)/gi),l=new RegExp(/^(.*?\?)(;.*)/gi),c={swipe:""};t={swipe:!0,onEventName:"hp.global_swipped_start",offEventName:"hp.global_swipped_end",onScanSwipe:e.noop};var p=function(e,t){var n=!1;try{n="undefined"!=typeof e[t]}catch(r){}return n};r.options=e.extend(!0,{},t,n),r.off("keypress").on("keypress",function(t){if(r.options.swipe){if(13!=t.which)return c.swipe+=String.fromCharCode(t.which),void(2==c.swipe.length&&"%B"==c.swipe&&r.trigger(r.options.onEventName));var n={track_one:"",track_two:"",track_three:"",ksn:"",card_number:"",name_on_card:"",card_exp_date_month:"",card_exp_date_year:"",is_valid:!0,is_emoney:!1,current_year:(new Date).getFullYear().toString().substring(0,2)},u=a.exec(c.swipe),d=i.exec(c.swipe),h=o.exec(c.swipe),f=c.swipe.match(s),m=l.exec(c.swipe);if(null!=u&&u.length&&(n.card_number=u[1]),null!=d&&d.length){var g=d[1];g=g.indexOf(",")===-1?g.replace(/\/+|\d+/gi," "):e.trim(g.replace(/\//gi," ").replace(/\W+/gi," ")),g=g.split(" ").length>2?g.split(" ")[1]+" "+g.split(" ")[2]+" "+g.split(" ")[0]:g.split(" ")[1]+" "+g.split(" ")[0],n.name_on_card=g}if(null!=h&&h.length){var v=h[1],y=v.substring(0,2),b=v.substring(2);n.card_exp_date_year=y,n.card_exp_date_month=b}null!=f&&f.length?(f=f.map(function(e){return e.replace("|","")}),p(f,1)&&(n.track_one=f[1]),p(f,2)&&(n.track_two=f[2]),f.length>=10&&p(f,3)&&(n.track_three=f[3]),f.length>=10&&p(f,8)?n.ksn=f[8]:9===f.length&&(n.ksn=f[7])):null!=m&&m.length>=3?(n.track_one=m[1],n.track_two=m[2]):n.is_valid=!1,13==t.which&&(n.is_valid||n.card_number.indexOf("627571")===-1||(n.is_valid=!0,n.is_emoney=!0,n.name_on_card="EMoney Card",n.card_exp_date_year=(+(new Date).getFullYear().toString().substring(2)+9).toString(),n.card_exp_date_month="12"),c.swipe.indexOf("%E?")===-1&&c.swipe.indexOf("+E?")===-1&&c.swipe.indexOf(";E?")===-1||(n.is_valid=!1),""===n.name_on_card&&(n.name_on_card="Unknown Card"),n.name_on_card=e.trim(n.name_on_card.replace("undefined","")),r.trigger(r.options.offEventName,n),r.options.onScanSwipe(n),c.swipe="")}})}}(jQuery),function(){var e;e=window.jQuery||window.Zepto||window.$,e.fn.fancySelect=function(t){var n,r;return null==t&&(t={}),r=e.extend({forceiOS:!1,includeBlank:!1,optionTemplate:function(e){return e.text()},triggerTemplate:function(e){return e.text()}},t),n=!!navigator.userAgent.match(/iP(hone|od|ad)/i),this.each(function(){var t,a,i,o,s,l,c;if(o=e(this),!o.hasClass("fancified")&&"SELECT"===o[0].tagName)return o.addClass("fancified"),o.css({width:1,height:1,display:"block",position:"absolute",top:0,left:0,opacity:0}),o.wrap('<div class="fancy-select">'),c=o.parent(),o.data("class")&&c.addClass(o.data("class")),c.append('<div class="trigger">'),n&&!r.forceiOS||c.append('<ul class="options">'),s=c.find(".trigger"),i=c.find(".options"),a=o.prop("disabled"),a&&c.addClass("disabled"),l=function(){var e;return e=r.triggerTemplate(o.find(":selected")),s.html(e)},o.on("blur.fs",function(){if(s.hasClass("open"))return setTimeout(function(){return s.trigger("close.fs")},120)}),s.on("close.fs",function(){return s.removeClass("open"),i.removeClass("open")}),s.on("click.fs",function(){var t,l;if(!a)if(s.toggleClass("open"),n&&!r.forceiOS){if(s.hasClass("open"))return o.focus()}else if(s.hasClass("open")&&(l=s.parent(),t=l.offsetParent(),l.offset().top+l.outerHeight()+i.outerHeight()+20>e(window).height()+e(window).scrollTop()?i.addClass("overflowing"):i.removeClass("overflowing")),i.toggleClass("open"),!n)return o.focus()}),o.on("enable",function(){return o.prop("disabled",!1),c.removeClass("disabled"),a=!1,t()}),o.on("disable",function(){return o.prop("disabled",!0),c.addClass("disabled"),a=!0}),o.on("change.fs",function(e){return e.originalEvent&&e.originalEvent.isTrusted?e.stopPropagation():l()}),o.on("keydown",function(e){var t,n,r;if(r=e.which,t=i.find(".hover"),t.removeClass("hover"),i.hasClass("open")){if(38===r?(e.preventDefault(),t.length&&t.index()>0?t.prev().addClass("hover"):i.find("li:last-child").addClass("hover")):40===r?(e.preventDefault(),t.length&&t.index()<i.find("li").length-1?t.next().addClass("hover"):i.find("li:first-child").addClass("hover")):27===r?(e.preventDefault(),s.trigger("click.fs")):13===r||32===r?(e.preventDefault(),t.trigger("mousedown.fs")):9===r&&s.hasClass("open")&&s.trigger("close.fs"),n=i.find(".hover"),n.length)return i.scrollTop(0),i.scrollTop(n.position().top-12)}else if(13===r||32===r||38===r||40===r)return e.preventDefault(),s.trigger("click.fs")}),i.on("mousedown.fs","li",function(t){var r;return r=e(this),o.val(r.data("raw-value")),n||o.trigger("blur.fs").trigger("focus.fs"),i.find(".selected").removeClass("selected"),r.addClass("selected"),s.addClass("selected"),o.val(r.data("raw-value")).trigger("change.fs").trigger("blur.fs").trigger("focus.fs")}),i.on("mouseenter.fs","li",function(){var t,n;return n=e(this),t=i.find(".hover"),t.removeClass("hover"),n.addClass("hover")}),i.on("mouseleave.fs","li",function(){return i.find(".hover").removeClass("hover")}),t=function(){var t;if(l(),!n||r.forceiOS)return t=o.find("option"),o.find("option").each(function(t,n){var a;if(n=e(n),!n.prop("disabled")&&(n.val()||r.includeBlank))return a=r.optionTemplate(n),n.prop("selected")?i.append('<li data-raw-value="'+n.val()+'" class="selected">'+a+"</li>"):i.append('<li data-raw-value="'+n.val()+'">'+a+"</li>")})},o.on("update.fs",function(){return c.find(".options").empty(),t()}),t()})}}.call(this),function(e,t,n,r){function a(e,t){this._name=i,this.element=e,"undefined"==typeof t&&(t={}),"undefined"!=typeof t.entryType&&(t.entryType=hp.Utils.setEntryType(t.entryType)),"undefined"!=typeof t.paymentType&&(t.paymentType=hp.Utils.setPaymentType(t.paymentType)),"undefined"!=typeof t.paymentService&&(t.paymentService=hp.Utils.setPaymentService(t.paymentService)),"undefined"!=typeof t.amount&&(t.amount=hp.Utils.setAmount(t.amount)),hp.Utils.defaults=jQuery.extend({},o,t),this.init(),hp.Utils.__instance=this}var i="hp",o={};o.version="v3.7.20",o.amount=0,o.baseUrl="https://htv.emoney.com/v3/adapters",o.defaultCardCharacters="&middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot; &middot;&middot;&middot;&middot;",o.defaultDateCharacters="&middot;&middot;",o.defaultNameOnCardName="Name On Card",o.defaultNameOnCardNameSwipe="Swipe/Scan Card",o.defaultName="Full Name",o.defaultPhone="800-834-7790",o.defaultErrorLabel="Error",o.defaultRedirectLabel="",o.defaultSuccessLabel="Transaction Complete!",o.paymentTypeOrder=[0,1],o.paymentService=hp.PaymentService.EFT,o.defaultAccountNumberCharacters="&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;",o.defaultRoutingNumberCharacters="&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;&middot;",o.correlationId="",o.successCallback=e.noop,o.errorCallback=e.noop,o.eventCallback=e.noop,o.terminalId="",o.transactionId=hp.Utils.generateGuild(),o.instrumentId="",o.apiKey="",o.bypassSessionStorage=!0,o.paymentType=hp.PaymentType.CHARGE,o.entryType=hp.EntryType.KEYED_CARD_NOT_PRESENT,o.billingAddress={},o.billingAddress.addressLine1="",o.billingAddress.postalCode="",o.antiForgeryToken="",o.antiForgeryName="__RequestVerificationToken",o.customerName="",o.promptForAvs=!1,o.allowAvsSkip=!0,o.allowHttpsSkip=!1,o.debug=!1,o.showAmex=!0,o.showVisa=!0,o.showDiscover=!0,o.showDiners=!0,o.showJcb=!0,o.showGift=!0,o.showEMoney=!0,o.showMasterCard=!0,o.appUrlScheme="emmerchant://";var s=function(){var t=this,n=e(t.element),r="";(new Date).toISOString();""===hp.Utils.getSession().apiKey&&("undefined"!=typeof n.data("etsKey")?(r=n.data("etsKey").toString(),hp.Utils.defaults.apiKey=r):r=hp.Utils.defaults.apiKey,hp.Utils.setSession(r,!0)),"undefined"!=typeof n.data("debug")&&("false"===n.data("debug").toString()?hp.Utils.defaults.debug=!1:hp.Utils.defaults.debug=!0),"undefined"!=typeof n.data("bypassSessionStorage")&&("false"===n.data("bypassSessionStorage").toString()?hp.Utils.defaults.bypassSessionStorage=!1:"true"===n.data("bypassSessionStorage").toString()&&(hp.Utils.defaults.bypassSessionStorage=!0)),"undefined"!=typeof n.data("showAmex")&&("false"===n.data("showAmex").toString()?hp.Utils.defaults.showAmex=!1:"true"===n.data("showAmex").toString()&&(hp.Utils.defaults.showAmex=!0)),"undefined"!=typeof n.data("showVisa")&&("false"===n.data("showVisa").toString()?hp.Utils.defaults.showVisa=!1:"true"===n.data("showVisa").toString()&&(hp.Utils.defaults.showVisa=!0)),"undefined"!=typeof n.data("showDiscover")&&("false"===n.data("showDiscover").toString()?hp.Utils.defaults.showDiscover=!1:"true"===n.data("showDiscover").toString()&&(hp.Utils.defaults.showDiscover=!0)),"undefined"!=typeof n.data("showDiners")&&("false"===n.data("showDiners").toString()?hp.Utils.defaults.showDiners=!1:"true"===n.data("showDiners").toString()&&(hp.Utils.defaults.showDiners=!0)),"undefined"!=typeof n.data("showJcb")&&("false"===n.data("showJcb").toString()?hp.Utils.defaults.showJcb=!1:"true"===n.data("showJcb").toString()&&(hp.Utils.defaults.showJcb=!0)),"undefined"!=typeof n.data("showMasterCard")&&("false"===n.data("showMasterCard").toString()?hp.Utils.defaults.showMasterCard=!1:"true"===n.data("showMasterCard").toString()&&(hp.Utils.defaults.showMasterCard=!0)),"undefined"!=typeof n.data("showEMoney")&&("false"===n.data("showEMoney").toString()?hp.Utils.defaults.showEMoney=!1:"true"===n.data("showEMoney").toString()&&(hp.Utils.defaults.showEMoney=!0)),"undefined"!=typeof n.data("showGift")&&("false"===n.data("showGift").toString()?hp.Utils.defaults.showGift=!1:"true"===n.data("showGift").toString()&&(hp.Utils.defaults.showGift=!0)),"undefined"!=typeof n.data("transactionId")&&(hp.Utils.defaults.transactionId=n.data("transactionId").toString()),"undefined"!=typeof n.data("appUrlScheme")&&(hp.Utils.defaults.appUrlScheme=n.data("appUrlScheme").toString()),"undefined"!=typeof n.data("avsStreet")&&(hp.Utils.defaults.billingAddress.addressLine1=n.data("avsStreet").toString()),"undefined"!=typeof n.data("avsZip")&&(hp.Utils.defaults.billingAddress.postalCode=n.data("avsZip").toString()),"undefined"!=typeof n.data("paymentService")&&(hp.Utils.defaults.paymentService=hp.Utils.setPaymentService(n.data("paymentService"))),"undefined"!=typeof n.data("entryType")&&(hp.Utils.defaults.entryType=hp.Utils.setEntryType(n.data("entryType"))),"undefined"!=typeof n.data("paymentType")&&(hp.Utils.defaults.paymentType=hp.Utils.setPaymentType(n.data("paymentType"))),"undefined"!=typeof n.data("promptForAvs")&&(hp.Utils.defaults.promptForAvs="false"!=n.data("promptForAvs").toString().toLowerCase()),"undefined"!=typeof n.data("allowAvsSkip")&&(hp.Utils.defaults.allowAvsSkip="false"!=n.data("allowAvsSkip").toString().toLowerCase()),"undefined"!=typeof n.data("allowHttpsSkip")&&(hp.Utils.defaults.allowHttpsSkip="false"!=n.data("allowHttpsSkip").toString().toLowerCase()),"undefined"!=typeof n.data("correlationId")&&(hp.Utils.defaults.correlationId=n.data("correlationId").toString()),"undefined"!=typeof n.data("terminalId")&&(hp.Utils.defaults.terminalId=n.data("terminalId").toString()),"undefined"!=typeof n.data("instrumentId")&&(hp.Utils.defaults.instrumentId=n.data("instrumentId").toString()),"undefined"!=typeof n.data("baseUrl")&&(hp.Utils.defaults.baseUrl=n.data("baseUrl").toString()),"undefined"!=typeof n.data("customerName")&&(hp.Utils.defaults.customerName=n.data("customerName").toString()),"undefined"!=typeof n.data("defaultPhone")&&(hp.Utils.defaults.defaultPhone=n.data("defaultPhone").toString()),"undefined"!=typeof n.data("errorLabel")&&(hp.Utils.defaults.defaultErrorLabel=n.data("errorLabel").toString()),"undefined"!=typeof n.data("redirectLabel")&&(hp.Utils.defaults.defaultRedirectLabel=n.data("redirectLabel").toString()),"undefined"!=typeof n.data("successLabel")&&(hp.Utils.defaults.defaultSuccessLabel=n.data("successLabel").toString()),"undefined"!=typeof n.data("paymentTypeOrder")&&(hp.Utils.defaults.paymentTypeOrder=e.trim(n.data("paymentTypeOrder").toString().replace(" ","")).split(",").map(function(e){return+e})),"undefined"!=typeof n.data("amount")&&hp.Utils.setAmount(n.data("amount")),"undefined"!=typeof n.data("antiForgeryToken")?hp.Utils.defaults.antiForgeryToken=n.data("antiForgeryToken").toString():hp.Utils.defaults.antiForgeryToken=hp.Utils.generateGuild(),"undefined"!=typeof n.data("antiForgeryName")&&(hp.Utils.defaults.antiForgeryName=n.data("antiForgeryName").toString()),n.attr("data-ets-key",hp.Utils.generateGuild()),hp.Utils.setPaymentInstrument(),hp.Utils.signIn().then(function(){hp.Utils.setupPluginInstances(n)})};e.extend(a.prototype,{init:function(){var t=e(this.element),n="",r=hp.types.Adapter;if(null!==t.data("event")&&"undefined"!=typeof t.data("event")&&(r=hp.types.Event,n=t.data("event")),null!==t.data("inventory")&&"undefined"!=typeof t.data("inventory")&&(r=hp.types.Product,n=t.data("inventory")),hp.Utils.setContainerClass(t),r===hp.types.Event)n=t.data("event");else if(r===hp.types.Product)n=t.data("inventory");else if(r===hp.types.Adapter)return void s.call(this);var a=t.data("email"),i=t.data("bcc"),o=t.data("client"),l="undefined"!=typeof t.data("memo"),c=t.data("ga"),p=t.data("order"),u=t.data("subject"),d=new hp.Setup(r,new hp.models.Options(o,a,i,l,c,p,n,u));t.find("[data-item]").each(function(){var t=new hp.models.Item(e(this).data("item"),e(this).data("price"));d.addItem(t)}),t.empty(),d.createForm(this.element,hp.Utils.defaults.baseUrl).then(function(e){t.width(e.width).height(e.height).css("margin","0 auto")})}}),e.fn[i]=function(t){return this.each(function(){e.data(this,"plugin_"+i)||e.data(this,"plugin_"+i,new a(this,t))}),this}}(jQuery,window,document);