YUI.add("gallery-yplate",function(Y){Y.yplate=function(return_core){function PlateCore(){var ARR="[object Array]",STR="[object String]";var PLATE_TMPL_UNDEF_ERROR="UndefinedTemplateError",PLATE_TMPL_COMP_ERROR="TemplateCompilationError",PLATE_TMPL_EXEC_ERROR="TemplateExecutionError";var n=1,tag="%",escreg=/(\\|["'])/g,type_of=Object.prototype.toString,platecache={};function raise(error,ext){error.message=error.message+(ext?"\n TYPE: "+ext:"");throw error.toString();}function escstr(str){return str.replace(escreg,"\\$1");}var platecompile,plateapply,platecacheview,add,cacheSize,platetag;platecompile=function(tid,template,tg){var cache,cacheid,elem,tmpl,t=tg||tag,type=type_of.call(template),tid_type=type_of.call(tid);if(tid_type===STR){cache=platecache[tid];if(cache){return cache;}}if(type===STR){elem=tmpl=template;}else{raise(new Error("Empty, undefined, or non-string template passed to platecompile"),PLATE_TMPL_UNDEF_ERROR);}var arr=tmpl.replace(/\s*<!-*\[CDATA\[\s*|\s*\]\]-*>\s*|[^:]\/{2,}.*|[\r\n\t]/g,"").replace(/\/\*.*\*\//g,"").split("<"+t).join(t+">\x1b").split(t+">");var m,l,arrm,esc=false,str="";for(m=0,l=arr.length;m<l;m++){arrm=arr[m];if(arrm.charAt(0)!=="\x1b"){str+="YP_OUT+='"+escstr(arrm)+"';";}else{if(arrm.charAt(1)==="="){str+="YP_OUT+=("+arrm.substr(2)+");";}else{if(arrm.charAt(1)==="!"){esc=true;str+='YP_OUT+=(_YP_ESC_("'+escstr(arr[m].substr(2))+'"));';}else{if(arrm.charAt(0)===" "){str+="";}else{str+=";"+arrm.substr(1);}}}}}str="try{"+('var YP_OUT="";'+str+";return YP_OUT;").split("YP_OUT+='';").join("").split('var YP_OUT="";YP_OUT+=').join("var YP_OUT=")+'}catch(e){e.type="'+PLATE_TMPL_EXEC_ERROR+'";e.args=arguments;throw e;}';if(esc){str="var _YP_ESC_ = function(str) {return str.toString().replace(/&(?!\\w+;)/g, '&#38;').split('<').join('&#60;').split('>').join('&#62;').split('\"').join('&#34;').split(\"'\").join('&#39;');};"+str;}str=str.split(";;").join(";");var fn;try{fn=new Function("YPI, YPJ, YP_DATA, YP_DATA_SIZE, YPFN",str);}catch(e){raise(e,PLATE_TMPL_COMP_ERROR);}if(tid_type===STR){cacheid=tid;n++;platecache[cacheid]=fn;return platecache[cacheid];}return fn;};plateapply=function(platefn,data){var val=[],i,s;try{if(type_of.call(data)!==ARR){data=[data];}s=data.length;for(i=0;i<s;i++){val.push(platefn.call(data[i],0,i,data[i],s,platefn));}}catch(e){raise(e,PLATE_TMPL_EXEC_ERROR);}return val;};platecacheview=function(tid){var pfn=platecache[tid],fnstr;if(pfn){fnstr=pfn.toString();fnstr=fnstr.substring(fnstr.indexOf("{")+1,fnstr.lastIndexOf("}"));}return fnstr;};add=function(tid,compiled){if(tid&&compiled&&type_of.call(tid)===STR&&type_of.call(compiled)===STR){var cacheid=tid;try{eval("platecache[cacheid] = "+compiled+";");n++;}catch(e){raise(e,PLATE_TMPL_COMP_ERROR);}return true;}return false;};cacheSize=function(){return n;};platetag=function(newtag){if(newtag&&type_of.call(newtag)===STR){tag=newtag;}};var core_api={"platecompile":platecompile,"plateapply":plateapply,"platecacheview":platecacheview,"plateTag":platetag,"add":add,"cacheSize":cacheSize};return core_api;}if(return_core&&return_core===true){return new PlateCore();}var core=new PlateCore();function getCoreInput(candidate){if(Y.Lang.isString(candidate)){return candidate;}candidate=Y.Node.getDOMNode(candidate);if(candidate){return candidate.innerHTML;}return null;}function ycachecompile(candidate,cid,tag,_internal){var txt=getCoreInput(candidate),pfn,fnstr;pfn=core.platecompile(cid,txt,tag);if(_internal===true){return pfn;}if(pfn){fnstr=pfn.toString();fnstr=fnstr.replace(/[\r\n\t]/g,"");fnstr=fnstr.replace(/;\s+/g,";");}return fnstr;}function ycacheadd(cid,compiledcache){return core.add(cid,compiledcache);}function ycacheview(cid){return core.platecacheview(cid);}function yplate(candidate,data,cid,tag){var txt=yplateText(candidate,data,cid,tag),nodes=new Y.all(""),i,isArr=Y.Lang.isArray(txt)&&txt.length>1,s=txt.length;if(isArr){for(i=0;i<s;i++){nodes.push(Y.Node.create(txt[i]));}}else{nodes=Y.Node.create(txt);}return nodes;}function yplatecache(cid,data,tag){var txt=yplatecacheText(cid,data,tag),nodes=new Y.all(""),i,isArr=Y.Lang.isArray(txt)&&txt.length>1,s=txt.length;if(isArr){for(i=0;i<s;i++){nodes.push(Y.Node.create(txt[i]));}}else{nodes=Y.Node.create(txt);}return nodes;}function yplateText(candidate,data,cid,tag){var pfn=ycachecompile(candidate,cid,tag,true);return core.plateapply(pfn,data);}function yplatecacheText(cid,data,tag){var pfn=core.platecompile(cid,null,tag,true);return core.plateapply(pfn,data);}function yplateTag(tag){core.plateTag(tag);}return{"plate":yplate,"platecache":yplatecache,"cachecompile":ycachecompile,"platecacheText":yplatecacheText,"plateText":yplateText,"plateTag":yplateTag,"cacheview":ycacheview,"cacheadd":ycacheadd};};},"gallery-2011.06.08-20-04",{requires:["node"]});