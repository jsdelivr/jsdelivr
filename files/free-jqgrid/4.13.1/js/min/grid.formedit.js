(function(a){"function"===typeof define&&define.amd?define(["jquery","./grid.base","./jquery.fmatter","./grid.common","./jsonxml"],a):"object"===typeof exports?a(require("jquery")):a(jQuery)})(function(a){var v=a.jgrid,F=v.jqID,C=a.fn.jqGrid,K=C.getGuiStyles,V=v.mergeCssClasses,T=v.hasOneFromClasses,ja=v.feedback,ka=v.fullBoolFeedback,M=v.builderFmButon,ca=function(a,v,e){!0===v[0]&&(e="<span class='"+V("fm-button-icon",e,v[2])+"'></span>","right"===v[1]?a.addClass("fm-button-icon-right").append(e):
a.addClass("fm-button-icon-left").prepend(e))},P=function(a){return K.call(this,"states."+a)},da=function(a){return"&nbsp;"===a||"&#160;"===a||1===a.length&&160===a.charCodeAt(0)};v.extend({searchGrid:function(p){return this.each(function(){function R(b){t("beforeShow",b)&&(a(w).data("onClose",c.onClose),v.viewModal.call(e,w,{gbox:D,jqm:c.jqModal,overlay:c.overlay,modal:c.modal,overlayClass:c.overlayClass,toTop:c.toTop,onHide:function(a){a.w.remove();a.o&&a.o.remove()}}),t("afterShow",b))}var e=this,
u=a(e),n=e.p;if(e.grid&&null!=n){var c=a.extend(!0,{drag:!0,sField:"searchField",sValue:"searchString",sOper:"searchOper",sFilter:"filters",loadDefaults:!0,beforeShowSearch:null,afterShowSearch:null,onInitializeSearch:null,afterRedraw:null,afterChange:null,closeAfterSearch:!1,closeAfterReset:!1,closeOnEscape:!1,searchOnEnter:!1,multipleSearch:!1,multipleGroup:!1,top:0,left:0,removemodal:!0,resize:!0,width:450,height:"auto",dataheight:"auto",showQuery:!1,errorcheck:!0,sopt:null,stringResult:void 0,
onClose:null,onSearch:null,onReset:null,columns:[],tmplNames:null,tmplFilters:null,tmplLabel:" Template: ",showOnLoad:!1,layer:null,operands:{eq:"=",ne:"<>",lt:"<",le:"<=",gt:">",ge:">=",bw:"LIKE",bn:"NOT LIKE","in":"IN",ni:"NOT IN",ew:"LIKE",en:"NOT LIKE",cn:"LIKE",nc:"NOT LIKE",nu:"IS NULL",nn:"IS NOT NULL"}},C.getGridRes.call(u,"search"),v.search||{},n.searching||{},p||{}),g="fbox_"+n.id,h=c.commonIconClass,f={themodal:"searchmod"+g,modalhead:"searchhd"+g,modalcontent:"searchcnt"+g,resizeAlso:g},
w="#"+F(f.themodal),D=n.gBox,d=n.gView,r=a.each,q=n.postData[c.sFilter],t=function(){var b=a.makeArray(arguments);b.unshift("Search");b.unshift("Filter");b.unshift(c);return ja.apply(e,b)},B=function(){v.hideModal(w,{gb:D,jqm:c.jqModal,onClose:c.onClose,removemodal:c.removemodal})};"string"===typeof q&&(q=""!==a.trim(q)?a.parseJSON(q):void 0);a(w).remove();if(void 0!==a(w)[0])R(a("#fbox_"+n.idSel));else{var H=a("<div><div id='"+g+"' class='"+K.call(e,"dialog.body","searchFilter")+"' style='overflow:auto'></div></div>").insertBefore(d);
"rtl"===n.direction&&H.attr("dir","rtl");var I="",b="",y,J=!1,x,E=-1,l=a.extend([],n.colModel);x=M.call(e,g+"_search",c.Find,V(h,c.findDialogIcon),"right");var L=M.call(e,g+"_reset",c.Reset,V(h,c.resetDialogIcon),"left");c.showQuery&&(I=M.call(e,g+"_query","Query",V(h,c.queryDialogIcon),"left")+"&#160;");c.searchForAdditionalProperties&&r(n.additionalProperties,function(){var a="string"===typeof this?{name:this}:this;a.label||(a.label=a.name);a.isAddProp=!0;l.push(a)});c.columns.length?(l=c.columns,
E=0,y=l[0].index||l[0].name):r(l,function(a,b){b.label||(b.label=b.isAddProp?b.name:n.colNames[a]);if(!J){var c=void 0===b.search?!0:b.search,g=!0===b.hidden;if(b.searchoptions&&!0===b.searchoptions.searchhidden&&c||c&&!g)J=!0,y=b.index||b.name,E=a}});if(!q&&y||!1===c.multipleSearch)h="eq",0<=E&&l[E].searchoptions&&l[E].searchoptions.sopt?h=l[E].searchoptions.sopt[0]:c.sopt&&c.sopt.length&&(h=c.sopt[0]),q={groupOp:"AND",rules:[{field:y,op:h,data:""}]};J=!1;c.tmplNames&&c.tmplNames.length&&(J=!0,b=
c.tmplLabel,b+="<select class='ui-template'>",b+="<option value='default'>Default</option>",r(c.tmplNames,function(a,c){b+="<option value='"+a+"'>"+c+"</option>"}),b+="</select>");x="<div class='"+K.call(e,"dialog.footer")+"'><table class='EditTable' style='border:0px none;margin-top:5px' id='"+g+"_2'><tbody><tr><td colspan='2'><hr class='"+K.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='EditButton EditButton-"+n.direction+"'  style='float:"+("rtl"===n.direction?"right":"left")+
";'>"+L+b+"</td><td class='EditButton EditButton-"+n.direction+"'>"+I+x+"</td></tr></tbody></table></div>";g=F(g);c.gbox=D;c.height="auto";g="#"+g;a(g).jqFilter({columns:l,filter:c.loadDefaults?q:null,showQuery:c.showQuery,errorcheck:c.errorcheck,sopt:c.sopt,groupButton:c.multipleGroup,ruleButtons:c.multipleSearch,afterRedraw:c.afterRedraw,ops:c.odata,cops:n.customSortOperations,operands:c.operands,ajaxSelectOptions:n.ajaxSelectOptions,groupOps:c.groupOps,onChange:function(){this.p.showQuery&&a(".query",
this).html(this.toUserFriendlyString());ka.call(e,c.afterChange,"jqGridFilterAfterChange",a(g),c)},direction:n.direction,id:n.id});H.append(x);J&&c.tmplFilters&&c.tmplFilters.length&&a(".ui-template",H).bind("change",function(){var b=a(this).val();"default"===b?a(g).jqFilter("addFilter",q):a(g).jqFilter("addFilter",c.tmplFilters[parseInt(b,10)]);return!1});!0===c.multipleGroup&&(c.multipleSearch=!0);t("onInitialize",a(g));c.layer?v.createModal.call(e,f,H,c,d,a(D)[0],"#"+F(c.layer),{position:"relative"}):
v.createModal.call(e,f,H,c,d,a(D)[0]);(c.searchOnEnter||c.closeOnEscape)&&a(w).keydown(function(b){var d=a(b.target);if(!(!c.searchOnEnter||13!==b.which||d.hasClass("add-group")||d.hasClass("add-rule")||d.hasClass("delete-group")||d.hasClass("delete-rule")||d.hasClass("fm-button")&&d.is("[id$=_query]")))return a(g+"_search").click(),!1;if(c.closeOnEscape&&27===b.which)return a("#"+F(f.modalhead)).find(".ui-jqdialog-titlebar-close").click(),!1});I&&a(g+"_query").bind("click",function(){a(".queryresult",
H).toggle();return!1});void 0===c.stringResult&&(c.stringResult=c.multipleSearch);a(g+"_search").bind("click",function(){var b={},d,f,t=a(g);f=t.find(".input-elm");f.filter(":focus")&&(f=f.filter(":focus"));f.change();f=t.jqFilter("filterData");if(c.errorcheck&&(t[0].hideError(),c.showQuery||t.jqFilter("toSQLString"),t[0].p.error))return t[0].showError(),!1;if(c.stringResult||"local"===n.datatype){try{d=xmlJsonClass.toJson(f,"","",!1)}catch(l){try{d=JSON.stringify(f)}catch(k){}}"string"===typeof d&&
(b[c.sFilter]=d,r([c.sField,c.sValue,c.sOper],function(){b[this]=""}))}else c.multipleSearch?(b[c.sFilter]=f,r([c.sField,c.sValue,c.sOper],function(){b[this]=""})):(b[c.sField]=f.rules[0].field,b[c.sValue]=f.rules[0].data,b[c.sOper]=f.rules[0].op,b[c.sFilter]="");n.search=!0;a.extend(n.postData,b);ka.call(e,c.onSearch,"jqGridFilterSearch",n.filters)&&u.trigger("reloadGrid",[a.extend({page:1},c.reloadGridSearchOptions||{})]);c.closeAfterSearch&&B();return!1});a(g+"_reset").bind("click",function(){var b=
{},d=a(g);n.search=!1;n.resetsearch=!0;!1===c.multipleSearch?b[c.sField]=b[c.sValue]=b[c.sOper]="":b[c.sFilter]="";d[0].resetFilter();J&&a(".ui-template",H).val("default");a.extend(n.postData,b);ka.call(e,c.onReset,"jqGridFilterReset")&&u.trigger("reloadGrid",[a.extend({page:1},c.reloadGridResetOptions||{})]);c.closeAfterReset&&B();return!1});R(a(g));var z=P.call(e,"hover");a(".fm-button:not(."+P.call(e,"disabled").split(" ").join(".")+")",H).hover(function(){a(this).addClass(z)},function(){a(this).removeClass(z)})}}})},
editGridRow:function(p,R){return this.each(function(){function e(){a(E+" > tbody > tr > td .FormElement").each(function(){var m=a(".customelement",this),c=this.name;if(m.length){if(c=m.attr("name"),m=ea[c],void 0!==m&&(m=O[m],m=m.editoptions||{},a.isFunction(m.custom_value))){try{if(k[c]=m.custom_value.call(r,a("#"+F(c),E),"get"),void 0===k[c])throw"e1";}catch(d){"e1"===d?v.info_dialog.call(r,fa,"function 'custom_value' "+b.msg.novalue,b.bClose):v.info_dialog.call(r,fa,d.message,b.bClose)}return!0}}else switch(m=
a(this)[0].type,m){case "checkbox":k[c]=a(this).is(":checked")?a(this).val():a(this).data("offval");break;case "select-one":k[c]=a("option:selected",this).val();break;case "select-multiple":k[c]=a(this).val();k[c]=k[c]?k[c].join(","):"";a("option:selected",this).each(function(b,m){a(m).text()});break;case "date":k[c]=a(this).val();3===String(k[c]).split("-").length&&(m=ea[c],void 0!==m&&(m=O[m],m=m.formatoptions||{},m=m.newformat||H.call(q,"formatter.date.newformat"),k[c]=v.parseDate.call(q[0],"Y-m-d",
k[c],m)));break;default:void 0!==m&&0>a.inArray(m,b.skipPostTypes)&&(k[c]=a(this).val())}});return!0}function u(m,c,d){var g=0,A=[],e=!1,k="",f;for(f=1;f<=d;f++)k+="<td class='CaptionTD'>&#160;</td><td class='DataTD'>&#160;</td>";"_empty"!==m&&(e=C.getInd.call(q,m));a(O).each(function(f){var n=this.name,l,h,p,u,q;l=this.editable;var w=!1,x=!1;q="_empty"===m?"addForm":"editForm";a.isFunction(l)&&(l=l.call(r,{rowid:m,iCol:f,iRow:e,cmName:n,cm:this,mode:q}));u=(this.editrules&&!0===this.editrules.edithidden?
0:!0===this.hidden||"hidden"===l)?"style='display:none'":"";switch(String(l).toLowerCase()){case "hidden":l=!0;break;case "disabled":w=l=!0;break;case "readonly":x=l=!0}if("cb"!==n&&"subgrid"!==n&&!0===l&&"rn"!==n){if(!1===e)p="";else{l=a(r.rows[e].cells[f]);try{p=a.unformat.call(r,l,{rowId:m,colModel:this},f)}catch(S){p=this.edittype&&"textarea"===this.edittype?l.text():l.html()}da(p)&&(p="")}l=a.extend({},this.editoptions||{},{id:n,name:n,rowId:m,mode:q,cm:this,iCol:f});var G=a.extend({},{elmprefix:"",
elmsuffix:"",rowabove:!1,rowcontent:""},this.formoptions||{}),z=parseInt(G.rowpos,10)||g+1,L=parseInt(2*(parseInt(G.colpos,10)||1),10);"_empty"===m&&l.defaultValue&&(p=a.isFunction(l.defaultValue)?l.defaultValue.call(r):l.defaultValue);this.edittype||(this.edittype="text");t.autoEncodeOnEdit&&(p=v.oldDecodePostedData(p));q=v.createEl.call(r,this.edittype,l,p,!1,a.extend({},v.ajaxOptions,t.ajaxSelectOptions||{}));if(b.checkOnSubmit||b.checkOnUpdate)b._savedData[n]=p;a(q).addClass("FormElement");-1<
a.inArray(this.edittype,["text","textarea","checkbox","password","select"])&&a(q).addClass(K.call(r,"dialog.dataField"));h=a(c).find("tr[data-rowpos="+z+"]");if(G.rowabove){var C=a("<tr><td class='contentinfo' colspan='"+2*d+"'>"+G.rowcontent+"</td></tr>");a(c).append(C);C[0].rp=z}0===h.length&&(h=a("<tr "+u+" data-rowpos='"+z+"'></tr>").addClass("FormData").attr("id","tr_"+n),a(h).append(k),a(c).append(h),h[0].rp=z);u=a("td:eq("+(L-2)+")",h[0]);h=a("td:eq("+(L-1)+")",h[0]);u.html(void 0===G.label?
t.colNames[f]:G.label||"&#160;");h[da(h.html())?"html":"append"](G.elmprefix).append(q).append(G.elmsuffix);w?(u.addClass(U),h.addClass(U),a(q).prop("readonly",!0),a(q).prop("disabled",!0)):x&&a(q).prop("readonly",!0);"custom"===this.edittype&&a.isFunction(l.custom_value)&&l.custom_value.call(r,a("#"+F(n),y),"set",p);v.bindEv.call(r,q,l);A[g]=f;g++}});0<g&&(f=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*d-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='"+
B+"_id' value='"+m+"'/></td></tr>"),f[0].rp=g+999,a(c).append(f),b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[B+"_id"]=m);return A}function n(m,c){var d,g=0,e,A,f,l;if(b.checkOnSubmit||b.checkOnUpdate)b._savedData={},b._savedData[B+"_id"]=m;var k=t.colModel;if("_empty"===m)a(k).each(function(){d=this.name;A=a.extend({},this.editoptions||{});(e=a("#"+F(d),c))&&e.length&&null!==e[0]&&(f="","custom"===this.edittype&&a.isFunction(A.custom_value)?A.custom_value.call(r,e,"set",f):A.defaultValue?(f=
a.isFunction(A.defaultValue)?A.defaultValue.call(r):A.defaultValue,"checkbox"===e[0].type?(l=f.toLowerCase(),0>l.search(/(false|f|0|no|n|off|undefined)/i)&&""!==l?(e[0].checked=!0,e[0].defaultChecked=!0,e[0].value=f):(e[0].checked=!1,e[0].defaultChecked=!1)):e.val(f)):"checkbox"===e[0].type?(e[0].checked=!1,e[0].defaultChecked=!1,f=a(e).data("offval")):e[0].type&&"select"===e[0].type.substr(0,6)?e[0].selectedIndex=0:e.val(f),!0===b.checkOnSubmit||b.checkOnUpdate)&&(b._savedData[d]=f)}),a("#id_g",
c).val(m);else{var n=C.getInd.call(q,m,!0);n&&(a(n.cells).filter("td[role=gridcell]").each(function(e){var f;d=k[e].name;if("cb"!==d&&"subgrid"!==d&&"rn"!==d&&!0===k[e].editable){try{f=a.unformat.call(r,a(this),{rowId:m,colModel:k[e]},e)}catch(A){f="textarea"===k[e].edittype?a(this).text():a(this).html()}t.autoEncodeOnEdit&&(f=v.oldDecodePostedData(f));if(!0===b.checkOnSubmit||b.checkOnUpdate)b._savedData[d]=f;d="#"+F(d);switch(k[e].edittype){case "password":case "text":case "button":case "image":case "textarea":da(f)&&
(f="");a(d,c).val(f);break;case "select":var l=f.split(","),l=a.map(l,function(b){return a.trim(b)});a(d+" option",c).each(function(){var b=a(this),m=a.trim(b.val()),b=a.trim(b.text());k[e].editoptions.multiple||a.trim(f)!==b&&l[0]!==b&&l[0]!==m?k[e].editoptions.multiple?-1<a.inArray(b,l)||-1<a.inArray(m,l)?this.selected=!0:this.selected=!1:this.selected=!1:this.selected=!0});break;case "checkbox":f=String(f);k[e].editoptions&&k[e].editoptions.value?f=k[e].editoptions.value.split(":")[0]===f:(f=f.toLowerCase(),
f=0>f.search(/(false|f|0|no|n|off|undefined)/i)&&""!==f);a(d,c).prop({checked:f,defaultChecked:f});break;case "custom":try{if(k[e].editoptions&&a.isFunction(k[e].editoptions.custom_value))k[e].editoptions.custom_value.call(r,a(d,c),"set",f);else throw"e1";}catch(A){"e1"===A?v.info_dialog.call(r,fa,"function 'custom_value' "+b.msg.nodefined,b.bClose):v.info_dialog.call(r,fa,A.message,b.bClose)}}g++}}),0<g&&a("#id_g",E).val(m))}}function c(){var m=b.url||t.editurl;a.each(O,function(b,c){var d=c.name,
e=k[d];"date"!==c.formatter||null!=c.formatoptions&&!0===c.formatoptions.sendFormatted||(k[d]=a.unformat.date.call(r,e,c));"clientArray"!==m&&c.editoptions&&!0===c.editoptions.NullIfEmpty&&k.hasOwnProperty(d)&&""===e&&(k[d]="null")})}function g(){var m=[!0,"",""],d={},e=t.prmNames,f,g,h,u,w,G,x=C.getInd.call(q,p),S=!1===x?null:r.rows[x];(G=q.triggerHandler("jqGridAddEditBeforeCheckValues",[a(y),A]))&&"object"===typeof G&&(k=G);x=!1===x?-1:x;a.isFunction(b.beforeCheckValues)&&(G=b.beforeCheckValues.call(r,
k,a(y),A))&&"object"===typeof G&&(k=G);for(h in k)if(k.hasOwnProperty(h)&&(G=t.iColByName[h],m=v.checkValues.call(r,k[h],h,void 0,void 0,{oldValue:"_empty"===p?null:C.getCell.call(q,p,G),newValue:k[h],cmName:h,rowid:p,cm:O[G],iCol:G,iRow:x,tr:S,td:null==S?null:S.cells[G],mode:"_empty"===p?"addForm":"editForm"}),!1===m[0]))break;c();m[0]&&(d=q.triggerHandler("jqGridAddEditClickSubmit",[b,k,A]),void 0===d&&a.isFunction(b.onclickSubmit)&&(d=b.onclickSubmit.call(r,b,k,A)||{}),m=q.triggerHandler("jqGridAddEditBeforeSubmit",
[k,a(y),A]),null==m&&(m=[!0,"",""]),m[0]&&a.isFunction(b.beforeSubmit)&&(m=b.beforeSubmit.call(r,k,a(y),A),null==m&&(m=[!0,"",""])));if(m[0]&&!b.processing){b.processing=!0;a("#sData",l).addClass(Z);h=b.url||t.editurl;g=e.oper;f="clientArray"===h&&!1!==t.keyName?t.keyName:e.id;k[g]="_empty"===a.trim(k[B+"_id"])?e.addoper:e.editoper;k[g]!==e.addoper?k[f]=k[B+"_id"]:void 0===k[f]&&(k[f]=k[B+"_id"]);delete k[B+"_id"];k=a.extend(k,b.editData,d);if(!0===t.treeGrid)for(w in k[g]===e.addoper&&(u=t.selrow,
k["adjacency"===t.treeGridModel?t.treeReader.parent_id_field:"parent_id"]=u),t.treeReader)t.treeReader.hasOwnProperty(w)&&(d=t.treeReader[w],!k.hasOwnProperty(d)||k[g]===e.addoper&&"parent_id_field"===w||delete k[d]);k[f]=v.stripPref(t.idPrefix,k[f]);t.autoEncodeOnEdit&&a.each(k,function(b,m){a.isFunction(m)||(k[b]=v.oldEncodePostedData(m))});w=a.extend({url:a.isFunction(h)?h.call(r,k[f],A,k,b):h,type:a.isFunction(b.mtype)?b.mtype.call(r,A,b,k[f],k):b.mtype,data:v.serializeFeedback.call(r,a.isFunction(b.serializeEditData)?
b.serializeEditData:t.serializeEditData,"jqGridAddEditSerializeEditData",k),complete:function(c,d){a("#sData",l).removeClass(Z);k[f]=a("#id_g",E).val();300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(m[0]=!1,m[1]=q.triggerHandler("jqGridAddEditErrorTextFormat",[c,A]),a.isFunction(b.errorTextFormat)?m[1]=b.errorTextFormat.call(r,c,A):m[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):(m=q.triggerHandler("jqGridAddEditAfterSubmit",[c,k,A]),null==m&&(m=[!0,"",""]),m[0]&&a.isFunction(b.afterSubmit)&&
(m=b.afterSubmit.call(r,c,k,A),null==m&&(m=[!0,"",""])));if(!1===m[0])a("#FormError>td",E).html(m[1]),a("#FormError",E).show();else{t.autoEncodeOnEdit&&a.each(k,function(a,b){k[a]=v.oldDecodePostedData(b)});var h=[a.extend({},b.reloadGridOptions||{})];k[g]===e.addoper?(m[2]||(m[2]=v.randId()),null==k[f]||"_empty"===k[f]||k[g]===e.addoper?k[f]=m[2]:m[2]=k[f],b.reloadAfterSubmit?q.trigger("reloadGrid",h):!0===t.treeGrid?C.addChildNode.call(q,m[2],u,k):C.addRowData.call(q,m[2],k,b.addedrow),b.closeAfterAdd?
(!0!==t.treeGrid&&I.call(q,m[2]),X()):b.clearAfterAdd&&n("_empty",y)):(b.reloadAfterSubmit?(q.trigger("reloadGrid",h),b.closeAfterEdit||setTimeout(function(){I.call(q,k[f])},1E3)):!0===t.treeGrid?C.setTreeRow.call(q,k[f],k):C.setRowData.call(q,k[f],k),b.closeAfterEdit&&X());if(a.isFunction(b.afterComplete)){var p=c;setTimeout(function(){q.triggerHandler("jqGridAddEditAfterComplete",[p,k,a(y),A]);b.afterComplete.call(r,p,k,a(y),A);p=null},50)}if(b.checkOnSubmit||b.checkOnUpdate)if(a(y).data("disabled",
!1),"_empty"!==b._savedData[B+"_id"])for(var w in b._savedData)b._savedData.hasOwnProperty(w)&&k[w]&&(b._savedData[w]=k[w])}b.processing=!1;try{a(":input:visible",y)[0].focus()}catch(G){}}},v.ajaxOptions,b.ajaxEditOptions);w.url||b.useDataProxy||(a.isFunction(t.dataProxy)?b.useDataProxy=!0:(m[0]=!1,m[1]+=" "+v.errors.nourl));m[0]&&(b.useDataProxy?(d=t.dataProxy.call(r,w,"set_"+B),void 0===d&&(d=[!0,""]),!1===d[0]?(m[0]=!1,m[1]=d[1]||"Error deleting the selected row!"):(w.data.oper===e.addoper&&b.closeAfterAdd&&
X(),w.data.oper===e.editoper&&b.closeAfterEdit&&X())):"clientArray"===w.url?(b.reloadAfterSubmit=!1,k=w.data,w.complete({status:200,statusText:""},"")):a.ajax(w))}!1===m[0]&&(a("#FormError>td",E).html(m[1]),a("#FormError",E).show())}function h(a,b){var c=!1,d;for(d in a)if(a.hasOwnProperty(d)&&String(a[d])!==String(b[d])){c=!0;break}return c}function f(){var c=!0;a("#FormError",E).hide();b.checkOnUpdate&&(k={},e(),aa=h(k,b._savedData))&&(a(y).data("disabled",!0),a(".confirm",z).show(),c=!1);return c}
function w(){var b=v.detectRowEditing.call(r,p);if(null!=b)if("inlineEditing"===b.mode)C.restoreRow.call(q,p);else{var b=b.savedRow,c=r.rows[b.id];C.restoreCell.call(q,b.id,b.ic);a(c.cells[b.ic]).removeClass("edit-cell "+oa);a(c).addClass(oa).attr({"aria-selected":"true",tabindex:"0"})}}function D(b,c){var d=c[1].length-1;0===b?a("#pData",l).addClass(U):void 0!==c[1][b-1]&&T(a("#"+F(c[1][b-1])),U)?a("#pData",l).addClass(U):a("#pData",l).removeClass(U);b===d?a("#nData",l).addClass(U):void 0!==c[1][b+
1]&&T(a("#"+F(c[1][b+1])),U)?a("#nData",l).addClass(U):a("#nData",l).removeClass(U)}function d(){var b=C.getDataIDs.call(q),c=a("#id_g",E).val();return[a.inArray(c,b),b]}var r=this,q=a(r),t=r.p;if(r.grid&&null!=t&&p){var B=t.id,H=C.getGridRes,I=C.setSelection,b=a.extend(!0,{top:0,left:0,width:300,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,url:null,mtype:"POST",clearAfterAdd:!0,closeAfterEdit:!1,reloadAfterSubmit:!0,onInitializeForm:null,beforeInitData:null,beforeShowForm:null,
afterShowForm:null,beforeSubmit:null,afterSubmit:null,onclickSubmit:null,afterComplete:null,onclickPgButtons:null,afterclickPgButtons:null,editData:{},closeOnEscape:!1,addedrow:"first",topinfo:"",bottominfo:"",savekey:[!1,13],navkeys:[!1,38,40],checkOnSubmit:!1,checkOnUpdate:!1,_savedData:{},processing:!1,onClose:null,ajaxEditOptions:{},serializeEditData:null,viewPagerButtons:!0,overlayClass:K.call(this,"overlay"),removemodal:!0,skipPostTypes:["image","file"]},H.call(q,"edit"),v.edit,t.formEditing||
{},R||{}),y="FrmGrid_"+B,J=y,x="TblGrid_"+B,E="#"+F(x),l=E+"_2",L={themodal:"editmod"+B,modalhead:"edithd"+B,modalcontent:"editcnt"+B,resizeAlso:y},z="#"+F(L.themodal),N=t.gBox,O=t.colModel,ea=t.iColByName,Q=1,W=0,k,aa,A,G=b.commonIconClass,X=function(){v.hideModal(z,{gb:N,jqm:b.jqModal,onClose:b.onClose,removemodal:b.removemodal})},fa=H.call(q,"errors.errcap"),Y=function(){var c=a.makeArray(arguments);c.unshift("");c.unshift("AddEdit");c.unshift(b);return ja.apply(r,c)},pa=P.call(r,"hover"),U=P.call(r,
"disabled"),oa=P.call(r,"select"),Z=P.call(r,"active"),S=P.call(r,"error");a(z).remove();y="#"+F(y);"new"===p?(p="_empty",A="add",b.caption=b.addCaption):(b.caption=b.editCaption,A="edit");var ia=!0;!b.checkOnUpdate||!0!==b.jqModal&&void 0!==b.jqModal||b.modal||(ia=!1);var ga=isNaN(b.dataheight)?b.dataheight:b.dataheight+"px",ba=isNaN(b.datawidth)?b.datawidth:b.datawidth+"px",J=a("<form name='FormPost' id='"+J+"' class='FormGrid' onSubmit='return false;' style='width:"+ba+";overflow:auto;position:relative;height:"+
ga+";'></form>").data("disabled",!1),ha=a("<table id='"+x+"' class='EditTable'><tbody></tbody></table>");a(O).each(function(){var a=this.formoptions;Q=Math.max(Q,a?a.colpos||0:0);W=Math.max(W,a?a.rowpos||0:0)});a(J).append(ha);S=a("<tr id='FormError' style='display:none'><td class='"+S+"' colspan='"+2*Q+"'>&#160;</td></tr>");S[0].rp=0;a(ha).append(S);S=a("<tr style='display:none' class='tinfo'><td class='topinfo' colspan='"+2*Q+"'>"+(b.topinfo||"&#160;")+"</td></tr>");S[0].rp=0;a(ha).append(S);if(Y("beforeInitData",
J,A)){w();ga=(S="rtl"===t.direction?!0:!1)?"nData":"pData";ba=S?"pData":"nData";u(p,ha,Q);var ga=M.call(r,ga,"",V(G,b.prevIcon),"","left"),ba=M.call(r,ba,"",V(G,b.nextIcon),"","right"),la=M.call(r,"sData",b.bSubmit),ma=M.call(r,"cData",b.bCancel),x="<div class='"+K.call(r,"dialog.footer")+"'><table class='EditTable' id='"+x+"_2'><tbody><tr><td colspan='2'><hr class='"+K.call(r,"dialog.hr")+"' style='margin:1px'/></td></tr><tr id='Act_Buttons'><td class='navButton navButton-"+t.direction+"'>"+(S?ba+
ga:ga+ba)+"</td><td class='EditButton EditButton-"+t.direction+"'>"+la+"&#160;"+ma+"</td></tr>",x=x+("<tr style='display:none' class='binfo'><td class='bottominfo' colspan='2'>"+(b.bottominfo||"&#160;")+"</td></tr>"),x=x+"</tbody></table></div>";if(0<W){var na=[];a.each(a(ha)[0].rows,function(a,b){na[a]=b});na.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(na,function(b,c){a("tbody",ha).append(c)})}b.gbox=N;var qa=!1;!0===b.closeOnEscape&&(b.closeOnEscape=!1,qa=!0);x=a("<div></div>").append(a("<div class='"+
K.call(r,"dialog.body")+"'></div>").append(J)).append(x);v.createModal.call(r,L,x,b,t.gView,a(N)[0]);b.topinfo&&a(".tinfo",E).show();b.bottominfo&&a(".binfo",l).show();x=x=null;a(z).keydown(function(c){var d=(c.target.tagName||"").toUpperCase(),e,g;if(!0===a(y).data("disabled"))return!1;if(13===c.which&&"TEXTAREA"!==d){e=a(l).find(":focus");g=e.attr("id");if(0<e.length&&0<=a.inArray(g,["pData","nData","cData"]))return e.trigger("click"),!1;if(!0===b.savekey[0]&&13===b.savekey[1])return a("#sData",
l).trigger("click"),!1}if(!0===b.savekey[0]&&c.which===b.savekey[1]&&"TEXTAREA"!==d)return a("#sData",l).trigger("click"),!1;if(27===c.which){if(!f())return!1;qa&&X();return!1}if(!0===b.navkeys[0]){if("_empty"===a("#id_g",E).val())return!0;if(c.which===b.navkeys[1])return a("#pData",l).trigger("click"),!1;if(c.which===b.navkeys[2])return a("#nData",l).trigger("click"),!1}});b.checkOnUpdate&&(a("a.ui-jqdialog-titlebar-close span",z).removeClass("jqmClose"),a("a.ui-jqdialog-titlebar-close",z).unbind("click").click(function(){if(!f())return!1;
X();return!1}));ca(a("#sData",l),b.saveicon,G);ca(a("#cData",l),b.closeicon,G);if(b.checkOnSubmit||b.checkOnUpdate)la=M.call(r,"sNew",b.bYes),ba=M.call(r,"nNew",b.bNo),ma=M.call(r,"cNew",b.bExit),L=b.zIndex||999,L++,a("<div class='"+b.overlayClass+" jqgrid-overlay confirm' style='z-index:"+L+";display:none;'>&#160;</div><div class='"+K.call(r,"dialog.content","confirm ui-jqconfirm")+"' style='z-index:"+(L+1)+"'>"+b.saveData+"<br/><br/>"+la+ba+ma+"</div>").insertAfter(y),a("#sNew",z).click(function(){g();
a(y).data("disabled",!1);a(".confirm",z).hide();return!1}),a("#nNew",z).click(function(){a(".confirm",z).hide();a(y).data("disabled",!1);setTimeout(function(){a(":input:visible",y)[0].focus()},0);return!1}),a("#cNew",z).click(function(){a(".confirm",z).hide();a(y).data("disabled",!1);X();return!1});Y("onInitializeForm",a(y),A);"_empty"!==p&&b.viewPagerButtons?a("#pData,#nData",l).show():a("#pData,#nData",l).hide();Y("beforeShowForm",a(y),A);a(z).data("onClose",b.onClose);v.viewModal.call(r,z,{gbox:N,
jqm:b.jqModal,overlay:b.overlay,modal:b.modal,overlayClass:b.overlayClass,toTop:b.toTop,onHide:function(a){a.w.remove();a.o&&a.o.remove()}});ia||a("."+F(b.overlayClass)).click(function(){if(!f())return!1;X();return!1});a(".fm-button",z).hover(function(){a(this).addClass(pa)},function(){a(this).removeClass(pa)});a("#sData",l).click(function(){k={};a("#FormError",E).hide();e();"_empty"===k[B+"_id"]?g():!0===b.checkOnSubmit?(aa=h(k,b._savedData))?(a(y).data("disabled",!0),a(".confirm",z).show()):g():
g();return!1});a("#cData",l).click(function(){if(!f())return!1;X();return!1});a("#nData",l).click(function(){if(!f())return!1;a("#FormError",E).hide();var b=d();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!Y("onclickPgButtons","next",a(y),b[1][b[0]]))return!1;n(b[1][b[0]+1],y);I.call(q,b[1][b[0]+1]);Y("afterclickPgButtons","next",a(y),b[1][b[0]+1]);D(b[0]+1,b)}return!1});a("#pData",l).click(function(){if(!f())return!1;a("#FormError",E).hide();var b=d();if(-1!==b[0]&&b[1][b[0]-1]){if(!Y("onclickPgButtons",
"prev",a(y),b[1][b[0]])||T(a("#"+F(b[1][b[0]-1])),U))return!1;n(b[1][b[0]-1],y);I.call(q,b[1][b[0]-1]);Y("afterclickPgButtons","prev",a(y),b[1][b[0]-1]);D(b[0]-1,b)}return!1});Y("afterShowForm",a(y),A);ia=d();D(ia[0],ia)}}})},viewGridRow:function(p,R){return this.each(function(){function e(){!0!==d.closeOnEscape&&!0!==d.navkeys[0]||setTimeout(function(){a("#cData").focus()},0)}function u(b,c,e){var g,k,l,n=0,r,p,t=[],u=C.getInd.call(f,b),q;q=K.call(h,"dialog.viewData","DataTD form-view-data");var x=
K.call(h,"dialog.viewLabel","CaptionTD form-view-label"),y="<td class='"+x+"' width='"+d.labelswidth+"'>&#160;</td><td class='"+q+" ui-helper-reset'>&#160;</td>",z="",x="<td class='"+x+"'></td><td class='"+q+"'></td>",L=["integer","number","currency"],D=0,B=0,m,E,F;for(q=1;q<=e;q++)z+=1===q?y:x;a(J).each(function(){(k=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)||"right"!==this.align||(this.formatter&&-1!==a.inArray(this.formatter,L)?D=Math.max(D,parseInt(this.width,10)):
B=Math.max(B,parseInt(this.width,10)))});m=0!==D?D:0!==B?B:0;a(J).each(function(b){g=this.name;E=!1;p=(k=this.editrules&&!0===this.editrules.edithidden?!1:!0===this.hidden?!0:!1)?"style='display:none'":"";F="boolean"!==typeof this.viewable?!0:this.viewable;if("cb"!==g&&"subgrid"!==g&&"rn"!==g&&F){r=!1===u?"":v.getDataFieldOfCell.call(h,h.rows[u],b).html();E="right"===this.align&&0!==m?!0:!1;var d=a.extend({},{rowabove:!1,rowcontent:""},this.formoptions||{}),f=parseInt(d.rowpos,10)||n+1,A=parseInt(2*
(parseInt(d.colpos,10)||1),10);if(d.rowabove){var q=a("<tr><td class='contentinfo' colspan='"+2*e+"'>"+d.rowcontent+"</td></tr>");a(c).append(q);q[0].rp=f}l=a(c).find("tr[data-rowpos="+f+"]");0===l.length&&(l=a("<tr "+p+" data-rowpos='"+f+"'></tr>").addClass("FormData").attr("id","trv_"+g),a(l).append(z),a(c).append(l),l[0].rp=f);d=void 0===d.label?w.colNames[b]:d.label;f=a("td:eq("+(A-1)+")",l[0]);a("td:eq("+(A-2)+")",l[0]).html("<b>"+(d||"&nbsp;")+"</b>");f[da(f.html())?"html":"append"]("<span>"+
(r||"&nbsp;")+"</span>").attr("id","v_"+g);E&&a("td:eq("+(A-1)+") span",l[0]).css({"text-align":"right",width:m+"px"});t[n]=b;n++}});0<n&&(b=a("<tr class='FormData' style='display:none'><td class='CaptionTD'>&#160;</td><td colspan='"+(2*e-1)+"' class='DataTD'><input class='FormElement' id='id_g' type='text' name='id' value='"+b+"'/></td></tr>"),b[0].rp=n+99,a(c).append(b));return t}function n(b){var c,d,e=0,g=C.getInd.call(f,b,!0),l;g&&(a("td",g).each(function(b){l=J[b];c=l.name;d=l.editrules&&!0===
l.editrules.edithidden?!1:!0===l.hidden?!0:!1;"cb"!==c&&"subgrid"!==c&&"rn"!==c&&(c=F("v_"+c),a("#"+c+" span",q).html(v.getDataFieldOfCell.call(h,g,b).html()),d&&a("#"+c,q).parents("tr:first").hide(),e++)}),0<e&&a("#id_g",q).val(b))}function c(b,c){var d=c[1].length-1;0===b?a("#pData",t).addClass(N):void 0!==c[1][b-1]&&T(a("#"+F(c[1][b-1])),N)?a("#pData",t).addClass(N):a("#pData",t).removeClass(N);b===d?a("#nData",t).addClass(N):void 0!==c[1][b+1]&&T(a("#"+F(c[1][b+1])),N)?a("#nData",t).addClass(N):
a("#nData",t).removeClass(N)}function g(){var b=C.getDataIDs.call(f),c=a("#id_g",q).val();return[a.inArray(c,b),b]}var h=this,f=a(h),w=h.p;if(h.grid&&null!=w&&p){var D=w.id,d=a.extend(!0,{top:0,left:0,width:0,datawidth:"auto",height:"auto",dataheight:"auto",drag:!0,resize:!0,closeOnEscape:!1,labelswidth:"30%",navkeys:[!1,38,40],onClose:null,beforeShowForm:null,beforeInitData:null,viewPagerButtons:!0,removemodal:!0},C.getGridRes.call(f,"view"),v.view||{},w.formViewing||{},R||{}),r="#ViewGrid_"+F(D),
q="#ViewTbl_"+F(D),t=q+"_2",B="ViewGrid_"+D,H="ViewTbl_"+D,I=d.commonIconClass,D={themodal:"viewmod"+D,modalhead:"viewhd"+D,modalcontent:"viewcnt"+D,resizeAlso:B},b="#"+F(D.themodal),y=w.gBox,J=w.colModel,x=1,E=0,l=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("View");b.unshift(d);return ja.apply(h,b)},L=function(){v.hideModal(b,{gb:y,jqm:d.jqModal,onClose:d.onClose,removemodal:d.removemodal})},z=P.call(h,"hover"),N=P.call(h,"disabled"),O=isNaN(d.dataheight)?d.dataheight:d.dataheight+
"px",ea=isNaN(d.datawidth)?d.datawidth:d.datawidth+"px",B=a("<div class='"+K.call(h,"dialog.body")+"'><form name='FormPost' id='"+B+"' class='FormGrid' style='width:"+ea+";overflow:auto;position:relative;height:"+O+";'></form></div>"),O=B.children("form.FormGrid"),Q=a("<table id='"+H+"' class='EditTable'><tbody></tbody></table>");a(b).remove();a(J).each(function(){var a=this.formoptions;x=Math.max(x,a?a.colpos||0:0);E=Math.max(E,a?a.rowpos||0:0)});O.append(Q);if(l("beforeInitData",O)){u(p,Q,x);var W=
(O="rtl"===w.direction?!0:!1)?"pData":"nData",ea=M.call(h,O?"nData":"pData","",V(I,d.prevIcon),"","left"),W=M.call(h,W,"",V(I,d.nextIcon),"","right"),k=M.call(h,"cData",d.bClose);if(0<E){var aa=[];a.each(a(Q)[0].rows,function(a,b){aa[a]=b});aa.sort(function(a,b){return a.rp>b.rp?1:a.rp<b.rp?-1:0});a.each(aa,function(b,c){a("tbody",Q).append(c)})}d.gbox=y;H=a("<div></div>").append(B).append("<div class='"+K.call(h,"dialog.footer")+"'><table border='0' class='EditTable' id='"+H+"_2'><tbody><tr id='Act_Buttons'><td class='navButton navButton-"+
w.direction+"' width='"+(d.labelswidth||"auto")+"'>"+(O?W+ea:ea+W)+"</td><td class='EditButton EditButton-"+w.direction+"'>"+k+"</td></tr></tbody></table></div>");v.createModal.call(h,D,H,d,w.gView,a(w.gView)[0]);d.viewPagerButtons||a("#pData, #nData",t).hide();H=null;a(b).keydown(function(b){var c,e;if(!0===a(r).data("disabled"))return!1;if(13===b.which&&(c=a(t).find(":focus"),e=c.attr("id"),0<c.length&&0<=a.inArray(e,["pData","nData","cData"])))return c.trigger("click"),!1;if(27===b.which)return d.closeOnEscape&&
L(),!1;if(!0===d.navkeys[0]){if(b.which===d.navkeys[1])return a("#pData",t).trigger("click"),!1;if(b.which===d.navkeys[2])return a("#nData",t).trigger("click"),!1}});ca(a("#cData",t),d.closeicon,I);l("beforeShowForm",a(r));v.viewModal.call(h,b,{gbox:y,jqm:d.jqModal,overlay:d.overlay,toTop:d.toTop,modal:d.modal,onHide:function(a){a.w.remove();a.o&&a.o.remove()}});a(".fm-button:not(."+N.split(" ").join(".")+")",t).hover(function(){a(this).addClass(z)},function(){a(this).removeClass(z)});e();a("#cData",
t).click(function(){L();return!1});a("#nData",t).click(function(){a("#FormError",q).hide();var b=g();b[0]=parseInt(b[0],10);if(-1!==b[0]&&b[1][b[0]+1]){if(!l("onclickPgButtons","next",a(r),b[1][b[0]]))return!1;n(b[1][b[0]+1]);C.setSelection.call(f,b[1][b[0]+1]);l("afterclickPgButtons","next",a(r),b[1][b[0]+1]);c(b[0]+1,b)}e();return!1});a("#pData",t).click(function(){a("#FormError",q).hide();var b=g();if(-1!==b[0]&&b[1][b[0]-1]){if(!l("onclickPgButtons","prev",a(r),b[1][b[0]]))return!1;n(b[1][b[0]-
1]);C.setSelection.call(f,b[1][b[0]-1]);l("afterclickPgButtons","prev",a(r),b[1][b[0]-1]);c(b[0]-1,b)}e();return!1});I=g();c(I[0],I)}}})},delGridRow:function(p,R){return this.each(function(){var e=this,u=e.p,n=a(e);if(e.grid&&null!=u&&p){var c=u.id,g=a.extend(!0,{top:0,left:0,width:240,removemodal:!0,height:"auto",dataheight:"auto",datawidth:"auto",drag:!0,resize:!0,url:"",mtype:"POST",reloadAfterSubmit:!0,beforeShowForm:null,beforeInitData:null,afterShowForm:null,beforeSubmit:null,onclickSubmit:null,
afterSubmit:null,closeOnEscape:!1,delData:{},onClose:null,ajaxDelOptions:{},processing:!1,serializeDelData:null,useDataProxy:!1},C.getGridRes.call(n,"del"),v.del||{},u.formDeleting||{},R||{}),h="DelTbl_"+c,f="#DelTbl_"+F(c),w,D,d,r,q={themodal:"delmod"+c,modalhead:"delhd"+c,modalcontent:"delcnt"+c,resizeAlso:h},t="#"+F(q.themodal),B=u.gBox,H=g.commonIconClass,I=function(){var b=a.makeArray(arguments);b.unshift("");b.unshift("Delete");b.unshift(g);return ja.apply(e,b)},b=P.call(e,"hover"),y=P.call(e,
"active"),J=P.call(e,"error");a.isArray(p)||(p=[String(p)]);if(void 0!==a(t)[0]){if(!I("beforeInitData",a(f)))return;a("#DelData>td",f).text(p.join()).data("rowids",p);a("#DelError",f).hide();!0===g.processing&&(g.processing=!1,a("#dData",f).removeClass(y));I("beforeShowForm",a(f));v.viewModal.call(e,t,{gbox:B,jqm:g.jqModal,jqM:!1,overlay:g.overlay,toTop:g.toTop,modal:g.modal})}else{var x=isNaN(g.dataheight)?g.dataheight:g.dataheight+"px",E=isNaN(g.datawidth)?g.datawidth:g.datawidth+"px",x="<div class='"+
K.call(e,"dialog.body")+"'><div id='"+h+"' class='formdata' style='width:"+E+";overflow:auto;position:relative;height:"+x+";'>",x=x+"<table class='DelTable'><tbody>"+("<tr id='DelError' style='display:none'><td class='"+J+"'></td></tr>"),x=x+("<tr id='DelData' style='display:none'><td >"+p.join()+"</td></tr>"),x=x+("<tr><td class='delmsg' style='white-space:pre;'>"+g.msg+"</td></tr>"),x=x+"</tbody></table></div></div>",J=M.call(e,"dData",g.bSubmit),E=M.call(e,"eData",g.bCancel),x=x+("<div class='"+
K.call(e,"dialog.footer")+"'><table class='EditTable' id='"+h+"_2'><tbody><tr><td><hr class='"+K.call(e,"dialog.hr")+"' style='margin:1px'/></td></tr><tr><td class='DelButton EditButton EditButton-"+u.direction+"'>"+J+"&#160;"+E+"</td></tr></tbody></table></div>");g.gbox=B;v.createModal.call(e,q,x,g,u.gView,a(u.gView)[0]);a("#DelData>td",f).data("rowids",p);if(!I("beforeInitData",a(x)))return;a(".fm-button",f+"_2").hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)});ca(a("#dData",
f+"_2"),g.delicon,H);ca(a("#eData",f+"_2"),g.cancelicon,H);a("#dData",f+"_2").click(function(){var b=[!0,""],h,p=a("#DelData>td",f),q=p.text(),x=p.data("rowids"),p={};a.isFunction(g.onclickSubmit)&&(p=g.onclickSubmit.call(e,g,q)||{});a.isFunction(g.beforeSubmit)&&(b=g.beforeSubmit.call(e,q)||b);if(b[0]&&!g.processing){g.processing=!0;d=u.prmNames;w=a.extend({},g.delData,p);r=d.oper;w[r]=d.deloper;D=d.id;q=x.slice();if(!q.length)return!1;for(h in q)q.hasOwnProperty(h)&&(q[h]=v.stripPref(u.idPrefix,
q[h]));w[D]=q.join();a(this).addClass(y);h=g.url||u.editurl;h=a.extend({url:a.isFunction(h)?h.call(e,w[D],w,g):h,type:g.mtype,data:a.isFunction(g.serializeDelData)?g.serializeDelData.call(e,w):w,complete:function(c,d){var h;a("#dData",f+"_2").removeClass(y);300<=c.status&&304!==c.status||0===c.status&&4===c.readyState?(b[0]=!1,a.isFunction(g.errorTextFormat)?b[1]=g.errorTextFormat.call(e,c):b[1]=d+" Status: '"+c.statusText+"'. Error code: "+c.status):a.isFunction(g.afterSubmit)&&(b=g.afterSubmit.call(e,
c,w)||[!0]);if(!1===b[0])a("#DelError>td",f).html(b[1]),a("#DelError",f).show();else{if(g.reloadAfterSubmit&&"local"!==u.datatype)n.trigger("reloadGrid",[a.extend({},g.reloadGridOptions||{})]);else if(!0===u.treeGrid)try{C.delTreeNode.call(n,x[0])}catch(k){}else for(x=x.slice(),h=0;h<x.length;h++)C.delRowData.call(n,x[h]);setTimeout(function(){I("afterComplete",c,q,a(f))},50)}g.processing=!1;b[0]&&v.hideModal(t,{gb:B,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal})}},v.ajaxOptions,g.ajaxDelOptions);
h.url||g.useDataProxy||(a.isFunction(u.dataProxy)?g.useDataProxy=!0:(b[0]=!1,b[1]+=" "+v.errors.nourl));b[0]&&(g.useDataProxy?(h=u.dataProxy.call(e,h,"del_"+c),void 0===h&&(h=[!0,""]),!1===h[0]?(b[0]=!1,b[1]=h[1]||"Error deleting the selected row!"):v.hideModal(t,{gb:B,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal})):"clientArray"===h.url?(w=h.data,h.complete({status:200,statusText:""},"")):a.ajax(h))}!1===b[0]&&(a("#DelError>td",f).html(b[1]),a("#DelError",f).show());return!1});a("#eData",
f+"_2").click(function(){v.hideModal(t,{gb:B,jqm:g.jqModal,onClose:g.onClose,removemodal:g.removemodal});return!1});I("beforeShowForm",a(f));v.viewModal.call(e,t,{gbox:B,jqm:g.jqModal,overlay:g.overlay,toTop:g.toTop,modal:g.modal})}I("afterShowForm",a(f));!0===g.closeOnEscape&&setTimeout(function(){a(".ui-jqdialog-titlebar-close","#"+F(q.modalhead)).attr("tabindex","-1").focus()},0)}})},navGrid:function(p,R,e,u,n,c,g){"object"===typeof p&&(g=c,c=n,n=u,u=e,e=R,R=p,p=void 0);u=u||{};e=e||{};g=g||{};
n=n||{};c=c||{};return this.each(function(){var h=this,f=h.p,w=a(h);if(h.grid&&null!=f&&!(h.nav&&0<a(p).find(".navtable").length)){var D=f.id,d=a.extend({edit:!0,add:!0,del:!0,search:!0,refresh:!0,refreshstate:"firstpage",view:!1,closeOnEscape:!0,beforeRefresh:null,afterRefresh:null,cloneToTop:!1,hideEmptyPagerParts:!0,alertwidth:200,alertheight:"auto",alerttop:null,removemodal:!0,alertleft:null,alertzIndex:null,iconsOverText:!1},C.getGridRes.call(w,"nav"),v.nav||{},f.navOptions||{},R||{});d.position=
d.position||("rtl"===f.direction?"right":"left");var r,q=f.idSel,t=f.gBox,B=d.commonIconClass,H={themodal:"alertmod_"+D,modalhead:"alerthd_"+D,modalcontent:"alertcnt_"+D},I=function(){return function(){var b=document.documentElement,c=window,e=1024,g=768,k=w.closest(".ui-jqgrid").offset();void 0===a("#"+F(H.themodal))[0]&&(d.alerttop||d.alertleft||(void 0!==c.innerWidth?(e=c.innerWidth,g=c.innerHeight):null!=b&&void 0!==b.clientWidth&&0!==b.clientWidth&&(e=b.clientWidth,g=b.clientHeight),e=e/2-parseInt(d.alertwidth,
10)/2-k.left,g=g/2-25-k.top),v.createModal.call(h,H,"<div class='"+K.call(h,"dialog.body")+"'><div>"+d.alerttext+"</div></div>",{gbox:t,jqModal:d.jqModal,drag:!0,resize:!0,caption:d.alertcap,top:null!=d.alerttop?d.alerttop:g,left:null!=d.alertleft?d.alertleft:e,width:d.alertwidth,height:d.alertheight,closeOnEscape:d.closeOnEscape,zIndex:d.alertzIndex,removemodal:d.removemodal},f.gView,a(t)[0],!1));v.viewModal.call(h,"#"+F(H.themodal),{gbox:t,toTop:d.alertToTop,jqm:d.jqModal});var l=a("#"+F(H.modalhead)).find(".ui-jqdialog-titlebar-close");
l.attr({tabindex:"0",href:"#",role:"button"});setTimeout(function(){l.focus()},50)}}(),b,y=function(b){if(13===b.which&&(b=a(this).find(".ui-pg-button").filter(":focus"),0<b.length)){var c=b[0].id,c=c.substr(0,0<a(this).closest(".ui-jqgrid-toppager").length?c.length-D.length-5:c.length-D.length-1)+"mod"+f.id,d=a(".ui-jqdialog").filter(":visible").map(function(){return this.id});if(0>a.inArray(c,d))return b.trigger("click"),!1}},J=P.call(h,"hover"),x=P.call(h,"disabled"),E=K.call(h,"navButton","ui-pg-button");
if(h.grid){h.modalAlert=I;void 0===p&&(f.pager?(p=f.pager,f.toppager&&(d.cloneToTop=!0)):f.toppager&&(p=f.toppager));var l=1,L,z,N,O,M,Q,W=["left","center","right"],k="<div class='"+K.call(h,"navButton","ui-pg-button "+P.call(h,"disabled"))+"'><span class='ui-separator'></span></div>",aa=function(){T(this,x)||a(this).addClass(J)},A=function(){a(this).removeClass(J)},G=function(){T(this,x)||(a.isFunction(d.addfunc)?d.addfunc.call(h):C.editGridRow.call(w,"new",u));return!1},X=function(b,c,d){if(!T(this,
x)){var e=f.selrow;e?a.isFunction(b)?b.call(h,e):C[c].call(w,e,d):I()}return!1},fa=function(){return X.call(this,d.editfunc,"editGridRow",e)},Y=function(){return X.call(this,d.viewfunc,"viewGridRow",g)},ca=function(){var b;T(this,x)||(f.multiselect?(b=f.selarrrow,0===b.length&&(b=null)):b=f.selrow,b?a.isFunction(d.delfunc)?d.delfunc.call(h,b):C.delGridRow.call(w,b,n):I());return!1},U=function(){T(this,x)||(a.isFunction(d.searchfunc)?d.searchfunc.call(h,c):C.searchGrid.call(w,c));return!1},da=function(){if(!T(this,
x)){a.isFunction(d.beforeRefresh)&&d.beforeRefresh.call(h);f.search=!1;f.resetsearch=!0;try{if("currentfilter"!==d.refreshstate){f.postData.filters="";try{a("#fbox_"+q).jqFilter("resetFilter")}catch(b){}a.isFunction(h.clearToolbar)&&h.clearToolbar(!1)}}catch(b){}switch(d.refreshstate){case "firstpage":w.trigger("reloadGrid",[a.extend({},d.reloadGridOptions||{},{page:1})]);break;case "current":case "currentfilter":w.trigger("reloadGrid",[a.extend({},d.reloadGridOptions||{},{current:!0})])}a.isFunction(d.afterRefresh)&&
d.afterRefresh.call(h)}return!1},Z=function(c,e,f){var g=a("<div class='"+E+"' tabindex='0' role='button'></div>"),h=d[c+"icon"],k=a.trim(d[c+"text"]);g.append("<div class='ui-pg-div'><span class='"+(d.iconsOverText?V("ui-pg-button-icon-over-text",B,h):V(B,h))+"'></span>"+(k?"<span class='ui-pg-button-text"+(d.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+k+"</span>":"")+"</div>");a(b).append(g);g.attr({title:d[c+"title"]||"",id:e||c+"_"+N}).click(f).hover(aa,A);return g};d.cloneToTop&&f.toppager&&
(l=2);for(L=0;L<l;L++){b=a("<div class='ui-pg-table navtable' role='toolbar' style='float:"+("rtl"===f.direction?"right":"left")+";table-layout:auto;'></div>");0===L?(z=p,N=D,z===f.toppager&&(N+="_top",l=1)):(z=f.toppager,N=D+"_top");d.add&&Z("add",u.id,G);d.edit&&Z("edit",e.id,fa);d.view&&Z("view",g.id,Y);d.del&&Z("del",n.id,ca);(d.add||d.edit||d.del||d.view)&&a(b).append(k);d.search&&(r=Z("search",c.id,U),c.showOnLoad&&!0===c.showOnLoad&&a(r,b).click());d.refresh&&Z("refresh","",da);r=a(".ui-jqgrid>.ui-jqgrid-view").css("font-size")||
"11px";a("body").append("<div id='testpg2' class='"+K.call(h,"gBox","ui-jqgrid")+"' style='font-size:"+r+";visibility:hidden;' ></div>");r=a(b).clone().appendTo("#testpg2").width();a("#testpg2").remove();a(z+"_"+d.position,z).append(b);if(d.hideEmptyPagerParts)for(O=0;O<W.length;O++)W[O]!==d.position&&(Q=a(z+"_"+W[O],z),0===Q.length||0===Q[0].childNodes.length?Q.hide():1===Q[0].childNodes.length&&(M=Q[0].firstChild,!a(M).is("table.ui-pg-table")||0!==M.rows&&0!==M.rows[0].cells.length||Q.hide()));
f._nvtd&&(r>f._nvtd[0]&&(a(z+"_"+d.position,z).width(r),f._nvtd[0]=r),f._nvtd[1]=r);h.nav=!0;b.bind("keydown.jqGrid",y)}w.triggerHandler("jqGridResetFrozenHeights")}}})},navButtonAdd:function(p,R){"object"===typeof p&&(R=p,p=void 0);return this.each(function(){var e=this,u=e.p;if(e.grid){var n=a.extend({caption:"newButton",title:"",onClickButton:null,position:"last",cursor:"pointer",iconsOverText:!1},C.getGridRes.call(a(e),"nav"),v.nav||{},u.navOptions||{},R||{}),c=P.call(e,"hover"),g=P.call(e,"disabled"),
h=K.call(e,"navButton","ui-pg-button");if(void 0===p)if(u.pager)if(C.navButtonAdd.call(a(e),u.pager,n),u.toppager)p=u.toppager;else return;else u.toppager&&(p=u.toppager);"string"===typeof p&&0!==p.indexOf("#")&&(p="#"+F(p));var u=a(".navtable",p),f=n.commonIconClass;if(0<u.length&&!(n.id&&0<u.find("#"+F(n.id)).length)){var w=a("<div tabindex='0' role='button'></div>");"NONE"===n.buttonicon.toString().toUpperCase()?a(w).addClass(h).append("<div class='ui-pg-div'>"+(n.caption?"<span class='ui-pg-button-text"+
(n.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+n.caption+"</span>":"")+"</div>"):a(w).addClass(h).append("<div class='ui-pg-div'><span class='"+(n.iconsOverText?V("ui-pg-button-icon-over-text",f,n.buttonicon):V(f,n.buttonicon))+"'></span>"+(n.caption?"<span class='ui-pg-button-text"+(n.iconsOverText?" ui-pg-button-icon-over-text":"")+"'>"+n.caption+"</span>":"")+"</div>");n.id&&a(w).attr("id",n.id);"first"===n.position&&0<u.children("div.ui-pg-button").length?u.children("div.ui-pg-button").first().before(w):
u.append(w);a(w,u).attr("title",n.title||"").click(function(c){T(this,g)||a.isFunction(n.onClickButton)&&n.onClickButton.call(e,n,c);return!1}).hover(function(){T(this,g)||a(this).addClass(c)},function(){a(this).removeClass(c)});a(e).triggerHandler("jqGridResetFrozenHeights")}}})},navSeparatorAdd:function(p,v){v=a.extend({sepclass:"ui-separator",sepcontent:"",position:"last"},v||{});return this.each(function(){if(this.grid){var e=this.p,u=K.call(this,"navButton","ui-pg-button "+P.call(this,"disabled"));
if(void 0===p)if(e.pager)if(C.navSeparatorAdd.call(a(this),e.pager,v),e.toppager)p=e.toppager;else return;else e.toppager&&(p=e.toppager);"string"===typeof p&&0!==p.indexOf("#")&&(p="#"+F(p));e=a(".navtable",p);0<e.length&&(u="<div class='"+u+"'><span class='"+v.sepclass+"'></span>"+v.sepcontent+"</div>","first"===v.position?0===e.children("div.ui-pg-button").length?e.append(u):e.children("div.ui-pg-button").first().before(u):e.append(u))}})},GridToForm:function(p,v){return this.each(function(){var e,
u,n,c;if(this.grid){var g=C.getRowData.call(a(this),p);if(g)for(e in g)if(g.hasOwnProperty(e))if(u=a("[name="+F(e)+"]",v),u.is("input:radio")||u.is("input:checkbox"))for(n=0;n<u.length;n++)c=a(u[n]),c.prop("checked",c.val()===String(g[e]));else u.val(da(g[e])?"":g[e])}})},FormToGrid:function(p,v,e,u){return this.each(function(){if(this.grid){e||(e="set");u||(u="first");var n=a(v).serializeArray(),c={};a.each(n,function(a,e){c[e.name]=e.value});"add"===e?C.addRowData.call(a(this),p,c,u):"set"===e&&
C.setRowData.call(a(this),p,c)}})}})});
//# sourceMappingURL=grid.formedit.map
