(function(){"use strict";angular.module("tubular-hchart.directives",["tubular.services","highcharts-ng"]).directive("tbHighcharts",[function(){return{template:'<div class="tubular-chart"><highchart config="options" ng-hide="isEmpty || hasError"><\/highchart><div class="alert alert-info" ng-show="isEmpty">{{emptyMessage}}<\/div><div class="alert alert-warning" ng-show="hasError">{{errorMessage}}<\/div><\/div>',restrict:"E",replace:!0,scope:{serverUrl:"@",title:"@?",requireAuthentication:"=?",name:"@?chartName",chartType:"@?",emptyMessage:"@?",errorMessage:"@?",onLoad:"=?",options:"=?"},controller:["$scope","tubularHttp",function(n,t){n.tubularDirective="tubular-chart";n.dataService=t.getDataService(n.dataServiceName);n.showLegend=n.showLegend||!0;n.chartType=n.chartType||"line";n.options=angular.extend({},n.options,{options:{chart:{type:n.chartType}},title:{text:n.title||""},xAxis:{categories:[]},yAxis:{},series:[]});n.requireAuthentication=angular.isUndefined(n.requireAuthentication)?!0:n.requireAuthentication;n.loadData=function(){t.setRequireAuthentication(n.requireAuthentication);n.hasError=!1;t.get(n.serverUrl).promise.then(function(t){if(!t||!t.Data||t.Data.length===0){if(n.isEmpty=!0,n.options.series=[{data:[]}],n.onLoad)n.onLoad(n.options,{});return}if(n.isEmpty=!1,t.Series)n.options.xAxis.categories=t.Labels,n.options.series=t.Series.map(function(n,i){return{name:n,data:t.Data[i]}});else{var i=t.Labels.map(function(n,i){return{name:n,y:t.Data[i]}});n.options.series=[{name:t.SerieName||"",data:i,showInLegend:(t.SerieName||"")!=""}]}if(n.onLoad)n.onLoad(n.options,t)},function(t){n.$emit("tbChart_OnConnectionError",t);n.hasError=!0})};n.$watch("serverUrl",function(t){angular.isDefined(t)&&t!=null&&t!=""&&n.loadData()});n.$watch("chartType",function(t){angular.isDefined(t)&&t!=null&&(n.options.options.chart.type=t)})}]}}])})();
/**
 * highcharts-ng
 * @version v0.0.9-dev - 2015-02-25
 * @link https://github.com/pablojim/highcharts-ng
 * @author Barry Fitzgerald <>
 * @license MIT License, http://www.opensource.org/licenses/MIT
 */
"undefined"!=typeof module&&"undefined"!=typeof exports&&module.exports===exports&&(module.exports="highcharts-ng"),function(){"use strict";function n(){return{indexOf:function(n,t,i){void 0===i&&(i=0);0>i&&(i+=n.length);0>i&&(i=0);for(var r=n.length;r>i;i++)if(i in n&&n[i]===t)return i;return-1},prependMethod:function(n,t,i){var r=n[t];n[t]=function(){var n=Array.prototype.slice.call(arguments);return i.apply(this,n),r?r.apply(this,n):void 0}},deepExtend:function n(t,i){var r,u;if(angular.isArray(i))for(t=angular.isArray(t)?t:[],r=0;r<i.length;r++)t[r]=n(t[r]||{},i[r]);else if(angular.isObject(i))for(u in i)t[u]=n(t[u]||{},i[u]);else t=i;return t}}}function t(n,t){var e=0,o=function(n){var t=!1;return angular.forEach(n,function(n){angular.isDefined(n.id)||(n.id="series-"+e++,t=!0)}),t},i=["xAxis","yAxis"],s={stock:"StockChart",map:"Map",chart:"Chart"},h=function(t,r,u){var f={},e={chart:{events:{}},title:{},subtitle:{},series:[],credits:{},plotOptions:{},navigator:{enabled:!1}};return f=u.options?n.deepExtend(e,u.options):e,f.chart.renderTo=r[0],angular.forEach(i,function(i){angular.isDefined(u[i])&&(f[i]=angular.copy(u[i]),(angular.isDefined(u[i].currentMin)||angular.isDefined(u[i].currentMax))&&(n.prependMethod(f.chart.events,"selection",function(n){var r=this;t.$apply(n[i]?function(){t.config[i].currentMin=n[i][0].min;t.config[i].currentMax=n[i][0].max}:function(){t.config[i].currentMin=r[i][0].dataMin;t.config[i].currentMax=r[i][0].dataMax})}),n.prependMethod(f.chart.events,"addSeries",function(){t.config[i].currentMin=this[i][0].min||t.config[i].currentMin;t.config[i].currentMax=this[i][0].max||t.config[i].currentMax})))}),u.title&&(f.title=u.title),u.subtitle&&(f.subtitle=u.subtitle),u.credits&&(f.credits=u.credits),u.size&&(u.size.width&&(f.chart.width=u.size.width),u.size.height&&(f.chart.height=u.size.height)),f},r=function(n,t){var i=n.getExtremes();(t.currentMin!==i.dataMin||t.currentMax!==i.dataMax)&&n.setExtremes(t.currentMin,t.currentMax,!1)},c=function(n,t,i){(t.currentMin||t.currentMax)&&n[i][0].setExtremes(t.currentMin,t.currentMax,!0)},u=function(t){return n.deepExtend({},t,{data:null,visible:null})},f=function(n){return void 0===n.config?"Chart":s[(""+n.config.chartType).toLowerCase()]||(n.config.useHighStocks?"StockChart":"Chart")};return{restrict:"EAC",replace:!0,template:"<div><\/div>",scope:{config:"=",disableDataWatch:"="},link:function(e,s){var a={},v=function(t){var i,s=[],h,f,r;if(t){if(h=o(t),h)return!1;if(angular.forEach(t,function(n){s.push(n.id);var t=l.get(n.id);t?angular.equals(a[n.id],u(n))?(void 0!==n.visible&&t.visible!==n.visible&&t.setVisible(n.visible,!1),t.setData(angular.copy(n.data),!1)):t.update(angular.copy(n),!1):l.addSeries(angular.copy(n),!1);a[n.id]=u(n)}),e.config.noData){for(f=!1,i=0;i<t.length;i++)if(t[i].data&&t[i].data.length>0){f=!0;break}f?l.hideLoading():l.showLoading(e.config.noData)}}for(i=l.series.length-1;i>=0;i--)r=l.series[i],"highcharts-navigator-series"!==r.options.id&&n.indexOf(s,r.options.id)<0&&r.remove(!1);return!0},l=!1,y=function(){var t;l&&l.destroy();a={};var n=e.config||{},r=h(e,s,n),u=n.func||void 0,o=f(e);for(l=new Highcharts[o](r,u),t=0;t<i.length;t++)n[i[t]]&&c(l,n[i[t]],i[t]);n.loading&&l.showLoading();n.getHighcharts=function(){return l}};y();e.disableDataWatch?e.$watchCollection("config.series",function(n){v(n);l.redraw()}):e.$watch("config.series",function(n){var t=v(n);t&&l.redraw()},!0);e.$watch("config.title",function(n){l.setTitle(n,!0)},!0);e.$watch("config.subtitle",function(n){l.setTitle(!0,n)},!0);e.$watch("config.loading",function(n){n?l.showLoading(n===!0?null:n):l.hideLoading()});e.$watch("config.noData",function(n){e.config&&e.config.loading&&l.showLoading(n)},!0);e.$watch("config.credits.enabled",function(n){n?l.credits.show():l.credits&&l.credits.hide()});e.$watch(f,function(n,t){n!==t&&y()});angular.forEach(i,function(n){e.$watch("config."+n,function(t,i){var u,f;if(t!==i&&t){if(angular.isArray(t))for(u=0;u<t.length;u++)f=t[u],u<l[n].length&&(l[n][u].update(f,!1),r(l[n][u],angular.copy(f)));else l[n][0].update(t,!1),r(l[n][0],angular.copy(t));l.redraw()}},!0)});e.$watch("config.options",function(n,t,i){n!==t&&(y(),v(i.config.series),l.redraw())},!0);e.$watch("config.size",function(n,t){n!==t&&n&&l.setSize(n.width||void 0,n.height||void 0)},!0);e.$on("highchartsng.reflow",function(){l.reflow()});e.$on("$destroy",function(){if(l){try{l.destroy()}catch(n){}t(function(){s.remove()},0)}})}}}angular.module("highcharts-ng",[]).factory("highchartsNGUtils",n).directive("highchart",["highchartsNGUtils","$timeout",t])}();