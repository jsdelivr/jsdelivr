{"version":3,"file":"ink.min.js","sources":["../../src/js/Ink/1/lib.js","../../src/js/Ink/Net/Ajax/1/lib.js","../../src/js/Ink/Net/JsonP/1/lib.js","../../src/js/Ink/Dom/Browser/1/lib.js","../../src/js/Ink/Dom/Css/1/lib.js","../../src/js/Ink/Dom/Element/1/lib.js","../../src/js/Ink/Dom/Event/1/lib.js","../../src/js/Ink/Dom/FormSerialize/1/lib.js","../../src/js/Ink/Dom/Loaded/1/lib.js","../../src/js/Ink/Dom/Selector/1/lib.js","../../src/js/Ink/Util/Array/1/lib.js","../../src/js/Ink/Util/BinPack/1/lib.js","../../src/js/Ink/Util/Cookie/1/lib.js","../../src/js/Ink/Util/Date/1/lib.js","../../src/js/Ink/Util/Dumper/1/lib.js","../../src/js/Ink/Util/I18n/1/lib.js","../../src/js/Ink/Util/Json/1/lib.js","../../src/js/Ink/Util/String/1/lib.js","../../src/js/Ink/Util/Url/1/lib.js","../../src/js/Ink/Util/Validator/1/lib.js"],"names":["window","document","paths","modules","modulesLoadOrder","modulesRequested","pendingRMs","modulesWaitingForDeps","apply","Function","prototype","isEmptyObject","o","k","hasOwnProperty","Ink","VERSION","_checkPendingRequireModules","I","F","dep","mod","cb","pRMs","toApply","length","left","args","remaining","push","i","setTimeout","getPath","key","noLib","split","curKey","root","path","slice","join","test","setPath","rootURI","replace","loadScript","uri","contentType","indexOf","givenUri","this","Error","scriptEl","createElement","setAttribute","onerror","error","head","getElementsByTagName","appendChild","_loadLater","namespace","ns","returnParentAndKey","levels","nsobj","parent","f","getModule","version","createModule","deps","modFn","modAll","Array","call","arguments","moduleContent","_version","isInkModule","t","requireModules","cbFn","undefined","_moduleRenames","warn","Ink.UI.Aux_1","getModulesLoadOrder","getModuleScripts","mlo","unshift","map","m","getModuleURL","createExt","moduleName","dependencies","bind","fn","context","innerArgs","finalArgs","concat","bindMethod","object","methodName","bindEvent","event","id","getElementById","ss","selector","from","Dom","Selector","select","s","extendObj","destination","sources","len","property","Object","log","console","Ajax","url","options","init","globalOptions","parameters","requestHeaders","xMLHttpRequestWithCredentials","XMLHttpRequest","userOptions","asynchronous","cors","validateCors","debug","delay","evalJS","method","postBody","sanitizeJSON","signRequest","timeout","useCredentials","xhrProxy","onComplete","onCreate","onException","onFailure","onHeaders","onInit","onSuccess","onTimeout","globalParameters","paramsObjToStr","safeCall","urlLocation","_locationFromURL","isHTTP","_locationIsHTTP","isCrossDomain","_locationIsCrossDomain","location","requestHasBody","search","transport","getTransport","request","createElementNS","href","match","protocol","widget","split1","split2","protocol1","protocol2","colonOrSlash","host1","host2","usingXDomainReq","XDomainRequest","ActiveXObject","e","setHeaders","headers","Accept","Accept-Language","navigator","language","X-Requested-With","X-Ink-Version","headerReqName","overrideMimeType","userAgent","Connection","headerName","setRequestHeader","optParams","p","a","params","toString","isNaN","encodeURIComponent","pop","setParams","getHeader","name","getResponseHeader","getAllHeaders","getAllResponseHeaders","getResponse","r","headerJSON","responseJSON","timeTaken","Date","startTime","requestedUrl","readyState","responseText","responseXML","status","statusText","abort","clearTimeout","delayTimeout","stoTimeout","ex","finish","runStateChange","rs","getTime","responseContent","response","curStatus","isSuccess","headerContentType","evalJSON","mimeType","xmlDoc","DOMParser","parseFromString","xml","onreadystatechange","destroy","handlerName","value","nodeType","crossDomain","open","withCredentials","onload","send","isJSON","str","strJSON","sanitize","JSON","parse","eval","load","callback","ping","JsonP","failureObj","callbackParam","internalCallback","randVar","parseInt","Math","random","Net","_cleanUp","_addScriptTag","_addParamsToGet","hasQuestionMark","sep","pKey","pValue","parts","_getScriptContainer","body","documentElement","rnd_seed","_scriptEl","type","src","scriptCtn","_removeScriptTag","parentNode","removeChild","Browser","IE","GECKO","OPERA","SAFARI","KONQUEROR","CHROME","model","cssPrefix","domPrefix","detectBrowser","setDimensions","setReferrer","myWidth","myHeight","innerWidth","innerHeight","clientWidth","clientHeight","windowWidth","windowHeight","referrer","escape","_sniffUserAgent","sAgent","toLowerCase","rVersion","re","RegExp","reVersion","alert","getCs","defaultView","getComputedStyle","Css","addRemoveClassName","elm","className","addRemState","addClassName","removeClassName","classList","add","hasClassName","remove","elmClassName","setClassName","all","has","contains","blinkClass","element","negate","Number","toggleClassName","forceAdd","toggle","setOpacity","val","style","opacity","filter","_camelCase","_","$1","toUpperCase","getStyle","currentStyle","charAt","css","parseFloat","setStyle","cssText","prop","styleFloat","cssFloat","show","forceDisplayProperty","display","hide","showHide","forceShow","_getRefTag","firstElementChild","child","firstChild","nextSibling","appendStyleTag","force","styles","oldStyle","l","innerHTML","defStyle","refTag","styleStr","styleSheet","createTextNode","insertBefore","appendStylesheet","media","rel","_loadingCSSFiles","_loadedCSSFiles","appendStylesheetCb","cbs","linkEl","headEl","imgEl","_url","callbacks","decToHex","dec","normalizeTo2","rDec","gDec","g","bDec","b","rgb","hexToDec","hex","substr","getPropertyFromStylesheet","rule","getRuleFromStylesheet","getPropertyFromStylesheet2","rules","getRulesFromStylesheet","x","sheet","ri","rf","styleSheets","si","sf","cssRules","selectorText","res","getPropertiesFromRule","props","steps","pre","pos","substring","borderTopLeftRadius","borderBottomRightRadius","borderTopRightRadius","borderBottomLeftRadius","changeFontSize","delta","op","minVal","maxVal","that","TypeError","el","els","fontSize","rect","elem","dimensions","getBoundingClientRect","top","offsetTop","offsetLeft","createContextualFragmentSupport","createRange","Range","createContextualFragment","deleteThisTbodyToken","browserCreatesTbodies","div","InkElement","isDOMElement","get","create","tag","properties","parEl","scrollTo","scrollIntoView","elmOffset","elmTop","elmLeft","offsetParent","y","offset","positionedOffset","valueTop","valueLeft","tagName","position","doc","ownerDocument","docElem","box","clientTop","clientLeft","scrollTop","pageYOffset","scrollLeft","pageXOffset","scroll","_getPropPx","cs","n","c","getPropertyValue","offset2","hasAttribute","attr","getAttribute","insertAfter","newElm","targetElm","insertTop","insertBottom","textContent","node","text","innerText","lastChild","childNodes","nodeValue","setTextContent","isLink","hasAttributeNS","isAncestorOf","ancestor","compareDocumentPosition","descendantOf","descendant","lastElementChild","previousSibling","nextElementSibling","sibling","previousElementSibling","elementWidth","offsetWidth","elementHeight","offsetHeight","elementLeft","elementTop","elementDimensions","outerDimensions","bbox","right","bottom","inViewport","dims","partial","margin","viewportWidth","viewportHeight","isHidden","w","h","isVisible","clonePosition","cloneTo","cloneFrom","ellipsizeText","overflow","whiteSpace","textOverflow","findUpwardsHaving","boolTest","findUpwardsByClass","tst","cls","findUpwardsByTag","nodeName","findUpwardsById","findUpwardsBySelector","sel","matchesSelector","getChildrenText","removeIt","j","part","nodes","jLen","_trimString","String","data","trim","getSelectValues","selectEl","values","_normalizeData","d","data2","fillSelect","container","skipEmpty","defaultValue","containerEl","optionEl","fillRadios","insertAfterEl","splitEl","inputEl","checked","fillChecks","parentIndexOf","parentEl","childEl","children","nextSiblings","elements","siblings","index","previousSiblings","childElementCount","_wrapElements","TABLE","html","TBODY","THEAD","TFOOT","TR","_getWrapper","wrapper","wrapFunc","tds","tbody","appendHTML","prependHTML","setHTML","wrap","target","nextNode","unwrap","wrapperSelector","replacement","replaceChild","removeTextNodeChildren","prevEl","toRemove","htmlToFragment","range","createDocumentFragment","selectNode","fragment","tempElement","current","InkDomSelector","dataset","attrs","attributes","curAttr","curAttrName","curAttrValue","total","moveCursorTo","setSelectionRange","createTextRange","collapse","moveEnd","moveStart","pageWidth","xScroll","scrollMaxX","scrollWidth","self","pageHeight","yScroll","scrollMaxY","scrollHeight","bean","definition","win","old","namespaceRegex","nameRegex","addEvent","removeEvent","W3C_MODEL","eventSupport","ONE","str2arr","isString","isFunction","standardNativeEvents","w3cNativeEvents","nativeEvents","hash","events","customEvents","isAncestor","check","related","relatedTarget","prefix","mouseenter","base","condition","mouseleave","mousewheel","Event","commonProps","mouseProps","mouseWheelProps","keyProps","textProps","touchProps","messageProps","stateProps","overOutRegex","typeFixers","reg","fix","newEvent","keyCode","which","rightClick","button","pageX","pageY","clientX","clientY","typeFixerMap","isNative","parentWindow","originalEvent","isBean","srcElement","fixer","preventDefault","returnValue","stopPropagation","cancelBubble","stop","stopped","stopImmediatePropagation","isImmediatePropagationStopped","clone","currentTarget","ne","targetElement","RegEntry","wrappedHandler","eargs","findTarget","eventElement","__beanDel","ft","handler","original","namespaces","customType","once","removeListener","eventType","inNamespaces","checkNamespaces","matches","checkElement","checkOriginal","checkHandler","registry","forAll","pfx","list","entries","entry","put","del","splice","removed","selectorEngine","setSelectorEngine","querySelectorAll","rootListener","propertyName","listeners","listener","custom","attachEvent","detachEvent","rm","originalFn","orgType","handlers","delegate","array","fireListener","evt","createEvent","dispatchEvent","fireEvent","createEventObject","off","typeSpec","isTypeStr","on","types","first","delfn","one","fire","names","beanDel","noConflict","cleanup","CollectGarbage","InkEvent","KEY_BACKSPACE","KEY_TAB","KEY_RETURN","KEY_ESC","KEY_SPACE","KEY_LEFT","KEY_UP","KEY_RIGHT","KEY_DOWN","KEY_DELETE","KEY_HOME","KEY_END","KEY_PAGEUP","KEY_PAGEDOWN","KEY_INSERT","throttle","func","wait","throttled","now","timeDiff","lastCall","ev","delegationTarget","fromElement","toElement","findElement","elmTagName","observe","eventName","callBack","useCapture","addEventListener","observeOnce","onceBack","stopObserving","observeMulti","observeDelegated","cursor","Selector_1","removeEventListener","cancel","stopDefault","pointer","pointerX","pointerY","touches","isLeftClick","isRightClick","isMiddleClick","getCharFromKeyboardEvent","changeCasing","fromCharCode","shiftOn","shiftKey","InkArray","isArrayIsh","obj","isArray","toArray","FormSerialize","serialize","form","out","emptyArrayToken","pairs","asPairs","emptyArray","outputUnchecked","forEach","pair","_resultsInArray","emit","serializeEl","elNodeName","elType","multiple","didEmit","thisOption","inputs","_isSerialized","fillIn","map2","_objToPairs","_fillInPairs","groupBy","reduce","_fillInOne","firstOne","firstNodeName","firstType","isSelectMulti","_fillInBoolean","min","checkAttr","input","isChecked","inArray","Loaded","_contexts","run","cbQueue","done","checkState","_checkState","poll","_poll","ael","rem","det","wet","csf","alreadyLoaded","frameElement","doScroll","where","_ready","rnative","createCache","cache","keys","Expr","cacheLength","shift","markFunction","expando","assert","Sizzle","results","seed","groups","nid","newContext","newSelector","preferredDoc","setDocument","documentIsHTML","rquickExpr","exec","support","getElementsByClassName","qsa","rbuggyQSA","tokenize","rescape","toSelector","rsibling","qsaError","removeAttribute","rtrim","siblingCheck","cur","diff","sourceIndex","MAX_NEGATIVE","createInputPseudo","createButtonPseudo","createPositionalPseudo","argument","matchIndexes","parseOnly","matched","tokens","soFar","preFilters","cached","tokenCache","preFilter","rcomma","rcombinators","matchExpr","addCombinator","matcher","combinator","dir","checkNonElements","doneName","outerCache","dirkey","dirruns","cachedruns","elementMatcher","matchers","condense","unmatched","newUnmatched","mapped","setMatcher","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","elems","multipleContexts","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","relative","implicitRelative","matchContext","matchAnyContext","outermostContext","matcherFromGroupMatchers","elementMatchers","setMatchers","matcherCachedRuns","bySet","byElement","superMatcher","expandContext","setMatched","matchedCount","outermost","contextBackup","find","dirrunsUnique","uniqueSort","contexts","token","runescape","funescape","compile","setFilters","getText","isXML","recompare","sortInput","rbuggyMatches","classCache","compilerCache","hasDuplicate","sortOrder","strundefined","arr","push_native","whitespace","characterEncoding","identifier","operators","pseudos","rpseudo","ridentifier","ID","CLASS","NAME","TAG","ATTR","PSEUDO","CHILD","needsContext","rinputs","rheader","rattributeQuotes","escaped","high","createComment","getByName","pass","getElementsByName","sortDetached","div1","attrHandle","attrId","getAttributeNode","tmp","mozMatchesSelector","webkitMatchesSelector","oMatchesSelector","msMatchesSelector","disconnectedMatch","adown","bup","compare","aup","ap","bp","expr","ret","specified","msg","duplicates","detectDuplicates","sortStable","sort","selectors","createPseudo",">"," ","+","~","excess","unquoted","pattern","operator","result","what","last","simple","forward","ofType","nodeIndex","start","useCache","pseudo","idx","not","lang","elemLang","focus","activeElement","hasFocus","tabIndex","enabled","disabled","selected","selectedIndex","empty","header","eq","even","odd","lt","gt","radio","checkbox","file","password","image","submit","reset","group","filters","arrayProto","testedObject","outKey","item","latestGroup","initial","sortMulti","constructor","keyValue","aKeys","shuffle","tmp1","rnd","floor","each","mapFn","filtered","some","intersect","arr1","arr2","shared","J","convert","unique","lastIndexOf","newArr","step","insert","rLen","output","iLen","Packer","fit","blocks","block","findNode","splitNode","used","down","GrowingPacker","growNode","canGrowDown","canGrowRight","shouldGrowRight","shouldGrowDown","growRight","growDown","sorts","area","max","height","msort","width","maxside","criteria","BinPack","binPack","bl","packer","sorter","dims2","fitted","unfitted","filled","Cookie","cookie","_Cookie","aCookie","aItem","decodeURIComponent","set","expires","domain","secure","sName","sExpires","sPath","sDomain","sSecure","oDate","sDate","valueOf","nDate","expiresString","toGMTString","hostname","cookieName","expiresDate","InkDate","_months","_m","_iMonth","month","janeiro","jan","fevereiro","fev","março","mar","abril","abr","maio","mai","junho","jun","julho","jul","agosto","ago","setembro","outubro","novembro","nov","dezembro","dez","_wDays","_d","_iWeek","week","segunda","seg","terça","ter","quarta","qua","quinta","qui","sexta","sex","sábado","sáb","domingo","dom","_daysInMonth","_y","nDays","format","_date","iFormat","escapeChar","jsDate","jsFirstDay","jsThisDay","jsHour","jsDay","getDate","getDay","suffixes","suffix","UTC","getFullYear","getMonth","jsYearStart","days","ceil","jsMonth","getYear","jsYear","getHours","jsMinute","getMinutes","jsSecond","getSeconds","getTimezoneOffset","jsMinZone","jsMinutes","jsDayName","jsMonthName","str_date","mList","objIndex","year","day","dayY","dayW","hour","hourD","sec","msec","ampm","diffM","diffH","date","pattr","_haveDatetime","_haveYear","_haveYDay","_haveDay","_haveMonth","_haveMonthDay","_haveOnlyDay","_haveWDay","_haveWeek","_haveWeekWDay","_haveOnlyWDay","_validDate","_noDate","_haveHour12","_haveHour24","_haveHour","_haveMin","_haveSec","_haveMSec","_haveMoreM","_haveMoreS","_haveDiffM","_haveDiffH","dList","gmt","aux","Dumper","_tab","_formatParam","param","formated","_outputFormat","_getTabs","numberOfTabs","tabs","_i","indent","_typeof","printDump","write","returnDump","alertDump","windowDump","dumperwindow","close","pattrText","funcOrVal","I18n","dict","testMode","append","_dicts","_dict","_testMode","_lang","_gLang","newTestMode","getKey","gLang","langGlobal","_gDict","pars","isObj","$2","$3","ntext","strSin","strPlur","count","ordinal","num","lastDig","ordDict","exceptions","byLastDigit","alias","_gDicts","appendGlobal","twoDigits","function_call","cx","dateToISOString","toISOString","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","toFixed","InkJson","_nativeJSON","_convertToUnicode","_escape","theString","\b","\t","\n","\f","\r","\"","\\","charCodeAt","_toUnicode","unicodeString","inInt","theUnicode","_stringifyValue","isFinite","toJSON","arrayString","objectString","stringify","convertToUnicode","reviver","walk","holder","v","lastIndex","SyntaxError","InkUtilString","_chars","_entities","_accentedChars","_accentedRemovedChars","_htmlUnsafeChars","<","&","'","ucFirst","string","firstWordOnly","replacer","stripTags","allowed","aAllowed","aNewAllowed","cleanedTag","strAllowed","reAllowed","aFoundTags","htmlEntitiesEncode","htmlEntitiesDecode","$0","utf8Encode","utfstring","shortString","words","resultstr","truncateString","utf8Decode","c2","c3","removeAccentedChars","newString","substrCount","haystack","needle","htmlEscapeUnsafe","chars","normalizeWhitespace","toUnicode","unescape","es","hexNum","escapeText","txt","whiteList","txt2","C","escapedCharRegex","unescapeText","strcmp","str1","str2","packetize","maxLen","sz","Url","_keyStr","getUrl","genQueryString","getQueryString","aParams","queryStr","aQueryStr","pairVar","getAnchor","anchor","getAnchorString","anchorStr","aAnchorStr","parseUrl","aURL","scheme","host","query","re1","re2","re3","regPort","tmpHost1","port","tmpHost2","tmpUserPass","user","urlObj","frag","currentScriptElement","aScripts","curScript","Validator","_countryCodes","_internacionalPT","_indicativosPT",21,22,231,232,233,234,235,236,238,239,241,242,243,244,245,249,251,252,253,254,255,256,258,259,261,262,263,265,266,268,269,271,272,273,274,275,276,277,278,279,281,282,283,284,285,286,289,291,292,295,296,91,93,96,92,707,760,800,808,30,"_internacionalCV","_indicativosCV",2,95,97,98,99,"_internacionalAO","_indicativosAO","_internacionalMZ","_indicativosMZ",82,84,"_internacionalTL","_indicativosTL",3,7,"_characterGroups","numbers","asciiAlpha","latin1Alpha","unicodeAlpha","space","dash","underscore","nicknamePunctuation","singleLineWhitespace","newline","asciiPunctuation","latin1Punctuation","unicodePunctuation","createRegExp","checkCharacterGroups","unicode","latin1","ascii","number","numb","decimalSep","thousandSep","negative","decimalPlaces","maxDigits","returnNumber","maxExcl","minExcl","_isLeapYear","yearRegExp","_dateParsers","yyyy-mm-dd","parser","yyyy/mm/dd","yy-mm-dd","yy/mm/dd","dd-mm-yyyy","dd/mm/yyyy","dd-mm-yy","dd/mm/yy","_isValidDate","validOneOrTwo","email","emailValido","mail","full","reHTTP","reUrl","isPTPhone","phone","aInd","strInd","re351","reSpecialChars","reInt","reValid","isPortuguesePhone","isCVPhone","re238","isAOPhone","re244","isMZPhone","re258","isTLPhone","re670","isPhone","codPostal","cp1","cp2","returnBothResults","cPostalSep","cPostal4","cPostal3","parserCPostal","cPostal","isDate","dateStr","yearIndex","monthIndex","dayIndex","dateParser","separator","isColor","valid","keyword","hexa","rgba","hsl","hsla","isIP","ipType","_creditCardSpecs","default","luhn","american express","diners club","discover","jcb","maestro","mastercard","visa","_luhn","checksum","dbl","isCreditCard","creditCardType","ccLength"],"mappings":"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","sourcesContent":["/**\n * Ink Core.\n * @module Ink_1\n * This module provides the necessary methods to create and load the modules using Ink.\n */\n\n;(function(window, document) {\n\n    'use strict';\n\n    // skip redefinition of Ink core\n    if ('Ink' in window) { return; }\n\n\n    // internal data\n\n    /*\n     * NOTE:\n     * invoke Ink.setPath('Ink', '/Ink/'); before requiring local modules\n     */\n    var paths = {};\n    var modules = {};\n    var modulesLoadOrder = [];\n    var modulesRequested = {};\n    var pendingRMs = [];\n    var modulesWaitingForDeps = {};\n\n    var apply = Function.prototype.apply;\n\n    // auxiliary fns\n    var isEmptyObject = function(o) {\n        /*jshint unused:false */\n        if (typeof o !== 'object') { return false; }\n        for (var k in o) {\n            if (o.hasOwnProperty(k)) {\n                return false;\n            }\n        }\n        return true;\n    };\n\n    /**\n     * @namespace Ink_1\n     */\n\n    window.Ink = {\n        /**\n         * @property {String} VERSION\n         **/\n        VERSION: '3.1.4',\n        _checkPendingRequireModules: function() {\n            var I, F, o, dep, mod, cb, pRMs = [];\n            var toApply = [];\n            for (I = 0, F = pendingRMs.length; I < F; ++I) {\n                o = pendingRMs[I];\n\n                if (!o) { continue; }\n\n                for (dep in o.left) {\n                    if (o.left.hasOwnProperty(dep)) {\n                        mod = modules[dep];\n                        if (mod) {\n                            o.args[o.left[dep] ] = mod;\n                            delete o.left[dep];\n                            --o.remaining;\n                        }\n                    }\n                }\n\n                if (o.remaining > 0) {\n                    pRMs.push(o);\n                } else {\n                    cb = o.cb;\n                    if (!cb) { continue; }\n                    delete o.cb; // to make sure I won't call this more than once!\n                    toApply.push([cb, o.args]);\n                }\n            }\n\n            pendingRMs = pRMs;\n\n            for (var i = 0; i < toApply.length; i++) {\n                toApply[i][0].apply(false, toApply[i][1]);\n            }\n\n            if (pendingRMs.length > 0) {\n                setTimeout( function() { Ink._checkPendingRequireModules(); }, 0 );\n            }\n        },\n\n        /**\n         * Get the full path of a module.\n         * This method looks up the paths given in setPath (and ultimately the default Ink's path).\n         *\n         * @method getPath\n         * @param {String}  key      Name of the module you want to get the path\n         * @param {Boolean} [noLib] Flag to skip appending 'lib.js' to the returned path.\n         *\n         * @return {String} The URI to the module, according to what you added in setPath for the given `key`.\n         */\n        getPath: function(key, noLib) {\n            var split = key.split(/[._]/g);\n            var curKey;\n            var i;\n            var root;\n            var path;\n\n            // Look for Ink.Dom.Element.1, Ink.Dom.Element, Ink.Dom, Ink in this order.\n            for (i = split.length; i >= 0; i -= 1) {\n                curKey = split.slice(0, i + 1).join('.');  // See comment in setPath\n                if (paths[curKey]) {\n                    root = curKey;\n                    break;\n                }\n            }\n\n            if (root in paths) {\n                path = paths[root];\n            } else {\n                return null;\n            }\n\n            if (!/\\/$/.test(path)) {\n                path += '/';\n            }\n            if (i < split.length) {\n                // Add the rest of the path. For example, if we found\n                // paths['Ink.Dom'] to be 'http://example.com/Ink/Dom/',\n                // we now add '/Element/' to get the full path.\n                path += split.slice(i + 1).join('/') + '/';\n            }\n            if (!noLib) {\n                path += 'lib.js';\n            }\n            return path;\n        },\n\n        /**\n         * Sets the URL path for a namespace.\n         * Use this to customize where requireModules and createModule will load dependencies from.\n         * This can be useful to set your own CDN for dynamic module loading or simply to change your module folder structure\n         *\n         * @method setPath\n         *\n         * @param {String} key       Module or namespace\n         * @param {String} rootURI   Base URL path and schema to be appended to the module or namespace\n         * @return {void}\n         *\n         * @example\n         *      Ink.setPath('Ink', 'http://my-cdn/Ink/');\n         *      Ink.setPath('Lol', 'http://my-cdn/Lol/');\n         *\n         *      // Loads from http://my-cdn/Ink/Dom/Whatever/lib.js\n         *      Ink.requireModules(['Ink.Dom.Whatever'], function () { ... });\n         *      // Loads from http://my-cdn/Lol/Whatever/lib.js\n         *      Ink.requireModules(['Lol.Whatever'], function () { ... });\n         */\n        setPath: function(key, rootURI) {\n            // Replacing version separator with dot because the difference\n            // between a submodule and a version doesn't matter here.\n            // It would also overcomplicate the implementation of getPath\n            paths[key.replace(/_/, '.')] = rootURI;\n        },\n\n        /**\n         * Loads a script URL.\n         * This creates a `script` tag in the `head` of the document.\n         * Reports errors by listening to 'error' and 'readystatechange' events.\n         *\n         * @method loadScript\n         * @param {String}  uri  Can be an external URL or a module name\n         * @param {String}  [contentType]='text/javascript' The `type` attribute of the new script tag.\n         * @return {Element} The newly created script element.\n         */\n        loadScript: function(uri, contentType) {\n            /*jshint evil:true */\n\n            if (uri.indexOf('/') === -1) {\n                var givenUri = uri;  // For the error message\n                uri = this.getPath(uri);\n                if (uri === null) {\n                    throw new Error('Could not load script \"' + givenUri + '\". ' +\n                        'Path not found in the registry. Did you misspell ' +\n                        'the name, or forgot to call setPath()?');\n                }\n            }\n\n            var scriptEl = document.createElement('script');\n            scriptEl.setAttribute('type', contentType || 'text/javascript');\n            scriptEl.setAttribute('src', uri);\n\n            if ('onerror' in scriptEl) {\n                scriptEl.onerror = function () {\n                    Ink.error(['Failed to load script from ', uri, '.'].join(''));\n                };\n            }\n\n            var head = document.head ||\n                document.getElementsByTagName('head')[0];\n\n            if (head) {\n                return head.appendChild(scriptEl);\n            }\n        },\n\n        _loadLater: function (dep) {\n            setTimeout(function () {\n                if (modules[dep] || modulesRequested[dep] ||\n                        modulesWaitingForDeps[dep]) {\n                    return;\n                }\n                modulesRequested[dep] = true;\n                Ink.loadScript(dep);\n            }, 0);\n        },\n\n        /**\n         * Defines a module namespace.\n         *\n         * @method namespace\n         * @param  {String}   ns                    Namespace to define.\n         * @param  {Boolean}  [returnParentAndKey]  Flag to change the return value to an array containing the namespace parent and the namespace key\n         * @return {Object|Array} Returns the created namespace object\n         */\n        namespace: function(ns, returnParentAndKey) {\n            if (!ns || !ns.length) { return null; }\n\n            var levels = ns.split('.');\n            var nsobj = window;\n            var parent;\n\n            for (var i = 0, f = levels.length; i < f; ++i) {\n                nsobj[ levels[i] ] = nsobj[ levels[i] ] || {};\n                parent = nsobj;\n                nsobj = nsobj[ levels[i] ];\n            }\n\n            if (returnParentAndKey) {\n                return [\n                    parent,\n                    levels[i-1]\n                ];\n            }\n\n            return nsobj;\n        },\n\n        /**\n         * Loads a module.\n         * A synchronous method to get the module from the internal registry.\n         * It assumes the module is defined and loaded already!\n         *\n         * @method getModule\n         * @param  {String}  mod        Module name\n         * @param  {Number}  [version]  Version number of the module\n         * @return {Object|Function}    Module object or function, depending how the module is defined\n         */\n        getModule: function(mod, version) {\n            var key = version ? [mod, '_', version].join('') : mod;\n            return modules[key];\n        },\n\n        /**\n         * Creates a new module.\n         * Use this to wrap your code and benefit from the module loading used throughout the Ink library\n         *\n         * @method createModule\n         * @param  {String}    mod      Module name, separated by dots. Like Ink.Dom.Selector, Ink.UI.Modal\n         * @param  {Number}    version  Version number\n         * @param  {Array}     deps     Array of module names which are dependencies of the module being created. The order in which they are passed here will define the order they will be passed to the callback function.\n         * @param  {Function}  modFn    The callback function to be executed when all the dependencies are resolved. The dependencies are passed as arguments, in the same order they were declared. The function itself should return the module.\n         * @return {void}\n         * @sample Ink_1_createModule.html\n         *\n         */\n        createModule: function(mod, version, deps, modFn) { // define\n            if (typeof mod !== 'string') {\n                throw new Error('module name must be a string!');\n            }\n\n            // validate version correctness\n            if (!(typeof version === 'number' || (typeof version === 'string' && version.length > 0))) {\n                throw new Error('version number missing!');\n            }\n\n            var modAll = [mod, '_', version].join('');\n\n            modulesWaitingForDeps[modAll] = true;\n\n            var cb = function() {\n                //console.log(['createModule(', mod, ', ', version, ', [', deps.join(', '), '], ', !!modFn, ')'].join(''));\n\n                // make sure module in not loaded twice\n                if (modules[modAll]) {\n                    //console.warn(['Ink.createModule ', modAll, ': module has been defined already.'].join(''));\n                    return;\n                }\n\n\n                // delete related pending tasks\n                delete modulesRequested[modAll];\n                delete modulesRequested[mod];\n\n\n                // run module's supplied factory\n                var args = Array.prototype.slice.call(arguments);\n                var moduleContent = modFn.apply(window, args);\n                modulesLoadOrder.push(modAll);\n                // console.log('** loaded module ' + modAll + '**');\n\n\n                // set version\n                if (typeof moduleContent === 'object') { // Dom.Css Dom.Event\n                    moduleContent._version = version;\n                }\n                else if (typeof moduleContent === 'function') {\n                    moduleContent.prototype._version = version; // if constructor\n                    moduleContent._version = version;           // if regular function\n                }\n\n\n                // add to global namespace...\n                var isInkModule = mod.indexOf('Ink.') === 0;\n                var t;\n                if (isInkModule) {\n                    t = Ink.namespace(mod, true); // for mod 'Ink.Dom.Css', t[0] gets 'Ink.Dom' object and t[1] 'Css'\n                }\n\n\n                // versioned\n                modules[ modAll ] = moduleContent; // in modules\n                delete modulesWaitingForDeps[ modAll ];\n\n                if (isInkModule) {\n                    t[0][ t[1] + '_' + version ] = moduleContent; // in namespace\n                }\n\n\n                // unversioned\n                modules[ mod ] = moduleContent; // in modules\n\n                if (isInkModule) {\n                    if (isEmptyObject( t[0][ t[1] ] )) {\n                        t[0][ t[1] ] = moduleContent; // in namespace\n                    }\n                    // else {\n                        // console.warn(['Ink.createModule ', modAll, ': module has been defined already with a different version!'].join(''));\n                    // }\n                }\n\n\n                if (this) { // there may be pending requires expecting this module, check...\n                    Ink._checkPendingRequireModules();\n                }\n            };\n\n            this.requireModules(deps, cb);\n        },\n\n        /**\n         * Requires modules asynchronously\n         * Use this to get modules, even if they're not loaded yet\n         *\n         * @method requireModules\n         * @param  {Array}     deps  Array of module names. The order in which they are passed here will define the order they will be passed to the callback function.\n         * @param  {Function}  cbFn  The callback function to be executed when all the dependencies are resolved. The dependencies are passed as arguments, in the same order they were declared.\n         * @return {void}\n         * @sample Ink_1_requireModules.html\n         */\n        requireModules: function(deps, cbFn) { // require\n            //console.log(['requireModules([', deps.join(', '), '], ', !!cbFn, ')'].join(''));\n            var i, f, o, dep, mod;\n            f = deps && deps.length;\n            o = {\n                args: new Array(f),\n                left: {},\n                remaining: f,\n                cb: cbFn\n            };\n\n            if (!(typeof deps === 'object' && deps.length !== undefined)) {\n                throw new Error('Dependency list should be an array!');\n            }\n            if (typeof cbFn !== 'function') {\n                throw new Error('Callback should be a function!');\n            }\n\n            for (i = 0; i < f; ++i) {\n                if (Ink._moduleRenames[deps[i]]) {\n                    Ink.warn(deps[i] + ' was renamed to ' + Ink._moduleRenames[deps[i]]);\n                    dep = Ink._moduleRenames[deps[i]];\n                } else {\n                    dep = deps[i];\n                }\n\n                // Because trailing commas in oldIE bring us undefined values here\n                if (!dep) {\n                    --o.remaining;\n                    continue;\n                }\n\n                mod = modules[dep];\n                if (mod) {\n                    o.args[i] = mod;\n                    --o.remaining;\n                    continue;\n                }\n                else if (!modulesRequested[dep]) {\n                    Ink._loadLater(dep);\n                }\n                o.left[dep] = i;\n            }\n\n            if (o.remaining > 0) {\n                pendingRMs.push(o);\n            }\n            else {\n                cbFn.apply(true, o.args);\n            }\n        },\n\n        _moduleRenames: {\n            'Ink.UI.Aux_1': 'Ink.UI.Common_1'\n        },\n\n        /**\n         * Lists loaded module names.\n         * The list is ordered by loaded time (oldest module comes first)\n         *\n         * @method getModulesLoadOrder\n         * @return {Array} returns the order in which modules were resolved and correctly loaded\n         */\n        getModulesLoadOrder: function() {\n            return modulesLoadOrder.slice();\n        },\n\n        /**\n         * Builds the markup needed to load the modules.\n         * This method builds the script tags needed to load the currently used modules\n         *\n         * @method getModuleScripts\n         * @uses getModulesLoadOrder\n         * @return {String} The script markup\n         */\n        getModuleScripts: function() {\n            var mlo = this.getModulesLoadOrder();\n            mlo.unshift('Ink_1');\n            mlo = mlo.map(function(m) {\n                return ['<scr', 'ipt type=\"text/javascript\" src=\"', Ink.getModuleURL(m), '\"></scr', 'ipt>'].join('');\n            });\n\n            return mlo.join('\\n');\n        },\n\n        /**\n         * Creates an Ink.Ext module\n         *\n         * Does exactly the same as createModule but creates the module in the Ink.Ext namespace\n         *\n         * @method createExt\n         * @uses createModule\n         * @param {String} moduleName   Extension name\n         * @param {String} version  Extension version\n         * @param {Array}  dependencies Extension dependencies\n         * @param {Function} modFn  Function returning the extension\n         * @return {void}\n         * @sample Ink_1_createExt.html\n         */\n        createExt: function (moduleName, version, dependencies, modFn) {\n            return Ink.createModule('Ink.Ext.' + moduleName, version, dependencies, modFn);\n        },\n\n        /**\n         * Function.prototype.bind alternative/fallback.\n         * Creates a new function that, when called, has its this keyword set to the provided value, with a given sequence of arguments preceding any provided when the new function is called.\n         *\n         * @method bind\n         * @param {Function}  fn        The function\n         * @param {Object}    context   The value to be passed as the this parameter to the target function when the bound function is called. If used as false, it preserves the original context and just binds the arguments.\n         * @param {Mixed}       [more...] Additional arguments will be sent to the original function as prefix arguments.\n         * @return {Function} A copy of `fn` bound to the given `context`. Calling this function causes a call to `fn` with the new `context` and any `more` arguments.\n         * @sample Ink_1_bind.html\n         */\n        bind: function(fn, context) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return function() {\n                var innerArgs = Array.prototype.slice.call(arguments);\n                var finalArgs = args.concat(innerArgs);\n                return fn.apply(context === false ? this : context, finalArgs);\n            };\n        },\n\n        /**\n         * Function.prototype.bind alternative for class methods\n         * See Ink.bind. The difference between `bindMethod` and `bind` is that `bindMethod` fetches a method from an object. It can be useful, for instance, to bind a function which is a property of an object returned by another function.\n         *\n         * @method bindMethod\n         * @uses bind\n         * @param {Object}  object      The object that contains the method to bind\n         * @param {String}  methodName  The name of the method that will be bound\n         * @param {Mixed}       [more...] Additional arguments will be sent to the new method as prefix arguments.\n         * @return {Function} See Ink.bind.\n         * @sample Ink_1_bindMethod.html\n         */\n        bindMethod: function (object, methodName) {\n            return Ink.bind.apply(Ink,\n                [object[methodName], object].concat([].slice.call(arguments, 2)));\n        },\n\n        /**\n         * Function.prototype.bind alternative for event handlers.\n         * Same as bind but keeps first argument of the call the original event.\n         * Set `context` to `false` to preserve the original context of the function and just bind the arguments.\n         *\n         * @method bindEvent\n         * @param {Function}  fn        The function\n         * @param {Object}    context   The value to be passed as the this parameter to the target\n         * @param {Mixed}       [more...] Additional arguments will be sent to the original function as prefix arguments\n         * @return {Function} A function which will always call `fn` with the given event (or window.event, in IE) as the first argument.\n         * @sample Ink_1_bindEvent.html\n         */\n        bindEvent: function(fn, context) {\n            var args = Array.prototype.slice.call(arguments, 2);\n            return function(event) {\n                var finalArgs = args.slice();\n                finalArgs.unshift(event || window.event);\n                return fn.apply(context === false ? this : context, finalArgs);\n            };\n        },\n\n        /**\n         * Shorter alias to document.getElementById.\n         * Just calls `document.getElementById(id)`, unless `id` happens to be an element.\n         * If `id` is an element, `Ink.i` just returns it.\n         *\n         * You can use this in situations where you want to accept an element id, but a raw element is also okay.\n         *\n         * @method i\n         * @param {String} id Element ID\n         * @return {DOMElement|null} The element returned by `document.getElementById(id)` if `id` was a string, and `id` otherwise.\n         * @sample Ink_1_i.html\n         */\n        i: function(id) {\n            if(typeof(id) === 'string') {\n                return document.getElementById(id) || null;\n            }\n            return id;\n        },\n\n        /**\n         * Alias for Ink.Dom.Selector\n         *\n         * Using sizzle-specific selectors is NOT encouraged!\n         *\n         * @method ss\n         * @uses Ink.Dom.Selector.select\n         * @param {String}     selector          CSS3 selector string\n         * @param {DOMElement} [from=document]   Context element. If set to a DOM element, the `selector` will only look for descendants of this DOM Element.\n         * @return {Array} array of DOMElements\n         * @sample Ink_1_ss.html\n         */\n        ss: function(selector, from)\n        {\n            if(typeof(Ink.Dom) === 'undefined' || typeof(Ink.Dom.Selector) === 'undefined') {\n                throw new Error('This method requires Ink.Dom.Selector');\n            }\n            return Ink.Dom.Selector.select(selector, (from || document));\n        },\n\n        /**\n         * Selects elements like `Ink.ss`, but only returns the first element found.\n         *\n         * Using sizzle-specific selectors is NOT encouraged!\n         *\n         * @method s\n         * @uses Ink.Dom.Selector.select\n         * @param {String}     selector        CSS3 selector string\n         * @param {DOMElement} [from=document] Context element. If set to a DOM element, the `selector` will only look for descendants of this DOM Element.\n         * @return {DOMElement} The first element found which matches the `selector`, or `null` if nothing is found.\n         * @sample Ink_1_s.html\n         */\n        s: function(selector, from)\n        {\n            if(typeof(Ink.Dom) === 'undefined' || typeof(Ink.Dom.Selector) === 'undefined') {\n                throw new Error('This method requires Ink.Dom.Selector');\n            }\n            return Ink.Dom.Selector.select(selector, (from || document))[0] || null;\n        },\n\n        /**\n         * Extends an object with another\n         * Copy all of the properties in one or more source objects over to the destination object, and return the destination object. It's in-order, so the last source will override properties of the same name in previous arguments.\n         *\n         * @method extendObj\n         * @param {Object} destination  The object that will receive the new/updated properties\n         * @param {Object} source       The object whose properties will be copied over to the destination object\n         * @param {Object} [more...]    Additional source objects. The last source will override properties of the same name in the previous defined sources\n         * @return {Object} destination object, enriched with defaults from the sources\n         * @sample Ink_1_extendObj.html\n         */\n        extendObj: function(destination/*, source... */) {\n            var sources = [].slice.call(arguments, 1);\n\n            for (var i = 0, len = sources.length; i < len; i++) {\n                if (!sources[i]) { continue; }\n                for (var property in sources[i]) {\n                    if(Object.prototype.hasOwnProperty.call(sources[i], property)) {\n                        destination[property] = sources[i][property];\n                    }\n                }\n            }\n\n            return destination;\n        },\n\n        /**\n         * Calls native console.log if available.\n         *\n         * @method log\n         * @param {Mixed} [more...] Arguments to be evaluated\n         * @return {void}\n         * @sample Ink_1_log.html\n         **/\n        log: function () {\n            // IE does not have console.log.apply in IE10 emulated mode\n            var console = window.console;\n            if (console && console.log) {\n                apply.call(console.log, console, arguments);\n            }\n        },\n\n        /**\n         * Calls native console.warn if available.\n         *\n         * @method warn\n         * @param {Mixed} [more...] Arguments to be evaluated\n         * @return {void}\n         * @sample Ink_1_warn.html\n         **/\n        warn: function () {\n            // IE does not have console.log.apply in IE10 emulated mode\n            var console = window.console;\n            if (console && console.warn) {\n                apply.call(console.warn, console, arguments);\n            }\n        },\n\n        /**\n         * Calls native console.error if available.\n         *\n         * @method error\n         * @param {Mixed} [more...] Arguments to be evaluated\n         * @return {void}\n         * @sample Ink_1_error.html\n         **/\n        error: function () {\n            // IE does not have console.log.apply in IE10 emulated mode\n            var console = window.console;\n            if (console && console.error) {\n                apply.call(console.error, console, arguments);\n            }\n        }\n    };\n\n\n    // TODO for debug - to detect pending stuff\n    /*\n    var failCount = {};   // fail count per module name\n    var maxFails = 3;     // times\n    var checkDelta = 0.5; //seconds\n\n    var tmpTmr = setInterval(function() {\n        var mk = Object.keys(modulesRequested);\n        var l = mk.length;\n\n        if (l > 0) {\n            // console.log('** waiting for modules: ' + mk.join(', ') + ' **');\n\n            for (var i = 0, f = mk.length, k, v; i < f; ++i) {\n                k = mk[i];\n                v = failCount[k];\n                failCount[k] = (v === undefined) ? 1 : ++v;\n\n                if (v >= maxFails) {\n                    console.error('** Loading of module ' + k + ' failed! **');\n                    delete modulesRequested[k];\n                }\n            }\n        }\n        else {\n            // console.log('** Module loads complete. **');\n            clearInterval(tmpTmr);\n        }\n    }, checkDelta*1000);\n    */\n}(window, document));\n","/**\n * Cross Browser Ajax requests\n * @module Ink.Net.Ajax_1\n * @version 1\n */\n\nInk.createModule('Ink.Net.Ajax', '1', [], function() {\n    'use strict';\n\n    /**\n     * Creates a new XMLHttpRequest object\n     *\n     * @class Ink.Net.Ajax\n     * @constructor\n     *\n     * @param {String}          url                             Request URL\n     * @param {Object}          [options]                       Request options, containing:\n     * @param {Boolean}         [options.asynchronous=true]     If false, the request synchronous.\n     * @param {String}          [options.contentType]           Content-type header to be sent. Defaults to 'application/x-www-form-urlencoded'\n     * @param {Boolean}         [options.cors]                  Flag to activate CORS. Set this to true if you're doing a cross-origin request\n     * @param {Boolean}         [options.validateCors]          If this is set to `true`, perform a CORS request automatically based on the URL being cross-domain or not.\n     * @param {Number}          [options.delay]                 Artificial delay. If the request is completed faster than this delay, wait the remaining time before executing the callbacks\n     * @param {Boolean|String}  [options.evalJS=true]           If the request Content-type header is application/json, evaluates the response and populates responseJSON. Use 'force' if you want to force the response evaluation, no matter what Content-type it's using.\n     * @param {String}          [options.method='POST']         HTTP request method. POST by default.\n     * @param {Object|String}   [options.parameters]            Request parameters to be sent with the request\n     * @param {String}          [options.postBody]              POST request body. If not specified, it's filled with the contents from parameters\n     * @param {Object}          [options.requestHeaders]        Key-value pairs for additional request headers\n     * @param {Boolean}         [options.sanitizeJSON]          Flag to sanitize the content of responseText before evaluation\n     * @xparam {Boolean}        [options.signRequest=false]     Send a \"X-Requested-With: XMLHttpRequest\" header in the request.\n     * @param {Number}          [options.timeout]               Request timeout in seconds\n     * @param {String}          [options.xhrProxy]              URI for proxy service hosted on the same server as the web app, that can fetch documents from other domains. The service must pipe all input and output untouched (some input sanitization is allowed, like clearing cookies). e.g., requesting http://example.org/doc can become /proxy/http%3A%2F%2Fexample.org%2Fdoc The proxy service will be used for cross-domain requests, if set, else a network error is returned as exception.\n     * @param {Function}        [options.onComplete]            Callback executed after the request is completed, regardless of what happened during the request.\n     * @param {Function}        [options.onCreate]              Callback executed after object initialization but before the request is made\n     * @param {Function}        [options.onException]           Callback executed if an exception occurs. Receives the exception as a parameter.\n     * @param {Function}        [options.onFailure]             Callback executed if the request fails (requests with status codes different from 2xx)\n     * @param {Function}        [options.onHeaders]             Callback executed when headers of the response arrive.\n     * @param {Function}        [options.onInit]                Callback executed before any initialization\n     * @param {Function}        [options.onSuccess]             Callback executed if the request is successful (requests with 2xx status codes)\n     * @param {Function}        [options.onTimeout]             Callback executed if the request times out\n     *\n     * @sample Ink_Net_Ajax_1.html \n     */\n    var Ajax = function(url, options){\n        this.init(url, options);\n    };\n\n    /**\n    * Options for all requests. These can then be overriden for individual ones.\n    */\n    Ajax.globalOptions = {\n        parameters: {},\n        requestHeaders: {}\n    };\n\n\n    // IE10 does not need XDomainRequest\n    var xMLHttpRequestWithCredentials = 'XMLHttpRequest' in window && 'withCredentials' in (new XMLHttpRequest());\n\n\n\n    Ajax.prototype = {\n\n        init: function(url, userOptions) {\n            if (!url) {\n                throw new Error(\"new Ink.Net.Ajax: Pass a url as the first argument!\");\n            }\n            var options = Ink.extendObj({\n                asynchronous: true,\n                contentType:  'application/x-www-form-urlencoded',\n                cors: false,\n                validateCors: false,\n                debug: false,\n                delay: 0,\n                evalJS: true,\n                method: 'POST',\n                parameters: null,\n                postBody: '',\n                requestHeaders: null,\n                sanitizeJSON: false,\n                signRequest: false,\n                timeout: 0,\n                useCredentials: false,\n                xhrProxy: '',\n                onComplete: null,\n                onCreate: null,\n                onException: null,\n                onFailure: null,\n                onHeaders: null,\n                onInit: null,\n                onSuccess: null,\n                onTimeout: null\n            }, Ajax.globalOptions);\n\n            if (userOptions && typeof userOptions === 'object') {\n                options = Ink.extendObj(options, userOptions);\n\n\n                if (typeof userOptions.parameters === 'object') {\n                    options.parameters = Ink.extendObj(Ink.extendObj({}, Ajax.globalOptions.parameters), userOptions.parameters);\n                } else if (userOptions.parameters !== null) {\n                    var globalParameters = this.paramsObjToStr(Ajax.globalOptions.parameters);\n                    if (globalParameters) {\n                        options.parameters = userOptions.parameters + '&' + globalParameters;\n                    }\n                }\n\n                options.requestHeaders = Ink.extendObj({}, Ajax.globalOptions.requestHeaders);\n                options.requestHeaders = Ink.extendObj(options.requestHeaders, userOptions.requestHeaders);\n            }\n\n            this.options = options;\n\n            this.safeCall('onInit');\n\n            this.url = url;\n\n            var urlLocation = this._locationFromURL(url);\n            this.isHTTP = this._locationIsHTTP(urlLocation);\n            this.isCrossDomain = this._locationIsCrossDomain(urlLocation, location);\n\n            this.requestHasBody = options.method.search(/^get|head$/i) < 0;\n\n            if (this.options.validateCors === true) {\n                this.options.cors = this.isCrossDomain;\n            }\n\n            if(this.options.cors) {\n                this.isCrossDomain = false;\n            }\n\n            this.transport = this.getTransport();\n\n            this.request();\n        },\n\n        /**\n         * Returns a location object from an URL\n         *\n         * @method _locationFromUrl\n         * @param {String} url Input url\n         * @return {Location} An `<a>` element with `href` set to the given URL.\n         * @private\n         **/\n        _locationFromURL: function (url) {\n            var urlLocation =  document.createElementNS ?\n                document.createElementNS('http://www.w3.org/1999/xhtml', 'a') :\n                document.createElement('a');\n            urlLocation.setAttribute('href', url);\n            return urlLocation;\n        },\n\n        /**\n         * Checks whether a location is HTTP or HTTPS\n         *\n         * @method locationIsHttp\n         * @param {Location} urlLocation Location object or `<a>` element representing the current location.\n         * @return {Boolean} `true` if the location is HTTP or HTTPS, `false` otherwise.\n         * @private\n         */\n        _locationIsHTTP: function (urlLocation) {\n            return urlLocation.href.match(/^https?:/i) ? true : false;\n        },\n\n        /**\n         * Checks whether a location is cross-domain from ours.\n         *\n         * @method _locationIsCrossDomain\n         * @param {Location} urlLocation A Location object or an `<a>` elemnt.\n         * @param {Location} [location=window.location] A location representing this one. This argument only exists for testing. Don't use it.\n         * @return {Boolean} `true` if the locations are in different domains (in which case we need to perform a cross-domain request)\n         * @private\n         */\n        _locationIsCrossDomain: function (urlLocation, location) {\n            // TODO because of oldIE compatibility, we can only use <a>.href (the full URL), and none of the other useful properties one can find in Location elements. So we should just pass pure strings around. Not only here.\n            location = location || window.location;\n            if (!Ajax.prototype._locationIsHTTP(urlLocation) || location.protocol === 'widget:' || typeof window.widget === 'object') {\n                return false;\n            } else {\n                var split1 = urlLocation.href.split('//');\n                var split2 = location.href.split('//');\n\n                if (split1.length === 1 || split2.length === 1) {\n                    // This occurs when there's no protocol string in either URL\n                    // Only happens in IE7 because setting the \"href\" of a link doesn't make that link show you the full URL when the URI is relative to this host.\n                    // So we have our answer.\n                    // If there's no protocol string\n                    // We know for sure that our `urlLocation` is relative\n                    // In which case, they are in the same domain.\n                    return false;\n                }\n\n                var protocol1 = split1[0];\n                var protocol2 = split2[0];\n\n                var colonOrSlash = /:|\\//;  // Finds colons or slashes, which are the end of hostnames (without ports)\n\n                var host1 = split1[1].split(colonOrSlash)[0];\n                var host2 = split2[1].split(colonOrSlash)[0];\n\n                return protocol1 !== protocol2 ||\n                    host1 !== host2;\n            }\n        },\n\n        /**\n         * Creates the appropriate XMLHttpRequest object, depending on our browser and whether we're trying to perform a cross-domain request.\n         *\n         * @method getTransport\n         * @return {Object} XMLHttpRequest object\n         * @private\n         */\n        getTransport: function()\n        {\n            /*global XDomainRequest:false, ActiveXObject:false */\n            if (!xMLHttpRequestWithCredentials && this.options.cors && 'XDomainRequest' in window) {\n                this.usingXDomainReq = true;\n                return new XDomainRequest();\n            }\n            else if (typeof XMLHttpRequest !== 'undefined') {\n                return new XMLHttpRequest();\n            }\n            else if (typeof ActiveXObject !== 'undefined') {\n                try {\n                    return new ActiveXObject('Msxml2.XMLHTTP');\n                } catch (e) {\n                    return new ActiveXObject('Microsoft.XMLHTTP');\n                }\n            } else {\n                return null;\n            }\n        },\n\n        /**\n         * Set the necessary headers for an ajax request.\n         *\n         * @method setHeaders\n         * @return {void}\n         */\n        setHeaders: function()\n        {\n            if (this.transport) {\n                try {\n                    var headers = {\n                        \"Accept\": \"text/javascript,text/xml,application/xml,application/xhtml+xml,text/html,application/json;q=0.9,text/plain;q=0.8,video/x-mng,image/png,image/jpeg,image/gif;q=0.2,*/*;q=0.1\",\n                        \"Accept-Language\": navigator.language,\n                        \"X-Requested-With\": \"XMLHttpRequest\",\n                        \"X-Ink-Version\": \"3\"\n                    };\n                    if (this.options.cors) {\n                        if (!this.options.signRequest) {\n                            delete headers['X-Requested-With'];\n                        }\n                        delete headers['X-Ink-Version'];\n                    }\n\n                    if (this.options.requestHeaders && typeof this.options.requestHeaders === 'object') {\n                        for(var headerReqName in this.options.requestHeaders) {\n                            if (this.options.requestHeaders.hasOwnProperty(headerReqName)) {\n                                headers[headerReqName] = this.options.requestHeaders[headerReqName];\n                            }\n                        }\n                    }\n\n                    if (this.transport.overrideMimeType && (navigator.userAgent.match(/Gecko\\/(\\d{4})/) || [0,2005])[1] < 2005) {\n                        headers.Connection = 'close';\n                    }\n\n                    for (var headerName in headers) {\n                        if(headers.hasOwnProperty(headerName)) {\n                            this.transport.setRequestHeader(headerName, headers[headerName]);\n                        }\n                    }\n                } catch(e) {}\n            }\n        },\n\n        /**\n         * Converts an object with parameters to a querystring\n         *\n         * @method paramsObjToStr\n         * @param {Object} optParams Parameters object, example: `{ a: 2, b: 3 }`\n         * @return {String} A query string. Example: `'a=2&b=3'`\n         * @private\n         */\n        paramsObjToStr: function(optParams) {\n            var k, m, p, a, params = [];\n            if (typeof optParams === 'object') {\n                for (p in optParams){\n                    if (optParams.hasOwnProperty(p)) {\n                        a = optParams[p];\n                        if (Object.prototype.toString.call(a) === '[object Array]' && !isNaN(a.length)) {\n                            for (k = 0, m = a.length; k < m; k++) {\n                                params = params.concat([\n                                    encodeURIComponent(p), '[]',   '=',\n                                    encodeURIComponent(a[k]), '&'\n                                ]);\n                            }\n                        }\n                        else {\n                            params = params.concat([\n                                encodeURIComponent(p), '=',\n                                encodeURIComponent(a), '&'\n                            ]);\n                        }\n                    }\n                }\n                if (params.length > 0) {\n                    params.pop();\n                }\n            }\n            else\n            {\n                return optParams;\n            }\n            return params.join('');\n        },\n\n        /**\n         * Set the url parameters for a GET request\n         *\n         * @method setParams\n         * @return {void}\n         * @private\n         */\n        setParams: function()\n        {\n            var params = null, optParams = this.options.parameters;\n\n            if(typeof optParams === \"object\"){\n                params = this.paramsObjToStr(optParams);\n            } else {\n                params = '' + optParams;\n            }\n\n            if(params){\n                if(this.url.indexOf('?') > -1) {\n                    this.url = this.url.split('#')[0] + '&' + params;\n                } else {\n                    this.url = this.url.split('#')[0] + '?' + params;\n                }\n            }\n        },\n\n        /**\n         * Gets an HTTP header from the response\n         *\n         * @method getHeader\n         * @param {String} name Header name\n         * @return {String} Header content\n         * @public\n         */\n        getHeader: function(name)\n        {\n            if (this.usingXDomainReq && name === 'Content-Type') {\n                return this.transport.contentType;\n            }\n            try{\n                return this.transport.getResponseHeader(name);\n            } catch(e) {\n                return null;\n            }\n        },\n\n        /**\n         * Gets all the HTTP headers from the response\n         *\n         * @method getAllHeaders\n         * @return {String} The headers, each separated by a newline\n         * @public\n         */\n        getAllHeaders: function()\n        {\n            try {\n                return this.transport.getAllResponseHeaders();\n            } catch(e) {\n                return null;\n            }\n        },\n\n        /**\n         * Gets the ajax response object\n         *\n         * @method getResponse\n         * @return {Object} The response object\n         * @public\n         */\n        getResponse: function(){\n            // setup our own stuff\n            var t = this.transport,\n                r = {\n                    headerJSON: null,\n                    responseJSON: null,\n                    getHeader: this.getHeader,\n                    getAllHeaders: this.getAllHeaders,\n                    request: this,\n                    transport: t,\n                    timeTaken: new Date() - this.startTime,\n                    requestedUrl: this.url\n                };\n\n            // setup things expected from the native object\n            r.readyState = t.readyState;\n            try { r.responseText = t.responseText; } catch(e) {}\n            try { r.responseXML  = t.responseXML;  } catch(e) {}\n            try { r.status       = t.status;       } catch(e) { r.status     = 0;  }\n            try { r.statusText   = t.statusText;   } catch(e) { r.statusText = ''; }\n\n            return r;\n        },\n\n        /**\n         * Aborts the request if still running. No callbacks are called\n         *\n         * @method abort\n         * @return {void}\n         * @public\n         */\n        abort: function(){\n            if (this.transport) {\n                clearTimeout(this.delayTimeout);\n                clearTimeout(this.stoTimeout);\n                try { this.transport.abort(); } catch(ex) {}\n                this.finish();\n            }\n        },\n\n        /**\n         * Executes the state changing phase of an ajax request\n         *\n         * @method runStateChange\n         * @return {void}\n         * @public\n         */\n        runStateChange: function()\n        {\n            var rs = this.transport.readyState;\n            if (rs === 3) {\n                if (this.isHTTP) {\n                    this.safeCall('onHeaders');\n                }\n            } else if (rs === 4 || this.usingXDomainReq) {\n\n                if (this.options.asynchronous && this.options.delay && (this.startTime + this.options.delay > new Date().getTime())) {\n                    this.delayTimeout = setTimeout(Ink.bind(this.runStateChange, this), this.options.delay + this.startTime - new Date().getTime());\n                    return;\n                }\n\n                var responseJSON,\n                    responseContent = this.transport.responseText,\n                    response = this.getResponse(),\n                    curStatus = this.transport.status;\n\n                if (this.isHTTP && !this.options.asynchronous) {\n                    this.safeCall('onHeaders');\n                }\n\n                clearTimeout(this.stoTimeout);\n\n                if (curStatus === 0) {\n                    // Status 0 indicates network error for http requests.\n                    // For http less requests, 0 is always returned.\n                    if (this.isHTTP) {\n                        this.safeCall('onException', new Error('Ink.Net.Ajax: network error! (HTTP status 0)'));\n                    } else {\n                        curStatus = responseContent ? 200 : 404;\n                    }\n                }\n                else if (curStatus === 304) {\n                    curStatus = 200;\n                }\n                var isSuccess = this.usingXDomainReq || 200 <= curStatus && curStatus < 300;\n\n                var headerContentType = this.getHeader('Content-Type') || '';\n                if (this.options.evalJS &&\n                    (headerContentType.indexOf(\"application/json\") >= 0 || this.options.evalJS === 'force')){\n                        try {\n                            responseJSON = this.evalJSON(responseContent, this.sanitizeJSON);\n\n                            if(responseJSON){\n                                responseContent = response.responseJSON = responseJSON;\n                            }\n                        } catch(e){\n                            if (isSuccess) {\n                                // If the request failed, then this is perhaps an error page\n                                // so don't notify error.\n                                this.safeCall('onException', e);\n                            }\n                        }\n                }\n\n                if (this.usingXDomainReq && headerContentType.indexOf('xml') !== -1 && 'DOMParser' in window) {\n                    // http://msdn.microsoft.com/en-us/library/ie/ff975278(v=vs.85).aspx\n                    var mimeType;\n                    switch (headerContentType) {\n                        case 'application/xml':\n                        case 'application/xhtml+xml':\n                        case 'image/svg+xml':\n                            mimeType = headerContentType;\n                            break;\n                        default:\n                            mimeType = 'text/xml';\n                    }\n                    var xmlDoc = (new DOMParser()).parseFromString( this.transport.responseText, mimeType);\n                    this.transport.responseXML = xmlDoc;\n                    response.responseXML  = xmlDoc;\n                }\n\n                if (this.transport.responseXML != null && response.responseJSON == null && this.transport.responseXML.xml !== \"\"){\n                    responseContent = this.transport.responseXML;\n                }\n\n                if (curStatus || this.usingXDomainReq) {\n                    if (isSuccess) {\n                        this.safeCall('onSuccess', response, responseContent);\n                    } else {\n                        this.safeCall('onFailure', response, responseContent);\n                    }\n                    this.safeCall('on'+curStatus, response, responseContent);\n                }\n                this.finish(response, responseContent);\n            }\n        },\n\n        /**\n         * Last step after XHR is complete. Call onComplete and cleanup object\n         *\n         * @method finish\n         * @param {Mixed} response Response object as returned from getResponse().\n         * @param {Mixed} responseContent Content of the response.\n         * @return {void}\n         * @private\n         */\n        finish: function(response, responseContent){\n            if (response) {\n                this.safeCall('onComplete', response, responseContent);\n            }\n            clearTimeout(this.stoTimeout);\n\n            if (this.transport) {\n                // IE6 sometimes barfs on this one\n                try{ this.transport.onreadystatechange = null; } catch(e){}\n\n                if (typeof this.transport.destroy === 'function') {\n                    // Stuff for Samsung.\n                    this.transport.destroy();\n                }\n\n                // Let XHR be collected.\n                this.transport = null;\n            }\n        },\n\n        /**\n         * Safely calls a callback function.\n         * Verifies that the callback is well defined and traps errors\n         *\n         * If you pass in an error as the second argument, it gets thrown if there is no default listener.\n         *\n         * @method safeCall\n         * @param {Function}  handlerName Name of the handler we wish to call\n         * @param {Error}     error     This error gets reported to the console using Ink.error if there's no listener to `handlerName`.\n         * @param {Mixed}     [args...] Arguments to get passed to the `handlerName` handler.\n         * @return {void}\n         * @private\n         */\n        safeCall: function(handlerName /*[error or rest...]*/) {\n            var error = arguments[1] instanceof Error ? arguments[1] : null;\n            if (typeof this.options[handlerName] === 'function') {\n                try {\n                    this.options[handlerName].apply(this, [].slice.call(arguments, 1));\n                } catch(ex) {\n                    Ink.error('Ink.Net.Ajax: an error was raised while executing ' + handlerName + '.', ex);\n                }\n            } else if (error) {\n                Ink.error('Ink.Net.Ajax: ' + error);\n            }\n        },\n\n        /**\n         * Sets a new request header for the next http request\n         *\n         * @method setRequestHeader\n         * @param {String} name Header name.\n         * @param {String} value New header value.\n         * @return {void}\n         * @public\n         */\n        setRequestHeader: function(name, value){\n            if (!this.options.requestHeaders) {\n                this.options.requestHeaders = {};\n            }\n            this.options.requestHeaders[name] = value;\n        },\n\n        /**\n         * Executes the request\n         *\n         * @method request\n         * @return {void}\n         * @private\n         */\n        request: function()\n        {\n            if(this.transport) {\n                var params = null;\n                if(this.requestHasBody) {\n                    if(this.options.postBody !== null && this.options.postBody !== '') {\n                        params = this.options.postBody;\n                        this.setParams();\n                    } else if (this.options.parameters !== null && this.options.parameters !== ''){\n                        params = this.options.parameters;\n                    }\n\n                    if (typeof params === \"object\" && !params.nodeType) {\n                        params = this.paramsObjToStr(params);\n                    } else if (typeof params !== \"object\" && params !== null){\n                        params = '' + params;\n                    }\n\n                    if(this.options.contentType) {\n                        this.setRequestHeader('Content-Type', this.options.contentType);\n                    }\n                } else {\n                    this.setParams();\n                }\n\n                var url = this.url;\n                var method = this.options.method;\n                var crossDomain = this.isCrossDomain;\n\n                if (crossDomain && this.options.xhrProxy) {\n                    this.setRequestHeader('X-Url', url);\n                    url = this.options.xhrProxy + encodeURIComponent(url);\n                    crossDomain = false;\n                }\n\n                try {\n                    this.transport.open(method, url, this.options.asynchronous);\n                } catch(e) {\n                    this.safeCall('onException', e);\n                    return this.finish(this.getResponse(), null);\n                }\n\n                this.setHeaders();\n\n                this.safeCall('onCreate');\n\n                if(this.options.timeout && !isNaN(this.options.timeout)) {\n                    this.stoTimeout = setTimeout(Ink.bind(function() {\n                        if(this.options.onTimeout) {\n                            this.safeCall('onTimeout');\n                            this.abort();\n                        }\n                    }, this), (this.options.timeout * 1000));\n                }\n\n                if(this.options.useCredentials && !this.usingXDomainReq) {\n                    this.transport.withCredentials = true;\n                }\n\n                if(this.options.asynchronous && !this.usingXDomainReq) {\n                    this.transport.onreadystatechange = Ink.bind(this.runStateChange, this);\n                }\n                else if (this.usingXDomainReq) {\n                    this.transport.onload = Ink.bind(this.runStateChange, this);\n                }\n\n                try {\n                    if (crossDomain) {\n                        // Need explicit handling because Mozila aborts\n                        // the script and Chrome fails silently.per the spec\n                        Ink.error('Ink.Net.Ajax: You are attempting to request a URL which is cross-domain from this one. To do this, you *must* enable the `cors` option!');\n                        return;\n                    } else {\n                        this.startTime = new Date().getTime();\n                        this.transport.send(params);\n                    }\n                } catch(e) {\n                    this.safeCall('onException', e);\n                    return this.finish(this.getResponse(), null);\n                }\n\n                if(!this.options.asynchronous) {\n                    this.runStateChange();\n                }\n            }\n        },\n\n        /**\n         * Checks if a given string is valid JSON\n         *\n         * @method isJSON\n         * @param {String} str  String to be evaluated\n         * @return {Boolean}    True if the string is valid JSON\n         * @public\n         */\n        isJSON: function(str)\n        {\n            if (typeof str !== \"string\" || !str){ return false; }\n            str = str.replace(/\\\\./g, '@').replace(/\"[^\"\\\\\\n\\r]*\"/g, '');\n            return (/^[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]*$/).test(str);\n        },\n\n        /**\n         * Evaluates a given string as JSON\n         *\n         * @method evalJSON\n         * @param {String}  strJSON  String to be evaluated\n         * @param {Boolean} sanitize Flag to sanitize the content\n         * @return {Object} JSON content as an object\n         * @public\n         */\n        evalJSON: function(strJSON, sanitize)\n        {\n            if (strJSON && (!sanitize || this.isJSON(strJSON))) {\n                try {\n                    if (typeof JSON  !== \"undefined\" && typeof JSON.parse !== 'undefined'){\n                        return JSON.parse(strJSON);\n                    }\n                    /*jshint evil:true */\n                    return eval('(' + strJSON + ')');\n                } catch(e) {\n                    throw new Error('Ink.Net.Ajax: Bad JSON string. ' + e);\n                }\n            }\n            return null;\n        }\n    };\n\n    /**\n     * Loads content from a given url through an XMLHttpRequest.\n     *\n     * Shortcut function for simple AJAX use cases. Works with JSON, XML and plain text.\n     *\n     * @method load\n     * @param {String}   url        Request URL\n     * @param {Function} callback   Callback to be executed if the request is successful\n     * @return {Object}             XMLHttpRequest object\n     * @public\n     *\n     * @sample Ink_Net_Ajax_load.html \n     */\n    Ajax.load = function(url, callback){\n        var isCrossDomain = Ajax.prototype._locationIsCrossDomain(window.location, Ajax.prototype._locationFromURL(url));\n        return new Ajax(url, {\n            method: 'GET',\n            cors: isCrossDomain,\n            onSuccess: function(response){\n                callback(response.responseJSON || response.responseText, response);\n            }\n        });\n    };\n\n    /**\n     * Loads content from a given url through an XMLHttpRequest.\n     * Shortcut function for simple AJAX use cases.\n     *\n     * @method ping\n     * @param {String}   url        Request url\n     * @param {Function} callback   Callback to be executed if the request is successful\n     * @public\n     * @return {Object}             XMLHttpRequest object\n     */\n    Ajax.ping = function(url, callback){\n        var isCrossDomain = Ajax.prototype._locationIsCrossDomain(window.location, Ajax.prototype._locationFromURL(url));\n        return new Ajax(url, {\n            method: 'HEAD',\n            cors: isCrossDomain,\n            onSuccess: function(response){\n                if (typeof callback === 'function'){\n                    callback(response);\n                }\n            }\n        });\n    };\n\n\n    return Ajax;\n});\n","/**\n * Cross Browser JsonP requests\n * @module Ink.Net.JsonP_1\n * @version 1\n */\n\nInk.createModule('Ink.Net.JsonP', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * Executes a JSONP request\n     *\n     * @class Ink.Net.JsonP\n     * @constructor\n     *\n     * @param {String}      uri                         Request URL\n     * @param {Object}      options                     Request options\n     * @param {Function}    options.onSuccess           Success callback. Called with the JSONP response.\n     * @param {Function}    [options.onFailure]         Failure callback. Called when there is a timeout.\n     * @param {Object}      [options.failureObj]        Object to be passed as argument to failure callback\n     * @param {Number}      [options.timeout]           Timeout for the request, in seconds. defaults to 10.\n     * @param {Object}      [options.params]            Object with URL parameters.\n     * @param {String}      [options.callbackParam]     URL parameter which gets the name of the JSONP function to call. defaults to 'jsoncallback'.\n     * @param {String}      [options.randVar]           (Advanced, not recommended unless you know what you're doing) A string to append to the callback name. By default, generate a random number. Use an empty string if you already passed the correct name in the internalCallback option.\n     * @param {String}      [options.internalCallback]  (Advanced) Name of the callback function stored in the Ink.Net.JsonP object (before it's prefixed).\n     *\n     * @sample Ink_Net_JsonP_1.html \n     */\n    var JsonP = function(uri, options) {\n        this.init(uri, options);\n    };\n\n    JsonP.prototype = {\n\n        init: function(uri, options) {\n            this.options = Ink.extendObj( {\n                onSuccess:          undefined,\n                onFailure:          undefined,\n                failureObj:         {},\n                timeout:            10,\n                params:             {},\n                callbackParam:      'jsoncallback',\n                internalCallback:   '_cb',\n                randVar:            false\n            }, options || {});\n\n            if(this.options.randVar !== false) {\n                this.randVar = this.options.randVar;\n            } else {\n                this.randVar = parseInt(Math.random() * 100000, 10);\n            }\n\n            this.options.internalCallback += this.randVar;\n\n            this.uri = uri;\n\n            // prevent SAPO legacy onComplete - make it onSuccess\n            if(typeof(this.options.onComplete) === 'function') {\n                this.options.onSuccess = this.options.onComplete;\n            }\n\n            if (typeof this.uri !== 'string') {\n                throw new Error('Ink.Net.JsonP: Please define an URI');\n            }\n\n            if (typeof this.options.onSuccess !== 'function') {\n                throw new Error('Ink.Net.JsonP: please define a callback function on option onSuccess!');\n            }\n\n            Ink.Net.JsonP[this.options.internalCallback] = Ink.bind(function() {\n                this.options.onSuccess(arguments[0]);\n                this._cleanUp();\n            }, this);\n\n            this.timeout = setTimeout(Ink.bind(function () {\n                this.abort();\n                if(typeof this.options.onFailure === 'function'){\n                    this.options.onFailure(this.options.failureObj);\n                }\n            }, this),\n            this.options.timeout * 1000);\n\n            this._addScriptTag();\n        },\n\n        /**\n         * Abort the request, avoiding onSuccess or onFailure being called.\n         * @method abort\n         * @return {void}\n         **/\n        abort: function () {\n            Ink.Net.JsonP[this.options.internalCallback] = Ink.bindMethod(this, '_cleanUp');\n        },\n\n        _addParamsToGet: function(uri, params) {\n            var hasQuestionMark = uri.indexOf('?') !== -1;\n            var sep, pKey, pValue, parts = [uri];\n\n            for (pKey in params) {\n                if (params.hasOwnProperty(pKey)) {\n                    if (!hasQuestionMark) { sep = '?';  hasQuestionMark = true; }\n                    else {                  sep = '&';                          }\n                    pValue = params[pKey];\n                    if (typeof pValue !== 'number' && !pValue) {    pValue = '';    }\n                    parts = parts.concat([sep, pKey, '=', encodeURIComponent(pValue)]);\n                }\n            }\n\n            return parts.join('');\n        },\n\n        _getScriptContainer: function() {\n            return document.body ||\n                document.getElementsByTagName('body')[0] ||\n                document.getElementsByTagName('head')[0] ||\n                document.documentElement;\n        },\n\n        _addScriptTag: function() {\n            // enrich options will callback and random seed\n            this.options.params[this.options.callbackParam] = 'Ink.Net.JsonP.' + this.options.internalCallback;\n            this.options.params.rnd_seed = this.randVar;\n            this.uri = this._addParamsToGet(this.uri, this.options.params);\n            // create script tag\n            this._scriptEl = document.createElement('script');\n            this._scriptEl.type = 'text/javascript';\n            this._scriptEl.src = this.uri;\n            var scriptCtn = this._getScriptContainer();\n            scriptCtn.appendChild(this._scriptEl);\n        },\n\n        _cleanUp: function () {\n            if (this.timeout) {\n                window.clearTimeout(this.timeout);\n            }\n            delete this.options.onSuccess;\n            delete this.options.onFailure;\n            delete Ink.Net.JsonP[this.options.internalCallback];\n            this._removeScriptTag();\n        },\n\n        _removeScriptTag: function() {\n            if (!this._scriptEl) { return; /* already removed */ }\n            this._scriptEl.parentNode.removeChild(this._scriptEl);\n            delete this._scriptEl;\n        }\n    };\n\n    return JsonP;\n\n});\n","/**\n * Browser Detection and User Agent sniffing\n * @module Ink.Dom.Browser_1\n * @version 1\n */\nInk.createModule('Ink.Dom.Browser', '1', [], function() {\n    'use strict';    \n\n    /**\n     * @namespace Ink.Dom.Browser\n     * @version 1\n     * @static\n     * @example\n     *     <script>\n     *         Ink.requireModules(['Ink.Dom.Browser_1'],function( InkBrowser ){\n     *             if( InkBrowser.CHROME ){\n     *                 console.log( 'This is a CHROME browser.' );\n     *             }\n     *         });\n     *     </script>\n     */\n    var Browser = {\n        /**\n         * True if the browser is Internet Explorer\n         *\n         * @property IE\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        IE: false,\n\n        /**\n         * True if the browser is Gecko based\n         *\n         * @property GECKO\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        GECKO: false,\n\n        /**\n         * True if the browser is Opera\n         *\n         * @property OPERA\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        OPERA: false,\n\n        /**\n         * True if the browser is Safari\n         *\n         * @property SAFARI\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        SAFARI: false,\n\n        /**\n         * True if the browser is Konqueror\n         *\n         * @property KONQUEROR\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        KONQUEROR: false,\n\n        /**\n         * True if browser is Chrome\n         *\n         * @property CHROME\n         * @type {Boolean}\n         * @public\n         * @static\n         */\n        CHROME: false,\n\n        /**\n         * The specific browser model.\n         * False if it is unavailable.\n         *\n         * @property model\n         * @type {Boolean|String}\n         * @public\n         * @static\n         */\n        model: false,\n\n        /**\n         * The browser version.\n         * False if it is unavailable.\n         *\n         * @property version\n         * @type {Boolean|String}\n         * @public\n         * @static\n         */\n        version: false,\n\n        /**\n         * The user agent string.\n         * False if it is unavailable.\n         *\n         * @property userAgent\n         * @type {Boolean|String}\n         * @public\n         * @static\n         */\n        userAgent: false,\n\n        /**\n         * The CSS prefix (-moz-, -webkit-, -ms-, ...)\n         * False if it is unavailable \n         *\n         * @property cssPrefix \n         * @type {Boolean|String}\n         * @public \n         * @static \n         */\n        cssPrefix: false, \n\n        /**\n         * The DOM prefix (Moz, Webkit, ms, ...)\n         * False if it is unavailable \n         * @property domPrefix \n         * @type {Boolean|String}\n         * @public \n         * @static \n         */\n        domPrefix: false,\n\n        /**\n         * Initialization function for the Browser object.\n         *\n         * Is called automatically when this module is loaded, and calls setDimensions, setBrowser and setReferrer.\n         *\n         * @method init\n         * @return {void}\n         * @public\n         */\n        init: function() {\n            this.detectBrowser();\n            this.setDimensions();\n            this.setReferrer();\n        },\n\n        /**\n         * Retrieves and stores window dimensions in this object. Called automatically when this module is loaded.\n         *\n         * @method setDimensions\n         * @return {void}\n         * @public\n         */\n        setDimensions: function() {\n            //this.windowWidth=window.innerWidth !== null? window.innerWidth : document.documentElement && document.documentElement.clientWidth ? document.documentElement.clientWidth : document.body !== null ? document.body.clientWidth : null;\n            //this.windowHeight=window.innerHeight != null? window.innerHeight : document.documentElement && document.documentElement.clientHeight ? document.documentElement.clientHeight : document.body != null? document.body.clientHeight : null;\n            var myWidth = 0, myHeight = 0;\n            if ( typeof window.innerWidth=== 'number' ) {\n                myWidth = window.innerWidth;\n                myHeight = window.innerHeight;\n            } else if( document.documentElement && ( document.documentElement.clientWidth || document.documentElement.clientHeight ) ) {\n                myWidth = document.documentElement.clientWidth;\n                myHeight = document.documentElement.clientHeight;\n            } else if( document.body && ( document.body.clientWidth || document.body.clientHeight ) ) {\n                myWidth = document.body.clientWidth;\n                myHeight = document.body.clientHeight;\n            }\n            this.windowWidth = myWidth;\n            this.windowHeight = myHeight;\n        },\n\n        /**\n         * Stores the referrer. Called automatically when this module is loaded.\n         *\n         * @method setReferrer\n         * @return {void}\n         * @public\n         */\n        setReferrer: function() {\n            if (document.referrer && document.referrer.length) {\n                this.referrer = window.escape(document.referrer);\n            } else {\n                this.referrer = false;\n            }\n        },\n\n        /**\n         * Detects the browser and stores the found properties. Called automatically when this module is loaded.\n         *\n         * @method detectBrowser\n         * @return {void}\n         * @public\n         */\n        detectBrowser: function() {\n            this._sniffUserAgent(navigator.userAgent);\n        },\n\n        _sniffUserAgent: function (sAgent) {\n            this.userAgent = sAgent;\n\n            sAgent = sAgent.toLowerCase();\n\n            if (/applewebkit\\//.test(sAgent)) {\n                this.cssPrefix = '-webkit-';\n                this.domPrefix = 'Webkit';\n                if(/(chrome|crios)\\//.test(sAgent)) {\n                    // Chrome\n                    this.CHROME = true;\n                    this.model = 'chrome';\n                    this.version = sAgent.replace(/(.*)chrome\\/([^\\s]+)(.*)/, \"$2\");\n                } else {\n                    // Safari\n                    this.SAFARI = true;\n                    this.model = 'safari';\n                    var rVersion = /version\\/([^) ]+)/;\n                    if (rVersion.test(sAgent)) {\n                        this.version = sAgent.match(rVersion)[1];\n                    } else {\n                        this.version = sAgent.replace(/(.*)applewebkit\\/([^\\s]+)(.*)/, \"$2\");\n                    }\n                }\n            } else if (/opera/.test(sAgent)) {\n                // Opera\n                this.OPERA = true;\n                this.model = 'opera';\n                this.version = sAgent.replace(/(.*)opera.([^\\s$]+)(.*)/, \"$2\");\n                this.cssPrefix = '-o-';\n                this.domPrefix = 'O';\n            } else if (/konqueror/.test(sAgent)) {\n                // Konqueroh\n                this.KONQUEROR = true;\n                this.model = 'konqueror';\n                this.version = sAgent.replace(/(.*)konqueror\\/([^;]+);(.*)/, \"$2\");\n                this.cssPrefix = '-khtml-';\n                this.domPrefix = 'Khtml';\n            } else if (/(msie|trident)/i.test(sAgent)) {\n                // MSIE\n                this.IE = true;\n                this.model = 'ie';\n                if (/rv:((?:\\d|\\.)+)/.test(sAgent)) {  // IE 11\n                    this.version = sAgent.match(/rv:((?:\\d|\\.)+)/)[1];\n                } else {\n                    this.version = sAgent.replace(/(.*)\\smsie\\s([^;]+);(.*)/, \"$2\");\n                }\n                this.cssPrefix = '-ms-';\n                this.domPrefix = 'ms';\n            } else if (/gecko/.test(sAgent)) {\n                // GECKO\n                // Supports only:\n                // Camino, Chimera, Epiphany, Minefield (firefox 3), Firefox, Firebird, Phoenix, Galeon,\n                // Iceweasel, K-Meleon, SeaMonkey, Netscape, Songbird, Sylera,\n                this.cssPrefix = '-moz-';\n                this.domPrefix = 'Moz';\n\n                this.GECKO = true;\n\n                var re = /(camino|chimera|epiphany|minefield|firefox|firebird|phoenix|galeon|iceweasel|k\\-meleon|seamonkey|netscape|songbird|sylera)/;\n                if(re.test(sAgent)) {\n                    this.model = sAgent.match(re)[1];\n                    this.version = sAgent.replace(new RegExp(\"(.*)\"+this.model+\"\\/([^;\\\\s$]+)(.*)\"), \"$2\");\n                } else {\n                    // probably is mozilla\n                    this.model = 'mozilla';\n                    var reVersion = /(.*)rv:([^)]+)(.*)/;\n                    if(reVersion.test(sAgent)) {\n                        this.version = sAgent.replace(reVersion, \"$2\");\n                    }\n                }\n            }\n        },\n\n        /**\n         * Debug function which displays browser (and Ink.Dom.Browser) information as an alert message.\n         *\n         * @method debug\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Browser_1_debug.html\n         */\n        debug: function() {\n            /*global alert:false */\n            var str = \"known browsers: (ie, gecko, opera, safari, konqueror) \\n\";\n            str += [this.IE, this.GECKO, this.OPERA, this.SAFARI, this.KONQUEROR] +\"\\n\";\n            str += \"cssPrefix -> \"+this.cssPrefix+\"\\n\";\n            str += \"domPrefix -> \"+this.domPrefix+\"\\n\";\n            str += \"model -> \"+this.model+\"\\n\";\n            str += \"version -> \"+this.version+\"\\n\";\n            str += \"\\n\";\n            str += \"original UA -> \"+this.userAgent;\n\n            alert(str);\n        }\n    };\n\n    Browser.init();\n\n    return Browser;\n});\n","/**\n * CSS Utilities and toolbox\n * @module Ink.Dom.Css_1\n * @version 1\n */\n\nInk.createModule( 'Ink.Dom.Css', 1, [], function() {\n\n    'use strict';\n\n     // getComputedStyle feature detection.\n     var getCs = (\"defaultView\" in document) && (\"getComputedStyle\" in document.defaultView) ? document.defaultView.getComputedStyle : window.getComputedStyle;\n\n    /**\n     * @namespace Ink.Dom.Css\n     * @static\n     */\n\n    var Css = {\n        /**\n         * Adds of removes a class.\n         * Depending on addRemState, this method either adds a class if it's true or removes if if false.\n         *\n         * @method addRemoveClassName\n         * @param {DOMElement|string}   elm          DOM element or element id\n         * @param {string}              className    class name to add or remove.\n         * @param {boolean}             addRemState  Whether to add or remove. `true` to add, `false` to remove.\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_addRemoveClassName.html \n         */\n        addRemoveClassName: function(elm, className, addRemState) {\n            if (addRemState) {\n                return this.addClassName(elm, className);\n            }\n            this.removeClassName(elm, className);\n        },\n\n        /**\n         * Adds a class to a given element\n         *\n         * @method addClassName\n         * @param {Element|String}      elm          Element or element id\n         * @param {String|Array}        className    Class or classes to add. Examples: 'my-class', ['my-class', 'other-class'], 'my-class other-class'\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_addClassName.html\n         */\n        addClassName: function(elm, className) {\n            elm = Ink.i(elm);\n            if (!elm || !className) { return null; }\n            className = ('' + className).split(/[, ]+/);\n            var i = 0;\n            var len = className.length;\n\n            for (; i < len; i++) {\n                // remove whitespace and ignore on empty string\n                if (className[i].replace(/^\\s+|\\s+$/g, '')) {\n                    if (typeof elm.classList !== \"undefined\") {\n                        elm.classList.add(className[i]);\n                    } else if (!Css.hasClassName(elm, className[i])) {\n                        elm.className += (elm.className ? ' ' : '') + className[i];\n                    }\n                }\n            }\n        },\n\n        /**\n         * Removes a class from a given element\n         *\n         * @method removeClassName\n         * @param {DOMElement|String}   elm        DOM element or element id\n         * @param {String|Array}        className  Class names to remove. You can either use a space separated string of classnames, comma-separated list or an array\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_removeClassName.html \n         */\n        removeClassName: function(elm, className) {\n            elm = Ink.i(elm);\n            if (!elm || !className) { return null; }\n            \n            className = ('' + className).split(/[, ]+/);\n            var i = 0;\n            var len = className.length;\n\n            if (typeof elm.classList !== \"undefined\"){\n                for (; i < len; i++) {\n                    elm.classList.remove(className[i]);\n                }\n            } else {\n                var elmClassName = elm.className || '';\n                var re;\n                for (; i < len; i++) {\n                    re = new RegExp(\"(^|\\\\s+)\" + className[i] + \"(\\\\s+|$)\");\n                    elmClassName = elmClassName.replace(re, ' ');\n                }\n                elm.className = (elmClassName\n                    .replace(/^\\s+/, '')\n                    .replace(/\\s+$/, ''));\n            }\n        },\n\n        /**\n         * Alias to addRemoveClassName. \n         * Utility function, saves many if/elses.\n         *\n         * @method setClassName\n         * @uses addRemoveClassName\n         * @param {DOMElement|String}  elm          DOM element or element id\n         * @param {String|Array}       className    Class names to add\\remove. Comma separated, space separated or simply an Array\n         * @param {Boolean}            [add]=false  Flag to switch behavior from removal to addition. true to add, false to remove\n         * @return {void}\n         * @public\n         */\n        setClassName: function(elm, className, add) {\n            this.addRemoveClassName(elm, className, add || false);\n        },\n\n        /**\n         * Checks if an element has a class.\n         * This method verifies if an element has ONE of a list of classes. If the last argument is flagged as true, instead checks if the element has ALL the classes\n         * \n         * @method hasClassName\n         * @param {DOMElement|String}  elm         DOM element or element id\n         * @param {String|Array}       className   Class name(s) to test\n         * @param {Boolean}            [all=false] Irrelevant if only one `className` is passed. If `true`, check if the element contains ALL the CSS classes. If `false`, check whether the element contains ANY of the given classes.\n         * @return {Boolean} `true` if a given class is applied to a given element, `false` if it isn't.\n         * @public\n         * @sample Ink_Dom_Css_hasClassName.html \n         */\n        hasClassName: function(elm, className, all) {\n            elm = Ink.i(elm);\n            if (!elm || !className) { return false; }\n\n            className = ('' + className).split(/[, ]+/);\n            var i = 0;\n            var len = className.length;\n            var has;\n            var re;\n\n            for ( ; i < len; i++) {\n                if (typeof elm.classList !== \"undefined\"){\n                    has = elm.classList.contains(className[i]);\n                } else {\n                    var elmClassName = elm.className;\n                    if (elmClassName === className[i]) {\n                        has = true;\n                    } else {\n                        re = new RegExp(\"(^|\\\\s)\" + className[i] + \"(\\\\s|$)\");\n                        has = re.test(elmClassName);\n                    }\n                }\n                if (has && !all) { return true; }  // return if looking for any class\n                if (!has && all) { return false; }  // return if looking for all classes\n            }\n\n            if (all) {\n                // if we got here, all classes were found so far\n                return true;\n            } else {\n                // if we got here with all == false, no class was found\n                return false;\n            }\n        },\n\n        /**\n         * Blinks a class from an element\n         * Add and removes the class from the element with a timeout, so it blinks\n         *\n         * @method blinkClass\n         * @uses addRemoveClassName\n         * @param {Element|String}     element    DOM element or element id\n         * @param {String|Array}       className  Class name(s) to blink\n         * @param {Number}             timeout    timeout in ms between adding and removing, default 100 ms\n         * @param {Boolean}            negate     is true, class is removed then added\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_blinkClass.html \n         */\n        blinkClass: function(element, className, timeout, negate){\n            element = Ink.i(element);\n            Css.addRemoveClassName(element, className, !negate);\n            setTimeout(function() {\n                Css.addRemoveClassName(element, className, negate);\n            }, Number(timeout) || 100);\n        },\n\n        /**\n         * Toggles a class name from a given element\n         *\n         * @method toggleClassName\n         * @param {DOMElement|String}  elm        DOM element or element id\n         * @param {String}             className  Class name\n         * @param {Boolean}            [forceAdd] Flag to force adding the the classe names if they don't exist yet.\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_toggleClassName.html \n         */\n        toggleClassName: function(elm, className, forceAdd) {\n            if (!elm || !className) { return false; }\n\n            if (typeof forceAdd !== 'undefined') {\n                return Css.addRemoveClassName(elm, className, forceAdd);\n            } else if (typeof elm.classList !== \"undefined\" && !/[, ]/.test(className)) {\n                elm = Ink.i(elm);\n                if (elm !== null){\n                    elm.classList.toggle(className);\n                }\n            } else {\n                if (Css.hasClassName(elm, className)) {\n                    Css.removeClassName(elm, className);\n                } else {\n                    Css.addClassName(elm, className);\n                }\n            }\n        },\n\n        /**\n         * Sets the opacity of given element \n         *\n         * @method setOpacity\n         * @param {DOMElement|String}  elm    DOM element or element id\n         * @param {Number}             value  allows 0 to 1(default mode decimal) or percentage (warning using 0 or 1 will reset to default mode)\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_setOpacity.html \n         */\n        setOpacity: function(elm, value) {\n            elm = Ink.i(elm);\n            if (elm !== null){\n                var val = 1;\n\n                if (!isNaN(Number(value))){\n                    if      (value <= 0) {   val = 0;           }\n                    else if (value <= 1) {   val = value;       }\n                    else if (value <= 100) { val = value / 100; }\n                    else {                   val = 1;           }\n                }\n\n                if (typeof elm.style.opacity !== 'undefined') {\n                    elm.style.opacity = val;\n                }\n                else {\n                    elm.style.filter = \"alpha(opacity:\"+(val*100|0)+\")\";\n                }\n            }\n        },\n\n        /**\n         * Converts a css property name to a string in camelcase to be used with CSSStyleDeclaration.\n         * @method _camelCase\n         * @private\n         * @param {String} str  String to convert\n         * @return {String} Converted string\n         */\n        _camelCase: function(str) {\n            return str ? str.replace(/-(\\w)/g, function (_, $1) {\n                return $1.toUpperCase();\n            }) : str;\n        },\n\n\n        /**\n         * Gets the value for an element's style attribute\n         *\n         * @method getStyle\n         * @param {DOMElement|String}  elm    DOM element or element id\n         * @param {String}             style  Which css attribute to fetch\n         * @return {Mixed} Style value\n         * @public\n         * @sample Ink_Dom_Css_getStyle.html \n         */\n         getStyle: function(elm, style) {\n             elm = Ink.i(elm);\n             if (elm !== null && elm.style) {\n                 style = style === 'float' ? 'cssFloat': this._camelCase(style);\n\n                 var value = elm.style[style];\n\n                 if (getCs && (!value || value === 'auto')) {\n                     var css = getCs(elm, null);\n                     value = css ? css[style] : null;\n                 }\n                 else if (!value && elm.currentStyle) {\n                      value = elm.currentStyle[style];\n                      if (value === 'auto' && (style === 'width' || style === 'height')) {\n                        value = elm[\"offset\" + style.charAt(0).toUpperCase() + style.slice(1)] + \"px\";\n                      }\n                 }\n\n                 if (style === 'opacity') {\n                     return value ? parseFloat(value, 10) : 1.0;\n                 }\n                 else if (style === 'borderTopWidth'   || style === 'borderBottomWidth' ||\n                          style === 'borderRightWidth' || style === 'borderLeftWidth'       ) {\n                      if      (value === 'thin') {      return '1px';   }\n                      else if (value === 'medium') {    return '3px';   }\n                      else if (value === 'thick') {     return '5px';   }\n                 }\n\n                 return value === 'auto' ? null : value;\n             }\n         },\n\n\n        /**\n         * Adds CSS rules to an element's style attribute.\n         *\n         * @method setStyle\n         * @param {DOMElement|String}  elm    DOM element or element id\n         * @param {String}             style  Which css attribute to set\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_setStyle.html \n         */\n        setStyle: function(elm, style) {\n            elm = Ink.i(elm);\n            if (elm === null) { return; }\n            if (typeof style === 'string') {\n                elm.style.cssText += '; '+style;\n\n                if (style.indexOf('opacity') !== -1) {\n                    this.setOpacity(elm, style.match(/opacity:\\s*(\\d?\\.?\\d*)/)[1]);\n                }\n            }\n            else {\n                for (var prop in style) {\n                    if (style.hasOwnProperty(prop)){\n                        if (prop === 'opacity') {\n                            this.setOpacity(elm, style[prop]);\n                        }\n                        else if (prop === 'float' || prop === 'cssFloat') {\n                            if (typeof elm.style.styleFloat === 'undefined') {\n                                elm.style.cssFloat = style[prop];\n                            }\n                            else {\n                                elm.style.styleFloat = style[prop];\n                            }\n                        } else {\n                            elm.style[prop] = style[prop];\n                        }\n                    }\n                }\n            }\n        },\n\n\n        /**\n         * Shows an element.\n         * Internally it unsets the display property of an element. You can force a specific display property using forceDisplayProperty\n         *\n         * @method show\n         * @param {DOMElement|String}  elm                      DOM element or element id\n         * @param {String}             [forceDisplayProperty]   Css display property to apply on show\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_show.html \n         */\n        show: function(elm, forceDisplayProperty) {\n            elm = Ink.i(elm);\n            if (elm !== null) {\n                elm.style.display = forceDisplayProperty || '';\n            }\n        },\n\n        /**\n         * Hides an element.\n         *\n         * @method hide\n         * @param {DOMElement|String}  elm  DOM element or element id\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_hide.html \n         */\n        hide: function(elm) {\n            elm = Ink.i(elm);\n            if (elm !== null) {\n                elm.style.display = 'none';\n            }\n        },\n\n        /**\n         * Shows or hides an element.\n         * If the show parameter is true, it shows the element. Otherwise, hides it.\n         *\n         * @method showHide\n         * @param {DOMElement|String}  elm          DOM element or element id\n         * @param {boolean}            [show]=false Whether to show or hide `elm`.\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_showHide.html \n         */\n        showHide: function(elm, show) {\n            elm = Ink.i(elm);\n            if (elm) {\n                elm.style.display = show ? '' : 'none';\n            }\n        },\n\n        /**\n         * Toggles an element visibility.\n         * \n         * @method toggle\n         * @param {DOMElement|String}  elm        DOM element or element id\n         * @param {Boolean}            forceShow  Forces showing if element is hidden\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_toggle.html \n         */\n        toggle: function(elm, forceShow) {\n            elm = Ink.i(elm);\n            if (elm !== null) {\n                if (typeof forceShow !== 'undefined') {\n                    if (forceShow === true) {\n                        this.show(elm);\n                    } else {\n                        this.hide(elm);\n                    }\n                } else {\n                    if (this.getStyle(elm,'display').toLowerCase() === 'none') {\n                        this.show(elm);\n                    }\n                    else {\n                        this.hide(elm);\n                    }\n                }\n            }\n        },\n\n        _getRefTag: function(head){\n            if (head.firstElementChild) {\n                return head.firstElementChild;\n            }\n\n            for (var child = head.firstChild; child; child = child.nextSibling){\n                if (child.nodeType === 1){\n                    return child;\n                }\n            }\n            return null;\n        },\n\n        /**\n         * Injects style tags with rules to the page.\n         *\n         * @method appendStyleTag\n         * @param {String}  selector  The css selector for the rule\n         * @param {String}  style     The content of the style rule\n         * @param {Object}  options   Options for the tag\n         *    @param {String}  [options.type]='text/css'   File type\n         *    @param {Boolean} [options.force]=false  If true, the style tag will be appended to end of head\n         * @return {void}\n         * @public\n         * \n         * @sample Ink_Dom_Css_appendStyleTag.html \n         */\n        appendStyleTag: function(selector, style, options){\n            options = Ink.extendObj({\n                type: 'text/css',\n                force: false\n            }, options || {});\n\n            var styles = document.getElementsByTagName(\"style\"),\n                oldStyle = false, setStyle = true, i, l;\n\n            for (i=0, l=styles.length; i<l; i++) {\n                oldStyle = styles[i].innerHTML;\n                if (oldStyle.indexOf(selector) >= 0) {\n                    setStyle = false;\n                }\n            }\n\n            if (setStyle) {\n                var defStyle = document.createElement(\"style\"),\n                    head = document.getElementsByTagName(\"head\")[0],\n                    refTag = false, styleStr = '';\n\n                defStyle.type  = options.type;\n\n                styleStr += selector +\" {\";\n                styleStr += style;\n                styleStr += \"} \";\n\n                if (typeof defStyle.styleSheet !== \"undefined\") {\n                    defStyle.styleSheet.cssText = styleStr;\n                } else {\n                    defStyle.appendChild(document.createTextNode(styleStr));\n                }\n\n                if (options.force){\n                    head.appendChild(defStyle);\n                } else {\n                    refTag = this._getRefTag(head);\n                    if (refTag){\n                        head.insertBefore(defStyle, refTag);\n                    }\n                }\n            }\n        },\n\n        /**\n         * Injects an external link tag.\n         * This method add a stylesheet to the head of a page\n         *\n         * @method appendStylesheet\n         * @param {String}  path     File path\n         * @param {Object}  options  Options for the tag\n         * @param {String}  [options.media='screen']    Media type\n         * @param {String}  [options.type='text/css']   File type\n         * @param {Boolean} [options.force=false]       If true, tag will be appended to end of head\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_appendStylesheet.html \n         */\n        appendStylesheet: function(path, options){\n            options = Ink.extendObj({\n                media: 'screen',\n                type: 'text/css',\n                force: false\n            }, options || {});\n\n            var refTag,\n                style = document.createElement(\"link\"),\n                head = document.getElementsByTagName(\"head\")[0];\n\n            style.media = options.media;\n            style.type = options.type;\n            style.href = path;\n            style.rel = \"Stylesheet\";\n\n            if (options.force){\n                head.appendChild(style);\n            }\n            else {\n                refTag = this._getRefTag(head);\n                if (refTag){\n                    head.insertBefore(style, refTag);\n                }\n            }\n        },\n\n        /**\n         * Injects an external link tag.\n         * Loads CSS via LINK element inclusion in HEAD (skips append if already there)\n         *\n         * Works similarly to appendStylesheet but:\n         *   supports optional callback which gets invoked once the CSS has been applied\n         *\n         * @method appendStylesheetCb\n         * @param {String}            cssURI      URI of the CSS to load, if empty ignores and just calls back directly\n         * @param {Function(cssURI)}  [callback]  optional callback which will be called once the CSS is loaded\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Css_appendStylesheetCb.html \n         */\n        _loadingCSSFiles: {},\n        _loadedCSSFiles:  {},\n        appendStylesheetCb: function(url, callback) {\n            if (!url) {\n                return callback(url);\n            }\n\n            if (this._loadedCSSFiles[url]) {\n                return callback(url);\n            }\n\n            var cbs = this._loadingCSSFiles[url];\n            if (cbs) {\n                return cbs.push(callback);\n            }\n\n            this._loadingCSSFiles[url] = [callback];\n\n            var linkEl = document.createElement('link');\n            linkEl.type = 'text/css';\n            linkEl.rel  = 'stylesheet';\n            linkEl.href = url;\n\n            var headEl = document.getElementsByTagName('head')[0];\n            headEl.appendChild(linkEl);\n\n            var imgEl = document.createElement('img');\n            /*\n            var _self = this;\n            (function(_url) {\n                imgEl.onerror = function() {\n                    //var url = this;\n                    var url = _url;\n                    _self._loadedCSSFiles[url] = true;\n                    var callbacks = _self._loadingCSSFiles[url];\n                    for (var i = 0, f = callbacks.length; i < f; ++i) {\n                        callbacks[i](url);\n                    }\n                    delete _self._loadingCSSFiles[url];\n                };\n            })(url);\n            */\n            imgEl.onerror = Ink.bindEvent(function(event, _url) {\n                //var url = this;\n                var url = _url;\n                this._loadedCSSFiles[url] = true;\n                var callbacks = this._loadingCSSFiles[url];\n                for (var i = 0, f = callbacks.length; i < f; ++i) {\n                    callbacks[i](url);\n                }\n                delete this._loadingCSSFiles[url];\n            }, this, url);\n            imgEl.src = url;\n        },\n\n        /**\n         * Converts decimal to hexadecimal values\n         * Useful to convert colors to their hexadecimal representation.\n         *\n         * @method decToHex\n         * @param {String} dec Either a single decimal value, an rgb(r, g, b) string or an Object with r, g and b properties\n         * @return {String} Hexadecimal value\n         * @sample Ink_Dom_Css_decToHex.html \n         */\n        decToHex: function(dec) {\n            var normalizeTo2 = function(val) {\n                if (val.length === 1) {\n                    val = '0' + val;\n                }\n                val = val.toUpperCase();\n                return val;\n            };\n\n            if (typeof dec === 'object') {\n                var rDec = normalizeTo2(parseInt(dec.r, 10).toString(16));\n                var gDec = normalizeTo2(parseInt(dec.g, 10).toString(16));\n                var bDec = normalizeTo2(parseInt(dec.b, 10).toString(16));\n                return rDec+gDec+bDec;\n            }\n            else {\n                dec += '';\n                var rgb = dec.match(/\\((\\d+),\\s?(\\d+),\\s?(\\d+)\\)/);\n                if (rgb !== null) {\n                    return  normalizeTo2(parseInt(rgb[1], 10).toString(16)) +\n                            normalizeTo2(parseInt(rgb[2], 10).toString(16)) +\n                            normalizeTo2(parseInt(rgb[3], 10).toString(16));\n                }\n                else {\n                    return normalizeTo2(parseInt(dec, 10).toString(16));\n                }\n            }\n        },\n\n        /**\n         * Converts hexadecimal values to decimal\n         * Useful to use with CSS colors\n         *\n         * @method hexToDec\n         * @param {String}  hex  hexadecimal Value with 6, 3, 2 or 1 characters\n         * @return {Number} Object with properties r, g, b if length of number is >= 3 or decimal value instead.\n         * @sample Ink_Dom_Css_hexToDec.html \n         */\n        hexToDec: function(hex){\n            if (hex.indexOf('#') === 0) {\n                hex = hex.substr(1);\n            }\n            if (hex.length === 6) { // will return object RGB\n                return {\n                    r: parseInt(hex.substr(0,2), 16),\n                    g: parseInt(hex.substr(2,2), 16),\n                    b: parseInt(hex.substr(4,2), 16)\n                };\n            }\n            else if (hex.length === 3) { // will return object RGB\n                return {\n                    r: parseInt(hex.charAt(0) + hex.charAt(0), 16),\n                    g: parseInt(hex.charAt(1) + hex.charAt(1), 16),\n                    b: parseInt(hex.charAt(2) + hex.charAt(2), 16)\n                };\n            }\n            else if (hex.length <= 2) { // will return int\n                return parseInt(hex, 16);\n            }\n        },\n\n        /**\n         * Get a single property from a stylesheet.\n         * Use this to obtain the value of a CSS property (searched from loaded CSS documents)\n         *\n         * @method getPropertyFromStylesheet\n         * @param {String}  selector  a CSS rule. must be an exact match\n         * @param {String}  property  a CSS property\n         * @return {String} value of the found property, or null if it wasn't matched\n         */\n        getPropertyFromStylesheet: function(selector, property) {\n            var rule = this.getRuleFromStylesheet(selector);\n            if (rule) {\n                return rule.style[property];\n            }\n            return null;\n        },\n\n        getPropertyFromStylesheet2: function(selector, property) {\n            var rules = this.getRulesFromStylesheet(selector);\n            /*\n            rules.forEach(function(rule) {\n                var x = rule.style[property];\n                if (x !== null && x !== undefined) {\n                    return x;\n                }\n            });\n            */\n            var x;\n            for(var i=0, t=rules.length; i < t; i++) {\n                x = rules[i].style[property];\n                if (x !== null && x !== undefined) {\n                    return x;\n                }\n            }\n            return null;\n        },\n\n        getRuleFromStylesheet: function(selector) {\n            var sheet, rules, ri, rf, rule;\n            var s = document.styleSheets;\n            if (!s) {\n                return null;\n            }\n\n            for (var si = 0, sf = document.styleSheets.length; si < sf; ++si) {\n                sheet = document.styleSheets[si];\n                rules = sheet.rules ? sheet.rules : sheet.cssRules;\n                if (!rules) { return null; }\n\n                for (ri = 0, rf = rules.length; ri < rf; ++ri) {\n                    rule = rules[ri];\n                    if (!rule.selectorText) { continue; }\n                    if (rule.selectorText === selector) {\n                        return rule;\n                    }\n                }\n            }\n\n            return null;\n        },\n\n        getRulesFromStylesheet: function(selector) {\n            var res = [];\n            var sheet, rules, ri, rf, rule;\n            var s = document.styleSheets;\n            if (!s) { return res; }\n\n            for (var si = 0, sf = document.styleSheets.length; si < sf; ++si) {\n                sheet = document.styleSheets[si];\n                rules = sheet.rules ? sheet.rules : sheet.cssRules;\n                if (!rules) {\n                    return null;\n                }\n\n                for (ri = 0, rf = rules.length; ri < rf; ++ri) {\n                    rule = rules[ri];\n                    if (!rule.selectorText) { continue; }\n                    if (rule.selectorText === selector) {\n                        res.push(rule);\n                    }\n                }\n            }\n\n            return res;\n        },\n\n        getPropertiesFromRule: function(selector) {\n            var rule = this.getRuleFromStylesheet(selector);\n            var props = {};\n            var prop, i, f;\n\n            /*if (typeof rule.style.length === 'snumber') {\n                for (i = 0, f = rule.style.length; i < f; ++i) {\n                    prop = this._camelCase( rule.style[i]   );\n                    props[prop] = rule.style[prop];\n                }\n            }\n            else {  // HANDLES IE 8, FIREFOX RULE JOINING... */\n                rule = rule.style.cssText;\n                var parts = rule.split(';');\n                var steps, val, pre, pos;\n                for (i = 0, f = parts.length; i < f; ++i) {\n                    if (parts[i].charAt(0) === ' ') {\n                        parts[i] = parts[i].substring(1);\n                    }\n                    steps = parts[i].split(':');\n                    prop = this._camelCase( steps[0].toLowerCase()  );\n                    val = steps[1];\n                    if (val) {\n                        val = val.substring(1);\n\n                        if (prop === 'padding' || prop === 'margin' || prop === 'borderWidth') {\n\n                            if (prop === 'borderWidth') {   pre = 'border'; pos = 'Width';  }\n                            else {                          pre = prop;     pos = '';       }\n\n                            if (val.indexOf(' ') !== -1) {\n                                val = val.split(' ');\n                                props[pre + 'Top'   + pos]  = val[0];\n                                props[pre + 'Bottom'+ pos]  = val[0];\n                                props[pre + 'Left'  + pos]  = val[1];\n                                props[pre + 'Right' + pos]  = val[1];\n                            }\n                            else {\n                                props[pre + 'Top'   + pos]  = val;\n                                props[pre + 'Bottom'+ pos]  = val;\n                                props[pre + 'Left'  + pos]  = val;\n                                props[pre + 'Right' + pos]  = val;\n                            }\n                        }\n                        else if (prop === 'borderRadius') {\n                            if (val.indexOf(' ') !== -1) {\n                                val = val.split(' ');\n                                props.borderTopLeftRadius       = val[0];\n                                props.borderBottomRightRadius   = val[0];\n                                props.borderTopRightRadius      = val[1];\n                                props.borderBottomLeftRadius    = val[1];\n                            }\n                            else {\n                                props.borderTopLeftRadius       = val;\n                                props.borderTopRightRadius      = val;\n                                props.borderBottomLeftRadius    = val;\n                                props.borderBottomRightRadius   = val;\n                            }\n                        }\n                        else {\n                            props[prop] = val;\n                        }\n                    }\n                }\n            //}\n            //console.log(props);\n\n            return props;\n        },\n\n        /**\n         * Change the font size of elements.\n         * Changes the font size of the elements which match the given CSS rule\n         * For this function to work, the CSS file must be in the same domain than the host page, otherwise JS can't access it.\n         *\n         * @method changeFontSize\n         * @param {String}  selector  CSS selector rule\n         * @param {Number}  delta     Number of pixels to change on font-size\n         * @param {String}  [op]      Supported operations are '+' and '*'. defaults to '+'\n         * @param {Number}  [minVal]  If result gets smaller than minVal, change does not occurr\n         * @param {Number}  [maxVal]  If result gets bigger  than maxVal, change does not occurr\n         * @return {void}\n         * @public\n         */\n        changeFontSize: function(selector, delta, op, minVal, maxVal) {\n            var that = this;\n            Ink.requireModules(['Ink.Dom.Selector_1'], function(Selector) {\n                var e;\n                if      (typeof selector !== 'string') { e = '1st argument must be a CSS selector rule.'; }\n                else if (typeof delta    !== 'number') { e = '2nd argument must be a number.'; }\n                else if (op !== undefined && op !== '+' && op !== '*') { e = '3rd argument must be one of \"+\", \"*\".'; }\n                else if (minVal !== undefined && (typeof minVal !== 'number' || minVal <= 0)) { e = '4th argument must be a positive number.'; }\n                else if (maxVal !== undefined && (typeof maxVal !== 'number' || maxVal < maxVal)) { e = '5th argument must be a positive number greater than minValue.'; }\n                if (e) { throw new TypeError(e); }\n\n                var val, el, els = Selector.select(selector);\n                if (minVal === undefined) { minVal = 1; }\n                op = (op === '*') ? function(a,b){return a*b;} : function(a,b){return a+b;};\n                for (var i = 0, f = els.length; i < f; ++i) {\n                    el = els[i];\n                    val = parseFloat( that.getStyle(el, 'fontSize'));\n                    val = op(val, delta);\n                    if (val < minVal) { continue; }\n                    if (typeof maxVal === 'number' && val > maxVal) { continue; }\n                    el.style.fontSize = val + 'px';\n                }\n            });\n        }\n\n    };\n\n    return Css;\n\n});\n","/**\n * DOM Traversal and manipulation\n * @module Ink.Dom.Element_1\n * @version 1\n */\n\nInk.createModule('Ink.Dom.Element', 1, [], function() {\n\n    'use strict';\n\n    var createContextualFragmentSupport = (\n        typeof document.createRange === 'function' &&\n        typeof window.Range.prototype.createContextualFragment === 'function');\n\n    var deleteThisTbodyToken = 'Ink.Dom.Element tbody: ' + Math.random();\n    var browserCreatesTbodies = (function () {\n        var div = document.createElement('div');\n        div.innerHTML = '<table>';\n        return div.getElementsByTagName('tbody').length !== 0;\n    }());\n\n    function rect(elem){\n        var dimensions = {};\n        try {\n            dimensions = elem.getBoundingClientRect();\n        } catch(e){\n            dimensions = { top: elem.offsetTop, left: elem.offsetLeft };\n        }\n        return dimensions;\n    }\n\n    /**\n     * @namespace Ink.Dom.Element_1\n     */\n\n    var InkElement = {\n\n        /**\n         * Checks if something is a DOM Element.\n         *\n         * @method isDOMElement\n         * @static\n         * @param   {Mixed}     o   The object to be checked.\n         * @return  {Boolean}       True if it's a valid DOM Element.\n         * @public\n         * @example\n         *     var el = Ink.s('#element');\n         *     if( InkElement.isDOMElement( el ) === true ){\n         *         // It is a DOM Element.\n         *     } else {\n         *         // It is NOT a DOM Element.\n         *     }\n         */\n        isDOMElement: function(o) {\n            return o !== null && typeof o === 'object' && 'nodeType' in o && o.nodeType === 1;\n        },\n\n        /**\n         * Shortcut for `document.getElementById`\n         *\n         * @method get\n         * @param {String|DOMElement} elm   Either an ID of an element, or an element.\n         * @return {DOMElement|null} The DOM element with the given id or null when it was not found\n         * @public\n         * @sample Ink_Dom_Element_1_get.html\n         */\n        get: function(elm) {\n            if(typeof elm !== 'undefined') {\n                if(typeof elm === 'string') {\n                    return document.getElementById(elm);\n                }\n                return elm;\n            }\n            return null;\n        },\n\n        /**\n         * Creates a DOM element.\n         *\n         * Just a shortcut for `document.createElement(tag)`, but with the second argument you can call additional functions present in Ink.Dom.Element.\n         *\n         * @method create\n         * @param {String} tag        Tag name\n         * @param {Object} properties Object with properties to be set on the element. You can also call other functions in Ink.Dom.Element like this\n         * @return {Element} The newly created element.\n         * @public\n         * @sample Ink_Dom_Element_1_create.html\n         */\n        create: function(tag, properties) {\n            var el = document.createElement(tag);\n            //Ink.extendObj(el, properties);\n            if (properties) {\n                for(var property in properties) {\n                    if(properties.hasOwnProperty(property)) {\n                        if (property in InkElement) {\n                            InkElement[property](el, properties[property]);\n                        } else {\n                            if(property === 'className' || property === 'class') {\n                                el.className = properties.className || properties['class'];\n                            } else {\n                                el.setAttribute(property, properties[property]);\n                            }\n                        }\n                    }\n                }\n            }\n            return el;\n        },\n\n        /**\n         * Removes a DOM Element\n         *\n         * @method remove\n         * @param {Element} elm The element to remove\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_remove.html\n         */\n        remove: function(elm) {\n            elm = Ink.i(elm);\n            var parEl;\n            if (elm && (parEl = elm.parentNode)) {\n                parEl.removeChild(elm);\n            }\n        },\n\n        /**\n         * Scrolls the window to an element\n         *\n         * @method scrollTo\n         * @param {DOMElement|String} elm  Element where to scroll\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_scrollTo.html\n         */\n        scrollTo: function(elm) {\n            elm = InkElement.get(elm);\n            if(elm) {\n                if (elm.scrollIntoView) {\n                    return elm.scrollIntoView();\n                }\n\n                var elmOffset = {},\n                    elmTop = 0, elmLeft = 0;\n\n                do {\n                    elmTop += elm.offsetTop || 0;\n                    elmLeft += elm.offsetLeft || 0;\n\n                    elm = elm.offsetParent;\n                } while(elm);\n\n                elmOffset = {x: elmLeft, y: elmTop};\n\n                window.scrollTo(elmOffset.x, elmOffset.y);\n            }\n        },\n\n        /**\n         * Gets the top offset of an element\n         *\n         * @method offsetTop\n         * @uses Ink.Dom.Browser\n         *\n         * @param {DOMElement|String} elm  Target element\n         * @return {Number} Offset from the target element to the top of the document.\n         * @public\n         * @sample Ink_Dom_Element_1_offsetTop.html\n         */\n        offsetTop: function(elm) {\n            return InkElement.offset(elm)[1];\n        },\n\n        /**\n         * Gets the left offset of an element\n         *\n         * @method offsetLeft\n         * @uses Ink.Dom.Browser\n         *\n         * @param {DOMElement|String} elm  Target element\n         * @return {Number} Offset from the target element to the left of the document\n         * @public\n         * @sample Ink_Dom_Element_1_offsetLeft.html\n         */\n        offsetLeft: function(elm) {\n            return InkElement.offset(elm)[0];\n        },\n\n        /**\n        * Gets the relative offset of an element\n        *\n        * @method positionedOffset\n        * @param {Element|String} element Target element\n        * @return {Array} Array with the element offsetleft and offsettop relative to the closest positioned ancestor\n        * @public\n        * @sample Ink_Dom_Element_1_positionedOffset.html\n        */\n        positionedOffset: function(element) {\n            var valueTop = 0, valueLeft = 0;\n            element = InkElement.get(element);\n            do {\n                valueTop  += element.offsetTop  || 0;\n                valueLeft += element.offsetLeft || 0;\n                element = element.offsetParent;\n                if (element) {\n                    if (element.tagName.toLowerCase() === 'body') { break;  }\n\n                    var value = element.style.position;\n                    if (!value && element.currentStyle) {\n                        value = element.currentStyle.position;\n                    }\n                    if ((!value || value === 'auto') && typeof getComputedStyle !== 'undefined') {\n                        var css = getComputedStyle(element, null);\n                        value = css ? css.position : null;\n                    }\n                    if (value === 'relative' || value === 'absolute') { break;  }\n                }\n            } while (element);\n            return [valueLeft, valueTop];\n        },\n\n        /**\n         * Gets the cumulative offset for an element\n         *\n         * Returns the top left position of the element on the page\n         *\n         * @method offset\n         * @uses Ink.Dom.Browser\n         *\n         * @method offset\n         * @param {DOMElement|String}   elm     Target element\n         * @return {[Number, Number]}   Array with pixel distance from the target element to the top left corner of the document\n         * @public\n         * @sample Ink_Dom_Element_1_offset.html\n         */\n        offset: function(elm) {\n            /*jshint boss:true */\n            elm = Ink.i(elm);\n            var res = [0, 0];\n            var doc = elm.ownerDocument,\n                docElem = doc.documentElement,\n                box = rect(elm),\n                body = doc.body,\n                clientTop  = docElem.clientTop  || body.clientTop  || 0,\n                clientLeft = docElem.clientLeft || body.clientLeft || 0,\n                scrollTop  = doc.pageYOffset || docElem.scrollTop  || body.scrollTop,\n                scrollLeft = doc.pageXOffset || docElem.scrollLeft || body.scrollLeft,\n                top  = box.top  + scrollTop  - clientTop,\n                left = box.left + scrollLeft - clientLeft;\n            res = [left, top];\n            return res;\n        },\n\n        /**\n         * Gets the scroll of the element\n         *\n         * @method scroll\n         * @param {DOMElement|String} [elm] Target element or document.body\n         * @returns {Array} offset values for x and y scroll\n         * @public\n         * @sample Ink_Dom_Element_1_scroll.html\n         */\n        scroll: function(elm) {\n            elm = elm ? Ink.i(elm) : document.body;\n            return [\n                ( ( !window.pageXOffset ) ? elm.scrollLeft : window.pageXOffset ),\n                ( ( !window.pageYOffset ) ? elm.scrollTop : window.pageYOffset )\n            ];\n        },\n\n        _getPropPx: function(cs, prop) {\n            var n, c;\n            var val = cs.getPropertyValue ? cs.getPropertyValue(prop) : cs[prop];\n            if (!val) { n = 0; }\n            else {\n                c = val.indexOf('px');\n                if (c === -1) { n = 0; }\n                else {\n                    n = parseFloat(val, 10);\n                }\n            }\n\n            //console.log([prop, ' \"', val, '\" ', n].join(''));\n\n            return n;\n        },\n\n        /**\n         * Alias for offset()\n         *\n         * @method offset2\n         * @param {Element} el Element to be passed to `offset()`\n         * @return {void}\n         * @public\n         * @deprecated Kept for historic reasons. Use offset() instead.\n         */\n        offset2: function(el) {\n            return InkElement.offset(el);\n        },\n\n        /**\n         * Checks if an element has an attribute\n         *\n         * @method hasAttribute\n         * @param {Object} elm   Target element\n         * @param {String} attr  Attribute name\n         * @return {Boolean} Boolean based on existance of attribute\n         * @sample Ink_Dom_Element_1_hasAttribute.html\n         */\n        hasAttribute: function(elm, attr){\n            elm = Ink.i(elm);\n            return elm.hasAttribute ? elm.hasAttribute(attr) : !!elm.getAttribute(attr);\n        },\n        /**\n         * Inserts an element right after another\n         *\n         * @method insertAfter\n         * @param {DOMElement}         newElm     Element to be inserted\n         * @param {DOMElement|String}  targetElm  Key element\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_insertAfter.html\n         */\n        insertAfter: function(newElm, targetElm) {\n            /*jshint boss:true */\n            if (targetElm = InkElement.get(targetElm)) {\n                if (targetElm.nextSibling !== null) {\n                    targetElm.parentNode.insertBefore(newElm, targetElm.nextSibling);\n                } else {\n                    targetElm.parentNode.appendChild(newElm);\n                }\n            }\n        },\n\n        /**\n         * Inserts an element before another\n         *\n         * @method insertBefore\n         * @param {DOMElement}         newElm     Element to be inserted\n         * @param {DOMElement|String}  targetElm  Key element\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_insertBefore.html\n         */\n        insertBefore: function (newElm, targetElm) {\n            /*jshint boss:true */\n            if ( (targetElm = InkElement.get(targetElm)) ) {\n                targetElm.parentNode.insertBefore(newElm, targetElm);\n            }\n        },\n\n        /**\n         * Inserts an element as the first child of another\n         *\n         * @method insertTop\n         * @param {DOMElement}         newElm     Element to be inserted\n         * @param {DOMElement|String}  targetElm  Key element\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_insertTop.html\n         */\n        insertTop: function(newElm,targetElm) {\n            /*jshint boss:true */\n            if (targetElm = InkElement.get(targetElm)) {\n                if (targetElm.firstChild) {\n                    targetElm.insertBefore(newElm, targetElm.firstChild);\n                } else {\n                    targetElm.appendChild(newElm);\n                }\n            }\n        },\n\n        /**\n         * Inserts an element as the last child of another\n         *\n         * @method insertBottom\n         * @param {DOMElement}         newElm     Element to be inserted\n         * @param {DOMElement|String}  targetElm  Key element\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_insertBottom.html\n         */\n        insertBottom: function(newElm, targetElm) {\n            /*jshint boss:true */\n            targetElm = Ink.i(targetElm);\n            targetElm.appendChild(newElm);\n        },\n\n        /**\n         * Retrieves textContent from node\n         *\n         * @method textContent\n         * @param {DOMNode} node Where to retreive text from. Can be any node type.\n         * @return {String} The text\n         * @public\n         * @sample Ink_Dom_Element_1_textContent.html\n         */\n        textContent: function(node){\n            node = Ink.i(node);\n            var text, k, cs, m;\n\n            switch(node && node.nodeType) {\n            case 9: /*DOCUMENT_NODE*/\n                // IE quirks mode does not have documentElement\n                return InkElement.textContent(node.documentElement || node.body && node.body.parentNode || node.body);\n\n            case 1: /*ELEMENT_NODE*/\n                text = ('textContent' in node) ? node.textContent : node.innerText;\n                if (typeof text !== 'undefined') {\n                    return text;\n                }\n                /* falls through */\n            case 11: /*DOCUMENT_FRAGMENT_NODE*/\n                text = node.textContent;\n                if (typeof text !== 'undefined') {\n                    return text;\n                }\n\n                if (node.firstChild === node.lastChild) {\n                    // Common case: 0 or 1 children\n                    return InkElement.textContent(node.firstChild);\n                }\n\n                text = [];\n                cs = node.childNodes;\n                for (k = 0, m = cs.length; k < m; ++k) {\n                    text.push( InkElement.textContent( cs[k] ) );\n                }\n                return text.join('');\n\n            case 3: /*TEXT_NODE*/\n            case 4: /*CDATA_SECTION_NODE*/\n                return node.nodeValue;\n            }\n            return '';\n        },\n\n        /**\n         * Replaces text content of a DOM Node\n         * This method removes any child node previously present\n         *\n         * @method setTextContent\n         * @param {Element} node Target node where the text will be added.\n         * @param {String}  text Text to be added on the node.\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_setTextContent.html\n         */\n        setTextContent: function(node, text){\n            node = Ink.i(node);\n            switch(node && node.nodeType)\n            {\n            case 1: /*ELEMENT_NODE*/\n                if ('innerText' in node) {\n                    node.innerText = text;\n                    break;\n                }\n                /* falls through */\n            case 11: /*DOCUMENT_FRAGMENT_NODE*/\n                if ('textContent' in node) {\n                    node.textContent = text;\n                    break;\n                }\n                /* falls through */\n            case 9: /*DOCUMENT_NODE*/\n                while(node.firstChild) {\n                    node.removeChild(node.firstChild);\n                }\n                if (text !== '') {\n                    var doc = node.ownerDocument || node;\n                    node.appendChild(doc.createTextNode(text));\n                }\n                break;\n\n            case 3: /*TEXT_NODE*/\n            case 4: /*CDATA_SECTION_NODE*/\n                node.nodeValue = text;\n                break;\n            }\n        },\n\n        /**\n         * Checks if an element is a link\n         *\n         * @method isLink\n         * @param {Element} element Element to check if it's a link.\n         * @return {Boolean} Whether the element is a link.\n         * @public\n         * @sample Ink_Dom_Element_1_isLink.html\n         */\n        isLink: function(element){\n            var b = element && element.nodeType === 1 && ((/^a|area$/i).test(element.tagName) ||\n                element.hasAttributeNS && element.hasAttributeNS('http://www.w3.org/1999/xlink','href'));\n            return !!b;\n        },\n\n        /**\n         * Checks if a node is an ancestor of another\n         *\n         * @method isAncestorOf\n         * @param {DOMNode} ancestor  Ancestor node\n         * @param {DOMNode} node      Descendant node\n         * @return {Boolean} Whether `ancestor` is an ancestor of `node`\n         * @public\n         * @sample Ink_Dom_Element_1_isAncestorOf.html\n         */\n        isAncestorOf: function(ancestor, node){\n            /*jshint boss:true */\n            if (!node || !ancestor) {\n                return false;\n            }\n            if (node.compareDocumentPosition) {\n                return (ancestor.compareDocumentPosition(node) & 0x10) !== 0;/*Node.DOCUMENT_POSITION_CONTAINED_BY*/\n            }\n            while (node = node.parentNode){\n                if (node === ancestor){\n                    return true;\n                }\n            }\n            return false;\n        },\n\n        /**\n         * Checks if a node is descendant of another\n         *\n         * @method descendantOf\n         * @param {DOMNode} node        The ancestor\n         * @param {DOMNode} descendant  The descendant\n         * @return {Boolean} `true` if 'descendant' is descendant of 'node'\n         * @public\n         * @sample Ink_Dom_Element_1_descendantOf.html\n         */\n        descendantOf: function(node, descendant){\n            return node !== descendant && InkElement.isAncestorOf(node, descendant);\n        },\n\n        /**\n         * Get first child element of another\n         * @method firstElementChild\n         * @param {DOMElement} elm Parent node\n         * @return {DOMElement} the Element child\n         * @public\n         * @sample Ink_Dom_Element_1_firstElementChild.html\n         */\n        firstElementChild: function(elm){\n            if(!elm) {\n                return null;\n            }\n            if ('firstElementChild' in elm) {\n                return elm.firstElementChild;\n            }\n            var child = elm.firstChild;\n            while(child && child.nodeType !== 1) {\n                child = child.nextSibling;\n            }\n            return child;\n        },\n\n        /**\n         * Get the last child element of another\n         * @method lastElementChild\n         * @param {DOMElement} elm Parent node\n         * @return {DOMElement} the Element child\n         * @public\n         * @sample Ink_Dom_Element_1_lastElementChild.html\n         */\n        lastElementChild: function(elm){\n            if(!elm) {\n                return null;\n            }\n            if ('lastElementChild' in elm) {\n                return elm.lastElementChild;\n            }\n            var child = elm.lastChild;\n            while(child && child.nodeType !== 1) {\n                child = child.previousSibling;\n            }\n            return child;\n        },\n\n        /**\n         * Get the first sibling element after the node\n         *\n         * @method nextElementSibling\n         * @param {DOMNode} node  The current node\n         * @return {DOMElement|Null} The first sibling element after node or null if none is found\n         * @public\n         * @sample Ink_Dom_Element_1_nextElementSibling.html \n         */\n        nextElementSibling: function(node){\n            var sibling = null;\n\n            if(!node){ return sibling; }\n\n            if(\"nextElementSibling\" in node){\n                return node.nextElementSibling;\n            } else {\n                sibling = node.nextSibling;\n\n                // 1 === Node.ELEMENT_NODE\n                while(sibling && sibling.nodeType !== 1){\n                    sibling = sibling.nextSibling;\n                }\n\n                return sibling;\n            }\n        },\n\n        /**\n         * Get the first sibling element before the node\n         *\n         * @method previousElementSibling\n         * @param {DOMNode}        node The current node\n         * @return {DOMElement|Null} The first element sibling before node or null if none is found\n         * @public\n         * @sample Ink_Dom_Element_1_previousElementSibling.html \n         */\n        previousElementSibling: function(node){\n            var sibling = null;\n\n            if(!node){ return sibling; }\n\n            if(\"previousElementSibling\" in node){\n                return node.previousElementSibling;\n            } else {\n                sibling = node.previousSibling;\n\n                // 1 === Node.ELEMENT_NODE\n                while(sibling && sibling.nodeType !== 1){\n                    sibling = sibling.previousSibling;\n                }\n\n                return sibling;\n            }\n        },\n\n        /**\n         * Get an element's width in pixels.\n         *\n         * @method elementWidth\n         * @param {DOMElement|String} element Target DOM element or target ID\n         * @return {Number} The element's width\n         * @public\n         * @sample Ink_Dom_Element_1_elementWidth.html \n         */\n        elementWidth: function(element) {\n            if(typeof element === \"string\") {\n                element = document.getElementById(element);\n            }\n            return element.offsetWidth;\n        },\n\n        /**\n         * Get an element's height in pixels.\n         *\n         * @method elementHeight\n         * @param {DOMElement|String} element DOM element or target ID\n         * @return {Number} The element's height\n         * @public\n         * @sample Ink_Dom_Element_1_elementHeight.html \n         */\n        elementHeight: function(element) {\n            if(typeof element === \"string\") {\n                element = document.getElementById(element);\n            }\n            return element.offsetHeight;\n        },\n\n        /**\n         * Deprecated. Alias for offsetLeft()\n         *\n         * @method elementLeft\n         * @param {DOMElement|String}       element     DOM element or target ID\n         * @return {Number} Element's left position\n         */\n        elementLeft: function(element) {\n            return InkElement.offsetLeft(element);\n        },\n\n        /**\n         * Deprecated. Alias for offsetTop()\n         *\n         * @method elementTop\n         * @param {DOMElement|string}   element     Target DOM element or target ID\n         * @return {Number} element's top position\n         */\n        elementTop: function(element) {\n            return InkElement.offsetTop(element);\n        },\n\n        /**\n         * Get an element's dimensions in pixels.\n         *\n         * @method elementDimensions\n         * @param {DOMElement|string}   element     DOM element or target ID\n         * @return {Array} Array with element's width and height\n         * @sample Ink_Dom_Element_1_elementDimensions.html \n         */\n        elementDimensions: function(element) {\n            element = Ink.i(element);\n            return [element.offsetWidth, element.offsetHeight];\n        },\n\n        /**\n         * Get the outer dimensions of an element in pixels.\n         *\n         * @method outerDimensions\n         * @uses Ink.Dom.Css\n         *\n         * @param {DOMElement} element Target element\n         * @return {Array} Array with element width and height.\n         * @sample Ink_Dom_Element_1_outerDimensions.html \n         */\n        outerDimensions: function (element) {\n            var bbox = rect(element);\n\n            var Css = Ink.getModule('Ink.Dom.Css_1');\n            var getStyle = Ink.bindMethod(Css, 'getStyle', element);\n\n            return [\n                bbox.right - bbox.left + parseFloat(getStyle('marginLeft') || 0) + parseFloat(getStyle('marginRight') || 0),  // w\n                bbox.bottom - bbox.top + parseFloat(getStyle('marginTop') || 0) + parseFloat(getStyle('marginBottom') || 0)  // h\n            ];\n        },\n\n        /**\n         * Check if an element is inside the viewport\n         *\n         * @method inViewport\n         * @param {DOMElement} element DOM Element\n         * @param {Object}  [options]  Options object. If you pass a Boolean value here, it is interpreted as `options.partial`\n         * @param {Boolean} [options.partial]=false    Return `true` even if it is only partially visible.\n         * @param {Number}  [options.margin]=0         Consider a margin all around the viewport with `opts.margin` width a dead zone.\n         * @return {Boolean} Whether the element is inside the viewport.\n         * @public\n         * @sample Ink_Dom_Element_1_inViewport.html \n         */\n        inViewport: function (element, options) {\n            var dims = rect(Ink.i(element));\n            if (typeof options === 'boolean') {\n                options = {partial: options, margin: 0};\n            }\n            options = Ink.extendObj({ partial: false, margin: 0}, options || {});\n            if (options.partial) {\n                return  dims.bottom + options.margin > 0                           && // from the top\n                        dims.left   - options.margin < InkElement.viewportWidth()  && // from the right\n                        dims.top    - options.margin < InkElement.viewportHeight() && // from the bottom\n                        dims.right  + options.margin > 0;                             // from the left\n            } else {\n                return  dims.top    + options.margin > 0                           && // from the top\n                        dims.right  - options.margin < InkElement.viewportWidth()  && // from the right\n                        dims.bottom - options.margin < InkElement.viewportHeight() && // from the bottom\n                        dims.left   + options.margin > 0;                             // from the left\n            }\n        },\n\n        /**\n         * Check if an element is hidden.\n         * Taken from Mootools Element extras ( https://gist.github.com/cheeaun/73342 )\n         * Does not take into account visibility:hidden\n         * @method isHidden\n         * @param {DOMElement} element Element to check\n         * @return {Boolean} Whether the element is hidden\n         * @sample Ink_Dom_Element_1_isHidden.html \n         */\n        isHidden: function (element) {\n            var w = element.offsetWidth, \n                h = element.offsetHeight,\n                force = (element.tagName.toLowerCase() === 'tr');\n\n            var Css = Ink.getModule('Ink.Dom.Css_1');\n\n            return (w===0 && h===0 && !force) ? true :\n                (w!==0 && h!==0 && !force) ? false :\n                Css.getStyle(element, 'display').toLowerCase() === 'none';\n         },\n\n        /**\n         * Check if an element is visible \n         *\n         * @method isVisible\n         * @uses isHidden\n         * @param {DOMElement} element Element to check\n         * @return {Boolean} Whether the element is visible\n         * @sample Ink_Dom_Element_1_isVisible.html \n         */\n        isVisible: function (element) {\n            return !this.isHidden(element);\n        },\n\n        /**\n         * Clones an element's position to another\n         *\n         * @method clonePosition\n         * @param {Element} cloneTo    element to be position cloned\n         * @param {Element} cloneFrom  element to get the cloned position\n         * @return {Element} The element with positionClone\n         * @public\n         * @sample Ink_Dom_Element_1_clonePosition.html \n         */\n        clonePosition: function(cloneTo, cloneFrom){\n            var pos = InkElement.offset(cloneFrom);\n            cloneTo.style.left = pos[0]+'px';\n            cloneTo.style.top = pos[1]+'px';\n\n            return cloneTo;\n        },\n\n        /**\n         * Text-overflow: ellipsis emulation\n         * Slices off a piece of text at the end of the element and adds the ellipsis so all text fits inside.\n         *\n         * @method ellipsizeText\n         * @param {Element} element             Element to modify text content\n         * @param {String}  [ellipsis='\\u2026'] String to append to the chopped text\n         * @return {void}\n         * @public\n         */\n        ellipsizeText: function(element/*, ellipsis*/){\n            if ((element = Ink.i(element))) {\n                element.style.overflow = 'hidden';\n                element.style.whiteSpace = 'nowrap';\n                element.style.textOverflow = 'ellipsis';\n            }\n        },\n\n        /**\n         * Finds the closest ancestor element matching your test function\n         *\n         * @method findUpwardsHaving\n         * @param {Element}     element  Element to base the search from\n         * @param {Function}    boolTest Testing function\n         * @return {Element|false}  The matched element or false if did not match\n         * @public\n         * @sample Ink_Dom_Element_1_findUpwardsHaving.html \n         */\n        findUpwardsHaving: function(element, boolTest) {\n            while (element && element.nodeType === 1) {\n                if (boolTest(element)) {\n                    return element;\n                }\n                element = element.parentNode;\n            }\n            return false;\n        },\n\n        /**\n         * Finds the closest ancestor by class name\n         *\n         * @method findUpwardsByClass\n         * @uses findUpwardsHaving\n         * @param {DOMElement}  element     Element to base the search from\n         * @param {String}      className   Class name to search\n         * @returns {DOMElement|false} The matched element or false if did not match\n         * @public\n         * @sample Ink_Dom_Element_1_findUpwardsByClass.html \n         */\n        findUpwardsByClass: function(element, className) {\n            var re = new RegExp(\"(^|\\\\s)\" + className + \"(\\\\s|$)\");\n            var tst = function(el) {\n                var cls = el.className;\n                return cls && re.test(cls);\n            };\n            return InkElement.findUpwardsHaving(element, tst);\n        },\n\n        /**\n         * Finds the closest ancestor by tag name\n         *\n         * @method findUpwardsByTag\n         * @param {DOMElement} element  Element to base the search from\n         * @param {String}      tag     Tag to search\n         * @returns {DOMElement|false} the matched element or false if did not match\n         * @sample Ink_Dom_Element_1_findUpwardsByTag.html \n         */\n        findUpwardsByTag: function(element, tag) {\n            tag = tag.toUpperCase();\n            var tst = function(el) {\n                return el.nodeName && el.nodeName.toUpperCase() === tag;\n            };\n            return InkElement.findUpwardsHaving(element, tst);\n        },\n\n        /**\n         * Finds the closest ancestor by id\n         *\n         * @method findUpwardsById\n         * @param {HtmlElement} element     Element to base the search from\n         * @param {String}      id          ID to search\n         * @returns {HtmlElement|false} The matched element or false if did not match\n         * @sample Ink_Dom_Element_1_findUpwardsById.html \n         */\n        findUpwardsById: function(element, id) {\n            var tst = function(el) {\n                return el.id === id;\n            };\n            return InkElement.findUpwardsHaving(element, tst);\n        },\n\n        /**\n         * Finds the closest ancestor by CSS selector\n         *\n         * @method findUpwardsBySelector\n         * @param {HtmlElement} element     Element to base the search from\n         * @param {String}      sel         CSS selector\n         * @returns {HtmlElement|false} The matched element or false if did not match\n         * @sample Ink_Dom_Element_1_findUpwardsBySelector.html \n         */\n        findUpwardsBySelector: function(element, sel) {\n            var Selector = Ink.getModule('Ink.Dom.Selector', '1');\n            if (!Selector) {\n                throw new Error('This method requires Ink.Dom.Selector');\n            }\n            var tst = function(el) {\n                return Selector.matchesSelector(el, sel);\n            };\n            return InkElement.findUpwardsHaving(element, tst);\n        },\n\n        /**\n         * Gets the trimmed text of an element\n         *\n         * @method getChildrenText\n         * @param {DOMElement}  el          Element to base the search from\n         * @param {Boolean}     [removeIt]  Flag to remove the text from the element\n         * @return {String} Text found\n         * @sample Ink_Dom_Element_1_getChildrenText.html \n         */\n        getChildrenText: function(el, removeIt) {\n            var node,\n                j,\n                part,\n                nodes = el.childNodes,\n                jLen = nodes.length,\n                text = '';\n\n            if (!el) {\n                return text;\n            }\n\n            for (j = 0; j < jLen; ++j) {\n                node = nodes[j];\n                if (!node) {    continue;   }\n                if (node.nodeType === 3) {  // TEXT NODE\n                    part = InkElement._trimString( String(node.data) );\n                    if (part.length > 0) {\n                        text += part;\n                        if (removeIt) { el.removeChild(node);   }\n                    }\n                    else {  el.removeChild(node);   }\n                }\n            }\n\n            return text;\n        },\n\n        /**\n         * String trim implementation\n         * Used by getChildrenText\n         *\n         * function _trimString\n         * param {String} text\n         * return {String} trimmed text\n         */\n        _trimString: function(text) {\n            return (String.prototype.trim) ? text.trim() : text.replace(/^\\s*/, '').replace(/\\s*$/, '');\n        },\n\n        /**\n         * Gets value of a select element\n         *\n         * @method getSelectValues\n         * @param {DOMElement|String} select element\n         * @return {Array} The selected values\n         * @sample Ink_Dom_Element_1_getSelectValues.html \n         */\n        getSelectValues: function (select) {\n            var selectEl = Ink.i(select);\n            var values = [];\n            for (var i = 0; i < selectEl.options.length; ++i) {\n                values.push( selectEl.options[i].value );\n            }\n            return values;\n        },\n\n\n        /* used by fills */\n        _normalizeData: function(data) {\n            var d, data2 = [];\n            for (var i = 0, f = data.length; i < f; ++i) {\n                d = data[i];\n\n                if (!(d instanceof Array)) {    // if not array, wraps primitive twice:     val -> [val, val]\n                    d = [d, d];\n                }\n                else if (d.length === 1) {      // if 1 element array:                      [val] -> [val, val]\n                    d.push(d[0]);\n                }\n                data2.push(d);\n            }\n            return data2;\n        },\n\n\n        /**\n         * Fills a select element with options\n         *\n         * @method fillSelect\n         * @param {DOMElement|String}  container       Select element which will get filled\n         * @param {Array}              data            Data to populate the component\n         * @param {Boolean}            [skipEmpty]     Flag to skip empty option\n         * @param {String|Number}      [defaultValue]  Initial selected value\n         * @return {void}\n         * @public\n         *\n         * @sample Ink_Dom_Element_1_fillSelect.html \n         */\n        fillSelect: function(container, data, skipEmpty, defaultValue) {\n            var containerEl = Ink.i(container);\n            if (!containerEl) {   return; }\n\n            containerEl.innerHTML = '';\n            var d, optionEl;\n\n            if (!skipEmpty) {\n                // add initial empty option\n                optionEl = document.createElement('option');\n                optionEl.setAttribute('value', '');\n                containerEl.appendChild(optionEl);\n            }\n\n            data = InkElement._normalizeData(data);\n\n            for (var i = 0, f = data.length; i < f; ++i) {\n                d = data[i];\n\n                optionEl = document.createElement('option');\n                optionEl.setAttribute('value', d[0]);\n                if (d.length > 2) {\n                    optionEl.setAttribute('extra', d[2]);\n                }\n                optionEl.appendChild( document.createTextNode(d[1]) );\n\n                if (d[0] === defaultValue) {\n                    optionEl.setAttribute('selected', 'selected');\n                }\n\n                containerEl.appendChild(optionEl);\n            }\n        },\n\n\n        /**\n         * Creates a set of radio buttons from an array of data\n         *\n         * @method fillRadios\n         * @param {Element|String} insertAfterEl  Element after which the input elements will be created\n         * @param {String}         name           Name for the form field ([] is added if not present as a suffix)\n         * @param {Array}          data           Data to populate the component\n         * @param {Boolean}        [skipEmpty]    Flag to skip creation of empty options\n         * @param {String|Number}  [defaultValue] Initial selected value\n         * @param {String}         [splitEl]      Name of element to add after each input element (example: 'br')\n         * @return {DOMElement} Wrapper element around the radio buttons\n         */\n        fillRadios: function(insertAfterEl, name, data, skipEmpty, defaultValue, splitEl) {\n            insertAfterEl = Ink.i(insertAfterEl);\n            var containerEl = document.createElement('span');\n            InkElement.insertAfter(containerEl, insertAfterEl);\n\n            data = InkElement._normalizeData(data);\n\n            /*\n            if (name.substring(name.length - 1) !== ']') {\n                name += '[]';\n            }\n            */\n\n            var d, inputEl;\n\n            if (!skipEmpty) {\n                // add initial empty option\n                inputEl = document.createElement('input');\n                inputEl.setAttribute('type', 'radio');\n                inputEl.setAttribute('name', name);\n                inputEl.setAttribute('value', '');\n                containerEl.appendChild(inputEl);\n                if (splitEl) {  containerEl.appendChild( document.createElement(splitEl) ); }\n            }\n\n            for (var i = 0; i < data.length; ++i) {\n                d = data[i];\n\n                inputEl = document.createElement('input');\n                inputEl.setAttribute('type', 'radio');\n                inputEl.setAttribute('name', name);\n                inputEl.setAttribute('value', d[0]);\n                containerEl.appendChild(inputEl);\n                containerEl.appendChild( document.createTextNode(d[1]) );\n                if (splitEl) {  containerEl.appendChild( document.createElement(splitEl) ); }\n\n                if (d[0] === defaultValue) {\n                    inputEl.checked = true;\n                }\n            }\n\n            return containerEl;\n        },\n\n\n        /**\n         * Creates set of checkbox buttons\n         *\n         * @method fillChecks\n         * @param {Element|String} insertAfterEl  Element after which the input elements will be created\n         * @param {String}         name           Name for the form field ([] is added if not present as a suffix)\n         * @param {Array}          data           Data to populate the component\n         * @param {String|Number}  [defaultValue] Initial selected value\n         * @param {String}         [splitEl]      Name of element to add after each input element (example: 'br')\n         * @return {Element} Wrapper element around the checkboxes\n         * @public\n         */\n        fillChecks: function(insertAfterEl, name, data, defaultValue, splitEl) {\n            insertAfterEl = Ink.i(insertAfterEl);\n            var containerEl = document.createElement('span');\n            InkElement.insertAfter(containerEl, insertAfterEl);\n\n            data = InkElement._normalizeData(data);\n\n            if (name.substring(name.length - 1) !== ']') {\n                name += '[]';\n            }\n\n            var d, inputEl;\n\n            for (var i = 0; i < data.length; ++i) {\n                d = data[i];\n\n                inputEl = document.createElement('input');\n                inputEl.setAttribute('type', 'checkbox');\n                inputEl.setAttribute('name', name);\n                inputEl.setAttribute('value', d[0]);\n                containerEl.appendChild(inputEl);\n                containerEl.appendChild( document.createTextNode(d[1]) );\n                if (splitEl) {  containerEl.appendChild( document.createElement(splitEl) ); }\n\n                if (d[0] === defaultValue) {\n                    inputEl.checked = true;\n                }\n            }\n\n            return containerEl;\n        },\n\n\n        /**\n         * Gets the index of an element relative to a parent\n         *\n         * @method parentIndexOf\n         * @param {Element} [parentEl] childEl's parent. Deprecated.\n         * @param {Element} childEl    Child Element to look for\n         * @return {Number} The index of the childEl inside parentEl. Returns -1 if it's not a direct child\n         * @public\n         * @sample Ink_Dom_Element_1_parentIndexOf.html \n         */\n        parentIndexOf: function(parentEl, childEl) {\n            if (!childEl) {\n                // one argument form\n                childEl = parentEl;\n                parentEl = parentEl.parentNode;\n            }\n            if (!parentEl) { return false; }\n            for (var i = 0, f = parentEl.children.length; i < f; ++i) {\n                if (parentEl.children[i] === childEl) {\n                    return i;\n                }\n            }\n            return false;\n        },\n\n\n        /**\n         * Gets the next siblings of an element\n         *\n         * @method nextSiblings\n         * @param {String|DOMElement} elm Element\n         * @return {Array} Array of next sibling elements\n         * @sample Ink_Dom_Element_1_nextSiblings.html \n         */\n        nextSiblings: function(elm) {\n            elm = Ink.i(elm);\n            if(typeof(elm) === 'object' && elm !== null && elm.nodeType && elm.nodeType === 1) {\n                var elements = [],\n                    siblings = elm.parentNode.children,\n                    index    = InkElement.parentIndexOf(elm.parentNode, elm);\n\n                for(var i = ++index, len = siblings.length; i<len; i++) {\n                    elements.push(siblings[i]);\n                }\n\n                return elements;\n            }\n            return [];\n        },\n\n\n        /**\n         * Gets the previous siblings of an element\n         *\n         * @method previousSiblings\n         * @param {String|DOMElement} elm Element\n         * @return {Array} Array of previous sibling elements\n         * @sample Ink_Dom_Element_1_previousSiblings.html \n         */\n        previousSiblings: function(elm) {\n            elm = Ink.i(elm);\n            if(typeof(elm) === 'object' && elm !== null && elm.nodeType && elm.nodeType === 1) {\n                var elements    = [],\n                    siblings    = elm.parentNode.children,\n                    index       = InkElement.parentIndexOf(elm.parentNode, elm);\n\n                for(var i = 0, len = index; i<len; i++) {\n                    elements.push(siblings[i]);\n                }\n\n                return elements;\n            }\n            return [];\n        },\n\n\n        /**\n         * Gets the all siblings of an element\n         *\n         * @method siblings\n         * @param {String|DOMElement} elm Element\n         * @return {Array} Array of sibling elements\n         * @sample Ink_Dom_Element_1_siblings.html \n         */\n        siblings: function(elm) {\n            elm = Ink.i(elm);\n            if(typeof(elm) === 'object' && elm !== null && elm.nodeType && elm.nodeType === 1) {\n                var elements   = [],\n                    siblings   = elm.parentNode.children;\n\n                for(var i = 0, len = siblings.length; i<len; i++) {\n                    if(elm !== siblings[i]) {\n                        elements.push(siblings[i]);\n                    }\n                }\n\n                return elements;\n            }\n            return [];\n        },\n\n        /**\n         * Counts the number of children of an element\n         *\n         * @method childElementCount\n         * @param {String|DOMElement} elm element\n         * @return {Number} number of child elements\n         * @sample Ink_Dom_Element_1_childElementCount.html \n         */\n        childElementCount: function(elm) {\n            elm = Ink.i(elm);\n            if ('childElementCount' in elm) {\n                return elm.childElementCount;\n            }\n            if (!elm) { return 0; }\n            return InkElement.siblings(elm).length + 1;\n        },\n\n        _wrapElements: {\n            TABLE: function (div, html) {\n                /* If we don't create a tbody, IE7 does that for us. Adding a tbody with a random string and then filtering for that random string is the only way to avoid double insertion of tbodies. */\n                if (browserCreatesTbodies) {\n                    div.innerHTML = \"<table>\" + html + \"<tbody><tr><td>\" + deleteThisTbodyToken + \"</tr></td></tbody></table>\";\n                } else {\n                    div.innerHTML = \"<table>\" + html + \"</table>\";\n                }\n                return div.firstChild;\n            },\n            TBODY: function (div, html) {\n                div.innerHTML = '<table><tbody>' + html + '</tbody></table>';\n                return div.firstChild.getElementsByTagName('tbody')[0];\n            },\n            THEAD: function (div, html) {\n                div.innerHTML = '<table><thead>' + html + '</thead><tbody></tbody></table>';\n                return div.firstChild.getElementsByTagName('thead')[0];\n            },\n            TFOOT: function (div, html) {\n                div.innerHTML = '<table><tfoot>' + html + '</tfoot><tbody></tbody></table>';\n                return div.firstChild.getElementsByTagName('tfoot')[0];\n            },\n            TR: function (div, html) {\n                div.innerHTML = '<table><tbody><tr>' + html + '</tr></tbody></table>';\n                return div.firstChild.firstChild.firstChild;\n            }\n        },\n\n        /**\n         * Gets a wrapper DIV with a certain HTML content to be inserted inside another element.\n         * This is necessary for appendHTML,prependHTML functions, because they need a container element to copy the children from.\n         *\n         * Works around IE table quirks\n         * @method _getWrapper\n         * @private\n         * @param elm\n         * @param html\n         */\n        _getWrapper: function (elm, html) {\n            var nodeName = elm.nodeName && elm.nodeName.toUpperCase();\n            var wrapper = document.createElement('div');\n            var wrapFunc = InkElement._wrapElements[nodeName];\n\n            if ( !wrapFunc ) {\n                wrapper.innerHTML = html;\n                return wrapper;\n            }\n            // special cases\n            wrapper = wrapFunc(wrapper, html);\n            // worst case: tbody auto-creation even when our HTML has a tbody.\n            if (browserCreatesTbodies && nodeName === 'TABLE') {\n                // terrible case. Deal with tbody creation too.\n                var tds = wrapper.getElementsByTagName('td');\n                for (var i = 0, len = tds.length; i < len; i++) {\n                    if (tds[i].innerHTML === deleteThisTbodyToken) {\n                        var tbody = tds[i].parentNode.parentNode;\n                        tbody.parentNode.removeChild(tbody);\n                    }\n                }\n            }\n            return wrapper;\n        },\n\n        /**\n         * Appends HTML to an element.\n         * This method parses the html string and doesn't modify its contents\n         *\n         * @method appendHTML\n         * @param {String|DOMElement} elm   Element\n         * @param {String}            html  Markup string\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_appendHTML.html \n         */\n        appendHTML: function(elm, html){\n            elm = Ink.i(elm);\n            if(elm !== null) {\n                var wrapper = InkElement._getWrapper(elm, html);\n                while (wrapper.firstChild) {\n                    elm.appendChild(wrapper.firstChild);\n                }\n            }\n        },\n\n        /**\n         * Prepends HTML to an element.\n         * This method parses the html string and doesn't modify its contents\n         *\n         * @method prependHTML\n         * @param {String|Element} elm   Element\n         * @param {String}         html  Markup string to prepend\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_prependHTML.html \n         */\n        prependHTML: function(elm, html){\n            elm = Ink.i(elm);\n            if(elm !== null) {\n                var wrapper = InkElement._getWrapper(elm, html);\n                while (wrapper.lastChild) {\n                    elm.insertBefore(wrapper.lastChild, elm.firstChild);\n                }\n            }\n        },\n\n        /**\n         * Sets the inner HTML of an element.\n         *\n         * @method setHTML\n         * @param {String|DOMElement} elm   Element\n         * @param {String}            html  Markup string\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_setHTML.html \n         */\n        setHTML: function (elm, html) {\n            elm = Ink.i(elm);\n            if(elm !== null) {\n                try {\n                    elm.innerHTML = html;\n                } catch (e) {\n                    // Tables in IE7\n                    while (elm.firstChild) {\n                        elm.removeChild(elm.firstChild);\n                    }\n                    InkElement.appendHTML(elm, html);\n                }\n            }\n        },\n\n        /**\n         * Wraps an element inside a container.\n         *\n         * The container may or may not be in the document yet.\n         *\n         * @method wrap\n         * @param {String|Element} target    Element to be wrapped\n         * @param {String|Element} container Element to wrap the target\n         * @return {Element} Container element\n         * @public\n         * @sample Ink_Dom_Element_1_wrap.html \n         *\n         * @example\n         * before:\n         *\n         *     <div id=\"target\"></div>\n         *\n         * call this function to wrap #target with a wrapper div.\n         *\n         *     InkElement.wrap('target', InkElement.create('div', {id: 'container'});\n         * \n         * after: \n         *\n         *     <div id=\"container\"><div id=\"target\"></div></div>\n         */\n        wrap: function (target, container) {\n            target = Ink.i(target);\n            container = Ink.i(container);\n            \n            var nextNode = target.nextSibling;\n            var parent = target.parentNode;\n\n            container.appendChild(target);\n\n            if (nextNode !== null) {\n                parent.insertBefore(container, nextNode);\n            } else {\n                parent.appendChild(container);\n            }\n\n            return container;\n        },\n\n        /**\n         * Places an element outside a wrapper.\n         *\n         * @method unwrap\n         * @param {DOMElement}  elem                The element you're trying to unwrap. This should be an ancestor of the wrapper.\n         * @param {String}      [wrapperSelector]   CSS Selector for the ancestor. Use this if your wrapper is not the direct parent of elem.\n         * @return {void}\n         * @sample Ink_Dom_Element_1_unwrap.html \n         *\n         * @example\n         *\n         * When you have this:\n         *\n         *      <div id=\"wrapper\">\n         *          <div id=\"unwrapMe\"></div>\n         *      </div>\n         *\n         * If you do this:\n         *\n         *      InkElement.unwrap('unwrapMe');\n         *\n         * You get this:\n         *\n         *      <div id=\"unwrapMe\"></div>\n         *      <div id=\"wrapper\"></div>\n         *      \n         **/\n        unwrap: function (elem, wrapperSelector) {\n            elem = Ink.i(elem);\n            var wrapper;\n            if (typeof wrapperSelector === 'string') {\n                wrapper = InkElement.findUpwardsBySelector(elem, wrapperSelector);\n            } else if (typeof wrapperSelector === 'object' && wrapperSelector.tagName) {\n                wrapper = InkElement.findUpwardsHaving(elem, function (ancestor) {\n                    return ancestor === wrapperSelector;\n                });\n            } else {\n                wrapper = elem.parentNode;\n            }\n            if (!wrapper || !wrapper.parentNode) { return; }\n\n            InkElement.insertBefore(elem, wrapper);\n        },\n\n        /**\n         * Replaces an element with another.\n         *\n         * @method replace\n         * @param {Element} element       The element to be replaced.\n         * @param {Element} replacement   The new element.\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_replace.html \n         *\n         * @example\n         *       var newelement1 = InkElement.create('div');\n         *       // ...\n         *       replace(Ink.i('element1'), newelement1);\n         */\n        replace: function (element, replacement) {\n            element = Ink.i(element);\n            if(element !== null) {\n                element.parentNode.replaceChild(replacement, element);\n            }\n        },\n\n        /**\n         * Removes direct text children.\n         * Useful to remove nasty layout gaps generated by whitespace on the markup.\n         *\n         * @method removeTextNodeChildren\n         * @param  {Element} el          Element to remove text from\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_removeTextNodeChildren.html \n         */\n        removeTextNodeChildren: function(el) {\n            el = Ink.i(el);\n            if(el !== null) {\n                var prevEl, toRemove, parent = el;\n                el = el.firstChild;\n                while (el) {\n                    toRemove = (el.nodeType === 3);\n                    prevEl = el;\n                    el = el.nextSibling;\n                    if (toRemove) {\n                        parent.removeChild(prevEl);\n                    }\n                }\n            }\n        },\n\n        /**\n         * Creates a documentFragment from an HTML string.\n         *\n         * @method htmlToFragment\n         * @param  {String} html  HTML string\n         * @return {DocumentFragment} DocumentFragment containing all of the elements from the html string\n         * @sample Ink_Dom_Element_1_htmlToFragment.html \n         */\n        htmlToFragment: (createContextualFragmentSupport ?\n            function(html){\n                var range;\n\n                if(typeof html !== 'string'){ return document.createDocumentFragment(); }\n\n                range = document.createRange();\n\n                // set the context to document.body (firefox does this already, webkit doesn't)\n                range.selectNode(document.body);\n\n                return range.createContextualFragment(html);\n            } : function (html) {\n                var fragment = document.createDocumentFragment(),\n                    tempElement,\n                    current;\n\n                if(typeof html !== 'string'){ return fragment; }\n\n                tempElement = document.createElement('div');\n                tempElement.innerHTML = html;\n\n                // append child removes elements from the original parent\n                while( (current = tempElement.firstChild) ){ // intentional assignment\n                    fragment.appendChild(current);\n                }\n\n                return fragment;\n            }),\n\n        _camelCase: function(str)\n        {\n            return str ? str.replace(/-(\\w)/g, function (_, $1){\n                return $1.toUpperCase();\n            }) : str;\n        },\n\n        /**\n         * Gets data attributes from an element\n         *\n         * @method data\n         * @param {String|DOMElement} selector Element or CSS selector\n         * @return {Object} Object with the data-* properties. If no data-attributes are present, an empty object is returned.\n         * @sample Ink_Dom_Element_1_data.html \n        */\n        data: function(selector) {\n            var el;\n            if (typeof selector !== 'object' && typeof selector !== 'string') {\n                throw '[Ink.Dom.Element.data] :: Invalid selector defined';\n            }\n\n            if (typeof selector === 'object') {\n                el = selector;\n            }\n            else {\n                var InkDomSelector = Ink.getModule('Ink.Dom.Selector', 1);\n                if (!InkDomSelector) {\n                    throw \"[Ink.Dom.Element.data] :: this method requires Ink.Dom.Selector - v1\";\n                }\n                el = InkDomSelector.select(selector);\n                if (el.length <= 0) {\n                    throw \"[Ink.Dom.Element.data] :: Can't find any element with the specified selector\";\n                }\n                el = el[0];\n            }\n\n            var dataset = {};\n            var attrs = el.attributes || [];\n\n            var curAttr, curAttrName, curAttrValue;\n            if (attrs) {\n                for (var i = 0, total = attrs.length; i < total; ++i) {\n                    curAttr = attrs[i];\n                    curAttrName = curAttr.name;\n                    curAttrValue = curAttr.value;\n                    if (curAttrName && curAttrName.indexOf('data-') === 0) {\n                        dataset[InkElement._camelCase(curAttrName.replace('data-', ''))] = curAttrValue;\n                    }\n                }\n            }\n\n            return dataset;\n        },\n\n        /**\n         * Move the cursor on an input or textarea element.\n         * @method moveCursorTo\n         * @param  {Element}    el  Input or Textarea element\n         * @param  {Number}     t   Index of the character to move the cursor to\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Element_1_moveCursorTo.html \n         */\n        moveCursorTo: function(el, t) {\n            el = Ink.i(el);\n            if(el !== null) {\n                if (el.setSelectionRange) {\n                    el.setSelectionRange(t, t);\n                    //el.focus();\n                }\n                else {\n                    var range = el.createTextRange();\n                    range.collapse(true);\n                    range.moveEnd(  'character', t);\n                    range.moveStart('character', t);\n                    range.select();\n                }\n            }\n        },\n\n        /**\n         * Get the page's width.\n         * @method pageWidth\n         * @return {Number} Page width in pixels\n         * @sample Ink_Dom_Element_1_pageWidth.html \n         */\n        pageWidth: function() {\n            var xScroll;\n\n            if (window.innerWidth && window.scrollMaxX) {\n                xScroll = window.innerWidth + window.scrollMaxX;\n            } else if (document.body.scrollWidth > document.body.offsetWidth){\n                xScroll = document.body.scrollWidth;\n            } else {\n                xScroll = document.body.offsetWidth;\n            }\n\n            var windowWidth;\n\n            if (window.self.innerWidth) {\n                if(document.documentElement.clientWidth){\n                    windowWidth = document.documentElement.clientWidth;\n                } else {\n                    windowWidth = window.self.innerWidth;\n                }\n            } else if (document.documentElement && document.documentElement.clientWidth) {\n                windowWidth = document.documentElement.clientWidth;\n            } else if (document.body) {\n                windowWidth = document.body.clientWidth;\n            }\n\n            if(xScroll < windowWidth){\n                return xScroll;\n            } else {\n                return windowWidth;\n            }\n        },\n\n        /**\n         * Get the page's height.\n         * @method pageHeight\n         * @return {Number} Page height in pixels\n         * @sample Ink_Dom_Element_1_pageHeight.html \n         */\n        pageHeight: function() {\n            var yScroll;\n\n            if (window.innerHeight && window.scrollMaxY) {\n                yScroll = window.innerHeight + window.scrollMaxY;\n            } else if (document.body.scrollHeight > document.body.offsetHeight){\n                yScroll = document.body.scrollHeight;\n            } else {\n                yScroll = document.body.offsetHeight;\n            }\n\n            var windowHeight;\n\n            if (window.self.innerHeight) {\n                windowHeight = window.self.innerHeight;\n            } else if (document.documentElement && document.documentElement.clientHeight) {\n                windowHeight = document.documentElement.clientHeight;\n            } else if (document.body) {\n                windowHeight = document.body.clientHeight;\n            }\n\n            if(yScroll < windowHeight){\n                return windowHeight;\n            } else {\n                return yScroll;\n            }\n        },\n\n       /**\n         * Get the viewport's width.\n         * @method viewportWidth\n         * @return {Number} Viewport width in pixels\n         * @sample Ink_Dom_Element_1_viewportWidth.html \n         */\n        viewportWidth: function() {\n            if(typeof window.innerWidth !== \"undefined\") {\n                return window.innerWidth;\n            }\n            if (document.documentElement && typeof document.documentElement.offsetWidth !== \"undefined\") {\n                return document.documentElement.offsetWidth;\n            }\n        },\n\n        /**\n         * Get the viewport's height.\n         * @method viewportHeight\n         * @return {Number} Viewport height in pixels\n         * @sample Ink_Dom_Element_1_viewportHeight.html \n         */\n        viewportHeight: function() {\n            if (typeof window.innerHeight !== \"undefined\") {\n                return window.innerHeight;\n            }\n            if (document.documentElement && typeof document.documentElement.offsetHeight !== \"undefined\") {\n                return document.documentElement.offsetHeight;\n            }\n        },\n\n        /**\n         * Get the scroll's width.\n         * @method scrollWidth\n         * @return {Number} Scroll width\n         */\n        scrollWidth: function() {\n            if (typeof window.self.pageXOffset !== 'undefined') {\n                return window.self.pageXOffset;\n            }\n            if (typeof document.documentElement !== 'undefined' && typeof document.documentElement.scrollLeft !== 'undefined') {\n                return document.documentElement.scrollLeft;\n            }\n            return document.body.scrollLeft;\n        },\n\n        /**\n         * Get the scroll's height.\n         * @method scrollHeight\n         * @return {Number} Scroll height\n         */\n        scrollHeight: function() {\n            if (typeof window.self.pageYOffset !== 'undefined') {\n                return window.self.pageYOffset;\n            }\n            if (typeof document.documentElement !== 'undefined' && typeof document.documentElement.scrollTop !== 'undefined') {\n                return document.documentElement.scrollTop;\n            }\n            return document.body.scrollTop;\n        }\n    };\n\n    return InkElement;\n\n});\n","/**\n * Event management\n * @module Ink.Dom.Event_1\n * @version 1\n */\n\nInk.createModule('Ink.Dom.Event', 1, [], function() {\n    /* jshint\n           asi:true,\n           strict:false,\n           laxcomma:true,\n           eqeqeq:false,\n           laxbreak:true,\n           boss:true,\n           curly:false,\n           expr:true\n           */\n\n    /**\n     * @namespace Ink.Dom.Event_1\n     * @static\n     */\n\n    /*!\n      * Bean - copyright (c) Jacob Thornton 2011-2012\n      * https://github.com/fat/bean\n      * MIT license\n      */\n    var bean = (function (name, context, definition) {\n      return definition()\n    })('bean', this, function (name, context) {\n      name    = name    || 'bean'\n      context = context || this\n\n      var win            = window\n        , old            = context[name]\n        , namespaceRegex = /[^\\.]*(?=\\..*)\\.|.*/\n        , nameRegex      = /\\..*/\n        , addEvent       = 'addEventListener'\n        , removeEvent    = 'removeEventListener'\n        , doc            = document || {}\n        , root           = doc.documentElement || {}\n        , W3C_MODEL      = root[addEvent]\n        , eventSupport   = W3C_MODEL ? addEvent : 'attachEvent'\n        , ONE            = {} // singleton for quick matching making add() do one()\n\n        , slice          = Array.prototype.slice\n        , str2arr        = function (s, d) { return s.split(d || ' ') }\n        , isString       = function (o) { return typeof o == 'string' }\n        , isFunction     = function (o) { return typeof o == 'function' }\n\n          // events that we consider to be 'native', anything not in this list will\n          // be treated as a custom event\n        , standardNativeEvents =\n            'click dblclick mouseup mousedown contextmenu '                  + // mouse buttons\n            'mousewheel mousemultiwheel DOMMouseScroll '                     + // mouse wheel\n            'mouseover mouseout mousemove selectstart selectend '            + // mouse movement\n            'keydown keypress keyup '                                        + // keyboard\n            'orientationchange '                                             + // mobile\n            'focus blur change reset select submit '                         + // form elements\n            'load unload beforeunload resize move DOMContentLoaded '         + // window\n            'readystatechange message '                                      + // window\n            'error abort scroll '                                              // misc\n          // element.fireEvent('onXYZ'... is not forgiving if we try to fire an event\n          // that doesn't actually exist, so make sure we only do these on newer browsers\n        , w3cNativeEvents =\n            'show '                                                          + // mouse buttons\n            'input invalid '                                                 + // form elements\n            'touchstart touchmove touchend touchcancel '                     + // touch\n            'gesturestart gesturechange gestureend '                         + // gesture\n            'textinput'                                                      + // TextEvent\n            'readystatechange pageshow pagehide popstate '                   + // window\n            'hashchange offline online '                                     + // window\n            'afterprint beforeprint '                                        + // printing\n            'dragstart dragenter dragover dragleave drag drop dragend '      + // dnd\n            'loadstart progress suspend emptied stalled loadmetadata '       + // media\n            'loadeddata canplay canplaythrough playing waiting seeking '     + // media\n            'seeked ended durationchange timeupdate play pause ratechange '  + // media\n            'volumechange cuechange '                                        + // media\n            'checking noupdate downloading cached updateready obsolete '       // appcache\n\n          // convert to a hash for quick lookups\n        , nativeEvents = (function (hash, events, i) {\n            for (i = 0; i < events.length; i++) events[i] && (hash[events[i]] = 1)\n            return hash\n          }({}, str2arr(standardNativeEvents + (W3C_MODEL ? w3cNativeEvents : ''))))\n\n          // custom events are events that we *fake*, they are not provided natively but\n          // we can use native events to generate them\n        , customEvents = (function () {\n            var isAncestor = 'compareDocumentPosition' in root\n                  ? function (element, container) {\n                      return container.compareDocumentPosition && (container.compareDocumentPosition(element) & 16) === 16\n                    }\n                  : 'contains' in root\n                    ? function (element, container) {\n                        container = container.nodeType === 9 || container === window ? root : container\n                        return container !== element && container.contains(element)\n                      }\n                    : function (element, container) {\n                        while (element = element.parentNode) if (element === container) return 1\n                        return 0\n                      }\n              , check = function (event) {\n                  var related = event.relatedTarget\n                  return !related\n                    ? related == null\n                    : (related !== this && related.prefix !== 'xul' && !/document/.test(this.toString())\n                        && !isAncestor(related, this))\n                }\n\n            return {\n                mouseenter: { base: 'mouseover', condition: check }\n              , mouseleave: { base: 'mouseout', condition: check }\n              , mousewheel: { base: /Firefox/.test(navigator.userAgent) ? 'DOMMouseScroll' : 'mousewheel' }\n            }\n          }())\n\n          // we provide a consistent Event object across browsers by taking the actual DOM\n          // event object and generating a new one from its properties.\n        , Event = (function () {\n                // a whitelist of properties (for different event types) tells us what to check for and copy\n            var commonProps  = str2arr('altKey attrChange attrName bubbles cancelable ctrlKey currentTarget ' +\n                  'detail eventPhase getModifierState isTrusted metaKey relatedNode relatedTarget shiftKey '  +\n                  'srcElement target timeStamp type view which propertyName path')\n              , mouseProps   = commonProps.concat(str2arr('button buttons clientX clientY dataTransfer '      +\n                  'fromElement offsetX offsetY pageX pageY screenX screenY toElement movementX movementY region'))\n              , mouseWheelProps = mouseProps.concat(str2arr('wheelDelta wheelDeltaX wheelDeltaY wheelDeltaZ ' +\n                  'axis')) // 'axis' is FF specific\n              , keyProps     = commonProps.concat(str2arr('char charCode key keyCode keyIdentifier '          +\n                  'keyLocation location isComposing code'))\n              , textProps    = commonProps.concat(str2arr('data'))\n              , touchProps   = commonProps.concat(str2arr('touches targetTouches changedTouches scale rotation'))\n              , messageProps = commonProps.concat(str2arr('data origin source'))\n              , stateProps   = commonProps.concat(str2arr('state'))\n              , overOutRegex = /over|out/\n                // some event types need special handling and some need special properties, do that all here\n              , typeFixers   = [\n                    { // key events\n                        reg: /key/i\n                      , fix: function (event, newEvent) {\n                          newEvent.keyCode = event.keyCode || event.which\n                          return keyProps\n                        }\n                    }\n                  , { // mouse events\n                        reg: /click|mouse(?!(.*wheel|scroll))|menu|drag|drop/i\n                      , fix: function (event, newEvent, type) {\n                          newEvent.rightClick = event.which === 3 || event.button === 2\n                          newEvent.pos = { x: 0, y: 0 }\n                          if (event.pageX || event.pageY) {\n                            newEvent.clientX = event.pageX\n                            newEvent.clientY = event.pageY\n                          } else if (event.clientX || event.clientY) {\n                            newEvent.clientX = event.clientX + doc.body.scrollLeft + root.scrollLeft\n                            newEvent.clientY = event.clientY + doc.body.scrollTop + root.scrollTop\n                          }\n                          if (overOutRegex.test(type)) {\n                            newEvent.relatedTarget = event.relatedTarget\n                              || event[(type == 'mouseover' ? 'from' : 'to') + 'Element']\n                          }\n                          return mouseProps\n                        }\n                    }\n                  , { // mouse wheel events\n                        reg: /mouse.*(wheel|scroll)/i\n                      , fix: function () { return mouseWheelProps }\n                    }\n                  , { // TextEvent\n                        reg: /^text/i\n                      , fix: function () { return textProps }\n                    }\n                  , { // touch and gesture events\n                        reg: /^touch|^gesture/i\n                      , fix: function () { return touchProps }\n                    }\n                  , { // message events\n                        reg: /^message$/i\n                      , fix: function () { return messageProps }\n                    }\n                  , { // popstate events\n                        reg: /^popstate$/i\n                      , fix: function () { return stateProps }\n                    }\n                  , { // everything else\n                        reg: /.*/\n                      , fix: function () { return commonProps }\n                    }\n                ]\n              , typeFixerMap = {} // used to map event types to fixer functions (above), a basic cache mechanism\n\n              , Event = function (event, element, isNative) {\n                  if (!arguments.length) return\n                  event = event || ((element.ownerDocument || element.document || element).parentWindow || win).event\n                  this.originalEvent = event\n                  this.isNative       = isNative\n                  this.isBean         = true\n\n                  if (!event) return\n\n                  var type   = event.type\n                    , target = event.target || event.srcElement\n                    , i, l, p, props, fixer\n\n                  this.target = target && target.nodeType === 3 ? target.parentNode : target\n\n                  if (isNative) { // we only need basic augmentation on custom events, the rest expensive & pointless\n                    fixer = typeFixerMap[type]\n                    if (!fixer) { // haven't encountered this event type before, map a fixer function for it\n                      for (i = 0, l = typeFixers.length; i < l; i++) {\n                        if (typeFixers[i].reg.test(type)) { // guaranteed to match at least one, last is .*\n                          typeFixerMap[type] = fixer = typeFixers[i].fix\n                          break\n                        }\n                      }\n                    }\n\n                    props = fixer(event, this, type)\n                    for (i = props.length; i--;) {\n                      if (!((p = props[i]) in this) && p in event) this[p] = event[p]\n                    }\n                  }\n                }\n\n            // preventDefault() and stopPropagation() are a consistent interface to those functions\n            // on the DOM, stop() is an alias for both of them together\n            Event.prototype.preventDefault = function () {\n              if (this.originalEvent.preventDefault) this.originalEvent.preventDefault()\n              else this.originalEvent.returnValue = false\n            }\n            Event.prototype.stopPropagation = function () {\n              if (this.originalEvent.stopPropagation) this.originalEvent.stopPropagation()\n              else this.originalEvent.cancelBubble = true\n            }\n            Event.prototype.stop = function () {\n              this.preventDefault()\n              this.stopPropagation()\n              this.stopped = true\n            }\n            // stopImmediatePropagation() has to be handled internally because we manage the event list for\n            // each element\n            // note that originalElement may be a Bean#Event object in some situations\n            Event.prototype.stopImmediatePropagation = function () {\n              if (this.originalEvent.stopImmediatePropagation) this.originalEvent.stopImmediatePropagation()\n              this.isImmediatePropagationStopped = function () { return true }\n            }\n            Event.prototype.isImmediatePropagationStopped = function () {\n              return this.originalEvent.isImmediatePropagationStopped && this.originalEvent.isImmediatePropagationStopped()\n            }\n            Event.prototype.clone = function (currentTarget) {\n              //TODO: this is ripe for optimisation, new events are *expensive*\n              // improving this will speed up delegated events\n              var ne = new Event(this, this.element, this.isNative)\n              ne.currentTarget = currentTarget\n              return ne\n            }\n\n            return Event\n          }())\n\n          // if we're in old IE we can't do onpropertychange on doc or win so we use doc.documentElement for both\n        , targetElement = function (element, isNative) {\n            return !W3C_MODEL && !isNative && (element === doc || element === win) ? root : element\n          }\n\n          /**\n            * Bean maintains an internal registry for event listeners. We don't touch elements, objects\n            * or functions to identify them, instead we store everything in the registry.\n            * Each event listener has a RegEntry object, we have one 'registry' for the whole instance.\n            */\n        , RegEntry = (function () {\n            // each handler is wrapped so we can handle delegation and custom events\n            var wrappedHandler = function (element, fn, condition, args) {\n                var call = function (event, eargs) {\n                      return fn.apply(element, args ? slice.call(eargs, event ? 0 : 1).concat(args) : eargs)\n                    }\n                  , findTarget = function (event, eventElement) {\n                      return fn.__beanDel ? fn.__beanDel.ft(event.target, element) : eventElement\n                    }\n                  , handler = condition\n                      ? function (event) {\n                          var target = findTarget(event, this) // deleated event\n                          if (condition.apply(target, arguments)) {\n                            if (event) event.currentTarget = target\n                            return call(event, arguments)\n                          }\n                        }\n                      : function (event) {\n                          if (fn.__beanDel) event = event.clone(findTarget(event)) // delegated event, fix the fix\n                          return call(event, arguments)\n                        }\n                handler.__beanDel = fn.__beanDel\n                return handler\n              }\n\n            , RegEntry = function (element, type, handler, original, namespaces, args, root) {\n                var customType     = customEvents[type]\n                  , isNative\n\n                if (type == 'unload') {\n                  // self clean-up\n                  handler = once(removeListener, element, type, handler, original)\n                }\n\n                if (customType) {\n                  if (customType.condition) {\n                    handler = wrappedHandler(element, handler, customType.condition, args)\n                  }\n                  type = customType.base || type\n                }\n\n                this.isNative      = isNative = nativeEvents[type] && !!element[eventSupport]\n                this.customType    = !W3C_MODEL && !isNative && type\n                this.element       = element\n                this.type          = type\n                this.original      = original\n                this.namespaces    = namespaces\n                this.eventType     = W3C_MODEL || isNative ? type : 'propertychange'\n                this.target        = targetElement(element, isNative)\n                this[eventSupport] = !!this.target[eventSupport]\n                this.root          = root\n                this.handler       = wrappedHandler(element, handler, null, args)\n              }\n\n            // given a list of namespaces, is our entry in any of them?\n            RegEntry.prototype.inNamespaces = function (checkNamespaces) {\n              var i, j, c = 0\n              if (!checkNamespaces) return true\n              if (!this.namespaces) return false\n              for (i = checkNamespaces.length; i--;) {\n                for (j = this.namespaces.length; j--;) {\n                  if (checkNamespaces[i] == this.namespaces[j]) c++\n                }\n              }\n              return checkNamespaces.length === c\n            }\n\n            // match by element, original fn (opt), handler fn (opt)\n            RegEntry.prototype.matches = function (checkElement, checkOriginal, checkHandler) {\n              return this.element === checkElement &&\n                (!checkOriginal || this.original === checkOriginal) &&\n                (!checkHandler || this.handler === checkHandler)\n            }\n\n            return RegEntry\n          }())\n\n        , registry = (function () {\n            // our map stores arrays by event type, just because it's better than storing\n            // everything in a single array.\n            // uses '$' as a prefix for the keys for safety and 'r' as a special prefix for\n            // rootListeners so we can look them up fast\n            var map = {}\n\n              // generic functional search of our registry for matching listeners,\n              // `fn` returns false to break out of the loop\n              , forAll = function (element, type, original, handler, root, fn) {\n                  var pfx = root ? 'r' : '$'\n                  if (!type || type == '*') {\n                    // search the whole registry\n                    for (var t in map) {\n                      if (t.charAt(0) == pfx) {\n                        forAll(element, t.substr(1), original, handler, root, fn)\n                      }\n                    }\n                  } else {\n                    var i = 0, l, list = map[pfx + type], all = element == '*'\n                    if (!list) return\n                    for (l = list.length; i < l; i++) {\n                      if ((all || list[i].matches(element, original, handler)) && !fn(list[i], list, i, type)) return\n                    }\n                  }\n                }\n\n              , has = function (element, type, original, root) {\n                  // we're not using forAll here simply because it's a bit slower and this\n                  // needs to be fast\n                  var i, list = map[(root ? 'r' : '$') + type]\n                  if (list) {\n                    for (i = list.length; i--;) {\n                      if (!list[i].root && list[i].matches(element, original, null)) return true\n                    }\n                  }\n                  return false\n                }\n\n              , get = function (element, type, original, root) {\n                  var entries = []\n                  forAll(element, type, original, null, root, function (entry) {\n                    return entries.push(entry)\n                  })\n                  return entries\n                }\n\n              , put = function (entry) {\n                  var has = !entry.root && !this.has(entry.element, entry.type, null, false)\n                    , key = (entry.root ? 'r' : '$') + entry.type\n                  ;(map[key] || (map[key] = [])).push(entry)\n                  return has\n                }\n\n              , del = function (entry) {\n                  forAll(entry.element, entry.type, null, entry.handler, entry.root, function (entry, list, i) {\n                    list.splice(i, 1)\n                    entry.removed = true\n                    if (list.length === 0) delete map[(entry.root ? 'r' : '$') + entry.type]\n                    return false\n                  })\n                }\n\n                // dump all entries, used for onunload\n              , entries = function () {\n                  var t, entries = []\n                  for (t in map) {\n                    if (t.charAt(0) == '$') entries = entries.concat(map[t])\n                  }\n                  return entries\n                }\n\n            return { has: has, get: get, put: put, del: del, entries: entries }\n          }())\n\n          // we need a selector engine for delegated events, use querySelectorAll if it exists\n          // but for older browsers we need Qwery, Sizzle or similar\n        , selectorEngine\n        , setSelectorEngine = function (e) {\n            if (!arguments.length) {\n              selectorEngine = doc.querySelectorAll\n                ? function (s, r) {\n                    return r.querySelectorAll(s)\n                  }\n                : function () {\n                    throw new Error('Bean: No selector engine installed') // eeek\n                  }\n            } else {\n              selectorEngine = e\n            }\n          }\n\n          // we attach this listener to each DOM event that we need to listen to, only once\n          // per event type per DOM element\n        , rootListener = function (event, type) {\n            if (!W3C_MODEL && type && event && event.propertyName != '_on' + type) return\n\n            var listeners = registry.get(this, type || event.type, null, false)\n              , l = listeners.length\n              , i = 0\n\n            event = new Event(event, this, true)\n            if (type) event.type = type\n\n            // iterate through all handlers registered for this type, calling them unless they have\n            // been removed by a previous handler or stopImmediatePropagation() has been called\n            for (; i < l && !event.isImmediatePropagationStopped(); i++) {\n              if (!listeners[i].removed) listeners[i].handler.call(this, event)\n            }\n          }\n\n          // add and remove listeners to DOM elements\n        , listener = W3C_MODEL\n            ? function (element, type, add) {\n                // new browsers\n                element[add ? addEvent : removeEvent](type, rootListener, false)\n              }\n            : function (element, type, add, custom) {\n                // IE8 and below, use attachEvent/detachEvent and we have to piggy-back propertychange events\n                // to simulate event bubbling etc.\n                var entry\n                if (add) {\n                  registry.put(entry = new RegEntry(\n                      element\n                    , custom || type\n                    , function (event) { // handler\n                        rootListener.call(element, event, custom)\n                      }\n                    , rootListener\n                    , null\n                    , null\n                    , true // is root\n                  ))\n                  if (custom && element['_on' + custom] == null) element['_on' + custom] = 0\n                  entry.target.attachEvent('on' + entry.eventType, entry.handler)\n                } else {\n                  entry = registry.get(element, custom || type, rootListener, true)[0]\n                  if (entry) {\n                    entry.target.detachEvent('on' + entry.eventType, entry.handler)\n                    registry.del(entry)\n                  }\n                }\n              }\n\n        , once = function (rm, element, type, fn, originalFn) {\n            // wrap the handler in a handler that does a remove as well\n            return function () {\n              fn.apply(this, arguments)\n              rm(element, type, originalFn)\n            }\n          }\n\n        , removeListener = function (element, orgType, handler, namespaces) {\n            var type     = orgType && orgType.replace(nameRegex, '')\n              , handlers = registry.get(element, type, null, false)\n              , removed  = {}\n              , i, l\n\n            for (i = 0, l = handlers.length; i < l; i++) {\n              if ((!handler || handlers[i].original === handler) && handlers[i].inNamespaces(namespaces)) {\n                // TODO: this is problematic, we have a registry.get() and registry.del() that\n                // both do registry searches so we waste cycles doing this. Needs to be rolled into\n                // a single registry.forAll(fn) that removes while finding, but the catch is that\n                // we'll be splicing the arrays that we're iterating over. Needs extra tests to\n                // make sure we don't screw it up. @rvagg\n                registry.del(handlers[i])\n                if (!removed[handlers[i].eventType] && handlers[i][eventSupport])\n                  removed[handlers[i].eventType] = { t: handlers[i].eventType, c: handlers[i].type }\n              }\n            }\n            // check each type/element for removed listeners and remove the rootListener where it's no longer needed\n            for (i in removed) {\n              if (removed.hasOwnProperty(i)) {\n                if (!registry.has(element, removed[i].t, null, false)) {\n                  // last listener of this type, remove the rootListener\n                  listener(element, removed[i].t, false, removed[i].c)\n                }\n              }\n            }\n          }\n\n          // set up a delegate helper using the given selector, wrap the handler function\n        , delegate = function (selector, fn) {\n            //TODO: findTarget (therefore $) is called twice, once for match and once for\n            // setting e.currentTarget, fix this so it's only needed once\n            var findTarget = function (target, root) {\n                  var i, array = isString(selector) ? selectorEngine(selector, root) : selector\n                  for (; target && target !== root; target = target.parentNode) {\n                    for (i = array.length; i--;) {\n                      if (array[i] === target) return target\n                    }\n                  }\n                }\n              , handler = function (e) {\n                  var match = findTarget(e.target, this)\n                  if (match) fn.apply(match, arguments)\n                }\n\n            // __beanDel isn't pleasant but it's a private function, not exposed outside of Bean\n            handler.__beanDel = {\n                ft       : findTarget // attach it here for customEvents to use too\n              , selector : selector\n            }\n            return handler\n          }\n\n        , fireListener = W3C_MODEL ? function (isNative, type, element) {\n            // modern browsers, do a proper dispatchEvent()\n            var evt = doc.createEvent(isNative ? 'HTMLEvents' : 'UIEvents')\n            evt[isNative ? 'initEvent' : 'initUIEvent'](type, true, true, win, 1)\n            element.dispatchEvent(evt)\n          } : function (isNative, type, element) {\n            // old browser use onpropertychange, just increment a custom property to trigger the event\n            element = targetElement(element, isNative)\n            isNative ? element.fireEvent('on' + type, doc.createEventObject()) : element['_on' + type]++\n          }\n\n          /**\n            * Public API: off(), on(), add(), (remove()), one(), fire(), clone()\n            */\n\n          /**\n            * off(element[, eventType(s)[, handler ]])\n            */\n        , off = function (element, typeSpec, fn) {\n            var isTypeStr = isString(typeSpec)\n              , k, type, namespaces, i\n\n            if (isTypeStr && typeSpec.indexOf(' ') > 0) {\n              // off(el, 't1 t2 t3', fn) or off(el, 't1 t2 t3')\n              typeSpec = str2arr(typeSpec)\n              for (i = typeSpec.length; i--;)\n                off(element, typeSpec[i], fn)\n              return element\n            }\n\n            type = isTypeStr && typeSpec.replace(nameRegex, '')\n            if (type && customEvents[type]) type = customEvents[type].base\n\n            if (!typeSpec || isTypeStr) {\n              // off(el) or off(el, t1.ns) or off(el, .ns) or off(el, .ns1.ns2.ns3)\n              if (namespaces = isTypeStr && typeSpec.replace(namespaceRegex, '')) namespaces = str2arr(namespaces, '.')\n              removeListener(element, type, fn, namespaces)\n            } else if (isFunction(typeSpec)) {\n              // off(el, fn)\n              removeListener(element, null, typeSpec)\n            } else {\n              // off(el, { t1: fn1, t2, fn2 })\n              for (k in typeSpec) {\n                if (typeSpec.hasOwnProperty(k)) off(element, k, typeSpec[k])\n              }\n            }\n\n            return element\n          }\n\n          /**\n            * on(element, eventType(s)[, selector], handler[, args ])\n            */\n        , on = function(element, events, selector, fn) {\n            var originalFn, type, types, i, args, entry, first\n\n            //TODO: the undefined check means you can't pass an 'args' argument, fix this perhaps?\n            if (selector === undefined && typeof events == 'object') {\n              //TODO: this can't handle delegated events\n              for (type in events) {\n                if (events.hasOwnProperty(type)) {\n                  on.call(this, element, type, events[type])\n                }\n              }\n              return\n            }\n\n            if (!isFunction(selector)) {\n              // delegated event\n              originalFn = fn\n              args       = slice.call(arguments, 4)\n              fn         = delegate(selector, originalFn, selectorEngine)\n            } else {\n              args       = slice.call(arguments, 3)\n              fn         = originalFn = selector\n            }\n\n            types = str2arr(events)\n\n            // special case for one(), wrap in a self-removing handler\n            if (this === ONE) {\n              fn = once(off, element, events, fn, originalFn)\n            }\n\n            for (i = types.length; i--;) {\n              // add new handler to the registry and check if it's the first for this element/type\n              first = registry.put(entry = new RegEntry(\n                  element\n                , types[i].replace(nameRegex, '') // event type\n                , fn\n                , originalFn\n                , str2arr(types[i].replace(namespaceRegex, ''), '.') // namespaces\n                , args\n                , false // not root\n              ))\n              if (entry[eventSupport] && first) {\n                // first event of this type on this element, add root listener\n                listener(element, entry.eventType, true, entry.customType)\n              }\n            }\n\n            return element\n          }\n\n          /**\n            * add(element[, selector], eventType(s), handler[, args ])\n            *\n            * Deprecated: kept (for now) for backward-compatibility\n            */\n        , add = function (element, events, fn, delfn) {\n            return on.apply(\n                null\n              , !isString(fn)\n                  ? slice.call(arguments)\n                  : [ element, fn, events, delfn ].concat(arguments.length > 3 ? slice.call(arguments, 5) : [])\n            )\n          }\n\n          /**\n            * one(element, eventType(s)[, selector], handler[, args ])\n            */\n        , one = function () {\n            return on.apply(ONE, arguments)\n          }\n\n          /**\n            * fire(element, eventType(s)[, args ])\n            *\n            * The optional 'args' argument must be an array, if no 'args' argument is provided\n            * then we can use the browser's DOM event system, otherwise we trigger handlers manually\n            */\n        , fire = function (element, type, args) {\n            var types = str2arr(type)\n              , i, j, l, names, handlers\n\n            for (i = types.length; i--;) {\n              type = types[i].replace(nameRegex, '')\n              if (names = types[i].replace(namespaceRegex, '')) names = str2arr(names, '.')\n              if (!names && !args && element[eventSupport]) {\n                fireListener(nativeEvents[type], type, element)\n              } else {\n                // non-native event, either because of a namespace, arguments or a non DOM element\n                // iterate over all listeners and manually 'fire'\n                handlers = registry.get(element, type, null, false)\n                args = [false].concat(args)\n                for (j = 0, l = handlers.length; j < l; j++) {\n                  if (handlers[j].inNamespaces(names)) {\n                    handlers[j].handler.apply(element, args)\n                  }\n                }\n              }\n            }\n            return element\n          }\n\n          /**\n            * clone(dstElement, srcElement[, eventType ])\n            *\n            * TODO: perhaps for consistency we should allow the same flexibility in type specifiers?\n            */\n        , clone = function (element, from, type) {\n            var handlers = registry.get(from, type, null, false)\n              , l = handlers.length\n              , i = 0\n              , args, beanDel\n\n            for (; i < l; i++) {\n              if (handlers[i].original) {\n                args = [ element, handlers[i].type ]\n                if (beanDel = handlers[i].handler.__beanDel) args.push(beanDel.selector)\n                args.push(handlers[i].original)\n                on.apply(null, args)\n              }\n            }\n            return element\n          }\n\n        , bean = {\n              'on'                : on\n            , 'add'               : add\n            , 'one'               : one\n            , 'off'               : off\n            , 'remove'            : off\n            , 'clone'             : clone\n            , 'fire'              : fire\n            , 'Event'             : Event\n            , 'setSelectorEngine' : setSelectorEngine\n            , 'noConflict'        : function () {\n                context[name] = old\n                return this\n              }\n          }\n\n      // for IE, clean up on unload to avoid leaks\n      if (win.attachEvent) {\n        var cleanup = function () {\n          var i, entries = registry.entries()\n          for (i in entries) {\n            if (entries[i].type && entries[i].type !== 'unload') off(entries[i].element, entries[i].type)\n          }\n          win.detachEvent('onunload', cleanup)\n          win.CollectGarbage && win.CollectGarbage()\n        }\n        win.attachEvent('onunload', cleanup)\n      }\n\n      // initialize selector engine to internal default (qSA or throw Error)\n      setSelectorEngine(Ink.ss)\n\n      return bean\n    });\n\n    /**\n     * Keep this declaration here and off Bean as it extends the Event\n     * object and some properties are readonly in strict mode\n     */\n    'use strict';\n\n    var InkEvent = {\n\n    KEY_BACKSPACE: 8,\n    KEY_TAB:       9,\n    KEY_RETURN:   13,\n    KEY_ESC:      27,\n    KEY_SPACE:    32,\n    KEY_LEFT:     37,\n    KEY_UP:       38,\n    KEY_RIGHT:    39,\n    KEY_DOWN:     40,\n    KEY_DELETE:   46,\n    KEY_HOME:     36,\n    KEY_END:      35,\n    KEY_PAGEUP:   33,\n    KEY_PAGEDOWN: 34,\n    KEY_INSERT:   45,\n    \n    /**\n     * Creates a throttled version of a function.\n     * Returns a function which calls `func`, waiting at least `wait` milliseconds between calls. This is useful for events such as `scroll` or `resize`, which can be triggered too many times per second, slowing down the browser with needless function calls.\n     *\n     * *note:* This does not delay the first function call to the function.\n     *\n     * @method throttle\n     * @param {Function} func   Function to call. Arguments and context are both passed.\n     * @param {Number} [wait]=0 Milliseconds to wait between calls.\n     * @return {Function} A function throttled which will only be called at most every `wait` milliseconds.\n     * @sample Ink_Dom_Event_1_throttle.html \n     **/\n    throttle: function (func, wait) {\n        wait = wait || 0;\n        var lastCall = 0;  // Warning: This breaks on Jan 1st 1970 0:00\n        var timeout;\n        function throttled() {\n            var now = +new Date();\n            var timeDiff = now - lastCall;\n            if (timeDiff >= wait) {\n                lastCall = now;\n                return func.apply(this, [].slice.call(arguments));\n            } else {\n                var that = this;\n                var args = [].slice.call(arguments);\n\n                if (timeout) {\n                    // Clear the old timeout because that one has old arguments\n                    clearTimeout(timeout);\n                }\n\n                timeout = setTimeout(function () {\n                    timeout = null;\n                    return throttled.apply(that, args);\n                }, wait - timeDiff);\n            }\n        }\n        return throttled;\n    },\n\n    /**\n     * Gets the event's target element.\n     *\n     * @method element\n     * @param {Object} ev  Event object\n     * @return {Element} The target\n     * @public\n     * @sample Ink_Dom_Event_1_element.html \n     */\n    element: function(ev) {\n        var node = ev.delegationTarget ||\n            ev.target ||\n            // IE stuff\n            (ev.type === 'mouseout'   && ev.fromElement) ||\n            (ev.type === 'mouseleave' && ev.fromElement) ||\n            (ev.type === 'mouseover'  && ev.toElement) ||\n            (ev.type === 'mouseenter' && ev.toElement) ||\n            ev.srcElement ||\n            null;\n        return node && (node.nodeType === 3 || node.nodeType === 4) ? node.parentNode : node;\n    },\n\n    /**\n     * Gets the event's related target element.\n     *\n     * @method relatedTarget\n     * @param {Object} ev event object\n     * @return {DOMNode} The related target\n     * @sample Ink_Dom_Event_1_relatedTarget.html \n     */\n    relatedTarget: function(ev){\n        var node = ev.relatedTarget ||\n            // IE stuff\n            (ev.type === 'mouseout'   && ev.toElement) ||\n            (ev.type === 'mouseleave' && ev.toElement) ||\n            (ev.type === 'mouseover'  && ev.fromElement) ||\n            (ev.type === 'mouseenter' && ev.fromElement) ||\n            null;\n        return node && (node.nodeType === 3 || node.nodeType === 4) ? node.parentNode : node;\n    },\n\n    /**\n     * Find closest ancestor element by tag name related to the event target.\n     * Navigate up the DOM tree, looking for a tag with the name `elmTagName`.\n     *\n     * If such tag is not found, `document` is returned.\n     *\n     * @method findElement\n     * @param {Object}  ev              Event object\n     * @param {String}  elmTagName      Tag name to find\n     * @param {Boolean} [force]=false   Flag to skip returning `document` and to return `false` instead.\n     * @return {DOMElement} the first element which matches given tag name or the document element if the wanted tag is not found\n     * @sample Ink_Dom_Event_1_findElement.html \n     */\n    findElement: function(ev, elmTagName, force)\n    {\n        var node = this.element(ev);\n        while(true) {\n            if(node.nodeName.toLowerCase() === elmTagName.toLowerCase()) {\n                return node;\n            } else {\n                node = node.parentNode;\n                if(!node) {\n                    if(force) {\n                        return false;\n                    }\n                    return document;\n                }\n                if(!node.parentNode){\n                    if(force){ return false; }\n                    return document;\n                }\n            }\n        }\n    },\n\n    /**\n     * Attaches an event to element\n     *\n     * @method observe\n     * @param {DOMElement|String}  element      Element id or element\n     * @param {String}             eventName    Event name\n     * @param {Function}           callBack     Receives the event object as a parameter. If you're manually firing custom events, check it's eventName property to make sure you're handling the right event.\n     * @param {Boolean}            [useCapture] Flag to change event listening from bubbling to capture.\n     * @return {Function} The event handler used. Hang on to this if you want to `stopObserving` later.\n     * @sample Ink_Dom_Event_1_observe.html \n     */\n    observe: function(element, eventName, callBack, useCapture) {\n        element = Ink.i(element);\n        if(element) {\n            if(element.addEventListener) {\n                element.addEventListener(eventName, callBack, !!useCapture);\n            } else {\n                element.attachEvent('on' + eventName, (callBack = Ink.bind(callBack, element)));\n            }\n            return callBack;\n        }\n    },\n\n    /**\n     * Like observe, but listen to the event only once.\n     *\n     * @method observeOnce\n     * @param {DOMElement|String}  element      Element id or element\n     * @param {String}             eventName    Event name\n     * @param {Function}           callBack     Receives the event object as a parameter. If you're manually firing custom events, check it's eventName property to make sure you're handling the right event.\n     * @param {Boolean}            [useCapture] Flag to change event listening from bubbling to capture.\n     * @return {Function} The event handler used. Hang on to this if you want to `stopObserving` later.\n     * @sample Ink_Dom_Event_1_observeOnce.html \n     */\n    observeOnce: function (element, eventName, callBack, useCapture) {\n        var onceBack = function () {\n            InkEvent.stopObserving(element, eventName, handler);\n            return callBack.apply(this, arguments);\n        };\n        var handler = InkEvent.observe(element, eventName, onceBack, useCapture);\n        return handler;\n    },\n\n    /**\n     * Attaches an event to a selector or array of elements.\n     *\n     * @method observeMulti\n     * @param {Array|String}        elements     Array of elements which are going to be observed. A selector is acceptable too.\n     * @param {String}              eventName    Event name\n     * @param {Function}            callBack     Receives the event object as a parameter. If you're manually firing custom events, check it's eventName property to make sure you're handling the right event.\n     * @param {Boolean}            [useCapture]  Flag change event listening from bubbling to capture.\n     * @return {Function} The used callback.\n     * @sample Ink_Dom_Event_1_observeMulti.html \n     */\n    observeMulti: function (elements, eventName, callBack, useCapture) {\n        if (typeof elements === 'string') {\n            elements = Ink.ss(elements);\n        } else if ( /* is an element */ elements && elements.nodeType === 1) {\n            elements = [elements];\n        }\n        if (!elements[0]) { return false; }\n\n        for (var i = 0, len = elements.length; i < len; i++) {\n            this.observe(elements[i], eventName, callBack, useCapture);\n        }\n        return callBack;\n    },\n\n    /**\n     * Observes an event on an element and its descendants matching the selector.\n     *\n     * Requires Ink.Dom.Selector if you need to use a selector.\n     *\n     * @method observeDelegated\n     * @param {Element|String} element   Element to observe.\n     * @param {String}         eventName Event name to observe.\n     * @param {String}         selector  Child element selector. When null, finds any element.\n     * @param {Function}       callback  Callback to be called when the event is fired\n     * @return {Function} The used callback, for ceasing to listen to the event later.\n     * @public\n     * @sample Ink_Dom_Event_1_observeDelegated.html \n     **/\n    observeDelegated: function (element, eventName, selector, callback) {\n        return InkEvent.observe(element, eventName, function (event) {\n            var fromElement = InkEvent.element(event);\n            if (!fromElement || fromElement === element) { return; }\n\n            var cursor = fromElement;\n\n            // Go up the document tree until we hit the element itself.\n            while (cursor !== element && cursor !== document && cursor) {\n                if (Ink.Dom.Selector_1.matchesSelector(cursor, selector)) {\n                    event.delegationTarget = cursor;\n                    return callback(event);\n                }\n                cursor = cursor.parentNode;\n            }\n        });\n    },\n\n    /**\n     * Removes an event attached to an element.\n     *\n     * @method stopObserving\n     * @param {DOMElement|String}  element       Element id or element\n     * @param {String}             eventName     Event name\n     * @param {Function}           callBack      Callback function\n     * @param {Boolean}            [useCapture]  Set to true if the event was being observed with useCapture set to true as well.\n     * @return {void}\n     * @public\n     * @sample Ink_Dom_Event_1_stopObserving.html \n     */\n    stopObserving: function(element, eventName, callBack, useCapture) {\n        element = Ink.i(element);\n\n        if(element) {\n            if(element.removeEventListener) {\n                element.removeEventListener(eventName, callBack, !!useCapture);\n            } else {\n                element.detachEvent('on' + eventName, callBack);\n            }\n        }\n    },\n\n    /**\n     * Stops event propagation and bubbling.\n     *\n     * @method stop\n     * @param {Object} event  Event handle\n     * @return {void}\n     * @public\n     * @sample Ink_Dom_Event_1_stop.html \n     */\n    stop: function(event)\n    {\n        if(event.cancelBubble !== null) {\n            event.cancelBubble = true;\n        }\n        if(event.stopPropagation) {\n            event.stopPropagation();\n        }\n        if(event.preventDefault) {\n            event.preventDefault();\n        }\n        if(window.attachEvent) {\n            event.returnValue = false;\n        }\n        if(event.cancel !== null) {\n            event.cancel = true;\n        }\n    },\n\n    /**\n     * Stops event propagation.\n     *\n     * @method stopPropagation\n     * @param {Object} event  Event handle\n     * @return {void}\n     * @public\n     * @sample Ink_Dom_Event_1_stopPropagation.html \n     */\n    stopPropagation: function(event) {\n        if(event.cancelBubble !== null) {\n            event.cancelBubble = true;\n        }\n        if(event.stopPropagation) {\n            event.stopPropagation();\n        }\n    },\n\n    /**\n     * Stops event default behaviour.\n     *\n     * @method stopDefault\n     * @param {Object} event  Event handle\n     * @return {void}\n     * @public\n     * @sample Ink_Dom_Event_1_stopDefault.html \n     */\n    stopDefault: function(event)\n    {\n        if(event.preventDefault) {\n            event.preventDefault();\n        }\n        if(window.attachEvent) {\n            event.returnValue = false;\n        }\n        if(event.cancel !== null) {\n            event.cancel = true;\n        }\n    },\n\n    /**\n     * Gets the pointer's coordinates from the event object.\n     *\n     * @method pointer\n     * @param {Object} ev Event object\n     * @return {Object} An object with the mouse X and Y position\n     * @public\n     * @sample Ink_Dom_Event_1_pointer.html \n     */\n    pointer: function(ev)\n    {\n        return {\n            x: this.pointerX(ev),\n            y: this.pointerY(ev)\n        };\n    },\n\n    /**\n     * Gets the pointer's X coordinate.\n     *\n     * @method pointerX\n     * @param {Object} ev Event object\n     * @return {Number} Mouse X position\n     * @public\n     */\n    pointerX: function(ev)\n    {\n        return (ev.touches && ev.touches[0] && ev.touches[0].clientX) ||\n            (ev.pageX) ||\n            (ev.clientX + (document.documentElement.scrollLeft || document.body.scrollLeft));\n    },\n\n    /**\n     * Gets the pointer's Y coordinate.\n     *\n     * @method pointerY\n     * @param {Object} ev Event object\n     * @return {Number} Mouse Y position\n     * @public\n     */\n    pointerY: function(ev)\n    {\n        return (ev.touches && ev.touches[0] && ev.touches[0].clientY) ||\n            (ev.pageY) ||\n            (ev.clientY + (document.documentElement.scrollTop || document.body.scrollTop));\n    },\n\n    /**\n     * Checks if an event is a left click.\n     *\n     * @method isLeftClick\n     * @param {Object} ev  Event object\n     * @return {Boolean} True if the event is a left click\n     * @public\n     * @sample Ink_Dom_Event_1_isLeftClick.html \n     */\n    isLeftClick: function(ev) {\n        if (window.addEventListener) {\n            if(ev.button === 0){\n                return true;\n            } else if(ev.type === 'touchend' && ev.button === null){\n                // [todo] do the above check for pointerEvents too\n                return true;\n            }\n        }\n        else {\n            if(ev.button === 1){ return true; }\n        }\n        return false;\n    },\n\n    /**\n     * Checks if an event is a right click.\n     *\n     * @method isRightClick\n     * @param {Object} ev  Event object\n     * @return {Boolean} True if the event is a right click\n     * @public\n     * @sample Ink_Dom_Event_1_isRightClick.html \n     */\n    isRightClick: function(ev) {\n        return (ev.button === 2);\n    },\n\n    /**\n     * Checks if an event is a middle click.\n     *\n     * @method isMiddleClick\n     * @param {Object} ev  Event object\n     * @return {Boolean} True if the event is a middle click\n     * @public\n     * @sample Ink_Dom_Event_1_isMiddleClick.html \n     */\n    isMiddleClick: function(ev) {\n        if (window.addEventListener) {\n            return (ev.button === 1);\n        }\n        else {\n            return (ev.button === 4);\n        }\n        return false;\n    },\n\n    /**\n     * Gets character from an event.\n     *\n     * @method getCharFromKeyboardEvent\n     * @param {Object}   event           Keyboard event\n     * @param {Boolean}  [changeCasing]  If true uppercases, if false lowercases, otherwise keeps casing\n     * @return {String} Character representation of pressed key combination\n     * @public\n     * @sample Ink_Dom_Event_1_getCharFromKeyboardEvent.html \n     */\n    getCharFromKeyboardEvent: function(event, changeCasing) {\n        var k = event.keyCode;\n        var c = String.fromCharCode(k);\n\n        var shiftOn = event.shiftKey;\n        if (k >= 65 && k <= 90) {   // A-Z\n            if (typeof changeCasing === 'boolean') {\n                shiftOn = changeCasing;\n            }\n            return (shiftOn) ? c : c.toLowerCase();\n        }\n        else if (k >= 96 && k <= 105) { // numpad digits\n            return String.fromCharCode( 48 + (k-96) );\n        }\n        switch (k) {\n            case 109:   case 189:   return '-';\n            case 107:   case 187:   return '+';\n        }\n        return c;\n    },\n\n    debug: function(){}\n};\n\n/**\n * Lets you attach event listeners to both elements and objects.\n * http://github.com/fat/bean#on\n *\n * @method on\n * @param {DOMElement|Object} element An HTML DOM element or any JavaScript Object\n * @param {String}            eventType An Event (or multiple events, space separated) to listen to\n * @param {String}            [selector] A CSS DOM Element selector string to bind the listener to child elements matching the selector\n * @param {Function}          [handler] The callback function\n * @param {Object}            [args...] Additional arguments to pass to the callback function when triggered\n * \n * @return {DOMElement|Object} Returns the original DOM Element or Javascript Object\n * @public\n * @sample Ink_Dom_Event_1_on.html \n */\n\n/**\n * Alias for `on` but will only be executed once.\n * bean.one() is an alias for bean.on() except that the handler will only be executed once and then removed for the event type(s).\n * http://github.com/fat/bean#one\n *\n * @method one\n * @param {DOMElement|Object} element An HTML DOM element or any JavaScript Object\n * @param {String}            eventType An Event (or multiple events, space separated) to listen to\n * @param {String}            [selector] A CSS DOM Element selector string to bind the listener to child elements matching the selector\n * @param {Function}          [handler] The callback function\n * @param                     [args...] Additional arguments to pass to the callback function when triggered\n * \n * @return {DOMElement|Object} Returns the original DOM Element or Javascript Object\n * @public\n * @sample Ink_Dom_Event_1_one.html \n */\n\n/**\n * Removes event handlers.\n * bean.off() is how you get rid of handlers once you no longer want them active. It's also a good idea to call off on elements before you remove them from your DOM; this gives Bean a chance to clean up some things and prevents memory leaks.\n * http://github.com/fat/bean#off\n *\n * @method off\n * @param {DOMElement|Object} element An HTML DOM element or any JavaScript Object\n * @param {String}            eventType An Event (or multiple events, space separated) to remove\n * @param {Function}          [handler] The specific callback function to remove\n * \n * @return {DOMElement|Object} Returns the original DOM Element or Javascript Object\n * @public\n * @sample Ink_Dom_Event_1_off.html \n */\n\n/**\n * Clones events from one object to another\n * bean.clone() is a method for cloning events from one DOM element or object to another.\n * http://github.com/fat/bean#clone\n *\n * @method clone\n * @param {DOMElement|Object} destElement An HTML DOM element or any JavaScript Object to copy events to\n * @param {String}            srcElement An HTML DOM element or any JavaScript Object to copy events from\n * @param {String}            [eventType] An Event (or multiple events, space separated) to clone\n * \n * @return {DOMElement|Object} Returns the original DOM Element or Javascript Object\n * @public\n * @sample Ink_Dom_Event_1_clone.html \n */\n\n/**\n * Triggers events.\n * http://github.com/fat/bean#fire\n *\n * @method fire\n * @param {DOMElement|Object} destElement An HTML DOM element or any JavaScript Object fire the event on\n * @param {String}            eventType An Event (or multiple events, space separated) to fire\n * @param                     [args...] Additional arguments to pass to the callback function when triggered\n *\n * @return {DOMElement|Object} Returns the original DOM Element or Javascript Object\n * @public\n * @sample Ink_Dom_Event_1_fire.html \n */\n\nreturn Ink.extendObj(InkEvent, bean);\n\n});\n","/**\n * @module Ink.Dom.FormSerialize_1\n * Two way serialization of form data and javascript objects.\n * Valid applications are ad hoc AJAX/syndicated submission of forms, restoring form values from server side state, etc.\n */\n\nInk.createModule('Ink.Dom.FormSerialize', 1, ['Ink.Util.Array_1', 'Ink.Dom.Element_1', 'Ink.Dom.Selector_1'], function (InkArray, InkElement, Selector) {\n    'use strict';\n\n    // Check whether something is not a string or a DOM element, but still has length.\n    function isArrayIsh(obj) {\n        return obj != null &&\n            (!InkElement.isDOMElement(obj)) &&\n            (InkArray.isArray(obj) || (typeof obj !== 'string' && typeof obj.length === 'number'));\n    }\n\n    function toArray(obj) {\n        if (isArrayIsh(obj)) { return obj; }\n        else { return [obj]; }\n    }\n\n    /**\n     * @namespace Ink.Dom.FormSerialize\n     * @static\n     **/\n    var FormSerialize = {\n\n        /**\n         * Serializes a form element into a JS object\n         * It turns field *names* (not IDs!) into keys and field values into values.\n         *\n         * note: Multi-select and checkboxes with multiple values will result in arrays\n         *\n         * @method serialize\n         * @param {DOMElement|String}   form    Form element to extract data\n         * @param {Object} [options] Options object, containing:\n         * @param {Boolean} [options.outputUnchecked=false] Whether to emit unchecked checkboxes and unselected radio buttons.\n         * @return {Object} Map of fieldName -> String|String[]|Boolean\n         * @sample Ink_Dom_FormSerialize_serialize.html \n         */\n        serialize: function(form, options) {\n            options = options || {};\n            var out = {};\n            var emptyArrayToken = {};  // A hack so that empty select[multiple] elements appear although empty.\n\n            var pairs = this.asPairs(form, { elements: true, emptyArray: emptyArrayToken, outputUnchecked: options.outputUnchecked });\n            if (pairs == null) { return pairs; }\n            InkArray.forEach(pairs, function (pair) {\n                var name = pair[0].replace(/\\[\\]$/, '');\n                var value = pair[1];\n                var el = pair[2];\n\n                if (value === emptyArrayToken) {\n                    out[name] = [];  // It's an empty select[multiple]\n                } else if (!(FormSerialize._resultsInArray(el) || /\\[\\]$/.test(pair[0]))) {\n                    out[name] = value;\n                } else {\n                    out[name] = out[name] || [];\n                    out[name].push(value);\n                }\n            });\n\n            return out;\n        },\n\n        /**\n         * Like `serialize`, but returns an array of [fieldName, value] pairs.\n         *\n         * @method asPairs\n         * @param {DOMElement|String} form  Form element\n         * @param {Object} [options] Options object, containing:\n         * @param {Boolean} [options.elements] Instead of returning an array of [fieldName, value] pairs, return an array of [fieldName, value, fieldElement] triples.\n         * @param {Boolean} [options.emptyArray] What to emit as the value of an empty select[multiple]. If you don't pass this option, nothing comes out.\n         * @param {Boolean} [options.outputUnchecked=false] Whether to emit unchecked checkboxes and unselected radio buttons.\n         * @return {Array} Array of [fieldName, value] pairs.\n         **/\n        asPairs: function (form, options) {\n            var out = [];\n            options = options || {};\n\n            function emit(name, val, el) {\n                if (options.elements) {\n                    out.push([name, val, el]);\n                } else {\n                    out.push([name, val]);\n                }\n            }\n\n            function serializeEl(el) {\n                var elNodeName = el.nodeName.toLowerCase();\n                var elType = (el.type + '').toLowerCase();\n\n                if (elNodeName === 'select' && el.multiple) {\n                    var didEmit = false;\n                    InkArray.forEach(Selector.select('option:checked', el), function (thisOption) {\n                        emit(el.name, thisOption.value, el);\n                        didEmit = true;\n                    });\n                    if (!didEmit && 'emptyArray' in options) {\n                        emit(el.name, options.emptyArray, el);\n                    }\n                } else if (elNodeName === 'input' && (elType === 'checkbox' || elType === 'radio') && options.outputUnchecked) {\n                    // It's an empty checkbox and we wouldn't emit it otherwise but the user asked for it using outputUnchecked\n                    emit(el.name, null, el);\n                } else {\n                    emit(el.name, el.value, el);\n                }\n            }\n\n            if ((form = Ink.i(form))) {\n                var inputs = InkArray.filter(form.elements, function (elm) {\n                    return FormSerialize._isSerialized(elm, options);\n                });\n                for (var i = 0, len = inputs.length; i < len; i++) {\n                    serializeEl(inputs[i]);\n                }\n                return out;\n            }\n\n            return null;\n        },\n\n        /**\n         * Sets form elements' values with values from an object\n         *\n         * Note: You can't set the values of an input with `type=\"file\"` (browser prohibits it)\n         *\n         * @method fillIn \n         * @param {Element|String} form Form element to be populated\n         * @param {Object|Array}   map2 Mapping of fields to values contained in fields. Can be a hash (keys as names, strings or arrays for values), or an array of [name, value] pairs.\n         * @return {void}\n         * @sample Ink_Dom_FormSerialize_fillIn.html \n         */\n        fillIn: function(form, map2) {\n            if (!(form = Ink.i(form))) { return null; }\n\n            var pairs;\n\n            if (typeof map2 === 'object' && !isArrayIsh(map2)) {\n                pairs = FormSerialize._objToPairs(map2);\n            } else if (isArrayIsh(map2)) {\n                pairs = map2;\n            } else {\n                return null;\n            }\n\n            return FormSerialize._fillInPairs(form, pairs);\n        },\n\n        _objToPairs: function (obj) {\n            var pairs = [];\n            var val;\n            for (var name in obj) if (obj.hasOwnProperty(name)) {\n                val = toArray(obj[name]);\n                for (var i = 0, len = val.length; i < len; i++) {\n                    pairs.push([name, val[i]]);\n                }\n                if (len === 0) {\n                    pairs.push([name, []]);\n                }\n            }\n            return pairs;\n        },\n\n        _fillInPairs: function (form, pairs) {\n            pairs = InkArray.groupBy(pairs, {\n                key: function (pair) { return pair[0].replace(/\\[\\]$/, ''); }\n            });\n\n            // For each chunk...\n            pairs = InkArray.map(pairs, function (pair) {\n                // Join the items in the chunk by concatenating the values together and leaving the names alone\n                var values = InkArray.reduce(pair, function (left, right) {\n                    return [null, left[1].concat([right[1]])];\n                }, [null, []])[1];\n                return [pair[0][0], values];\n            });\n\n            var name;\n            var inputs;\n            var values;\n            for (var i = 0, len = pairs.length; i < len; i++) {\n                name = pairs[i][0];\n\n                if (name in form) {\n                    inputs = form[name];\n                } else if ((name + '[]') in form) {\n                    inputs = form[name + '[]'];\n                    name = name + '[]';\n                } else {\n                    continue;\n                }\n\n                inputs = toArray(inputs);\n                values = pairs[i][1];\n\n                FormSerialize._fillInOne(name, inputs, values);\n            }\n        },\n\n        _fillInOne: function (name, inputs, values) {\n            var firstOne = inputs[0];\n            var firstNodeName = firstOne.nodeName.toLowerCase();\n            var firstType = firstOne.getAttribute('type');\n            firstType = firstType && firstType.toLowerCase();\n            var isSelectMulti = firstNodeName === 'select' && InkElement.hasAttribute(firstOne, 'multiple');\n\n            if (firstType === 'checkbox' || firstType === 'radio') {\n                FormSerialize._fillInBoolean(inputs, values, 'checked');\n            } else if (isSelectMulti) {\n                FormSerialize._fillInBoolean(inputs[0].options, values, 'selected');\n            } else {\n                if (inputs.length !== values.length) {\n                    Ink.warn('Form had ' + inputs.length + ' inputs named \"' + name + '\", but received ' + values.length + ' values.');\n                }\n\n                for (var i = 0, len = Math.min(inputs.length, values.length); i < len; i += 1) {\n                    inputs[i].value = values[i];\n                }\n            }\n        },\n\n        _fillInBoolean: function (inputs, values, checkAttr /* 'selected' or 'checked' */) {\n            InkArray.forEach(inputs, function (input) {\n                var isChecked = InkArray.inArray(input.value, values);\n                input[checkAttr] = isChecked;\n            });\n        },\n\n        /**\n         * Whether FormSerialize.serialize() should produce an array when looking at this element.\n         * @method _resultsInArray\n         * @private\n         * @param element\n         **/\n        _resultsInArray: function (element) {\n            var type = element.getAttribute('type');\n            var nodeName = element.nodeName.toLowerCase();\n\n            return type === 'checkbox' ||\n                (nodeName === 'select' && InkElement.hasAttribute(element, 'multiple'));\n        },\n\n        _isSerialized: function (element, options) {\n            options = options || {};\n            if (!InkElement.isDOMElement(element)) { return false; }\n            if (!InkElement.hasAttribute(element, 'name')) { return false; }\n\n            var nodeName = element.nodeName.toLowerCase();\n\n            if (!nodeName || nodeName === 'fieldset') { return false; }\n\n            if (element.type === 'checkbox' || element.type === 'radio') {\n                if (options.outputUnchecked) { return true; }\n                return !!element.checked;\n            }\n\n            return true;\n        }\n    };\n\n    return FormSerialize;\n});\n","/**\n * Execute code only when the DOM is loaded.\n * @module Ink.Dom.Loaded_1\n * @version 1\n */\n \nInk.createModule('Ink.Dom.Loaded', 1, [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Dom.Loaded_1\n     **/\n    var Loaded = {\n\n        /**\n         * Callbacks and their contexts. Array of 2-arrays.\n         *\n         * []\n         *\n         * @attribute _contexts Array\n         * @private\n         * \n         */\n        _contexts: [], // Callbacks' queue\n\n        /**\n         * Specify a function to execute when the DOM is fully loaded.\n         *\n         * @method run\n         * @param {Object}   [win]=window   Window object to attach/add the event\n         * @param {Function} fn             Callback function to be executed after the DOM is ready\n         * @return {void}\n         * @public\n         * @sample Ink_Dom_Loaded_run.html \n         */\n        run: function(win, fn) {\n            if (!fn) {\n                fn  = win;\n                win = window;\n            }\n\n            var context;\n\n            for (var i = 0, len = this._contexts.length; i < len; i++) {\n                if (this._contexts[i][0] === win) {\n                    context = this._contexts[i][1];\n                    break;\n                }\n            }\n            if (!context) {\n                context = {\n                    cbQueue: [],\n                    win: win,\n                    doc: win.document,\n                    root: win.document.documentElement,\n                    done: false,\n                    top: true\n                };\n                context.handlers = {\n                    checkState: Ink.bindEvent(this._checkState, this, context),\n                    poll: Ink.bind(this._poll, this, context)\n                };\n                this._contexts.push(\n                    [win, context]  // Javascript Objects cannot map different windows to\n                                    // different values.\n                );\n            }\n\n            var   ael = context.doc.addEventListener;\n            context.add = ael ? 'addEventListener' : 'attachEvent';\n            context.rem = ael ? 'removeEventListener' : 'detachEvent';\n            context.pre = ael ? '' : 'on';\n            context.det = ael ? 'DOMContentLoaded' : 'onreadystatechange';\n            context.wet = context.pre + 'load';\n\n            var csf = context.handlers.checkState;\n            var alreadyLoaded = (\n                /complete|loaded/.test(context.doc.readyState) &&\n                context.win.location.toString() !== 'about:blank');  // https://code.google.com/p/chromium/issues/detail?id=32357\n\n            if (alreadyLoaded){\n                setTimeout(Ink.bind(function () {\n                    fn.call(context.win, 'lazy');\n                }, this), 0);\n            } else {\n                context.cbQueue.push(fn);\n\n                context.doc[context.add]( context.det , csf );\n                context.win[context.add]( context.wet , csf );\n\n                var frameElement = 1;\n                try{\n                    frameElement = context.win.frameElement;\n                } catch(e) {}\n                if ( !ael && context.root && context.root.doScroll ) { // IE HACK\n                    try {\n                        context.top = !frameElement;\n                    } catch(e) { }\n                    if (context.top) {\n                        this._poll(context);\n                    }\n                }\n            }\n        },\n\n        /**\n         * Function that will be running the callbacks after the page is loaded\n         *\n         * @method _checkState\n         * @param {Event} event Triggered event\n         * @private\n         */\n        _checkState: function(event, context) {\n            if ( !event || (event.type === 'readystatechange' && !/complete|loaded/.test(context.doc.readyState))) {\n                return;\n            }\n            var where = (event.type === 'load') ? context.win : context.doc;\n            where[context.rem](context.pre+event.type, context.handlers.checkState, false);\n            this._ready(context);\n        },\n\n        /**\n         * Polls the load progress of the page to see if it has already loaded or not\n         *\n         * @method _poll\n         * @private\n         */\n\n        /**\n         * (old IE only) wait until a doScroll() call does not throw an error\n         *\n         * @method _poll\n         * @private\n         */\n        _poll: function(context) {\n            try {\n                context.root.doScroll('left');\n            } catch(e) {\n                return setTimeout(context.handlers.poll, 50);\n            }\n            this._ready(context);\n        },\n\n        /**\n         * Function that runs the callbacks from the queue when the document is ready.\n         *\n         * @method _ready\n         * @private\n         */\n        _ready: function(context) {\n            if (!context.done) {\n                context.done = true;\n                for (var i = 0; i < context.cbQueue.length; ++i) {\n                    context.cbQueue[i].call(context.win);\n                }\n                context.cbQueue = [];\n            }\n        }\n    };\n\n    return Loaded;\n\n});\n","/**\n * CSS selector engine\n * @module Ink.Dom.Selector_1\n * @version 1\n */\n \nInk.createModule('Ink.Dom.Selector', 1, [], function() {\n    /*jshint forin:false, eqnull:true, noempty:false, expr:true, boss:true, maxdepth:false*/\n\t'use strict';\n\n/*!\n * Sizzle CSS Selector Engine\n * Copyright 2013 jQuery Foundation and other contributors\n * Released under the MIT license\n * http://sizzlejs.com/\n */\n\nvar i,\n\tcachedruns,\n\tExpr,\n\tgetText,\n\tisXML,\n\tcompile,\n\toutermostContext,\n\trecompare,\n\tsortInput,\n\n\t// Local document vars\n\tsetDocument,\n\tdocument,\n\tdocElem,\n\tdocumentIsHTML,\n\trbuggyQSA,\n\trbuggyMatches,\n\tmatches,\n\tcontains,\n\n\t// Instance-specific data\n\texpando = \"sizzle\" + -(new Date()),\n\tpreferredDoc = window.document,\n\tsupport = {},\n\tdirruns = 0,\n\tdone = 0,\n\tclassCache = createCache(),\n\ttokenCache = createCache(),\n\tcompilerCache = createCache(),\n\thasDuplicate = false,\n\tsortOrder = function() { return 0; },\n\n\t// General-purpose constants\n\tstrundefined = typeof undefined,\n\tMAX_NEGATIVE = 1 << 31,\n\n\t// Array methods\n\tarr = [],\n\tpop = arr.pop,\n\tpush_native = arr.push,\n\tpush = arr.push,\n\tslice = arr.slice,\n\t// Use a stripped-down indexOf if we can't use a native one\n\tindexOf = arr.indexOf || function( elem ) {\n\t\tvar i = 0,\n\t\t\tlen = this.length;\n\t\tfor ( ; i < len; i++ ) {\n\t\t\tif ( this[i] === elem ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t},\n\n\n\t// Regular expressions\n\n\t// Whitespace characters http://www.w3.org/TR/css3-selectors/#whitespace\n\twhitespace = \"[\\\\x20\\\\t\\\\r\\\\n\\\\f]\",\n\t// http://www.w3.org/TR/css3-syntax/#characters\n\tcharacterEncoding = \"(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+\",\n\n\t// Loosely modeled on CSS identifier characters\n\t// An unquoted value should be a CSS identifier http://www.w3.org/TR/css3-selectors/#attribute-selectors\n\t// Proper syntax: http://www.w3.org/TR/CSS21/syndata.html#value-def-identifier\n\tidentifier = characterEncoding.replace( \"w\", \"w#\" ),\n\n\t// Acceptable operators http://www.w3.org/TR/selectors/#attribute-selectors\n\toperators = \"([*^$|!~]?=)\",\n\tattributes = \"\\\\[\" + whitespace + \"*(\" + characterEncoding + \")\" + whitespace +\n\t\t\"*(?:\" + operators + whitespace + \"*(?:(['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|(\" + identifier + \")|)|)\" + whitespace + \"*\\\\]\",\n\n\t// Prefer arguments quoted,\n\t//   then not containing pseudos/brackets,\n\t//   then attribute selectors/non-parenthetical expressions,\n\t//   then anything else\n\t// These preferences are here to reduce the number of selectors\n\t//   needing tokenize in the PSEUDO preFilter\n\tpseudos = \":(\" + characterEncoding + \")(?:\\\\(((['\\\"])((?:\\\\\\\\.|[^\\\\\\\\])*?)\\\\3|((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|\" + attributes.replace( 3, 8 ) + \")*)|.*)\\\\)|)\",\n\n\t// Leading and non-escaped trailing whitespace, capturing some non-whitespace characters preceding the latter\n\trtrim = new RegExp( \"^\" + whitespace + \"+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)\" + whitespace + \"+$\", \"g\" ),\n\n\trcomma = new RegExp( \"^\" + whitespace + \"*,\" + whitespace + \"*\" ),\n\trcombinators = new RegExp( \"^\" + whitespace + \"*([\\\\x20\\\\t\\\\r\\\\n\\\\f>+~])\" + whitespace + \"*\" ),\n\trpseudo = new RegExp( pseudos ),\n\tridentifier = new RegExp( \"^\" + identifier + \"$\" ),\n\n\tmatchExpr = {\n\t\t\"ID\": new RegExp( \"^#(\" + characterEncoding + \")\" ),\n\t\t\"CLASS\": new RegExp( \"^\\\\.(\" + characterEncoding + \")\" ),\n\t\t\"NAME\": new RegExp( \"^\\\\[name=['\\\"]?(\" + characterEncoding + \")['\\\"]?\\\\]\" ),\n\t\t\"TAG\": new RegExp( \"^(\" + characterEncoding.replace( \"w\", \"w*\" ) + \")\" ),\n\t\t\"ATTR\": new RegExp( \"^\" + attributes ),\n\t\t\"PSEUDO\": new RegExp( \"^\" + pseudos ),\n\t\t\"CHILD\": new RegExp( \"^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(\" + whitespace +\n\t\t\t\"*(even|odd|(([+-]|)(\\\\d*)n|)\" + whitespace + \"*(?:([+-]|)\" + whitespace +\n\t\t\t\"*(\\\\d+)|))\" + whitespace + \"*\\\\)|)\", \"i\" ),\n\t\t// For use in libraries implementing .is()\n\t\t// We use this for POS matching in `select`\n\t\t\"needsContext\": new RegExp( \"^\" + whitespace + \"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(\" +\n\t\t\twhitespace + \"*((?:-\\\\d)?\\\\d*)\" + whitespace + \"*\\\\)|)(?=[^-]|$)\", \"i\" )\n\t},\n\n\trsibling = /[\\x20\\t\\r\\n\\f]*[+~]/,\n\n\trnative = /^[^{]+\\{\\s*\\[native code/,\n\n\t// Easily-parseable/retrievable ID or TAG or CLASS selectors\n\trquickExpr = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n\n\trinputs = /^(?:input|select|textarea|button)$/i,\n\trheader = /^h\\d$/i,\n\n\trescape = /'|\\\\/g,\n\trattributeQuotes = /\\=[\\x20\\t\\r\\n\\f]*([^'\"\\]]*)[\\x20\\t\\r\\n\\f]*\\]/g,\n\n\t// CSS escapes http://www.w3.org/TR/CSS21/syndata.html#escaped-characters\n\trunescape = /\\\\([\\da-fA-F]{1,6}[\\x20\\t\\r\\n\\f]?|.)/g,\n\tfunescape = function( _, escaped ) {\n\t\tvar high = \"0x\" + escaped - 0x10000;\n\t\t// NaN means non-codepoint\n\t\treturn high !== high ?\n\t\t\tescaped :\n\t\t\t// BMP codepoint\n\t\t\thigh < 0 ?\n\t\t\t\tString.fromCharCode( high + 0x10000 ) :\n\t\t\t\t// Supplemental Plane codepoint (surrogate pair)\n\t\t\t\tString.fromCharCode( high >> 10 | 0xD800, high & 0x3FF | 0xDC00 );\n\t};\n\n// Optimize for push.apply( _, NodeList )\ntry {\n\tpush.apply(\n\t\t(arr = slice.call( preferredDoc.childNodes )),\n\t\tpreferredDoc.childNodes\n\t);\n\t// Support: Android<4.0\n\t// Detect silently failing push.apply\n\tarr[ preferredDoc.childNodes.length ].nodeType;\n} catch ( e ) {\n\tpush = { apply: arr.length ?\n\n\t\t// Leverage slice if possible\n\t\tfunction( target, els ) {\n\t\t\tpush_native.apply( target, slice.call(els) );\n\t\t} :\n\n\t\t// Support: IE<9\n\t\t// Otherwise append directly\n\t\tfunction( target, els ) {\n\t\t\tvar j = target.length,\n\t\t\t\ti = 0;\n\t\t\t// Can't trust NodeList.length\n\t\t\twhile ( (target[j++] = els[i++]) ) {}\n\t\t\ttarget.length = j - 1;\n\t\t}\n\t};\n}\n\n/*\n * For feature detection\n * @param {Function} fn The function to test for native support\n */\nfunction isNative( fn ) {\n\treturn rnative.test( fn + \"\" );\n}\n\n/*\n * Create key-value caches of limited size\n * @returns {Function(string, Object)} Returns the Object data after storing it on itself with\n *\tproperty name the (space-suffixed) string and (if the cache is larger than Expr.cacheLength)\n *\tdeleting the oldest entry\n */\nfunction createCache() {\n\tvar cache,\n\t\tkeys = [];\n\n\treturn (cache = function( key, value ) {\n\t\t// Use (key + \" \") to avoid collision with native prototype properties (see Issue #157)\n\t\tif ( keys.push( key += \" \" ) > Expr.cacheLength ) {\n\t\t\t// Only keep the most recent entries\n\t\t\tdelete cache[ keys.shift() ];\n\t\t}\n\t\treturn (cache[ key ] = value);\n\t});\n}\n\n/*\n * Mark a function for special use by Sizzle\n * @param {Function} fn The function to mark\n */\nfunction markFunction( fn ) {\n\tfn[ expando ] = true;\n\treturn fn;\n}\n\n/*\n * Support testing using an element\n * @param {Function} fn Passed the created div and expects a boolean result\n */\nfunction assert( fn ) {\n\tvar div = document.createElement(\"div\");\n\n\ttry {\n\t\treturn !!fn( div );\n\t} catch (e) {\n\t\treturn false;\n\t} finally {\n\t\t// release memory in IE\n\t\tdiv = null;\n\t}\n}\n\nfunction Sizzle( selector, context, results, seed ) {\n\tvar match, elem, m, nodeType,\n\t\t// QSA vars\n\t\ti, groups, old, nid, newContext, newSelector;\n\n\tif ( ( context ? context.ownerDocument || context : preferredDoc ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\n\tcontext = context || document;\n\tresults = results || [];\n\n\tif ( !selector || typeof selector !== \"string\" ) {\n\t\treturn results;\n\t}\n\n\tif ( (nodeType = context.nodeType) !== 1 && nodeType !== 9 ) {\n\t\treturn [];\n\t}\n\n\tif ( documentIsHTML && !seed ) {\n\n\t\t// Shortcuts\n\t\tif ( (match = rquickExpr.exec( selector )) ) {\n\t\t\t// Speed-up: Sizzle(\"#ID\")\n\t\t\tif ( (m = match[1]) ) {\n\t\t\t\tif ( nodeType === 9 ) {\n\t\t\t\t\telem = context.getElementById( m );\n\t\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\t\tif ( elem && elem.parentNode ) {\n\t\t\t\t\t\t// Handle the case where IE, Opera, and Webkit return items\n\t\t\t\t\t\t// by name instead of ID\n\t\t\t\t\t\tif ( elem.id === m ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Context is not a document\n\t\t\t\t\tif ( context.ownerDocument && (elem = context.ownerDocument.getElementById( m )) &&\n\t\t\t\t\t\tcontains( context, elem ) && elem.id === m ) {\n\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\treturn results;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t// Speed-up: Sizzle(\"TAG\")\n\t\t\t} else if ( match[2] ) {\n\t\t\t\tpush.apply( results, context.getElementsByTagName( selector ) );\n\t\t\t\treturn results;\n\n\t\t\t// Speed-up: Sizzle(\".CLASS\")\n\t\t\t} else if ( (m = match[3]) && support.getElementsByClassName && context.getElementsByClassName ) {\n\t\t\t\tpush.apply( results, context.getElementsByClassName( m ) );\n\t\t\t\treturn results;\n\t\t\t}\n\t\t}\n\n\t\t// QSA path\n\t\tif ( support.qsa && !rbuggyQSA.test(selector) ) {\n\t\t\told = true;\n\t\t\tnid = expando;\n\t\t\tnewContext = context;\n\t\t\tnewSelector = nodeType === 9 && selector;\n\n\t\t\t// qSA works strangely on Element-rooted queries\n\t\t\t// We can work around this by specifying an extra ID on the root\n\t\t\t// and working up from there (Thanks to Andrew Dupont for the technique)\n\t\t\t// IE 8 doesn't work on object elements\n\t\t\tif ( nodeType === 1 && context.nodeName.toLowerCase() !== \"object\" ) {\n\t\t\t\tgroups = tokenize( selector );\n\n\t\t\t\tif ( (old = context.getAttribute(\"id\")) ) {\n\t\t\t\t\tnid = old.replace( rescape, \"\\\\$&\" );\n\t\t\t\t} else {\n\t\t\t\t\tcontext.setAttribute( \"id\", nid );\n\t\t\t\t}\n\t\t\t\tnid = \"[id='\" + nid + \"'] \";\n\n\t\t\t\ti = groups.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tgroups[i] = nid + toSelector( groups[i] );\n\t\t\t\t}\n\t\t\t\tnewContext = rsibling.test( selector ) && context.parentNode || context;\n\t\t\t\tnewSelector = groups.join(\",\");\n\t\t\t}\n\n\t\t\tif ( newSelector ) {\n\t\t\t\ttry {\n\t\t\t\t\tpush.apply( results,\n\t\t\t\t\t\tnewContext.querySelectorAll( newSelector )\n\t\t\t\t\t);\n\t\t\t\t\treturn results;\n\t\t\t\t} catch(qsaError) {\n\t\t\t\t} finally {\n\t\t\t\t\tif ( !old ) {\n\t\t\t\t\t\tcontext.removeAttribute(\"id\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// All others\n\treturn select( selector.replace( rtrim, \"$1\" ), context, results, seed );\n}\n\n/*\n * Detect xml\n * @param {Element|Object} elem An element or a document\n */\nisXML = Sizzle.isXML = function( elem ) {\n\t// documentElement is verified for cases where it doesn't yet exist\n\t// (such as loading iframes in IE - #4833)\n\tvar documentElement = elem && (elem.ownerDocument || elem).documentElement;\n\treturn documentElement ? documentElement.nodeName !== \"HTML\" : false;\n};\n\n/*\n * Sets document-related variables once based on the current document\n * @param {Element|Object} [doc] An element or document object to use to set the document\n * @returns {Object} Returns the current document\n */\nsetDocument = Sizzle.setDocument = function( node ) {\n\tvar doc = node ? node.ownerDocument || node : preferredDoc;\n\n\t// If no document and documentElement is available, return\n\tif ( doc === document || doc.nodeType !== 9 || !doc.documentElement ) {\n\t\treturn document;\n\t}\n\n\t// Set our document\n\tdocument = doc;\n\tdocElem = doc.documentElement;\n\n\t// Support tests\n\tdocumentIsHTML = !isXML( doc );\n\n\t// Check if getElementsByTagName(\"*\") returns only elements\n\tsupport.getElementsByTagName = assert(function( div ) {\n\t\tdiv.appendChild( doc.createComment(\"\") );\n\t\treturn !div.getElementsByTagName(\"*\").length;\n\t});\n\n\t// Check if attributes should be retrieved by attribute nodes\n\tsupport.attributes = assert(function( div ) {\n\t\tdiv.innerHTML = \"<select></select>\";\n\t\tvar type = typeof div.lastChild.getAttribute(\"multiple\");\n\t\t// IE8 returns a string for some attributes even when not present\n\t\treturn type !== \"boolean\" && type !== \"string\";\n\t});\n\n\t// Check if getElementsByClassName can be trusted\n\tsupport.getElementsByClassName = assert(function( div ) {\n\t\t// Opera can't find a second classname (in 9.6)\n\t\tdiv.innerHTML = \"<div class='hidden e'></div><div class='hidden'></div>\";\n\t\tif ( !div.getElementsByClassName || !div.getElementsByClassName(\"e\").length ) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Safari 3.2 caches class attributes and doesn't catch changes\n\t\tdiv.lastChild.className = \"e\";\n\t\treturn div.getElementsByClassName(\"e\").length === 2;\n\t});\n\n\t// Check if getElementsByName privileges form controls or returns elements by ID\n\t// If so, assume (for broader support) that getElementById returns elements by name\n\tsupport.getByName = assert(function( div ) {\n\t\t// Inject content\n\t\tdiv.id = expando + 0;\n\t\t// Support: Windows 8 Native Apps\n\t\t// Assigning innerHTML with \"name\" attributes throws uncatchable exceptions\n\t\t// http://msdn.microsoft.com/en-us/library/ie/hh465388.aspx\n\t\tdiv.appendChild( document.createElement(\"a\") ).setAttribute( \"name\", expando );\n\t\tdiv.appendChild( document.createElement(\"i\") ).setAttribute( \"name\", expando );\n\t\tdocElem.appendChild( div );\n\n\t\t// Test\n\t\tvar pass = doc.getElementsByName &&\n\t\t\t// buggy browsers will return fewer than the correct 2\n\t\t\tdoc.getElementsByName( expando ).length === 2 +\n\t\t\t// buggy browsers will return more than the correct 0\n\t\t\tdoc.getElementsByName( expando + 0 ).length;\n\n\t\t// Cleanup\n\t\tdocElem.removeChild( div );\n\n\t\treturn pass;\n\t});\n\n\t// Support: Webkit<537.32\n\t// Detached nodes confoundingly follow *each other*\n\tsupport.sortDetached = assert(function( div1 ) {\n\t\treturn div1.compareDocumentPosition &&\n\t\t\t// Should return 1, but Webkit returns 4 (following)\n\t\t\t(div1.compareDocumentPosition( document.createElement(\"div\") ) & 1);\n\t});\n\n\t// IE6/7 return modified attributes\n\tExpr.attrHandle = assert(function( div ) {\n\t\tdiv.innerHTML = \"<a href='#'></a>\";\n\t\treturn div.firstChild && typeof div.firstChild.getAttribute !== strundefined &&\n\t\t\tdiv.firstChild.getAttribute(\"href\") === \"#\";\n\t}) ?\n\t\t{} :\n\t\t{\n\t\t\t\"href\": function( elem ) {\n\t\t\t\treturn elem.getAttribute( \"href\", 2 );\n\t\t\t},\n\t\t\t\"type\": function( elem ) {\n\t\t\t\treturn elem.getAttribute(\"type\");\n\t\t\t}\n\t\t};\n\n\t// ID find and filter\n\tif ( support.getByName ) {\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== strundefined && documentIsHTML ) {\n\t\t\t\tvar m = context.getElementById( id );\n\t\t\t\t// Check parentNode to catch when Blackberry 4.6 returns\n\t\t\t\t// nodes that are no longer in the document #6963\n\t\t\t\treturn m && m.parentNode ? [m] : [];\n\t\t\t}\n\t\t};\n\t\tExpr.filter[\"ID\"] = function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.getAttribute(\"id\") === attrId;\n\t\t\t};\n\t\t};\n\t} else {\n\t\tExpr.find[\"ID\"] = function( id, context ) {\n\t\t\tif ( typeof context.getElementById !== strundefined && documentIsHTML ) {\n\t\t\t\tvar m = context.getElementById( id );\n\n\t\t\t\treturn m ?\n\t\t\t\t\tm.id === id || typeof m.getAttributeNode !== strundefined && m.getAttributeNode(\"id\").value === id ?\n\t\t\t\t\t\t[m] :\n\t\t\t\t\t\tundefined :\n\t\t\t\t\t[];\n\t\t\t}\n\t\t};\n\t\tExpr.filter[\"ID\"] =  function( id ) {\n\t\t\tvar attrId = id.replace( runescape, funescape );\n\t\t\treturn function( elem ) {\n\t\t\t\tvar node = typeof elem.getAttributeNode !== strundefined && elem.getAttributeNode(\"id\");\n\t\t\t\treturn node && node.value === attrId;\n\t\t\t};\n\t\t};\n\t}\n\n\t// Tag\n\tExpr.find[\"TAG\"] = support.getElementsByTagName ?\n\t\tfunction( tag, context ) {\n\t\t\tif ( typeof context.getElementsByTagName !== strundefined ) {\n\t\t\t\treturn context.getElementsByTagName( tag );\n\t\t\t}\n\t\t} :\n\t\tfunction( tag, context ) {\n\t\t\tvar elem,\n\t\t\t\ttmp = [],\n\t\t\t\ti = 0,\n\t\t\t\tresults = context.getElementsByTagName( tag );\n\n\t\t\t// Filter out possible comments\n\t\t\tif ( tag === \"*\" ) {\n\t\t\t\twhile ( (elem = results[i++]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 ) {\n\t\t\t\t\t\ttmp.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\treturn tmp;\n\t\t\t}\n\t\t\treturn results;\n\t\t};\n\n\t// Name\n\tExpr.find[\"NAME\"] = support.getByName && function( tag, context ) {\n\t\tif ( typeof context.getElementsByName !== strundefined ) {\n\t\t\treturn context.getElementsByName( name );\n\t\t}\n\t};\n\n\t// Class\n\tExpr.find[\"CLASS\"] = support.getElementsByClassName && function( className, context ) {\n\t\tif ( typeof context.getElementsByClassName !== strundefined && documentIsHTML ) {\n\t\t\treturn context.getElementsByClassName( className );\n\t\t}\n\t};\n\n\t// QSA and matchesSelector support\n\n\t// matchesSelector(:active) reports false when true (IE9/Opera 11.5)\n\trbuggyMatches = [];\n\n\t// qSa(:focus) reports false when true (Chrome 21),\n\t// no need to also add to buggyMatches since matches checks buggyQSA\n\t// A support test would require too much code (would include document ready)\n\trbuggyQSA = [ \":focus\" ];\n\n\tif ( (support.qsa = isNative(doc.querySelectorAll)) ) {\n\t\t// Build QSA regex\n\t\t// Regex strategy adopted from Diego Perini\n\t\tassert(function( div ) {\n\t\t\t// Select is set to empty string on purpose\n\t\t\t// This is to test IE's treatment of not explicitly\n\t\t\t// setting a boolean content attribute,\n\t\t\t// since its presence should be enough\n\t\t\t// http://bugs.jquery.com/ticket/12359\n\t\t\tdiv.innerHTML = \"<select><option selected=''></option></select>\";\n\n\t\t\t// IE8 - Some boolean attributes are not treated correctly\n\t\t\tif ( !div.querySelectorAll(\"[selected]\").length ) {\n\t\t\t\trbuggyQSA.push( \"\\\\[\" + whitespace + \"*(?:checked|disabled|ismap|multiple|readonly|selected|value)\" );\n\t\t\t}\n\n\t\t\t// Webkit/Opera - :checked should return selected option elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":checked\").length ) {\n\t\t\t\trbuggyQSA.push(\":checked\");\n\t\t\t}\n\t\t});\n\n\t\tassert(function( div ) {\n\n\t\t\t// Opera 10-12/IE8 - ^= $= *= and empty values\n\t\t\t// Should not select anything\n\t\t\tdiv.innerHTML = \"<input type='hidden' i=''/>\";\n\t\t\tif ( div.querySelectorAll(\"[i^='']\").length ) {\n\t\t\t\trbuggyQSA.push( \"[*^$]=\" + whitespace + \"*(?:\\\"\\\"|'')\" );\n\t\t\t}\n\n\t\t\t// FF 3.5 - :enabled/:disabled and hidden elements (hidden elements are still enabled)\n\t\t\t// IE8 throws error here and will not see later tests\n\t\t\tif ( !div.querySelectorAll(\":enabled\").length ) {\n\t\t\t\trbuggyQSA.push( \":enabled\", \":disabled\" );\n\t\t\t}\n\n\t\t\t// Opera 10-11 does not throw on post-comma invalid pseudos\n\t\t\tdiv.querySelectorAll(\"*,:x\");\n\t\t\trbuggyQSA.push(\",.*:\");\n\t\t});\n\t}\n\n\tif ( (support.matchesSelector = isNative( (matches = docElem.matchesSelector ||\n\t\tdocElem.mozMatchesSelector ||\n\t\tdocElem.webkitMatchesSelector ||\n\t\tdocElem.oMatchesSelector ||\n\t\tdocElem.msMatchesSelector) )) ) {\n\n\t\tassert(function( div ) {\n\t\t\t// Check to see if it's possible to do matchesSelector\n\t\t\t// on a disconnected node (IE 9)\n\t\t\tsupport.disconnectedMatch = matches.call( div, \"div\" );\n\n\t\t\t// This should fail with an exception\n\t\t\t// Gecko does not error, returns false instead\n\t\t\tmatches.call( div, \"[s!='']:x\" );\n\t\t\trbuggyMatches.push( \"!=\", pseudos );\n\t\t});\n\t}\n\n\trbuggyQSA = new RegExp( rbuggyQSA.join(\"|\") );\n\trbuggyMatches = rbuggyMatches.length && new RegExp( rbuggyMatches.join(\"|\") );\n\n\t// Element contains another\n\t// Purposefully does not implement inclusive descendent\n\t// As in, an element does not contain itself\n\tcontains = isNative(docElem.contains) || docElem.compareDocumentPosition ?\n\t\tfunction( a, b ) {\n\t\t\tvar adown = a.nodeType === 9 ? a.documentElement : a,\n\t\t\t\tbup = b && b.parentNode;\n\t\t\treturn a === bup || !!( bup && bup.nodeType === 1 && (\n\t\t\t\tadown.contains ?\n\t\t\t\t\tadown.contains( bup ) :\n\t\t\t\t\ta.compareDocumentPosition && a.compareDocumentPosition( bup ) & 16\n\t\t\t));\n\t\t} :\n\t\tfunction( a, b ) {\n\t\t\tif ( b ) {\n\t\t\t\twhile ( (b = b.parentNode) ) {\n\t\t\t\t\tif ( b === a ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\n\t// Document order sorting\n\tsortOrder = docElem.compareDocumentPosition ?\n\tfunction( a, b ) {\n\n\t\t// Flag for duplicate removal\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\t\t}\n\n\t\tvar compare = b.compareDocumentPosition && a.compareDocumentPosition && a.compareDocumentPosition( b );\n\n\t\tif ( compare ) {\n\t\t\t// Disconnected nodes\n\t\t\tif ( compare & 1 ||\n\t\t\t\t(recompare && b.compareDocumentPosition( a ) === compare) ) {\n\n\t\t\t\t// Choose the first element that is related to our preferred document\n\t\t\t\tif ( a === doc || contains(preferredDoc, a) ) {\n\t\t\t\t\treturn -1;\n\t\t\t\t}\n\t\t\t\tif ( b === doc || contains(preferredDoc, b) ) {\n\t\t\t\t\treturn 1;\n\t\t\t\t}\n\n\t\t\t\t// Maintain original order\n\t\t\t\treturn sortInput ?\n\t\t\t\t\t( indexOf.call( sortInput, a ) - indexOf.call( sortInput, b ) ) :\n\t\t\t\t\t0;\n\t\t\t}\n\n\t\t\treturn compare & 4 ? -1 : 1;\n\t\t}\n\n\t\t// Not directly comparable, sort on existence of method\n\t\treturn a.compareDocumentPosition ? -1 : 1;\n\t} :\n\tfunction( a, b ) {\n\t\tvar cur,\n\t\t\ti = 0,\n\t\t\taup = a.parentNode,\n\t\t\tbup = b.parentNode,\n\t\t\tap = [ a ],\n\t\t\tbp = [ b ];\n\n\t\t// Exit early if the nodes are identical\n\t\tif ( a === b ) {\n\t\t\thasDuplicate = true;\n\t\t\treturn 0;\n\n\t\t// Parentless nodes are either documents or disconnected\n\t\t} else if ( !aup || !bup ) {\n\t\t\treturn a === doc ? -1 :\n\t\t\t\tb === doc ? 1 :\n\t\t\t\taup ? -1 :\n\t\t\t\tbup ? 1 :\n\t\t\t\t0;\n\n\t\t// If the nodes are siblings, we can do a quick check\n\t\t} else if ( aup === bup ) {\n\t\t\treturn siblingCheck( a, b );\n\t\t}\n\n\t\t// Otherwise we need full lists of their ancestors for comparison\n\t\tcur = a;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tap.unshift( cur );\n\t\t}\n\t\tcur = b;\n\t\twhile ( (cur = cur.parentNode) ) {\n\t\t\tbp.unshift( cur );\n\t\t}\n\n\t\t// Walk down the tree looking for a discrepancy\n\t\twhile ( ap[i] === bp[i] ) {\n\t\t\ti++;\n\t\t}\n\n\t\treturn i ?\n\t\t\t// Do a sibling check if the nodes have a common ancestor\n\t\t\tsiblingCheck( ap[i], bp[i] ) :\n\n\t\t\t// Otherwise nodes in our document sort first\n\t\t\tap[i] === preferredDoc ? -1 :\n\t\t\tbp[i] === preferredDoc ? 1 :\n\t\t\t0;\n\t};\n\n\treturn document;\n};\n\nSizzle.matches = function( expr, elements ) {\n\treturn Sizzle( expr, null, null, elements );\n};\n\nSizzle.matchesSelector = function( elem, expr ) {\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\t// Make sure that attribute selectors are quoted\n\texpr = expr.replace( rattributeQuotes, \"='$1']\" );\n\n\t// rbuggyQSA always contains :focus, so no need for an existence check\n\tif ( support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && !rbuggyQSA.test(expr) ) {\n\t\ttry {\n\t\t\tvar ret = matches.call( elem, expr );\n\n\t\t\t// IE 9's matchesSelector returns false on disconnected nodes\n\t\t\tif ( ret || support.disconnectedMatch ||\n\t\t\t\t\t// As well, disconnected nodes are said to be in a document\n\t\t\t\t\t// fragment in IE 9\n\t\t\t\t\telem.document && elem.document.nodeType !== 11 ) {\n\t\t\t\treturn ret;\n\t\t\t}\n\t\t} catch(e) {}\n\t}\n\n\treturn Sizzle( expr, document, null, [elem] ).length > 0;\n};\n\nSizzle.contains = function( context, elem ) {\n\t// Set document vars if needed\n\tif ( ( context.ownerDocument || context ) !== document ) {\n\t\tsetDocument( context );\n\t}\n\treturn contains( context, elem );\n};\n\nSizzle.attr = function( elem, name ) {\n\tvar val;\n\n\t// Set document vars if needed\n\tif ( ( elem.ownerDocument || elem ) !== document ) {\n\t\tsetDocument( elem );\n\t}\n\n\tif ( documentIsHTML ) {\n\t\tname = name.toLowerCase();\n\t}\n\tif ( (val = Expr.attrHandle[ name ]) ) {\n\t\treturn val( elem );\n\t}\n\tif ( !documentIsHTML || support.attributes ) {\n\t\treturn elem.getAttribute( name );\n\t}\n\treturn ( (val = elem.getAttributeNode( name )) || elem.getAttribute( name ) ) && elem[ name ] === true ?\n\t\tname :\n\t\tval && val.specified ? val.value : null;\n};\n\nSizzle.error = function( msg ) {\n\tthrow new Error( \"Syntax error, unrecognized expression: \" + msg );\n};\n\n// Document sorting and removing duplicates\nSizzle.uniqueSort = function( results ) {\n\tvar elem,\n\t\tduplicates = [],\n\t\tj = 0,\n\t\ti = 0;\n\n\t// Unless we *know* we can detect duplicates, assume their presence\n\thasDuplicate = !support.detectDuplicates;\n\t// Compensate for sort limitations\n\trecompare = !support.sortDetached;\n\tsortInput = !support.sortStable && results.slice( 0 );\n\tresults.sort( sortOrder );\n\n\tif ( hasDuplicate ) {\n\t\twhile ( (elem = results[i++]) ) {\n\t\t\tif ( elem === results[ i ] ) {\n\t\t\t\tj = duplicates.push( i );\n\t\t\t}\n\t\t}\n\t\twhile ( j-- ) {\n\t\t\tresults.splice( duplicates[ j ], 1 );\n\t\t}\n\t}\n\n\treturn results;\n};\n\n/*\n * Checks document order of two siblings\n * @param {Element} a\n * @param {Element} b\n * @returns Returns -1 if a precedes b, 1 if a follows b\n */\nfunction siblingCheck( a, b ) {\n\tvar cur = b && a,\n\t\tdiff = cur && ( ~b.sourceIndex || MAX_NEGATIVE ) - ( ~a.sourceIndex || MAX_NEGATIVE );\n\n\t// Use IE sourceIndex if available on both nodes\n\tif ( diff ) {\n\t\treturn diff;\n\t}\n\n\t// Check if b follows a\n\tif ( cur ) {\n\t\twhile ( (cur = cur.nextSibling) ) {\n\t\t\tif ( cur === b ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\t}\n\n\treturn a ? 1 : -1;\n}\n\n// Returns a function to use in pseudos for input types\nfunction createInputPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn name === \"input\" && elem.type === type;\n\t};\n}\n\n// Returns a function to use in pseudos for buttons\nfunction createButtonPseudo( type ) {\n\treturn function( elem ) {\n\t\tvar name = elem.nodeName.toLowerCase();\n\t\treturn (name === \"input\" || name === \"button\") && elem.type === type;\n\t};\n}\n\n// Returns a function to use in pseudos for positionals\nfunction createPositionalPseudo( fn ) {\n\treturn markFunction(function( argument ) {\n\t\targument = +argument;\n\t\treturn markFunction(function( seed, matches ) {\n\t\t\tvar j,\n\t\t\t\tmatchIndexes = fn( [], seed.length, argument ),\n\t\t\t\ti = matchIndexes.length;\n\n\t\t\t// Match elements found at the specified indexes\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( seed[ (j = matchIndexes[i]) ] ) {\n\t\t\t\t\tseed[j] = !(matches[j] = seed[j]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n\n/*\n * Utility function for retrieving the text value of an array of DOM nodes\n * @param {Array|Element} elem\n */\ngetText = Sizzle.getText = function( elem ) {\n\tvar node,\n\t\tret = \"\",\n\t\ti = 0,\n\t\tnodeType = elem.nodeType;\n\n\tif ( !nodeType ) {\n\t\t// If no nodeType, this is expected to be an array\n\t\tfor ( ; (node = elem[i]); i++ ) {\n\t\t\t// Do not traverse comment nodes\n\t\t\tret += getText( node );\n\t\t}\n\t} else if ( nodeType === 1 || nodeType === 9 || nodeType === 11 ) {\n\t\t// Use textContent for elements\n\t\t// innerText usage removed for consistency of new lines (see #11153)\n\t\tif ( typeof elem.textContent === \"string\" ) {\n\t\t\treturn elem.textContent;\n\t\t} else {\n\t\t\t// Traverse its children\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tret += getText( elem );\n\t\t\t}\n\t\t}\n\t} else if ( nodeType === 3 || nodeType === 4 ) {\n\t\treturn elem.nodeValue;\n\t}\n\t// Do not include comment or processing instruction nodes\n\n\treturn ret;\n};\n\nExpr = Sizzle.selectors = {\n\n\t// Can be adjusted by the user\n\tcacheLength: 50,\n\n\tcreatePseudo: markFunction,\n\n\tmatch: matchExpr,\n\n\tfind: {},\n\n\trelative: {\n\t\t\">\": { dir: \"parentNode\", first: true },\n\t\t\" \": { dir: \"parentNode\" },\n\t\t\"+\": { dir: \"previousSibling\", first: true },\n\t\t\"~\": { dir: \"previousSibling\" }\n\t},\n\n\tpreFilter: {\n\t\t\"ATTR\": function( match ) {\n\t\t\tmatch[1] = match[1].replace( runescape, funescape );\n\n\t\t\t// Move the given value to match[3] whether quoted or unquoted\n\t\t\tmatch[3] = ( match[4] || match[5] || \"\" ).replace( runescape, funescape );\n\n\t\t\tif ( match[2] === \"~=\" ) {\n\t\t\t\tmatch[3] = \" \" + match[3] + \" \";\n\t\t\t}\n\n\t\t\treturn match.slice( 0, 4 );\n\t\t},\n\n\t\t\"CHILD\": function( match ) {\n\t\t\t/* matches from matchExpr[\"CHILD\"]\n\t\t\t\t1 type (only|nth|...)\n\t\t\t\t2 what (child|of-type)\n\t\t\t\t3 argument (even|odd|\\d*|\\d*n([+-]\\d+)?|...)\n\t\t\t\t4 xn-component of xn+y argument ([+-]?\\d*n|)\n\t\t\t\t5 sign of xn-component\n\t\t\t\t6 x of xn-component\n\t\t\t\t7 sign of y-component\n\t\t\t\t8 y of y-component\n\t\t\t*/\n\t\t\tmatch[1] = match[1].toLowerCase();\n\n\t\t\tif ( match[1].slice( 0, 3 ) === \"nth\" ) {\n\t\t\t\t// nth-* requires argument\n\t\t\t\tif ( !match[3] ) {\n\t\t\t\t\tSizzle.error( match[0] );\n\t\t\t\t}\n\n\t\t\t\t// numeric x and y parameters for Expr.filter.CHILD\n\t\t\t\t// remember that false/true cast respectively to 0/1\n\t\t\t\tmatch[4] = +( match[4] ? match[5] + (match[6] || 1) : 2 * ( match[3] === \"even\" || match[3] === \"odd\" ) );\n\t\t\t\tmatch[5] = +( ( match[7] + match[8] ) || match[3] === \"odd\" );\n\n\t\t\t// other types prohibit arguments\n\t\t\t} else if ( match[3] ) {\n\t\t\t\tSizzle.error( match[0] );\n\t\t\t}\n\n\t\t\treturn match;\n\t\t},\n\n\t\t\"PSEUDO\": function( match ) {\n\t\t\tvar excess,\n\t\t\t\tunquoted = !match[5] && match[2];\n\n\t\t\tif ( matchExpr[\"CHILD\"].test( match[0] ) ) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\t// Accept quoted arguments as-is\n\t\t\tif ( match[4] ) {\n\t\t\t\tmatch[2] = match[4];\n\n\t\t\t// Strip excess characters from unquoted arguments\n\t\t\t} else if ( unquoted && rpseudo.test( unquoted ) &&\n\t\t\t\t// Get excess from tokenize (recursively)\n\t\t\t\t(excess = tokenize( unquoted, true )) &&\n\t\t\t\t// advance to the next closing parenthesis\n\t\t\t\t(excess = unquoted.indexOf( \")\", unquoted.length - excess ) - unquoted.length) ) {\n\n\t\t\t\t// excess is a negative index\n\t\t\t\tmatch[0] = match[0].slice( 0, excess );\n\t\t\t\tmatch[2] = unquoted.slice( 0, excess );\n\t\t\t}\n\n\t\t\t// Return only captures needed by the pseudo filter method (type and argument)\n\t\t\treturn match.slice( 0, 3 );\n\t\t}\n\t},\n\n\tfilter: {\n\n\t\t\"TAG\": function( nodeName ) {\n\t\t\tif ( nodeName === \"*\" ) {\n\t\t\t\treturn function() { return true; };\n\t\t\t}\n\n\t\t\tnodeName = nodeName.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\treturn elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n\t\t\t};\n\t\t},\n\n\t\t\"CLASS\": function( className ) {\n\t\t\tvar pattern = classCache[ className + \" \" ];\n\n\t\t\treturn pattern ||\n\t\t\t\t(pattern = new RegExp( \"(^|\" + whitespace + \")\" + className + \"(\" + whitespace + \"|$)\" )) &&\n\t\t\t\tclassCache( className, function( elem ) {\n\t\t\t\t\treturn pattern.test( elem.className || (typeof elem.getAttribute !== strundefined && elem.getAttribute(\"class\")) || \"\" );\n\t\t\t\t});\n\t\t},\n\n\t\t\"ATTR\": function( name, operator, check ) {\n\t\t\treturn function( elem ) {\n\t\t\t\tvar result = Sizzle.attr( elem, name );\n\n\t\t\t\tif ( result == null ) {\n\t\t\t\t\treturn operator === \"!=\";\n\t\t\t\t}\n\t\t\t\tif ( !operator ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\n\t\t\t\tresult += \"\";\n\n\t\t\t\treturn operator === \"=\" ? result === check :\n\t\t\t\t\toperator === \"!=\" ? result !== check :\n\t\t\t\t\toperator === \"^=\" ? check && result.indexOf( check ) === 0 :\n\t\t\t\t\toperator === \"*=\" ? check && result.indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"$=\" ? check && result.slice( -check.length ) === check :\n\t\t\t\t\toperator === \"~=\" ? ( \" \" + result + \" \" ).indexOf( check ) > -1 :\n\t\t\t\t\toperator === \"|=\" ? result === check || result.slice( 0, check.length + 1 ) === check + \"-\" :\n\t\t\t\t\tfalse;\n\t\t\t};\n\t\t},\n\n\t\t\"CHILD\": function( type, what, argument, first, last ) {\n\t\t\tvar simple = type.slice( 0, 3 ) !== \"nth\",\n\t\t\t\tforward = type.slice( -4 ) !== \"last\",\n\t\t\t\tofType = what === \"of-type\";\n\n\t\t\treturn first === 1 && last === 0 ?\n\n\t\t\t\t// Shortcut for :nth-*(n)\n\t\t\t\tfunction( elem ) {\n\t\t\t\t\treturn !!elem.parentNode;\n\t\t\t\t} :\n\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tvar cache, outerCache, node, diff, nodeIndex, start,\n\t\t\t\t\t\tdir = simple !== forward ? \"nextSibling\" : \"previousSibling\",\n\t\t\t\t\t\tparent = elem.parentNode,\n\t\t\t\t\t\tname = ofType && elem.nodeName.toLowerCase(),\n\t\t\t\t\t\tuseCache = !xml && !ofType;\n\n\t\t\t\t\tif ( parent ) {\n\n\t\t\t\t\t\t// :(first|last|only)-(child|of-type)\n\t\t\t\t\t\tif ( simple ) {\n\t\t\t\t\t\t\twhile ( dir ) {\n\t\t\t\t\t\t\t\tnode = elem;\n\t\t\t\t\t\t\t\twhile ( (node = node[ dir ]) ) {\n\t\t\t\t\t\t\t\t\tif ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Reverse direction for :only-* (if we haven't yet done so)\n\t\t\t\t\t\t\t\tstart = dir = type === \"only\" && !start && \"nextSibling\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tstart = [ forward ? parent.firstChild : parent.lastChild ];\n\n\t\t\t\t\t\t// non-xml :nth-child(...) stores cache data on `parent`\n\t\t\t\t\t\tif ( forward && useCache ) {\n\t\t\t\t\t\t\t// Seek `elem` from a previously-cached index\n\t\t\t\t\t\t\touterCache = parent[ expando ] || (parent[ expando ] = {});\n\t\t\t\t\t\t\tcache = outerCache[ type ] || [];\n\t\t\t\t\t\t\tnodeIndex = cache[0] === dirruns && cache[1];\n\t\t\t\t\t\t\tdiff = cache[0] === dirruns && cache[2];\n\t\t\t\t\t\t\tnode = nodeIndex && parent.childNodes[ nodeIndex ];\n\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\n\t\t\t\t\t\t\t\t// Fallback to seeking `elem` from the start\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\t// When found, cache indexes on `parent` and break\n\t\t\t\t\t\t\t\tif ( node.nodeType === 1 && ++diff && node === elem ) {\n\t\t\t\t\t\t\t\t\touterCache[ type ] = [ dirruns, nodeIndex, diff ];\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Use previously-cached element index if available\n\t\t\t\t\t\t} else if ( useCache && (cache = (elem[ expando ] || (elem[ expando ] = {}))[ type ]) && cache[0] === dirruns ) {\n\t\t\t\t\t\t\tdiff = cache[1];\n\n\t\t\t\t\t\t// xml :nth-child(...) or :nth-last-child(...) or :nth(-last)?-of-type(...)\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Use the same loop as above to seek `elem` from the start\n\t\t\t\t\t\t\twhile ( (node = ++nodeIndex && node && node[ dir ] ||\n\t\t\t\t\t\t\t\t(diff = nodeIndex = 0) || start.pop()) ) {\n\n\t\t\t\t\t\t\t\tif ( ( ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1 ) && ++diff ) {\n\t\t\t\t\t\t\t\t\t// Cache the index of each encountered element\n\t\t\t\t\t\t\t\t\tif ( useCache ) {\n\t\t\t\t\t\t\t\t\t\t(node[ expando ] || (node[ expando ] = {}))[ type ] = [ dirruns, diff ];\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif ( node === elem ) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Incorporate the offset, then check against cycle size\n\t\t\t\t\t\tdiff -= last;\n\t\t\t\t\t\treturn diff === first || ( diff % first === 0 && diff / first >= 0 );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t},\n\n\t\t\"PSEUDO\": function( pseudo, argument ) {\n\t\t\t// pseudo-class names are case-insensitive\n\t\t\t// http://www.w3.org/TR/selectors/#pseudo-classes\n\t\t\t// Prioritize by case sensitivity in case custom pseudos are added with uppercase letters\n\t\t\t// Remember that setFilters inherits from pseudos\n\t\t\tvar args,\n\t\t\t\tfn = Expr.pseudos[ pseudo ] || Expr.setFilters[ pseudo.toLowerCase() ] ||\n\t\t\t\t\tSizzle.error( \"unsupported pseudo: \" + pseudo );\n\n\t\t\t// The user may use createPseudo to indicate that\n\t\t\t// arguments are needed to create the filter function\n\t\t\t// just as Sizzle does\n\t\t\tif ( fn[ expando ] ) {\n\t\t\t\treturn fn( argument );\n\t\t\t}\n\n\t\t\t// But maintain support for old signatures\n\t\t\tif ( fn.length > 1 ) {\n\t\t\t\targs = [ pseudo, pseudo, \"\", argument ];\n\t\t\t\treturn Expr.setFilters.hasOwnProperty( pseudo.toLowerCase() ) ?\n\t\t\t\t\tmarkFunction(function( seed, matches ) {\n\t\t\t\t\t\tvar idx,\n\t\t\t\t\t\t\tmatched = fn( seed, argument ),\n\t\t\t\t\t\t\ti = matched.length;\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tidx = indexOf.call( seed, matched[i] );\n\t\t\t\t\t\t\tseed[ idx ] = !( matches[ idx ] = matched[i] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}) :\n\t\t\t\t\tfunction( elem ) {\n\t\t\t\t\t\treturn fn( elem, 0, args );\n\t\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn fn;\n\t\t}\n\t},\n\n\tpseudos: {\n\t\t// Potentially complex pseudos\n\t\t\"not\": markFunction(function( selector ) {\n\t\t\t// Trim the selector passed to compile\n\t\t\t// to avoid treating leading and trailing\n\t\t\t// spaces as combinators\n\t\t\tvar input = [],\n\t\t\t\tresults = [],\n\t\t\t\tmatcher = compile( selector.replace( rtrim, \"$1\" ) );\n\n\t\t\treturn matcher[ expando ] ?\n\t\t\t\tmarkFunction(function( seed, matches, context, xml ) {\n\t\t\t\t\tvar elem,\n\t\t\t\t\t\tunmatched = matcher( seed, null, xml, [] ),\n\t\t\t\t\t\ti = seed.length;\n\n\t\t\t\t\t// Match elements unmatched by `matcher`\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = unmatched[i]) ) {\n\t\t\t\t\t\t\tseed[i] = !(matches[i] = elem);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}) :\n\t\t\t\tfunction( elem, context, xml ) {\n\t\t\t\t\tinput[0] = elem;\n\t\t\t\t\tmatcher( input, null, xml, results );\n\t\t\t\t\treturn !results.pop();\n\t\t\t\t};\n\t\t}),\n\n\t\t\"has\": markFunction(function( selector ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn Sizzle( selector, elem ).length > 0;\n\t\t\t};\n\t\t}),\n\n\t\t\"contains\": markFunction(function( text ) {\n\t\t\treturn function( elem ) {\n\t\t\t\treturn ( elem.textContent || elem.innerText || getText( elem ) ).indexOf( text ) > -1;\n\t\t\t};\n\t\t}),\n\n\t\t// \"Whether an element is represented by a :lang() selector\n\t\t// is based solely on the element's language value\n\t\t// being equal to the identifier C,\n\t\t// or beginning with the identifier C immediately followed by \"-\".\n\t\t// The matching of C against the element's language value is performed case-insensitively.\n\t\t// The identifier C does not have to be a valid language name.\"\n\t\t// http://www.w3.org/TR/selectors/#lang-pseudo\n\t\t\"lang\": markFunction( function( lang ) {\n\t\t\t// lang value must be a valid identifier\n\t\t\tif ( !ridentifier.test(lang || \"\") ) {\n\t\t\t\tSizzle.error( \"unsupported lang: \" + lang );\n\t\t\t}\n\t\t\tlang = lang.replace( runescape, funescape ).toLowerCase();\n\t\t\treturn function( elem ) {\n\t\t\t\tvar elemLang;\n\t\t\t\tdo {\n\t\t\t\t\tif ( (elemLang = documentIsHTML ?\n\t\t\t\t\t\telem.lang :\n\t\t\t\t\t\telem.getAttribute(\"xml:lang\") || elem.getAttribute(\"lang\")) ) {\n\n\t\t\t\t\t\telemLang = elemLang.toLowerCase();\n\t\t\t\t\t\treturn elemLang === lang || elemLang.indexOf( lang + \"-\" ) === 0;\n\t\t\t\t\t}\n\t\t\t\t} while ( (elem = elem.parentNode) && elem.nodeType === 1 );\n\t\t\t\treturn false;\n\t\t\t};\n\t\t}),\n\n\t\t// Miscellaneous\n\t\t\"target\": function( elem ) {\n\t\t\tvar hash = window.location && window.location.hash;\n\t\t\treturn hash && hash.slice( 1 ) === elem.id;\n\t\t},\n\n\t\t\"root\": function( elem ) {\n\t\t\treturn elem === docElem;\n\t\t},\n\n\t\t\"focus\": function( elem ) {\n\t\t\treturn elem === document.activeElement && (!document.hasFocus || document.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n\t\t},\n\n\t\t// Boolean properties\n\t\t\"enabled\": function( elem ) {\n\t\t\treturn elem.disabled === false;\n\t\t},\n\n\t\t\"disabled\": function( elem ) {\n\t\t\treturn elem.disabled === true;\n\t\t},\n\n\t\t\"checked\": function( elem ) {\n\t\t\t// In CSS3, :checked should return both checked and selected elements\n\t\t\t// http://www.w3.org/TR/2011/REC-css3-selectors-20110929/#checked\n\t\t\tvar nodeName = elem.nodeName.toLowerCase();\n\t\t\treturn (nodeName === \"input\" && !!elem.checked) || (nodeName === \"option\" && !!elem.selected);\n\t\t},\n\n\t\t\"selected\": function( elem ) {\n\t\t\t// Accessing this property makes selected-by-default\n\t\t\t// options in Safari work properly\n\t\t\tif ( elem.parentNode ) {\n\t\t\t\telem.parentNode.selectedIndex;\n\t\t\t}\n\n\t\t\treturn elem.selected === true;\n\t\t},\n\n\t\t// Contents\n\t\t\"empty\": function( elem ) {\n\t\t\t// http://www.w3.org/TR/selectors/#empty-pseudo\n\t\t\t// :empty is only affected by element nodes and content nodes(including text(3), cdata(4)),\n\t\t\t//   not comment, processing instructions, or others\n\t\t\t// Thanks to Diego Perini for the nodeName shortcut\n\t\t\t//   Greater than \"@\" means alpha characters (specifically not starting with \"#\" or \"?\")\n\t\t\tfor ( elem = elem.firstChild; elem; elem = elem.nextSibling ) {\n\t\t\t\tif ( elem.nodeName > \"@\" || elem.nodeType === 3 || elem.nodeType === 4 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\n\t\t\"parent\": function( elem ) {\n\t\t\treturn !Expr.pseudos[\"empty\"]( elem );\n\t\t},\n\n\t\t// Element/input types\n\t\t\"header\": function( elem ) {\n\t\t\treturn rheader.test( elem.nodeName );\n\t\t},\n\n\t\t\"input\": function( elem ) {\n\t\t\treturn rinputs.test( elem.nodeName );\n\t\t},\n\n\t\t\"button\": function( elem ) {\n\t\t\tvar name = elem.nodeName.toLowerCase();\n\t\t\treturn name === \"input\" && elem.type === \"button\" || name === \"button\";\n\t\t},\n\n\t\t\"text\": function( elem ) {\n\t\t\tvar attr;\n\t\t\t// IE6 and 7 will map elem.type to 'text' for new HTML5 types (search, etc)\n\t\t\t// use getAttribute instead to test this case\n\t\t\treturn elem.nodeName.toLowerCase() === \"input\" &&\n\t\t\t\telem.type === \"text\" &&\n\t\t\t\t( (attr = elem.getAttribute(\"type\")) == null || attr.toLowerCase() === elem.type );\n\t\t},\n\n\t\t// Position-in-collection\n\t\t\"first\": createPositionalPseudo(function() {\n\t\t\treturn [ 0 ];\n\t\t}),\n\n\t\t\"last\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\treturn [ length - 1 ];\n\t\t}),\n\n\t\t\"eq\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\treturn [ argument < 0 ? argument + length : argument ];\n\t\t}),\n\n\t\t\"even\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 0;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"odd\": createPositionalPseudo(function( matchIndexes, length ) {\n\t\t\tvar i = 1;\n\t\t\tfor ( ; i < length; i += 2 ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"lt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; --i >= 0; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t}),\n\n\t\t\"gt\": createPositionalPseudo(function( matchIndexes, length, argument ) {\n\t\t\tvar i = argument < 0 ? argument + length : argument;\n\t\t\tfor ( ; ++i < length; ) {\n\t\t\t\tmatchIndexes.push( i );\n\t\t\t}\n\t\t\treturn matchIndexes;\n\t\t})\n\t}\n};\n\n// Add button/input type pseudos\nfor ( i in { radio: true, checkbox: true, file: true, password: true, image: true } ) {\n\tExpr.pseudos[ i ] = createInputPseudo( i );\n}\nfor ( i in { submit: true, reset: true } ) {\n\tExpr.pseudos[ i ] = createButtonPseudo( i );\n}\n\nfunction tokenize( selector, parseOnly ) {\n\tvar matched, match, tokens, type,\n\t\tsoFar, groups, preFilters,\n\t\tcached = tokenCache[ selector + \" \" ];\n\n\tif ( cached ) {\n\t\treturn parseOnly ? 0 : cached.slice( 0 );\n\t}\n\n\tsoFar = selector;\n\tgroups = [];\n\tpreFilters = Expr.preFilter;\n\n\twhile ( soFar ) {\n\n\t\t// Comma and first run\n\t\tif ( !matched || (match = rcomma.exec( soFar )) ) {\n\t\t\tif ( match ) {\n\t\t\t\t// Don't consume trailing commas as valid\n\t\t\t\tsoFar = soFar.slice( match[0].length ) || soFar;\n\t\t\t}\n\t\t\tgroups.push( tokens = [] );\n\t\t}\n\n\t\tmatched = false;\n\n\t\t// Combinators\n\t\tif ( (match = rcombinators.exec( soFar )) ) {\n\t\t\tmatched = match.shift();\n\t\t\ttokens.push( {\n\t\t\t\tvalue: matched,\n\t\t\t\t// Cast descendant combinators to space\n\t\t\t\ttype: match[0].replace( rtrim, \" \" )\n\t\t\t} );\n\t\t\tsoFar = soFar.slice( matched.length );\n\t\t}\n\n\t\t// Filters\n\t\tfor ( type in Expr.filter ) {\n\t\t\tif ( (match = matchExpr[ type ].exec( soFar )) && (!preFilters[ type ] ||\n\t\t\t\t(match = preFilters[ type ]( match ))) ) {\n\t\t\t\tmatched = match.shift();\n\t\t\t\ttokens.push( {\n\t\t\t\t\tvalue: matched,\n\t\t\t\t\ttype: type,\n\t\t\t\t\tmatches: match\n\t\t\t\t} );\n\t\t\t\tsoFar = soFar.slice( matched.length );\n\t\t\t}\n\t\t}\n\n\t\tif ( !matched ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// Return the length of the invalid excess\n\t// if we're just parsing\n\t// Otherwise, throw an error or return tokens\n\treturn parseOnly ?\n\t\tsoFar.length :\n\t\tsoFar ?\n\t\t\tSizzle.error( selector ) :\n\t\t\t// Cache the tokens\n\t\t\ttokenCache( selector, groups ).slice( 0 );\n}\n\nfunction toSelector( tokens ) {\n\tvar i = 0,\n\t\tlen = tokens.length,\n\t\tselector = \"\";\n\tfor ( ; i < len; i++ ) {\n\t\tselector += tokens[i].value;\n\t}\n\treturn selector;\n}\n\nfunction addCombinator( matcher, combinator, base ) {\n\tvar dir = combinator.dir,\n\t\tcheckNonElements = base && dir === \"parentNode\",\n\t\tdoneName = done++;\n\n\treturn combinator.first ?\n\t\t// Check against closest ancestor/preceding element\n\t\tfunction( elem, context, xml ) {\n\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\treturn matcher( elem, context, xml );\n\t\t\t\t}\n\t\t\t}\n\t\t} :\n\n\t\t// Check against all ancestor/preceding elements\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar data, cache, outerCache,\n\t\t\t\tdirkey = dirruns + \" \" + doneName;\n\n\t\t\t// We can't set arbitrary data on XML nodes, so they don't benefit from dir caching\n\t\t\tif ( xml ) {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\twhile ( (elem = elem[ dir ]) ) {\n\t\t\t\t\tif ( elem.nodeType === 1 || checkNonElements ) {\n\t\t\t\t\t\touterCache = elem[ expando ] || (elem[ expando ] = {});\n\t\t\t\t\t\tif ( (cache = outerCache[ dir ]) && cache[0] === dirkey ) {\n\t\t\t\t\t\t\tif ( (data = cache[1]) === true || data === cachedruns ) {\n\t\t\t\t\t\t\t\treturn data === true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tcache = outerCache[ dir ] = [ dirkey ];\n\t\t\t\t\t\t\tcache[1] = matcher( elem, context, xml ) || cachedruns;\n\t\t\t\t\t\t\tif ( cache[1] === true ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t};\n}\n\nfunction elementMatcher( matchers ) {\n\treturn matchers.length > 1 ?\n\t\tfunction( elem, context, xml ) {\n\t\t\tvar i = matchers.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( !matchers[i]( elem, context, xml ) ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn true;\n\t\t} :\n\t\tmatchers[0];\n}\n\nfunction condense( unmatched, map, filter, context, xml ) {\n\tvar elem,\n\t\tnewUnmatched = [],\n\t\ti = 0,\n\t\tlen = unmatched.length,\n\t\tmapped = map != null;\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (elem = unmatched[i]) ) {\n\t\t\tif ( !filter || filter( elem, context, xml ) ) {\n\t\t\t\tnewUnmatched.push( elem );\n\t\t\t\tif ( mapped ) {\n\t\t\t\t\tmap.push( i );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treturn newUnmatched;\n}\n\nfunction setMatcher( preFilter, selector, matcher, postFilter, postFinder, postSelector ) {\n\tif ( postFilter && !postFilter[ expando ] ) {\n\t\tpostFilter = setMatcher( postFilter );\n\t}\n\tif ( postFinder && !postFinder[ expando ] ) {\n\t\tpostFinder = setMatcher( postFinder, postSelector );\n\t}\n\treturn markFunction(function( seed, results, context, xml ) {\n\t\tvar temp, i, elem,\n\t\t\tpreMap = [],\n\t\t\tpostMap = [],\n\t\t\tpreexisting = results.length,\n\n\t\t\t// Get initial elements from seed or context\n\t\t\telems = seed || multipleContexts( selector || \"*\", context.nodeType ? [ context ] : context, [] ),\n\n\t\t\t// Prefilter to get matcher input, preserving a map for seed-results synchronization\n\t\t\tmatcherIn = preFilter && ( seed || !selector ) ?\n\t\t\t\tcondense( elems, preMap, preFilter, context, xml ) :\n\t\t\t\telems,\n\n\t\t\tmatcherOut = matcher ?\n\t\t\t\t// If we have a postFinder, or filtered seed, or non-seed postFilter or preexisting results,\n\t\t\t\tpostFinder || ( seed ? preFilter : preexisting || postFilter ) ?\n\n\t\t\t\t\t// ...intermediate processing is necessary\n\t\t\t\t\t[] :\n\n\t\t\t\t\t// ...otherwise use results directly\n\t\t\t\t\tresults :\n\t\t\t\tmatcherIn;\n\n\t\t// Find primary matches\n\t\tif ( matcher ) {\n\t\t\tmatcher( matcherIn, matcherOut, context, xml );\n\t\t}\n\n\t\t// Apply postFilter\n\t\tif ( postFilter ) {\n\t\t\ttemp = condense( matcherOut, postMap );\n\t\t\tpostFilter( temp, [], context, xml );\n\n\t\t\t// Un-match failing elements by moving them back to matcherIn\n\t\t\ti = temp.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\tif ( (elem = temp[i]) ) {\n\t\t\t\t\tmatcherOut[ postMap[i] ] = !(matcherIn[ postMap[i] ] = elem);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif ( seed ) {\n\t\t\tif ( postFinder || preFilter ) {\n\t\t\t\tif ( postFinder ) {\n\t\t\t\t\t// Get the final matcherOut by condensing this intermediate into postFinder contexts\n\t\t\t\t\ttemp = [];\n\t\t\t\t\ti = matcherOut.length;\n\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\tif ( (elem = matcherOut[i]) ) {\n\t\t\t\t\t\t\t// Restore matcherIn since elem is not yet a final match\n\t\t\t\t\t\t\ttemp.push( (matcherIn[i] = elem) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tpostFinder( null, (matcherOut = []), temp, xml );\n\t\t\t\t}\n\n\t\t\t\t// Move matched elements from seed to results to keep them synchronized\n\t\t\t\ti = matcherOut.length;\n\t\t\t\twhile ( i-- ) {\n\t\t\t\t\tif ( (elem = matcherOut[i]) &&\n\t\t\t\t\t\t(temp = postFinder ? indexOf.call( seed, elem ) : preMap[i]) > -1 ) {\n\n\t\t\t\t\t\tseed[temp] = !(results[temp] = elem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t// Add elements to results, through postFinder if defined\n\t\t} else {\n\t\t\tmatcherOut = condense(\n\t\t\t\tmatcherOut === results ?\n\t\t\t\t\tmatcherOut.splice( preexisting, matcherOut.length ) :\n\t\t\t\t\tmatcherOut\n\t\t\t);\n\t\t\tif ( postFinder ) {\n\t\t\t\tpostFinder( null, results, matcherOut, xml );\n\t\t\t} else {\n\t\t\t\tpush.apply( results, matcherOut );\n\t\t\t}\n\t\t}\n\t});\n}\n\nfunction matcherFromTokens( tokens ) {\n\tvar checkContext, matcher, j,\n\t\tlen = tokens.length,\n\t\tleadingRelative = Expr.relative[ tokens[0].type ],\n\t\timplicitRelative = leadingRelative || Expr.relative[\" \"],\n\t\ti = leadingRelative ? 1 : 0,\n\n\t\t// The foundational matcher ensures that elements are reachable from top-level context(s)\n\t\tmatchContext = addCombinator( function( elem ) {\n\t\t\treturn elem === checkContext;\n\t\t}, implicitRelative, true ),\n\t\tmatchAnyContext = addCombinator( function( elem ) {\n\t\t\treturn indexOf.call( checkContext, elem ) > -1;\n\t\t}, implicitRelative, true ),\n\t\tmatchers = [ function( elem, context, xml ) {\n\t\t\treturn ( !leadingRelative && ( xml || context !== outermostContext ) ) || (\n\t\t\t\t(checkContext = context).nodeType ?\n\t\t\t\t\tmatchContext( elem, context, xml ) :\n\t\t\t\t\tmatchAnyContext( elem, context, xml ) );\n\t\t} ];\n\n\tfor ( ; i < len; i++ ) {\n\t\tif ( (matcher = Expr.relative[ tokens[i].type ]) ) {\n\t\t\tmatchers = [ addCombinator(elementMatcher( matchers ), matcher) ];\n\t\t} else {\n\t\t\tmatcher = Expr.filter[ tokens[i].type ].apply( null, tokens[i].matches );\n\n\t\t\t// Return special upon seeing a positional matcher\n\t\t\tif ( matcher[ expando ] ) {\n\t\t\t\t// Find the next relative operator (if any) for proper handling\n\t\t\t\tj = ++i;\n\t\t\t\tfor ( ; j < len; j++ ) {\n\t\t\t\t\tif ( Expr.relative[ tokens[j].type ] ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn setMatcher(\n\t\t\t\t\ti > 1 && elementMatcher( matchers ),\n\t\t\t\t\ti > 1 && toSelector( tokens.slice( 0, i - 1 ) ).replace( rtrim, \"$1\" ),\n\t\t\t\t\tmatcher,\n\t\t\t\t\ti < j && matcherFromTokens( tokens.slice( i, j ) ),\n\t\t\t\t\tj < len && matcherFromTokens( (tokens = tokens.slice( j )) ),\n\t\t\t\t\tj < len && toSelector( tokens )\n\t\t\t\t);\n\t\t\t}\n\t\t\tmatchers.push( matcher );\n\t\t}\n\t}\n\n\treturn elementMatcher( matchers );\n}\n\nfunction matcherFromGroupMatchers( elementMatchers, setMatchers ) {\n\t// A counter to specify which element is currently being matched\n\tvar matcherCachedRuns = 0,\n\t\tbySet = setMatchers.length > 0,\n\t\tbyElement = elementMatchers.length > 0,\n\t\tsuperMatcher = function( seed, context, xml, results, expandContext ) {\n\t\t\tvar elem, j, matcher,\n\t\t\t\tsetMatched = [],\n\t\t\t\tmatchedCount = 0,\n\t\t\t\ti = \"0\",\n\t\t\t\tunmatched = seed && [],\n\t\t\t\toutermost = expandContext != null,\n\t\t\t\tcontextBackup = outermostContext,\n\t\t\t\t// We must always have either seed elements or context\n\t\t\t\telems = seed || byElement && Expr.find[\"TAG\"]( \"*\", expandContext && context.parentNode || context ),\n\t\t\t\t// Use integer dirruns iff this is the outermost matcher\n\t\t\t\tdirrunsUnique = (dirruns += contextBackup == null ? 1 : Math.random() || 0.1);\n\n\t\t\tif ( outermost ) {\n\t\t\t\toutermostContext = context !== document && context;\n\t\t\t\tcachedruns = matcherCachedRuns;\n\t\t\t}\n\n\t\t\t// Add elements passing elementMatchers directly to results\n\t\t\t// Keep `i` a string if there are no elements so `matchedCount` will be \"00\" below\n\t\t\tfor ( ; (elem = elems[i]) != null; i++ ) {\n\t\t\t\tif ( byElement && elem ) {\n\t\t\t\t\tj = 0;\n\t\t\t\t\twhile ( (matcher = elementMatchers[j++]) ) {\n\t\t\t\t\t\tif ( matcher( elem, context, xml ) ) {\n\t\t\t\t\t\t\tresults.push( elem );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif ( outermost ) {\n\t\t\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\t\t\tcachedruns = ++matcherCachedRuns;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Track unmatched elements for set filters\n\t\t\t\tif ( bySet ) {\n\t\t\t\t\t// They will have gone through all possible matchers\n\t\t\t\t\tif ( (elem = !matcher && elem) ) {\n\t\t\t\t\t\tmatchedCount--;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Lengthen the array for every element, matched or not\n\t\t\t\t\tif ( seed ) {\n\t\t\t\t\t\tunmatched.push( elem );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Apply set filters to unmatched elements\n\t\t\tmatchedCount += i;\n\t\t\tif ( bySet && i !== matchedCount ) {\n\t\t\t\tj = 0;\n\t\t\t\twhile ( (matcher = setMatchers[j++]) ) {\n\t\t\t\t\tmatcher( unmatched, setMatched, context, xml );\n\t\t\t\t}\n\n\t\t\t\tif ( seed ) {\n\t\t\t\t\t// Reintegrate element matches to eliminate the need for sorting\n\t\t\t\t\tif ( matchedCount > 0 ) {\n\t\t\t\t\t\twhile ( i-- ) {\n\t\t\t\t\t\t\tif ( !(unmatched[i] || setMatched[i]) ) {\n\t\t\t\t\t\t\t\tsetMatched[i] = pop.call( results );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Discard index placeholder values to get only actual matches\n\t\t\t\t\tsetMatched = condense( setMatched );\n\t\t\t\t}\n\n\t\t\t\t// Add matches to results\n\t\t\t\tpush.apply( results, setMatched );\n\n\t\t\t\t// Seedless set matches succeeding multiple successful matchers stipulate sorting\n\t\t\t\tif ( outermost && !seed && setMatched.length > 0 &&\n\t\t\t\t\t( matchedCount + setMatchers.length ) > 1 ) {\n\n\t\t\t\t\tSizzle.uniqueSort( results );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Override manipulation of globals by nested matchers\n\t\t\tif ( outermost ) {\n\t\t\t\tdirruns = dirrunsUnique;\n\t\t\t\toutermostContext = contextBackup;\n\t\t\t}\n\n\t\t\treturn unmatched;\n\t\t};\n\n\treturn bySet ?\n\t\tmarkFunction( superMatcher ) :\n\t\tsuperMatcher;\n}\n\ncompile = Sizzle.compile = function( selector, group /* Internal Use Only */ ) {\n\tvar i,\n\t\tsetMatchers = [],\n\t\telementMatchers = [],\n\t\tcached = compilerCache[ selector + \" \" ];\n\n\tif ( !cached ) {\n\t\t// Generate a function of recursive functions that can be used to check each element\n\t\tif ( !group ) {\n\t\t\tgroup = tokenize( selector );\n\t\t}\n\t\ti = group.length;\n\t\twhile ( i-- ) {\n\t\t\tcached = matcherFromTokens( group[i] );\n\t\t\tif ( cached[ expando ] ) {\n\t\t\t\tsetMatchers.push( cached );\n\t\t\t} else {\n\t\t\t\telementMatchers.push( cached );\n\t\t\t}\n\t\t}\n\n\t\t// Cache the compiled function\n\t\tcached = compilerCache( selector, matcherFromGroupMatchers( elementMatchers, setMatchers ) );\n\t}\n\treturn cached;\n};\n\nfunction multipleContexts( selector, contexts, results ) {\n\tvar i = 0,\n\t\tlen = contexts.length;\n\tfor ( ; i < len; i++ ) {\n\t\tSizzle( selector, contexts[i], results );\n\t}\n\treturn results;\n}\n\nfunction select( selector, context, results, seed ) {\n\tvar i, tokens, token, type, find,\n\t\tmatch = tokenize( selector );\n\n\tif ( !seed ) {\n\t\t// Try to minimize operations if there is only one group\n\t\tif ( match.length === 1 ) {\n\n\t\t\t// Take a shortcut and set the context if the root selector is an ID\n\t\t\ttokens = match[0] = match[0].slice( 0 );\n\t\t\tif ( tokens.length > 2 && (token = tokens[0]).type === \"ID\" &&\n\t\t\t\t\tcontext.nodeType === 9 && documentIsHTML &&\n\t\t\t\t\tExpr.relative[ tokens[1].type ] ) {\n\n\t\t\t\tcontext = ( Expr.find[\"ID\"]( token.matches[0].replace(runescape, funescape), context ) || [] )[0];\n\t\t\t\tif ( !context ) {\n\t\t\t\t\treturn results;\n\t\t\t\t}\n\n\t\t\t\tselector = selector.slice( tokens.shift().value.length );\n\t\t\t}\n\n\t\t\t// Fetch a seed set for right-to-left matching\n\t\t\ti = matchExpr[\"needsContext\"].test( selector ) ? 0 : tokens.length;\n\t\t\twhile ( i-- ) {\n\t\t\t\ttoken = tokens[i];\n\n\t\t\t\t// Abort if we hit a combinator\n\t\t\t\tif ( Expr.relative[ (type = token.type) ] ) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tif ( (find = Expr.find[ type ]) ) {\n\t\t\t\t\t// Search, expanding context for leading sibling combinators\n\t\t\t\t\tif ( (seed = find(\n\t\t\t\t\t\ttoken.matches[0].replace( runescape, funescape ),\n\t\t\t\t\t\trsibling.test( tokens[0].type ) && context.parentNode || context\n\t\t\t\t\t)) ) {\n\n\t\t\t\t\t\t// If seed is empty or no tokens remain, we can return early\n\t\t\t\t\t\ttokens.splice( i, 1 );\n\t\t\t\t\t\tselector = seed.length && toSelector( tokens );\n\t\t\t\t\t\tif ( !selector ) {\n\t\t\t\t\t\t\tpush.apply( results, seed );\n\t\t\t\t\t\t\treturn results;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Compile and execute a filtering function\n\t// Provide `match` to avoid retokenization if we modified the selector above\n\tcompile( selector, match )(\n\t\tseed,\n\t\tcontext,\n\t\t!documentIsHTML,\n\t\tresults,\n\t\trsibling.test( selector )\n\t);\n\treturn results;\n}\n\n// Deprecated\nExpr.pseudos[\"nth\"] = Expr.pseudos[\"eq\"];\n\n// Easy API for creating new setFilters\nfunction setFilters() {}\nsetFilters.prototype = Expr.filters = Expr.pseudos;\nExpr.setFilters = new setFilters();\n\n// Check sort stability\nsupport.sortStable = expando.split(\"\").sort( sortOrder ).join(\"\") === expando;\n\n// Initialize with the default document\nsetDocument();\n\n// Always assume the presence of duplicates if sort doesn't\n// pass them to our comparison function (as in Google Chrome).\n[0, 0].sort( sortOrder );\nsupport.detectDuplicates = hasDuplicate;\n\n// EXPOSE\n/*if ( typeof define === \"function\" && define.amd ) {\n\tdefine(function() { return Sizzle; });\n} else {\n\twindow.Sizzle = Sizzle;\n}*/\n// EXPOSE\n\n/**\n * @namespace Ink.Dom.Selector\n * @static\n */\n\n/**\n * Alias for the Sizzle selector engine\n *\n * @method select\n * @param {String}      selector    CSS selector to search for elements\n * @param {DOMElement}  [context]   By default the search is done in the document element. However, you can specify an element as search context\n * @param {Array}       [results]   By default this is considered an empty array. But if you want to merge it with other searches you did, pass their result array through here.\n * @return {Array} Array of resulting DOM Elements\n * @sample Ink_Dom_Selector_select.html\n */\n\n/**\n * Filters elements that match a CSS selector.\n *\n * @method matches\n * @param {String}  selector    CSS selector to search for elements\n * @param {Array}   matches     Elements to be 'matched' with\n * @return {Array} Elements that matched\n * @sample Ink_Dom_Selector_matches.html\n */\n\n/**\n * Checks if an element matches a given selector\n *\n * @method matchesSelector\n * @param {DOMElement} element Element to test\n * @param {String}     selector CSS selector to test the element with\n * @return {Boolean} True if element matches the CSS selector\n * @sample Ink_Dom_Selector_matchesSelector.html \n */\n\nreturn {\n    select:          Sizzle,\n    matches:         Sizzle.matches,\n    matchesSelector: Sizzle.matchesSelector\n};\n\n\n}); //( window );\n","/**\n * Array Utilities\n * @module Ink.Util.Array_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Array', '1', [], function() {\n\n    'use strict';\n\n    var arrayProto = Array.prototype;\n\n    /**\n     * @namespace Ink.Util.Array_1\n     */\n\n    var InkArray = {\n\n        /**\n         * Checks if a value is an array\n         *\n         * @method isArray\n         * @param {Mixed} testedObject The object we want to check\n         * @return {Boolean} Whether the given value is a javascript Array.\n         **/\n        isArray: Array.isArray || function (testedObject) {\n            return {}.toString.call(testedObject) === '[object Array]';\n        },\n\n        /**\n         * Loops through an array, grouping similar items together.\n         * @method groupBy\n         * @param {Array}    arr             The input array.\n         * @param {Object}   [options]       Options object, containing:\n         * @param {Function} [options.key]   A function which computes the group key by which the items are grouped.\n         * @param {Boolean}  [options.pairs] Set to `true` if you want to output an array of `[key, [group...]]` pairs instead of an array of groups.\n         * @return {Array} An array containing arrays of chunks.\n         *\n         * @example\n         *        InkArray.groupBy([1, 1, 2, 2, 3, 1])  // -> [ [1, 1], [2, 2], [3], [1] ]\n         *        InkArray.groupBy([1.1, 1.2, 2.1], { key: Math.floor })  // -> [ [1.1, 1.2], [2.1] ]\n         *        InkArray.groupBy([1.1, 1.2, 2.1], { key: Math.floor, pairs: true })  // -> [ [1, [1.1, 1.2]], [2, [2.1]] ]\n         *\n         **/\n        groupBy: function (arr, options) {\n            options = options || {};\n            var ret = [];\n            var latestGroup;\n            function eq(a, b) {\n                return outKey(a) === outKey(b);\n            }\n            function outKey(item) {\n                if (typeof options.key === 'function') {\n                    return options.key(item);\n                } else {\n                    return item;\n                }\n            }\n\n            for (var i = 0, len = arr.length; i < len; i++) {\n                latestGroup = [arr[i]];\n\n                // Chunkin'\n                while ((i + 1 < len) && eq(arr[i], arr[i + 1])) {\n                    latestGroup.push(arr[i + 1]);\n                    i++;\n                }\n\n                if (options.pairs) {\n                    ret.push([outKey(arr[i]), latestGroup]);\n                } else {\n                    ret.push(latestGroup);\n                }\n            }\n            return ret;\n        },\n\n        /**\n         * Replacement for Array.prototype.reduce.\n         *\n         * Uses Array.prototype.reduce if available.\n         *\n         * Produces a single result from a list of values by calling an \"aggregator\" function.\n         *\n         * Falls back to Array.prototype.reduce if available.\n         *\n         * @method reduce\n         * @param {Array} array Input array to be reduced.\n         * @param {Function} callback `function (previousValue, currentValue, index, all) { return {Mixed} }` to execute for each value.\n         * @param {Mixed} initial Object used as the first argument to the first call of `callback`\n         * @return {Mixed} Reduced array.\n         *\n         * @example\n         *          var sum = InkArray.reduce([1, 2, 3], function (a, b) { return a + b; });  // -> 6\n         */\n        reduce: function (array, callback, initial) {\n            if (arrayProto.reduce) {\n                return arrayProto.reduce.apply(array, arrayProto.slice.call(arguments, 1));\n            }\n\n            // From https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce#Polyfill\n            var t = Object( array ), len = t.length >>> 0, k = 0, value;\n            if ( arguments.length >= 3 ) {\n                value = initial;\n            } else {\n                while ( k < len && !(k in t) ) k++;\n                if ( k >= len )\n                    throw new TypeError('Reduce of empty array with no initial value');\n                value = t[ k++ ];\n            }\n            for ( ; k < len ; k++ ) {\n                if ( k in t ) {\n                    value = callback( value, t[k], k, t );\n                }\n            }\n            return value;\n        },\n\n        /**\n         * Checks if a value exists in array\n         *\n         * @method inArray\n         * @public\n         * @static\n         * @param {Mixed} value     Value to check\n         * @param {Array} arr       Array to search in\n         * @return {Boolean}        True if value exists in the array\n         * @sample Ink_Util_Array_inArray.html\n         */\n        inArray: function(value, arr) {\n            if (typeof arr === 'object') {\n                for (var i = 0, f = arr.length; i < f; ++i) {\n                    if (arr[i] === value) {\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n\n        /**\n         * Sorts an array of objects by an object property\n         *\n         * @method sortMulti\n         * @param {Array}           arr         Array of objects to sort\n         * @param {String}  key         Property to sort by\n         * @return {Array|Boolean}      False if it's not an array, returns a sorted array if it's an array.\n         * @public\n         * @static\n         * @sample Ink_Util_Array_sortMulti.html\n         */\n        sortMulti: function(arr, key) {\n            if (typeof arr === 'undefined' || arr.constructor !== Array) { return false; }\n            if (typeof key !== 'string') { return arr.sort(); }\n            if (arr.length > 0) {\n                if (typeof(arr[0][key]) === 'undefined') { return false; }\n                arr.sort(function(a, b){\n                    var x = a[key];\n                    var y = b[key];\n                    return ((x < y) ? -1 : ((x > y) ? 1 : 0));\n                });\n            }\n            return arr;\n        },\n\n        /**\n         * Gets the indexes of a value in an array\n         *\n         * @method keyValue\n         * @param   {String}      value     Value to search for.\n         * @param   {Array}       arr       Array to run the search in.\n         * @param   {Boolean}     [first]   Flag to stop the search at the first match. It also returns an index number instead of an array of indexes.\n         * @return  {Boolean|Number|Array}  False for no matches. Array of matches or first match index.\n         * @public\n         * @static\n         * @sample Ink_Util_Array_keyValue.html\n         */\n        keyValue: function(value, arr, first) {\n            if (typeof value !== 'undefined' && typeof arr === 'object' && this.inArray(value, arr)) {\n                var aKeys = [];\n                for (var i = 0, f = arr.length; i < f; ++i) {\n                    if (arr[i] === value) {\n                        if (typeof first !== 'undefined' && first === true) {\n                            return i;\n                        } else {\n                            aKeys.push(i);\n                        }\n                    }\n                }\n                return aKeys;\n            }\n            return false;\n        },\n\n        /**\n         * Shuffles an array.\n         *\n         * @method shuffle\n         * @param   {Array}       arr    Array to shuffle\n         * @return  {Array|Boolean}      Shuffled Array or false if not an array.\n         * @public\n         * @static\n         * @sample Ink_Util_Array_shuffle.html\n         */\n        shuffle: function(arr) {\n            if (typeof(arr) !== 'undefined' && arr.constructor !== Array) { return false; }\n            var total   = arr.length,\n                tmp1    = false,\n                rnd     = false;\n\n            while (total--) {\n                rnd        = Math.floor(Math.random() * (total + 1));\n                tmp1       = arr[total];\n                arr[total] = arr[rnd];\n                arr[rnd]   = tmp1;\n            }\n            return arr;\n        },\n\n        /**\n         * Runs a function through each of the elements of an array.\n         *\n         * Uses Array.prototype.forEach if available.\n         *\n         * @method forEach\n         * @param   {Array}     array    The array to be cycled/iterated\n         * @param   {Function}  callback The function receives as arguments the value, index and array.\n         * @param   {Mixed}     context  The value of `this` inside the `callback` you passed.\n         * @return  {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Array_forEach.html\n         */\n        forEach: function(array, callback, context) {\n            if (arrayProto.forEach) {\n                return arrayProto.forEach.call(array, callback, context);\n            }\n            for (var i = 0, len = array.length >>> 0; i < len; i++) {\n                callback.call(context, array[i], i, array);\n            }\n        },\n\n        /**\n         * Alias for backwards compatibility. See forEach\n         *\n         * @method each\n         * @param {Mixed} [forEachArguments] (see forEach)\n         * @return {void} (see forEach)\n         */\n        each: function () {\n            InkArray.forEach.apply(InkArray, arrayProto.slice.call(arguments));\n        },\n\n        /**\n         * Runs a function for each item in the array.\n         * Uses Array.prototype.map if available.\n         * That function will receive each item as an argument and its return value will change the corresponding array item.\n         * @method map\n         * @param {Array}       array       The array to map over\n         * @param {Function}    mapFn       The map function. Will take `(item, index, array)` as arguments and the `this` value will be the `context` argument you pass to this function.\n         * @param {Object}      [context]   Object to be `this` in the map function.\n         * @return {Array} A copy of the original array, with all of its items processed by the map function.\n         *\n         * @sample Ink_Util_Array_map.html\n         */\n        map: function (array, mapFn, context) {\n            if (arrayProto.map) {\n                return arrayProto.map.call(array, mapFn, context);\n            }\n            var mapped = new Array(len);\n            for (var i = 0, len = array.length >>> 0; i < len; i++) {\n                mapped[i] = mapFn.call(context, array[i], i, array);\n            }\n            return mapped;\n        },\n\n        /**\n         * Filters an array based on a truth test.\n         * This method runs a test function on all the array values and returns a new array with all the values that pass the test.\n         * @method filter\n         * @param {Array}       array       The array to filter\n         * @param {Function}    test        A test function taking `(item, index, array)`\n         * @param {Object}      [context]   Object to be `this` in the test function.\n         * @return {Array}                  Returns the filtered array\n         *\n         * @sample Ink_Util_Array_filter.html\n         */\n        filter: function (array, test, context) {\n            if (arrayProto.filter) {\n                return arrayProto.filter.call(array, test, context);\n            }\n            var filtered = [],\n                val = null;\n            for (var i = 0, len = array.length; i < len; i++) {\n                val = array[i]; // it might be mutated\n                if (test.call(context, val, i, array)) {\n                    filtered.push(val);\n                }\n            }\n            return filtered;\n        },\n\n        /**\n         * Checks if some element in the array passes a truth test\n         *\n         * @method some\n         * @param   {Array}       arr       The array to iterate through\n         * @param   {Function}    cb        The callback to be called on the array's elements. It receives the value, the index and the array as arguments.\n         * @param   {Object}      context   Object of the callback function\n         * @return  {Boolean}               True if the callback returns true at any point, false otherwise\n         * @public\n         * @static\n         * @sample Ink_Util_Array_some.html\n         */\n        some: function(arr, cb, context){\n\n            if (arr === null){\n                throw new TypeError('First argument is invalid.');\n            }\n\n            var t = Object(arr);\n            var len = t.length >>> 0;\n            if (typeof cb !== \"function\"){ throw new TypeError('Second argument must be a function.'); }\n\n            for (var i = 0; i < len; i++) {\n                if (i in t && cb.call(context, t[i], i, t)){ return true; }\n            }\n\n            return false;\n        },\n\n        /**\n         * Compares the values of two arrays and return the matches\n         *\n         * @method intersect\n         * @param   {Array}   arr1      First array\n         * @param   {Array}   arr2      Second array\n         * @return  {Array}             Empty array if one of the arrays is false (or do not intersect) | Array with the intersected values\n         * @public\n         * @static\n         * @sample Ink_Util_Array_intersect.html\n         */\n        intersect: function(arr1, arr2) {\n            if (!arr1 || !arr2 || arr1 instanceof Array === false || arr2 instanceof Array === false) {\n                return [];\n            }\n\n            var shared = [];\n            for (var i = 0, I = arr1.length; i<I; ++i) {\n                for (var j = 0, J = arr2.length; j < J; ++j) {\n                    if (arr1[i] === arr2[j]) {\n                        shared.push(arr1[i]);\n                    }\n                }\n            }\n\n            return shared;\n        },\n\n        /**\n         * Converts an array-like object to an array\n         *\n         * @method convert\n         * @param   {Array}   arr   Array to be converted\n         * @return  {Array}         Array resulting of the conversion\n         * @public\n         * @static\n         * @sample Ink_Util_Array_convert.html\n         */\n        convert: function(arr) {\n            return arrayProto.slice.call(arr || [], 0);\n        },\n\n        /**\n         * Removes duplicated values in an array.\n         *\n         * @method unique\n         * @param {Array}   arr   Array to filter\n         * @return {Array}        Array with only unique values\n         * @public\n         * @static\n         */\n        unique: function(arr){\n            if(!Array.prototype.lastIndexOf){ //IE8 slower alternative\n                var newArr = [];\n\n                InkArray.forEach(InkArray.convert(arr), function(i){\n                    if(!InkArray.inArray(i,newArr)){\n                        newArr.push(i);\n                    }\n                });\n                return newArr;\n            }//else\n            return InkArray.filter(InkArray.convert(arr), function (e, i, arr) {\n                            return arr.lastIndexOf(e) === i;\n                        });\n        },\n\n        /**\n         * Simulates python's range(start, stop, step) function.\n         *\n         * Creates a list with numbers counting from start until stop, using a for loop.\n         *.\n         * The optional step argument defines how to step ahead. You can pass a negative number to count backwards (see the examples below).\n         *\n         * @method range\n         * @param {Number} start    The array's first element.\n         * @param {Number} stop     Stop counting before this number.\n         * @param {Number} [step=1] Interval between numbers. You can use a negative number to count backwards.\n         * @return {Array} An Array representing the range.\n         *\n         * @sample Ink_Util_Array_1_range.html\n         **/\n        range: function range(start, stop, step) {\n            // From: https://github.com/mcandre/node-range\n            if (!step) {\n                step = 1;\n            }\n\n            var r = [];\n            var x;\n\n            if (step > 0) {\n                for (x = start; x < stop; x += step) {\n                    r.push(x);\n                }\n            } else {\n                for (x = start; x > stop; x += step) {\n                    r.push(x);\n                }\n            }\n\n            return r;\n        },\n\n        /**\n         * Inserts a value on a specified index\n         *\n         * @method insert\n         * @param {Array}   arr     Array where the value will be inserted\n         * @param {Number}  idx     Index of the array where the value should be inserted\n         * @param {Mixed}   value   Value to be inserted\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Array_insert.html\n         */\n        insert: function(arr, idx, value) {\n            arr.splice(idx, 0, value);\n        },\n\n        /**\n         * Removes a range of values from the array\n         *\n         * @method remove\n         * @param   {Array}     arr     Array where the value will be removed\n         * @param   {Number}    from    Index of the array where the removal will start removing.\n         * @param   {Number}    rLen    Number of items to be removed from the index onwards.\n         * @return  {Array}             An array with the remaining values\n         * @public\n         * @static\n         * @sample Ink_Util_Array_remove.html\n         */\n        remove: function(arr, from, rLen){\n            var output = [];\n\n            for(var i = 0, iLen = arr.length; i < iLen; i++){\n                if(i >= from && i < from + rLen){\n                    continue;\n                }\n\n                output.push(arr[i]);\n            }\n\n            return output;\n        }\n    };\n\n    return InkArray;\n\n});\n","/**\n * Binary Packing algorithm implementation\n * @module Ink.Util.BinPack_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.BinPack', '1', [], function() {\n\n    'use strict';\n\n    /*jshint boss:true */\n\n    // https://github.com/jakesgordon/bin-packing/\n\n    /*\n        Copyright (c) 2011, 2012, 2013 Jake Gordon and contributors\n\n        Permission is hereby granted, free of charge, to any person obtaining a copy\n        of this software and associated documentation files (the \"Software\"), to deal\n        in the Software without restriction, including without limitation the rights\n        to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n        copies of the Software, and to permit persons to whom the Software is\n        furnished to do so, subject to the following conditions:\n\n        The above copyright notice and this permission notice shall be included in all\n        copies or substantial portions of the Software.\n\n        THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n        IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n        FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n        AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n        LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n        OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n        SOFTWARE.\n    */\n\n\n\n    var Packer = function(w, h) {\n        this.init(w, h);\n    };\n\n    Packer.prototype = {\n\n        init: function(w, h) {\n            this.root = { x: 0, y: 0, w: w, h: h };\n        },\n\n        fit: function(blocks) {\n            var n, node, block;\n            for (n = 0; n < blocks.length; ++n) {\n                block = blocks[n];\n                if (node = this.findNode(this.root, block.w, block.h)) {\n                    block.fit = this.splitNode(node, block.w, block.h);\n                }\n            }\n        },\n\n        findNode: function(root, w, h) {\n            if (root.used) {\n                return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);\n            }\n            else if ((w <= root.w) && (h <= root.h)) {\n                return root;\n            }\n            else {\n                return null;\n            }\n        },\n\n        splitNode: function(node, w, h) {\n            node.used = true;\n            node.down  = { x: node.x,     y: node.y + h, w: node.w,     h: node.h - h };\n            node.right = { x: node.x + w, y: node.y,     w: node.w - w, h: h          };\n            return node;\n        }\n\n    };\n\n\n\n    var GrowingPacker = function() {};\n\n    GrowingPacker.prototype = {\n\n        fit: function(blocks) {\n            var n, node, block, len = blocks.length;\n            var w = len > 0 ? blocks[0].w : 0;\n            var h = len > 0 ? blocks[0].h : 0;\n            this.root = { x: 0, y: 0, w: w, h: h };\n            for (n = 0; n < len ; n++) {\n                block = blocks[n];\n                if (node = this.findNode(this.root, block.w, block.h)) {\n                    block.fit = this.splitNode(node, block.w, block.h);\n                }\n                else {\n                    block.fit = this.growNode(block.w, block.h);\n                }\n            }\n        },\n\n        findNode: function(root, w, h) {\n            if (root.used) {\n                return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);\n            }\n            else if ((w <= root.w) && (h <= root.h)) {\n                return root;\n            }\n            else {\n                return null;\n            }\n        },\n\n        splitNode: function(node, w, h) {\n            node.used = true;\n            node.down  = { x: node.x,     y: node.y + h, w: node.w,     h: node.h - h };\n            node.right = { x: node.x + w, y: node.y,     w: node.w - w, h: h          };\n            return node;\n        },\n\n        growNode: function(w, h) {\n            var canGrowDown  = (w <= this.root.w);\n            var canGrowRight = (h <= this.root.h);\n\n            var shouldGrowRight = canGrowRight && (this.root.h >= (this.root.w + w)); // attempt to keep square-ish by growing right when height is much greater than width\n            var shouldGrowDown  = canGrowDown  && (this.root.w >= (this.root.h + h)); // attempt to keep square-ish by growing down  when width  is much greater than height\n\n            if (shouldGrowRight) {\n                return this.growRight(w, h);\n            }\n            else if (shouldGrowDown) {\n                return this.growDown(w, h);\n            }\n            else if (canGrowRight) {\n                return this.growRight(w, h);\n            }\n            else if (canGrowDown) {\n                return this.growDown(w, h);\n            }\n            else {\n                return null; // need to ensure sensible root starting size to avoid this happening\n            }\n        },\n\n        growRight: function(w, h) {\n            this.root = {\n                used: true,\n                x: 0,\n                y: 0,\n                w: this.root.w + w,\n                h: this.root.h,\n                down: this.root,\n                right: { x: this.root.w, y: 0, w: w, h: this.root.h }\n            };\n            var node;\n            if (node = this.findNode(this.root, w, h)) {\n                return this.splitNode(node, w, h);\n            }\n            else {\n                return null;\n            }\n        },\n\n        growDown: function(w, h) {\n            this.root = {\n                used: true,\n                x: 0,\n                y: 0,\n                w: this.root.w,\n                h: this.root.h + h,\n                down:  { x: 0, y: this.root.h, w: this.root.w, h: h },\n                right: this.root\n            };\n            var node;\n            if (node = this.findNode(this.root, w, h)) {\n                return this.splitNode(node, w, h);\n            }\n            else {\n                return null;\n            }\n        }\n\n    };\n\n\n\n    var sorts = {\n        random:  function() { return Math.random() - 0.5; },\n        w:       function(a, b) { return b.w - a.w; },\n        h:       function(a, b) { return b.h - a.h; },\n        a:       function(a, b) { return b.area - a.area; },\n        max:     function(a, b) { return Math.max(b.w, b.h) - Math.max(a.w, a.h); },\n        min:     function(a, b) { return Math.min(b.w, b.h) - Math.min(a.w, a.h); },\n        height:  function(a, b) { return sorts.msort(a, b, ['h', 'w']);               },\n        width:   function(a, b) { return sorts.msort(a, b, ['w', 'h']);               },\n        area:    function(a, b) { return sorts.msort(a, b, ['a', 'h', 'w']);          },\n        maxside: function(a, b) { return sorts.msort(a, b, ['max', 'min', 'h', 'w']); },\n        msort:   function(a, b, criteria) { /* sort by multiple criteria */\n            var diff, n;\n            for (n = 0; n < criteria.length; ++n) {\n                diff = sorts[ criteria[n] ](a, b);\n                if (diff !== 0) {\n                    return diff;\n                }\n            }\n            return 0;\n        }\n    };\n\n\n\n    // end of Jake's code\n\n\n\n    // aux, used to display blocks in unfitted property\n    var toString = function() {\n      return [this.w, ' x ', this.h].join('');\n    };\n\n\n\n    /**\n     * Binary Packing algorithm implementation\n     *\n     * Based on the work of Jake Gordon\n     *\n     * see https://github.com/jakesgordon/bin-packing/\n     *\n     * @namespace Ink.Util.BinPack\n     * @version 1\n     * @static\n     */\n    var BinPack = {\n\n        /**\n        * @method binPack\n        * @param {Object}       o               Options\n        * @param {Array}        o.blocks        Array of items with width and height integer attributes.\n        * @param {Array}        [o.dimensions]  Flag to fix container dimensions\n        * @param {String}       [o.sorter]      Sorting function. One of: random, height, width, area, maxside\n        * @return {Object}                      Returns an object containing container dimensions, filled ratio, fitted blocks, unfitted blocks and all blocks\n        * @static\n        */\n        binPack: function(o) {\n            var i, f, bl;\n\n\n\n            // calculate area if not there already\n            for (i = 0, f = o.blocks.length; i < f; ++i) {\n                bl = o.blocks[i];\n                if (! ('area' in bl) ) {\n                    bl.area = bl.w * bl.h;\n                }\n            }\n\n\n\n            // apply algorithm\n            var packer = o.dimensions ? new Packer(o.dimensions[0], o.dimensions[1]) : new GrowingPacker();\n\n            if (!o.sorter) { o.sorter = 'maxside'; }\n\n            o.blocks.sort( sorts[ o.sorter ] );\n\n            packer.fit(o.blocks);\n\n            var dims2 = [packer.root.w, packer.root.h];\n\n\n\n            // layout is done here, generating report data...\n            var fitted   = [];\n            var unfitted = [];\n\n            for (i = 0, f = o.blocks.length; i < f; ++i) {\n                bl = o.blocks[i];\n                if (bl.fit) {\n                    fitted.push(bl);\n                }\n                else {\n                    bl.toString = toString; // TO AID SERIALIZATION\n                    unfitted.push(bl);\n                }\n            }\n\n            var area = dims2[0] * dims2[1];\n            var fit = 0;\n            for (i = 0, f = fitted.length; i < f; ++i) {\n                bl = fitted[i];\n                fit += bl.area;\n            }\n\n            return {\n                dimensions: dims2,\n                filled:     fit / area,\n                blocks:     o.blocks,\n                fitted:     fitted,\n                unfitted:   unfitted\n            };\n        }\n    };\n\n\n\n    return BinPack;\n\n});","/**\n * Cookie Utilities\n * @module Ink.Util.Cookie_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Cookie', '1', [], function() {\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.Cookie_1\n     */\n    var Cookie = {\n\n        /**\n         * Gets an object with the current page cookies, or a specific cookie if you specify the `name`.\n         *\n         * @method get\n         * @param   {String}          [name]    The cookie name.\n         * @return  {String|Object}             If the name is specified, it returns the value of that key. Otherwise it returns the full cookie object\n         * @public\n         * @static\n         * @sample Ink_Util_Cookie_get.html\n         */\n        get: function(name)\n        {\n            var cookie = document.cookie || false;\n\n            var _Cookie = {};\n\n            if(cookie) {\n                cookie = cookie.replace(new RegExp(\"; \", \"g\"), ';');\n\n                var aCookie = cookie.split(';');\n                var aItem = [];\n                if(aCookie.length > 0) {\n                    for(var i=0; i < aCookie.length; i++) {\n                        aItem = aCookie[i].split('=');\n                        if(aItem.length === 2) {\n                            _Cookie[aItem[0]] = decodeURIComponent(aItem[1]);\n                        }\n                    }\n                }\n                if(name) {\n                    if(typeof(_Cookie[name]) !== 'undefined') {\n                        return _Cookie[name];\n                    } else {\n                        return null;\n                    }\n                }\n            }\n            return _Cookie;\n        },\n\n        /**\n         * Sets a cookie.\n         *\n         * @method set\n         * @param {String}      name        Cookie name.\n         * @param {String}      value       Cookie value.\n         * @param {Number}      [expires]   Number of seconds the cookie will be valid for.\n         * @param {String}      [path]      Path for the cookie. Defaults to '/'.\n         * @param {String}      [domain]    Domain for the cookie. Defaults to current hostname.\n         * @param {Boolean}     [secure]    Flag for secure. Default 'false'.\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Cookie_set.html\n         */\n        set: function(name, value, expires, path, domain, secure)\n        {\n            var sName;\n            if(!name || value===false || typeof(name) === 'undefined' || typeof(value) === 'undefined') {\n                return false;\n            } else {\n                sName = name+'='+encodeURIComponent(value);\n            }\n            var sExpires = false;\n            var sPath = false;\n            var sDomain = false;\n            var sSecure = false;\n\n            if(expires && typeof(expires) !== 'undefined' && !isNaN(expires)) {\n                var oDate = new Date();\n                var sDate = (parseInt(Number(oDate.valueOf()), 10) + (Number(parseInt(expires, 10)) * 1000));\n\n                var nDate = new Date(sDate);\n                var expiresString = nDate.toGMTString();\n\n                var re = new RegExp(\"([^\\\\s]+)(\\\\s\\\\d\\\\d)\\\\s(\\\\w\\\\w\\\\w)\\\\s(.*)\");\n                expiresString = expiresString.replace(re, \"$1$2-$3-$4\");\n\n                sExpires = 'expires='+expiresString;\n            } else {\n                if(typeof(expires) !== 'undefined' && !isNaN(expires) && Number(parseInt(expires, 10))===0) {\n                    sExpires = '';\n                } else {\n                    sExpires = 'expires=Thu, 01-Jan-2037 00:00:01 GMT';\n                }\n            }\n\n            if(path && typeof(path) !== 'undefined') {\n                sPath = 'path='+path;\n            } else {\n                sPath = 'path=/';\n            }\n\n            if(domain) {\n                sDomain = 'domain='+domain;\n            } else if (/\\./.test(window.location.hostname)) {\n                // When trying to set domain=localhost or any other domain\n                // without dots, setting the cookie fails.\n                // Anyways, the cookies are bound to the current domain by default so let it be.\n                sDomain = 'domain='+window.location.hostname;\n            }\n\n            if(secure && typeof(secure) !== 'undefined') {\n                sSecure = secure;\n            } else {\n                sSecure = false;\n            }\n\n            document.cookie = sName +\n                '; ' + sExpires +\n                '; ' + sPath +\n                (sDomain ? '; ' + sDomain : '') +\n                '; ' + sSecure;\n        },\n\n        /**\n         * Deletes a cookie.\n         *\n         * @method remove\n         * @param {String}  cookieName   Cookie name.\n         * @param {String}  [path]       Path of the cookie. Defaults to '/'.\n         * @param {String}  [domain]     Domain of the cookie. Defaults to current hostname.\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Cookie_remove.html\n         */\n        remove: function(cookieName, path, domain) {\n            var expiresDate = -1;\n\n            this.set(cookieName, 'deleted', expiresDate, path, domain);\n        }\n    };\n\n    return Cookie;\n\n});\n","/**\n * Date utility functions\n * @module Ink.Util.Date_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Date', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.Date_1 \n     */\n    var InkDate = {\n\n        /**\n         * Function that returns the string representation of the month [PT only]\n         *\n         * @method _months\n         * @param {Number} index Month javascript (0 to 11)\n         * @return {String} The month's name\n         * @private\n         * @static\n         * @example\n         *     console.log( InkDate._months(0) ); // Result: Janeiro\n         */\n        _months: function(index){\n            var _m = ['Janeiro', 'Fevereiro', 'Março', 'Abril', 'Maio', 'Junho', 'Julho', 'Agosto', 'Setembro', 'Outubro', 'Novembro', 'Dezembro'];\n            return _m[index];\n        },\n\n        /**\n         * Function that returns the month [PT only] ( 0 to 11 )\n         *\n         * @method _iMonth\n         * @param {String} month Month javascript (0 to 11)\n         * @return {Number} The month's number\n         * @private\n         * @static\n         * @example\n         *     console.log( InkDate._iMonth('maio') ); // Result: 4\n         */\n        _iMonth : function( month )\n        {\n            if ( Number( month ) ) { return +month - 1; }\n            return {\n                'janeiro'   : 0  ,\n                'jan'       : 0  ,\n                'fevereiro' : 1  ,\n                'fev'       : 1  ,\n                'março'     : 2  ,\n                'mar'       : 2  ,\n                'abril'     : 3  ,\n                'abr'       : 3  ,\n                'maio'      : 4  ,\n                'mai'       : 4  ,\n                'junho'     : 5  ,\n                'jun'       : 5  ,\n                'julho'     : 6  ,\n                'jul'       : 6  ,\n                'agosto'    : 7  ,\n                'ago'       : 7  ,\n                'setembro'  : 8  ,\n                'set'       : 8  ,\n                'outubro'   : 9  ,\n                'out'       : 9  ,\n                'novembro'  : 10 ,\n                'nov'       : 10 ,\n                'dezembro'  : 11 ,\n                'dez'       : 11\n            }[ month.toLowerCase( ) ];\n        } ,\n\n        /**\n         * Function that returns the representation the day of the week [PT Only]\n         *\n         * @method _wDays\n         * @param {Number} index Week's day index\n         * @return {String} The week's day name\n         * @private\n         * @static\n         * @example\n         *     console.log( InkDate._wDays(0) ); // Result: Domingo\n         */\n        _wDays: function(index){\n            var _d = ['Domingo', 'Segunda', 'Terça', 'Quarta', 'Quinta', 'Sexta', 'Sábado'];\n            return _d[index];\n        },\n\n        /**\n         * Function that returns day of the week in javascript 1 to 7\n         *\n         * @method _iWeek\n         * @param {String} week Week's day name\n         * @return {Number} The week's day index\n         * @private\n         * @static\n         * @example\n         *     console.log( InkDate._iWeek('quarta') ); // Result: 3\n         */\n        _iWeek: function( week )\n        {\n            if ( Number( week ) ) { return +week || 7; }\n            return {\n                'segunda' : 1  ,\n                'seg'     : 1  ,\n                'terça'   : 2  ,\n                'ter'     : 2  ,\n                'quarta'  : 3  ,\n                'qua'     : 3  ,\n                'quinta'  : 4  ,\n                'qui'     : 4  ,\n                'sexta'   : 5  ,\n                'sex'     : 5  ,\n                'sábado'  : 6  ,\n                'sáb'     : 6  ,\n                'domingo' : 7  ,\n                'dom'     : 7\n            }[ week.toLowerCase( ) ];\n        },\n\n        /**\n         * Function that returns the number of days of a given month (m) on a given year (y)\n         *\n         * @method _daysInMonth\n         * @param {Number} _m Month\n         * @param {Number} _y Year\n         * @return {Number} Number of days of a give month on a given year\n         * @private\n         * @static\n         * @example\n         *     console.log( InkDate._daysInMonth(2,2013) ); // Result: 28\n         */\n        _daysInMonth: function(_m,_y){\n            var nDays;\n\n            if(_m===1 || _m===3 || _m===5 || _m===7 || _m===8 || _m===10 || _m===12)\n            {\n                nDays= 31;\n            }\n            else if ( _m===4 || _m===6 || _m===9 || _m===11)\n            {\n                nDays = 30;\n            }\n            else\n            {\n                if((_y%400===0) || (_y%4===0 && _y%100!==0))\n                {\n                    nDays = 29;\n                }\n                else\n                {\n                    nDays = 28;\n                }\n            }\n            return nDays;\n        },\n\n        /**\n         * Formats a date object.\n         * This works exactly as php date() function. http://php.net/manual/en/function.date.php\n         *\n         * @method get\n         * @param   {String}      format    The format in which the date it will be formatted.\n         * @param   {Date}        [_date]   The date to format. Can receive unix timestamp or a date object. Defaults to current time.\n         * @return  {String}                Formatted date\n         * @public\n         * @static\n         * @sample Ink_Util_Date_get.html \n         */\n        get: function(format, _date){\n            /*jshint maxcomplexity:65 */\n            if(typeof(format) === 'undefined' || format === ''){\n                format = \"Y-m-d\";\n            }\n\n\n            var iFormat = format.split(\"\");\n            var result = new Array(iFormat.length);\n            var escapeChar = \"\\\\\";\n            var jsDate;\n\n        if (typeof(_date) === 'undefined'){\n            jsDate = new Date();\n        } else if (typeof(_date)==='number'){\n            jsDate = new Date(_date*1000);\n        } else {\n            jsDate = new Date(_date);\n        }\n\n        var jsFirstDay, jsThisDay, jsHour;\n        /* This switch is presented in the same order as in php date function (PHP 5.2.2) */\n        for (var i = 0; i < iFormat.length; i++) {\n           switch(iFormat[i]) {\n                case escapeChar:\n                    result[i] = iFormat[i+1];\n                    i++;\n                    break;\n\n\n                /* DAY */\n                case \"d\":   /* Day of the month, 2 digits with leading zeros; ex: 01 to 31  */\n                    var jsDay = jsDate.getDate();\n                    result[i] = (String(jsDay).length > 1) ? jsDay : \"0\" + jsDay;\n                    break;\n\n                case \"D\":   /* A textual representation of a day, three letters; Seg to Dom */\n                    result[i] = this._wDays(jsDate.getDay()).substring(0, 3);\n                    break;\n\n                case \"j\":  /* Day of the month without leading zeros; ex: 1 to 31  */\n                    result[i] = jsDate.getDate();\n                    break;\n\n                case \"l\":   /* A full textual representation of the day of the week; Domingo to Sabado  */\n                    result[i] = this._wDays(jsDate.getDay());\n                    break;\n\n                case \"N\":  /* ISO-8601 numeric representation of the day of the week; 1 (Segunda) to 7 (Domingo)  */\n                    result[i] = jsDate.getDay() || 7;\n                    break;\n\n                case \"S\":  /* English ordinal suffix for the day of the month, 2 characters; st, nd, rd or th. Works well with j */\n                    var temp     = jsDate.getDate();\n                    var suffixes = [\"st\", \"nd\", \"rd\"];\n                    var suffix   = \"\";\n\n                    if (temp >= 11 && temp <= 13) {\n                        result[i] = \"th\";\n                    } else {\n                        result[i]  = (suffix = suffixes[String(temp).substr(-1) - 1]) ? (suffix) : (\"th\");\n                    }\n                    break;\n\n                case \"w\":    /* Numeric representation of the day of the week; 0 (for Sunday) through 6 (for Saturday) */\n                    result[i] = jsDate.getDay();\n                    break;\n\n                case \"z\":    /* The day of the year (starting from 0); 0 to 365 */\n                    jsFirstDay = Date.UTC(jsDate.getFullYear(), 0, 0);\n                    jsThisDay = Date.UTC(jsDate.getFullYear(), jsDate.getMonth(), jsDate.getDate());\n                    result[i] = Math.floor((jsThisDay - jsFirstDay) / (1000 * 60 * 60 * 24));\n                    break;\n\n                /* WEEK */\n                case \"W\":    /* ISO-8601 week number of year, weeks starting on Monday; ex: 42 (the 42nd week in the year)  */\n                    var jsYearStart = new Date( jsDate.getFullYear( ) , 0 , 1 );\n                    jsFirstDay = jsYearStart.getDay() || 7;\n\n                    var days = Math.floor( ( jsDate - jsYearStart ) / ( 24 * 60 * 60 * 1000 ) + 1 );\n\n                    result[ i ] = Math.ceil( ( days - ( 8 - jsFirstDay ) ) / 7 ) + 1;\n                    break;\n\n\n                /* MONTH */\n                case \"F\":   /* A full textual representation of a month, such as Janeiro or Marco; Janeiro a Dezembro */\n                    result[i] = this._months(jsDate.getMonth());\n                    break;\n\n                case \"m\":   /* Numeric representation of a month, with leading zeros; 01 to 12  */\n                    var jsMonth = String(jsDate.getMonth() + 1);\n                    result[i] = (jsMonth.length > 1) ? jsMonth : \"0\" + jsMonth;\n                    break;\n\n                case \"M\":   /* A short textual representation of a month, three letters; Jan a Dez */\n                    result[i] = this._months(jsDate.getMonth()).substring(0,3);\n                    break;\n\n                case \"n\":   /* Numeric representation of a month, without leading zeros; 1 a 12  */\n                    result[i] = jsDate.getMonth() + 1;\n                    break;\n\n                case \"t\":   /* Number of days in the given month; ex: 28 */\n                    result[i] = this._daysInMonth(jsDate.getMonth()+1,jsDate.getYear());\n                    break;\n\n                /* YEAR */\n                case \"L\":   /* Whether it's a leap year; 1 if it is a leap year, 0 otherwise.  */\n                    var jsYear = jsDate.getFullYear();\n                    result[i] = (jsYear % 4) ? false : ( (jsYear % 100) ?  true : ( (jsYear % 400) ? false : true  ) );\n                    break;\n\n                case \"o\":  /* ISO-8601 year number. This has the same value as Y, except that if the ISO week number (W) belongs to the previous or next year, that year is used instead.  */\n                    throw '\"o\" not implemented!';\n\n                case \"Y\":  /* A full numeric representation of a year, 4 digits; 1999  */\n                    result[i] = jsDate.getFullYear();\n                    break;\n\n                case \"y\":  /* A two digit representation of a year; 99  */\n                    result[i] = String(jsDate.getFullYear()).substring(2);\n                    break;\n\n                /* TIME */\n                case \"a\":   /* Lowercase Ante meridiem and Post meridiem; am or pm */\n                    result[i] = (jsDate.getHours() < 12) ? \"am\" : \"pm\";\n                    break;\n\n                case \"A\":   /* Uppercase Ante meridiem and Post meridiem; AM or PM  */\n                    result[i] = (jsDate.getHours < 12) ? \"AM\" : \"PM\";\n                    break;\n\n                case \"B\":  /* Swatch Internet time; 000 through 999  */\n                    throw '\"B\" not implemented!';\n\n                case \"g\":   /* 12-hour format of an hour without leading zeros;  1 to 12 */\n                    jsHour = jsDate.getHours();\n                    result[i] = (jsHour <= 12) ? jsHour : (jsHour - 12);\n                    break;\n\n                case \"G\":   /* 24-hour format of an hour without leading zeros; 1 to 23 */\n                    result[i] = String(jsDate.getHours());\n                    break;\n\n                case \"h\":   /* 12-hour format of an hour with leading zeros; 01 to 12 */\n                    jsHour = String(jsDate.getHours());\n                    jsHour = (jsHour <= 12) ? jsHour : (jsHour - 12);\n                    result[i] = (jsHour.length > 1) ? jsHour : \"0\" + jsHour;\n                    break;\n\n                case \"H\":   /* 24-hour format of an hour with leading zeros; 01 to 24 */\n                    jsHour = String(jsDate.getHours());\n                    result[i] = (jsHour.length > 1) ? jsHour : \"0\" + jsHour;\n                    break;\n\n                case \"i\":   /* Minutes with leading zeros; 00 to 59 */\n                    var jsMinute  = String(jsDate.getMinutes());\n                    result[i] = (jsMinute.length > 1) ? jsMinute : \"0\" + jsMinute;\n                    break;\n\n                case \"s\":   /* Seconds with leading zeros; 00 to 59; */\n                    var jsSecond  = String(jsDate.getSeconds());\n                    result[i]  = (jsSecond.length > 1) ? jsSecond : \"0\" + jsSecond;\n                    break;\n\n                case \"u\":  /* Microseconds */\n                    throw '\"u\" not implemented!';\n\n\n                /* TIMEZONE */\n\n                case \"e\": /* Timezone identifier  */\n                    throw '\"e\" not implemented!';\n\n                case \"I\":   /*  \"1\" if Daylight Savings Time, \"0\" otherwise. Works only on the northern hemisphere */\n                    jsFirstDay = new Date(jsDate.getFullYear(), 0, 1);\n                    result[i] = (jsDate.getTimezoneOffset() !== jsFirstDay.getTimezoneOffset()) ? (1) : (0);\n                    break;\n\n                case \"O\":  /* Difference to Greenwich time (GMT) in hours */\n                    var jsMinZone = jsDate.getTimezoneOffset();\n                    var jsMinutes = jsMinZone % 60;\n                    jsHour = String(((jsMinZone - jsMinutes) / 60) * -1);\n\n                    if (jsHour.charAt(0) !== \"-\") {\n                        jsHour = \"+\" + jsHour;\n                    }\n\n                    jsHour = (jsHour.length === 3) ? (jsHour) : (jsHour.replace(/([+\\-])(\\d)/, \"$1\" + 0 + \"$2\"));\n                    result[i]  = jsHour + jsMinutes + \"0\";\n                    break;\n\n                case \"P\": /* Difference to Greenwich time (GMT) with colon between hours and minutes */\n                    throw '\"P\" not implemented!';\n\n                case \"T\": /* Timezone abbreviation */\n                    throw '\"T\" not implemented!';\n\n                case \"Z\": /* Timezone offset in seconds. The offset for timezones west of UTC is always negative, and for those east of UTC is always positive. */\n                    result[i] = jsDate.getTimezoneOffset() * 60;\n                    break;\n\n\n                /* FULL DATE/TIME  */\n\n                case \"c\": /* ISO 8601 date */\n                    throw '\"c\" not implemented!';\n\n                case \"r\": /* RFC 2822 formatted date  */\n                    var jsDayName = this._wDays(jsDate.getDay()).substr(0, 3);\n                    var jsMonthName = this._months(jsDate.getMonth()).substr(0, 3);\n                    result[i] = jsDayName + \", \" + jsDate.getDate() + \" \" + jsMonthName + this.get(\" Y H:i:s O\",jsDate);\n                    break;\n\n                case \"U\":  /* Seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)  */\n                    result[i] = Math.floor(jsDate.getTime() / 1000);\n                    break;\n\n                default:\n                    result[i] = iFormat[i];\n            }\n        }\n\n        return result.join('');\n\n        },\n\n        /**\n         * Creates a date object based on a format string.\n         * This works exactly as php date() function. http://php.net/manual/en/function.date.php\n         *\n         * @method set\n         * @param   {String}    [format]    The format in which the date will be formatted. Defaults to 'Y-m-d'\n         * @param   {String}    str_date    The date formatted.\n         * @return  {Date}                  Date object based on the formatted date and format\n         * @public\n         * @static\n         * @sample Ink_Util_Date_set.html \n         */\n        set : function( format , str_date ) {\n            if ( typeof str_date === 'undefined' ) { return ; }\n            if ( typeof format === 'undefined' || format === '' ) { format = \"Y-m-d\"; }\n\n            var iFormat = format.split(\"\");\n            var result = new Array( iFormat.length );\n            var escapeChar = \"\\\\\";\n            var mList;\n\n            var objIndex = {\n                year  : undefined ,\n                month : undefined ,\n                day   : undefined ,\n                dayY  : undefined ,\n                dayW  : undefined ,\n                week  : undefined ,\n                hour  : undefined ,\n                hourD : undefined ,\n                min   : undefined ,\n                sec   : undefined ,\n                msec  : undefined ,\n                ampm  : undefined ,\n                diffM : undefined ,\n                diffH : undefined ,\n                date  : undefined\n            };\n\n            var matches = 0;\n\n            /* This switch is presented in the same order as in php date function (PHP 5.2.2) */\n            for ( var i = 0; i < iFormat.length; i++) {\n                switch( iFormat[ i ] ) {\n                    case escapeChar:\n                        result[i]      = iFormat[ i + 1 ];\n                        i++;\n                        break;\n\n                    /* DAY */\n                    case \"d\":   /* Day of the month, 2 digits with leading zeros; ex: 01 to 31  */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.day   = { original : i , match : matches++ };\n                        break;\n\n                    case \"j\":  /* Day of the month without leading zeros; ex: 1 to 31  */\n                        result[ i ]    = '(\\\\d{1,2})';\n                        objIndex.day   = { original : i , match : matches++ };\n                        break;\n\n                    case \"D\":   /* A textual representation of a day, three letters; Seg to Dom */\n                        result[ i ]    = '([\\\\wá]{3})';\n                        objIndex.dayW  = { original : i , match : matches++ };\n                        break;\n\n                    case \"l\":   /* A full textual representation of the day of the week; Domingo to Sabado  */\n                        result[i]      = '([\\\\wá]{5,7})';\n                        objIndex.dayW  = { original : i , match : matches++ };\n                        break;\n\n                    case \"N\":  /* ISO-8601 numeric representation of the day of the week; 1 (Segunda) to 7 (Domingo)  */\n                        result[ i ]    = '(\\\\d)';\n                        objIndex.dayW  = { original : i , match : matches++ };\n                        break;\n\n                    case \"w\":    /* Numeric representation of the day of the week; 0 (for Sunday) through 6 (for Saturday) */\n                        result[ i ]    = '(\\\\d)';\n                        objIndex.dayW  = { original : i , match : matches++ };\n                        break;\n\n                    case \"S\":  /* English ordinal suffix for the day of the month, 2 characters; st, nd, rd or th. Works well with j */\n                        result[ i ]    = '\\\\w{2}';\n                        break;\n\n                    case \"z\":    /* The day of the year (starting from 0); 0 to 365 */\n                        result[ i ]    = '(\\\\d{1,3})';\n                        objIndex.dayY  = { original : i , match : matches++ };\n                        break;\n\n                    /* WEEK */\n                    case \"W\":    /* ISO-8601 week number of year, weeks starting on Monday; ex: 42 (the 42nd week in the year)  */\n                        result[ i ]    = '(\\\\d{1,2})';\n                        objIndex.week  = { original : i , match : matches++ };\n                        break;\n\n                    /* MONTH */\n                    case \"F\":   /* A full textual representation of a month, such as Janeiro or Marco; Janeiro a Dezembro */\n                        result[ i ]    = '([\\\\wç]{4,9})';\n                        objIndex.month = { original : i , match : matches++ };\n                        break;\n\n                    case \"M\":   /* A short textual representation of a month, three letters; Jan a Dez */\n                        result[ i ]    = '(\\\\w{3})';\n                        objIndex.month = { original : i , match : matches++ };\n                        break;\n\n                    case \"m\":   /* Numeric representation of a month, with leading zeros; 01 to 12  */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.month = { original : i , match : matches++ };\n                        break;\n\n                    case \"n\":   /* Numeric representation of a month, without leading zeros; 1 a 12  */\n                        result[ i ]    = '(\\\\d{1,2})';\n                        objIndex.month = { original : i , match : matches++ };\n                        break;\n\n                    case \"t\":   /* Number of days in the given month; ex: 28 */\n                        result[ i ]    = '\\\\d{2}';\n                        break;\n\n                    /* YEAR */\n                    case \"L\":   /* Whether it's a leap year; 1 if it is a leap year, 0 otherwise.  */\n                        result[ i ]    = '\\\\w{4,5}';\n                        break;\n\n                    case \"o\":  /* ISO-8601 year number. This has the same value as Y, except that if the ISO week number (W) belongs to the previous or next year, that year is used instead.  */\n                        throw '\"o\" not implemented!';\n\n                    case \"Y\":  /* A full numeric representation of a year, 4 digits; 1999  */\n                        result[ i ]    = '(\\\\d{4})';\n                        objIndex.year  = { original : i , match : matches++ };\n                        break;\n\n                    case \"y\":  /* A two digit representation of a year; 99  */\n                        result[ i ]    = '(\\\\d{2})';\n                        if ( typeof objIndex.year === 'undefined' || iFormat[ objIndex.year.original ] !== 'Y' ) {\n                            objIndex.year = { original : i , match : matches++ };\n                        }\n                        break;\n\n                    /* TIME */\n                    case \"a\":   /* Lowercase Ante meridiem and Post meridiem; am or pm */\n                        result[ i ]    = '(am|pm)';\n                        objIndex.ampm  = { original : i , match : matches++ };\n                        break;\n\n                    case \"A\":   /* Uppercase Ante meridiem and Post meridiem; AM or PM  */\n                        result[ i ]    = '(AM|PM)';\n                        objIndex.ampm  = { original : i , match : matches++ };\n                        break;\n\n                    case \"B\":  /* Swatch Internet time; 000 through 999  */\n                        throw '\"B\" not implemented!';\n\n                    case \"g\":   /* 12-hour format of an hour without leading zeros;  1 to 12 */\n                        result[ i ]    = '(\\\\d{1,2})';\n                        objIndex.hourD = { original : i , match : matches++ };\n                        break;\n\n                    case \"G\":   /* 24-hour format of an hour without leading zeros; 1 to 23 */\n                        result[ i ]    = '(\\\\d{1,2})';\n                        objIndex.hour  = { original : i , match : matches++ };\n                        break;\n\n                    case \"h\":   /* 12-hour format of an hour with leading zeros; 01 to 12 */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.hourD = { original : i , match : matches++ };\n                        break;\n\n                    case \"H\":   /* 24-hour format of an hour with leading zeros; 01 to 24 */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.hour  = { original : i , match : matches++ };\n                        break;\n\n                    case \"i\":   /* Minutes with leading zeros; 00 to 59 */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.min   = { original : i , match : matches++ };\n                        break;\n\n                    case \"s\":   /* Seconds with leading zeros; 00 to 59; */\n                        result[ i ]    = '(\\\\d{2})';\n                        objIndex.sec   = { original : i , match : matches++ };\n                        break;\n\n                    case \"u\":  /* Microseconds */\n                        throw '\"u\" not implemented!';\n\n                    /* TIMEZONE */\n                    case \"e\": /* Timezone identifier  */\n                        throw '\"e\" not implemented!';\n\n                    case \"I\":   /*  \"1\" if Daylight Savings Time, \"0\" otherwise. Works only on the northern hemisphere */\n                        result[i]      = '\\\\d';\n                        break;\n\n                    case \"O\":  /* Difference to Greenwich time (GMT) in hours */\n                        result[ i ]    = '([-+]\\\\d{4})';\n                        objIndex.diffH = { original : i , match : matches++ };\n                        break;\n\n                    case \"P\": /* Difference to Greenwich time (GMT) with colon between hours and minutes */\n                        throw '\"P\" not implemented!';\n\n                    case \"T\": /* Timezone abbreviation */\n                        throw '\"T\" not implemented!';\n\n                    case \"Z\": /* Timezone offset in seconds. The offset for timezones west of UTC is always negative, and for those east of UTC is always positive. */\n                        result[ i ]    = '(\\\\-?\\\\d{1,5})';\n                        objIndex.diffM = { original : i , match : matches++ };\n                        break;\n\n                    /* FULL DATE/TIME  */\n                    case \"c\": /* ISO 8601 date */\n                        throw '\"c\" not implemented!';\n\n                    case \"r\": /* RFC 2822 formatted date  */\n                        result[ i ]    = '([\\\\wá]{3}, \\\\d{1,2} \\\\w{3} \\\\d{4} \\\\d{2}:\\\\d{2}:\\\\d{2} [+\\\\-]\\\\d{4})';\n                        objIndex.date  = { original : i , match : matches++ };\n                        break;\n\n                    case \"U\":  /* Seconds since the Unix Epoch (January 1 1970 00:00:00 GMT)  */\n                        result[ i ]    = '(\\\\d{1,13})';\n                        objIndex.date  = { original : i , match : matches++ };\n                        break;\n\n                    default:\n                        result[ i ]    = iFormat[ i ];\n                }\n            }\n\n            var pattr = new RegExp( result.join('') );\n\n            try {\n                mList = str_date.match( pattr );\n                if ( !mList ) { return; }\n            }\n            catch ( e ) { return ; }\n\n            var _haveDatetime = typeof objIndex.date  !== 'undefined';\n\n            var _haveYear     = typeof objIndex.year  !== 'undefined';\n\n            var _haveYDay     = typeof objIndex.dayY  !== 'undefined';\n\n            var _haveDay      = typeof objIndex.day   !== 'undefined';\n            var _haveMonth    = typeof objIndex.month !== 'undefined';\n            var _haveMonthDay =  _haveMonth && _haveDay;\n            var _haveOnlyDay  = !_haveMonth && _haveDay;\n\n            var _haveWDay     = typeof objIndex.dayW  !== 'undefined';\n            var _haveWeek     = typeof objIndex.week  !== 'undefined';\n            var _haveWeekWDay =  _haveWeek && _haveWDay;\n            var _haveOnlyWDay = !_haveWeek && _haveWDay;\n\n            var _validDate    = _haveYDay || _haveMonthDay || !_haveYear && _haveOnlyDay || _haveWeekWDay || !_haveYear && _haveOnlyWDay;\n            var _noDate       = !_haveYear && !_haveYDay && !_haveDay && !_haveMonth && !_haveWDay && !_haveWeek;\n\n            var _haveHour12   = typeof objIndex.hourD !== 'undefined' && typeof objIndex.ampm !== 'undefined';\n            var _haveHour24   = typeof objIndex.hour  !== 'undefined';\n            var _haveHour     = _haveHour12 || _haveHour24;\n\n            var _haveMin      = typeof objIndex.min   !== 'undefined';\n            var _haveSec      = typeof objIndex.sec   !== 'undefined';\n            var _haveMSec     = typeof objIndex.msec  !== 'undefined';\n\n            var _haveMoreM    = !_noDate || _haveHour;\n            var _haveMoreS    = _haveMoreM || _haveMin;\n\n            var _haveDiffM    = typeof objIndex.diffM !== 'undefined';\n            var _haveDiffH    = typeof objIndex.diffH !== 'undefined';\n            //var _haveGMT      = _haveDiffM || _haveDiffH;\n            var hour;\n            var min;\n\n            if ( _haveDatetime ) {\n                if ( iFormat[ objIndex.date.original ] === 'U' ) {\n                    return new Date( +mList[ objIndex.date.match + 1 ] * 1000 );\n                }\n\n                var dList = mList[ objIndex.date.match + 1 ].match( /\\w{3}, (\\d{1,2}) (\\w{3}) (\\d{4}) (\\d{2}):(\\d{2}):(\\d{2}) ([+\\-]\\d{4})/ );\n                hour  = +dList[ 4 ] + ( +dList[ 7 ].slice( 0 , 3 ) );\n                min   = +dList[ 5 ] + ( dList[ 7 ].slice( 0 , 1 ) + dList[ 7 ].slice( 3 ) ) / 100 * 60;\n\n                return new Date( dList[ 3 ] , this._iMonth( dList[ 2 ] ) , dList[ 1 ] , hour  , min , dList[ 6 ] );\n            }\n\n            var _d = new Date( );\n            var year;\n            var month;\n            var day;\n            var sec;\n            var msec;\n            var gmt;\n\n            if ( !_validDate && !_noDate ) { return ; }\n\n            if ( _validDate ) {\n                if ( _haveYear ) {\n                    var _y = _d.getFullYear( ) - 50 + '';\n                    year   = mList[ objIndex.year.match + 1 ];\n                    if ( iFormat[ objIndex.year.original ] === 'y' ) {\n                        year = +_y.slice( 0 , 2 ) + ( year >= ( _y ).slice( 2 ) ? 0 : 1 ) + year;\n                    }\n                } else {\n                    year = _d.getFullYear();\n                }\n\n                if ( _haveYDay ) {\n                    month = 0;\n                    day   = mList[ objIndex.dayY.match + 1 ];\n                } else if ( _haveDay ) {\n                    if ( _haveMonth ) {\n                        month = this._iMonth( mList[ objIndex.month.match + 1 ] );\n                    } else {\n                        month = _d.getMonth( );\n                    }\n\n                    day = mList[ objIndex.day.match + 1 ];\n                } else {\n                    month = 0;\n\n                    var week;\n                    if ( _haveWeek ) {\n                        week = mList[ objIndex.week.match + 1 ];\n                    } else {\n                        week = this.get( 'W' , _d );\n                    }\n\n                    day = ( week - 2 ) * 7 + ( 8 - ( ( new Date( year , 0 , 1 ) ).getDay( ) || 7 ) ) + this._iWeek( mList[ objIndex.week.match + 1 ] );\n                }\n\n                if ( month === 0 && day > 31 ) {\n                    var aux = new Date( year , month , day );\n                    month   = aux.getMonth( );\n                    day     = aux.getDate( );\n                }\n            }\n            else {\n                year  = _d.getFullYear( );\n                month = _d.getMonth( );\n                day   = _d.getDate( );\n            }\n\n            if      ( _haveHour12 ) { hour = +mList[ objIndex.hourD.match + 1 ] + ( mList[ objIndex.ampm.match + 1 ] === 'pm' ? 12 : 0 ); }\n            else if ( _haveHour24 ) { hour = mList[ objIndex.hour.match + 1 ]; }\n            else if ( _noDate     ) { hour = _d.getHours( ); }\n            else                    { hour = '00'; }\n\n            if      (  _haveMin   ) { min  = mList[ objIndex.min.match + 1 ]; }\n            else if ( !_haveMoreM ) { min  = _d.getMinutes( ); }\n            else                    { min  = '00'; }\n\n            if      (  _haveSec   ) { sec  = mList[ objIndex.sec.match + 1 ]; }\n            else if ( !_haveMoreS ) { sec  = _d.getSeconds( ); }\n            else                    { sec  = '00'; }\n\n            if      ( _haveMSec )   { msec = mList[ objIndex.msec.match + 1 ]; }\n            else                    { msec = '000'; }\n\n            if      ( _haveDiffH )  { gmt  = mList[ objIndex.diffH.match + 1 ]; }\n            else if ( _haveDiffM )  { gmt  = String( -1 * mList[ objIndex.diffM.match + 1 ] / 60 * 100 ).replace( /^(\\d)/ , '+$1' ).replace( /(^[\\-+])(\\d{3}$)/ , '$10$2' ); }\n            else                    { gmt  = '+0000'; }\n\n            return new Date( year, month, day, hour, min, sec );\n        }\n    };\n\n\n    return InkDate;\n\n});\n","/**\n * Dump/Profiling Utilities\n * @module Ink.Util.Dumper_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Dumper', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.Dumper_1 \n     */\n\n    var Dumper = {\n\n        /**\n         * Hex code for the 'tab'\n         * \n         * @property _tab\n         * @type {String}\n         * @private\n         * @readOnly\n         * @static\n         *\n         */\n        _tab: '\\xA0\\xA0\\xA0\\xA0',\n\n        /**\n         * Function that returns the argument passed formatted\n         *\n         * @method _formatParam\n         * @param {Mixed} param The thing to format.\n         * @return {String} The argument passed formatted\n         * @private\n         * @static\n         */\n        _formatParam: function(param)\n        {\n            var formated = '';\n\n            switch(typeof(param)) {\n                case 'string':\n                    formated = '(string) '+param;\n                    break;\n                case 'number':\n                    formated = '(number) '+param;\n                    break;\n                case 'boolean':\n                    formated = '(boolean) '+param;\n                    break;\n                case 'object':\n                    if(param !== null) {\n                        if(param.constructor === Array) {\n                            formated = 'Array \\n{\\n' + this._outputFormat(param, 0) + '\\n}';\n                        } else {\n                            formated = 'Object \\n{\\n' + this._outputFormat(param, 0) + '\\n}';\n                        }\n                    } else {\n                        formated = 'null';\n                    }\n                    break;\n                default:\n                    formated = false;\n            }\n\n            return formated;\n        },\n\n        /**\n         * Function that returns the tabs concatenated\n         *\n         * @method _getTabs\n         * @param {Number} numberOfTabs Number of Tabs\n         * @return {String} Tabs concatenated\n         * @private\n         * @static\n         */\n        _getTabs: function(numberOfTabs)\n        {\n            var tabs = '';\n            for(var _i = 0; _i < numberOfTabs; _i++) {\n                tabs += this._tab;\n            }\n            return tabs;\n        },\n\n        /**\n         * Function that formats the parameter to display.\n         *\n         * @method _outputFormat\n         * @param {Mixed} param The thing to format.\n         * @param {Number} indent Indentation level.\n         * @return {String} The parameter passed formatted to displat\n         * @private\n         * @static\n         */\n        _outputFormat: function(param, indent)\n        {\n            var formated = '';\n            //var _strVal = false;\n            var _typeof = false;\n            for(var key in param) {\n                if(param[key] !== null) {\n                    if(typeof(param[key]) === 'object' && (param[key].constructor === Array || param[key].constructor === Object)) {\n                        if(param[key].constructor === Array) {\n                            _typeof = 'Array';\n                        } else if(param[key].constructor === Object) {\n                            _typeof = 'Object';\n                        }\n                        formated += this._tab + this._getTabs(indent) + '[' + key + '] => <b>'+_typeof+'</b>\\n';\n                        formated += this._tab + this._getTabs(indent) + '{\\n';\n                        formated += this._outputFormat(param[key], indent + 1) + this._tab + this._getTabs(indent) + '}\\n';\n                    } else if(param[key].constructor === Function) {\n                        continue;\n                    } else {\n                        formated = formated + this._tab + this._getTabs(indent) + '[' + key + '] => ' + param[key] + '\\n';\n                    }\n                } else {\n                    formated = formated + this._tab + this._getTabs(indent) + '[' + key + '] => null \\n';\n                }\n            }\n            return formated;\n        },\n\n        /**\n         * Prints variable structure.\n         *\n         * @method printDump\n         * @param {Mixed}                 param       Variable to be dumped.\n         * @param {DOMElement|String}   [target]    Element to print the dump on.\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Dumper_printDump.html \n         */\n        printDump: function(param, target)\n        {\n            /*jshint evil:true */\n            if(!target || typeof(target) === 'undefined') {\n                document.write('<pre>'+this._formatParam(param)+'</pre>');\n            } else {\n                if(typeof(target) === 'string') {\n                    document.getElementById(target).innerHTML = '<pre>' + this._formatParam(param) + '</pre>';\n                } else if(typeof(target) === 'object') {\n                    target.innerHTML = '<pre>'+this._formatParam(param)+'</pre>';\n                } else {\n                    throw \"TARGET must be an element or an element ID\";\n                }\n            }\n        },\n\n        /**\n         * Get a variable's structure.\n         *\n         * @method returnDump\n         * @param   {Mixed}       param   Variable to get the structure.\n         * @return  {String}      The variable's structure.\n         * @public\n         * @static\n         * @sample Ink_Util_Dumper_returnDump.html \n         */\n        returnDump: function(param)\n        {\n            return this._formatParam(param);\n        },\n\n        /**\n         * Alert a variable's structure.\n         *\n         * @method alertDump\n         * @param {Mixed}     param     Variable to be dumped.\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Dumper_alertDump.html \n         */\n        alertDump: function(param)\n        {\n            window.alert(this._formatParam(param).replace(/(<b>)(Array|Object)(<\\/b>)/g, \"$2\"));\n        },\n\n        /**\n         * Prints the variable structure to a new window.\n         *\n         * @method windowDump\n         * @param {Mixed}     param   Variable to be dumped.\n         * @return {void}\n         * @public\n         * @static\n         * @sample Ink_Util_Dumper_windowDump.html \n         */\n        windowDump: function(param)\n        {\n            var dumperwindow = 'dumperwindow_'+(Math.random() * 10000);\n            var win = window.open('',\n                dumperwindow,\n                'width=400,height=300,left=50,top=50,status,menubar,scrollbars,resizable'\n            );\n            win.document.open();\n            win.document.write('<pre>'+this._formatParam(param)+'</pre>');\n            win.document.close();\n            win.focus();\n        }\n\n    };\n\n    return Dumper;\n\n});\n","/**\n * Internationalization Utilities \n * @module Ink.Util.I18n_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.I18n', '1', [], function () {\n    'use strict';\n\n    var pattrText = /\\{(?:(\\{.*?})|(?:%s:)?(\\d+)|(?:%s)?|([\\w-]+))}/g;\n\n    var funcOrVal = function( ret , args ) {\n        if ( typeof ret === 'function' ) {\n            return ret.apply(this, args);\n        } else if (typeof ret !== undefined) {\n            return ret;\n        } else {\n            return '';\n        }\n    };\n\n    /**\n     * You can use this module to internationalize your applications. It roughly emulates GNU gettext's API.\n     *\n     * @class Ink.Util.I18n\n     * @constructor\n     *\n     * @param {Object} dict         Object mapping language codes (in the form of `pt_PT`, `pt_BR`, `fr`, `en_US`, etc.) to their `dictionaries`\n     * @param {String} [lang='pt_PT'] language code of the target language\n     * @param {Boolean} [testMode=false] Sets the test mode (see `testMode()`) on construction.\n     *\n     * @sample Ink_Util_I18n_1.html\n     */\n    var I18n = function( dict , lang , testMode ) {\n        if ( !( this instanceof I18n ) ) { return new I18n( dict , lang , testMode ); }\n\n        this.reset( )\n            .lang( lang )\n            .testMode( testMode )\n            .append( dict || { } , lang );\n    };\n\n    I18n.prototype = {\n        reset: function( ) {\n            this._dicts    = [ ];\n            this._dict     = { };\n            this._testMode = false;\n            this._lang     = this._gLang;\n\n            return this;\n        },\n        /**\n         * Adds translation strings for the helper to use.\n         *\n         * @method append\n         * @param   {Object} dict Object containing language objects identified by their language code\n         * @return {I18n} (itself)\n         *\n         * @sample Ink_Util_I18n_1_append.html\n         */\n        append: function( dict ) {\n            this._dicts.push( dict );\n\n            this._dict = Ink.extendObj(this._dict , dict[ this._lang ] );\n\n            return this;\n        },\n        /**\n         * Gets or sets the language.\n         * If there are more dictionaries available in cache, they will be loaded.\n         *\n         * @method lang\n         * @param  {String}    [lang]    Language code to set this instance to. Omit this argument if you want to get the language code instead.\n         * @return {String|I18n} The language code, if called without arguments, or this I18n instance if called with an argument.\n         */\n        lang: function( lang ) {\n            if ( !arguments.length ) { return this._lang; }\n\n            if ( lang && this._lang !== lang ) {\n                this._lang = lang;\n\n                this._dict = { };\n\n                for ( var i = 0, l = this._dicts.length; i < l; i++ ) {\n                    this._dict = Ink.extendObj( this._dict , this._dicts[ i ][ lang ] || { } );\n                }\n            }\n\n            return this;\n        },\n        /**\n         * Sets or unsets test mode.\n         * In test mode, unknown strings are wrapped in `[ ... ]`. This is useful for debugging your application and to make sure all your translation keys are in place.\n         *\n         * @method  testMode\n         * @param   {Boolean} [newTestMode] Flag to set the test mode state. Omit this argument to *get* the current testMode instead.\n         * @return {String|I18n} The current testMode, if called without arguments, or this I18n instance if called with an argument.\n         *\n         */\n        testMode: function( newTestMode ) {\n            if ( !arguments.length ) { return !!this._testMode; }\n\n            if ( newTestMode !== undefined  ) { this._testMode = !!newTestMode; }\n\n            return this;\n        },\n\n        /**\n         * Gest a key from the current dictionary\n         *\n         * @method getKey\n         * @param {String} key Key you wish to get from the dictionary.\n         * @return {Mixed} The object which happened to be in the current language dictionary on the given key.\n         *\n         * @sample Ink_Util_I18n_1_getKey.html\n         */\n        getKey: function( key ) {\n            var ret;\n            var gLang = this._gLang;\n            var lang  = this._lang;\n    \n            if ( key in this._dict ) {\n                ret = this._dict[ key ];\n            } else {\n                I18n.langGlobal( lang );\n    \n                ret = this._gDict[ key ];\n    \n                I18n.langGlobal( gLang );\n            }\n    \n            return ret;\n        },\n\n        /**\n         * Translates a string.\n         * Given a translation key, return a translated string, with replaced parameters.\n         * When a translated string is not available, the original string is returned unchanged.\n         *\n         * @method text\n         * @param {String} str          Key to look for in i18n dictionary (which is returned verbatim if unknown)\n         * @param {Object} [namedParms] Named replacements. Replaces {named} with values in this object.\n         * @param {String} [args]      Replacement #1 (replaces first {} and all {1})\n         * @param {String} [arg2]       Replacement #2 (replaces second {} and all {2})\n         * @param {String} [argn...]      Replacement #n (replaces nth {} and all {n})\n         *\n         * @return {String} Translated string.\n         *\n         * @sample Ink_Util_I18n_1_text.html\n         */\n        text: function( str /*, replacements...*/ ) {\n            if ( typeof str !== 'string' ) { return; } // Backwards-compat\n\n            var pars = Array.prototype.slice.call( arguments , 1 );\n            var idx = 0;\n            var isObj = typeof pars[ 0 ] === 'object';\n\n            var original = this.getKey( str );\n            if ( original === undefined ) { original = this._testMode ? '[' + str + ']' : str; }\n            if ( typeof original === 'number' ) { original += ''; }\n\n            if (typeof original === 'string') {\n                original = original.replace( pattrText , function( m , $1 , $2 , $3 ) {\n                    var ret =\n                        $1 ? $1 :\n                        $2 ? pars[ $2 - ( isObj ? 0 : 1 ) ] :\n                        $3 ? pars[ 0 ][ $3 ] || '' :\n                             pars[ (idx++) + ( isObj ? 1 : 0 ) ];\n                    return funcOrVal( ret , [idx].concat(pars) );\n                });\n                return original;\n            }\n             \n            return (\n                typeof original === 'function' ? original.apply( this , pars ) :\n                original instanceof Array      ? funcOrVal( original[ pars[ 0 ] ] , pars ) :\n                typeof original === 'object'   ? funcOrVal( original[ pars[ 0 ] ] , pars ) :\n                                                 '');\n        },\n\n        /**\n         * Translates and pluralizes text.\n         * Given a singular string, a plural string and a number, translates either the singular or plural string.\n         *\n         * @method ntext\n         *\n         * @param {String} strSin   Word to use when count is 1\n         * @param {String} strPlur  Word to use otherwise\n         * @param {Number} count    Number which defines which word to use\n         * @param {Mixed} [args...] Extra arguments, to be passed to `text()`\n         *\n         * @return {String} Pluralized text string.\n         *\n         * @sample Ink_Util_I18n_1_ntext.html\n         */\n        ntext: function( strSin , strPlur , count ) {\n            var pars = Array.prototype.slice.apply( arguments );\n            var original;\n\n            if ( pars.length === 2 && typeof strPlur === 'number' ) {\n                original = this.getKey( strSin );\n                if ( !( original instanceof Array ) ) { return ''; }\n\n                pars.splice( 0 , 1 );\n                original = original[ strPlur === 1 ? 0 : 1 ];\n            } else {\n                pars.splice( 0 , 2 );\n                original = count === 1 ? strSin : strPlur;\n            }\n\n            return this.text.apply( this , [ original ].concat( pars ) );\n        },\n\n        /**\n         * Gets the ordinal suffix of a number.\n         *\n         * This works by using transforms (in the form of Objects or Functions) passed into the function or found in the special key `_ordinals` in the active language dictionary.\n         *\n         * @method ordinal\n         *\n         * @param {Number}          num                         Input number\n         * @param {Object|Function} [options]={}                Dictionaries for translating. Each of these options' fallback is found in the current language's dictionary. The lookup order is the following: `exceptions`, `byLastDigit`, `default`. Each of these may be either an `Object` or a `Function`. If it's a function, it is called (with `number` and `digit` for any function except for byLastDigit, which is called with the `lastDigit` of the number in question), and if the function returns a string, that is used. If it's an object, the property is looked up using `obj[prop]`. If what is found is a string, it is used directly.\n         * @param {Object|Function} [options.byLastDigit]={}    If the language requires the last digit to be considered, mappings of last digits to ordinal suffixes can be created here.\n         * @param {Object|Function} [options.exceptions]={}     Map unique, special cases to their ordinal suffixes.\n         *\n         * @returns {String}        Ordinal suffix for `num`.\n         *\n         * @sample Ink_Util_I18n_1_ordinal.html\n         **/\n        ordinal: function( num ) {\n            if ( num === undefined ) { return ''; }\n\n            var lastDig = +num.toString( ).slice( -1 );\n\n            var ordDict  = this.getKey( '_ordinals' );\n            if ( ordDict === undefined ) { return ''; }\n\n            if ( typeof ordDict === 'string' ) { return ordDict; }\n\n            var ret;\n\n            if ( typeof ordDict === 'function' ) {\n                ret = ordDict( num , lastDig );\n\n                if ( typeof ret === 'string' ) { return ret; }\n            }\n\n            if ( 'exceptions' in ordDict ) {\n                ret = typeof ordDict.exceptions === 'function' ? ordDict.exceptions( num , lastDig ) :\n                      num in ordDict.exceptions                ? funcOrVal( ordDict.exceptions[ num ] , [num , lastDig] ) :\n                                                                 undefined;\n\n                if ( typeof ret === 'string' ) { return ret; }\n            }\n\n            if ( 'byLastDigit' in ordDict ) {\n                ret = typeof ordDict.byLastDigit === 'function' ? ordDict.byLastDigit( lastDig , num ) :\n                      lastDig in ordDict.byLastDigit            ? funcOrVal( ordDict.byLastDigit[ lastDig ] , [lastDig , num] ) :\n                                                                  undefined;\n\n                if ( typeof ret === 'string' ) { return ret; }\n            }\n\n            if ( 'default' in ordDict ) {\n                ret = funcOrVal( ordDict['default'] , [ num , lastDig ] );\n\n                if ( typeof ret === 'string' ) { return ret; }\n            }\n\n            return '';\n        },\n\n        /**\n         * Create an alias.\n         *\n         * Returns an alias to this I18n instance. It contains the I18n methods documented here, but is also a function. If you call it, it just calls `text()`. This is commonly assigned to \"_\".\n         *\n         * @method alias\n         * @returns {Function} an alias to `text()` on this instance. You can also access the rest of the translation API through this alias.\n         *\n         * @sample Ink_Util_I18n_1_alias.html\n         */\n        alias: function( ) {\n            var ret      = Ink.bind( I18n.prototype.text     , this );\n            ret.ntext    = Ink.bind( I18n.prototype.ntext    , this );\n            ret.append   = Ink.bind( I18n.prototype.append   , this );\n            ret.ordinal  = Ink.bind( I18n.prototype.ordinal  , this );\n            ret.testMode = Ink.bind( I18n.prototype.testMode , this );\n\n            return ret;\n        }\n    };\n\n    /**\n     * Resets I18n global state (global dictionaries, and default language for instances)\n     *\n     * @method reset\n     * @return {void}\n     * @static\n     *\n     **/\n    I18n.reset = function( ) {\n        I18n.prototype._gDicts = [ ];\n        I18n.prototype._gDict  = { };\n        I18n.prototype._gLang  = 'pt_PT';\n    };\n    I18n.reset( );\n\n    /**\n     * Adds a dictionary to be used in all I18n instances for the corresponding language.\n     *\n     * @method appendGlobal\n     * @static\n     *\n     * @param {Object} dict Dictionary to be added\n     * @param {String} lang Language fo the dictionary being added\n     * @return {void}\n     *\n     */\n    I18n.appendGlobal = function( dict , lang ) {\n        if ( lang ) {\n            if ( !( lang in dict ) ) {\n                var obj = { };\n\n                obj[ lang ] = dict;\n\n                dict = obj;\n            }\n\n            if ( lang !== I18n.prototype._gLang ) { I18n.langGlobal( lang ); }\n        }\n\n        I18n.prototype._gDicts.push( dict );\n\n        Ink.extendObj( I18n.prototype._gDict , dict[ I18n.prototype._gLang ] );\n    };\n\n    /**\n     * Gets or sets the current default language of I18n instances.\n     *\n     * @method langGlobal\n     * @param {String} [lang] the new language for all I18n instances. Omit this argument if you wish to *get* the current default language instead.\n     *\n     * @static\n     *\n     * @return {String} language code, or nothing if not used as a setter.\n     */\n    I18n.langGlobal = function( lang ) {\n        if ( !arguments.length ) { return I18n.prototype._gLang; }\n\n        if ( lang && I18n.prototype._gLang !== lang ) {\n            I18n.prototype._gLang = lang;\n\n            I18n.prototype._gDict = { };\n\n            for ( var i = 0, l = I18n.prototype._gDicts.length; i < l; i++ ) {\n                Ink.extendObj( I18n.prototype._gDict , I18n.prototype._gDicts[ i ][ lang ] || { } );\n            }\n        }\n    };\n\n    return I18n;\n});","/**\n * JSON Utilities\n * @module Ink.Util.Json_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Json', '1', [], function() {\n    'use strict';\n\n    var function_call = Function.prototype.call;\n    var cx = /[\\u0000\\u00ad\\u0600-\\u0604\\u070f\\u17b4\\u17b5\\u200c-\\u200f\\u2028-\\u202f\\u2060-\\u206f\\ufeff\\ufff0-\\uffff]/g;\n\n    function twoDigits(n) {\n        var r = '' + n;\n        if (r.length === 1) {\n            return '0' + r;\n        } else {\n            return r;\n        }\n    }\n\n    var dateToISOString = Date.prototype.toISOString ?\n        Ink.bind(function_call, Date.prototype.toISOString) :\n        function(date) {\n            // Adapted from https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString\n            return date.getUTCFullYear() +\n                '-' + twoDigits( date.getUTCMonth() + 1 ) +\n                '-' + twoDigits( date.getUTCDate() ) +\n                'T' + twoDigits( date.getUTCHours() ) +\n                ':' + twoDigits( date.getUTCMinutes() ) +\n                ':' + twoDigits( date.getUTCSeconds() ) +\n                '.' + String( (date.getUTCMilliseconds()/1000).toFixed(3) ).slice( 2, 5 ) +\n                'Z';\n        };\n\n    /**\n     * Use this class to convert JSON strings to JavaScript objects\n     * `.parse()` and also to do the opposite operation `.stringify()`.\n     * Internally, the standard JSON implementation is used if available\n     * Otherwise, the functions mimic the standard implementation.\n     *\n     * Here's how to produce JSON from an existing object:\n     * \n     *      Ink.requireModules(['Ink.Util.Json_1'], function (Json) {\n     *          var obj = {\n     *              key1: 'value1',\n     *              key2: 'value2',\n     *              keyArray: ['arrayValue1', 'arrayValue2', 'arrayValue3']\n     *          };\n     *          Json.stringify(obj);  // The above object as a JSON string\n     *      });\n     *\n     * And here is how to parse JSON:\n     *\n     *      Ink.requireModules(['Ink.Util.Json_1'], function (Json) {\n     *          var source = '{\"key\": \"value\", \"array\": [true, null, false]}';\n     *          Json.parse(source);  // The above JSON string as an object\n     *      });\n     *\n     * @namespace Ink.Util.Json_1 \n     * @static\n     * \n     */\n    var InkJson = {\n        _nativeJSON: window.JSON || null,\n\n        _convertToUnicode: false,\n\n        // Escape characters so as to embed them in JSON strings\n        _escape: function (theString) {\n            var _m = { '\\b': '\\\\b', '\\t': '\\\\t', '\\n': '\\\\n', '\\f': '\\\\f', '\\r': '\\\\r', '\"': '\\\\\"',  '\\\\': '\\\\\\\\' };\n\n            if (/[\"\\\\\\x00-\\x1f]/.test(theString)) {\n                theString = theString.replace(/([\\x00-\\x1f\\\\\"])/g, function(a, b) {\n                    var c = _m[b];\n                    if (c) {\n                        return c;\n                    }\n                    c = b.charCodeAt();\n                    return '\\\\u00' + Math.floor(c / 16).toString(16) + (c % 16).toString(16);\n                });\n            }\n\n            return theString;\n        },\n\n        // A character conversion map\n        _toUnicode: function (theString)\n        {\n            if(!this._convertToUnicode) {\n                return this._escape(theString);\n            } else {\n                var unicodeString = '';\n                var inInt = false;\n                var theUnicode = false;\n                var i = 0;\n                var total = theString.length;\n                while(i < total) {\n                    inInt = theString.charCodeAt(i);\n                    if( (inInt >= 32 && inInt <= 126) ||\n                            //(inInt >= 48 && inInt <= 57) ||\n                            //(inInt >= 65 && inInt <= 90) ||\n                            //(inInt >= 97 && inInt <= 122) ||\n                            inInt === 8 ||\n                            inInt === 9 ||\n                            inInt === 10 ||\n                            inInt === 12 ||\n                            inInt === 13 ||\n                            inInt === 32 ||\n                            inInt === 34 ||\n                            inInt === 47 ||\n                            inInt === 58 ||\n                            inInt === 92) {\n\n                        if(inInt === 34 || inInt === 92 || inInt === 47) {\n                            theUnicode = '\\\\'+theString.charAt(i);\n                        } else if(inInt === 8) {\n                            theUnicode = '\\\\b';\n                        } else if(inInt === 9) {\n                            theUnicode = '\\\\t';\n                        } else if(inInt === 10) {\n                            theUnicode = '\\\\n';\n                        } else if(inInt === 12) {\n                            theUnicode = '\\\\f';\n                        } else if(inInt === 13) {\n                            theUnicode = '\\\\r';\n                        } else {\n                            theUnicode = theString.charAt(i);\n                        }\n                    } else {\n                        if(this._convertToUnicode) {\n                            theUnicode = theString.charCodeAt(i).toString(16)+''.toUpperCase();\n                            while (theUnicode.length < 4) {\n                                theUnicode = '0' + theUnicode;\n                            }\n                            theUnicode = '\\\\u' + theUnicode;\n                        } else {\n                            theUnicode = theString.charAt(i);\n                        }\n                    }\n                    unicodeString += theUnicode;\n\n                    i++;\n                }\n\n                return unicodeString;\n            }\n\n        },\n\n        _stringifyValue: function(param) {\n            if (typeof param === 'string') {\n                return '\"' + this._toUnicode(param) + '\"';\n            } else if (typeof param === 'number' && (isNaN(param) || !isFinite(param))) {  // Unusable numbers go null\n                return 'null';\n            } else if (typeof param === 'undefined' || param === null) {  // And so does undefined\n                return 'null';\n            } else if (typeof param.toJSON === 'function') {\n                var t = param.toJSON();\n                if (typeof t === 'string') {\n                    return '\"' + this._escape(t) + '\"';\n                } else {\n                    return this._escape(t.toString());\n                }\n            } else if (typeof param === 'number' || typeof param === 'boolean') {  // These ones' toString methods return valid JSON.\n                return '' + param;\n            } else if (typeof param === 'function') {\n                return 'null';  // match JSON.stringify\n            } else if (param.constructor === Date) {\n                return '\"' + this._escape(dateToISOString(param)) + '\"';\n            } else if (param.constructor === Array) {\n                var arrayString = '';\n                for (var i = 0, len = param.length; i < len; i++) {\n                    if (i > 0) {\n                        arrayString += ',';\n                    }\n                    arrayString += this._stringifyValue(param[i]);\n                }\n                return '[' + arrayString + ']';\n            } else {  // Object\n                var objectString = '';\n                for (var k in param)  {\n                    if ({}.hasOwnProperty.call(param, k)) {\n                        if (objectString !== '') {\n                            objectString += ',';\n                        }\n                        objectString += '\"' + this._escape(k) + '\": ' + this._stringifyValue(param[k]);\n                    }\n                }\n                return '{' + objectString + '}';\n            }\n        },\n\n        /**\n         * Serializes a JSON object into a string.\n         *\n         * @method stringify\n         * @param   {Object}      input                 Data to be serialized into JSON\n         * @param   {Boolean}     convertToUnicode      When `true`, converts string contents to unicode \\uXXXX\n         * @return  {String}                            Serialized string\n         *\n         * @sample Ink_Util_Json_stringify.html \n         */\n        stringify: function(input, convertToUnicode) {\n            this._convertToUnicode = !!convertToUnicode;\n            if(!this._convertToUnicode && this._nativeJSON) {\n                return this._nativeJSON.stringify(input);\n            }\n            return this._stringifyValue(input);  // And recurse.\n        },\n        \n        /**\n         * Parses a JSON text through a function\n         * \n         * @method parse\n         * @param text      {String}    Input string\n         * @param reviver   {Function}  Function receiving `(key, value)`, and `this`=(containing object), used to walk objects.\n         * \n         * @return {Object}             JSON object\n         *\n         * @sample Ink_Util_Json_parse.html \n         */\n        /* From https://github.com/douglascrockford/JSON-js/blob/master/json.js */\n        parse: function (text, reviver) {\n            /*jshint evil:true*/\n\n// The parse method takes a text and an optional reviver function, and returns\n// a JavaScript value if the text is a valid JSON text.\n\n            var j;\n\n            function walk(holder, key) {\n\n// The walk method is used to recursively walk the resulting structure so\n// that modifications can be made.\n\n                var k, v, value = holder[key];\n                if (value && typeof value === 'object') {\n                    for (k in value) {\n                        if (Object.prototype.hasOwnProperty.call(value, k)) {\n                            v = walk(value, k);\n                            if (v !== undefined) {\n                                value[k] = v;\n                            } else {\n                                delete value[k];\n                            }\n                        }\n                    }\n                }\n                return reviver.call(holder, key, value);\n            }\n\n\n// Parsing happens in four stages. In the first stage, we replace certain\n// Unicode characters with escape sequences. JavaScript handles many characters\n// incorrectly, either silently deleting them, or treating them as line endings.\n\n            text = String(text);\n            cx.lastIndex = 0;\n            if (cx.test(text)) {\n                text = text.replace(cx, function (a) {\n                    return '\\\\u' +\n                        ('0000' + a.charCodeAt(0).toString(16)).slice(-4);\n                });\n            }\n\n// In the second stage, we run the text against regular expressions that look\n// for non-JSON patterns. We are especially concerned with '()' and 'new'\n// because they can cause invocation, and '=' because it can cause mutation.\n// But just to be safe, we want to reject all unexpected forms.\n\n// We split the second stage into 4 regexp operations in order to work around\n// crippling inefficiencies in IE's and Safari's regexp engines. First we\n// replace the JSON backslash pairs with '@' (a non-JSON character). Second, we\n// replace all simple value tokens with ']' characters. Third, we delete all\n// open brackets that follow a colon or comma or that begin the text. Finally,\n// we look to see that the remaining characters are only whitespace or ']' or\n// ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.\n\n            if (/^[\\],:{}\\s]*$/\n                    .test(text.replace(/\\\\(?:[\"\\\\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')\n                        .replace(/\"[^\"\\\\\\n\\r]*\"|true|false|null|-?\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d+)?/g, ']')\n                        .replace(/(?:^|:|,)(?:\\s*\\[)+/g, ''))) {\n\n// In the third stage we use the eval function to compile the text into a\n// JavaScript structure. The '{' operator is subject to a syntactic ambiguity\n// in JavaScript: it can begin a block or an object literal. We wrap the text\n// in parens to eliminate the ambiguity.\n\n                j = eval('(' + text + ')');\n\n// In the optional fourth stage, we recursively walk the new structure, passing\n// each name/value pair to a reviver function for possible transformation.\n\n                return typeof reviver === 'function' ?\n                    walk({'': j}, '') :\n                    j;\n            }\n\n// If the text is not JSON parseable, then a SyntaxError is thrown.\n\n            throw new SyntaxError('JSON.parse');\n        }\n    };\n\n    return InkJson;\n});\n","/**\n * String Utilities\n * @module Ink.Util.String_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.String', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.String_1 \n     */\n    var InkUtilString = {\n\n        /**\n         * List of special chars\n         * \n         * @property _chars\n         * @type {Array}\n         * @private\n         * @readOnly\n         * @static\n         */\n        _chars: ['&','à','á','â','ã','ä','å','æ','ç','è','é',\n                'ê','ë','ì','í','î','ï','ð','ñ','ò','ó','ô',\n                'õ','ö','ø','ù','ú','û','ü','ý','þ','ÿ','À',\n                'Á','Â','Ã','Ä','Å','Æ','Ç','È','É','Ê','Ë',\n                'Ì','Í','Î','Ï','Ð','Ñ','Ò','Ó','Ô','Õ','Ö',\n                'Ø','Ù','Ú','Û','Ü','Ý','Þ','€','\\\"','ß','<',\n                '>','¢','£','¤','¥','¦','§','¨','©','ª','«',\n                '¬','\\xad','®','¯','°','±','²','³','´','µ','¶',\n                '·','¸','¹','º','»','¼','½','¾'],\n\n        /**\n         * List of the special characters' html entities\n         * \n         * @property _entities\n         * @type {Array}\n         * @private\n         * @readOnly\n         * @static\n         */\n        _entities: ['amp','agrave','aacute','acirc','atilde','auml','aring',\n                    'aelig','ccedil','egrave','eacute','ecirc','euml','igrave',\n                    'iacute','icirc','iuml','eth','ntilde','ograve','oacute',\n                    'ocirc','otilde','ouml','oslash','ugrave','uacute','ucirc',\n                    'uuml','yacute','thorn','yuml','Agrave','Aacute','Acirc',\n                    'Atilde','Auml','Aring','AElig','Ccedil','Egrave','Eacute',\n                    'Ecirc','Euml','Igrave','Iacute','Icirc','Iuml','ETH','Ntilde',\n                    'Ograve','Oacute','Ocirc','Otilde','Ouml','Oslash','Ugrave',\n                    'Uacute','Ucirc','Uuml','Yacute','THORN','euro','quot','szlig',\n                    'lt','gt','cent','pound','curren','yen','brvbar','sect','uml',\n                    'copy','ordf','laquo','not','shy','reg','macr','deg','plusmn',\n                    'sup2','sup3','acute','micro','para','middot','cedil','sup1',\n                    'ordm','raquo','frac14','frac12','frac34'],\n\n        /**\n         * List of accented chars\n         * \n         * @property _accentedChars\n         * @type {Array}\n         * @private\n         * @readOnly\n         * @static\n         */\n        _accentedChars:['à','á','â','ã','ä','å',\n                        'è','é','ê','ë',\n                        'ì','í','î','ï',\n                        'ò','ó','ô','õ','ö',\n                        'ù','ú','û','ü',\n                        'ç','ñ',\n                        'À','Á','Â','Ã','Ä','Å',\n                        'È','É','Ê','Ë',\n                        'Ì','Í','Î','Ï',\n                        'Ò','Ó','Ô','Õ','Ö',\n                        'Ù','Ú','Û','Ü',\n                        'Ç','Ñ'],\n\n        /**\n         * List of the accented chars (above), but without the accents\n         * \n         * @property _accentedRemovedChars\n         * @type {Array}\n         * @private\n         * @readOnly\n         * @static\n         */\n        _accentedRemovedChars:['a','a','a','a','a','a',\n                               'e','e','e','e',\n                               'i','i','i','i',\n                               'o','o','o','o','o',\n                               'u','u','u','u',\n                               'c','n',\n                               'A','A','A','A','A','A',\n                               'E','E','E','E',\n                               'I','I','I','I',\n                               'O','O','O','O','O',\n                               'U','U','U','U',\n                               'C','N'],\n        /**\n         * Object that contains the basic HTML unsafe chars, as keys, and their HTML entities as values\n         * \n         * @property _htmlUnsafeChars\n         * @type {Object}\n         * @private\n         * @readOnly\n         * @static\n         */\n        _htmlUnsafeChars:{'<':'&lt;','>':'&gt;','&':'&amp;','\"':'&quot;',\"'\":'&apos;'},\n\n        /**\n         * Capitalizes a word.\n         * If param as more than one word, it converts first letter of all words that have more than 2 letters\n         *\n         * @method ucFirst\n         * @param   {String}  string                String to capitalize.\n         * @param   {Boolean} [firstWordOnly]=false Flag to capitalize only the first word.\n         * @return  {String}                        Camel cased string.\n         * @public\n         * @static\n         * @sample Ink_Util_String_ucFirst.html \n         */\n        ucFirst: function(string, firstWordOnly) {\n            var replacer = firstWordOnly ? /(^|\\s)(\\w)(\\S{2,})/ : /(^|\\s)(\\w)(\\S{2,})/g;\n            return string ? String(string).replace(replacer, function(_, $1, $2, $3){\n                return $1 + $2.toUpperCase() + $3.toLowerCase();\n            }) : string;\n        },\n\n        /**\n         * Trims whitespace from strings\n         *\n         * @method trim\n         * @param   {String} string     String to be trimmed\n         * @return  {String}            Trimmed string\n         * @public\n         * @static\n         * @sample Ink_Util_String_trim.html \n         */\n        trim: function(string)\n        {\n            if (typeof string === 'string') {\n                return string.replace(/^\\s+|\\s+$|\\n+$/g, '');\n            }\n            return string;\n        },\n\n        /**\n         * Strips HTML tags from strings\n         *\n         * @method stripTags\n         * @param   {String} string     String to strip tags from.\n         * @param   {String} allowed    Comma separated list of allowed tags.\n         * @return  {String}            Stripped string\n         * @public\n         * @static\n         * @sample Ink_Util_String_stripTags.html \n         */\n        stripTags: function(string, allowed)\n        {\n            if (allowed && typeof allowed === 'string') {\n                var aAllowed = InkUtilString.trim(allowed).split(',');\n                var aNewAllowed = [];\n                var cleanedTag = false;\n                for(var i=0; i < aAllowed.length; i++) {\n                    if(InkUtilString.trim(aAllowed[i]) !== '') {\n                        cleanedTag = InkUtilString.trim(aAllowed[i].replace(/(<|\\>)/g, '').replace(/\\s/, ''));\n                        aNewAllowed.push('(<'+cleanedTag+'\\\\s[^>]+>|<(\\\\s|\\\\/)?(\\\\s|\\\\/)?'+cleanedTag+'>)');\n                    }\n                }\n                var strAllowed = aNewAllowed.join('|');\n                var reAllowed = new RegExp(strAllowed, \"i\");\n\n                var aFoundTags = string.match(new RegExp(\"<[^>]*>\", \"g\"));\n\n                for(var j=0; j < aFoundTags.length; j++) {\n                    if(!aFoundTags[j].match(reAllowed)) {\n                        string = string.replace((new RegExp(aFoundTags[j], \"gm\")), '');\n                    }\n                }\n                return string;\n            } else {\n                return string.replace(/<[^\\>]+\\>/g, '');\n            }\n        },\n\n        /**\n         * Encodes string into HTML entities.\n         *\n         * @method htmlEntitiesEncode\n         * @param {String} string Input string.\n         * @return {String} HTML encoded string.\n         * @public\n         * @static\n         * @sample Ink_Util_String_htmlEntitiesEncode.html \n         */\n        htmlEntitiesEncode: function(string)\n        {\n            if (string && string.replace) {\n                var re = false;\n                for (var i = 0; i < InkUtilString._chars.length; i++) {\n                    re = new RegExp(InkUtilString._chars[i], \"gm\");\n                    string = string.replace(re, '&' + InkUtilString._entities[i] + ';');\n                }\n            }\n            return string;\n        },\n\n        /**\n         * Decodes string from HTML entities.\n         *\n         * @method htmlEntitiesDecode\n         * @param   {String}    string  String to be decoded\n         * @return  {String}            Decoded string\n         * @public\n         * @static\n         * @sample Ink_Util_String_htmlEntitiesDecode.html \n         */\n        htmlEntitiesDecode: function(string)\n        {\n            if (string && string.replace) {\n                var re = false;\n                for (var i = 0; i < InkUtilString._entities.length; i++) {\n                    re = new RegExp(\"&\"+InkUtilString._entities[i]+\";\", \"gm\");\n                    string = string.replace(re, InkUtilString._chars[i]);\n                }\n                string = string.replace(/&#[^;]+;?/g, function($0){\n                    if ($0.charAt(2) === 'x') {\n                        return String.fromCharCode(parseInt($0.substring(3), 16));\n                    }\n                    else {\n                        return String.fromCharCode(parseInt($0.substring(2), 10));\n                    }\n                });\n            }\n            return string;\n        },\n\n        /**\n         * Encode a string to UTF-8.\n         *\n         * @method utf8Encode\n         * @param   {String}    string      String to be encoded\n         * @return  {String}    string      UTF-8 encoded string\n         * @public\n         * @static\n         */\n        utf8Encode: function(string) {\n            /*jshint bitwise:false*/\n            string = string.replace(/\\r\\n/g,\"\\n\");\n            var utfstring = \"\";\n\n            for (var n = 0; n < string.length; n++) {\n\n                var c = string.charCodeAt(n);\n\n                if (c < 128) {\n                    utfstring += String.fromCharCode(c);\n                }\n                else if((c > 127) && (c < 2048)) {\n                    utfstring += String.fromCharCode((c >> 6) | 192);\n                    utfstring += String.fromCharCode((c & 63) | 128);\n                }\n                else {\n                    utfstring += String.fromCharCode((c >> 12) | 224);\n                    utfstring += String.fromCharCode(((c >> 6) & 63) | 128);\n                    utfstring += String.fromCharCode((c & 63) | 128);\n                }\n\n            }\n            return utfstring;\n        },\n\n        /**\n         * Truncates a string without breaking words. Inserts an ellipsis HTML entity at the end of the string if it's too long.\n         *\n         * @method shortString\n         * @param   {String}    str     String to truncate\n         * @param   {Number}    n       Number of chars of the short string\n         * @return  {String}            Truncated string, or the original `str` if it's shorter than `n`\n         * @public\n         * @static\n         * @sample Ink_Util_String_shortString.html \n         */\n        shortString: function(str,n) {\n          var words = str.split(' ');\n          var resultstr = '';\n          for(var i = 0; i < words.length; i++ ){\n            if((resultstr + words[i] + ' ').length>=n){\n              resultstr += '&hellip;';\n              break;\n              }\n            resultstr += words[i] + ' ';\n            }\n          return resultstr;\n        },\n\n        /**\n         * Truncates a string, breaking words and adding ... at the end.\n         *\n         * @method truncateString\n         * @param   {String} str        String to truncate\n         * @param   {Number} length     Limit for the returned string, ellipsis included.\n         * @return  {String}            Truncated String\n         * @public\n         * @static\n         * @sample Ink_Util_String_truncateString.html \n         */\n        truncateString: function(str, length) {\n            if(str.length - 1 > length) {\n                return str.substr(0, length - 1) + \"\\u2026\";\n            } else {\n                return str;\n            }\n        },\n\n        /**\n         * Decodes a string from UTF-8.\n         *\n         * @method utf8Decode\n         * @param   {String} string     String to be decoded\n         * @return  {String}            Decoded string\n         * @public\n         * @static\n         */\n        utf8Decode: function(string) {\n            /*jshint bitwise:false*/\n            var ret = \"\";\n            var i = 0, c = 0, c2 = 0, c3 = 0;\n\n            while ( i < string.length ) {\n\n                c = string.charCodeAt(i);\n\n                if (c < 128) {\n                    ret += String.fromCharCode(c);\n                    i++;\n                }\n                else if((c > 191) && (c < 224)) {\n                    c2 = string.charCodeAt(i+1);\n                    ret += String.fromCharCode(((c & 31) << 6) | (c2 & 63));\n                    i += 2;\n                }\n                else {\n                    c2 = string.charCodeAt(i+1);\n                    c3 = string.charCodeAt(i+2);\n                    ret += String.fromCharCode(((c & 15) << 12) | ((c2 & 63) << 6) | (c3 & 63));\n                    i += 3;\n                }\n\n            }\n            return ret;\n        },\n\n        /**\n         * Removes all accented characters from a string.\n         *\n         * @method removeAccentedChars\n         * @param   {String} string     String to remove accents from\n         * @return  {String}            String without accented chars\n         * @public\n         * @static\n         * @sample Ink_Util_String_removeAccentedChars.html \n         */\n        removeAccentedChars: function(string)\n        {\n            var newString = string;\n            var re = false;\n            for (var i = 0; i < InkUtilString._accentedChars.length; i++) {\n                re = new RegExp(InkUtilString._accentedChars[i], \"gm\");\n                newString = newString.replace(re, '' + InkUtilString._accentedRemovedChars[i] + '');\n            }\n            return newString;\n        },\n\n        /**\n         * Count the number of occurrences of a specific needle in a haystack\n         *\n         * @method substrCount\n         * @param   {String} haystack   String to search in\n         * @param   {String} needle     String to search for\n         * @return  {Number}            Number of occurrences\n         * @public\n         * @static\n         * @sample Ink_Util_String_substrCount.html \n         */\n        substrCount: function(haystack,needle)\n        {\n            return haystack ? haystack.split(needle).length - 1 : 0;\n        },\n\n        /**\n         * Eval a JSON - We recommend you Ink.Util.Json\n         *\n         * @method evalJSON\n         * @param   {String}    strJSON     JSON string to eval\n         * @param   {Boolean}   sanitize    Flag to sanitize input\n         * @return  {Object}                JS Object\n         * @public\n         * @static\n         */\n        evalJSON: function(strJSON, sanitize) {\n            /* jshint evil:true */\n            if( (typeof sanitize === 'undefined' || sanitize === null) || InkUtilString.isJSON(strJSON)) {\n                try {\n                    if(typeof(JSON) !== \"undefined\" && typeof(JSON.parse) !== 'undefined'){\n                        return JSON.parse(strJSON);\n                    }\n                    return eval('('+strJSON+')');\n                } catch(e) {\n                    throw new Error('ERROR: Bad JSON string...');\n                }\n            }\n        },\n\n        /**\n         * Checks if a string is a valid JSON object (string encoded)\n         *\n         * @method isJSON\n         * @param   {String}    str      String to check\n         * @return  {Boolean}   Return whether it's JSON.\n         * @public\n         * @static\n         */\n        isJSON: function(str)\n        {\n            str = str.replace(/\\\\./g, '@').replace(/\"[^\"\\\\\\n\\r]*\"/g, '');\n            return (/^[,:{}\\[\\]0-9.\\-+Eaeflnr-u \\n\\r\\t]*$/).test(str);\n        },\n\n        /**\n         * Escapes unsafe html chars as HTML entities\n         *\n         * @method htmlEscapeUnsafe\n         * @param {String} str String to escape\n         * @return {String} Escaped string\n         * @public\n         * @static\n         * @sample Ink_Util_String_htmlEscapeUnsafe.html \n         */\n        htmlEscapeUnsafe: function(str){\n            var chars = InkUtilString._htmlUnsafeChars;\n            return str !== null ? String(str).replace(/[<>&'\"]/g,function(c){return chars[c];}) : str;\n        },\n\n        /**\n         * Normalizes whitespace in string.\n         * String is trimmed and sequences of whitespaces are collapsed.\n         *\n         * @method normalizeWhitespace\n         * @param   {String}    str     String to normalize\n         * @return  {String}            Normalized string\n         * @public\n         * @static\n         * @sample Ink_Util_String_normalizeWhitespace.html \n         */\n        normalizeWhitespace: function(str){\n            return str !== null ? InkUtilString.trim(String(str).replace(/\\s+/g,' ')) : str;\n        },\n\n        /**\n         * Converts string to unicode.\n         *\n         * @method toUnicode\n         * @param   {String} str    String to convert\n         * @return  {String}        Unicoded String\n         * @public\n         * @static\n         * @sample Ink_Util_String_toUnicode.html \n         */\n        toUnicode: function(str) {\n            if (typeof str === 'string') {\n                var unicodeString = '';\n                var inInt = false;\n                var theUnicode = false;\n                var total = str.length;\n                var i=0;\n\n                while(i < total)\n                {\n                    inInt = str.charCodeAt(i);\n                    if( (inInt >= 32 && inInt <= 126) ||\n                            inInt === 8 ||\n                            inInt === 9 ||\n                            inInt === 10 ||\n                            inInt === 12 ||\n                            inInt === 13 ||\n                            inInt === 32 ||\n                            inInt === 34 ||\n                            inInt === 47 ||\n                            inInt === 58 ||\n                            inInt === 92) {\n\n                        /*\n                        if(inInt == 34 || inInt == 92 || inInt == 47) {\n                            theUnicode = '\\\\'+str.charAt(i);\n                        } else {\n                        }\n                        */\n                        if(inInt === 8) {\n                            theUnicode = '\\\\b';\n                        } else if(inInt === 9) {\n                            theUnicode = '\\\\t';\n                        } else if(inInt === 10) {\n                            theUnicode = '\\\\n';\n                        } else if(inInt === 12) {\n                            theUnicode = '\\\\f';\n                        } else if(inInt === 13) {\n                            theUnicode = '\\\\r';\n                        } else {\n                            theUnicode = str.charAt(i);\n                        }\n                    } else {\n                        theUnicode = str.charCodeAt(i).toString(16)+''.toUpperCase();\n                        while (theUnicode.length < 4) {\n                            theUnicode = '0' + theUnicode;\n                        }\n                        theUnicode = '\\\\u' + theUnicode;\n                    }\n                    unicodeString += theUnicode;\n\n                    i++;\n                }\n                return unicodeString;\n            }\n        },\n\n        /**\n         * Escapes a unicode character.\n         *\n         * @method escape\n         * @param {String}  c   Character to escape\n         * @return {String} Escaped character. Returns \\xXX if hex smaller than 0x100, otherwise \\uXXXX\n         * @public\n         * @static\n         * @sample Ink_Util_String_escape.html \n         */\n        escape: function(c) {\n            var hex = (c).charCodeAt(0).toString(16).split('');\n            if (hex.length < 3) {\n                while (hex.length < 2) { hex.unshift('0'); }\n                hex.unshift('x');\n            }\n            else {\n                while (hex.length < 4) { hex.unshift('0'); }\n                hex.unshift('u');\n            }\n\n            hex.unshift('\\\\');\n            return hex.join('');\n        },\n\n        /**\n         * Unescapes a unicode character escape sequence\n         *\n         * @method unescape\n         * @param   {String} es     Escape sequence\n         * @return  {String}        String un-unicoded\n         * @public\n         * @static\n         * @sample Ink_Util_String_unescape.html \n         */\n        unescape: function(es) {\n            var idx = es.lastIndexOf('0');\n            idx = idx === -1 ? 2 : Math.min(idx, 2);\n            //console.log(idx);\n            var hexNum = es.substring(idx);\n            //console.log(hexNum);\n            var num = parseInt(hexNum, 16);\n            return String.fromCharCode(num);\n        },\n\n        /**\n         * Escapes unicode characters in a string as unicode character entities (`\\x##`, where the `##` are hex digits).\n         *\n         * @method escapeText\n         * @param   {String}    txt             String with characters outside the ASCII printable range (32 < charCode < 127)\n         * @param   {Array}     [whiteList]     Whitelist of characters which should NOT be escaped\n         * @return  {String}                    String escaped with unicode character entities.\n         * @public\n         * @static\n         * @sample Ink_Util_String_escapeText.html \n         */\n        escapeText: function(txt, whiteList) {\n            if (whiteList === undefined) {\n                whiteList = ['[', ']', '\\'', ','];\n            }\n            var txt2 = [];\n            var c, C;\n            for (var i = 0, f = txt.length; i < f; ++i) {\n                c = txt[i];\n                C = c.charCodeAt(0);\n                if (C < 32 || C > 126 && whiteList.indexOf(c) === -1) {\n                    c = InkUtilString.escape(c);\n                }\n                txt2.push(c);\n            }\n            return txt2.join('');\n        },\n\n        /**\n         * Regex to check escaped strings\n         *\n         * @property escapedCharRegex\n         * @type {Regex}\n         * @public\n         * @readOnly\n         * @static\n         */\n        escapedCharRegex: /(\\\\x[0-9a-fA-F]{2})|(\\\\u[0-9a-fA-F]{4})/g,\n\n        /**\n         * Removes unicode entities (in the format \"\\x##\" or \"\\u####\", where \"#\" is a hexadecimal digit)\n         *\n         * @method unescapeText\n         * @param {String} txt Text you intend to remove unicode character entities.\n         * @return {String} Unescaped string\n         * @public\n         * @static\n         * @sample Ink_Util_String_unescapeText.html \n         */\n        unescapeText: function(txt) {\n            /*jshint boss:true */\n            var m;\n            while (m = InkUtilString.escapedCharRegex.exec(txt)) {\n                m = m[0];\n                txt = txt.replace(m, InkUtilString.unescape(m));\n                InkUtilString.escapedCharRegex.lastIndex = 0;\n            }\n            return txt;\n        },\n\n        /**\n         * Compares two strings.\n         *\n         * @method strcmp\n         * @param   {String}    str1     First String\n         * @param   {String}    str2     Second String\n         * @return  {Number} 0 if given strings are equal, 1 if str1 is greater than str2, and -1 if str2 is greater than str1.\n         * @public\n         * @static\n         * @sample Ink_Util_String_strcmp.html \n         */\n        strcmp: function(str1, str2) {\n            return ((str1 === str2) ? 0 : ((str1 > str2) ? 1 : -1));\n        },\n\n        /**\n         * Splits a string into smaller chunks\n         *\n         * @method packetize\n         * @param   {String} str        String to divide\n         * @param   {Number} maxLen     Maximum chunk size (in characters)\n         * @return  {Array}             Chunks of the original string\n         * @public\n         * @static\n         * @sample Ink_Util_String_packetize.html \n         */\n        packetize: function(str, maxLen) {\n            var len = str.length;\n            var parts = new Array( Math.ceil(len / maxLen) );\n            var chars = str.split('');\n            var sz, i = 0;\n            while (len) {\n                sz = Math.min(maxLen, len);\n                parts[i++] = chars.splice(0, sz).join('');\n                len -= sz;\n            }\n            return parts;\n        }\n    };\n\n    return InkUtilString;\n\n});\n","/**\n * URL Utilities\n * @module Ink.Util.Url_1\n * @version 1\n */\n\nInk.createModule('Ink.Util.Url', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.Url_1\n     */\n    var Url = {\n\n        /**\n         * Auxiliary string for encoding\n         *\n         * @property _keyStr\n         * @type {String}\n         * @readOnly\n         * @private\n         */\n        _keyStr : 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=',\n\n\n        /**\n         * Gets URL of current page\n         *\n         * @method getUrl\n         * @return {String} Current URL\n         * @public\n         * @static\n         * @sample Ink_Util_Url_getUrl.html \n         */\n        getUrl: function()\n        {\n            return window.location.href;\n        },\n\n        /**\n         * Generates an URL string.\n         *\n         * @method genQueryString\n         * @param {String} uri      Base URL\n         * @param {Object} params   Object to transform to query string\n         * @return {String} URI with query string set\n         * @public\n         * @static\n         * @sample Ink_Util_Url_genQueryString.html \n         */\n        genQueryString: function(uri, params) {\n            var hasQuestionMark = uri.indexOf('?') !== -1;\n            var sep, pKey, pValue, parts = [uri];\n\n            for (pKey in params) {\n                if (params.hasOwnProperty(pKey)) {\n                    if (!hasQuestionMark) {\n                        sep = '?';\n                        hasQuestionMark = true;\n                    } else {\n                        sep = '&';\n                    }\n                    pValue = params[pKey];\n                    if (typeof pValue !== 'number' && !pValue) {\n                        pValue = '';\n                    }\n                    parts = parts.concat([sep, encodeURIComponent(pKey), '=', encodeURIComponent(pValue)]);\n                }\n            }\n\n            return parts.join('');\n        },\n\n        /**\n         * Gets an object from an URL encoded string.\n         *\n         * @method getQueryString\n         * @param   {String} [str]      URL String. When not specified it uses the current URL.\n         * @return  {Object}            Key-Value pair object\n         * @public\n         * @static\n         * @sample Ink_Util_Url_getQueryString.html \n         */\n        getQueryString: function(str)\n        {\n            var url;\n            if(str && typeof(str) !== 'undefined') {\n                url = str;\n            } else {\n                url = this.getUrl();\n            }\n            var aParams = {};\n            if(url.match(/\\?(.+)/i)) {\n                var queryStr = url.replace(/^(.*)\\?([^\\#]+)(\\#(.*))?/g, \"$2\");\n                if(queryStr.length > 0) {\n                    var aQueryStr = queryStr.split(/[;&]/);\n                    for(var i=0; i < aQueryStr.length; i++) {\n                        var pairVar = aQueryStr[i].split('=');\n                        aParams[decodeURIComponent(pairVar[0])] = (typeof(pairVar[1]) !== 'undefined' && pairVar[1]) ? decodeURIComponent(pairVar[1]) : false;\n                    }\n                }\n            }\n            return aParams;\n        },\n\n        /**\n         * Gets the URL hash value\n         *\n         * @method getAnchor\n         * @param   {String}            [str]   URL String. Defaults to current page URL.\n         * @return  {String|Boolean}            Hash in the URL. If there's no hash, returns false.\n         * @public\n         * @static\n         * @sample Ink_Util_Url_getAnchor.html \n         */\n        getAnchor: function(str)\n        {\n            var url;\n            if(str && typeof(str) !== 'undefined') {\n                url = str;\n            } else {\n                url = this.getUrl();\n            }\n            var anchor = false;\n            if(url.match(/#(.+)/)) {\n                anchor = url.replace(/([^#]+)#(.*)/, \"$2\");\n            }\n            return anchor;\n        },\n\n        /**\n         * Gets the anchor string of an URL\n         *\n         * @method getAnchorString\n         * @param   {String} [string]   URL to parse. Defaults to current URL.\n         * @return  {Object}            Key-value pair object of the URL's hashtag 'variables'\n         * @public\n         * @static\n         * @sample Ink_Util_Url_getAnchorString.html \n         */\n        getAnchorString: function(string)\n        {\n            var url;\n            if(string && typeof(string) !== 'undefined') {\n                url = string;\n            } else {\n                url = this.getUrl();\n            }\n            var aParams = {};\n            if(url.match(/#(.+)/i)) {\n                var anchorStr = url.replace(/^([^#]+)#(.*)?/g, \"$2\");\n                if(anchorStr.length > 0) {\n                    var aAnchorStr = anchorStr.split(/[;&]/);\n                    for(var i=0; i < aAnchorStr.length; i++) {\n                        var pairVar = aAnchorStr[i].split('=');\n                        aParams[decodeURIComponent(pairVar[0])] = (typeof(pairVar[1]) !== 'undefined' && pairVar[1]) ? decodeURIComponent(pairVar[1]) : false;\n                    }\n                }\n            }\n            return aParams;\n        },\n\n\n        /**\n         * Parses URL string into URL parts\n         *\n         * @method parseUrl\n         * @param {String} url URL to be parsed\n         * @return {Object} Parsed URL as a key-value object.\n         * @public\n         * @static\n         * @sample Ink_Util_Url_parseUrl.html \n         */\n        parseUrl: function(url) {\n            var aURL = {};\n            if(url && typeof url === 'string') {\n                if(url.match(/^([^:]+):\\/\\//i)) {\n                    var re = /^([^:]+):\\/\\/([^\\/]*)\\/?([^\\?#]*)\\??([^#]*)#?(.*)/i;\n                    if(url.match(re)) {\n                        aURL.scheme   = url.replace(re, \"$1\");\n                        aURL.host     = url.replace(re, \"$2\");\n                        aURL.path     = '/'+url.replace(re, \"$3\");\n                        aURL.query    = url.replace(re, \"$4\") || false;\n                        aURL.fragment = url.replace(re, \"$5\") || false;\n                    }\n                } else {\n                    var re1 = new RegExp(\"^([^\\\\?]+)\\\\?([^#]+)#(.*)\", \"i\");\n                    var re2 = new RegExp(\"^([^\\\\?]+)\\\\?([^#]+)#?\", \"i\");\n                    var re3 = new RegExp(\"^([^\\\\?]+)\\\\??\", \"i\");\n                    if(url.match(re1)) {\n                        aURL.scheme   = false;\n                        aURL.host     = false;\n                        aURL.path     = url.replace(re1, \"$1\");\n                        aURL.query    = url.replace(re1, \"$2\");\n                        aURL.fragment = url.replace(re1, \"$3\");\n                    } else if(url.match(re2)) {\n                        aURL.scheme = false;\n                        aURL.host   = false;\n                        aURL.path   = url.replace(re2, \"$1\");\n                        aURL.query  = url.replace(re2, \"$2\");\n                        aURL.fragment = false;\n                    } else if(url.match(re3)) {\n                        aURL.scheme   = false;\n                        aURL.host     = false;\n                        aURL.path     = url.replace(re3, \"$1\");\n                        aURL.query    = false;\n                        aURL.fragment = false;\n                    }\n                }\n                if(aURL.host) {\n                    var regPort = /^(.*?)\\\\:(\\\\d+)$/i;\n                    // check for port\n                    if(aURL.host.match(regPort)) {\n                        var tmpHost1 = aURL.host;\n                        aURL.host = tmpHost1.replace(regPort, \"$1\");\n                        aURL.port = tmpHost1.replace(regPort, \"$2\");\n                    } else {\n                        aURL.port = false;\n                    }\n                    // check for user and pass\n                    if(aURL.host.match(/@/i)) {\n                        var tmpHost2 = aURL.host;\n                        aURL.host = tmpHost2.split('@')[1];\n                        var tmpUserPass = tmpHost2.split('@')[0];\n                        if(tmpUserPass.match(/\\:/)) {\n                            aURL.user = tmpUserPass.split(':')[0];\n                            aURL.pass = tmpUserPass.split(':')[1];\n                        } else {\n                            aURL.user = tmpUserPass;\n                            aURL.pass = false;\n                        }\n                    }\n                }\n            }\n            return aURL;\n        },\n\n        /**\n         * Formats an URL object into an URL string.\n         *\n         * @method format\n         * @param {String|Location|Object} urlObj Window.location, a.href, or parseUrl object to format\n         * @return {String} Full URL.\n         */\n        format: function (urlObj) {\n            var protocol = '';\n            var host = '';\n            var path = '';\n            var frag = '';\n            var query = '';\n\n            if (typeof urlObj.protocol === 'string') {\n                protocol = urlObj.protocol + '//';  // here it comes with the colon\n            } else if (typeof urlObj.scheme === 'string')  {\n                protocol = urlObj.scheme + '://';\n            }\n\n            host = urlObj.host || urlObj.hostname || '';\n            path = urlObj.path || '';\n\n            if (typeof urlObj.query === 'string') {\n                query = urlObj.query;\n            } else if (typeof urlObj.search === 'string') {\n                query = urlObj.search.replace(/^\\?/, '');\n            }\n            if (typeof urlObj.fragment === 'string') {\n                frag =  urlObj.fragment;\n            } else if (typeof urlObj.hash === 'string') {\n                frag = urlObj.hash.replace(/#$/, '');\n            }\n\n            return [\n                protocol,\n                host,\n                path,\n                query && '?' + query,\n                frag && '#' + frag\n            ].join('');\n        },\n\n        /**\n         * Gets the last loaded script element\n         *\n         * @method currentScriptElement\n         * @param {String} [match] String to match against the script src attribute\n         * @return {DOMElement|Boolean} Returns the `script` DOM Element or false if unable to find it.\n         * @public\n         * @static\n         * @sample Ink_Util_Url_currentScriptElement.html \n         */\n        currentScriptElement: function(match)\n        {\n            var aScripts = document.getElementsByTagName('script');\n            if(typeof(match) === 'undefined') {\n                if(aScripts.length > 0) {\n                    return aScripts[(aScripts.length - 1)];\n                } else {\n                    return false;\n                }\n            } else {\n                var curScript = false;\n                var re = new RegExp(\"\"+match+\"\", \"i\");\n                for(var i=0, total = aScripts.length; i < total; i++) {\n                    curScript = aScripts[i];\n                    if(re.test(curScript.src)) {\n                        return curScript;\n                    }\n                }\n                return false;\n            }\n        }\n    };\n\n    return Url;\n\n});\n","/**\n * Validation Utilities\n * @module Ink.Util.Validator_1\n * @version 1\n */\n \nInk.createModule('Ink.Util.Validator', '1', [], function() {\n\n    'use strict';\n\n    /**\n     * @namespace Ink.Util.Validator_1 \n     */\n    var Validator = {\n\n        /**\n         * List of country codes avaible for the isPhone method\n         *\n         * @property _countryCodes\n         * @type {Array}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _countryCodes : [\n                        'AO',\n                        'CV',\n                        'MZ',\n                        'PT'\n                    ],\n\n        /**\n         * International number for portugal\n         *\n         * @property _internacionalPT\n         * @type {Number}\n         * @private\n         * @static\n         * @readOnly\n         *\n         */\n        _internacionalPT: 351,\n\n        /**\n         * List of all portuguese number prefixes\n         *\n         * @property _indicativosPT\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         *\n         */\n        _indicativosPT: {\n                        21: 'lisboa',\n                        22: 'porto',\n                        231: 'mealhada',\n                        232: 'viseu',\n                        233: 'figueira da foz',\n                        234: 'aveiro',\n                        235: 'arganil',\n                        236: 'pombal',\n                        238: 'seia',\n                        239: 'coimbra',\n                        241: 'abrantes',\n                        242: 'ponte de sôr',\n                        243: 'santarém',\n                        244: 'leiria',\n                        245: 'portalegre',\n                        249: 'torres novas',\n                        251: 'valença',\n                        252: 'vila nova de famalicão',\n                        253: 'braga',\n                        254: 'peso da régua',\n                        255: 'penafiel',\n                        256: 'são joão da madeira',\n                        258: 'viana do castelo',\n                        259: 'vila real',\n                        261: 'torres vedras',\n                        262: 'caldas da raínha',\n                        263: 'vila franca de xira',\n                        265: 'setúbal',\n                        266: 'évora',\n                        268: 'estremoz',\n                        269: 'santiago do cacém',\n                        271: 'guarda',\n                        272: 'castelo branco',\n                        273: 'bragança',\n                        274: 'proença-a-nova',\n                        275: 'covilhã',\n                        276: 'chaves',\n                        277: 'idanha-a-nova',\n                        278: 'mirandela',\n                        279: 'moncorvo',\n                        281: 'tavira',\n                        282: 'portimão',\n                        283: 'odemira',\n                        284: 'beja',\n                        285: 'moura',\n                        286: 'castro verde',\n                        289: 'faro',\n                        291: 'funchal, porto santo',\n                        292: 'corvo, faial, flores, horta, pico',\n                        295: 'angra do heroísmo, graciosa, são jorge, terceira',\n                        296: 'ponta delgada, são miguel, santa maria',\n\n                        91 : 'rede móvel 91 (Vodafone / Yorn)',\n                        93 : 'rede móvel 93 (Optimus)',\n                        96 : 'rede móvel 96 (TMN)',\n                        92 : 'rede móvel 92 (TODOS)',\n                        //925 : 'rede móvel 925 (TMN 925)',\n                        //926 : 'rede móvel 926 (TMN 926)',\n                        //927 : 'rede móvel 927 (TMN 927)',\n                        //922 : 'rede móvel 922 (Phone-ix)',\n\n                        707: 'número único',\n                        760: 'número único',\n                        800: 'número grátis',\n                        808: 'chamada local',\n                        30:  'voip'\n                          },\n        /**\n         * International number for Cabo Verde\n         *\n         * @property _internacionalCV\n         * @type {Number}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _internacionalCV: 238,\n\n        /**\n         * List of all Cabo Verde number prefixes\n         *\n         * @property _indicativosCV\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _indicativosCV: {\n                        2: 'fixo',\n                        91: 'móvel 91',\n                        95: 'móvel 95',\n                        97: 'móvel 97',\n                        98: 'móvel 98',\n                        99: 'móvel 99'\n                    },\n        /**\n         * International number for Angola\n         *\n         * @property _internacionalAO\n         * @type {Number}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _internacionalAO: 244,\n\n        /**\n         * List of all Angola number prefixes\n         *\n         * @property _indicativosAO\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _indicativosAO: {\n                        2: 'fixo',\n                        91: 'móvel 91',\n                        92: 'móvel 92'\n                    },\n        /**\n         * International number for Mozambique\n         *\n         * @property _internacionalMZ\n         * @type {Number}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _internacionalMZ: 258,\n\n        /**\n         * List of all Mozambique number prefixes\n         *\n         * @property _indicativosMZ\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _indicativosMZ: {\n                        2: 'fixo',\n                        82: 'móvel 82',\n                        84: 'móvel 84'\n                    },\n\n        /**\n         * International number for Timor\n         *\n         * @property _internacionalTL\n         * @type {Number}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _internacionalTL: 670,\n\n        /**\n         * List of all Timor number prefixes\n         *\n         * @property _indicativosTL\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _indicativosTL: {\n                        3: 'fixo',\n                        7: 'móvel 7'\n                    },\n\n        /**\n         * Regular expression groups for several groups of characters\n         *\n         * http://en.wikipedia.org/wiki/C0_Controls_and_Basic_Latin\n         * http://en.wikipedia.org/wiki/Plane_%28Unicode%29#Basic_Multilingual_Plane\n         * http://en.wikipedia.org/wiki/ISO_8859-1\n         *\n         * @property _characterGroups\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _characterGroups: {\n            numbers: ['0-9'],\n            asciiAlpha: ['a-zA-Z'],\n            latin1Alpha: ['a-zA-Z', '\\u00C0-\\u00FF'],\n            unicodeAlpha: ['a-zA-Z', '\\u00C0-\\u00FF', '\\u0100-\\u1FFF', '\\u2C00-\\uD7FF'],\n            /* whitespace characters */\n            space: [' '],\n            dash: ['-'],\n            underscore: ['_'],\n            nicknamePunctuation: ['_.-'],\n\n            singleLineWhitespace: ['\\t '],\n            newline: ['\\n'],\n            whitespace: ['\\t\\n\\u000B\\f\\r\\u00A0 '],\n\n            asciiPunctuation: ['\\u0021-\\u002F', '\\u003A-\\u0040', '\\u005B-\\u0060', '\\u007B-\\u007E'],\n            latin1Punctuation: ['\\u0021-\\u002F', '\\u003A-\\u0040', '\\u005B-\\u0060', '\\u007B-\\u007E', '\\u00A1-\\u00BF', '\\u00D7', '\\u00F7'],\n            unicodePunctuation: ['\\u0021-\\u002F', '\\u003A-\\u0040', '\\u005B-\\u0060', '\\u007B-\\u007E', '\\u00A1-\\u00BF', '\\u00D7', '\\u00F7', '\\u2000-\\u206F', '\\u2E00-\\u2E7F', '\\u3000-\\u303F']\n        },\n\n        /**\n         * Creates a regular expression for several character groups.\n         *\n         * @method createRegExp\n         *\n         * @param {Object} groups\n         *  Groups to build regular expressions for. Possible keys are:\n         *\n         * - **numbers**: 0-9\n         * - **asciiAlpha**: a-z, A-Z\n         * - **latin1Alpha**: asciiAlpha, plus printable characters in latin-1\n         * - **unicodeAlpha**: unicode alphanumeric characters.\n         * - **space**: ' ', the space character.\n         * - **dash**: dash character.\n         * - **underscore**: underscore character.\n         * - **nicknamePunctuation**: dash, dot, underscore\n         * - **singleLineWhitespace**: space and tab (whitespace which only spans one line).\n         * - **newline**: newline character ('\\n')\n         * - **whitespace**: whitespace characters in the ASCII character set.\n         * - **asciiPunctuation**: punctuation characters in the ASCII character set.\n         * - **latin1Punctuation**: punctuation characters in latin-1.\n         * - **unicodePunctuation**: punctuation characters in unicode.\n         *\n         * @returns {RegExp} A regular expression with the given groups.\n         */\n        createRegExp: function (groups) {\n            var re = '^[';\n            for (var key in groups) if (groups.hasOwnProperty(key)) {\n                if (!(key in Validator._characterGroups)) {\n                    throw new Error('group ' + key + ' is not a valid character group');\n                } else if (groups[key]) {\n                    re += Validator._characterGroups[key].join('');\n                }\n            }\n            if (re === '^[') {\n                // No changes\n                return new RegExp('$^'); // match nothing\n            }\n            return new RegExp(re + ']*?$');\n        },\n\n        /**\n         * Checks if a field has the required groups.\n         *\n         * @method checkCharacterGroups\n         * @param {String}  s               The validation string\n         * @param {Object}  [groups={}]     What groups are included. See `createRegExp`\n         * @return {Boolean} Whether this is a valid string (all groups pass).\n         * @sample Ink_Util_Validator_checkCharacterGroups.html \n         */\n        checkCharacterGroups: function (s, groups) {\n            return Validator.createRegExp(groups).test(s);\n        },\n\n        /**\n         * Checks if a field contains unicode printable characters.\n         *\n         * @method unicode\n         * @param {String}  s               The validation string\n         * @param {Object}  [options={}]    Optional configuration object. See createRegexp\n         * @return {Boolean} Whether this is a valid unicode string.\n         */\n        unicode: function (s, options) {\n            return Validator.checkCharacterGroups(s, Ink.extendObj({\n                unicodeAlpha: true}, options));\n        },\n\n        /**\n         * Checks if a field only contains latin-1 alphanumeric characters. \n         * Takes options for allowing singleline whitespace, cross-line whitespace and punctuation.\n         *\n         * @method latin1\n         *\n         * @param {String}  s               The validation string\n         * @param {Object}  [options={}]    Optional configuration object. See createRegexp\n         * @return {Boolean} Whether this is a valid latin1 string.\n         * @sample Ink_Util_Validator_latin1.html  \n         */\n        latin1: function (s, options) {\n            return Validator.checkCharacterGroups(s, Ink.extendObj({\n                latin1Alpha: true}, options));\n        },\n\n        /**\n         * Checks if a field only contains only ASCII alphanumeric characters. \n         * Takes options for allowing singleline whitespace, cross-line whitespace and punctuation.\n         *\n         * @method ascii\n         *\n         * @param {String}  s               The validation string\n         * @param {Object}  [options={}]    Optional configuration object. See createRegexp\n         * @return {Boolean} Whether this is a valid ascii string.\n         * @sample Ink_Util_Validator_ascii.html \n         */\n        ascii: function (s, options) {\n            return Validator.checkCharacterGroups(s, Ink.extendObj({\n                asciiAlpha: true}, options));\n        },\n\n        /**\n         * Checks if a number is a valid\n         *\n         * @method number\n         * @param {String} numb         The number\n         * @param {Object} [options]    Further options\n         *  @param {String} [options.decimalSep='.']     Allow decimal separator.\n         *  @param {String} [options.thousandSep=\",\"]    Strip this character from the number.\n         *  @param {String} [options.negative=false]     Allow negative numbers.\n         *  @param {String} [options.decimalPlaces=null] Maximum number of decimal places. Use `0` for an integer number.\n         *  @param {Number} [options.max=null]           Maximum number\n         *  @param {Number} [options.min=null]           Minimum number\n         *  @param {Boolean}[options.returnNumber=false] When this option is `true`, return the number itself when the value is valid.\n         * @return {Boolean|Number} `false` when invalid, `true` when valid. If `options.returnNumber` is `true`, return the parsed, valid number or `false`.\n         * @sample Ink_Util_Validator_number.html \n         */\n        number: function (numb, options) {\n            numb = numb + '';\n            options = Ink.extendObj({\n                decimalSep: '.',\n                thousandSep: '',\n                negative: true,\n                decimalPlaces: null,\n                maxDigits: null,\n                max: null,\n                min: null,\n                returnNumber: false\n            }, options || {});\n            // smart recursion thing sets up aliases for options.\n            if (options.thousandSep) {\n                numb = numb.replace(new RegExp('\\\\' + options.thousandSep, 'g'), '');\n                options.thousandSep = '';\n                return Validator.number(numb, options);\n            }\n            if (options.negative === false) {\n                options.min = 0;\n                options.negative = true;\n                return Validator.number(numb, options);\n            }\n            if (options.decimalSep !== '.') {\n                numb = numb.replace(new RegExp('\\\\' + options.decimalSep, 'g'), '.');\n            }\n\n            if (!/^(-)?(\\d+)?(\\.\\d+)?$/.test(numb) || numb === '') {\n                return false;  // forbidden character found\n            }\n            \n            var split;\n            if (options.decimalSep && numb.indexOf(options.decimalSep) !== -1) {\n                split = numb.split(options.decimalSep);\n                if (options.decimalPlaces !== null &&\n                        split[1].length > options.decimalPlaces) {\n                    return false;\n                }\n            } else {\n                split = ['' + numb, ''];\n            }\n            \n            if (options.maxDigits!== null) {\n                if (split[0].replace(/-/g, '').length > options.maxDigits) {\n                    return split;\n                }\n            }\n            \n            // Now look at the actual float\n            var ret = parseFloat(numb);\n            \n            if (options.maxExcl !== null && ret >= options.maxExcl ||\n                    options.minExcl !== null && ret <= options.minExcl) {\n                return false;\n            }\n            if (options.max !== null && ret > options.max ||\n                    options.min !== null && ret < options.min) {\n                return false;\n            }\n            \n            if (options.returnNumber) {\n                return ret;\n            } else {\n                return true;\n            }\n        },\n\n        /**\n         * Checks if a year is Leap \"Bissexto\"\n         *\n         * @method _isLeapYear\n         * @param {Number} year Year to be checked\n         * @return {Boolean} True if it is a leap year.\n         * @private\n         * @static\n         * @example\n         *     Ink.requireModules(['Ink.Util.Validator_1'], function( InkValidator ){\n         *         console.log( InkValidator._isLeapYear( 2004 ) ); // Result: true\n         *         console.log( InkValidator._isLeapYear( 2006 ) ); // Result: false\n         *     });\n         */\n        _isLeapYear: function(year){\n            var yearRegExp = /^\\d{4}$/;\n\n            if(yearRegExp.test(year)){\n                return ((year%4) ? false: ((year%100) ? true : ((year%400)? false : true)) );\n            }\n\n            return false;\n        },\n\n        /**\n         * Object with the date formats available for validation\n         *\n         * @property _dateParsers\n         * @type {Object}\n         * @private\n         * @static\n         * @readOnly\n         */\n        _dateParsers: {\n            'yyyy-mm-dd': {day:5, month:3, year:1, sep: '-', parser: /^(\\d{4})(\\-)(\\d{1,2})(\\-)(\\d{1,2})$/},\n            'yyyy/mm/dd': {day:5, month:3, year:1, sep: '/', parser: /^(\\d{4})(\\/)(\\d{1,2})(\\/)(\\d{1,2})$/},\n            'yy-mm-dd': {day:5, month:3, year:1, sep: '-', parser: /^(\\d{2})(\\-)(\\d{1,2})(\\-)(\\d{1,2})$/},\n            'yy/mm/dd': {day:5, month:3, year:1, sep: '/', parser: /^(\\d{2})(\\/)(\\d{1,2})(\\/)(\\d{1,2})$/},\n            'dd-mm-yyyy': {day:1, month:3, year:5, sep: '-', parser: /^(\\d{1,2})(\\-)(\\d{1,2})(\\-)(\\d{4})$/},\n            'dd/mm/yyyy': {day:1, month:3, year:5, sep: '/', parser: /^(\\d{1,2})(\\/)(\\d{1,2})(\\/)(\\d{4})$/},\n            'dd-mm-yy': {day:1, month:3, year:5, sep: '-', parser: /^(\\d{1,2})(\\-)(\\d{1,2})(\\-)(\\d{2})$/},\n            'dd/mm/yy': {day:1, month:3, year:5, sep: '/', parser: /^(\\d{1,2})(\\/)(\\d{1,2})(\\/)(\\d{2})$/}\n        },\n\n        /**\n         * Gets the number of days in a given month of a given year\n         *\n         * @method _daysInMonth\n         * @param {Number} _m Month (1 to 12)\n         * @param {Number} _y Year\n         * @return {Number} Returns the number of days in a given month of a given year\n         * @private\n         * @static\n         * @example\n         *     Ink.requireModules(['Ink.Util.Validator_1'], function( InkValidator ){\n         *         console.log( InkValidator._daysInMonth( 2, 2004 ) ); // Result: 29\n         *         console.log( InkValidator._daysInMonth( 2, 2006 ) ); // Result: 28\n         *     });\n         */\n        _daysInMonth: function(_m,_y){\n            var nDays=0;\n\n            _m = parseInt(_m, 10);\n            _y = parseInt(_y, 10);\n\n            if(_m===1 || _m===3 || _m===5 || _m===7 || _m===8 || _m===10 || _m===12) {\n                nDays= 31;\n            } else if ( _m===4 || _m===6 || _m===9 || _m===11) {\n                nDays = 30;\n            } else if (_m===2) {\n                if((_y%400===0) || (_y%4===0 && _y%100!==0)) {\n                    nDays = 29;\n                } else {\n                    nDays = 28;\n                }\n            }\n\n            return nDays;\n        },\n\n\n\n        /**\n         * Checks if a date is valid\n         *\n         * @method _isValidDate\n         * @param {Number} year Year fragment of your date.\n         * @param {Number} month Month fragment of your date.\n         * @param {Number} day Day fragment of your date.\n         * @return {Boolean} True if valid\n         * @private\n         * @static\n         * @example\n         *     Ink.requireModules(['Ink.Util.Validator_1'], function( InkValidator ){\n         *         console.log( InkValidator._isValidDate( 2004, 2, 29 ) ); // Result: true\n         *         console.log( InkValidator._isValidDate( 2006, 2, 29 ) ); // Result: false\n         *     });\n         */\n        _isValidDate: function(year, month, day){\n            var yearRegExp = /^\\d{4}$/;\n            var validOneOrTwo = /^\\d{1,2}$/;\n            if(yearRegExp.test(year) && validOneOrTwo.test(month) && validOneOrTwo.test(day)){\n                if(month>=1 && month<=12 && day>=1 && this._daysInMonth(month,year)>=day){\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Checks if an email address is valid\n         *\n         * @method email\n         * @param {String} email String containing the e-mail.\n         * @return {Boolean} `true` if it's a valid e-mail address.\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_mail.html \n         */\n        email: function(email)\n        {\n            var emailValido = new RegExp(\"^[_a-z0-9-]+((\\\\.|\\\\+)[_a-z0-9-]+)*@([\\\\w]*-?[\\\\w]*\\\\.)+[a-z]{2,4}$\", \"i\");\n            return !!emailValido.test(email);\n        },\n\n        /**\n         * Deprecated. Alias for email(). Use it instead.\n         *\n         * @method mail\n         * @public\n         * @param {String} mail See `email`\n         * @returns {Boolean} See `email`\n         * @static\n         * @private\n         */\n        mail: function (mail) { return Validator.email(mail); },\n\n        /**\n         * Checks if an url is valid\n         *\n         * @method url\n         * @param {String} url URL to be checked\n         * @param {Boolean} [full] If true, validates a full URL (one that should start with 'http')\n         * @return {Boolean} True if valid\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_url.html \n         */\n        url: function(url, full)\n        {\n            if(typeof full === \"undefined\" || full === false) {\n                var reHTTP = new RegExp(\"(^(http\\\\:\\\\/\\\\/|https\\\\:\\\\/\\\\/)(.+))\", \"i\");\n                if(reHTTP.test(url) === false) {\n                    url = 'http://'+url;\n                }\n            }\n\n            var reUrl = new RegExp(\"^(http:\\\\/\\\\/|https:\\\\/\\\\/)([\\\\w]*(-?[\\\\w]*)*\\\\.)+[a-z]{2,4}\", \"i\");\n            if(reUrl.test(url) === false) {\n                return false;\n            } else {\n                return true;\n            }\n        },\n\n        /**\n         * Checks if a phone is valid in Portugal\n         *\n         * @method isPTPhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid Portuguese Phone\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isPTPhone.html\n         */\n        isPTPhone: function(phone)\n        {\n\n            phone = phone.toString();\n            var aInd = [];\n            for(var i in this._indicativosPT) {\n                if(typeof(this._indicativosPT[i]) === 'string') {\n                    aInd.push(i);\n                }\n            }\n            var strInd = aInd.join('|');\n\n            var re351 = /^(00351|\\+351)/;\n            if(re351.test(phone)) {\n                phone = phone.replace(re351, \"\");\n            }\n\n            var reSpecialChars = /(\\s|\\-|\\.)+/g;\n            phone = phone.replace(reSpecialChars, '');\n            //var reInt = new RegExp(\"\\\\d\", \"i\");\n            var reInt = /[\\d]{9}/i;\n            if(phone.length === 9 && reInt.test(phone)) {\n                var reValid = new RegExp(\"^(\"+strInd+\")\");\n                if(reValid.test(phone)) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Alias function for isPTPhone\n         *\n         * @method isPortuguesePhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid Portuguese Phone\n         * @public\n         * @static\n         */\n        isPortuguesePhone: function(phone)\n        {\n            return this.isPTPhone(phone);\n        },\n\n        /**\n         * Checks if a phone is valid in Cabo Verde\n         *\n         * @method isCVPhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid Cape Verdean Phone\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isCVPhone.html \n         */\n        isCVPhone: function(phone)\n        {\n            phone = phone.toString();\n            var aInd = [];\n            for(var i in this._indicativosCV) {\n                if(typeof(this._indicativosCV[i]) === 'string') {\n                    aInd.push(i);\n                }\n            }\n            var strInd = aInd.join('|');\n\n            var re238 = /^(00238|\\+238)/;\n            if(re238.test(phone)) {\n                phone = phone.replace(re238, \"\");\n            }\n\n            var reSpecialChars = /(\\s|\\-|\\.)+/g;\n            phone = phone.replace(reSpecialChars, '');\n            //var reInt = new RegExp(\"\\\\d\", \"i\");\n            var reInt = /[\\d]{7}/i;\n            if(phone.length === 7 && reInt.test(phone)) {\n                var reValid = new RegExp(\"^(\"+strInd+\")\");\n                if(reValid.test(phone)) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Checks if a phone is valid in Angola\n         *\n         * @method isAOPhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid Angolan Phone\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isAOPhone.html \n         */\n        isAOPhone: function(phone)\n        {\n\n            phone = phone.toString();\n            var aInd = [];\n            for(var i in this._indicativosAO) {\n                if(typeof(this._indicativosAO[i]) === 'string') {\n                    aInd.push(i);\n                }\n            }\n            var strInd = aInd.join('|');\n\n            var re244 = /^(00244|\\+244)/;\n            if(re244.test(phone)) {\n                phone = phone.replace(re244, \"\");\n            }\n\n            var reSpecialChars = /(\\s|\\-|\\.)+/g;\n            phone = phone.replace(reSpecialChars, '');\n            //var reInt = new RegExp(\"\\\\d\", \"i\");\n            var reInt = /[\\d]{9}/i;\n            if(phone.length === 9 && reInt.test(phone)) {\n                var reValid = new RegExp(\"^(\"+strInd+\")\");\n                if(reValid.test(phone)) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Checks if a phone is valid in Mozambique\n         *\n         * @method isMZPhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid Mozambican Phone\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isMZPhone.html \n         */\n        isMZPhone: function(phone)\n        {\n\n            phone = phone.toString();\n            var aInd = [];\n            for(var i in this._indicativosMZ) {\n                if(typeof(this._indicativosMZ[i]) === 'string') {\n                    aInd.push(i);\n                }\n            }\n            var strInd = aInd.join('|');\n            var re258 = /^(00258|\\+258)/;\n            if(re258.test(phone)) {\n                phone = phone.replace(re258, \"\");\n            }\n\n            var reSpecialChars = /(\\s|\\-|\\.)+/g;\n            phone = phone.replace(reSpecialChars, '');\n            //var reInt = new RegExp(\"\\\\d\", \"i\");\n            var reInt = /[\\d]{8,9}/i;\n            if((phone.length === 9 || phone.length === 8) && reInt.test(phone)) {\n                var reValid = new RegExp(\"^(\"+strInd+\")\");\n                if(reValid.test(phone)) {\n                   if(phone.indexOf('2') === 0 && phone.length === 8) {\n                       return true;\n                   } else if(phone.indexOf('8') === 0 && phone.length === 9) {\n                       return true;\n                   }\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Checks if a phone is valid in Timor\n         *\n         * @method isTLPhone\n         * @param {Number} phone Phone number to be checked\n         * @return {Boolean} True if it's a valid phone from Timor-Leste\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isTLPhone.html \n         */\n        isTLPhone: function(phone)\n        {\n\n            phone = phone.toString();\n            var aInd = [];\n            for(var i in this._indicativosTL) {\n                if(typeof(this._indicativosTL[i]) === 'string') {\n                    aInd.push(i);\n                }\n            }\n            var strInd = aInd.join('|');\n            var re670 = /^(00670|\\+670)/;\n            if(re670.test(phone)) {\n                phone = phone.replace(re670, \"\");\n            }\n\n\n            var reSpecialChars = /(\\s|\\-|\\.)+/g;\n            phone = phone.replace(reSpecialChars, '');\n            //var reInt = new RegExp(\"\\\\d\", \"i\");\n            var reInt = /[\\d]{7}/i;\n            if(phone.length === 7 && reInt.test(phone)) {\n                var reValid = new RegExp(\"^(\"+strInd+\")\");\n                if(reValid.test(phone)) {\n                    return true;\n                }\n            }\n\n            return false;\n        },\n\n        /**\n         * Checks if a number is a phone number.\n         * This method validates the number in all country codes available the ones set in the second param\n         *\n         * @method isPhone\n         * @param   {String}        phone           Phone number to validate\n         * @param   {String|Array}  [countryCode]   Country code or  array of countries to validate\n         * @return  {Boolean}                       True if it's a valid phone in any country available\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isPhone.html\n         */\n        isPhone: function(){\n            var index;\n\n            if(arguments.length===0){\n                return false;\n            }\n\n            var phone = arguments[0];\n\n            if(arguments.length>1){\n                if(arguments[1].constructor === Array){\n                    var func;\n                    for(index=0; index<arguments[1].length; index++ ){\n                        if(typeof(func=this['is' + arguments[1][index].toUpperCase() + 'Phone'])==='function'){\n                            if(func(phone)){\n                                return true;\n                            }\n                        } else {\n                            throw \"Invalid Country Code!\";\n                        }\n                    }\n                } else if(typeof(this['is' + arguments[1].toUpperCase() + 'Phone'])==='function'){\n                    return this['is' + arguments[1].toUpperCase() + 'Phone'](phone);\n                } else {\n                    throw \"Invalid Country Code!\";\n                }\n            } else {\n                for(index=0; index<this._countryCodes.length; index++){\n                    if(this['is' + this._countryCodes[index] + 'Phone'](phone)){\n                        return true;\n                    }\n                }\n            }\n            return false;\n        },\n\n        /**\n         * Validates if a zip code is valid in Portugal\n         *\n         * @method codPostal\n         * @param {Number|String} cp1 If passed alone, it's the full postal code. If passed with `cp2`, it's the first fragment of the zip code, which should have 4 numeric digits.\n         * @param {Number|String} [cp2] Second fragment of the zip code, which should have 3 numeric digits.\n         * @param {Boolean} [returnBothResults] When given both `cp1` and `cp2`, return an array `[Boolean, Boolean]`, indicating which of these were valid. For example `[true, true]` means both were valid, while `[true, false]` means `cp1` was valid, and `cp2` was invalid.\n         * @return {Boolean|Array} `true` if it's a valid zip code. If `returnBothResults` is `true`, return an array as described above.\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_codPostal.html \n         */\n        codPostal: function(cp1, cp2, returnBothResults){\n            var cPostalSep = /^(\\s*\\-\\s*|\\s+)$/;\n            var trim = /^\\s+|\\s+$/g;\n            var cPostal4 = /^[1-9]\\d{3}$/;\n            var cPostal3 = /^\\d{3}$/;\n            var parserCPostal = /^(.{4})(.*)(.{3})$/;\n\n            cp1 = cp1.replace(trim,'');\n\n            if(typeof(cp2)!=='undefined'){\n                cp2 = cp2.replace(trim,'');\n                if(cPostal4.test(cp1) && cPostal3.test(cp2)){\n                    if( returnBothResults ){\n                        return [true, true];\n                    } else {\n                        return true;\n                    }\n                }\n            } else {\n                if(cPostal4.test(cp1) ){\n                    if( returnBothResults ){\n                        return [true,false];\n                    } else {\n                        return true;\n                    }\n                }\n\n                var cPostal = cp1.match(parserCPostal);\n\n                if(cPostal!==null && cPostal4.test(cPostal[1]) && cPostalSep.test(cPostal[2]) && cPostal3.test(cPostal[3])){\n                    if( returnBothResults ){\n                        return [true,false];\n                    } else {\n                        return true;\n                    }\n                }\n            }\n\n            if( returnBothResults ){\n                return [false,false];\n            } else {\n                return false;\n            }\n        },\n\n        /**\n         * Checks if a date is valid in a given format\n         *\n         * @method isDate\n         * @param {String} format Format defined in _dateParsers\n         * @param {String} dateStr Date string\n         * @return {Boolean} True if it's a valid date and in the specified format\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isDate.html \n         */\n        isDate: function(format, dateStr){\n\n\n\n            if(typeof(this._dateParsers[format])==='undefined'){\n                return false;\n            }\n            var yearIndex = this._dateParsers[format].year;\n            var monthIndex = this._dateParsers[format].month;\n            var dayIndex = this._dateParsers[format].day;\n            var dateParser = this._dateParsers[format].parser;\n            var separator = this._dateParsers[format].sep;\n\n            /* Trim Deactivated\n            * var trim = /^\\w+|\\w+$/g;\n            * dateStr = dateStr.replace(trim,\"\");\n            */\n            var data = dateStr.match(dateParser);\n            if(data!==null){\n                /* Trim Deactivated\n                * for(i=1;i<=data.length;i++){\n                *   data[i] = data[i].replace(trim,\"\");\n                *}\n                */\n                if(data[2]===data[4] && data[2]===separator){\n\n                    var _y = ((data[yearIndex].length===2) ? \"20\" + data[yearIndex].toString() : data[yearIndex] );\n\n                    if(this._isValidDate(_y,data[monthIndex].toString(),data[dayIndex].toString())){\n                        return true;\n                    }\n                }\n            }\n\n\n            return false;\n        },\n\n        /**\n         * Checks if a string is a valid color\n         *\n         * @method isColor\n         * @param {String} str Color string to be checked\n         * @return {Boolean} True if it's a valid color string\n         * @public\n         * @static\n         * @sample Ink_Util_Validator_isColor.html \n         */\n        isColor: function(str){\n            var match, valid = false,\n                keyword = /^[a-zA-Z]+$/,\n                hexa = /^#([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/,\n                rgb = /^rgb\\(\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*\\)$/,\n                rgba = /^rgba\\(\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*(1(\\.0)?|0(\\.[0-9])?)\\s*\\)$/,\n                hsl = /^hsl\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*\\)$/,\n                hsla = /^hsla\\(\\s*([0-9]{1,3})\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*([0-9]{1,3})(%)?\\s*,\\s*(1(\\.0)?|0(\\.[0-9])?)\\s*\\)$/;\n\n            // rgb(123, 123, 132) 0 to 255\n            // rgb(123%, 123%, 123%) 0 to 100\n            // rgba( 4 vals) last val: 0 to 1.0\n            // hsl(0 to 360, %, %)\n            // hsla( ..., 0 to 1.0)\n\n            if(\n                keyword.test(str) ||\n                hexa.test(str)\n            ){\n                return true;\n            }\n\n            var i;\n\n            // rgb range check\n            if((match = rgb.exec(str)) !== null || (match = rgba.exec(str)) !== null){\n                i = match.length;\n\n                while(i--){\n                    // check percentage values\n                    if((i===2 || i===4 || i===6) && typeof match[i] !== \"undefined\" && match[i] !== \"\"){\n                        if(typeof match[i-1] !== \"undefined\" && match[i-1] >= 0 && match[i-1] <= 100){\n                            valid = true;\n                        } else {\n                            return false;\n                        }\n                    }\n                    // check 0 to 255 values\n                    if(i===1 || i===3 || i===5 && (typeof match[i+1] === \"undefined\" || match[i+1] === \"\")){\n                        if(typeof match[i] !== \"undefined\" && match[i] >= 0 && match[i] <= 255){\n                            valid = true;\n                        } else {\n                            return false;\n                        }\n                    }\n                }\n            }\n\n            // hsl range check\n            if((match = hsl.exec(str)) !== null || (match = hsla.exec(str)) !== null){\n                i = match.length;\n                while(i--){\n                    // check percentage values\n                    if(i===3 || i===5){\n                        if(typeof match[i-1] !== \"undefined\" && typeof match[i] !== \"undefined\" && match[i] !== \"\" &&\n                        match[i-1] >= 0 && match[i-1] <= 100){\n                            valid = true;\n                        } else {\n                            return false;\n                        }\n                    }\n                    // check 0 to 360 value\n                    if(i===1){\n                        if(typeof match[i] !== \"undefined\" && match[i] >= 0 && match[i] <= 360){\n                            valid = true;\n                        } else {\n                            return false;\n                        }\n                    }\n                }\n            }\n\n            return valid;\n        },\n\n        /**\n         * Checks if the value is a valid IP. \n         *\n         * @method isIP\n         * @param  {String} value   Value to be checked\n         * @param  {String} ipType Type of IP to be validated. The values are: ipv4, ipv6. By default is ipv4.\n         * @return {Boolean}         True if the value is a valid IP address. False if not.\n         * @sample Ink_Util_Validator_isIP.html \n         */\n        isIP: function( value, ipType ){\n            if( typeof value !== 'string' ){\n                return false;\n            }\n\n            ipType = (ipType || 'ipv4').toLowerCase();\n\n            switch( ipType ){\n                case 'ipv4':\n                    return (/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/).test(value);\n                case 'ipv6':\n                    return (/^\\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)(\\.(25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]?\\d)){3}))|:)))(%.+)?\\s*$/).test(value);\n                default:\n                    return false;\n            }\n        },\n\n        /**\n         * Credit Card specifications, to be used in the credit card verification.\n         *\n         * @property _creditCardSpecs\n         * @type {Object}\n         * @private\n         */\n        _creditCardSpecs: {\n            'default': {\n                'length': '13,14,15,16,17,18,19',\n                'prefix': /^.+/,\n                'luhn': true\n            },\n\n            'american express': {\n                'length': '15',\n                'prefix': /^3[47]/,\n                'luhn'  : true\n            },\n\n            'diners club': {\n                'length': '14,16',\n                'prefix': /^36|55|30[0-5]/,\n                'luhn'  : true\n            },\n\n            'discover': {\n                'length': '16',\n                'prefix': /^6(?:5|011)/,\n                'luhn'  : true\n            },\n\n            'jcb': {\n                'length': '15,16',\n                'prefix': /^3|1800|2131/,\n                'luhn'  : true\n            },\n\n            'maestro': {\n                'length': '16,18',\n                'prefix': /^50(?:20|38)|6(?:304|759)/,\n                'luhn'  : true\n            },\n\n            'mastercard': {\n                'length': '16',\n                'prefix': /^5[1-5]/,\n                'luhn'  : true\n            },\n\n            'visa': {\n                'length': '13,16',\n                'prefix': /^4/,\n                'luhn'  : true\n            }\n        },\n\n        /**\n         * Luhn function, to be used when validating credit card numbers\n         * @method _luhn\n         * @private\n         * @param {Number} num Given credit card number\n         * @returns {Boolean} Whether the credit card number is valid.\n         */\n        _luhn: function (num){\n\n            num = parseInt(num,10);\n\n            if ( (typeof num !== 'number') && (num % 1 !== 0) ){\n                // Luhn can only be used on nums!\n                return false;\n            }\n\n            num = num+'';\n            // Check num length\n            var length = num.length;\n\n            // Checksum of the card num\n            var i;\n            var checksum = 0;\n\n            for (i = length - 1; i >= 0; i -= 2)\n            {\n                // Add up every 2nd digit, starting from the right\n                checksum += parseInt(num.substr(i, 1),10);\n            }\n\n            for (i = length - 2; i >= 0; i -= 2)\n            {\n                // Add up every 2nd digit doubled, starting from the right\n                var dbl = parseInt(num.substr(i, 1) * 2,10);\n\n                // Subtract 9 from the dbl where value is greater than 10\n                checksum += (dbl >= 10) ? (dbl - 9) : dbl;\n            }\n\n            // If the checksum is a multiple of 10, the number is valid\n            return (checksum % 10 === 0);\n        },\n\n        /**\n         * Checks if a number is of a specific credit card type\n         * @method isCreditCard\n         * @param  {String}  num            Number to be validates\n         * @param  {String|Array}  creditCardType Credit card type or list of types. See _creditCardSpecs for the list of supported values.\n         * @return {Boolean} Whether the number is of that credit card type (or at least one of `creditCardType` if you pass in an array).\n         * @sample Ink_Util_Validator_isCreditCard.html \n         */\n        isCreditCard: function(num, creditCardType){\n\n            if ( /\\d+/.test(num) === false ){\n                return false;\n            }\n\n            if ( typeof creditCardType === 'undefined' ){\n                creditCardType = 'default';\n            }\n            else if ( creditCardType instanceof Array ){\n                var i, ccLength = creditCardType.length;\n                for ( i=0; i < ccLength; i++ ){\n                    // Test each type for validity\n                    if (this.isCreditCard(num, creditCardType[i]) ){\n                        return true;\n                    }\n                }\n\n                return false;\n            }\n\n            // Check card type\n            creditCardType = creditCardType.toLowerCase();\n\n            if ( typeof this._creditCardSpecs[creditCardType] === 'undefined' ){\n                return false;\n            }\n\n            // Check card number length\n            var length = num.length+'';\n\n            // Validate the card length by the card type\n            if ( this._creditCardSpecs[creditCardType]['length'].split(\",\").indexOf(length) === -1 ){\n                return false;\n            }\n\n            // Check card number prefix\n            if ( !this._creditCardSpecs[creditCardType]['prefix'].test(num) ){\n                return false;\n            }\n\n            // No Luhn check required\n            if (this._creditCardSpecs[creditCardType]['luhn'] === false){\n                return true;\n            }\n\n            return this._luhn(num);\n        }\n    };\n\n    return Validator;\n\n});\n"]}