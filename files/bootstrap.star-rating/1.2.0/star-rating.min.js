/*!
 * @copyright &copy; Kartik Visweswaran, Krajee.com, 2013
 * @version 1.0.0
 * For more JQuery plugins visit http://plugins.krajee.com
 */(function(e){var t=1;var n=5;var r=1;var i=function(t,n){return typeof t==="undefined"||t===null||t===undefined||t==[]||t===""||n&&e.trim(t)===""};var s=function(e,t,n){var r=i(e.data(t))?e.attr(t):e.data(t);if(r){return r}return n[t]};var o=function(t,n){this.$element=e(t);this.init(n)};o.prototype={constructor:o,_parseAttr:function(e,o){var u=this,a=u.$element;if(a.attr("type")==="number"){var f=s(a,e,o);var l=r;if(e==="min"){l=t}else if(e==="max"){l=n}else if(e==="step"){l=r}var c=i(f)?l:f;return parseFloat(c)}return parseFloat(o[e])},listen:function(){var e=this;e.$star.on("click",function(t){if(!e.inactive){e.change(t)}});e.$clear.on("click",function(t){if(!e.inactive){e.clear()}})},init:function(s){this.options=s;this.initialValue=parseFloat(this.$element.val());this.min=typeof s.min!=="undefined"?s.min:this._parseAttr("min",s);this.max=typeof s.max!=="undefined"?s.max:this._parseAttr("max",s);this.step=typeof s.step!=="undefined"?s.step:this._parseAttr("step",s);if(isNaN(this.min)||i(this.min)){this.min=t}if(isNaN(this.max)||i(this.max)){this.max=n}if(isNaN(this.step)||i(this.step)||this.step==0){this.step=r}this.checkDisabled();this.rtl=s.rtl;this.showClear=s.showClear;this.showCaption=s.showCaption;this.size=s.size;this.defaultCaption=s.defaultCaption;this.starCaptions=s.starCaptions;this.starCaptionClasses=s.starCaptionClasses;this.clearButton=s.clearButton;this.clearButtonTitle=s.clearButtonTitle;this.clearButtonBaseClass=!i(s.clearButtonBaseClass)?s.clearButtonBaseClass:"clear-rating";this.clearButtonActiveClass=!i(s.clearButtonActiveClass)?s.clearButtonActiveClass:"clear-rating-active";this.clearCaption=s.clearCaption;this.clearCaptionClass=s.clearCaptionClass;this.clearValue=s.clearValue;this.$clearElement=s.clearElement;this.$captionElement=s.captionElement;if(typeof this.$container==="undefined"){this.$container=this.createContainer();this.$element.before(this.$container);this.$element.hide()}this.$star=this.$container.children("s");this.$stars=this.$container.find("s");this.$clear=!i(this.$clearElement)?this.$clearElement:this.$container.find("."+this.clearButtonBaseClass);this.$caption=!i(this.$captionElement)?this.$captionElement:this.$container.find(".caption");this.listen();e(this.$element[0].form).on("reset",e.proxy(this.reset,this));this.$container.attr({"class":this.getContainerClass()});if(this.showClear){this.$clear.attr({"class":this.getClearClass()})}},checkDisabled:function(){this.disabled=s(this.$element,"disabled",this.options);this.readonly=s(this.$element,"readonly",this.options);this.inactive=this.disabled||this.readonly},getContainerClass:function(){var e=this,t=e.rtl?"star-rating-rtl":"star-rating";t+=e.inactive?e.disabled?" "+t+"-disabled ":" ":" "+t+"-active ";t+="rating-"+e.size;return t},getClearClass:function(){return this.clearButtonBaseClass+" "+(this.inactive?"":this.clearButtonActiveClass)},createContainer:function(){var t=this,n=t.renderRating();return e(document.createElement("div")).html(n)},renderRating:function(){var e=this,t=e.renderStars(),n=e.renderClear(),r=e.renderCaption();return e.rtl?r+t+n:n+t+r},renderStars:function(){var e=this,t="",n="",s=e.step>0?e.step:r;var o=parseInt(e.max/s);for(var u=e.min;u<=e.max;u+=s){t+=!i(e.$element.val())&&u<=e.$element.val()?'<s class="rated">':"<s>";n+="</s>"}return t+n},renderClear:function(){var e=this;if(!e.showClear){return""}var t=e.getClearClass();if(!i(e.$clearElement)){e.$clearElement.removeClass(t).addClass(t).attr({title:e.clearButtonTitle});e.$clearElement.html(e.clearButton);return""}return'<div class="'+t+'" title="'+e.clearButtonTitle+'">'+e.clearButton+"</div>"},renderCaption:function(){var e=this,t=e.$element.val();if(!e.showCaption){return""}var n=e.fetchCaption(t);if(!i(e.$captionElement)){e.$captionElement.removeClass("caption").addClass("caption").attr({title:e.clearCaption});e.$captionElement.html(n);return""}return'<div class="caption">'+n+"</div>"},fetchCaption:function(e){var t=this;var n=parseFloat(e);var r=i(t.starCaptionClasses[n])?t.clearCaptionClass:t.starCaptionClasses[n];var s=i(t.starCaptions[n])?t.clearCaption:t.starCaptions[n];return'<span class="'+r+'">'+s+"</span>"},change:function(t){var n=this;var r=e(t.target).parentsUntil("div").length+1;r=(r-1)*n.step+n.min;var s=!i(n.starCaptions[r]);var o=s?n.starCaptionClasses[r]:n.clearCaptionClass;var u=s?n.starCaptions[r]:n.defaultCaption.replace(/\{rating\}/g,r);var a='<span class="'+o+'">'+u+"</span>";n.$element.val(r);n.$caption.html(a);n.$stars.removeClass("rated");e(t.target).removeClass("rated").addClass("rated");e(t.target).parentsUntil("div","s").removeClass("rated").addClass("rated");n.$element.trigger("rating.change",[r,a])},clear:function(){var e=this;var t='<span class="'+e.clearCaptionClass+'">'+e.clearCaption+"</span>";e.$stars.removeClass("rated");if(!e.inactive){e.$caption.html(t)}e.$element.val(e.clearValue);e.$element.trigger("rating.clear")},refresh:function(t){var n=this;if(arguments.length){var r="";n.init(e.extend(n.options,t));if(n.showClear){n.$clear.show()}else{n.$clear.hide()}if(n.showCaption){n.$caption.show()}else{n.$caption.hide()}}},update:function(e){if(arguments.length){var t=parseFloat(e);this.$element.val(t);this.initialValue=t;this.reset()}},reset:function(){var e=this,t=e.$container,n=e.initialValue,r=e.$caption;var i="";e.clear();if(n){var s=parseInt(n/e.step);t.find("s").addClass("rated");for(var o=e.min;o<=s*e.step;o+=e.step){i+=o===e.min?"s":" > s"}t.find(i+" > s").removeClass("rated");if(r){r.html(e.fetchCaption(n))}}e.$element.trigger("rating.reset")}};e.fn.rating=function(t){var n=Array.apply(null,arguments);n.shift();return this.each(function(){var r=e(this),i=r.data("rating"),s=typeof t==="object"&&t;if(!i){r.data("rating",i=new o(this,e.extend({},e.fn.rating.defaults,s,e(this).data())))}if(typeof t==="string"){i[t].apply(i,n)}})};e.fn.rating.defaults={disabled:false,readonly:false,rtl:false,size:"md",showClear:true,showCaption:true,defaultCaption:"{rating} Stars",starCaptions:{1:"One Star",2:"Two Stars",3:"Three Stars",4:"Four Stars",5:"Five Stars"},starCaptionClasses:{1:"label label-danger",2:"label label-warning",3:"label label-info",4:"label label-primary",5:"label label-success"},clearButton:'<i class="glyphicon glyphicon-minus-sign"></i>',clearButtonTitle:"Clear",clearButtonBaseClass:"clear-rating",clearButtonActiveClass:"clear-rating-active",clearCaption:"Not Rated",clearCaptionClass:"label label-default",clearValue:0,captionElement:null,clearElement:null};e(function(){var t=e("input.rating[type=number]");if(t.length>0){t.rating()}})})(jQuery)