{"version":3,"sources":["node_modules/grunt-browserify/node_modules/browserify/node_modules/browser-pack/_prelude.js","build/csscritic.umd.js","build/csscritic.concat.css","node_modules/cssify/browser.js","node_modules/ayepromise/ayepromise.js","node_modules/imagediff/imagediff.js","node_modules/rasterizehtml/dist/rasterizeHTML.js","node_modules/imagediff/browser/canvas.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/index.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/url/url.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/punycode/punycode.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/querystring-es3/index.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/is-array/index.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/ieee754/index.js","node_modules/rasterizehtml/node_modules/css-mediaquery/index.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/buffer/node_modules/base64-js/lib/b64.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/querystring-es3/decode.js","node_modules/grunt-browserify/node_modules/browserify/node_modules/querystring-es3/encode.js","node_modules/inlineresources/src/inline.js","node_modules/rasterizehtml/node_modules/xmlserializer/lib/serializer.js","node_modules/inlineresources/src/util.js","node_modules/inlineresources/src/inlineImage.js","node_modules/inlineresources/src/inlineScript.js","node_modules/inlineresources/src/inlineCss.js","node_modules/inlineresources/src/cssSupport.js","node_modules/inlineresources/src/backgroundValueParser.js","node_modules/inlineresources/node_modules/css-font-face-src/lib/index.js","node_modules/inlineresources/node_modules/cssom/lib/index.js","node_modules/inlineresources/node_modules/cssom/lib/CSSStyleDeclaration.js","node_modules/inlineresources/node_modules/cssom/lib/CSSRule.js","node_modules/inlineresources/node_modules/cssom/lib/CSSStyleRule.js","node_modules/inlineresources/node_modules/cssom/lib/MediaList.js","node_modules/inlineresources/node_modules/cssom/lib/CSSMediaRule.js","node_modules/inlineresources/node_modules/cssom/lib/CSSImportRule.js","node_modules/inlineresources/node_modules/cssom/lib/CSSFontFaceRule.js","node_modules/inlineresources/node_modules/cssom/lib/StyleSheet.js","node_modules/inlineresources/node_modules/cssom/lib/CSSStyleSheet.js","node_modules/inlineresources/node_modules/cssom/lib/CSSKeyframesRule.js","node_modules/inlineresources/node_modules/cssom/lib/CSSKeyframeRule.js","node_modules/inlineresources/node_modules/cssom/lib/MatcherList.js","node_modules/inlineresources/node_modules/cssom/lib/CSSDocumentRule.js","node_modules/inlineresources/node_modules/cssom/lib/CSSValue.js","node_modules/inlineresources/node_modules/cssom/lib/CSSValueExpression.js","node_modules/inlineresources/node_modules/cssom/lib/parse.js","node_modules/inlineresources/node_modules/cssom/lib/clone.js","node_modules/inlineresources/node_modules/css-font-face-src/lib/grammar/index.js","node_modules/inlineresources/node_modules/css-font-face-src/lib/util.js"],"names":["root","factory","define","amd","a0","b1","c2","exports","module","require","ayepromise","imagediff","rasterizeHTML","this","csscriticLib","main","regression","reporting","util","storage","selectionFilter","currentComponentLabel","testCases","component","componentLabel","supportUrlAsOnlyTestCaseInput","testCase","url","add","augmentedTestCase","clone","undefined","push","fetchStartingComparisons","all","map","readReferenceImage","then","referenceImageRecord","referenceImage","image","viewport","selectComparisons","configuredComparisons","configuredComparison","selected","isComparisonSelected","reportConfiguredComparisons","comparisonSelection","selection","isSelected","doReportConfiguredComparison","executeTestCase","startingComparison","compare","comparison","doReportComparison","execute","allPassed","startingComp","selectedComparisons","filter","comparisons","hasTestSuitePassed","doReportTestSuite","renderer","toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux","workAroundFirefoxResourcesSporadicallyMissing","htmlImage","diff","workAroundBrowserIssues","pageImage","workAroundTransparencyIssueInFirefox","compareRenderingAndReference","isEqual","adaptedHtmlImage","equal","comparisonResult","textualStatus","renderErrors","result","status","loadPageAndCompare","render","hover","active","width","height","renderResult","errors","viewportFallback","fallbackWidth","fallbackHeight","reporters","addReporter","reporter","testCaseIsResizable","attachPageAcceptHelpers","viewportWidth","viewportHeight","resizePageImage","acceptPage","storeReferenceImage","reportingMethod","reportSelectedComparison","reportDeselectedComparison","reportingFunc","reportComparison","passed","reportTestSuite","success","getDataURIForImage","canvas","window","document","createElement","context","getContext","naturalWidth","naturalHeight","drawImage","toDataURL","getImageForUrl","defer","Image","onload","resolve","onerror","reject","src","promise","getUncachableURL","delimiter","indexOf","Date","now","ajax","xhr","XMLHttpRequest","response","open","send","e","loadAsBlob","responseType","loadBlobAsText","blob","reader","FileReader","target","readAsText","loadBlobAsDataURI","readAsDataURL","excludeKeys","theMap","Array","prototype","slice","call","arguments","newMap","Object","keys","forEach","key","serializeMap","serializationEntries","sort","join","object","i","theClone","hasOwnProperty","successfulPromise","value","dataUri","nonPassingTestCases","length","hasValidTestSetup","functionReturnValues","pendingFunctionCalls","resolvedValues","functionCallResolved","idx","returnValue","browserRenderer","jobQueue","queue","cache","getOrCreateJobQueue","extractErrorMessages","error","msg","logErrorToConsole","console","doRenderHtml","parameters","drawOptions","cacheBucket","executeJs","executeJsTimeout","baseUrl","drawHTML","html","renderHtmlFromBlob","content","loadImageFromBlob","fallbackFilter","windowLocation","storageKey","fullDescription","desc","sessionStorage","getItem","filterFor","setItem","reload","filterForComponent","clearFilter","removeItem","indexeddbstorage","createDb","db","createObjectStore","keyPath","getDb","request","indexedDB","onsuccess","event","onupgradeneeded","buildKey","testCaseParameters","serializedParameters","imageUri","transaction","objectStore","put","reference","close","get","dataObj","img","busy","runJob","job","func","nextInQueue","shift","constructJob","niceReporter","pageNavigationHandlingFallback","packageVersion","originalTitle","escapeValue","toString","replace","RegExp","template","templateStr","values","_","param","elementFor","htmlString","tmp","insertAdjacentHTML","firstChild","findElementIn","container","elementClassName","querySelector","escapeId","id","headerClassName","timeTakenClassName","progressBarClassName","statusTextClassName","createContainer","parentContainer","reportBody","showHeader","appendChild","header","updateStatusInDocumentTitle","totalCount","doneCount","title","padNumber","number","renderMilliseconds","time","seconds","Math","floor","milliSeconds","showTimeTaken","timeTakenInMillis","timeTaken","textContent","setOutcomeOnHeader","successful","classList","progressBarPendingClassName","testDescription","comparisonKey","addTickToProgressBar","linkTarget","progressBar","clickableTickTemplate","deactivatedTickTemplate","tickTemplate","tick","install","markTickDone","renderErrorCount","tickElement","remove","singularPlural","singularForm","pluralForm","statusTotalText","selectedCount","totalContent","total","statusIssueText","issueCount","issueContent","doneContent","noTestsContent","doneWithoutErrors","issues","acceptAllClassName","acceptAllButton","showAcceptAllButtonIfNeccessary","acceptableEntries","statusText","button","onclick","acceptableEntry","acceptComparison","entry","setAttribute","installFallbackClearSelectionHandler","element","preventDefault","updateStatusBar","runAllUrl","clearFilterUrl","runAll","innerHTML","installFallbackComponentSelectionHandler","addComponentHeading","filterUrl","filterUrlForComponent","headlineElement","headline","runningComparisonClassName","imageContainerClassName","errorContainerClassName","imageWrapper","wrapper","serializeValue","installFallbackSelectionHandler","addComparison","titleLinkClassName","filterUrlFor","imageContainer","titleLink","canvasForImageCanvas","imageData","putImageData","diffPageImages","imageA","imageB","align","embossChanges","d","data","getDifferenceCanvas","differenceImageData","canvasForImage","style","addImageDiff","imageForDiff","acceptClassName","acceptButton","changedImageContainer","changedImageContainerClassName","outerChangedImageContainer","showComparisonWithDiff","pageAsIframe","testCaseUrl","iframe","scrolling","showComparisonWithRenderedPage","addEventListener","showComparisonWithoutReference","sameOriginWarning","showComparisonWithError","errorMsg","errorContainer","showRenderErrors","listElement","li","updateComparisonStatus","supportsReadingHtmlFromCanvas","browserIssueChecked","showBrowserWarningIfNeeded","supported","NiceReporter","outerContainer","containerElement","timeStarted","lastComponentLabel","progressTickElements","runningComparisonEntries","acceptableComparisons","body","registerComparison","comparisonElement","fakeTargetClassName","clearFakeActiveClass","previousTargets","querySelectorAll","elem","triggerFakeActiveClass","targetElement","scrollTo","getElementById","scrollIntoView","globalNavigationHandlingInstalled","installGlobalNavigationHandling","onpopstate","state","targetLink","href","targetId","substr","history","pushState","urlQueryFilter","filterParam","parseUrlSearch","search","paramString","split","keyValue","equalsIdx","serializeKeyValuePair","pair","getFilterValue","filterKeyValue","entryPair","pop","decodeURIComponent","existingQueryParams","queryPart","queryParams","encodeURIComponent","csscritic","installCallChain","self","apply","startsWith","str","prefix","needsFallback","location","indexedDbStorage","queryFilter","css","customDocument","doc","createStyleSheet","sheet","cssText","ownerNode","head","getElementsByTagName","type","styleSheet","createTextNode","byUrl","link","rel","once","wasCalled","wrappedFunction","getThenableIfExists","obj","aThenHandler","onFulfilled","onRejected","doHandlerCall","setTimeout","TypeError","callFulfilled","callRejected","handle","FULFILLED","PENDING","REJECTED","outcome","thenHandlers","doSettle","settledState","doFulfill","doReject","registerThenHandler","thenHandler","safelyResolveThenable","thenable","onceWrapper","transparentlyResolveThenablesAndSettle","fail","name","definition","Canvas","Error","message","getCanvas","getImageData","clearRect","createImageData","getCanvasRef","isImage","isType","TYPE_IMAGE","isCanvas","TYPE_CANVAS","isContext","TYPE_CONTEXT","isImageData","TYPE_IMAGE_DATA","UNDEFINED","isImageType","match","copyImageData","newImageData","newData","toImageData","toImageDataFromImage","toImageDataFromCanvas","toImageDataFromContext","toCanvas","equalWidth","a","b","equalHeight","equalDimensions","tolerance","aData","bData","abs","options","diffEqual","diffUnequal","c","cData","offsets","rowOffset","columnOffset","row","column","j","max","checkType","imageDataToPNG","outputFile","callback","base64Data","decodedImage","Function","Buffer","writeFile","jasmine","previous","toBeImageData","actual","toImageDiffEqual","expected","div","overflow","createCanvas","noConflict","d3","e4","cssMediaQuery","xmlserializer","inlineresources","uniqueIdList","joinUrl","relUrl","getConstantUniqueIdFor","isObject","parseOptionalParameters","args","proxies","monkeyPatchInstanceMethod","methodName","proxyFunc","originalFunc","baseUrlRespectingXhr","XHRObject","xhrConstructor","originalOpen","method","joinedUrl","concat","finishNotifyingXhr","totalXhrCount","doneXhrCount","waitingForPendingToClose","checkAllRequestsFinished","pendingXhrCount","originalSend","waitForRequestsToFinish","documentUtil","asArray","arrayLike","addClassNameRecursively","className","parentNode","ownerDocument","changeCssRule","rule","newRuleText","parentStyleSheet","ruleIdx","cssRules","insertRule","deleteRule","updateRuleSelector","updatedSelector","styleDefinitions","newRule","cssRulesToText","reduce","rewriteStyleContent","styleElement","matchingSimpleSelectorsRegex","simpleSelectorList","replaceSimpleSelectorsBy","caseInsensitiveReplaceFunc","selectorRegex","matchingRules","selectorText","test","newSelector","prefixMatch","selectorMatch","rewriteCssSelectorWith","oldSelector","lowercaseCssTypeSelectors","matchingTagNames","toLowerCase","findHtmlOnlyNodeNames","currentTagName","treeWalker","createTreeWalker","NodeFilter","SHOW_ELEMENT","htmlNodeNames","nonHtmlNodeNames","nextNode","currentNode","tagName","namespaceURI","documentHelper","fakeHover","hoverSelector","fakeHoverClass","fakeActive","activeSelector","fakeActiveClass","fakeFocus","focusSelector","fakeFocusClass","persistInputValues","inputs","textareas","isCheckable","input","checked","removeAttribute","textarea","rewriteTagNameSelectorsToLowerCase","mediaQueryHelper","hasEmIssue","svgImgBlueByEmMediaQuery","svg","firstPixelHasColor","r","g","hasEmMediaQueryIssue","removeChild","needsEmWorkaround","mediaQueryRule","mediaQueries","exchangeRuleWithNewContent","serializeExpression","exp","feature","modifier","serializeQueryPart","q","segments","inverse","expressions","serializeQuery","queryParts","transformEmIntoPx","em","replaceEmValueWithPx","exec","parseFloat","substituteEmWithPx","mediaQuery","parsedQuery","parse","hasChanges","rewrittenValue","replaceEmsWithPx","mediaQueryRules","anyRuleHasChanges","reworkedMediaQueries","media","rewrittenMediaQuery","workAroundWebKitEmSizeIssue","styles","CSSRule","MEDIA_RULE","browser","theWindow","createHiddenElement","visibility","position","top","left","executeJavascript","documentElement","outerHTML","iframeErrorsMessages","timeout","doResolve","contentDocument","waitForJavaScriptToRun","finishNotifyXhrProxy","contentWindow","baseUrlXhrProxy","resourceType","write","createHiddenSandboxedIFrame","sandbox","createIframeWithSizeAtZoomLevel1","zoom","scaledViewportWidth","scaledViewportHeight","calculateZoomedContentSizeAndRoundUp","actualViewport","requestedWidth","requestedHeight","calculateContentSize","selector","originalWidth","originalHeight","rootFontSize","rect","contentSize","actualViewportWidth","scrollWidth","clientWidth","actualViewportHeight","scrollHeight","clientHeight","getBoundingClientRect","getComputedStyle","fontSize","calculateDocumentContentSize","size","clip","addHTMLTagAttributes","htmlTagSubstitute","elementSubstitute","attribute","attributeMatch","helperDoc","implementation","createHTMLDocument","attributes","parseHTML","isParseError","parsedDocument","p","DOMParser","errorneousParse","parseFromString","parsererrorNS","getElementsByTagNameNS","failOnParseError","validateXHTML","xhtml","lastCacheDate","doDocumentLoad","ajaxRequest","augmentedUrl","responseXML","err","loadDocument","svg2image","checkForBlobsResult","urlForSvg","useBlobs","URL","createObjectURL","Blob","cleanUpUrl","revokeObjectURL","simpleForeignObjectSvg","supportsReadingObjectFromCanvas","readingBackFromCanvasBenefitsFromOldSchoolDataUris","blobUrl","supportsReadingFromBlobs","s","supportsBlobBuilding","checkBlobSupport","doesBenefit","checkForBlobs","buildImageUrl","renderSvg","resetEventHandlers","cleanUp","imageUrl","document2svg","zoomedElementSizingAttributes","zoomFactor","closestScaledWith","closestScaledHeight","offsetX","offsetY","round","x","y","transform","workAroundCollapsingMarginsAcrossSVGElementInWebKitLike","workAroundSafariSometimesNotShowingExternalResources","externalResourcesRequired","workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll","serializeAttributes","convertDocumentToSvg","serializeToString","getSvgForDocument","needsWorkaround","drawDocumentAsSvg","focus","rasterize","generalDrawError","drawSvgAsImg","drawImageOnCanvas","doDraw","operateJavaScriptOnDocument","inlineOptions","inlineScripts","inlineReferences","drawResult","getViewportSize","defaultWidth","defaultHeight","constructOptions","params","drawDocument","optionalArguments","workAroundFirefoxNotLoadingStylesheetStyles","replaceChild","extendedOptions","drawURL","workaround","subject","encoding","byteLength","isArray","kMaxLength","RangeError","TYPED_ARRAY_SUPPORT","_augment","Uint8Array","_isBuffer","_set","isArrayish","isBuffer","readUInt8","poolSize","parent","rootParent","SlowBuffer","buf","hexWrite","string","offset","Number","remaining","strLen","parsed","parseInt","isNaN","utf8Write","charsWritten","blitBuffer","utf8ToBytes","asciiWrite","asciiToBytes","binaryWrite","base64Write","base64ToBytes","utf16leWrite","utf16leToBytes","base64Slice","start","end","base64","fromByteArray","utf8Slice","res","min","decodeUtf8Char","String","fromCharCode","asciiSlice","ret","binarySlice","hexSlice","len","out","toHex","utf16leSlice","bytes","checkOffset","ext","checkInt","objectWriteUInt16","littleEndian","objectWriteUInt32","checkIEEE754","writeFloat","noAssert","ieee754","writeDouble","base64clean","stringtrim","INVALID_BASE64_RE","trim","n","units","Infinity","codePoint","leadSurrogate","charCodeAt","byteArray","hi","lo","toByteArray","dst","INSPECT_MAX_BYTES","ArrayBuffer","arr","foo","subarray","isEncoding","list","totalLength","pos","item","copy","loweredCase","equals","inspect","val","byteOffset","arrayIndexOf","foundIndex","log","set","v","writeUInt8","isFinite","swap","toJSON","_arr","newBuf","sliceLen","readUIntLE","mul","readUIntBE","readUInt16LE","readUInt16BE","readUInt32LE","readUInt32BE","readIntLE","pow","readIntBE","readInt8","readInt16LE","readInt16BE","readInt32LE","readInt32BE","readFloatLE","read","readFloatBE","readDoubleLE","readDoubleBE","writeUIntLE","writeUIntBE","writeUInt16LE","writeUInt16BE","writeUInt32LE","writeUInt32BE","writeIntLE","sub","writeIntBE","writeInt8","writeInt16LE","writeInt16BE","writeInt32LE","writeInt32BE","writeFloatLE","writeFloatBE","writeDoubleLE","writeDoubleBE","target_start","fill","toArrayBuffer","buffer","BP","constructor","toLocaleString","Url","protocol","slashes","auth","host","port","hostname","hash","query","pathname","path","urlParse","parseQueryString","slashesDenoteHost","u","urlFormat","isString","format","urlResolve","source","relative","urlResolveObject","resolveObject","arg","isNull","isNullOrUndefined","punycode","protocolPattern","portPattern","delims","unwise","autoEscape","nonHostChars","hostEndingChars","hostnameMaxLen","hostnamePartPattern","hostnamePartStart","unsafeProtocol","javascript","javascript:","hostlessProtocol","slashedProtocol","http","https","ftp","gopher","file","http:","https:","ftp:","gopher:","file:","querystring","rest","proto","lowerProto","hostEnd","hec","atSign","lastIndexOf","parseHost","ipv6Hostname","hostparts","l","part","newpart","k","validParts","notHost","bit","unshift","domainArray","newOut","encode","h","ae","esc","escape","qm","stringify","charAt","relPath","isSourceAbs","isRelAbs","mustEndAbs","removeAllDots","srcPath","psychotic","authInHost","last","hasTrailingSlash","up","splice","isAbsolute","array","fn","mapDomain","regexSeparators","ucs2decode","extra","output","counter","ucs2encode","stringFromCharCode","basicToDigit","base","digitToBasic","digit","flag","adapt","delta","numPoints","firstTime","damp","baseMinusTMin","tMax","skew","decode","basic","index","oldi","w","t","baseMinusT","inputLength","initialN","bias","initialBias","maxInt","tMin","handledCPCount","basicLength","m","currentValue","handledCPCountPlusOne","qMinusT","toUnicode","domain","regexPunycode","toASCII","regexNonASCII","freeExports","freeModule","freeGlobal","global","not-basic","invalid-input","version","ucs2","nodeType","isLE","mLen","nBytes","eLen","eMax","eBias","nBits","NaN","rt","LN2","matchQuery","parseQuery","some","typeMatch","expressionsMatch","every","expression","expValue","toPx","toDpi","toDecimal","captures","RE_MEDIA_QUERY","RE_MQ_EXPRESSION","RE_MQ_FEATURE","ratio","numbers","decimal","resolution","RE_RESOLUTION_UNIT","RE_LENGTH_UNIT","lookup","elt","code","PLUS","PLUS_URL_SAFE","SLASH","SLASH_URL_SAFE","NUMBER","UPPER","LOWER","b64ToByteArray","b64","L","placeHolders","Arr","uint8ToBase64","uint8","num","tripletToBase64","temp","extraBytes","base64js","prop","qs","sep","eq","regexp","maxKeys","kstr","vstr","xs","f","stringifyPrimitive","objectKeys","ks","inlineImage","inlineScript","inlineCss","cssSupport","getUrlBasePath","parameterHashFunction","JSON","memoizeFunctionOnCaching","memoize","requestExternalsForStylesheet","styleContent","alreadyLoadedCssUrls","rulesForCssText","loadCSSImportsForRules","cssImportResult","loadAndInlineCSSResourcesForRules","cssResourcesResult","loadAndInlineCssForStyle","processExternals","childNodes","nodeValue","cloneArray","getCssStyleElements","loadAndInlineStyles","allErrors","getDocumentBaseUrl","substituteLinkWithInlineStyle","oldLinkNode","styleNode","insertBefore","requestStylesheetAndInlineResources","hasChangesFromPathAdjustment","adjustPathsOfCssResources","loadLinkedCSS","cssHref","documentBaseUrl","ajaxOptions","processStylesheet","getCssStylesheetLinks","links","loadAndInlineCssLinks","loadAndInlineImages","inline","loadAndInlineScript","inlineFuncs","removeInvalidCharacters","serializeAttributeValue","serializeTextContent","serializeAttribute","attr","getTagName","node","serializeNamespace","nodeHasXmlnsAttr","attrs","serializeChildren","childNode","nodeTreeToXHTML","serializeTag","serializeText","text","serializeComment","serializeCDATA","nodeName","baseURI","nodeList","isDataUri","promises","pendingPromiseCount","collectAndReportErrors","overrideMimeType","mimeType","binaryAjax","binaryContent","detectMimeType","substring","getDataURIForImageURL","base64Content","btoa","constantUniqueIdFor","hasher","memo","retValue","argumentHash","funcHash","encodeImageAsDataURI","documentBase","dataURI","filterExternalImages","images","filterInputsForImageType","toArray","imageInputs","externalImages","loadLinkedScript","script","escapeClosingTags","substituteExternalScriptWithInline","scriptNode","jsCode","removeNamedItem","getScripts","scripts","backgroundValueParser","fontFaceSrcValueParser","updateCssPropertyValue","property","setProperty","getPropertyPriority","findBackgroundImageRules","STYLE_RULE","getPropertyValue","findBackgroundDeclarations","rules","backgroundDeclarations","findFontFaceRules","FONT_FACE_RULE","findCSSImportRules","IMPORT_RULE","findExternalBackgroundUrls","parsedBackground","matchIndices","backgroundLayer","findExternalFontFaceUrls","parsedFontFaceSources","sourceIndices","sourceItem","backgroundRules","change","declaration","backgroundValue","externalBackgroundIndices","backgroundLayerIndex","relativeUrl","serialize","externalFontFaceUrlIndices","fontFaceSrcDeclaration","fontFaceUrlIndex","changeFontFaceRuleSrc","cssUrl","exchangeRule","substituteRule","newCssRules","fulfilledPromise","loadAndInlineCSSImport","cssHrefRelativeToDoc","unquoteString","externalCssRules","rulesToInline","moreErrors","loadAndInlineBackgroundImages","externalBackgroundLayerIndices","iterateOverRulesAndInlineBackgroundImages","cssHasChanges","loadAndInlineFontFace","srcDeclarationValue","urlIndex","fontSrc","iterateOverRulesAndInlineFontFace","cssom","quotedUrl","doubleQuoteRegex","singleQuoteRegex","rulesForCssTextFromBrowser","browserHasBackgroundImageUrlIssue","newSrc","trimCSSWhitespace","whitespaceRegex","extractCssUrl","urlRegex","sliceBackgroundDeclaration","backgroundDeclarationText","outerRepeatedMatch","functionParamRegexS","valueRegexS","simpleSingularBackgroundRegexS","simpleBackgroundRegexS","simpleSingularBackgroundRegex","backgroundLayers","getValues","singularBackgroundDeclaration","repeatedMatch","valueRegex","backgroundValues","findBackgroundImageUrlInValues","backgroundLayerValues","urlMatch","preUrl","postUrl","grammar","SyntaxError","fontFaceSourceValue","itemValue","local","CSSStyleDeclaration","CSSStyleRule","MediaList","CSSMediaRule","CSSImportRule","CSSFontFaceRule","StyleSheet","CSSStyleSheet","CSSKeyframesRule","CSSKeyframeRule","MatcherList","CSSDocumentRule","CSSValue","CSSValueExpression","CSSOM","parentRule","_importants","priority","removeProperty","prevValue","getPropertyCSSValue","getPropertyShorthand","isPropertyImplicit",{"end":{"file":"?","comments_before":[],"nlb":false,"endpos":2540,"endcol":12,"endline":112,"pos":2533,"col":5,"line":112,"value":"cssText","type":"name"},"start":{"file":"?","comments_before":[],"nlb":false,"endpos":2540,"endcol":12,"endline":112,"pos":2533,"col":5,"line":112,"value":"cssText","type":"name"},"name":"cssText"},"properties","dummyRule","PAGE_RULE","WEBKIT_KEYFRAMES_RULE","WEBKIT_KEYFRAME_RULE","defineProperty","ruleText","character","SIGNIFICANT_WHITESPACE","styleRule","mediaText","appendMedium","medium","deleteMedium","cssTexts","cssRule","_vendorPrefix","keyText","matcherText","appendMatcher","matcher","deleteMatcher","_getConstructorName","Exception","token","_token","_idx","info","paren","_parseJSComment","_parseJSRexExp","_parseJSString","nextChar","endIdx","commentEndChar","startIdx","_findMatchedIdx","before","legalRegx","isLegal","reg","NOT_FOUND","matched","nextNewLineIdx","mediaRule","importRule","fontFaceRule","keyframesRule","documentRule","atRule","importRule-begin","atBlock","documentRule-begin","currentScope","atKeyframesRegExp","parseError","lines","lineCount","charCount","line","__starts","lastIndex","matchKeyframes","__ends","stylesheet","cloned","RULE_TYPES",1,4,8,9,"rulesLength","ruleClone","styleClone","styleLength","peg$subclass","child","ctor","found","peg$computePosDetails","advance","details","startPos","endPos","ch","seenCR","peg$cachedPos","peg$cachedPosDetails","peg$fail","peg$maxFailPos","peg$currPos","peg$maxFailExpected","peg$buildException","cleanupExpected","description","buildMessage","stringEscape","hex","toUpperCase","expectedDesc","foundDesc","expectedDescs","posDetails","peg$parsestart","s0","s1","peg$parsesourceEntries","peg$FAILED","peg$reportedPos","peg$c1","s2","s3","s4","s5","peg$parsesourceEntry","peg$parsewhitespace","peg$c3","peg$silentFails","peg$c4","peg$c5","peg$c2","peg$c6","peg$parseurlEntry","peg$parselocalEntry","peg$parseurl","peg$parseformat","peg$c7","peg$c8","peg$c9","peg$c10","peg$parsevalue","peg$c11","peg$c12","peg$c13","peg$c14","peg$c15","peg$c16","peg$c17","peg$c18","peg$c19","peg$c20","peg$c21","peg$c22","peg$c23","peg$result","peg$startRuleFunctions","peg$startRuleFunction","chars","extractValue","startRule"],"mappings":"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","file":"bundle.js","sourcesContent":["(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})","(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"ayepromise\",\"imagediff\",\"rasterizeHTML\"], function (a0,b1,c2) {\n      return (root['csscritic'] = factory(a0,b1,c2));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"ayepromise\"),require(\"imagediff\"),require(\"rasterizehtml\"),require(\"../build/csscritic.concat.css\"));\n  } else {\n    root['csscritic'] = factory(ayepromise,imagediff,rasterizeHTML);\n  }\n}(this, function (ayepromise, imagediff, rasterizeHTML) {\n\nvar csscriticLib = {};\n\ncsscriticLib.main = function (regression, reporting, util, storage, selectionFilter) {\n    \"use strict\";\n\n    var module = {};\n\n    var testCases = [],\n        currentComponentLabel;\n\n\n    module.component = function (componentLabel) {\n        currentComponentLabel = componentLabel;\n    };\n\n\n    var supportUrlAsOnlyTestCaseInput = function (testCase) {\n        if (typeof testCase === 'string') {\n            return {\n                url: testCase\n            };\n        }\n        return testCase;\n    };\n\n    module.add = function (testCase) {\n        var augmentedTestCase = util.clone(supportUrlAsOnlyTestCaseInput(testCase));\n\n        if (currentComponentLabel && augmentedTestCase.component === undefined) {\n            augmentedTestCase.component = currentComponentLabel;\n        }\n\n        testCases.push(augmentedTestCase);\n    };\n\n\n    var fetchStartingComparisons = function (testCases) {\n        return util.all(testCases.map(function (testCase) {\n            return storage.readReferenceImage(testCase)\n                .then(function (referenceImageRecord) {\n                    return {\n                        testCase: testCase,\n                        referenceImage: referenceImageRecord.image,\n                        viewport: referenceImageRecord.viewport\n                    };\n                }, function () {\n                    // no referenceImage found\n                    return {\n                        testCase: testCase\n                    };\n                });\n        }));\n    };\n\n    var selectComparisons = function (configuredComparisons) {\n        return configuredComparisons.map(function (configuredComparison) {\n            return {\n                configuredComparison: configuredComparison,\n                selected: !selectionFilter || selectionFilter.isComparisonSelected(configuredComparison)\n            };\n        });\n    };\n\n    var reportConfiguredComparisons = function (comparisonSelection) {\n        return util.all(comparisonSelection.map(function (selection) {\n            var isSelected = selection.selected;\n            return reporting.doReportConfiguredComparison(selection.configuredComparison, isSelected);\n        }));\n    };\n\n    var executeTestCase = function (startingComparison) {\n        return regression.compare(startingComparison).then(function (comparison) {\n            return reporting.doReportComparison(comparison).then(function () {\n                return comparison;\n            });\n        });\n    };\n\n    module.execute = function () {\n        var comparisonSelection, allPassed;\n\n        return fetchStartingComparisons(testCases)\n            .then(function (startingComp) {\n                comparisonSelection = selectComparisons(startingComp);\n\n                return reportConfiguredComparisons(comparisonSelection);\n            })\n            .then(function () {\n                var selectedComparisons = comparisonSelection.filter(function (selection) {\n                    return selection.selected;\n                }).map(function (selection) {\n                    return selection.configuredComparison;\n                });\n\n                return util.all(selectedComparisons.map(\n                    executeTestCase\n                ));\n            })\n            .then(function (comparisons) {\n                allPassed = util.hasTestSuitePassed(comparisons);\n            })\n            .then(function () {\n                return reporting.doReportTestSuite(allPassed);\n            })\n            .then(function () {\n                return allPassed;\n            });\n    };\n\n    return module;\n};\n\ncsscriticLib.regression = function (renderer, util, imagediff) {\n    \"use strict\";\n\n    var module = {};\n\n    var toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux = 1;\n\n    var workAroundFirefoxResourcesSporadicallyMissing = function (htmlImage, referenceImage) {\n        if (referenceImage) {\n            // This does nothing meaningful for us, but seems to trigger Firefox to load any missing resources.\n            imagediff.diff(htmlImage, referenceImage);\n        }\n    };\n\n    var workAroundBrowserIssues = function (pageImage, referenceImage) {\n        workAroundFirefoxResourcesSporadicallyMissing(pageImage, referenceImage);\n\n        return util.workAroundTransparencyIssueInFirefox(pageImage);\n    };\n\n    var compareRenderingAndReference = function (pageImage, referenceImage) {\n        var isEqual;\n\n        return workAroundBrowserIssues(pageImage, referenceImage).then(function (adaptedHtmlImage) {\n            if (referenceImage) {\n                isEqual = imagediff.equal(\n                    adaptedHtmlImage,\n                    referenceImage,\n                    toleranceToWorkAroundFirefoxRenderingAFewPixelsIndeterministicallyOnLinux\n                );\n                return isEqual ? \"passed\" : \"failed\";\n            } else {\n                return \"referenceMissing\";\n            }\n        });\n    };\n\n    var comparisonResult = function (textualStatus, testCase, viewport, renderErrors, pageImage, referenceImage) {\n        var result = {\n            status: textualStatus,\n            testCase: testCase,\n            viewport: util.clone(viewport),\n            renderErrors: renderErrors\n        };\n\n        if (pageImage) {\n            result.pageImage = pageImage;\n        }\n        if (referenceImage) {\n            result.referenceImage = referenceImage;\n        }\n        return result;\n    };\n\n    var loadPageAndCompare = function (testCase, viewport, referenceImage) {\n        return renderer.render({\n            url: testCase.url,\n            hover: testCase.hover,\n            active: testCase.active,\n            width: viewport.width,\n            height: viewport.height\n        }).then(function (renderResult) {\n            return compareRenderingAndReference(renderResult.image, referenceImage).then(function (textualStatus) {\n                return comparisonResult(textualStatus,\n                                        testCase,\n                                        viewport,\n                                        renderResult.errors,\n                                        renderResult.image,\n                                        referenceImage);\n            });\n        }, function () {\n            return comparisonResult(\"error\",\n                                    testCase,\n                                    viewport,\n                                    []);\n        });\n    };\n\n    var viewportFallback = function (testCase) {\n        var fallbackWidth = 800,\n            fallbackHeight = 100;\n        return {\n            width: testCase.width || fallbackWidth,\n            height: testCase.height || fallbackHeight\n        };\n    };\n\n    module.compare = function (startingComparison) {\n        var viewport = startingComparison.viewport;\n\n        if (startingComparison.referenceImage === undefined) {\n            viewport = viewportFallback(startingComparison.testCase);\n        }\n\n        return loadPageAndCompare(startingComparison.testCase, viewport, startingComparison.referenceImage);\n    };\n\n    return module;\n};\n\ncsscriticLib.reporting = function (renderer, storage, util) {\n    \"use strict\";\n\n    var module = {};\n\n    var reporters = [];\n\n    module.addReporter = function (reporter) {\n        reporters.push(reporter);\n    };\n\n    var testCaseIsResizable = function (testCase) {\n        return testCase.width === undefined && testCase.height === undefined;\n    };\n\n    var attachPageAcceptHelpers = function (comparison) {\n        var viewportWidth, viewportHeight;\n\n        if (comparison.pageImage) {\n            viewportWidth = comparison.viewport.width;\n            viewportHeight = comparison.viewport.height;\n\n            if (testCaseIsResizable(comparison.testCase)) {\n                comparison.resizePageImage = function (width, height) {\n                    viewportWidth = width;\n                    viewportHeight = height;\n\n                    return renderer.render({\n                        url: comparison.testCase.url,\n                        hover: comparison.testCase.hover,\n                        active: comparison.testCase.active,\n                        width: width,\n                        height: height\n                    }).then(function (renderResult) {\n                        comparison.pageImage = renderResult.image;\n                        return renderResult.image;\n                    });\n                };\n            }\n            comparison.acceptPage = function () {\n                storage.storeReferenceImage(comparison.testCase, comparison.pageImage, {\n                    width: viewportWidth,\n                    height: viewportHeight\n                });\n            };\n        }\n    };\n\n    var reportingMethod = function (reporter, isSelected) {\n        if (isSelected) {\n            return reporter.reportSelectedComparison;\n        } else {\n            return reporter.reportDeselectedComparison;\n        }\n    };\n\n    module.doReportConfiguredComparison = function (configuredComparison, isSelected) {\n        return util.all(reporters.map(function (reporter) {\n            var reportingFunc = reportingMethod(reporter, isSelected);\n            if (reportingFunc) {\n                return reportingFunc(configuredComparison);\n            }\n        }));\n    };\n\n    module.doReportComparison = function (comparison) {\n        var result = util.clone(comparison);\n\n        attachPageAcceptHelpers(result);\n\n        return util.all(reporters.map(function (reporter) {\n            if (reporter.reportComparison) {\n                return reporter.reportComparison(result);\n            }\n        }));\n    };\n\n    module.doReportTestSuite = function (passed) {\n        return util.all(reporters.map(function (reporter) {\n            if (reporter.reportTestSuite) {\n                return reporter.reportTestSuite({success: passed});\n            }\n        }));\n    };\n\n    return module;\n};\n\ncsscriticLib.util = function () {\n    \"use strict\";\n\n    var module = {};\n\n    module.getDataURIForImage = function (image) {\n        var canvas = window.document.createElement(\"canvas\"),\n            context = canvas.getContext(\"2d\");\n\n        canvas.width = image.naturalWidth;\n        canvas.height = image.naturalHeight;\n\n        context.drawImage(image, 0, 0);\n\n        return canvas.toDataURL(\"image/png\");\n    };\n\n    module.getImageForUrl = function (url) {\n        var defer = ayepromise.defer(),\n            image = new window.Image();\n\n        image.onload = function () {\n            defer.resolve(image);\n        };\n        image.onerror = function () {\n            defer.reject();\n        };\n        image.src = url;\n\n        return defer.promise;\n    };\n\n    var getUncachableURL = function (url) {\n        var delimiter;\n        if (url.indexOf(\"?\") < 0) {\n            delimiter = \"?\";\n        } else {\n            delimiter = \"&\";\n        }\n        return url + delimiter + \"_=\" + Date.now();\n    };\n\n    module.ajax = function (url) {\n        var defer = ayepromise.defer(),\n            xhr = new XMLHttpRequest();\n\n        xhr.onload = function () {\n            if (xhr.status === 200 || xhr.status === 0) {\n                defer.resolve(xhr.response);\n            } else {\n                defer.reject();\n            }\n        };\n\n        xhr.onerror = function () {\n            defer.reject();\n        };\n\n        try {\n            xhr.open('get', getUncachableURL(url), true);\n            xhr.send();\n        } catch (e) {\n            defer.reject();\n        }\n\n        return defer.promise;\n    };\n\n    module.loadAsBlob = function (url) {\n        var defer = ayepromise.defer(),\n            xhr = new XMLHttpRequest();\n\n        xhr.onload = function () {\n            if (xhr.status === 200 || xhr.status === 0) {\n                defer.resolve(xhr.response);\n            } else {\n                defer.reject();\n            }\n        };\n\n        xhr.onerror = function () {\n            defer.reject();\n        };\n\n        try {\n            xhr.open('get', getUncachableURL(url), true);\n            xhr.responseType = 'blob';\n            xhr.send();\n        } catch (e) {\n            defer.reject();\n        }\n\n        return defer.promise;\n    };\n\n    module.loadBlobAsText = function (blob) {\n        var defer = ayepromise.defer(),\n            reader = new FileReader();\n\n        reader.onload = function (e) {\n            defer.resolve(e.target.result);\n        };\n\n        reader.onerror = function () {\n            defer.reject();\n        };\n\n        reader.readAsText(blob);\n\n        return defer.promise;\n    };\n\n    module.loadBlobAsDataURI = function (blob) {\n        var defer = ayepromise.defer(),\n            reader = new FileReader();\n\n        reader.onload = function (e) {\n            defer.resolve(e.target.result);\n        };\n\n        reader.onerror = function () {\n            defer.reject();\n        };\n\n        reader.readAsDataURL(blob);\n\n        return defer.promise;\n\n    };\n\n    // excludeKeys(theMap, excludeKey...)\n    module.excludeKeys = function (theMap) {\n        var excludeKeys = Array.prototype.slice.call(arguments, 1),\n            newMap = {};\n\n        Object.keys(theMap).forEach(function (key) {\n            if (excludeKeys.indexOf(key) === -1) {\n                newMap[key] = theMap[key];\n            }\n        });\n\n        return newMap;\n    };\n\n    module.serializeMap = function (theMap) {\n        var serializationEntries = [],\n            keys = Object.keys(theMap);\n\n        keys.sort();\n        keys.forEach(function (key) {\n            serializationEntries.push(key + '=' + theMap[key]);\n        });\n        return serializationEntries.join(',');\n    };\n\n    module.clone = function (object) {\n        var theClone = {},\n            i;\n        for (i in object) {\n            if (object.hasOwnProperty(i)) {\n               theClone[i] = object[i];\n            }\n        }\n        return theClone;\n    };\n\n    var successfulPromise = function (value) {\n        var defer = ayepromise.defer();\n        defer.resolve(value);\n        return defer.promise;\n    };\n\n    module.workAroundTransparencyIssueInFirefox = function (image) {\n        // Work around bug https://bugzilla.mozilla.org/show_bug.cgi?id=790468 where the content of a canvas\n        //   drawn to another one will be slightly different if transparency is involved.\n        // Here the reference image has been drawn to a canvas once (to serialize it to localStorage), while the\n        //   image of the newly rendered page hasn't.  Solution: apply the same transformation to the second image, too.\n        var dataUri;\n        try {\n            dataUri = module.getDataURIForImage(image);\n        } catch (e) {\n            // Fallback for Chrome & Safari\n            return successfulPromise(image);\n        }\n\n        return module.getImageForUrl(dataUri);\n    };\n\n    module.hasTestSuitePassed = function (comparisons) {\n        var nonPassingTestCases = comparisons.filter(function (comparison) {\n                return comparison.status !== \"passed\";\n            }),\n            allPassed = nonPassingTestCases.length === 0,\n            hasValidTestSetup = comparisons.length > 0;\n\n        return hasValidTestSetup && allPassed;\n    };\n\n    module.all = function (functionReturnValues) {\n        var defer = ayepromise.defer(),\n            pendingFunctionCalls = functionReturnValues.length,\n            resolvedValues = [];\n\n        var functionCallResolved = function (value, idx) {\n            pendingFunctionCalls -= 1;\n            resolvedValues[idx] = value;\n\n            if (pendingFunctionCalls === 0) {\n                defer.resolve(resolvedValues);\n            }\n        };\n\n        if (functionReturnValues.length === 0) {\n            defer.resolve([]);\n            return defer.promise;\n        }\n\n        functionReturnValues.forEach(function (returnValue, idx) {\n            if (returnValue && returnValue.then) {\n                returnValue.then(function (result) {\n                    functionCallResolved(result, idx);\n                }, function (e) {\n                    defer.reject(e);\n                });\n            } else {\n                functionCallResolved(returnValue, idx);\n            }\n        });\n        return defer.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.browserRenderer = function (util, jobQueue, rasterizeHTML) {\n    \"use strict\";\n\n    var module = {};\n\n    var cache = {};\n\n    var queue;\n\n    var getOrCreateJobQueue = function () {\n        if (!queue) {\n            queue = jobQueue();\n        }\n        return queue;\n    };\n\n    var extractErrorMessages = function (errors) {\n        return errors.map(function (error) {\n            return error.msg;\n        });\n    };\n\n    var logErrorToConsole = function (e) {\n        console.error(e);\n\n        throw e;\n    };\n\n    var doRenderHtml = function (parameters) {\n        var drawOptions = {\n                cache: 'repeated',\n                cacheBucket: cache,\n                width: parameters.width,\n                height: parameters.height,\n                executeJs: true,\n                executeJsTimeout: 50,\n                baseUrl: parameters.baseUrl\n            };\n        if (parameters.hover) {\n            drawOptions.hover = parameters.hover;\n        }\n        if (parameters.active) {\n            drawOptions.active = parameters.active;\n        }\n\n        return rasterizeHTML.drawHTML(parameters.html, drawOptions).then(function (result) {\n            var renderErrors = extractErrorMessages(result.errors);\n\n            return {\n                image: result.image,\n                errors: renderErrors\n            };\n        }, logErrorToConsole);\n    };\n\n    var renderHtmlFromBlob = function (blob, parameters) {\n        return util.loadBlobAsText(blob).then(function (content) {\n            return doRenderHtml({\n                html: content,\n                baseUrl: parameters.url,\n                width: parameters.width,\n                height: parameters.height,\n                hover: parameters.hover,\n                active: parameters.active\n            });\n        });\n    };\n\n    var loadImageFromBlob = function (blob, parameters) {\n        return util.loadBlobAsDataURI(blob)\n            .then(util.getImageForUrl)\n            .then(function (image) {\n                return {\n                    image: image,\n                    errors: []\n                };\n            }, function () {\n                // It's not an image, so it must be a HTML page\n                return renderHtmlFromBlob(blob, parameters);\n            });\n    };\n\n    module.render = function (parameters) {\n        // Execute render jobs one after another to stabilise rendering (especially JS execution).\n        // Also provides a more fluid response. Performance seems not to be affected.\n        return getOrCreateJobQueue().execute(function () {\n            return util.loadAsBlob(parameters.url)\n                .then(function (blob) {\n                    return loadImageFromBlob(blob, parameters);\n                });\n        });\n    };\n\n    return module;\n};\n\ncsscriticLib.fallbackFilter = function (windowLocation) {\n    \"use strict\";\n\n    var module = {};\n\n    var storageKey = 'csscriticFallbackFilter';\n\n    var fullDescription = function (testCase) {\n        return testCase.component ? testCase.component + ' ' + testCase.desc : testCase.desc;\n    };\n\n    module.isComparisonSelected = function (comparison) {\n        var filter = sessionStorage.getItem(storageKey);\n\n        if (!filter) {\n            return true;\n        }\n\n        if (comparison.testCase.desc && fullDescription(comparison.testCase) === filter) {\n            return true;\n        }\n        if (comparison.testCase.component && comparison.testCase.component === filter) {\n            return true;\n        }\n\n        return !filter || comparison.testCase.url === filter;\n    };\n\n    module.filterFor = function (testCase) {\n        var filter;\n\n        if (testCase.desc) {\n            filter = fullDescription(testCase);\n        } else {\n            filter = testCase.url;\n        }\n        sessionStorage.setItem(storageKey, filter);\n\n        windowLocation.reload();\n    };\n\n    module.filterForComponent = function (componentLabel) {\n        sessionStorage.setItem(storageKey, componentLabel);\n\n        windowLocation.reload();\n    };\n\n    module.clearFilter = function () {\n        sessionStorage.removeItem(storageKey);\n\n        windowLocation.reload();\n    };\n\n    return module;\n};\n\ncsscriticLib.indexeddbstorage = function (util) {\n    \"use strict\";\n\n    var module = {};\n\n    var createDb = function(db) {\n        db.createObjectStore('references', { keyPath: \"testCase\" });\n    };\n\n    var getDb = function () {\n        var defer = ayepromise.defer(),\n            request = indexedDB.open('csscritic', 1);\n\n        request.onsuccess = function (event) {\n            var db = event.target.result;\n            defer.resolve(db);\n        };\n        request.onupgradeneeded = function (event) {\n            var db = event.target.result;\n            createDb(db);\n        };\n        return defer.promise;\n    };\n\n    var buildKey = function (testCase) {\n        var testCaseParameters = util.excludeKeys(testCase, 'url'),\n            serializedParameters = util.serializeMap(testCaseParameters),\n            key = testCase.url;\n\n        if (serializedParameters) {\n            key += ',' + serializedParameters;\n        }\n\n        return key;\n    };\n\n    module.storeReferenceImage = function (testCase, referenceImage, viewport) {\n        var defer = ayepromise.defer(),\n            imageUri;\n\n        imageUri = util.getDataURIForImage(referenceImage);\n\n        var key = buildKey(testCase);\n\n        getDb().then(function (db) {\n            var request = db.transaction(['references'], 'readwrite')\n                .objectStore('references')\n                .put({\n                    testCase: key,\n                    reference: {\n                        imageUri: imageUri,\n                        viewport: viewport\n                    }\n                });\n\n            request.onsuccess = function () {\n                db.close();\n\n                defer.resolve();\n            };\n        });\n\n        return defer.promise;\n    };\n\n    module.readReferenceImage = function (testCase) {\n        var defer = ayepromise.defer(),\n            key = buildKey(testCase);\n\n        getDb().then(function (db) {\n            var request = db.transaction(['references'])\n                .objectStore('references')\n                .get(key);\n\n            request.onsuccess = function () {\n                db.close();\n\n                if (request.result === undefined || request.result.reference === undefined || request.result.reference.imageUri === undefined) {\n                    defer.reject();\n                    return;\n                }\n\n                var dataObj = request.result.reference;\n\n                util.getImageForUrl(dataObj.imageUri).then(function (img) {\n                    var viewport = dataObj.viewport || {\n                        width: img.width,\n                        height: img.height\n                    };\n\n                    defer.resolve({\n                        image: img,\n                        viewport: viewport\n                    });\n                }, defer.reject);\n            };\n        });\n\n        return defer.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.jobQueue = function () {\n    \"use strict\";\n\n    var module = {};\n\n    var jobQueue = [],\n        busy = false;\n\n    var runJob = function (job) {\n        var result = job.func();\n\n        job.resolve(result);\n        return result;\n    };\n\n    var nextInQueue = function () {\n        var job;\n        if (jobQueue.length > 0) {\n            busy = true;\n\n            job = jobQueue.shift();\n\n            runJob(job)\n                .then(nextInQueue, nextInQueue);\n        } else {\n            busy = false;\n        }\n    };\n\n    var constructJob = function (func) {\n        var defer = ayepromise.defer();\n\n        return {\n            func: func,\n            resolve: defer.resolve,\n            promise: defer.promise\n        };\n    };\n\n    module.execute = function (func) {\n        var job = constructJob(func);\n\n        jobQueue.push(job);\n        if (!busy) {\n            nextInQueue();\n        }\n\n        return job.promise;\n    };\n\n    return module;\n};\n\ncsscriticLib.niceReporter = function (util, selectionFilter, pageNavigationHandlingFallback, rasterizeHTML, packageVersion) {\n    \"use strict\";\n\n    var module = {};\n\n    // our very own templating implementation\n\n    var escapeValue = function (value) {\n        return value.toString()\n            .replace(/&/g, '&amp;')\n            .replace(new RegExp('<'), '&lt;', 'g') // work around https://github.com/cburgmer/inlineresources/issues/2\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n    };\n\n    var template = function (templateStr, values) {\n        return templateStr.replace(/\\{\\{(\\w+)\\}\\}/g, function (_, param) {\n            var value = values[param] !== undefined ? values[param] : '';\n            return escapeValue(value);\n        });\n    };\n\n    var elementFor = function (htmlString) {\n        var tmp = document.createElement('body');\n        tmp.insertAdjacentHTML('beforeend', htmlString);\n        return tmp.firstChild;\n    };\n\n    var findElementIn = function (container, elementClassName) {\n        return container.querySelector('.' + elementClassName);\n    };\n\n    var escapeId = function (id) {\n        return id.replace(' ', '_', 'g');\n    };\n\n    // container\n\n    var headerClassName = 'header',\n        timeTakenClassName = 'timeTaken',\n        progressBarClassName = 'progressBar',\n        statusTextClassName = 'statusText';\n\n    var createContainer = function (parentContainer) {\n        var reportBody = elementFor('<div class=\"cssCriticNiceReporter\"></div>');\n\n        showHeader(reportBody);\n\n        parentContainer.appendChild(reportBody);\n\n        return reportBody;\n    };\n\n    var showHeader = function (container) {\n        var header = elementFor(template('<header class=\"{{headerClassName}}\">' +\n                                         '<a href=\"http://cburgmer.github.io/csscritic/\" class=\"cssCriticVersion\">' +\n                                         'CSS Critic {{packageVersion}}' +\n                                         '</a>' +\n                                         '<span class=\"{{timeTakenClassName}}\"></span>' +\n                                         '<ul class=\"{{progressBarClassName}}\"></ul>' +\n                                         '<div class=\"{{statusTextClassName}}\" class=\"statusText\"></div>' +\n                                         '</header>', {\n                                             headerClassName: headerClassName,\n                                             timeTakenClassName: timeTakenClassName,\n                                             progressBarClassName: progressBarClassName,\n                                             statusTextClassName: statusTextClassName,\n                                             packageVersion: packageVersion\n                                         }));\n\n        container.appendChild(header);\n    };\n\n    // document title\n\n    var originalTitle;\n\n    var updateStatusInDocumentTitle = function (totalCount, doneCount) {\n        if (originalTitle === undefined) {\n            originalTitle = document.title;\n        }\n\n        document.title = \"(\" + doneCount + \"/\" + totalCount + \") \" + originalTitle;\n    };\n\n    // header\n\n    var padNumber = function (number, length) {\n        number += '';\n        while (number.length < length) {\n            number = \"0\" + number;\n        }\n        return number;\n    };\n\n    var renderMilliseconds = function (time) {\n        var seconds = Math.floor(time / 1000),\n            milliSeconds = time % 1000;\n        return seconds + '.' + padNumber(milliSeconds, 3);\n    };\n\n    var showTimeTaken = function (container, timeTakenInMillis) {\n        var timeTaken = findElementIn(container, timeTakenClassName);\n        timeTaken.textContent = \"finished in \" + renderMilliseconds(timeTakenInMillis) + \"s\";\n    };\n\n    var setOutcomeOnHeader = function (container, successful) {\n        var header = findElementIn(container, headerClassName);\n\n        header.classList.add(successful ? 'pass' : 'fail');\n    };\n\n    // progress bar\n\n    var progressBarPendingClassName = 'pending';\n\n    var testDescription = function (testCase) {\n        var component;\n        if (testCase.desc) {\n            component = testCase.component ? testCase.component + ' ' : '';\n            return component + testCase.desc;\n        } else {\n            return comparisonKey(testCase);\n        }\n    };\n\n    var addTickToProgressBar = function (container, testCase, linkTarget) {\n        var progressBar = findElementIn(container, progressBarClassName),\n            clickableTickTemplate = '<li><a href=\"#{{linkTarget}}\" title=\"{{title}}\"></a></li>',\n            deactivatedTickTemplate = '<li><a title=\"{{title}}\"></a></li>',\n            tickTemplate = linkTarget ? clickableTickTemplate : deactivatedTickTemplate;\n\n        var tick = elementFor(template(tickTemplate, {\n            linkTarget: linkTarget ? escapeId(linkTarget) : '',\n            title: testDescription(testCase)\n        }));\n        tick.classList.add(progressBarPendingClassName);\n        progressBar.appendChild(tick);\n\n        if (pageNavigationHandlingFallback) {\n            pageNavigationHandlingFallback.install(tick.querySelector('a'));\n        }\n\n        return tick;\n    };\n\n    var markTickDone = function (status, renderErrorCount, tickElement) {\n        tickElement.classList.remove(progressBarPendingClassName);\n        tickElement.classList.add(status);\n        if (renderErrorCount > 0) {\n            tickElement.classList.add('hasRenderErrors');\n        }\n    };\n\n    // status bar\n\n    var singularPlural = function (value, singularForm, pluralForm) {\n        if (value === 1) {\n            return singularForm;\n        } else {\n            return pluralForm;\n        }\n    };\n\n    var statusTotalText = function (totalCount, selectedCount) {\n        var totalContent = '{{total}} ' + singularPlural(totalCount, 'entry', 'entries') + ', ';\n        if (selectedCount < totalCount) {\n            totalContent = '{{selected}} of ' + totalContent;\n        }\n        return template('<span>' +\n                        totalContent +\n                        '</span>', {\n            total: totalCount,\n            selected: selectedCount\n        });\n    };\n\n    var statusIssueText = function (issueCount, selectedCount, doneCount) {\n        var issueContent = '{{issues}} ' + singularPlural(issueCount, 'needs', 'need') + ' some love',\n            doneContent = 'all good',\n            noTestsContent = \"nothing here yet\",\n            doneWithoutErrors = selectedCount === doneCount && issueCount === 0,\n            content;\n        if (selectedCount === 0) {\n            content = noTestsContent;\n        } else if (doneWithoutErrors) {\n            content = doneContent;\n        } else {\n            content = issueContent;\n        }\n        return template('<span>' +\n                        content +\n                        '</span>', {\n                            issues: issueCount\n                        });\n    };\n\n    var acceptAllClassName = 'acceptAll';\n\n    var acceptAllButton = function () {\n        return elementFor(template('<button class=\"{{acceptAllClassName}}\">... accept all (I know what I\\'m doing)</button>', {\n            acceptAllClassName: acceptAllClassName\n        }));\n    };\n\n    var showAcceptAllButtonIfNeccessary = function (container, acceptableEntries) {\n        var statusText = findElementIn(container, statusTextClassName),\n            button = statusText.querySelector('.' + acceptAllClassName);\n\n        if (acceptableEntries.length > 2) {\n            button.classList.add('active');\n            button.onclick = function () {\n                acceptableEntries.forEach(function (acceptableEntry) {\n                    acceptableEntry.acceptPage();\n                    acceptComparison(acceptableEntry.entry);\n                });\n\n                button.setAttribute('disabled', 'disabled');\n            };\n        }\n    };\n\n    var installFallbackClearSelectionHandler = function (element) {\n        if (selectionFilter.clearFilter) {\n            element.onclick = function (e) {\n                selectionFilter.clearFilter();\n                e.preventDefault();\n            };\n        }\n    };\n\n    var updateStatusBar = function (container, totalCount, selectedCount, issueCount, doneCount) {\n        var runAllUrl = selectionFilter.clearFilterUrl ? selectionFilter.clearFilterUrl() : '#',\n            runAll = elementFor(template('<a class=\"runAll\" href=\"{{url}}\">Run all</a>', {\n                url: runAllUrl\n            })),\n            statusText = findElementIn(container, statusTextClassName);\n\n        statusText.innerHTML = '';\n        statusText.appendChild(elementFor(statusTotalText(totalCount, selectedCount)));\n        statusText.appendChild(elementFor(statusIssueText(issueCount, selectedCount, doneCount)));\n        statusText.appendChild(acceptAllButton());\n        if (totalCount > selectedCount) {\n            installFallbackClearSelectionHandler(runAll);\n            statusText.appendChild(runAll);\n        }\n    };\n\n    // component headline\n\n    var installFallbackComponentSelectionHandler = function (element, componentLabel) {\n        if (selectionFilter.filterForComponent) {\n            element.onclick = function (e) {\n                selectionFilter.filterForComponent(componentLabel);\n                e.preventDefault();\n            };\n        }\n    };\n\n    var addComponentHeading = function (container, componentLabel) {\n        var filterUrl = selectionFilter.filterUrlForComponent ? selectionFilter.filterUrlForComponent(componentLabel) : '#',\n            headlineElement = elementFor(template('<h2 class=\"componentLabel\"><a href=\"{{filterUrl}}\">{{headline}}</a></h2>', {\n                headline: componentLabel,\n                filterUrl: filterUrl\n            }));\n\n        installFallbackComponentSelectionHandler(headlineElement, componentLabel);\n        container.appendChild(headlineElement);\n    };\n\n    // comparisons\n\n    var comparisonKey = function (testCase) {\n        var testCaseParameters = util.excludeKeys(testCase, 'url'),\n            serializedParameters = util.serializeMap(testCaseParameters),\n            key = testCase.url;\n\n        if (serializedParameters) {\n            return key + ',' + serializedParameters;\n        }\n\n        return key;\n    };\n\n    var runningComparisonClassName = 'running',\n        imageContainerClassName = 'imageContainer',\n        errorContainerClassName = 'errorText';\n\n    var imageWrapper = function (image) {\n        var wrapper = elementFor('<div class=\"imageWrapper\"></div>');\n        wrapper.appendChild(image);\n        return wrapper;\n    };\n\n    var serializeValue = function (value) {\n        if (typeof value === 'string') {\n            return \"'\" + value + \"'\";\n        }\n        return value;\n    };\n\n    var testCaseParameters = function (testCase) {\n        var parameters = util.excludeKeys(testCase, 'url', 'desc', 'component'),\n            keys = Object.keys(parameters);\n\n        if (!keys.length) {\n            return '';\n        }\n        keys.sort();\n\n        return '<dl class=\"parameters\">' +\n            keys.map(function (key) {\n                return template('<dt>{{key}}</dt><dd>{{value}}</dd>', {\n                    key: key,\n                    value: serializeValue(parameters[key])\n                });\n            }).join('\\n') +\n            '</dl>';\n    };\n\n    var installFallbackSelectionHandler = function (element, testCase) {\n        if (selectionFilter.filterFor) {\n            element.onclick = function (e) {\n                selectionFilter.filterFor(testCase);\n                e.preventDefault();\n            };\n        }\n    };\n\n    var addComparison = function (container, testCase, referenceImage, key) {\n        var titleLinkClassName = 'titleLink',\n            filterUrl = selectionFilter.filterUrlFor ? selectionFilter.filterUrlFor(testCase) : '#',\n            comparison = elementFor(template('<section class=\"comparison {{runningComparisonClassName}}\" id=\"{{id}}\">' +\n                                             '<h3 class=\"title\">' +\n                                             '<a class=\"{{titleLinkClassName}}\" href=\"{{filterUrl}}\">{{title}}</a> ' +\n                                             '<a class=\"externalLink\" href=\"{{url}}\"></a>' +\n                                             testCaseParameters(testCase) +\n                                             '</h3>' +\n                                             '<div class=\"{{errorContainerClassName}}\"></div>' +\n                                             '<div><div class=\"{{imageContainerClassName}}\"></div></div>' +\n                                             '</section>', {\n                                                 url: testCase.url,\n                                                 title: testCase.desc ? testCase.desc : testCase.url,\n                                                 filterUrl: filterUrl,\n                                                 id: escapeId(key),\n                                                 runningComparisonClassName: runningComparisonClassName,\n                                                 errorContainerClassName: errorContainerClassName,\n                                                 imageContainerClassName: imageContainerClassName,\n                                                 titleLinkClassName: titleLinkClassName\n                                             })),\n            imageContainer = comparison.querySelector('.' + imageContainerClassName),\n            titleLink = comparison.querySelector('.' + titleLinkClassName);\n\n        if (referenceImage) {\n            imageContainer.appendChild(imageWrapper(referenceImage));\n        }\n        installFallbackSelectionHandler(titleLink, testCase);\n\n        container.appendChild(comparison);\n\n        return comparison;\n    };\n\n    var canvasForImageCanvas = function (imageData) {\n        var canvas = document.createElement(\"canvas\"),\n            context;\n\n        canvas.height = imageData.height;\n        canvas.width  = imageData.width;\n\n        context = canvas.getContext(\"2d\");\n        context.putImageData(imageData, 0, 0);\n\n        return canvas;\n    };\n\n    var diffPageImages = function (imageA, imageB) {\n        return imagediff.diff(imageA, imageB, {align: 'top'});\n    };\n\n    var embossChanges = function (imageData) {\n        var d = imageData.data,\n            i;\n        for (i = 0; i < d.length; i += 4) {\n            if (d[i] === 0 && d[i+1] === 0 && d[i+2] === 0) {\n                d[i+3] = 0;\n            } else {\n                d[i] = 0;\n                d[i+1] = 0;\n                d[i+2] = 255;\n                d[i+3] = 255;\n            }\n        }\n        return imageData;\n    };\n\n    var getDifferenceCanvas = function (imageA, imageB) {\n        var differenceImageData = diffPageImages(imageA, imageB),\n            canvas = canvasForImageCanvas(embossChanges(differenceImageData));\n\n        canvas.classList.add('diff');\n        return canvas;\n    };\n\n    // Use a canvas for display to work around https://bugzilla.mozilla.org/show_bug.cgi?id=986403\n    var canvasForImage = function (image) {\n        var canvas = document.createElement(\"canvas\"),\n            width  = image.naturalWidth,\n            height = image.naturalHeight,\n            context;\n\n        canvas.width  = width;\n        canvas.height = height;\n\n        context = canvas.getContext(\"2d\");\n        context.drawImage(image, 0, 0, width, height);\n\n        // fix size in css so the tests will show something (canvas is not supported so far)\n        canvas.style.width = width + 'px';\n        canvas.style.height = height + 'px';\n\n        return canvas;\n    };\n\n    var addImageDiff = function (image, imageForDiff, container) {\n        var imageContainer = container.querySelector('.' + imageContainerClassName);\n\n        imageContainer.appendChild(getDifferenceCanvas(image, imageForDiff));\n    };\n\n    var acceptClassName = 'accept';\n\n    var acceptComparison = function (container) {\n        var acceptButton = container.querySelector('.' + acceptClassName);\n        acceptButton.setAttribute('disabled', 'disabled');\n        acceptButton.textContent = \"\";\n        container.classList.add('accepted');\n    };\n\n    var changedImageContainer = function (pageImage, acceptPage, container) {\n        var changedImageContainerClassName = 'changedImageContainer',\n            outerChangedImageContainer = elementFor(template('<div class=\"outerChangedImageContainer\">' +\n                                                             '<div class=\"{{changedImageContainerClassName}}\"></div>' +\n                                                             '<button class=\"{{acceptClassName}}\"><span>Accept</span></button>' +\n                                                             '</div>', {\n                                                                 changedImageContainerClassName: changedImageContainerClassName,\n                                                                 acceptClassName: acceptClassName\n                                                             })),\n            changedImageContainer = outerChangedImageContainer.querySelector('.' + changedImageContainerClassName),\n            acceptButton = outerChangedImageContainer.querySelector('button');\n\n        changedImageContainer.appendChild(imageWrapper(pageImage));\n        acceptButton.onclick = function () {\n            acceptPage();\n            acceptComparison(container);\n        };\n\n        return outerChangedImageContainer;\n    };\n\n    var showComparisonWithDiff = function (pageImage, referenceImage, acceptPage, container) {\n        addImageDiff(referenceImage, pageImage, container);\n        container.appendChild(changedImageContainer(canvasForImage(pageImage), acceptPage, container));\n    };\n\n    var pageAsIframe = function (pageImage, testCaseUrl) {\n        var iframe = document.createElement('iframe');\n        iframe.width = pageImage.width;\n        iframe.height = pageImage.height;\n        iframe.src = testCaseUrl;\n        iframe.scrolling = \"no\";\n        return iframe;\n    };\n\n    var showComparisonWithRenderedPage = function (pageImage, testCaseUrl, container) {\n        var imageContainer = container.querySelector('.' + imageContainerClassName);\n\n        imageContainer.innerHTML = '';\n        imageContainer.appendChild(imageWrapper(canvasForImage(pageImage)));\n\n        imageContainer.addEventListener('dblclick', function () {\n            imageContainer.innerHTML = '';\n            imageContainer.appendChild(imageWrapper(pageAsIframe(pageImage, testCaseUrl)));\n\n            imageContainer.classList.add('realView');\n        }, false);\n    };\n\n    var showComparisonWithoutReference = function (pageImage, acceptPage, container) {\n        container.appendChild(changedImageContainer(canvasForImage(pageImage), acceptPage, container));\n    };\n\n    var sameOriginWarning = 'Make sure the path lies within the ' +\n        '<a href=\"https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy\">' +\n        'same origin' +\n        '</a> ' +\n        'as this document.';\n\n    var showComparisonWithError = function (url, container) {\n        var errorMsg = elementFor(template('<span>' +\n                                           'The page \"{{url}}\" could not be rendered. ' +\n                                           sameOriginWarning +\n                                           '</span>', {\n                                               url: url\n                                           })),\n            errorContainer = container.querySelector('.' + errorContainerClassName);\n        errorContainer.appendChild(errorMsg);\n    };\n\n    var showRenderErrors = function (errors, container) {\n        var errorMsg = elementFor(template('<span>' +\n                                           'Had the following errors rendering the page:' +\n                                           '<ul></ul>' +\n                                           sameOriginWarning +\n                                           '</span>')),\n            listElement = errorMsg.querySelector('ul'),\n            errorContainer = container.querySelector('.' + errorContainerClassName);\n\n        errors.map(function (error) {\n            return elementFor(template('<li>{{msg}}</li>', {msg: error}));\n        }).forEach(function (li) {\n            listElement.appendChild(li);\n        });\n\n        errorContainer.appendChild(errorMsg);\n    };\n\n    var updateComparisonStatus = function (status, container) {\n        container.classList.remove(runningComparisonClassName);\n        container.classList.add(status);\n    };\n\n    // browser warning\n\n    var supportsReadingHtmlFromCanvas = function () {\n        return rasterizeHTML.drawHTML('<b></b>').then(function (result) {\n            var canvas = document.createElement(\"canvas\"),\n                context = canvas.getContext(\"2d\");\n            try {\n                context.drawImage(result.image, 0, 0);\n                // This will fail in Chrome & Safari\n                canvas.toDataURL(\"image/png\");\n                return true;\n            } catch (e) {\n                return false;\n            }\n        });\n    };\n\n    var browserIssueChecked = false;\n\n    var showBrowserWarningIfNeeded = function (container) {\n        if (browserIssueChecked) {\n            return;\n        }\n        browserIssueChecked = true;\n\n        supportsReadingHtmlFromCanvas().then(function (supported) {\n            if (supported) {\n                return;\n            }\n\n            container.appendChild(elementFor(\n                '<div class=\"browserWarning\">' +\n                    'Your browser is currently not supported, ' +\n                    'as it does not support reading rendered HTML from the canvas ' +\n                    '(<a href=\"https://code.google.com/p/chromium/issues/detail?id=294129\">Chrome #294129</a>, ' +\n                    '<a href=\"https://bugs.webkit.org/show_bug.cgi?id=17352\">Safari #17352</a>). How about trying Firefox?' +\n                    '</div>'\n            ));\n        });\n    };\n\n    // the reporter\n\n    module.NiceReporter = function (outerContainer) {\n        var totalCount = 0,\n            selectedCount = 0,\n            doneCount = 0,\n            issueCount = 0,\n            progressTickElements = {},\n            runningComparisonEntries = {},\n            acceptableComparisons = [],\n            containerElement, timeStarted, lastComponentLabel;\n\n        var container = function () {\n            if (!containerElement) {\n                containerElement = createContainer(outerContainer || document.body);\n            }\n            return containerElement;\n        };\n\n        var registerComparison = function () {\n            totalCount += 1;\n            if (!timeStarted) {\n                timeStarted = Date.now();\n            }\n\n            showBrowserWarningIfNeeded(container());\n            updateStatusInDocumentTitle(totalCount, doneCount);\n            updateStatusBar(container(), totalCount, selectedCount, issueCount);\n        };\n\n        return {\n            reportDeselectedComparison: function (comparison) {\n                registerComparison();\n\n                addTickToProgressBar(container(), comparison.testCase);\n            },\n            reportSelectedComparison: function (comparison) {\n                var key = comparisonKey(comparison.testCase);\n                selectedCount += 1;\n\n                if (comparison.testCase.component && comparison.testCase.component !== lastComponentLabel) {\n                    lastComponentLabel = comparison.testCase.component;\n                    addComponentHeading(container(), comparison.testCase.component);\n                }\n\n                registerComparison();\n\n                var tickElement = addTickToProgressBar(container(), comparison.testCase, key);\n                progressTickElements[key] = tickElement;\n\n                var comparisonElement = addComparison(container(),\n                                                      comparison.testCase,\n                                                      comparison.referenceImage,\n                                                      key);\n                runningComparisonEntries[key] = comparisonElement;\n            },\n            reportComparison: function (comparison) {\n                var key = comparisonKey(comparison.testCase),\n                    tickElement = progressTickElements[key],\n                    entry = runningComparisonEntries[key];\n\n                doneCount += 1;\n                if (comparison.status !== 'passed') {\n                    issueCount += 1;\n                }\n\n                updateStatusInDocumentTitle(totalCount, doneCount);\n                updateStatusBar(container(), totalCount, selectedCount, issueCount, doneCount);\n                markTickDone(comparison.status, comparison.renderErrors.length, tickElement);\n\n                if (comparison.status === 'failed') {\n                    showComparisonWithDiff(comparison.pageImage,\n                                           comparison.referenceImage,\n                                           comparison.acceptPage,\n                                           entry);\n                    acceptableComparisons.push(comparison);\n                } else if (comparison.status === 'referenceMissing') {\n                    showComparisonWithoutReference(comparison.pageImage,\n                                                   comparison.acceptPage,\n                                                   entry);\n                    acceptableComparisons.push(comparison);\n                } else if (comparison.status === 'passed') {\n                    showComparisonWithRenderedPage(comparison.pageImage,\n                                                   comparison.testCase.url,\n                                                   entry);\n                } else if (comparison.status === 'error') {\n                    showComparisonWithError(comparison.testCase.url,\n                                            entry);\n                }\n\n                if (comparison.renderErrors.length > 0) {\n                    showRenderErrors(comparison.renderErrors, entry);\n                }\n\n                updateComparisonStatus(comparison.status, entry);\n            },\n            reportTestSuite: function (result) {\n                var acceptableEntries = acceptableComparisons.map(function (comparison) {\n                    var key = comparisonKey(comparison.testCase);\n                    return {\n                        acceptPage: comparison.acceptPage,\n                        entry: runningComparisonEntries[key]\n                    };\n                });\n\n                updateStatusInDocumentTitle(totalCount, doneCount);\n                updateStatusBar(container(), totalCount, selectedCount, issueCount, doneCount);\n\n                showTimeTaken(container(), timeStarted ? Date.now() - timeStarted : 0);\n                setOutcomeOnHeader(container(), result.success);\n                showAcceptAllButtonIfNeccessary(container(), acceptableEntries);\n            }\n        };\n    };\n\n    return module;\n};\n\n/* Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1005634\n * Replaces anchors with inner page targets with a JavaScript navigation handling implementation.\n */\ncsscriticLib.pageNavigationHandlingFallback = function () {\n    \"use strict\";\n\n    var module = {};\n\n    var fakeTargetClassName = 'fakeTarget';\n\n    var clearFakeActiveClass = function () {\n        var previousTargets = Array.prototype.slice.call(document.querySelectorAll('.' + fakeTargetClassName));\n        previousTargets.forEach(function (elem) {\n            elem.classList.remove(fakeTargetClassName);\n        });\n    };\n\n    var triggerFakeActiveClass = function (targetElement) {\n        targetElement.classList.add(fakeTargetClassName);\n    };\n\n    var scrollTo = function (id) {\n        var targetElement;\n\n        clearFakeActiveClass();\n        if (id) {\n            targetElement = document.getElementById(id);\n            targetElement.scrollIntoView();\n            triggerFakeActiveClass(targetElement);\n        } else {\n            window.scrollTo(0, 0);\n        }\n    };\n\n    var globalNavigationHandlingInstalled = false;\n\n    var installGlobalNavigationHandling = function () {\n        if (!globalNavigationHandlingInstalled) {\n            globalNavigationHandlingInstalled = true;\n\n            window.onpopstate = function (e) {\n                scrollTo(e.state);\n            };\n        }\n    };\n\n    module.install = function (element) {\n        installGlobalNavigationHandling();\n\n        element.onclick = function (e) {\n            var targetLink = e.target.href,\n                targetId = targetLink.substr(targetLink.indexOf('#')+1);\n\n            scrollTo(targetId);\n            history.pushState(targetId, targetId);\n            e.preventDefault();\n        };\n    };\n\n    return module;\n};\n\ncsscriticLib.urlQueryFilter = function (windowLocation) {\n    \"use strict\";\n\n    var module = {};\n\n    var filterParam = 'filter';\n\n    var parseUrlSearch = function (search) {\n        var paramString = search.replace(/^\\?/, '');\n        if (!paramString) {\n            return [];\n        }\n        return paramString\n            .split('&')\n            .map(function (keyValue) {\n                var equalsIdx = keyValue.indexOf('='),\n                    key, value;\n\n                if (equalsIdx >= 0) {\n                    key = keyValue.substr(0, equalsIdx);\n                    value = keyValue.substr(equalsIdx + 1);\n                } else {\n                    key = keyValue;\n                }\n                return {\n                    key: key,\n                    value: value\n                };\n            });\n    };\n\n    var serializeKeyValuePair = function (pair) {\n        if (pair.value) {\n            return pair.key + '=' + pair.value;\n        }\n        return pair.key;\n    };\n\n    var getFilterValue = function () {\n        var filterKeyValue = parseUrlSearch(windowLocation.search)\n                .filter(function (entryPair) {\n                    return entryPair.key === filterParam;\n                })\n                .pop();\n\n        if (filterKeyValue) {\n            return decodeURIComponent(filterKeyValue.value);\n        }\n    };\n\n    var fullDescription = function (testCase) {\n        return testCase.component ? testCase.component + ' ' + testCase.desc : testCase.desc;\n    };\n\n    var filter = getFilterValue(),\n        existingQueryParams = parseUrlSearch(windowLocation.search);\n\n    // interface towards main.js\n\n    module.isComparisonSelected = function (comparison) {\n        if (!filter) {\n            return true;\n        }\n\n        if (comparison.testCase.desc && fullDescription(comparison.testCase) === filter) {\n            return true;\n        }\n        if (comparison.testCase.component && comparison.testCase.component === filter) {\n            return true;\n        }\n        return comparison.testCase.url === filter;\n    };\n\n    // interface towards browser reporters\n\n    var queryPart = function (selection) {\n        var queryParams = existingQueryParams\n                .filter(function (pair) {\n                    return pair.key !== filterParam;\n                });\n        if (selection) {\n            queryParams.push({\n                key: filterParam,\n                value: encodeURIComponent(selection)\n            });\n        }\n\n        return '?' + queryParams.map(serializeKeyValuePair).join('&');\n    };\n\n    module.filterUrlForComponent = function (componentLabel) {\n        return queryPart(componentLabel);\n    };\n\n    module.filterUrlFor = function (testCase) {\n        if (testCase.desc) {\n            return queryPart(fullDescription(testCase));\n        }\n        return queryPart(testCase.url);\n    };\n\n    module.clearFilterUrl = function () {\n        return queryPart();\n    };\n\n    return module;\n};\n\ncsscriticLib.packageVersion = '1.0.0';\n\n/* exported csscritic */\nvar csscritic = (function () {\n    \"use strict\";\n\n    var installCallChain = function (func, self) {\n        return function chainableProxy() {\n            func.apply(null, arguments);\n            return self;\n        };\n    };\n\n    var startsWith = function (str, prefix) {\n        // PhantomJS has no startsWith\n        return str.substr(0, prefix.length) === prefix;\n    };\n\n    // Work around https://bugzilla.mozilla.org/show_bug.cgi?id=1005634\n    var needsFallback = function () {\n        return startsWith(window.location.href, 'file://');\n    };\n\n    var packageVersion = csscriticLib.packageVersion || 'dev',\n        util = csscriticLib.util();\n\n    var indexedDbStorage = csscriticLib.indexeddbstorage(util);\n\n    var browserRenderer = csscriticLib.browserRenderer(util, csscriticLib.jobQueue, rasterizeHTML),\n        reporting = csscriticLib.reporting(browserRenderer, indexedDbStorage, util),\n        regression = csscriticLib.regression(browserRenderer, util, imagediff),\n        queryFilter = csscriticLib.urlQueryFilter(window.location),\n        fallbackFilter = csscriticLib.fallbackFilter(window.location);\n\n    var filter = needsFallback() ? fallbackFilter : queryFilter;\n\n    var main = csscriticLib.main(\n        regression,\n        reporting,\n        util,\n        indexedDbStorage,\n        filter\n    );\n\n    var pageNavigationHandlingFallback = csscriticLib.pageNavigationHandlingFallback(window.location),\n        niceReporter = csscriticLib.niceReporter(\n            util,\n            filter,\n            needsFallback() ? pageNavigationHandlingFallback : undefined,\n            rasterizeHTML,\n            packageVersion\n        );\n\n\n    var self = {};\n\n    self.add = installCallChain(main.add, self);\n    self.component = installCallChain(main.component, self);\n    self.execute = main.execute;\n\n    self.addReporter = installCallChain(reporting.addReporter, self);\n\n    self.NiceReporter = niceReporter.NiceReporter;\n\n    return self;\n}());\n\nreturn csscritic;\n\n}));\n","var css = \".cssCriticNiceReporter{font-family:sans-serif;font-size:16px}.cssCriticNiceReporter a{text-decoration:none;color:inherit}.cssCriticNiceReporter .comparison .title .titleLink:hover,.cssCriticNiceReporter .componentLabel:hover,.cssCriticNiceReporter .errorText a{text-decoration:underline}.cssCriticNiceReporter button{padding:2px 10px;border-radius:3px;border:none;background-color:#00c04e;font-size:inherit;font-family:inherit}.cssCriticNiceReporter button[disabled]{background-color:#ddd}.cssCriticNiceReporter button:hover{background-color:#24d66c}.cssCriticNiceReporter button:not([disabled]):active{background-color:#4cec8d}.cssCriticNiceReporter .errorText{color:#591100;margin-bottom:1em}.cssCriticNiceReporter .errorText:not(:empty)::before{content:\\\"\\\";color:#591100;font-size:1.2rem;padding-right:5px;vertical-align:middle}.cssCriticNiceReporter .errorText ul{margin:.2em 0}.cssCriticNiceReporter .header{padding:15px;transition:background-color 1s}.cssCriticNiceReporter .header.pass{background-color:#00c04e}.cssCriticNiceReporter .header.fail{background-color:#ff3100}.cssCriticNiceReporter .timeTaken{float:right;padding:.5em 0 0 1em}.cssCriticNiceReporter .statusText{display:inline-block}.cssCriticNiceReporter .statusText .runAll{display:block;margin-top:.5em;text-decoration:underline}.cssCriticNiceReporter .acceptAll{display:none;margin:-4px 0 -4px 1em}.cssCriticNiceReporter .acceptAll.active{display:inline-block}.cssCriticNiceReporter .cssCriticVersion{font-size:.7rem}.cssCriticNiceReporter .progressBar{margin:.4em 0;list-style:none;padding:0}.cssCriticNiceReporter .progressBar:empty::after{content:'';width:0;height:0;border:.63rem solid;border-radius:50%;display:inline-block;opacity:.15}.cssCriticNiceReporter .progressBar li{display:inline-block;margin-right:-.4rem;transition:color 1s}.cssCriticNiceReporter .progressBar a{width:0;height:0;border:.63rem solid;border-radius:50%;display:block}.cssCriticNiceReporter .progressBar .pending{color:grey}.cssCriticNiceReporter .progressBar .passed{color:#048337}.cssCriticNiceReporter .progressBar .failed{color:#b62705}.cssCriticNiceReporter .progressBar .error{color:#591100}.cssCriticNiceReporter .progressBar .referenceMissing{color:#ff0}.cssCriticNiceReporter .progressBar a:focus{outline:0}.cssCriticNiceReporter .progressBar .hasRenderErrors{position:relative}.cssCriticNiceReporter .progressBar .hasRenderErrors a::after{content:'!';color:#000;line-height:1.26rem;text-align:center;position:absolute;top:0;left:0;right:0;bottom:0}.cssCriticNiceReporter .componentLabel{margin:1.8em 0 .5em 15px;font-size:1.15rem}.cssCriticNiceReporter .comparison{background-color:#f5f5f5;padding:15px;margin:4px 0}.cssCriticNiceReporter .comparison .title{font-weight:400}.cssCriticNiceReporter .comparison.fakeTarget .title,.cssCriticNiceReporter .comparison:target .title{font-weight:700}.cssCriticNiceReporter .comparison .title .externalLink{vertical-align:top;font-size:.8rem;line-height:.6em;color:#888;display:inline-block}.cssCriticNiceReporter .comparison .title .externalLink:hover{transform:scale(1.1);transform-origin:bottom left}.cssCriticNiceReporter .comparison .parameters,.cssCriticNiceReporter .comparison .parameters dd,.cssCriticNiceReporter .comparison .parameters dt{display:inline-block;margin:0}.cssCriticNiceReporter .comparison .parameters{margin-left:1.5em;color:#444}.cssCriticNiceReporter .comparison .parameters dt{font-style:italic}.cssCriticNiceReporter .comparison .parameters dt::after{content:\\\":\\\"}.cssCriticNiceReporter .comparison .parameters dd{margin-left:.5em;margin-right:.7em}.cssCriticNiceReporter .comparison .parameters dd::after{content:\\\",\\\"}.cssCriticNiceReporter .comparison .parameters dd:last-child::after{content:\\\"\\\"}.cssCriticNiceReporter .running.comparison .imageContainer{opacity:.2}.cssCriticNiceReporter .comparison .imageContainer:empty{display:none}.cssCriticNiceReporter .comparison .imageWrapper{background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAKUlEQVQ4jWNYt27df2Lwo0ePiMIMowaOGjgsDSRWIbEWjxo4auCwNBAAenk4PB4atggAAAAASUVORK5CYII=)-5px -5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cssCriticNiceReporter .comparison canvas,.cssCriticNiceReporter .comparison img{display:block}.cssCriticNiceReporter .comparison .changedImageContainer,.cssCriticNiceReporter .comparison .imageContainer{border:1px solid #000}.cssCriticNiceReporter .comparison .outerChangedImageContainer{margin-top:4px;display:inline-block;position:relative}.cssCriticNiceReporter .comparison .imageContainer{display:inline-block}.cssCriticNiceReporter .comparison .imageContainer .diff{max-height:0;max-width:0;opacity:0}.cssCriticNiceReporter .failed.comparison .imageContainer:hover .diff{max-height:none;max-width:none;opacity:1;transition:opacity 1s}.cssCriticNiceReporter .failed.comparison .imageContainer:hover .imageWrapper{opacity:.5;transition:opacity 1s;position:absolute;top:0;left:0;right:0;bottom:0}.cssCriticNiceReporter .comparison iframe{border:none;display:block;background:0 0}.cssCriticNiceReporter .comparison .realView{border-style:dashed}.cssCriticNiceReporter .comparison .accept{vertical-align:top;position:absolute;top:0;bottom:0;right:-65px;width:50px;font-size:.7rem}.cssCriticNiceReporter .accepted.comparison .accept{font-size:1.4rem}.cssCriticNiceReporter .comparison button span{transform:rotate(-90deg);display:block}.cssCriticNiceReporter .comparison .imageContainer{opacity:1;max-height:1000000px;position:relative}.cssCriticNiceReporter .accepted.comparison .imageContainer{opacity:0;max-height:0;border-width:0;transition:max-height .001s ease 1s,opacity 1s,border-width .001s ease 1s}.cssCriticNiceReporter .comparison:hover .imageContainer::after{position:absolute;top:0;right:0;transform:translateX(100%);margin-right:-8px;padding:4px;white-space:nowrap;background-color:#000;opacity:.55;color:#fff;font-size:.9rem;border-radius:5px}.cssCriticNiceReporter .failed.comparison:hover .imageContainer::after{content:\\\"< Hover over the reference image to highlight changes\\\"}.cssCriticNiceReporter .failed.comparison .imageContainer:hover::after{display:none}.cssCriticNiceReporter .passed.comparison .imageContainer:not(.realView):hover::after{content:\\\"< Double click the image to expose the DOM of the underlying page\\\"}.cssCriticNiceReporter .browserWarning::before{content:\\\"\\\";font-size:1.2rem;padding-right:5px;vertical-align:middle}.cssCriticNiceReporter .browserWarning{position:fixed;top:0;left:0;width:100%;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box;background-color:rgba(182,39,5,.85);color:#fff;font-size:1.2rem;border:2px solid #000;padding:20px}\"; (require(\"./../node_modules/cssify\"))(css); module.exports = css;","module.exports = function (css, customDocument) {\n  var doc = customDocument || document;\n  if (doc.createStyleSheet) {\n    var sheet = doc.createStyleSheet()\n    sheet.cssText = css;\n    return sheet.ownerNode;\n  } else {\n    var head = doc.getElementsByTagName('head')[0],\n        style = doc.createElement('style');\n\n    style.type = 'text/css';\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = css;\n    } else {\n      style.appendChild(doc.createTextNode(css));\n    }\n\n    head.appendChild(style);\n    return style;\n  }\n};\n\nmodule.exports.byUrl = function(url) {\n  if (document.createStyleSheet) {\n    return document.createStyleSheet(url).ownerNode;\n  } else {\n    var head = document.getElementsByTagName('head')[0],\n        link = document.createElement('link');\n\n    link.rel = 'stylesheet';\n    link.href = url;\n\n    head.appendChild(link);\n    return link;\n  }\n};\n","// UMD header\n(function (root, factory) {\n    if (typeof define === 'function' && define.amd) {\n        define(factory);\n    } else if (typeof exports === 'object') {\n        module.exports = factory();\n    } else {\n        root.ayepromise = factory();\n    }\n}(this, function () {\n    'use strict';\n\n    var ayepromise = {};\n\n    /* Wrap an arbitrary number of functions and allow only one of them to be\n       executed and only once */\n    var once = function () {\n        var wasCalled = false;\n\n        return function wrapper(wrappedFunction) {\n            return function () {\n                if (wasCalled) {\n                    return;\n                }\n                wasCalled = true;\n                wrappedFunction.apply(null, arguments);\n            };\n        };\n    };\n\n    var getThenableIfExists = function (obj) {\n        // Make sure we only access the accessor once as required by the spec\n        var then = obj && obj.then;\n\n        if (typeof obj === \"object\" && typeof then === \"function\") {\n            // Bind function back to it's object (so fan's of 'this' don't get sad)\n            return function() { return then.apply(obj, arguments); };\n        }\n    };\n\n    var aThenHandler = function (onFulfilled, onRejected) {\n        var defer = ayepromise.defer();\n\n        var doHandlerCall = function (func, value) {\n            setTimeout(function () {\n                var returnValue;\n                try {\n                    returnValue = func(value);\n                } catch (e) {\n                    defer.reject(e);\n                    return;\n                }\n\n                if (returnValue === defer.promise) {\n                    defer.reject(new TypeError('Cannot resolve promise with itself'));\n                } else {\n                    defer.resolve(returnValue);\n                }\n            }, 1);\n        };\n\n        var callFulfilled = function (value) {\n            if (onFulfilled && onFulfilled.call) {\n                doHandlerCall(onFulfilled, value);\n            } else {\n                defer.resolve(value);\n            }\n        };\n\n        var callRejected = function (value) {\n            if (onRejected && onRejected.call) {\n                doHandlerCall(onRejected, value);\n            } else {\n                defer.reject(value);\n            }\n        };\n\n        return {\n            promise: defer.promise,\n            handle: function (state, value) {\n                if (state === FULFILLED) {\n                    callFulfilled(value);\n                } else {\n                    callRejected(value);\n                }\n            }\n        };\n    };\n\n    // States\n    var PENDING = 0,\n        FULFILLED = 1,\n        REJECTED = 2;\n\n    ayepromise.defer = function () {\n        var state = PENDING,\n            outcome,\n            thenHandlers = [];\n\n        var doSettle = function (settledState, value) {\n            state = settledState;\n            // persist for handlers registered after settling\n            outcome = value;\n\n            thenHandlers.forEach(function (then) {\n                then.handle(state, outcome);\n            });\n\n            // Discard all references to handlers to be garbage collected\n            thenHandlers = null;\n        };\n\n        var doFulfill = function (value) {\n            doSettle(FULFILLED, value);\n        };\n\n        var doReject = function (error) {\n            doSettle(REJECTED, error);\n        };\n\n        var registerThenHandler = function (onFulfilled, onRejected) {\n            var thenHandler = aThenHandler(onFulfilled, onRejected);\n\n            if (state === PENDING) {\n                thenHandlers.push(thenHandler);\n            } else {\n                thenHandler.handle(state, outcome);\n            }\n\n            return thenHandler.promise;\n        };\n\n        var safelyResolveThenable = function (thenable) {\n            // Either fulfill, reject or reject with error\n            var onceWrapper = once();\n            try {\n                thenable(\n                    onceWrapper(transparentlyResolveThenablesAndSettle),\n                    onceWrapper(doReject)\n                );\n            } catch (e) {\n                onceWrapper(doReject)(e);\n            }\n        };\n\n        var transparentlyResolveThenablesAndSettle = function (value) {\n            var thenable;\n\n            try {\n                thenable = getThenableIfExists(value);\n            } catch (e) {\n                doReject(e);\n                return;\n            }\n\n            if (thenable) {\n                safelyResolveThenable(thenable);\n            } else {\n                doFulfill(value);\n            }\n        };\n\n        var onceWrapper = once();\n        return {\n            resolve: onceWrapper(transparentlyResolveThenablesAndSettle),\n            reject: onceWrapper(doReject),\n            promise: {\n                then: registerThenHandler,\n                fail: function (onRejected) {\n                    return registerThenHandler(null, onRejected);\n                }\n            }\n        };\n    };\n\n    return ayepromise;\n}));\n","// js-imagediff 1.0.3\n// (c) 2011-2012 Carl Sutherland, Humble Software\n// Distributed under the MIT License\n// For original source and documentation visit:\n// http://www.github.com/HumbleSoftware/js-imagediff\n\n(function (name, definition) {\n  var root = this;\n  if (typeof module !== 'undefined') {\n    try {\n      var Canvas = require('canvas');\n    } catch (e) {\n      throw new Error(\n        e.message + '\\n' +\n        'Please see https://github.com/HumbleSoftware/js-imagediff#cannot-find-module-canvas\\n'\n      );\n    }\n    module.exports = definition(root, name, Canvas);\n  } else if (typeof define === 'function' && typeof define.amd === 'object') {\n    define(definition);\n  } else {\n    root[name] = definition(root, name);\n  }\n})('imagediff', function (root, name, Canvas) {\n\n  var\n    TYPE_ARRAY        = /\\[object Array\\]/i,\n    TYPE_CANVAS       = /\\[object (Canvas|HTMLCanvasElement)\\]/i,\n    TYPE_CONTEXT      = /\\[object CanvasRenderingContext2D\\]/i,\n    TYPE_IMAGE        = /\\[object (Image|HTMLImageElement)\\]/i,\n    TYPE_IMAGE_DATA   = /\\[object ImageData\\]/i,\n\n    UNDEFINED         = 'undefined',\n\n    canvas            = getCanvas(),\n    context           = canvas.getContext('2d'),\n    previous          = root[name],\n    imagediff, jasmine;\n\n  // Creation\n  function getCanvas (width, height) {\n    var\n      canvas = Canvas ?\n        new Canvas() :\n        document.createElement('canvas');\n    if (width) canvas.width = width;\n    if (height) canvas.height = height;\n    return canvas;\n  }\n  function getImageData (width, height) {\n    canvas.width = width;\n    canvas.height = height;\n    context.clearRect(0, 0, width, height);\n    return context.createImageData(width, height);\n  }\n  // expost canvas module\n  function getCanvasRef() {\n    return Canvas;\n  }\n\n\n  // Type Checking\n  function isImage (object) {\n    return isType(object, TYPE_IMAGE);\n  }\n  function isCanvas (object) {\n    return isType(object, TYPE_CANVAS);\n  }\n  function isContext (object) {\n    return isType(object, TYPE_CONTEXT);\n  }\n  function isImageData (object) {\n    return !!(object &&\n      isType(object, TYPE_IMAGE_DATA) &&\n      typeof(object.width) !== UNDEFINED &&\n      typeof(object.height) !== UNDEFINED &&\n      typeof(object.data) !== UNDEFINED);\n  }\n  function isImageType (object) {\n    return (\n      isImage(object) ||\n      isCanvas(object) ||\n      isContext(object) ||\n      isImageData(object)\n    );\n  }\n  function isType (object, type) {\n    return typeof (object) === 'object' && !!Object.prototype.toString.apply(object).match(type);\n  }\n\n\n  // Type Conversion\n  function copyImageData (imageData) {\n    var\n      height = imageData.height,\n      width = imageData.width,\n      data = imageData.data,\n      newImageData, newData, i;\n\n    canvas.width = width;\n    canvas.height = height;\n    newImageData = context.getImageData(0, 0, width, height);\n    newData = newImageData.data;\n\n    for (i = imageData.data.length; i--;) {\n        newData[i] = data[i];\n    }\n\n    return newImageData;\n  }\n  function toImageData (object) {\n    if (isImage(object)) { return toImageDataFromImage(object); }\n    if (isCanvas(object)) { return toImageDataFromCanvas(object); }\n    if (isContext(object)) { return toImageDataFromContext(object); }\n    if (isImageData(object)) { return object; }\n  }\n  function toImageDataFromImage (image) {\n    var\n      height = image.height,\n      width = image.width;\n    canvas.width = width;\n    canvas.height = height;\n    context.clearRect(0, 0, width, height);\n    context.drawImage(image, 0, 0);\n    return context.getImageData(0, 0, width, height);\n  }\n  function toImageDataFromCanvas (canvas) {\n    var\n      height = canvas.height,\n      width = canvas.width,\n      context = canvas.getContext('2d');\n    return context.getImageData(0, 0, width, height);\n  }\n  function toImageDataFromContext (context) {\n    var\n      canvas = context.canvas,\n      height = canvas.height,\n      width = canvas.width;\n    return context.getImageData(0, 0, width, height);\n  }\n  function toCanvas (object) {\n    var\n      data = toImageData(object),\n      canvas = getCanvas(data.width, data.height),\n      context = canvas.getContext('2d');\n\n    context.putImageData(data, 0, 0);\n    return canvas;\n  }\n\n\n  // ImageData Equality Operators\n  function equalWidth (a, b) {\n    return a.width === b.width;\n  }\n  function equalHeight (a, b) {\n    return a.height === b.height;\n  }\n  function equalDimensions (a, b) {\n    return equalHeight(a, b) && equalWidth(a, b);\n  }\n  function equal (a, b, tolerance) {\n\n    var\n      aData     = a.data,\n      bData     = b.data,\n      length    = aData.length,\n      i;\n\n    tolerance = tolerance || 0;\n\n    if (!equalDimensions(a, b)) return false;\n    for (i = length; i--;) if (aData[i] !== bData[i] && Math.abs(aData[i] - bData[i]) > tolerance) return false;\n\n    return true;\n  }\n\n\n  // Diff\n  function diff (a, b, options) {\n    return (equalDimensions(a, b) ? diffEqual : diffUnequal)(a, b, options);\n  }\n  function diffEqual (a, b, options) {\n\n    var\n      height  = a.height,\n      width   = a.width,\n      c       = getImageData(width, height), // c = a - b\n      aData   = a.data,\n      bData   = b.data,\n      cData   = c.data,\n      length  = cData.length,\n      row, column,\n      i, j, k, v;\n\n    for (i = 0; i < length; i += 4) {\n      cData[i] = Math.abs(aData[i] - bData[i]);\n      cData[i+1] = Math.abs(aData[i+1] - bData[i+1]);\n      cData[i+2] = Math.abs(aData[i+2] - bData[i+2]);\n      cData[i+3] = Math.abs(255 - Math.abs(aData[i+3] - bData[i+3]));\n    }\n\n    return c;\n  }\n  function diffUnequal (a, b, options) {\n\n    var\n      height  = Math.max(a.height, b.height),\n      width   = Math.max(a.width, b.width),\n      c       = getImageData(width, height), // c = a - b\n      aData   = a.data,\n      bData   = b.data,\n      cData   = c.data,\n      align   = options && options.align,\n      rowOffset,\n      columnOffset,\n      row, column,\n      i, j, k, v;\n\n\n    for (i = cData.length - 1; i > 0; i = i - 4) {\n      cData[i] = 255;\n    }\n\n    // Add First Image\n    offsets(a);\n    for (row = a.height; row--;){\n      for (column = a.width; column--;) {\n        i = 4 * ((row + rowOffset) * width + (column + columnOffset));\n        j = 4 * (row * a.width + column);\n        cData[i+0] = aData[j+0]; // r\n        cData[i+1] = aData[j+1]; // g\n        cData[i+2] = aData[j+2]; // b\n        // cData[i+3] = aData[j+3]; // a\n      }\n    }\n\n    // Subtract Second Image\n    offsets(b);\n    for (row = b.height; row--;){\n      for (column = b.width; column--;) {\n        i = 4 * ((row + rowOffset) * width + (column + columnOffset));\n        j = 4 * (row * b.width + column);\n        cData[i+0] = Math.abs(cData[i+0] - bData[j+0]); // r\n        cData[i+1] = Math.abs(cData[i+1] - bData[j+1]); // g\n        cData[i+2] = Math.abs(cData[i+2] - bData[j+2]); // b\n      }\n    }\n\n    // Helpers\n    function offsets (imageData) {\n      if (align === 'top') {\n        rowOffset = 0;\n        columnOffset = 0;\n      } else {\n        rowOffset = Math.floor((height - imageData.height) / 2);\n        columnOffset = Math.floor((width - imageData.width) / 2);\n      }\n    }\n\n    return c;\n  }\n\n\n  // Validation\n  function checkType () {\n    var i;\n    for (i = 0; i < arguments.length; i++) {\n      if (!isImageType(arguments[i])) {\n        throw {\n          name : 'ImageTypeError',\n          message : 'Submitted object was not an image.'\n        };\n      }\n    }\n  }\n\n\n  // Jasmine Matchers\n  function get (element, content) {\n    element = document.createElement(element);\n    if (element && content) {\n      element.innerHTML = content;\n    }\n    return element;\n  }\n\n  jasmine = {\n\n    toBeImageData : function () {\n      return imagediff.isImageData(this.actual);\n    },\n\n    toImageDiffEqual : function (expected, tolerance) {\n\n      if (typeof (document) !== UNDEFINED) {\n        this.message = function () {\n          var\n            div     = get('div'),\n            a       = get('div', '<div>Actual:</div>'),\n            b       = get('div', '<div>Expected:</div>'),\n            c       = get('div', '<div>Diff:</div>'),\n            diff    = imagediff.diff(this.actual, expected),\n            canvas  = getCanvas(),\n            context;\n\n          canvas.height = diff.height;\n          canvas.width  = diff.width;\n\n          div.style.overflow = 'hidden';\n          a.style.float = 'left';\n          b.style.float = 'left';\n          c.style.float = 'left';\n\n          context = canvas.getContext('2d');\n          context.putImageData(diff, 0, 0);\n\n          a.appendChild(toCanvas(this.actual));\n          b.appendChild(toCanvas(expected));\n          c.appendChild(canvas);\n\n          div.appendChild(a);\n          div.appendChild(b);\n          div.appendChild(c);\n\n          return [\n            div,\n            \"Expected not to be equal.\"\n          ];\n        };\n      }\n\n      return imagediff.equal(this.actual, expected, tolerance);\n    }\n  };\n\n\n  // Image Output\n  function imageDataToPNG (imageData, outputFile, callback) {\n\n    var\n      canvas = toCanvas(imageData),\n      base64Data,\n      decodedImage;\n\n    callback = callback || Function;\n\n    base64Data = canvas.toDataURL().replace(/^data:image\\/\\w+;base64,/,\"\");\n    decodedImage = new Buffer(base64Data, 'base64');\n    require('fs').writeFile(outputFile, decodedImage, callback);\n  }\n\n\n  // Definition\n  imagediff = {\n\n    createCanvas : getCanvas,\n    createImageData : getImageData,\n    getCanvasRef: getCanvasRef,\n\n    isImage : isImage,\n    isCanvas : isCanvas,\n    isContext : isContext,\n    isImageData : isImageData,\n    isImageType : isImageType,\n\n    toImageData : function (object) {\n      checkType(object);\n      if (isImageData(object)) { return copyImageData(object); }\n      return toImageData(object);\n    },\n\n    equal : function (a, b, tolerance) {\n      checkType(a, b);\n      a = toImageData(a);\n      b = toImageData(b);\n      return equal(a, b, tolerance);\n    },\n    diff : function (a, b, options) {\n      checkType(a, b);\n      a = toImageData(a);\n      b = toImageData(b);\n      return diff(a, b, options);\n    },\n\n    jasmine : jasmine,\n\n    // Compatibility\n    noConflict : function () {\n      root[name] = previous;\n      return imagediff;\n    }\n  };\n\n  if (typeof module !== 'undefined') {\n    imagediff.imageDataToPNG = imageDataToPNG;\n  }\n\n  return imagediff;\n});\n","/*! rasterizeHTML.js - v1.1.0 - 2015-03-26\n* http://www.github.com/cburgmer/rasterizeHTML.js\n* Copyright (c) 2015 Christoph Burgmer; Licensed MIT */\n(function (root, factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module unless amdModuleId is set\n    define([\"url\",\"cssMediaQuery\",\"xmlserializer\",\"ayepromise\",\"inlineresources\"], function (a0,b1,c2,d3,e4) {\n      return (root['rasterizeHTML'] = factory(a0,b1,c2,d3,e4));\n    });\n  } else if (typeof exports === 'object') {\n    // Node. Does not work with strict CommonJS, but\n    // only CommonJS-like environments that support module.exports,\n    // like Node.\n    module.exports = factory(require(\"url\"),require(\"css-mediaquery\"),require(\"xmlserializer\"),require(\"ayepromise\"),require(\"inlineresources\"));\n  } else {\n    root['rasterizeHTML'] = factory(url,cssMediaQuery,xmlserializer,ayepromise,inlineresources);\n  }\n}(this, function (url, cssMediaQuery, xmlserializer, ayepromise, inlineresources) {\n\nvar util = (function (url) {\n    \"use strict\";\n\n    var module = {};\n\n    var uniqueIdList = [];\n\n    module.joinUrl = function (baseUrl, relUrl) {\n        if (!baseUrl) {\n            return relUrl;\n        }\n        return url.resolve(baseUrl, relUrl);\n    };\n\n    module.getConstantUniqueIdFor = function (element) {\n        // HACK, using a list results in O(n), but how do we hash e.g. a DOM node?\n        if (uniqueIdList.indexOf(element) < 0) {\n            uniqueIdList.push(element);\n        }\n        return uniqueIdList.indexOf(element);\n    };\n\n    module.clone = function (object) {\n        var theClone = {},\n            i;\n        for (i in object) {\n            if (object.hasOwnProperty(i)) {\n                theClone[i] = object[i];\n            }\n        }\n        return theClone;\n    };\n\n    var isObject = function (obj) {\n        return typeof obj === \"object\" && obj !== null;\n    };\n\n    var isCanvas = function (obj) {\n        return isObject(obj) &&\n            Object.prototype.toString.apply(obj).match(/\\[object (Canvas|HTMLCanvasElement)\\]/i);\n    };\n\n    // args: canvas, options\n    module.parseOptionalParameters = function (args) {\n        var parameters = {\n            canvas: null,\n            options: {}\n        };\n\n        if (args[0] == null || isCanvas(args[0])) {\n            parameters.canvas = args[0] || null;\n\n            parameters.options = module.clone(args[1]);\n        } else {\n            parameters.options = module.clone(args[0]);\n        }\n\n        return parameters;\n    };\n\n    return module;\n}(url));\n\n// Proxy objects by monkey patching\nvar proxies = (function (util, ayepromise) {\n    \"use strict\";\n\n    var module = {};\n\n    var monkeyPatchInstanceMethod = function (object, methodName, proxyFunc) {\n        var originalFunc = object[methodName];\n\n        object[methodName] = function () {\n            var args = Array.prototype.slice.call(arguments);\n\n            return proxyFunc.apply(this, [args, originalFunc]);\n        };\n\n        return originalFunc;\n    };\n\n    // Bases all XHR calls on the given base URL\n    module.baseUrlRespectingXhr = function (XHRObject, baseUrl) {\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(xhr, 'open', function (args, originalOpen) {\n                var method = args.shift(),\n                    url = args.shift(),\n                    joinedUrl = util.joinUrl(baseUrl, url);\n\n                return originalOpen.apply(this, [method, joinedUrl].concat(args));\n            });\n\n            return xhr;\n        };\n\n        return xhrConstructor;\n    };\n\n    // Provides a convenient way of being notified when all pending XHR calls are finished\n    module.finishNotifyingXhr = function (XHRObject) {\n        var totalXhrCount = 0,\n            doneXhrCount = 0,\n            waitingForPendingToClose = false,\n            defer = ayepromise.defer();\n\n        var checkAllRequestsFinished = function () {\n            var pendingXhrCount = totalXhrCount - doneXhrCount;\n\n            if (pendingXhrCount <= 0 && waitingForPendingToClose) {\n                defer.resolve({totalCount: totalXhrCount});\n            }\n        };\n\n        var xhrConstructor = function () {\n            var xhr = new XHRObject();\n\n            monkeyPatchInstanceMethod(xhr, 'send', function (_, originalSend) {\n                totalXhrCount += 1;\n                return originalSend.apply(this, arguments);\n            });\n\n            xhr.addEventListener('load', function () {\n                doneXhrCount += 1;\n\n                checkAllRequestsFinished();\n            });\n\n            return xhr;\n        };\n\n        xhrConstructor.waitForRequestsToFinish = function () {\n            waitingForPendingToClose = true;\n            checkAllRequestsFinished();\n            return defer.promise;\n        };\n\n        return xhrConstructor;\n    };\n\n    return module;\n}(util, ayepromise));\n\nvar documentUtil = (function () {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    module.addClassNameRecursively = function (element, className) {\n        element.className += ' ' + className;\n\n        if (element.parentNode !== element.ownerDocument) {\n            module.addClassNameRecursively(element.parentNode, className);\n        }\n    };\n\n    var changeCssRule = function (rule, newRuleText) {\n        var styleSheet = rule.parentStyleSheet,\n            ruleIdx = asArray(styleSheet.cssRules).indexOf(rule);\n\n        // Exchange rule with the new text\n        styleSheet.insertRule(newRuleText, ruleIdx+1);\n        styleSheet.deleteRule(ruleIdx);\n    };\n\n    var updateRuleSelector = function (rule, updatedSelector) {\n        var styleDefinitions = rule.cssText.replace(/^[^\\{]+/, ''),\n            newRule = updatedSelector + ' ' + styleDefinitions;\n\n        changeCssRule(rule, newRule);\n    };\n\n    var cssRulesToText = function (cssRules) {\n        return asArray(cssRules).reduce(function (cssText, rule) {\n            return cssText + rule.cssText;\n        }, '');\n    };\n\n    var rewriteStyleContent = function (styleElement) {\n        styleElement.textContent = cssRulesToText(styleElement.sheet.cssRules);\n    };\n\n    var matchingSimpleSelectorsRegex = function (simpleSelectorList) {\n        return '(' +\n            '(?:^|[^.#:\\\\w])' +            // start of string or not a simple selector character,\n            '|' +                          // ... or ...\n            '(?=\\\\W)' +                    // the next character parsed is not an alphabetic character (and thus a natural boundary)\n            ')' +\n            '(' +\n            simpleSelectorList.join('|') + // one out of the given simple selectors\n            ')' +\n            '(?=\\\\W|$)';                   // followed either by a non-alphabetic character or the end of the string\n    };\n\n    var replaceSimpleSelectorsBy = function (doc, simpleSelectorList, caseInsensitiveReplaceFunc) {\n        var selectorRegex = matchingSimpleSelectorsRegex(simpleSelectorList);\n\n        asArray(doc.querySelectorAll('style')).forEach(function (styleElement) {\n            var matchingRules = asArray(styleElement.sheet.cssRules).filter(function (rule) {\n                return rule.selectorText && new RegExp(selectorRegex, 'i').test(rule.selectorText);\n            });\n\n            if (matchingRules.length) {\n                matchingRules.forEach(function (rule) {\n                    var newSelector = rule.selectorText.replace(new RegExp(selectorRegex, 'gi'),\n                                                             function (_, prefixMatch, selectorMatch) {\n                        return prefixMatch + caseInsensitiveReplaceFunc(selectorMatch);\n                    });\n\n                    if (newSelector !== rule.selectorText) {\n                        updateRuleSelector(rule, newSelector);\n                    }\n                });\n\n                rewriteStyleContent(styleElement);\n            }\n        });\n    };\n\n    module.rewriteCssSelectorWith = function (doc, oldSelector, newSelector) {\n        replaceSimpleSelectorsBy(doc, [oldSelector], function () {\n            return newSelector;\n        });\n    };\n\n    module.lowercaseCssTypeSelectors = function (doc, matchingTagNames) {\n        replaceSimpleSelectorsBy(doc, matchingTagNames, function (match) {\n            return match.toLowerCase();\n        });\n    };\n\n    module.findHtmlOnlyNodeNames = function (doc) {\n        var treeWalker = doc.createTreeWalker(doc, NodeFilter.SHOW_ELEMENT),\n            htmlNodeNames = {},\n            nonHtmlNodeNames = {},\n            currentTagName;\n\n        while(treeWalker.nextNode()) {\n            currentTagName = treeWalker.currentNode.tagName.toLowerCase();\n            if (treeWalker.currentNode.namespaceURI === 'http://www.w3.org/1999/xhtml') {\n                htmlNodeNames[currentTagName] = true;\n            } else {\n                nonHtmlNodeNames[currentTagName] = true;\n            }\n        }\n\n        return Object.keys(htmlNodeNames).filter(function (tagName) {\n            return !nonHtmlNodeNames[tagName];\n        });\n    };\n\n    return module;\n}());\n\nvar documentHelper = (function (documentUtil) {\n    \"use strict\";\n\n    var module = {};\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    module.fakeHover = function (doc, hoverSelector) {\n        var elem = doc.querySelector(hoverSelector),\n            fakeHoverClass = 'rasterizehtmlhover';\n        if (! elem) {\n            return;\n        }\n\n        documentUtil.addClassNameRecursively(elem, fakeHoverClass);\n        documentUtil.rewriteCssSelectorWith(doc, ':hover', '.' + fakeHoverClass);\n    };\n\n    module.fakeActive = function (doc, activeSelector) {\n        var elem = doc.querySelector(activeSelector),\n            fakeActiveClass = 'rasterizehtmlactive';\n        if (! elem) {\n            return;\n        }\n\n        documentUtil.addClassNameRecursively(elem, fakeActiveClass);\n        documentUtil.rewriteCssSelectorWith(doc, ':active', '.' + fakeActiveClass);\n    };\n\n    module.fakeFocus = function (doc, focusSelector) {\n        var elem = doc.querySelector(focusSelector),\n            fakeFocusClass = 'rasterizehtmlfocus';\n        if (! elem) {\n            return;\n        }\n\n        documentUtil.addClassNameRecursively(elem, fakeFocusClass);\n        documentUtil.rewriteCssSelectorWith(doc, ':focus', '.' + fakeFocusClass);\n    };\n\n    module.persistInputValues = function (doc) {\n        var inputs = doc.querySelectorAll('input'),\n            textareas = doc.querySelectorAll('textarea'),\n            isCheckable = function (input) {\n                return input.type === 'checkbox' || input.type === 'radio';\n            };\n\n        asArray(inputs).filter(isCheckable)\n            .forEach(function (input) {\n                if (input.checked) {\n                    input.setAttribute('checked', '');\n                } else {\n                    input.removeAttribute('checked');\n                }\n            });\n\n        asArray(inputs).filter(function (input) { return !isCheckable(input); })\n            .forEach(function (input) {\n                input.setAttribute('value', input.value);\n            });\n\n        asArray(textareas)\n            .forEach(function (textarea) {\n                textarea.textContent = textarea.value;\n            });\n    };\n\n    module.rewriteTagNameSelectorsToLowerCase = function (doc) {\n        documentUtil.lowercaseCssTypeSelectors(doc, documentUtil.findHtmlOnlyNodeNames(doc));\n    };\n\n    return module;\n}(documentUtil));\n\nvar mediaQueryHelper = (function (cssMediaQuery) {\n    \"use strict\";\n\n    var module = {};\n\n    var svgImgBlueByEmMediaQuery = function () {\n        var svg = '<svg id=\"svg\" xmlns=\"http://www.w3.org/2000/svg\" width=\"10\" height=\"10\">' +\n                '<style>@media (max-width: 1em) { svg { background: #00f; } }</style>' +\n                '</svg>';\n\n        var url = \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svg),\n            img = document.createElement('img');\n\n        img.src = url;\n\n        return img;\n    };\n\n    var firstPixelHasColor = function (img, r, g, b) {\n        var canvas = document.createElement(\"canvas\");\n        canvas.width = img.width;\n        canvas.height = img.height;\n\n        var context = canvas.getContext(\"2d\"),\n            data;\n\n        context.drawImage(img, 0, 0);\n        data = context.getImageData(0, 0, 1, 1).data;\n        return data[0] === r && data[1] === g && data[2] === b;\n    };\n\n    var hasEmMediaQueryIssue = function () {\n        var img = svgImgBlueByEmMediaQuery(),\n            defer = ayepromise.defer();\n\n        document.querySelector('body').appendChild(img);\n\n        img.onload = function () {\n            document.querySelector('body').removeChild(img);\n            try {\n                defer.resolve(!firstPixelHasColor(img, 0, 0, 255));\n            } catch (e) {\n                // Fails in PhantomJS, let's assume the issue exists\n                defer.resolve(true);\n            }\n        };\n        img.onerror = function () {\n            defer.reject();\n        };\n\n        return defer.promise;\n    };\n\n    var hasEmIssue;\n\n    module.needsEmWorkaround = function () {\n        if (hasEmIssue === undefined) {\n            hasEmIssue = hasEmMediaQueryIssue();\n        }\n        return hasEmIssue;\n    };\n\n    var asArray = function (arrayLike) {\n        return Array.prototype.slice.call(arrayLike);\n    };\n\n    var cssRulesToText = function (cssRules) {\n        return asArray(cssRules).map(function (rule) {\n            return rule.cssText;\n        }).join('\\n');\n    };\n\n    var mediaQueryRule = function (mediaQueries, cssRules) {\n        return '@media ' + mediaQueries.join(', ') + '{' +\n            cssRulesToText(cssRules) +\n            '}';\n    };\n\n    var exchangeRuleWithNewContent = function (styleSheet, ruleIdx, newRuleText) {\n        try {\n            styleSheet.insertRule(newRuleText, ruleIdx+1);\n        } catch (e) {\n            // In case the browser does not like our new rule we just keep the existing one and quietly leave\n            return;\n        }\n        styleSheet.deleteRule(ruleIdx);\n    };\n\n    var changeCssRule = function (rule, newRuleText) {\n        var styleSheet = rule.parentStyleSheet,\n            ruleIdx = asArray(styleSheet.cssRules).indexOf(rule);\n\n        exchangeRuleWithNewContent(styleSheet, ruleIdx, newRuleText);\n    };\n\n    var rewriteStyleContent = function (styleElement) {\n        styleElement.textContent = cssRulesToText(styleElement.sheet.cssRules);\n    };\n\n    var serializeExpression = function (exp) {\n        var feature = exp.modifier ? exp.modifier + '-' + exp.feature : exp.feature;\n        if (exp.value) {\n            return '(' + feature + ': ' + exp.value + ')';\n        } else {\n            return '(' + feature + ')';\n        }\n    };\n\n    var serializeQueryPart = function (q) {\n        var segments = [];\n\n        if (q.inverse) {\n            segments.push(\"not\");\n        }\n\n        segments.push(q.type);\n\n        if (q.expressions.length > 0) {\n            segments.push('and ' + q.expressions.map(serializeExpression).join(' and '));\n        }\n\n        return segments.join(' ');\n    };\n\n    // poor man's testability\n    module.serializeQuery = function (q) {\n        var queryParts = q.map(serializeQueryPart);\n        return queryParts.join(', ');\n    };\n\n    var transformEmIntoPx = function (em) {\n        return em * 16;\n    };\n\n    var replaceEmValueWithPx = function (value) {\n        // Match a number with em unit. Doesn't match all, but should be enough for now\n        var match = /^((?:\\d+\\.)?\\d+)em/.exec(value);\n        if (match) {\n            return transformEmIntoPx(parseFloat(match[1])) + 'px';\n        }\n        return value;\n    };\n\n    var substituteEmWithPx = function (mediaQuery) {\n        var parsedQuery = cssMediaQuery.parse(mediaQuery),\n            hasChanges = false;\n\n        parsedQuery.forEach(function (q) {\n            q.expressions.forEach(function (exp) {\n                var rewrittenValue = replaceEmValueWithPx(exp.value);\n\n                hasChanges |= rewrittenValue !== exp.value;\n                exp.value = rewrittenValue;\n            });\n        });\n\n        if (hasChanges) {\n            mediaQuery = module.serializeQuery(parsedQuery);\n        }\n\n        return mediaQuery;\n    };\n\n    var replaceEmsWithPx = function (mediaQueryRules) {\n        var anyRuleHasChanges = false;\n\n        mediaQueryRules.forEach(function (rule) {\n            var hasChanges = false;\n\n            var reworkedMediaQueries = asArray(rule.media).map(function (mediaQuery) {\n                var rewrittenMediaQuery = substituteEmWithPx(mediaQuery);\n\n                hasChanges |= rewrittenMediaQuery !== mediaQuery;\n                return rewrittenMediaQuery;\n            });\n\n            if (hasChanges) {\n                changeCssRule(rule, mediaQueryRule(reworkedMediaQueries, rule.cssRules));\n            }\n\n            anyRuleHasChanges |= hasChanges;\n        });\n\n        return anyRuleHasChanges;\n    };\n\n    module.workAroundWebKitEmSizeIssue = function (document) {\n        var styles = document.querySelectorAll('style');\n\n        asArray(styles).forEach(function (style) {\n            var mediaQueryRules = asArray(style.sheet.cssRules).filter(function (rule) {\n                return rule.type === window.CSSRule.MEDIA_RULE;\n            });\n\n            var hasChanges = replaceEmsWithPx(mediaQueryRules);\n            if (hasChanges) {\n                rewriteStyleContent(style);\n            }\n        });\n    };\n\n    return module;\n}(cssMediaQuery));\n\nvar browser = (function (util, proxies, ayepromise, theWindow) {\n    \"use strict\";\n\n    var module = {};\n\n    var createHiddenElement = function (doc, tagName, width, height) {\n        var element = doc.createElement(tagName);\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading CSS\n        element.style.visibility = \"hidden\";\n        element.style.width = width + \"px\";\n        element.style.height = height + \"px\";\n        element.style.position = \"absolute\";\n        element.style.top = (-10000 - height) + \"px\";\n        element.style.left = (-10000 - width) + \"px\";\n        // We need to add the element to the document so that its content gets loaded\n        doc.getElementsByTagName(\"body\")[0].appendChild(element);\n        return element;\n    };\n\n    module.executeJavascript = function (doc, options) {\n        var iframe = createHiddenElement(theWindow.document, \"iframe\", options.width, options.height),\n            html = doc.documentElement.outerHTML,\n            iframeErrorsMessages = [],\n            defer = ayepromise.defer(),\n            timeout = options.executeJsTimeout || 0;\n\n        var doResolve = function () {\n            var doc = iframe.contentDocument;\n            theWindow.document.getElementsByTagName(\"body\")[0].removeChild(iframe);\n            defer.resolve({\n                document: doc,\n                errors: iframeErrorsMessages\n            });\n        };\n\n        var waitForJavaScriptToRun = function () {\n            var d = ayepromise.defer();\n            if (timeout > 0) {\n                setTimeout(d.resolve, timeout);\n            } else {\n                d.resolve();\n            }\n            return d.promise;\n        };\n\n        iframe.onload = function () {\n            waitForJavaScriptToRun()\n                .then(finishNotifyXhrProxy.waitForRequestsToFinish)\n                .then(doResolve);\n        };\n\n        var xhr = iframe.contentWindow.XMLHttpRequest,\n            finishNotifyXhrProxy = proxies.finishNotifyingXhr(xhr),\n            baseUrlXhrProxy = proxies.baseUrlRespectingXhr(finishNotifyXhrProxy, options.baseUrl);\n\n        iframe.contentDocument.open();\n        iframe.contentWindow.XMLHttpRequest = baseUrlXhrProxy;\n        iframe.contentWindow.onerror = function (msg) {\n            iframeErrorsMessages.push({\n                resourceType: \"scriptExecution\",\n                msg: msg\n            });\n        };\n\n        iframe.contentDocument.write('<!DOCTYPE html>');\n        iframe.contentDocument.write(html);\n        iframe.contentDocument.close();\n\n        return defer.promise;\n    };\n\n    var createHiddenSandboxedIFrame = function (doc, width, height) {\n        var iframe = doc.createElement('iframe');\n        iframe.style.width = width + \"px\";\n        iframe.style.height = height + \"px\";\n        // 'display: none' doesn't cut it, as browsers seem to be lazy loading content\n        iframe.style.visibility = \"hidden\";\n        iframe.style.position = \"absolute\";\n        iframe.style.top = (-10000 - height) + \"px\";\n        iframe.style.left = (-10000 - width) + \"px\";\n        // Don't execute JS, all we need from sandboxing is access to the iframe's document\n        iframe.sandbox = 'allow-same-origin';\n        // Don't include a scrollbar on Linux\n        iframe.scrolling = 'no';\n        return iframe;\n    };\n\n    var createIframeWithSizeAtZoomLevel1 = function (width, height, zoom) {\n        var scaledViewportWidth = Math.floor(width / zoom),\n            scaledViewportHeight = Math.floor(height / zoom);\n\n        return createHiddenSandboxedIFrame(theWindow.document, scaledViewportWidth, scaledViewportHeight);\n    };\n\n    var calculateZoomedContentSizeAndRoundUp = function (actualViewport, requestedWidth, requestedHeight, zoom) {\n        return {\n            width: Math.max(actualViewport.width * zoom, requestedWidth),\n            height: Math.max(actualViewport.height * zoom, requestedHeight)\n        };\n    };\n\n    var calculateContentSize = function (doc, selector, requestedWidth, requestedHeight, zoom) {\n            // clientWidth/clientHeight needed for PhantomJS\n        var actualViewportWidth = Math.max(doc.documentElement.scrollWidth, doc.body.clientWidth),\n            actualViewportHeight = Math.max(doc.documentElement.scrollHeight, doc.body.scrollHeight, doc.body.clientHeight),\n            top, left, originalWidth, originalHeight, rootFontSize,\n            element, rect, contentSize;\n\n        if (selector) {\n            element = doc.querySelector(selector);\n\n            if (!element) {\n                throw {\n                    message: \"Clipping selector not found\"\n                };\n            }\n\n            rect = element.getBoundingClientRect();\n\n            top = rect.top;\n            left = rect.left;\n            originalWidth = rect.width;\n            originalHeight = rect.height;\n        } else {\n            top = 0;\n            left = 0;\n            originalWidth = actualViewportWidth;\n            originalHeight = actualViewportHeight;\n        }\n\n        contentSize = calculateZoomedContentSizeAndRoundUp({\n                width: originalWidth,\n                height: originalHeight\n            },\n            requestedWidth,\n            requestedHeight,\n            zoom);\n\n        rootFontSize = theWindow.getComputedStyle(doc.documentElement).fontSize;\n\n        return {\n            left: left,\n            top: top,\n            width: contentSize.width,\n            height: contentSize.height,\n            viewportWidth: actualViewportWidth,\n            viewportHeight: actualViewportHeight,\n\n            rootFontSize: rootFontSize\n        };\n    };\n\n    module.calculateDocumentContentSize = function (doc, options) {\n        var html = doc.documentElement.outerHTML,\n            defer = ayepromise.defer(),\n            zoom = options.zoom || 1,\n            iframe;\n\n\n        iframe = createIframeWithSizeAtZoomLevel1(options.width, options.height, zoom);\n        // We need to add the element to the document so that its content gets loaded\n        theWindow.document.getElementsByTagName(\"body\")[0].appendChild(iframe);\n\n        iframe.onload = function () {\n            var doc = iframe.contentDocument,\n                size;\n\n            try {\n                size = calculateContentSize(doc, options.clip, options.width, options.height, zoom);\n\n                defer.resolve(size);\n            } catch (e) {\n                defer.reject(e);\n            } finally {\n                theWindow.document.getElementsByTagName(\"body\")[0].removeChild(iframe);\n            }\n        };\n\n        // srcdoc doesn't work in PhantomJS yet\n        iframe.contentDocument.open();\n        iframe.contentDocument.write('<!DOCTYPE html>');\n        iframe.contentDocument.write(html);\n        iframe.contentDocument.close();\n\n        return defer.promise;\n    };\n\n    var addHTMLTagAttributes = function (doc, html) {\n        var attributeMatch = /<html((?:\\s+[^>]*)?)>/im.exec(html),\n            helperDoc = theWindow.document.implementation.createHTMLDocument(''),\n            htmlTagSubstitute,\n            i, elementSubstitute, attribute;\n\n        if (!attributeMatch) {\n            return;\n        }\n\n        htmlTagSubstitute = '<div' + attributeMatch[1] + '></div>';\n        helperDoc.documentElement.innerHTML = htmlTagSubstitute;\n        elementSubstitute = helperDoc.querySelector('div');\n\n        for (i = 0; i < elementSubstitute.attributes.length; i++) {\n            attribute = elementSubstitute.attributes[i];\n            doc.documentElement.setAttribute(attribute.name, attribute.value);\n        }\n    };\n\n    module.parseHTML = function (html) {\n        // We should be using the DOMParser, but it is not supported in older browsers\n        var doc = theWindow.document.implementation.createHTMLDocument('');\n        doc.documentElement.innerHTML = html;\n\n        addHTMLTagAttributes(doc, html);\n        return doc;\n    };\n\n    var isParseError = function (parsedDocument) {\n        // http://stackoverflow.com/questions/11563554/how-do-i-detect-xml-parsing-errors-when-using-javascripts-domparser-in-a-cross\n        var p = new DOMParser(),\n            errorneousParse = p.parseFromString('<', 'text/xml'),\n            parsererrorNS = errorneousParse.getElementsByTagName(\"parsererror\")[0].namespaceURI;\n\n        if (parsererrorNS === 'http://www.w3.org/1999/xhtml') {\n            // In PhantomJS the parseerror element doesn't seem to have a special namespace, so we are just guessing here :(\n            return parsedDocument.getElementsByTagName(\"parsererror\").length > 0;\n        }\n\n        return parsedDocument.getElementsByTagNameNS(parsererrorNS, 'parsererror').length > 0;\n    };\n\n    var failOnParseError = function (doc) {\n        if (doc === null || isParseError(doc)) {\n            throw {\n                message: \"Invalid source\"\n            };\n        }\n    };\n\n    module.validateXHTML = function (xhtml) {\n        var p = new DOMParser(),\n            doc = p.parseFromString(xhtml, \"application/xml\");\n\n        failOnParseError(doc);\n    };\n\n    var lastCacheDate = null;\n\n    var getUncachableURL = function (url, cache) {\n        if (cache === 'none' || cache === 'repeated') {\n            if (lastCacheDate === null || cache !== 'repeated') {\n                lastCacheDate = Date.now();\n            }\n            return url + \"?_=\" + lastCacheDate;\n        } else {\n            return url;\n        }\n    };\n\n    var doDocumentLoad = function (url, options) {\n        var ajaxRequest = new window.XMLHttpRequest(),\n            joinedUrl = util.joinUrl(options.baseUrl, url),\n            augmentedUrl = getUncachableURL(joinedUrl, options.cache),\n            defer = ayepromise.defer(),\n            doReject = function () {\n                defer.reject({message: \"Unable to load page\"});\n            };\n\n        ajaxRequest.addEventListener(\"load\", function () {\n            if (ajaxRequest.status === 200 || ajaxRequest.status === 0) {\n                defer.resolve(ajaxRequest.responseXML);\n            } else {\n                doReject();\n            }\n        }, false);\n\n        ajaxRequest.addEventListener(\"error\", function () {\n            doReject();\n        }, false);\n\n        try {\n            ajaxRequest.open('GET', augmentedUrl, true);\n            ajaxRequest.responseType = \"document\";\n            ajaxRequest.send(null);\n        } catch (err) {\n            doReject();\n        }\n\n        return defer.promise;\n    };\n\n    module.loadDocument = function (url, options) {\n        return doDocumentLoad(url, options)\n            .then(function (doc) {\n                failOnParseError(doc);\n\n                return doc;\n            });\n    };\n\n    return module;\n}(util, proxies, ayepromise, window));\n\nvar svg2image = (function (ayepromise, window) {\n    \"use strict\";\n\n    var module = {};\n\n    var urlForSvg = function (svg, useBlobs) {\n        if (useBlobs) {\n            return URL.createObjectURL(new Blob([svg], {\"type\": \"image/svg+xml\"}));\n        } else {\n            return \"data:image/svg+xml;charset=utf-8,\" + encodeURIComponent(svg);\n        }\n    };\n\n    var cleanUpUrl = function (url) {\n        if (url instanceof Blob) {\n            URL.revokeObjectURL(url);\n        }\n    };\n\n    var simpleForeignObjectSvg = '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1\" height=\"1\"><foreignObject></foreignObject></svg>';\n\n    var supportsReadingObjectFromCanvas = function (url) {\n        var canvas = document.createElement(\"canvas\"),\n            image = new Image(),\n            defer = ayepromise.defer();\n\n        image.onload = function () {\n            var context = canvas.getContext(\"2d\");\n            try {\n                context.drawImage(image, 0, 0);\n                // This will fail in Chrome & Safari\n                canvas.toDataURL(\"image/png\");\n                defer.resolve(true);\n            } catch (e) {\n                defer.resolve(false);\n            }\n        };\n        image.onerror = defer.reject;\n        image.src = url;\n\n        return defer.promise;\n    };\n\n    var readingBackFromCanvasBenefitsFromOldSchoolDataUris = function () {\n        // Check for work around for https://code.google.com/p/chromium/issues/detail?id=294129\n        var blobUrl = urlForSvg(simpleForeignObjectSvg, true);\n        return supportsReadingObjectFromCanvas(blobUrl)\n            .then(function (supportsReadingFromBlobs) {\n                cleanUpUrl(blobUrl);\n                if (supportsReadingFromBlobs) {\n                    return false;\n                }\n                return supportsReadingObjectFromCanvas(urlForSvg(simpleForeignObjectSvg, false))\n                    .then(function (s) {\n                        return s;\n                    });\n            }, function () {\n                return false;\n            });\n    };\n\n    var supportsBlobBuilding = function () {\n        if (window.Blob) {\n            // Available as constructor only in newer builds for all browsers\n            try {\n                new Blob(['<b></b>'], { \"type\" : \"text/xml\" });\n                return true;\n            } catch (err) {}\n        }\n        return false;\n    };\n\n    var checkBlobSupport = function () {\n        var defer = ayepromise.defer();\n\n        if (supportsBlobBuilding && window.URL) {\n            readingBackFromCanvasBenefitsFromOldSchoolDataUris()\n                .then(function (doesBenefit) {\n                    defer.resolve(! doesBenefit);\n                }, function () {\n                    defer.reject();\n                });\n        } else {\n            defer.resolve(false);\n        }\n\n        return defer.promise;\n    };\n\n    var checkForBlobsResult;\n\n    var checkForBlobs = function () {\n        if (checkForBlobsResult === undefined) {\n            checkForBlobsResult = checkBlobSupport();\n        }\n\n        return checkForBlobsResult;\n    };\n\n    var buildImageUrl = function (svg) {\n        return checkForBlobs().then(function (useBlobs) {\n            return urlForSvg(svg, useBlobs);\n        });\n    };\n\n    module.renderSvg = function (svg) {\n        var url, image,\n            defer = ayepromise.defer(),\n            resetEventHandlers = function () {\n                image.onload = null;\n                image.onerror = null;\n            },\n            cleanUp = function () {\n                if (url) {\n                    cleanUpUrl(url);\n                }\n            };\n\n        image = new Image();\n        image.onload = function() {\n            resetEventHandlers();\n            cleanUp();\n\n            defer.resolve(image);\n        };\n        image.onerror = function () {\n            cleanUp();\n\n            // Webkit calls the onerror handler if the SVG is faulty\n            defer.reject();\n        };\n\n        buildImageUrl(svg).then(function (imageUrl) {\n            url = imageUrl;\n            image.src = url;\n        }, defer.reject);\n\n        return defer.promise;\n    };\n\n    return module;\n}(ayepromise, window));\n\nvar document2svg = (function (util, browser, documentHelper, mediaQueryHelper, xmlserializer) {\n    \"use strict\";\n\n    var module = {};\n\n    var zoomedElementSizingAttributes = function (size, zoomFactor) {\n        var closestScaledWith, closestScaledHeight,\n            offsetX, offsetY;\n\n        zoomFactor = zoomFactor || 1;\n        closestScaledWith = Math.round(size.viewportWidth);\n        closestScaledHeight = Math.round(size.viewportHeight);\n\n        offsetX = -size.left;\n        offsetY = -size.top;\n\n        var attributes = {\n             'x': offsetX,\n             'y': offsetY,\n             'width': closestScaledWith,\n             'height': closestScaledHeight\n        };\n\n        if (zoomFactor !== 1) {\n            attributes.transform = 'scale(' + zoomFactor + ')';\n        }\n\n        return attributes;\n    };\n\n    var workAroundCollapsingMarginsAcrossSVGElementInWebKitLike = function (attributes) {\n        var style = attributes.style || '';\n        attributes.style = style + 'float: left;';\n    };\n\n    var workAroundSafariSometimesNotShowingExternalResources = function (attributes) {\n        /* Let's hope that works some magic. The spec says SVGLoad only fires\n         * now when all externals are available.\n         * http://www.w3.org/TR/SVG/struct.html#ExternalResourcesRequired */\n        attributes.externalResourcesRequired = true;\n    };\n\n    var workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll = function () {\n        return '<style scoped=\"\">html::-webkit-scrollbar { display: none; }</style>';\n    };\n\n    var serializeAttributes = function (attributes) {\n        var keys = Object.keys(attributes);\n        if (!keys.length) {\n            return '';\n        }\n\n        return ' ' + keys.map(function (key) {\n            return key + '=\"' + attributes[key] + '\"';\n        }).join(' ');\n    };\n\n    var convertDocumentToSvg = function (doc, size, zoomFactor) {\n        var xhtml = xmlserializer.serializeToString(doc);\n\n        browser.validateXHTML(xhtml);\n\n        var attributes = zoomedElementSizingAttributes(size, zoomFactor);\n\n        workAroundCollapsingMarginsAcrossSVGElementInWebKitLike(attributes);\n        workAroundSafariSometimesNotShowingExternalResources(attributes);\n\n        return (\n            '<svg xmlns=\"http://www.w3.org/2000/svg\"' +\n                ' width=\"' + size.width + '\"' +\n                ' height=\"' + size.height + '\"' +\n                ' font-size=\"' + size.rootFontSize + '\"' +\n                '>' +\n                workAroundChromeShowingScrollbarsUnderLinuxIfHtmlIsOverflowScroll() +\n                '<foreignObject' + serializeAttributes(attributes) + '>' +\n                xhtml +\n                '</foreignObject>' +\n                '</svg>'\n        );\n    };\n\n    module.getSvgForDocument = function (doc, size, zoomFactor) {\n        documentHelper.rewriteTagNameSelectorsToLowerCase(doc);\n\n        return mediaQueryHelper.needsEmWorkaround().then(function (needsWorkaround) {\n            if (needsWorkaround) {\n                mediaQueryHelper.workAroundWebKitEmSizeIssue(doc);\n            }\n\n            return convertDocumentToSvg(doc, size, zoomFactor);\n        });\n    };\n\n    module.drawDocumentAsSvg = function (doc, options) {\n        if (options.hover) {\n            documentHelper.fakeHover(doc, options.hover);\n        }\n        if (options.active) {\n            documentHelper.fakeActive(doc, options.active);\n        }\n        if (options.focus) {\n            documentHelper.fakeFocus(doc, options.focus);\n        }\n\n        return browser.calculateDocumentContentSize(doc, options)\n            .then(function (size) {\n                return module.getSvgForDocument(doc, size, options.zoom);\n            });\n    };\n\n    return module;\n}(util, browser, documentHelper, mediaQueryHelper, xmlserializer));\n\nvar rasterize = (function (util, browser, documentHelper, document2svg, svg2image, inlineresources) {\n    \"use strict\";\n\n    var module = {};\n\n    var generalDrawError = function () {\n        return {message: \"Error rendering page\"};\n    };\n\n    var drawSvgAsImg = function (svg) {\n        return svg2image.renderSvg(svg)\n            .then(function (image) {\n                return {\n                    image: image,\n                    svg: svg\n                };\n            }, function () {\n                throw generalDrawError();\n            });\n    };\n\n    var drawImageOnCanvas = function (image, canvas) {\n        try {\n            canvas.getContext(\"2d\").drawImage(image, 0, 0);\n        } catch (e) {\n            // Firefox throws a 'NS_ERROR_NOT_AVAILABLE' if the SVG is faulty\n            throw generalDrawError();\n        }\n    };\n\n    var doDraw = function (doc, canvas, options) {\n        return document2svg.drawDocumentAsSvg(doc, options)\n            .then(drawSvgAsImg)\n            .then(function (result) {\n                if (canvas) {\n                    drawImageOnCanvas(result.image, canvas);\n                }\n\n                return result;\n            });\n    };\n\n    var operateJavaScriptOnDocument = function (doc, options) {\n        return browser.executeJavascript(doc, options)\n            .then(function (result) {\n                var document = result.document;\n                documentHelper.persistInputValues(document);\n\n                return {\n                    document: document,\n                    errors: result.errors\n                };\n            });\n    };\n\n    module.rasterize = function (doc, canvas, options) {\n        var inlineOptions;\n\n        inlineOptions = util.clone(options);\n        inlineOptions.inlineScripts = options.executeJs === true;\n\n        return inlineresources.inlineReferences(doc, inlineOptions)\n            .then(function (errors) {\n                if (options.executeJs) {\n                    return operateJavaScriptOnDocument(doc, options)\n                        .then(function (result) {\n                            return {\n                                document: result.document,\n                                errors: errors.concat(result.errors)\n                            };\n                        });\n                } else {\n                    return {\n                        document: doc,\n                        errors: errors\n                    };\n                }\n            }).then(function (result) {\n                return doDraw(result.document, canvas, options)\n                    .then(function (drawResult) {\n                        return {\n                            image: drawResult.image,\n                            svg: drawResult.svg,\n                            errors: result.errors\n                        };\n                    });\n            });\n    };\n\n    return module;\n}(util, browser, documentHelper, document2svg, svg2image, inlineresources));\n\nvar rasterizeHTML = (function (util, browser, rasterize) {\n    \"use strict\";\n\n    var module = {};\n\n    var getViewportSize = function (canvas, options) {\n        var defaultWidth = 300,\n            defaultHeight = 200,\n            fallbackWidth = canvas ? canvas.width : defaultWidth,\n            fallbackHeight = canvas ? canvas.height : defaultHeight,\n            width = options.width !== undefined ? options.width : fallbackWidth,\n            height = options.height !== undefined ? options.height : fallbackHeight;\n\n        return {\n            width: width,\n            height: height\n        };\n    };\n\n    var constructOptions = function (params) {\n        var viewport = getViewportSize(params.canvas, params.options),\n            options;\n\n        options = util.clone(params.options);\n        options.width = viewport.width;\n        options.height = viewport.height;\n\n        return options;\n    };\n\n    /**\n     * Draws a Document to the canvas.\n     * rasterizeHTML.drawDocument( document [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawDocument = function () {\n        var doc = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return rasterize.rasterize(doc, params.canvas, constructOptions(params));\n    };\n\n    var drawHTML = function (html, canvas, options) {\n        var doc = browser.parseHTML(html);\n\n        return module.drawDocument(doc, canvas, options);\n    };\n\n    /**\n     * Draws a HTML string to the canvas.\n     * rasterizeHTML.drawHTML( html [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawHTML = function () {\n        var html = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawHTML(html, params.canvas, params.options);\n    };\n\n    // work around https://bugzilla.mozilla.org/show_bug.cgi?id=925493\n    var workAroundFirefoxNotLoadingStylesheetStyles = function (doc, url, options) {\n        var d = document.implementation.createHTMLDocument('');\n        d.replaceChild(doc.documentElement, d.documentElement);\n\n        var extendedOptions = options ? util.clone(options) : {};\n\n        if (!options.baseUrl) {\n            extendedOptions.baseUrl = url;\n        }\n\n        return {\n            document: d,\n            options: extendedOptions\n        };\n    };\n\n    var drawURL = function (url, canvas, options) {\n        return browser.loadDocument(url, options)\n            .then(function (doc) {\n                var workaround = workAroundFirefoxNotLoadingStylesheetStyles(doc, url, options);\n                return module.drawDocument(workaround.document, canvas, workaround.options);\n            });\n    };\n\n    /**\n     * Draws a page to the canvas.\n     * rasterizeHTML.drawURL( url [, canvas] [, options] ).then(function (result) { ... });\n     */\n    module.drawURL = function () {\n        var url = arguments[0],\n            optionalArguments = Array.prototype.slice.call(arguments, 1),\n            params = util.parseOptionalParameters(optionalArguments);\n\n        return drawURL(url, params.canvas, params.options);\n    };\n\n    return module;\n}(util, browser, rasterize));\n\nreturn rasterizeHTML;\n\n}));\n","\"use strict\";\n\nmodule.exports = function Canvas () {\n  return document.createElement('canvas');\n};\n","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <feross@feross.org> <http://feross.org>\n * @license  MIT\n */\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('is-array')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\nBuffer.poolSize = 8192 // not used by this implementation\n\nvar kMaxLength = 0x3fffffff\nvar rootParent = {}\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Note:\n *\n * - Implementation must support adding new properties to `Uint8Array` instances.\n *   Firefox 4-29 lacked support, fixed in Firefox 30+.\n *   See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *  - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *  - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *    incorrect length in some situations.\n *\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they will\n * get the Object implementation, which is slower but will work correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = (function () {\n  try {\n    var buf = new ArrayBuffer(0)\n    var arr = new Uint8Array(buf)\n    arr.foo = function () { return 42 }\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        new Uint8Array(1).subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n})()\n\n/**\n * Class: Buffer\n * =============\n *\n * The Buffer constructor returns instances of `Uint8Array` that are augmented\n * with function properties for all the node `Buffer` API functions. We use\n * `Uint8Array` so that square bracket notation works as expected -- it returns\n * a single octet.\n *\n * By augmenting the instances, we can avoid modifying the `Uint8Array`\n * prototype.\n */\nfunction Buffer (subject, encoding) {\n  var self = this\n  if (!(self instanceof Buffer)) return new Buffer(subject, encoding)\n\n  var type = typeof subject\n  var length\n\n  if (type === 'number') {\n    length = +subject\n  } else if (type === 'string') {\n    length = Buffer.byteLength(subject, encoding)\n  } else if (type === 'object' && subject !== null) {\n    // assume object is array-like\n    if (subject.type === 'Buffer' && isArray(subject.data)) subject = subject.data\n    length = +subject.length\n  } else {\n    throw new TypeError('must start with number, buffer, array or string')\n  }\n\n  if (length > kMaxLength) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum size: 0x' +\n      kMaxLength.toString(16) + ' bytes')\n  }\n\n  if (length < 0) length = 0\n  else length >>>= 0 // coerce to uint32\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Preferred: Return an augmented `Uint8Array` instance for best performance\n    self = Buffer._augment(new Uint8Array(length)) // eslint-disable-line consistent-this\n  } else {\n    // Fallback: Return THIS instance of Buffer (created by `new`)\n    self.length = length\n    self._isBuffer = true\n  }\n\n  var i\n  if (Buffer.TYPED_ARRAY_SUPPORT && typeof subject.byteLength === 'number') {\n    // Speed optimization -- use set if we're copying from a typed array\n    self._set(subject)\n  } else if (isArrayish(subject)) {\n    // Treat array-ish objects as a byte array\n    if (Buffer.isBuffer(subject)) {\n      for (i = 0; i < length; i++) {\n        self[i] = subject.readUInt8(i)\n      }\n    } else {\n      for (i = 0; i < length; i++) {\n        self[i] = ((subject[i] % 256) + 256) % 256\n      }\n    }\n  } else if (type === 'string') {\n    self.write(subject, 0, encoding)\n  } else if (type === 'number' && !Buffer.TYPED_ARRAY_SUPPORT) {\n    for (i = 0; i < length; i++) {\n      self[i] = 0\n    }\n  }\n\n  if (length > 0 && length <= Buffer.poolSize) self.parent = rootParent\n\n  return self\n}\n\nfunction SlowBuffer (subject, encoding) {\n  if (!(this instanceof SlowBuffer)) return new SlowBuffer(subject, encoding)\n\n  var buf = new Buffer(subject, encoding)\n  delete buf.parent\n  return buf\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n  for (var i = 0, len = Math.min(x, y); i < len && a[i] === b[i]; i++) {}\n  if (i !== len) {\n    x = a[i]\n    y = b[i]\n  }\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'binary':\n    case 'base64':\n    case 'raw':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, totalLength) {\n  if (!isArray(list)) throw new TypeError('list argument must be an Array of Buffers.')\n\n  if (list.length === 0) {\n    return new Buffer(0)\n  } else if (list.length === 1) {\n    return list[0]\n  }\n\n  var i\n  if (totalLength === undefined) {\n    totalLength = 0\n    for (i = 0; i < list.length; i++) {\n      totalLength += list[i].length\n    }\n  }\n\n  var buf = new Buffer(totalLength)\n  var pos = 0\n  for (i = 0; i < list.length; i++) {\n    var item = list[i]\n    item.copy(buf, pos)\n    pos += item.length\n  }\n  return buf\n}\n\nBuffer.byteLength = function byteLength (str, encoding) {\n  var ret\n  str = str + ''\n  switch (encoding || 'utf8') {\n    case 'ascii':\n    case 'binary':\n    case 'raw':\n      ret = str.length\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = str.length * 2\n      break\n    case 'hex':\n      ret = str.length >>> 1\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8ToBytes(str).length\n      break\n    case 'base64':\n      ret = base64ToBytes(str).length\n      break\n    default:\n      ret = str.length\n  }\n  return ret\n}\n\n// pre-set for values that may exist in the future\nBuffer.prototype.length = undefined\nBuffer.prototype.parent = undefined\n\n// toString(encoding, start=0, end=buffer.length)\nBuffer.prototype.toString = function toString (encoding, start, end) {\n  var loweredCase = false\n\n  start = start >>> 0\n  end = end === undefined || end === Infinity ? this.length : end >>> 0\n\n  if (!encoding) encoding = 'utf8'\n  if (start < 0) start = 0\n  if (end > this.length) end = this.length\n  if (end <= start) return ''\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'binary':\n        return binarySlice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return 0\n  return Buffer.compare(this, b)\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset) {\n  if (byteOffset > 0x7fffffff) byteOffset = 0x7fffffff\n  else if (byteOffset < -0x80000000) byteOffset = -0x80000000\n  byteOffset >>= 0\n\n  if (this.length === 0) return -1\n  if (byteOffset >= this.length) return -1\n\n  // Negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = Math.max(this.length + byteOffset, 0)\n\n  if (typeof val === 'string') {\n    if (val.length === 0) return -1 // special case: looking for empty string always fails\n    return String.prototype.indexOf.call(this, val, byteOffset)\n  }\n  if (Buffer.isBuffer(val)) {\n    return arrayIndexOf(this, val, byteOffset)\n  }\n  if (typeof val === 'number') {\n    if (Buffer.TYPED_ARRAY_SUPPORT && Uint8Array.prototype.indexOf === 'function') {\n      return Uint8Array.prototype.indexOf.call(this, val, byteOffset)\n    }\n    return arrayIndexOf(this, [ val ], byteOffset)\n  }\n\n  function arrayIndexOf (arr, val, byteOffset) {\n    var foundIndex = -1\n    for (var i = 0; byteOffset + i < arr.length; i++) {\n      if (arr[byteOffset + i] === val[foundIndex === -1 ? 0 : i - foundIndex]) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === val.length) return byteOffset + foundIndex\n      } else {\n        foundIndex = -1\n      }\n    }\n    return -1\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\n// `get` will be removed in Node 0.13+\nBuffer.prototype.get = function get (offset) {\n  console.log('.get() is deprecated. Access using array indexes instead.')\n  return this.readUInt8(offset)\n}\n\n// `set` will be removed in Node 0.13+\nBuffer.prototype.set = function set (v, offset) {\n  console.log('.set() is deprecated. Access using array indexes instead.')\n  return this.writeUInt8(v, offset)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new Error('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; i++) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) throw new Error('Invalid hex string')\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n  return charsWritten\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(asciiToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction binaryWrite (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  var charsWritten = blitBuffer(base64ToBytes(string), buf, offset, length)\n  return charsWritten\n}\n\nfunction utf16leWrite (buf, string, offset, length) {\n  var charsWritten = blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n  return charsWritten\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Support both (string, offset, length, encoding)\n  // and the legacy (string, encoding, offset, length)\n  if (isFinite(offset)) {\n    if (!isFinite(length)) {\n      encoding = length\n      length = undefined\n    }\n  } else {  // legacy\n    var swap = encoding\n    encoding = offset\n    offset = length\n    length = swap\n  }\n\n  offset = Number(offset) || 0\n\n  if (length < 0 || offset < 0 || offset > this.length) {\n    throw new RangeError('attempt to write outside buffer bounds')\n  }\n\n  var remaining = this.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n  encoding = String(encoding || 'utf8').toLowerCase()\n\n  var ret\n  switch (encoding) {\n    case 'hex':\n      ret = hexWrite(this, string, offset, length)\n      break\n    case 'utf8':\n    case 'utf-8':\n      ret = utf8Write(this, string, offset, length)\n      break\n    case 'ascii':\n      ret = asciiWrite(this, string, offset, length)\n      break\n    case 'binary':\n      ret = binaryWrite(this, string, offset, length)\n      break\n    case 'base64':\n      ret = base64Write(this, string, offset, length)\n      break\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      ret = utf16leWrite(this, string, offset, length)\n      break\n    default:\n      throw new TypeError('Unknown encoding: ' + encoding)\n  }\n  return ret\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  var res = ''\n  var tmp = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    if (buf[i] <= 0x7F) {\n      res += decodeUtf8Char(tmp) + String.fromCharCode(buf[i])\n      tmp = ''\n    } else {\n      tmp += '%' + buf[i].toString(16)\n    }\n  }\n\n  return res + decodeUtf8Char(tmp)\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction binarySlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; i++) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; i++) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = Buffer._augment(this.subarray(start, end))\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; i++) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  if (newBuf.length) newBuf.parent = this.parent || this\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('buffer must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) >>> 0 & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  byteLength = byteLength >>> 0\n  if (!noAssert) checkInt(this, value, offset, byteLength, Math.pow(2, 8 * byteLength), 0)\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) >>> 0 & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = value\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; i++) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = value\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; i++) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = value\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = value\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkInt(\n      this, value, offset, byteLength,\n      Math.pow(2, 8 * byteLength - 1) - 1,\n      -Math.pow(2, 8 * byteLength - 1)\n    )\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = value < 0 ? 1 : 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) {\n    checkInt(\n      this, value, offset, byteLength,\n      Math.pow(2, 8 * byteLength - 1) - 1,\n      -Math.pow(2, 8 * byteLength - 1)\n    )\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = value < 0 ? 1 : 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = value\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = value\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = value\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset >>> 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = value\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (value > max || value < min) throw new RangeError('value is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('index out of range')\n  if (offset < 0) throw new RangeError('index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, target_start, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (target_start >= target.length) target_start = target.length\n  if (!target_start) target_start = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (target_start < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - target_start < end - start) {\n    end = target.length - target_start + start\n  }\n\n  var len = end - start\n\n  if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < len; i++) {\n      target[i + target_start] = this[i + start]\n    }\n  } else {\n    target._set(this.subarray(start, start + len), target_start)\n  }\n\n  return len\n}\n\n// fill(value, start=0, end=buffer.length)\nBuffer.prototype.fill = function fill (value, start, end) {\n  if (!value) value = 0\n  if (!start) start = 0\n  if (!end) end = this.length\n\n  if (end < start) throw new RangeError('end < start')\n\n  // Fill 0 bytes; we're done\n  if (end === start) return\n  if (this.length === 0) return\n\n  if (start < 0 || start >= this.length) throw new RangeError('start out of bounds')\n  if (end < 0 || end > this.length) throw new RangeError('end out of bounds')\n\n  var i\n  if (typeof value === 'number') {\n    for (i = start; i < end; i++) {\n      this[i] = value\n    }\n  } else {\n    var bytes = utf8ToBytes(value.toString())\n    var len = bytes.length\n    for (i = start; i < end; i++) {\n      this[i] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n/**\n * Creates a new `ArrayBuffer` with the *copied* memory of the buffer instance.\n * Added in Node 0.12. Only available in browsers that support ArrayBuffer.\n */\nBuffer.prototype.toArrayBuffer = function toArrayBuffer () {\n  if (typeof Uint8Array !== 'undefined') {\n    if (Buffer.TYPED_ARRAY_SUPPORT) {\n      return (new Buffer(this)).buffer\n    } else {\n      var buf = new Uint8Array(this.length)\n      for (var i = 0, len = buf.length; i < len; i += 1) {\n        buf[i] = this[i]\n      }\n      return buf.buffer\n    }\n  } else {\n    throw new TypeError('Buffer.toArrayBuffer not supported in this browser')\n  }\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar BP = Buffer.prototype\n\n/**\n * Augment a Uint8Array *instance* (not the Uint8Array class!) with Buffer methods\n */\nBuffer._augment = function _augment (arr) {\n  arr.constructor = Buffer\n  arr._isBuffer = true\n\n  // save reference to original Uint8Array set method before overwriting\n  arr._set = arr.set\n\n  // deprecated, will be removed in node 0.13+\n  arr.get = BP.get\n  arr.set = BP.set\n\n  arr.write = BP.write\n  arr.toString = BP.toString\n  arr.toLocaleString = BP.toString\n  arr.toJSON = BP.toJSON\n  arr.equals = BP.equals\n  arr.compare = BP.compare\n  arr.indexOf = BP.indexOf\n  arr.copy = BP.copy\n  arr.slice = BP.slice\n  arr.readUIntLE = BP.readUIntLE\n  arr.readUIntBE = BP.readUIntBE\n  arr.readUInt8 = BP.readUInt8\n  arr.readUInt16LE = BP.readUInt16LE\n  arr.readUInt16BE = BP.readUInt16BE\n  arr.readUInt32LE = BP.readUInt32LE\n  arr.readUInt32BE = BP.readUInt32BE\n  arr.readIntLE = BP.readIntLE\n  arr.readIntBE = BP.readIntBE\n  arr.readInt8 = BP.readInt8\n  arr.readInt16LE = BP.readInt16LE\n  arr.readInt16BE = BP.readInt16BE\n  arr.readInt32LE = BP.readInt32LE\n  arr.readInt32BE = BP.readInt32BE\n  arr.readFloatLE = BP.readFloatLE\n  arr.readFloatBE = BP.readFloatBE\n  arr.readDoubleLE = BP.readDoubleLE\n  arr.readDoubleBE = BP.readDoubleBE\n  arr.writeUInt8 = BP.writeUInt8\n  arr.writeUIntLE = BP.writeUIntLE\n  arr.writeUIntBE = BP.writeUIntBE\n  arr.writeUInt16LE = BP.writeUInt16LE\n  arr.writeUInt16BE = BP.writeUInt16BE\n  arr.writeUInt32LE = BP.writeUInt32LE\n  arr.writeUInt32BE = BP.writeUInt32BE\n  arr.writeIntLE = BP.writeIntLE\n  arr.writeIntBE = BP.writeIntBE\n  arr.writeInt8 = BP.writeInt8\n  arr.writeInt16LE = BP.writeInt16LE\n  arr.writeInt16BE = BP.writeInt16BE\n  arr.writeInt32LE = BP.writeInt32LE\n  arr.writeInt32BE = BP.writeInt32BE\n  arr.writeFloatLE = BP.writeFloatLE\n  arr.writeFloatBE = BP.writeFloatBE\n  arr.writeDoubleLE = BP.writeDoubleLE\n  arr.writeDoubleBE = BP.writeDoubleBE\n  arr.fill = BP.fill\n  arr.inspect = BP.inspect\n  arr.toArrayBuffer = BP.toArrayBuffer\n\n  return arr\n}\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-z\\-]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction isArrayish (subject) {\n  return isArray(subject) || Buffer.isBuffer(subject) ||\n      subject && typeof subject === 'object' &&\n      typeof subject.length === 'number'\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n  var i = 0\n\n  for (; i < length; i++) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (leadSurrogate) {\n        // 2 leads in a row\n        if (codePoint < 0xDC00) {\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          leadSurrogate = codePoint\n          continue\n        } else {\n          // valid surrogate pair\n          codePoint = leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00 | 0x10000\n          leadSurrogate = null\n        }\n      } else {\n        // no lead yet\n\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else {\n          // valid lead\n          leadSurrogate = codePoint\n          continue\n        }\n      }\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n      leadSurrogate = null\n    }\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x200000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; i++) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; i++) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction decodeUtf8Char (str) {\n  try {\n    return decodeURIComponent(str)\n  } catch (err) {\n    return String.fromCharCode(0xFFFD) // UTF 8 invalid char\n  }\n}\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar punycode = require('punycode');\n\nexports.parse = urlParse;\nexports.resolve = urlResolve;\nexports.resolveObject = urlResolveObject;\nexports.format = urlFormat;\n\nexports.Url = Url;\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.host = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.query = null;\n  this.pathname = null;\n  this.path = null;\n  this.href = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = ['<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t'],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = ['{', '}', '|', '\\\\', '^', '`'].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = ['\\''].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = ['%', '/', '?', ';', '#'].concat(autoEscape),\n    hostEndingChars = ['/', '?', '#'],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    unsafeProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    },\n    querystring = require('querystring');\n\nfunction urlParse(url, parseQueryString, slashesDenoteHost) {\n  if (url && isObject(url) && url instanceof Url) return url;\n\n  var u = new Url;\n  u.parse(url, parseQueryString, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, parseQueryString, slashesDenoteHost) {\n  if (!isString(url)) {\n    throw new TypeError(\"Parameter 'url' must be a string, not \" + typeof url);\n  }\n\n  var rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    var lowerProto = proto.toLowerCase();\n    this.protocol = lowerProto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    var slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (var i = 0; i < hostEndingChars.length; i++) {\n      var hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = decodeURIComponent(auth);\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (var i = 0; i < nonHostChars.length; i++) {\n      var hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd))\n        hostEnd = hec;\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1)\n      hostEnd = rest.length;\n\n    this.host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost();\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (var i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) continue;\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = '/' + notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    } else {\n      // hostnames are always lower case.\n      this.hostname = this.hostname.toLowerCase();\n    }\n\n    if (!ipv6Hostname) {\n      // IDNA Support: Returns a puny coded representation of \"domain\".\n      // It only converts the part of the domain name that\n      // has non ASCII characters. I.e. it dosent matter if\n      // you call it with a domain that already is in ASCII.\n      var domainArray = this.hostname.split('.');\n      var newOut = [];\n      for (var i = 0; i < domainArray.length; ++i) {\n        var s = domainArray[i];\n        newOut.push(s.match(/[^A-Za-z0-9_-]/) ?\n            'xn--' + punycode.encode(s) : s);\n      }\n      this.hostname = newOut.join('.');\n    }\n\n    var p = this.port ? ':' + this.port : '';\n    var h = this.hostname || '';\n    this.host = h + p;\n    this.href += this.host;\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n      if (rest[0] !== '/') {\n        rest = '/' + rest;\n      }\n    }\n  }\n\n  // now rest is set to the post-host stuff.\n  // chop off any delim chars.\n  if (!unsafeProtocol[lowerProto]) {\n\n    // First, make 100% sure that any \"autoEscape\" chars get\n    // escaped, even if encodeURIComponent doesn't think they\n    // need to be.\n    for (var i = 0, l = autoEscape.length; i < l; i++) {\n      var ae = autoEscape[i];\n      var esc = encodeURIComponent(ae);\n      if (esc === ae) {\n        esc = escape(ae);\n      }\n      rest = rest.split(ae).join(esc);\n    }\n  }\n\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    this.query = rest.substr(qm + 1);\n    if (parseQueryString) {\n      this.query = querystring.parse(this.query);\n    }\n    rest = rest.slice(0, qm);\n  } else if (parseQueryString) {\n    // no query string, but parseQueryString still requested\n    this.search = '';\n    this.query = {};\n  }\n  if (rest) this.pathname = rest;\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '/';\n  }\n\n  //to support http.request\n  if (this.pathname || this.search) {\n    var p = this.pathname || '';\n    var s = this.search || '';\n    this.path = p + s;\n  }\n\n  // finally, reconstruct the href based on what has been validated.\n  this.href = this.format();\n  return this;\n};\n\n// format a parsed object into a url string\nfunction urlFormat(obj) {\n  // ensure it's an object, and not a string url.\n  // If it's an obj, this is a no-op.\n  // this way, you can call url_format() on strings\n  // to clean up potentially wonky urls.\n  if (isString(obj)) obj = urlParse(obj);\n  if (!(obj instanceof Url)) return Url.prototype.format.call(obj);\n  return obj.format();\n}\n\nUrl.prototype.format = function() {\n  var auth = this.auth || '';\n  if (auth) {\n    auth = encodeURIComponent(auth);\n    auth = auth.replace(/%3A/i, ':');\n    auth += '@';\n  }\n\n  var protocol = this.protocol || '',\n      pathname = this.pathname || '',\n      hash = this.hash || '',\n      host = false,\n      query = '';\n\n  if (this.host) {\n    host = auth + this.host;\n  } else if (this.hostname) {\n    host = auth + (this.hostname.indexOf(':') === -1 ?\n        this.hostname :\n        '[' + this.hostname + ']');\n    if (this.port) {\n      host += ':' + this.port;\n    }\n  }\n\n  if (this.query &&\n      isObject(this.query) &&\n      Object.keys(this.query).length) {\n    query = querystring.stringify(this.query);\n  }\n\n  var search = this.search || (query && ('?' + query)) || '';\n\n  if (protocol && protocol.substr(-1) !== ':') protocol += ':';\n\n  // only the slashedProtocols get the //.  Not mailto:, xmpp:, etc.\n  // unless they had them to begin with.\n  if (this.slashes ||\n      (!protocol || slashedProtocol[protocol]) && host !== false) {\n    host = '//' + (host || '');\n    if (pathname && pathname.charAt(0) !== '/') pathname = '/' + pathname;\n  } else if (!host) {\n    host = '';\n  }\n\n  if (hash && hash.charAt(0) !== '#') hash = '#' + hash;\n  if (search && search.charAt(0) !== '?') search = '?' + search;\n\n  pathname = pathname.replace(/[?#]/g, function(match) {\n    return encodeURIComponent(match);\n  });\n  search = search.replace('#', '%23');\n\n  return protocol + host + pathname + search + hash;\n};\n\nfunction urlResolve(source, relative) {\n  return urlParse(source, false, true).resolve(relative);\n}\n\nUrl.prototype.resolve = function(relative) {\n  return this.resolveObject(urlParse(relative, false, true)).format();\n};\n\nfunction urlResolveObject(source, relative) {\n  if (!source) return relative;\n  return urlParse(source, false, true).resolveObject(relative);\n}\n\nUrl.prototype.resolveObject = function(relative) {\n  if (isString(relative)) {\n    var rel = new Url();\n    rel.parse(relative, false, true);\n    relative = rel;\n  }\n\n  var result = new Url();\n  Object.keys(this).forEach(function(k) {\n    result[k] = this[k];\n  }, this);\n\n  // hash is always overridden, no matter what.\n  // even href=\"\" will remove it.\n  result.hash = relative.hash;\n\n  // if the relative url is empty, then there's nothing left to do here.\n  if (relative.href === '') {\n    result.href = result.format();\n    return result;\n  }\n\n  // hrefs like //foo/bar always cut to the protocol.\n  if (relative.slashes && !relative.protocol) {\n    // take everything except the protocol from relative\n    Object.keys(relative).forEach(function(k) {\n      if (k !== 'protocol')\n        result[k] = relative[k];\n    });\n\n    //urlParse appends trailing / to urls like http://www.example.com\n    if (slashedProtocol[result.protocol] &&\n        result.hostname && !result.pathname) {\n      result.path = result.pathname = '/';\n    }\n\n    result.href = result.format();\n    return result;\n  }\n\n  if (relative.protocol && relative.protocol !== result.protocol) {\n    // if it's a known url protocol, then changing\n    // the protocol does weird things\n    // first, if it's not file:, then we MUST have a host,\n    // and if there was a path\n    // to begin with, then we MUST have a path.\n    // if it is file:, then the host is dropped,\n    // because that's known to be hostless.\n    // anything else is assumed to be absolute.\n    if (!slashedProtocol[relative.protocol]) {\n      Object.keys(relative).forEach(function(k) {\n        result[k] = relative[k];\n      });\n      result.href = result.format();\n      return result;\n    }\n\n    result.protocol = relative.protocol;\n    if (!relative.host && !hostlessProtocol[relative.protocol]) {\n      var relPath = (relative.pathname || '').split('/');\n      while (relPath.length && !(relative.host = relPath.shift()));\n      if (!relative.host) relative.host = '';\n      if (!relative.hostname) relative.hostname = '';\n      if (relPath[0] !== '') relPath.unshift('');\n      if (relPath.length < 2) relPath.unshift('');\n      result.pathname = relPath.join('/');\n    } else {\n      result.pathname = relative.pathname;\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    result.host = relative.host || '';\n    result.auth = relative.auth;\n    result.hostname = relative.hostname || relative.host;\n    result.port = relative.port;\n    // to support http.request\n    if (result.pathname || result.search) {\n      var p = result.pathname || '';\n      var s = result.search || '';\n      result.path = p + s;\n    }\n    result.slashes = result.slashes || relative.slashes;\n    result.href = result.format();\n    return result;\n  }\n\n  var isSourceAbs = (result.pathname && result.pathname.charAt(0) === '/'),\n      isRelAbs = (\n          relative.host ||\n          relative.pathname && relative.pathname.charAt(0) === '/'\n      ),\n      mustEndAbs = (isRelAbs || isSourceAbs ||\n                    (result.host && relative.pathname)),\n      removeAllDots = mustEndAbs,\n      srcPath = result.pathname && result.pathname.split('/') || [],\n      relPath = relative.pathname && relative.pathname.split('/') || [],\n      psychotic = result.protocol && !slashedProtocol[result.protocol];\n\n  // if the url is a non-slashed url, then relative\n  // links like ../.. should be able\n  // to crawl up to the hostname, as well.  This is strange.\n  // result.protocol has already been set by now.\n  // Later on, put the first path part into the host field.\n  if (psychotic) {\n    result.hostname = '';\n    result.port = null;\n    if (result.host) {\n      if (srcPath[0] === '') srcPath[0] = result.host;\n      else srcPath.unshift(result.host);\n    }\n    result.host = '';\n    if (relative.protocol) {\n      relative.hostname = null;\n      relative.port = null;\n      if (relative.host) {\n        if (relPath[0] === '') relPath[0] = relative.host;\n        else relPath.unshift(relative.host);\n      }\n      relative.host = null;\n    }\n    mustEndAbs = mustEndAbs && (relPath[0] === '' || srcPath[0] === '');\n  }\n\n  if (isRelAbs) {\n    // it's absolute.\n    result.host = (relative.host || relative.host === '') ?\n                  relative.host : result.host;\n    result.hostname = (relative.hostname || relative.hostname === '') ?\n                      relative.hostname : result.hostname;\n    result.search = relative.search;\n    result.query = relative.query;\n    srcPath = relPath;\n    // fall through to the dot-handling below.\n  } else if (relPath.length) {\n    // it's relative\n    // throw away the existing file, and take the new path instead.\n    if (!srcPath) srcPath = [];\n    srcPath.pop();\n    srcPath = srcPath.concat(relPath);\n    result.search = relative.search;\n    result.query = relative.query;\n  } else if (!isNullOrUndefined(relative.search)) {\n    // just pull out the search.\n    // like href='?foo'.\n    // Put this after the other two cases because it simplifies the booleans\n    if (psychotic) {\n      result.hostname = result.host = srcPath.shift();\n      //occationaly the auth can get stuck only in host\n      //this especialy happens in cases like\n      //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n      var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                       result.host.split('@') : false;\n      if (authInHost) {\n        result.auth = authInHost.shift();\n        result.host = result.hostname = authInHost.shift();\n      }\n    }\n    result.search = relative.search;\n    result.query = relative.query;\n    //to support http.request\n    if (!isNull(result.pathname) || !isNull(result.search)) {\n      result.path = (result.pathname ? result.pathname : '') +\n                    (result.search ? result.search : '');\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  if (!srcPath.length) {\n    // no path at all.  easy.\n    // we've already handled the other stuff above.\n    result.pathname = null;\n    //to support http.request\n    if (result.search) {\n      result.path = '/' + result.search;\n    } else {\n      result.path = null;\n    }\n    result.href = result.format();\n    return result;\n  }\n\n  // if a url ENDs in . or .., then it must get a trailing slash.\n  // however, if it ends in anything else non-slashy,\n  // then it must NOT get a trailing slash.\n  var last = srcPath.slice(-1)[0];\n  var hasTrailingSlash = (\n      (result.host || relative.host) && (last === '.' || last === '..') ||\n      last === '');\n\n  // strip single dots, resolve double dots to parent dir\n  // if the path tries to go above the root, `up` ends up > 0\n  var up = 0;\n  for (var i = srcPath.length; i >= 0; i--) {\n    last = srcPath[i];\n    if (last == '.') {\n      srcPath.splice(i, 1);\n    } else if (last === '..') {\n      srcPath.splice(i, 1);\n      up++;\n    } else if (up) {\n      srcPath.splice(i, 1);\n      up--;\n    }\n  }\n\n  // if the path is allowed to go above the root, restore leading ..s\n  if (!mustEndAbs && !removeAllDots) {\n    for (; up--; up) {\n      srcPath.unshift('..');\n    }\n  }\n\n  if (mustEndAbs && srcPath[0] !== '' &&\n      (!srcPath[0] || srcPath[0].charAt(0) !== '/')) {\n    srcPath.unshift('');\n  }\n\n  if (hasTrailingSlash && (srcPath.join('/').substr(-1) !== '/')) {\n    srcPath.push('');\n  }\n\n  var isAbsolute = srcPath[0] === '' ||\n      (srcPath[0] && srcPath[0].charAt(0) === '/');\n\n  // put the host back\n  if (psychotic) {\n    result.hostname = result.host = isAbsolute ? '' :\n                                    srcPath.length ? srcPath.shift() : '';\n    //occationaly the auth can get stuck only in host\n    //this especialy happens in cases like\n    //url.resolveObject('mailto:local1@domain1', 'local2@domain2')\n    var authInHost = result.host && result.host.indexOf('@') > 0 ?\n                     result.host.split('@') : false;\n    if (authInHost) {\n      result.auth = authInHost.shift();\n      result.host = result.hostname = authInHost.shift();\n    }\n  }\n\n  mustEndAbs = mustEndAbs || (result.host && srcPath.length);\n\n  if (mustEndAbs && !isAbsolute) {\n    srcPath.unshift('');\n  }\n\n  if (!srcPath.length) {\n    result.pathname = null;\n    result.path = null;\n  } else {\n    result.pathname = srcPath.join('/');\n  }\n\n  //to support request.http\n  if (!isNull(result.pathname) || !isNull(result.search)) {\n    result.path = (result.pathname ? result.pathname : '') +\n                  (result.search ? result.search : '');\n  }\n  result.auth = relative.auth || result.auth;\n  result.slashes = result.slashes || relative.slashes;\n  result.href = result.format();\n  return result;\n};\n\nUrl.prototype.parseHost = function() {\n  var host = this.host;\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) this.hostname = host;\n};\n\nfunction isString(arg) {\n  return typeof arg === \"string\";\n}\n\nfunction isObject(arg) {\n  return typeof arg === 'object' && arg !== null;\n}\n\nfunction isNull(arg) {\n  return arg === null;\n}\nfunction isNullOrUndefined(arg) {\n  return  arg == null;\n}\n","/*! http://mths.be/punycode v1.2.4 by @mathias */\n;(function(root) {\n\n\t/** Detect free variables */\n\tvar freeExports = typeof exports == 'object' && exports;\n\tvar freeModule = typeof module == 'object' && module &&\n\t\tmodule.exports == freeExports && module;\n\tvar freeGlobal = typeof global == 'object' && global;\n\tif (freeGlobal.global === freeGlobal || freeGlobal.window === freeGlobal) {\n\t\troot = freeGlobal;\n\t}\n\n\t/**\n\t * The `punycode` object.\n\t * @name punycode\n\t * @type Object\n\t */\n\tvar punycode,\n\n\t/** Highest positive signed 32-bit float value */\n\tmaxInt = 2147483647, // aka. 0x7FFFFFFF or 2^31-1\n\n\t/** Bootstring parameters */\n\tbase = 36,\n\ttMin = 1,\n\ttMax = 26,\n\tskew = 38,\n\tdamp = 700,\n\tinitialBias = 72,\n\tinitialN = 128, // 0x80\n\tdelimiter = '-', // '\\x2D'\n\n\t/** Regular expressions */\n\tregexPunycode = /^xn--/,\n\tregexNonASCII = /[^ -~]/, // unprintable ASCII chars + non-ASCII chars\n\tregexSeparators = /\\x2E|\\u3002|\\uFF0E|\\uFF61/g, // RFC 3490 separators\n\n\t/** Error messages */\n\terrors = {\n\t\t'overflow': 'Overflow: input needs wider integers to process',\n\t\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t\t'invalid-input': 'Invalid input'\n\t},\n\n\t/** Convenience shortcuts */\n\tbaseMinusTMin = base - tMin,\n\tfloor = Math.floor,\n\tstringFromCharCode = String.fromCharCode,\n\n\t/** Temporary variable */\n\tkey;\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/**\n\t * A generic error utility function.\n\t * @private\n\t * @param {String} type The error type.\n\t * @returns {Error} Throws a `RangeError` with the applicable error message.\n\t */\n\tfunction error(type) {\n\t\tthrow RangeError(errors[type]);\n\t}\n\n\t/**\n\t * A generic `Array#map` utility function.\n\t * @private\n\t * @param {Array} array The array to iterate over.\n\t * @param {Function} callback The function that gets called for every array\n\t * item.\n\t * @returns {Array} A new array of values returned by the callback function.\n\t */\n\tfunction map(array, fn) {\n\t\tvar length = array.length;\n\t\twhile (length--) {\n\t\t\tarray[length] = fn(array[length]);\n\t\t}\n\t\treturn array;\n\t}\n\n\t/**\n\t * A simple `Array#map`-like wrapper to work with domain name strings.\n\t * @private\n\t * @param {String} domain The domain name.\n\t * @param {Function} callback The function that gets called for every\n\t * character.\n\t * @returns {Array} A new string of characters returned by the callback\n\t * function.\n\t */\n\tfunction mapDomain(string, fn) {\n\t\treturn map(string.split(regexSeparators), fn).join('.');\n\t}\n\n\t/**\n\t * Creates an array containing the numeric code points of each Unicode\n\t * character in the string. While JavaScript uses UCS-2 internally,\n\t * this function will convert a pair of surrogate halves (each of which\n\t * UCS-2 exposes as separate characters) into a single code point,\n\t * matching UTF-16.\n\t * @see `punycode.ucs2.encode`\n\t * @see <http://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode.ucs2\n\t * @name decode\n\t * @param {String} string The Unicode input string (UCS-2).\n\t * @returns {Array} The new array of code points.\n\t */\n\tfunction ucs2decode(string) {\n\t\tvar output = [],\n\t\t    counter = 0,\n\t\t    length = string.length,\n\t\t    value,\n\t\t    extra;\n\t\twhile (counter < length) {\n\t\t\tvalue = string.charCodeAt(counter++);\n\t\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t\t// high surrogate, and there is a next character\n\t\t\t\textra = string.charCodeAt(counter++);\n\t\t\t\tif ((extra & 0xFC00) == 0xDC00) { // low surrogate\n\t\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t\t} else {\n\t\t\t\t\t// unmatched surrogate; only append this code unit, in case the next\n\t\t\t\t\t// code unit is the high surrogate of a surrogate pair\n\t\t\t\t\toutput.push(value);\n\t\t\t\t\tcounter--;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\toutput.push(value);\n\t\t\t}\n\t\t}\n\t\treturn output;\n\t}\n\n\t/**\n\t * Creates a string based on an array of numeric code points.\n\t * @see `punycode.ucs2.decode`\n\t * @memberOf punycode.ucs2\n\t * @name encode\n\t * @param {Array} codePoints The array of numeric code points.\n\t * @returns {String} The new Unicode string (UCS-2).\n\t */\n\tfunction ucs2encode(array) {\n\t\treturn map(array, function(value) {\n\t\t\tvar output = '';\n\t\t\tif (value > 0xFFFF) {\n\t\t\t\tvalue -= 0x10000;\n\t\t\t\toutput += stringFromCharCode(value >>> 10 & 0x3FF | 0xD800);\n\t\t\t\tvalue = 0xDC00 | value & 0x3FF;\n\t\t\t}\n\t\t\toutput += stringFromCharCode(value);\n\t\t\treturn output;\n\t\t}).join('');\n\t}\n\n\t/**\n\t * Converts a basic code point into a digit/integer.\n\t * @see `digitToBasic()`\n\t * @private\n\t * @param {Number} codePoint The basic numeric code point value.\n\t * @returns {Number} The numeric value of a basic code point (for use in\n\t * representing integers) in the range `0` to `base - 1`, or `base` if\n\t * the code point does not represent a value.\n\t */\n\tfunction basicToDigit(codePoint) {\n\t\tif (codePoint - 48 < 10) {\n\t\t\treturn codePoint - 22;\n\t\t}\n\t\tif (codePoint - 65 < 26) {\n\t\t\treturn codePoint - 65;\n\t\t}\n\t\tif (codePoint - 97 < 26) {\n\t\t\treturn codePoint - 97;\n\t\t}\n\t\treturn base;\n\t}\n\n\t/**\n\t * Converts a digit/integer into a basic code point.\n\t * @see `basicToDigit()`\n\t * @private\n\t * @param {Number} digit The numeric value of a basic code point.\n\t * @returns {Number} The basic code point whose value (when used for\n\t * representing integers) is `digit`, which needs to be in the range\n\t * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n\t * used; else, the lowercase form is used. The behavior is undefined\n\t * if `flag` is non-zero and `digit` has no uppercase form.\n\t */\n\tfunction digitToBasic(digit, flag) {\n\t\t//  0..25 map to ASCII a..z or A..Z\n\t\t// 26..35 map to ASCII 0..9\n\t\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n\t}\n\n\t/**\n\t * Bias adaptation function as per section 3.4 of RFC 3492.\n\t * http://tools.ietf.org/html/rfc3492#section-3.4\n\t * @private\n\t */\n\tfunction adapt(delta, numPoints, firstTime) {\n\t\tvar k = 0;\n\t\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\t\tdelta += floor(delta / numPoints);\n\t\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\t\tdelta = floor(delta / baseMinusTMin);\n\t\t}\n\t\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n\t}\n\n\t/**\n\t * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The Punycode string of ASCII-only symbols.\n\t * @returns {String} The resulting string of Unicode symbols.\n\t */\n\tfunction decode(input) {\n\t\t// Don't use UCS-2\n\t\tvar output = [],\n\t\t    inputLength = input.length,\n\t\t    out,\n\t\t    i = 0,\n\t\t    n = initialN,\n\t\t    bias = initialBias,\n\t\t    basic,\n\t\t    j,\n\t\t    index,\n\t\t    oldi,\n\t\t    w,\n\t\t    k,\n\t\t    digit,\n\t\t    t,\n\t\t    /** Cached calculation results */\n\t\t    baseMinusT;\n\n\t\t// Handle the basic code points: let `basic` be the number of input code\n\t\t// points before the last delimiter, or `0` if there is none, then copy\n\t\t// the first basic code points to the output.\n\n\t\tbasic = input.lastIndexOf(delimiter);\n\t\tif (basic < 0) {\n\t\t\tbasic = 0;\n\t\t}\n\n\t\tfor (j = 0; j < basic; ++j) {\n\t\t\t// if it's not a basic code point\n\t\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\t\terror('not-basic');\n\t\t\t}\n\t\t\toutput.push(input.charCodeAt(j));\n\t\t}\n\n\t\t// Main decoding loop: start just after the last delimiter if any basic code\n\t\t// points were copied; start at the beginning otherwise.\n\n\t\tfor (index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t\t// `index` is the index of the next character to be consumed.\n\t\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t\t// which gets added to `i`. The overflow checking is easier\n\t\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t\t// value at the end to obtain `delta`.\n\t\t\tfor (oldi = i, w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\t\tif (index >= inputLength) {\n\t\t\t\t\terror('invalid-input');\n\t\t\t\t}\n\n\t\t\t\tdigit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\ti += digit * w;\n\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\t\tif (digit < t) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tbaseMinusT = base - t;\n\t\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tw *= baseMinusT;\n\n\t\t\t}\n\n\t\t\tout = output.length + 1;\n\t\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t\t// incrementing `n` each time, so we'll fix that now:\n\t\t\tif (floor(i / out) > maxInt - n) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tn += floor(i / out);\n\t\t\ti %= out;\n\n\t\t\t// Insert `n` at position `i` of the output\n\t\t\toutput.splice(i++, 0, n);\n\n\t\t}\n\n\t\treturn ucs2encode(output);\n\t}\n\n\t/**\n\t * Converts a string of Unicode symbols to a Punycode string of ASCII-only\n\t * symbols.\n\t * @memberOf punycode\n\t * @param {String} input The string of Unicode symbols.\n\t * @returns {String} The resulting Punycode string of ASCII-only symbols.\n\t */\n\tfunction encode(input) {\n\t\tvar n,\n\t\t    delta,\n\t\t    handledCPCount,\n\t\t    basicLength,\n\t\t    bias,\n\t\t    j,\n\t\t    m,\n\t\t    q,\n\t\t    k,\n\t\t    t,\n\t\t    currentValue,\n\t\t    output = [],\n\t\t    /** `inputLength` will hold the number of code points in `input`. */\n\t\t    inputLength,\n\t\t    /** Cached calculation results */\n\t\t    handledCPCountPlusOne,\n\t\t    baseMinusT,\n\t\t    qMinusT;\n\n\t\t// Convert the input in UCS-2 to Unicode\n\t\tinput = ucs2decode(input);\n\n\t\t// Cache the length\n\t\tinputLength = input.length;\n\n\t\t// Initialize the state\n\t\tn = initialN;\n\t\tdelta = 0;\n\t\tbias = initialBias;\n\n\t\t// Handle the basic code points\n\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\tcurrentValue = input[j];\n\t\t\tif (currentValue < 0x80) {\n\t\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t\t}\n\t\t}\n\n\t\thandledCPCount = basicLength = output.length;\n\n\t\t// `handledCPCount` is the number of code points that have been handled;\n\t\t// `basicLength` is the number of basic code points.\n\n\t\t// Finish the basic string - if it is not empty - with a delimiter\n\t\tif (basicLength) {\n\t\t\toutput.push(delimiter);\n\t\t}\n\n\t\t// Main encoding loop:\n\t\twhile (handledCPCount < inputLength) {\n\n\t\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t\t// larger one:\n\t\t\tfor (m = maxInt, j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\t\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\t\tm = currentValue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t\t// but guard against overflow\n\t\t\thandledCPCountPlusOne = handledCPCount + 1;\n\t\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\t\tn = m;\n\n\t\t\tfor (j = 0; j < inputLength; ++j) {\n\t\t\t\tcurrentValue = input[j];\n\n\t\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\t\terror('overflow');\n\t\t\t\t}\n\n\t\t\t\tif (currentValue == n) {\n\t\t\t\t\t// Represent delta as a generalized variable-length integer\n\t\t\t\t\tfor (q = delta, k = base; /* no condition */; k += base) {\n\t\t\t\t\t\tt = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tqMinusT = q - t;\n\t\t\t\t\t\tbaseMinusT = base - t;\n\t\t\t\t\t\toutput.push(\n\t\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t\t);\n\t\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t\t}\n\n\t\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\t\tdelta = 0;\n\t\t\t\t\t++handledCPCount;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t++delta;\n\t\t\t++n;\n\n\t\t}\n\t\treturn output.join('');\n\t}\n\n\t/**\n\t * Converts a Punycode string representing a domain name to Unicode. Only the\n\t * Punycoded parts of the domain name will be converted, i.e. it doesn't\n\t * matter if you call it on a string that has already been converted to\n\t * Unicode.\n\t * @memberOf punycode\n\t * @param {String} domain The Punycode domain name to convert to Unicode.\n\t * @returns {String} The Unicode representation of the given Punycode\n\t * string.\n\t */\n\tfunction toUnicode(domain) {\n\t\treturn mapDomain(domain, function(string) {\n\t\t\treturn regexPunycode.test(string)\n\t\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/**\n\t * Converts a Unicode string representing a domain name to Punycode. Only the\n\t * non-ASCII parts of the domain name will be converted, i.e. it doesn't\n\t * matter if you call it with a domain that's already in ASCII.\n\t * @memberOf punycode\n\t * @param {String} domain The domain name to convert, as a Unicode string.\n\t * @returns {String} The Punycode representation of the given domain name.\n\t */\n\tfunction toASCII(domain) {\n\t\treturn mapDomain(domain, function(string) {\n\t\t\treturn regexNonASCII.test(string)\n\t\t\t\t? 'xn--' + encode(string)\n\t\t\t\t: string;\n\t\t});\n\t}\n\n\t/*--------------------------------------------------------------------------*/\n\n\t/** Define the public API */\n\tpunycode = {\n\t\t/**\n\t\t * A string representing the current Punycode.js version number.\n\t\t * @memberOf punycode\n\t\t * @type String\n\t\t */\n\t\t'version': '1.2.4',\n\t\t/**\n\t\t * An object of methods to convert from JavaScript's internal character\n\t\t * representation (UCS-2) to Unicode code points, and back.\n\t\t * @see <http://mathiasbynens.be/notes/javascript-encoding>\n\t\t * @memberOf punycode\n\t\t * @type Object\n\t\t */\n\t\t'ucs2': {\n\t\t\t'decode': ucs2decode,\n\t\t\t'encode': ucs2encode\n\t\t},\n\t\t'decode': decode,\n\t\t'encode': encode,\n\t\t'toASCII': toASCII,\n\t\t'toUnicode': toUnicode\n\t};\n\n\t/** Expose `punycode` */\n\t// Some AMD build optimizers, like r.js, check for specific condition patterns\n\t// like the following:\n\tif (\n\t\ttypeof define == 'function' &&\n\t\ttypeof define.amd == 'object' &&\n\t\tdefine.amd\n\t) {\n\t\tdefine('punycode', function() {\n\t\t\treturn punycode;\n\t\t});\n\t} else if (freeExports && !freeExports.nodeType) {\n\t\tif (freeModule) { // in Node.js or RingoJS v0.8.0+\n\t\t\tfreeModule.exports = punycode;\n\t\t} else { // in Narwhal or RingoJS v0.7.0-\n\t\t\tfor (key in punycode) {\n\t\t\t\tpunycode.hasOwnProperty(key) && (freeExports[key] = punycode[key]);\n\t\t\t}\n\t\t}\n\t} else { // in Rhino or a web browser\n\t\troot.punycode = punycode;\n\t}\n\n}(this));\n","'use strict';\n\nexports.decode = exports.parse = require('./decode');\nexports.encode = exports.stringify = require('./encode');\n","\n/**\n * isArray\n */\n\nvar isArray = Array.isArray;\n\n/**\n * toString\n */\n\nvar str = Object.prototype.toString;\n\n/**\n * Whether or not the given `val`\n * is an array.\n *\n * example:\n *\n *        isArray([]);\n *        // > true\n *        isArray(arguments);\n *        // > false\n *        isArray('');\n *        // > false\n *\n * @param {mixed} val\n * @return {bool}\n */\n\nmodule.exports = isArray || function (val) {\n  return !! val && '[object Array]' == str.call(val);\n};\n","exports.read = function(buffer, offset, isLE, mLen, nBytes) {\n  var e, m,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      nBits = -7,\n      i = isLE ? (nBytes - 1) : 0,\n      d = isLE ? -1 : 1,\n      s = buffer[offset + i];\n\n  i += d;\n\n  e = s & ((1 << (-nBits)) - 1);\n  s >>= (-nBits);\n  nBits += eLen;\n  for (; nBits > 0; e = e * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  m = e & ((1 << (-nBits)) - 1);\n  e >>= (-nBits);\n  nBits += mLen;\n  for (; nBits > 0; m = m * 256 + buffer[offset + i], i += d, nBits -= 8);\n\n  if (e === 0) {\n    e = 1 - eBias;\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity);\n  } else {\n    m = m + Math.pow(2, mLen);\n    e = e - eBias;\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n};\n\nexports.write = function(buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c,\n      eLen = nBytes * 8 - mLen - 1,\n      eMax = (1 << eLen) - 1,\n      eBias = eMax >> 1,\n      rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0),\n      i = isLE ? 0 : (nBytes - 1),\n      d = isLE ? 1 : -1,\n      s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0;\n\n  value = Math.abs(value);\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0;\n    e = eMax;\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2);\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--;\n      c *= 2;\n    }\n    if (e + eBias >= 1) {\n      value += rt / c;\n    } else {\n      value += rt * Math.pow(2, 1 - eBias);\n    }\n    if (value * c >= 2) {\n      e++;\n      c /= 2;\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0;\n      e = eMax;\n    } else if (e + eBias >= 1) {\n      m = (value * c - 1) * Math.pow(2, mLen);\n      e = e + eBias;\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n      e = 0;\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8);\n\n  e = (e << mLen) | m;\n  eLen += mLen;\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8);\n\n  buffer[offset + i - d] |= s * 128;\n};\n","/*\nCopyright (c) 2014, Yahoo! Inc. All rights reserved.\nCopyrights licensed under the New BSD License.\nSee the accompanying LICENSE file for terms.\n*/\n\n'use strict';\n\nexports.match = matchQuery;\nexports.parse = parseQuery;\n\n// -----------------------------------------------------------------------------\n\nvar RE_MEDIA_QUERY     = /(?:(only|not)?\\s*([^\\s\\(\\)]+)(?:\\s*and)?\\s*)?(.+)?/i,\n    RE_MQ_EXPRESSION   = /\\(\\s*([^\\s\\:\\)]+)\\s*(?:\\:\\s*([^\\s\\)]+))?\\s*\\)/,\n    RE_MQ_FEATURE      = /^(?:(min|max)-)?(.+)/,\n    RE_LENGTH_UNIT     = /(em|rem|px|cm|mm|in|pt|pc)?$/,\n    RE_RESOLUTION_UNIT = /(dpi|dpcm|dppx)?$/;\n\nfunction matchQuery(mediaQuery, values) {\n    return parseQuery(mediaQuery).some(function (query) {\n        var inverse = query.inverse;\n\n        // Either the parsed or specified `type` is \"all\", or the types must be\n        // equal for a match.\n        var typeMatch = query.type === 'all' || values.type === query.type;\n\n        // Quit early when `type` doesn't match, but take \"not\" into account.\n        if ((typeMatch && inverse) || !(typeMatch || inverse)) {\n            return false;\n        }\n\n        var expressionsMatch = query.expressions.every(function (expression) {\n            var feature  = expression.feature,\n                modifier = expression.modifier,\n                expValue = expression.value,\n                value    = values[feature];\n\n            // Missing or falsy values don't match.\n            if (!value) { return false; }\n\n            switch (feature) {\n                case 'orientation':\n                case 'scan':\n                    return value.toLowerCase() === expValue.toLowerCase();\n\n                case 'width':\n                case 'height':\n                case 'device-width':\n                case 'device-height':\n                    expValue = toPx(expValue);\n                    value    = toPx(value);\n                    break;\n\n                case 'resolution':\n                    expValue = toDpi(expValue);\n                    value    = toDpi(value);\n                    break;\n\n                case 'aspect-ratio':\n                case 'device-aspect-ratio':\n                case /* Deprecated */ 'device-pixel-ratio':\n                    expValue = toDecimal(expValue);\n                    value    = toDecimal(value);\n                    break;\n\n                case 'grid':\n                case 'color':\n                case 'color-index':\n                case 'monochrome':\n                    expValue = parseInt(expValue, 10) || 1;\n                    value    = parseInt(value, 10) || 0;\n                    break;\n            }\n\n            switch (modifier) {\n                case 'min': return value >= expValue;\n                case 'max': return value <= expValue;\n                default   : return value === expValue;\n            }\n        });\n\n        return (expressionsMatch && !inverse) || (!expressionsMatch && inverse);\n    });\n}\n\nfunction parseQuery(mediaQuery) {\n    return mediaQuery.split(',').map(function (query) {\n        query = query.trim();\n\n        var captures    = query.match(RE_MEDIA_QUERY),\n            modifier    = captures[1],\n            type        = captures[2],\n            expressions = captures[3] || '',\n            parsed      = {};\n\n        parsed.inverse = !!modifier && modifier.toLowerCase() === 'not';\n        parsed.type    = type ? type.toLowerCase() : 'all';\n\n        // Split expressions into a list.\n        expressions = expressions.match(/\\([^\\)]+\\)/g) || [];\n\n        parsed.expressions = expressions.map(function (expression) {\n            var captures = expression.match(RE_MQ_EXPRESSION),\n                feature  = captures[1].toLowerCase().match(RE_MQ_FEATURE);\n\n            return {\n                modifier: feature[1],\n                feature : feature[2],\n                value   : captures[2]\n            };\n        });\n\n        return parsed;\n    });\n}\n\n// -- Utilities ----------------------------------------------------------------\n\nfunction toDecimal(ratio) {\n    var decimal = Number(ratio),\n        numbers;\n\n    if (!decimal) {\n        numbers = ratio.match(/^(\\d+)\\s*\\/\\s*(\\d+)$/);\n        decimal = numbers[1] / numbers[2];\n    }\n\n    return decimal;\n}\n\nfunction toDpi(resolution) {\n    var value = parseFloat(resolution),\n        units = String(resolution).match(RE_RESOLUTION_UNIT)[1];\n\n    switch (units) {\n        case 'dpcm': return value / 2.54;\n        case 'dppx': return value * 96;\n        default    : return value;\n    }\n}\n\nfunction toPx(length) {\n    var value = parseFloat(length),\n        units = String(length).match(RE_LENGTH_UNIT)[1];\n\n    switch (units) {\n        case 'em' : return value * 16;\n        case 'rem': return value * 16;\n        case 'cm' : return value * 96 / 2.54;\n        case 'mm' : return value * 96 / 2.54 / 10;\n        case 'in' : return value * 96;\n        case 'pt' : return value * 72;\n        case 'pc' : return value * 72 / 12;\n        default   : return value;\n    }\n}\n","var lookup = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/';\n\n;(function (exports) {\n\t'use strict';\n\n  var Arr = (typeof Uint8Array !== 'undefined')\n    ? Uint8Array\n    : Array\n\n\tvar PLUS   = '+'.charCodeAt(0)\n\tvar SLASH  = '/'.charCodeAt(0)\n\tvar NUMBER = '0'.charCodeAt(0)\n\tvar LOWER  = 'a'.charCodeAt(0)\n\tvar UPPER  = 'A'.charCodeAt(0)\n\tvar PLUS_URL_SAFE = '-'.charCodeAt(0)\n\tvar SLASH_URL_SAFE = '_'.charCodeAt(0)\n\n\tfunction decode (elt) {\n\t\tvar code = elt.charCodeAt(0)\n\t\tif (code === PLUS ||\n\t\t    code === PLUS_URL_SAFE)\n\t\t\treturn 62 // '+'\n\t\tif (code === SLASH ||\n\t\t    code === SLASH_URL_SAFE)\n\t\t\treturn 63 // '/'\n\t\tif (code < NUMBER)\n\t\t\treturn -1 //no match\n\t\tif (code < NUMBER + 10)\n\t\t\treturn code - NUMBER + 26 + 26\n\t\tif (code < UPPER + 26)\n\t\t\treturn code - UPPER\n\t\tif (code < LOWER + 26)\n\t\t\treturn code - LOWER + 26\n\t}\n\n\tfunction b64ToByteArray (b64) {\n\t\tvar i, j, l, tmp, placeHolders, arr\n\n\t\tif (b64.length % 4 > 0) {\n\t\t\tthrow new Error('Invalid string. Length must be a multiple of 4')\n\t\t}\n\n\t\t// the number of equal signs (place holders)\n\t\t// if there are two placeholders, than the two characters before it\n\t\t// represent one byte\n\t\t// if there is only one, then the three characters before it represent 2 bytes\n\t\t// this is just a cheap hack to not do indexOf twice\n\t\tvar len = b64.length\n\t\tplaceHolders = '=' === b64.charAt(len - 2) ? 2 : '=' === b64.charAt(len - 1) ? 1 : 0\n\n\t\t// base64 is 4/3 + up to two characters of the original data\n\t\tarr = new Arr(b64.length * 3 / 4 - placeHolders)\n\n\t\t// if there are placeholders, only get up to the last complete 4 chars\n\t\tl = placeHolders > 0 ? b64.length - 4 : b64.length\n\n\t\tvar L = 0\n\n\t\tfunction push (v) {\n\t\t\tarr[L++] = v\n\t\t}\n\n\t\tfor (i = 0, j = 0; i < l; i += 4, j += 3) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 18) | (decode(b64.charAt(i + 1)) << 12) | (decode(b64.charAt(i + 2)) << 6) | decode(b64.charAt(i + 3))\n\t\t\tpush((tmp & 0xFF0000) >> 16)\n\t\t\tpush((tmp & 0xFF00) >> 8)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\tif (placeHolders === 2) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 2) | (decode(b64.charAt(i + 1)) >> 4)\n\t\t\tpush(tmp & 0xFF)\n\t\t} else if (placeHolders === 1) {\n\t\t\ttmp = (decode(b64.charAt(i)) << 10) | (decode(b64.charAt(i + 1)) << 4) | (decode(b64.charAt(i + 2)) >> 2)\n\t\t\tpush((tmp >> 8) & 0xFF)\n\t\t\tpush(tmp & 0xFF)\n\t\t}\n\n\t\treturn arr\n\t}\n\n\tfunction uint8ToBase64 (uint8) {\n\t\tvar i,\n\t\t\textraBytes = uint8.length % 3, // if we have 1 byte left, pad 2 bytes\n\t\t\toutput = \"\",\n\t\t\ttemp, length\n\n\t\tfunction encode (num) {\n\t\t\treturn lookup.charAt(num)\n\t\t}\n\n\t\tfunction tripletToBase64 (num) {\n\t\t\treturn encode(num >> 18 & 0x3F) + encode(num >> 12 & 0x3F) + encode(num >> 6 & 0x3F) + encode(num & 0x3F)\n\t\t}\n\n\t\t// go through the array every three bytes, we'll deal with trailing stuff later\n\t\tfor (i = 0, length = uint8.length - extraBytes; i < length; i += 3) {\n\t\t\ttemp = (uint8[i] << 16) + (uint8[i + 1] << 8) + (uint8[i + 2])\n\t\t\toutput += tripletToBase64(temp)\n\t\t}\n\n\t\t// pad the end with zeros, but make sure to not forget the extra bytes\n\t\tswitch (extraBytes) {\n\t\t\tcase 1:\n\t\t\t\ttemp = uint8[uint8.length - 1]\n\t\t\t\toutput += encode(temp >> 2)\n\t\t\t\toutput += encode((temp << 4) & 0x3F)\n\t\t\t\toutput += '=='\n\t\t\t\tbreak\n\t\t\tcase 2:\n\t\t\t\ttemp = (uint8[uint8.length - 2] << 8) + (uint8[uint8.length - 1])\n\t\t\t\toutput += encode(temp >> 10)\n\t\t\t\toutput += encode((temp >> 4) & 0x3F)\n\t\t\t\toutput += encode((temp << 2) & 0x3F)\n\t\t\t\toutput += '='\n\t\t\t\tbreak\n\t\t}\n\n\t\treturn output\n\t}\n\n\texports.toByteArray = b64ToByteArray\n\texports.fromByteArray = uint8ToBase64\n}(typeof exports === 'undefined' ? (this.base64js = {}) : exports))\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n// If obj.hasOwnProperty has been overridden, then calling\n// obj.hasOwnProperty(prop) will break.\n// See: https://github.com/joyent/node/issues/1707\nfunction hasOwnProperty(obj, prop) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}\n\nmodule.exports = function(qs, sep, eq, options) {\n  sep = sep || '&';\n  eq = eq || '=';\n  var obj = {};\n\n  if (typeof qs !== 'string' || qs.length === 0) {\n    return obj;\n  }\n\n  var regexp = /\\+/g;\n  qs = qs.split(sep);\n\n  var maxKeys = 1000;\n  if (options && typeof options.maxKeys === 'number') {\n    maxKeys = options.maxKeys;\n  }\n\n  var len = qs.length;\n  // maxKeys <= 0 means that we should not limit keys count\n  if (maxKeys > 0 && len > maxKeys) {\n    len = maxKeys;\n  }\n\n  for (var i = 0; i < len; ++i) {\n    var x = qs[i].replace(regexp, '%20'),\n        idx = x.indexOf(eq),\n        kstr, vstr, k, v;\n\n    if (idx >= 0) {\n      kstr = x.substr(0, idx);\n      vstr = x.substr(idx + 1);\n    } else {\n      kstr = x;\n      vstr = '';\n    }\n\n    k = decodeURIComponent(kstr);\n    v = decodeURIComponent(vstr);\n\n    if (!hasOwnProperty(obj, k)) {\n      obj[k] = v;\n    } else if (isArray(obj[k])) {\n      obj[k].push(v);\n    } else {\n      obj[k] = [obj[k], v];\n    }\n  }\n\n  return obj;\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\nvar stringifyPrimitive = function(v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nmodule.exports = function(obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return map(objectKeys(obj), function(k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n      if (isArray(obj[k])) {\n        return map(obj[k], function(v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).join(sep);\n\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq +\n         encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar isArray = Array.isArray || function (xs) {\n  return Object.prototype.toString.call(xs) === '[object Array]';\n};\n\nfunction map (xs, f) {\n  if (xs.map) return xs.map(f);\n  var res = [];\n  for (var i = 0; i < xs.length; i++) {\n    res.push(f(xs[i], i));\n  }\n  return res;\n}\n\nvar objectKeys = Object.keys || function (obj) {\n  var res = [];\n  for (var key in obj) {\n    if (Object.prototype.hasOwnProperty.call(obj, key)) res.push(key);\n  }\n  return res;\n};\n","\"use strict\";\n\nvar util = require('./util'),\n    inlineImage = require('./inlineImage'),\n    inlineScript = require('./inlineScript'),\n    inlineCss = require('./inlineCss'),\n    cssSupport = require('./cssSupport');\n\n\nvar getUrlBasePath = function (url) {\n    return util.joinUrl(url, '.');\n};\n\nvar parameterHashFunction = function (params) {\n    // HACK JSON.stringify is poor man's hashing;\n    // same objects might not receive same result as key order is not guaranteed\n    var a = params.map(function (param, idx) {\n        // Only include options relevant for method\n        if (idx === (params.length - 1)) {\n            param = {\n                // Two different HTML pages on the same path level have the same base path, but a different URL\n                baseUrl: getUrlBasePath(param.baseUrl)\n            };\n        }\n        return JSON.stringify(param);\n    });\n    return a;\n};\n\nvar memoizeFunctionOnCaching = function (func, options) {\n    if ((options.cache !== false && options.cache !== 'none') && options.cacheBucket) {\n        return util.memoize(func, parameterHashFunction, options.cacheBucket);\n    } else {\n        return func;\n    }\n};\n\n/* Style inlining */\n\nvar requestExternalsForStylesheet = function (styleContent, alreadyLoadedCssUrls, options) {\n    var cssRules = cssSupport.rulesForCssText(styleContent);\n\n    return inlineCss.loadCSSImportsForRules(cssRules, alreadyLoadedCssUrls, options).then(function (cssImportResult) {\n        return inlineCss.loadAndInlineCSSResourcesForRules(cssRules, options).then(function (cssResourcesResult) {\n            var errors = cssImportResult.errors.concat(cssResourcesResult.errors),\n                hasChanges = cssImportResult.hasChanges || cssResourcesResult.hasChanges;\n\n            if (hasChanges) {\n                styleContent = cssSupport.cssRulesToText(cssRules);\n            }\n\n            return {\n                hasChanges: hasChanges,\n                content: styleContent,\n                errors: errors\n            };\n        });\n    });\n};\n\nvar loadAndInlineCssForStyle = function (style, options, alreadyLoadedCssUrls) {\n    var styleContent = style.textContent,\n        processExternals = memoizeFunctionOnCaching(requestExternalsForStylesheet, options);\n\n    return processExternals(styleContent, alreadyLoadedCssUrls, options).then(function (result) {\n        if (result.hasChanges) {\n            style.childNodes[0].nodeValue = result.content;\n        }\n\n        return util.cloneArray(result.errors);\n    });\n};\n\nvar getCssStyleElements = function (doc) {\n    var styles = doc.getElementsByTagName(\"style\");\n\n    return Array.prototype.filter.call(styles, function (style) {\n        return !style.attributes.type || style.attributes.type.nodeValue === \"text/css\";\n    });\n};\n\nexports.loadAndInlineStyles = function (doc, options) {\n    var styles = getCssStyleElements(doc),\n        allErrors = [],\n        alreadyLoadedCssUrls = [],\n        inlineOptions;\n\n    inlineOptions = util.clone(options);\n    inlineOptions.baseUrl = inlineOptions.baseUrl || util.getDocumentBaseUrl(doc);\n\n    return util.all(styles.map(function (style) {\n        return loadAndInlineCssForStyle(style, inlineOptions, alreadyLoadedCssUrls).then(function (errors) {\n            allErrors = allErrors.concat(errors);\n        });\n    })).then(function () {\n        return allErrors;\n    });\n};\n\n/* CSS link inlining */\n\nvar substituteLinkWithInlineStyle = function (oldLinkNode, styleContent) {\n    var parent = oldLinkNode.parentNode,\n        styleNode;\n\n    styleContent = styleContent.trim();\n    if (styleContent) {\n        styleNode = oldLinkNode.ownerDocument.createElement(\"style\");\n        styleNode.type = \"text/css\";\n        styleNode.appendChild(oldLinkNode.ownerDocument.createTextNode(styleContent));\n\n        parent.insertBefore(styleNode, oldLinkNode);\n    }\n\n    parent.removeChild(oldLinkNode);\n};\n\nvar requestStylesheetAndInlineResources = function (url, options) {\n    return util.ajax(url, options)\n        .then(function (content) {\n            var cssRules = cssSupport.rulesForCssText(content);\n\n            return {\n                content: content,\n                cssRules: cssRules\n            };\n        })\n        .then(function (result) {\n            var hasChangesFromPathAdjustment = inlineCss.adjustPathsOfCssResources(url, result.cssRules);\n\n            return {\n                content: result.content,\n                cssRules: result.cssRules,\n                hasChanges: hasChangesFromPathAdjustment\n            };\n        })\n        .then(function (result) {\n            return inlineCss.loadCSSImportsForRules(result.cssRules, [], options)\n                .then(function (cssImportResult) {\n                    return {\n                        content: result.content,\n                        cssRules: result.cssRules,\n                        hasChanges: result.hasChanges || cssImportResult.hasChanges,\n                        errors: cssImportResult.errors\n                    };\n                });\n        })\n        .then(function (result) {\n            return inlineCss.loadAndInlineCSSResourcesForRules(result.cssRules, options)\n                .then(function (cssResourcesResult) {\n                    return {\n                        content: result.content,\n                        cssRules: result.cssRules,\n                        hasChanges: result.hasChanges || cssResourcesResult.hasChanges,\n                        errors: result.errors.concat(cssResourcesResult.errors)\n                    };\n                });\n        })\n        .then(function (result) {\n            var content = result.content;\n            if (result.hasChanges) {\n                content = cssSupport.cssRulesToText(result.cssRules);\n            }\n            return {\n                content: content,\n                errors: result.errors\n            };\n        });\n};\n\nvar loadLinkedCSS = function (link, options) {\n    var cssHref = link.attributes.href.nodeValue,\n        documentBaseUrl = util.getDocumentBaseUrl(link.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBaseUrl) {\n        ajaxOptions.baseUrl = documentBaseUrl;\n    }\n\n    var processStylesheet = memoizeFunctionOnCaching(requestStylesheetAndInlineResources, options);\n\n    return processStylesheet(cssHref, ajaxOptions).then(function (result) {\n        return {\n            content: result.content,\n            errors: util.cloneArray(result.errors)\n        };\n    });\n};\n\nvar getCssStylesheetLinks = function (doc) {\n    var links = doc.getElementsByTagName(\"link\");\n\n    return Array.prototype.filter.call(links, function (link) {\n        return link.attributes.rel && link.attributes.rel.nodeValue === \"stylesheet\" &&\n            (!link.attributes.type || link.attributes.type.nodeValue === \"text/css\");\n    });\n};\n\nexports.loadAndInlineCssLinks = function (doc, options) {\n    var links = getCssStylesheetLinks(doc),\n        errors = [];\n\n    return util.all(links.map(function (link) {\n        return loadLinkedCSS(link, options).then(function(result) {\n            substituteLinkWithInlineStyle(link, result.content + \"\\n\");\n\n            errors = errors.concat(result.errors);\n        }, function (e) {\n            errors.push({\n                resourceType: \"stylesheet\",\n                url: e.url,\n                msg: \"Unable to load stylesheet \" + e.url\n            });\n        });\n    })).then(function () {\n        return errors;\n    });\n};\n\n/* Main */\n\nexports.loadAndInlineImages = inlineImage.inline;\nexports.loadAndInlineScript = inlineScript.inline;\n\nexports.inlineReferences = function (doc, options) {\n    var allErrors = [],\n        inlineFuncs = [\n            exports.loadAndInlineImages,\n            exports.loadAndInlineStyles,\n            exports.loadAndInlineCssLinks];\n\n    if (options.inlineScripts !== false) {\n        inlineFuncs.push(exports.loadAndInlineScript);\n    }\n\n    return util.all(inlineFuncs.map(function (func) {\n        return func(doc, options)\n            .then(function (errors) {\n                allErrors = allErrors.concat(errors);\n            });\n    })).then(function () {\n        return allErrors;\n    });\n};\n","var removeInvalidCharacters = function (content) {\n    // See http://www.w3.org/TR/xml/#NT-Char for valid XML 1.0 characters\n    return content.replace(/[\\x00-\\x08\\x0B\\x0C\\x0E-\\x1F]/g, '');\n};\n\nvar serializeAttributeValue = function (value) {\n    return value\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&apos;');\n};\n\nvar serializeTextContent = function (content) {\n    return content\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;');\n};\n\nvar serializeAttribute = function (attr) {\n    var value = attr.value;\n\n    return ' ' + attr.name + '=\"' + serializeAttributeValue(value) + '\"';\n};\n\nvar getTagName = function (node) {\n    var tagName = node.tagName;\n\n    // Aid in serializing of original HTML documents\n    if (node.namespaceURI === 'http://www.w3.org/1999/xhtml') {\n        tagName = tagName.toLowerCase();\n    }\n    return tagName;\n};\n\nvar serializeNamespace = function (node) {\n    var nodeHasXmlnsAttr = Array.prototype.map.call(node.attributes || node.attrs, function (attr) {\n            return attr.name;\n        })\n        .indexOf('xmlns') >= 0;\n    // Serialize the namespace as an xmlns attribute whenever the element\n    // doesn't already have one and the inherited namespace does not match\n    // the element's namespace.\n    // As a special case, always include an xmlns for html elements, in case\n    // of broken namespaceURI handling by browsers.\n    if (!nodeHasXmlnsAttr &&\n            (!node.parentNode ||\n             node.namespaceURI !== node.parentNode.namespaceURI ||\n             getTagName(node) === 'html')) {\n         return ' xmlns=\"' + node.namespaceURI + '\"';\n    } else {\n        return '';\n    }\n};\n\nvar serializeChildren = function (node) {\n    return Array.prototype.map.call(node.childNodes, function (childNode) {\n        return nodeTreeToXHTML(childNode);\n    }).join('');\n};\n\nvar serializeTag = function (node) {\n    var output = '<' + getTagName(node);\n    output += serializeNamespace(node);\n\n    Array.prototype.forEach.call(node.attributes || node.attrs, function (attr) {\n        output += serializeAttribute(attr);\n    });\n\n    if (node.childNodes.length > 0) {\n        output += '>';\n        output += serializeChildren(node);\n        output += '</' + getTagName(node) + '>';\n    } else {\n        output += '/>';\n    }\n    return output;\n};\n\nvar serializeText = function (node) {\n    var text = node.nodeValue || node.value || '';\n    return serializeTextContent(text);\n};\n\nvar serializeComment = function (node) {\n    return '<!--' +\n        node.data\n            .replace(/-/g, '&#45;') +\n        '-->';\n};\n\nvar serializeCDATA = function (node) {\n    return '<![CDATA[' + node.nodeValue + ']]>';\n};\n\nvar nodeTreeToXHTML = function (node) {\n    if (node.nodeName === '#document' ||\n        node.nodeName === '#document-fragment') {\n        return serializeChildren(node);\n    } else {\n        if (node.tagName) {\n            return serializeTag(node);\n        } else if (node.nodeName === '#text') {\n            return serializeText(node);\n        } else if (node.nodeName === '#comment') {\n            return serializeComment(node);\n        } else if (node.nodeName === '#cdata-section') {\n            return serializeCDATA(node);\n        }\n    }\n};\n\nexports.serializeToString = function (document) {\n    return removeInvalidCharacters(nodeTreeToXHTML(document));\n};\n","\"use strict\";\n\nvar url = require('url'),\n    ayepromise = require('ayepromise');\n\n\nexports.getDocumentBaseUrl = function (doc) {\n    if (doc.baseURI !== 'about:blank') {\n        return doc.baseURI;\n    }\n\n    return null;\n};\n\nexports.clone = function (object) {\n    var theClone = {},\n        i;\n    for (i in object) {\n        if (object.hasOwnProperty(i)) {\n           theClone[i] = object[i];\n        }\n    }\n    return theClone;\n};\n\nexports.cloneArray = function (nodeList) {\n    return Array.prototype.slice.apply(nodeList, [0]);\n};\n\nexports.joinUrl = function (baseUrl, relUrl) {\n    if (!baseUrl) {\n        return relUrl;\n    }\n    return url.resolve(baseUrl, relUrl);\n};\n\nexports.isDataUri = function (url) {\n    return (/^data:/).test(url);\n};\n\nexports.all = function (promises) {\n    var defer = ayepromise.defer(),\n        pendingPromiseCount = promises.length,\n        resolvedValues = [];\n\n    if (promises.length === 0) {\n        defer.resolve([]);\n        return defer.promise;\n    }\n\n    promises.forEach(function (promise, idx) {\n        promise.then(function (value) {\n            pendingPromiseCount -= 1;\n            resolvedValues[idx] = value;\n\n            if (pendingPromiseCount === 0) {\n                defer.resolve(resolvedValues);\n            }\n        }, function (e) {\n            defer.reject(e);\n        });\n    });\n    return defer.promise;\n};\n\nexports.collectAndReportErrors = function (promises) {\n    var errors = [];\n\n    return exports.all(promises.map(function (promise) {\n        return promise.fail(function (e) {\n            errors.push(e);\n        });\n    })).then(function () {\n        return errors;\n    });\n};\n\nvar lastCacheDate = null;\n\nvar getUncachableURL = function (url, cache) {\n    if (cache === false || cache === 'none' || cache === 'repeated') {\n        if (lastCacheDate === null || cache !== 'repeated') {\n            lastCacheDate = Date.now();\n        }\n        return url + \"?_=\" + lastCacheDate;\n    } else {\n        return url;\n    }\n};\n\nexports.ajax = function (url, options) {\n    var ajaxRequest = new window.XMLHttpRequest(),\n        defer = ayepromise.defer(),\n        joinedUrl = exports.joinUrl(options.baseUrl, url),\n        augmentedUrl;\n\n    var doReject = function () {\n        defer.reject({\n            msg: 'Unable to load url',\n            url: joinedUrl\n        });\n    };\n\n    augmentedUrl = getUncachableURL(joinedUrl, options.cache);\n\n    ajaxRequest.addEventListener(\"load\", function () {\n        if (ajaxRequest.status === 200 || ajaxRequest.status === 0) {\n            defer.resolve(ajaxRequest.response);\n        } else {\n            doReject();\n        }\n    }, false);\n\n    ajaxRequest.addEventListener(\"error\", doReject, false);\n\n    try {\n        ajaxRequest.open('GET', augmentedUrl, true);\n        ajaxRequest.overrideMimeType(options.mimeType);\n        ajaxRequest.send(null);\n    } catch (e) {\n        doReject();\n    }\n\n    return defer.promise;\n};\n\nexports.binaryAjax = function (url, options) {\n    var ajaxOptions = exports.clone(options);\n\n    ajaxOptions.mimeType = 'text/plain; charset=x-user-defined';\n\n    return exports.ajax(url, ajaxOptions)\n        .then(function (content) {\n            var binaryContent = \"\";\n\n            for (var i = 0; i < content.length; i++) {\n                binaryContent += String.fromCharCode(content.charCodeAt(i) & 0xFF);\n            }\n\n            return binaryContent;\n        });\n};\n\nvar detectMimeType = function (content) {\n    var startsWith = function (string, substring) {\n        return string.substring(0, substring.length) === substring;\n    };\n\n    if (startsWith(content, '<?xml') || startsWith(content, '<svg')) {\n        return 'image/svg+xml';\n    }\n    return 'image/png';\n};\n\nexports.getDataURIForImageURL = function (url, options) {\n    return exports.binaryAjax(url, options)\n        .then(function (content) {\n            var base64Content = btoa(content),\n                mimeType = detectMimeType(content);\n\n            return 'data:' + mimeType + ';base64,' + base64Content;\n        });\n};\n\nvar uniqueIdList = [];\n\nvar constantUniqueIdFor = function (element) {\n    // HACK, using a list results in O(n), but how do we hash a function?\n    if (uniqueIdList.indexOf(element) < 0) {\n        uniqueIdList.push(element);\n    }\n    return uniqueIdList.indexOf(element);\n};\n\nexports.memoize = function (func, hasher, memo) {\n    if (typeof memo !== \"object\") {\n        throw new Error(\"cacheBucket is not an object\");\n    }\n\n    return function () {\n        var args = Array.prototype.slice.call(arguments);\n\n        var argumentHash = hasher(args),\n            funcHash = constantUniqueIdFor(func),\n            retValue;\n\n        if (memo[funcHash] && memo[funcHash][argumentHash]) {\n            return memo[funcHash][argumentHash];\n        } else {\n            retValue = func.apply(null, args);\n\n            memo[funcHash] = memo[funcHash] || {};\n            memo[funcHash][argumentHash] = retValue;\n\n            return retValue;\n        }\n    };\n};\n","\"use strict\";\n\nvar util = require('./util');\n\n\nvar encodeImageAsDataURI = function (image, options) {\n    var url = image.attributes.src ? image.attributes.src.nodeValue : null,\n        documentBase = util.getDocumentBaseUrl(image.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBase) {\n        ajaxOptions.baseUrl = documentBase;\n    }\n\n    return util.getDataURIForImageURL(url, ajaxOptions)\n        .then(function (dataURI) {\n            return dataURI;\n        }, function (e) {\n            throw {\n                resourceType: \"image\",\n                url: e.url,\n                msg: \"Unable to load image \" + e.url\n            };\n        });\n};\n\nvar filterExternalImages = function (images) {\n    return images.filter(function (image) {\n        var url = image.attributes.src ? image.attributes.src.nodeValue : null;\n\n        return url !== null && !util.isDataUri(url);\n    });\n};\n\nvar filterInputsForImageType = function (inputs) {\n    return Array.prototype.filter.call(inputs, function (input) {\n        return input.type === \"image\";\n    });\n};\n\nvar toArray = function (arrayLike) {\n    return Array.prototype.slice.call(arrayLike);\n};\n\nexports.inline = function (doc, options) {\n    var images = toArray(doc.getElementsByTagName(\"img\")),\n        imageInputs = filterInputsForImageType(doc.getElementsByTagName(\"input\")),\n        externalImages = filterExternalImages(images.concat(imageInputs));\n\n    return util.collectAndReportErrors(externalImages.map(function (image) {\n        return encodeImageAsDataURI(image, options).then(function (dataURI) {\n            image.attributes.src.nodeValue = dataURI;\n        });\n    }));\n};\n","\"use strict\";\n\nvar util = require('./util');\n\n\nvar loadLinkedScript = function (script, options) {\n    var src = script.attributes.src.nodeValue,\n        documentBase = util.getDocumentBaseUrl(script.ownerDocument),\n        ajaxOptions = util.clone(options);\n\n    if (!ajaxOptions.baseUrl && documentBase) {\n        ajaxOptions.baseUrl = documentBase;\n    }\n\n    return util.ajax(src, ajaxOptions)\n        .fail(function (e) {\n            throw {\n                resourceType: \"script\",\n                url: e.url,\n                msg: \"Unable to load script \" + e.url\n            };\n        });\n};\n\nvar escapeClosingTags = function (text) {\n    // http://stackoverflow.com/questions/9246382/escaping-script-tag-inside-javascript\n    return text.replace(/<\\//g, '<\\\\/');\n};\n\nvar substituteExternalScriptWithInline = function (scriptNode, jsCode) {\n    scriptNode.attributes.removeNamedItem('src');\n    scriptNode.textContent = escapeClosingTags(jsCode);\n};\n\nvar getScripts = function (doc) {\n    var scripts = doc.getElementsByTagName(\"script\");\n\n    return Array.prototype.filter.call(scripts, function (script) {\n        return !!script.attributes.src;\n    });\n};\n\nexports.inline = function (doc, options) {\n    var scripts = getScripts(doc);\n\n    return util.collectAndReportErrors(scripts.map(function (script) {\n        return loadLinkedScript(script, options).then(function (jsCode) {\n            substituteExternalScriptWithInline(script, jsCode);\n        });\n    }));\n};\n","\"use strict\";\n\nvar ayepromise = require('ayepromise'),\n    util = require('./util'),\n    cssSupport = require('./cssSupport'),\n    backgroundValueParser = require('./backgroundValueParser'),\n    fontFaceSrcValueParser = require('css-font-face-src');\n\n\nvar updateCssPropertyValue = function (rule, property, value) {\n    rule.style.setProperty(property, value, rule.style.getPropertyPriority(property));\n};\n\nvar findBackgroundImageRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.STYLE_RULE && (rule.style.getPropertyValue('background-image') || rule.style.getPropertyValue('background'));\n    });\n};\n\nvar findBackgroundDeclarations = function (rules) {\n    var backgroundDeclarations = [];\n\n    rules.forEach(function (rule) {\n        if (rule.style.getPropertyValue('background-image')) {\n            backgroundDeclarations.push({\n                property: 'background-image',\n                value: rule.style.getPropertyValue('background-image'),\n                rule: rule\n            });\n        } else if (rule.style.getPropertyValue('background')) {\n            backgroundDeclarations.push({\n                property: 'background',\n                value: rule.style.getPropertyValue('background'),\n                rule: rule\n            });\n        }\n    });\n\n    return backgroundDeclarations;\n};\n\nvar findFontFaceRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.FONT_FACE_RULE && rule.style.getPropertyValue(\"src\");\n    });\n};\n\nvar findCSSImportRules = function (cssRules) {\n    return cssRules.filter(function (rule) {\n        return rule.type === window.CSSRule.IMPORT_RULE && rule.href;\n    });\n};\n\nvar findExternalBackgroundUrls = function (parsedBackground) {\n    var matchIndices = [];\n\n    parsedBackground.forEach(function (backgroundLayer, i) {\n        if (backgroundLayer.url && !util.isDataUri(backgroundLayer.url)) {\n            matchIndices.push(i);\n        }\n    });\n\n    return matchIndices;\n};\n\nvar findExternalFontFaceUrls = function (parsedFontFaceSources) {\n    var sourceIndices = [];\n    parsedFontFaceSources.forEach(function (sourceItem, i) {\n        if (sourceItem.url && !util.isDataUri(sourceItem.url)) {\n            sourceIndices.push(i);\n        }\n    });\n    return sourceIndices;\n};\n\nexports.adjustPathsOfCssResources = function (baseUrl, cssRules) {\n    var backgroundRules = findBackgroundImageRules(cssRules),\n        backgroundDeclarations = findBackgroundDeclarations(backgroundRules),\n        change = false;\n\n    backgroundDeclarations.forEach(function (declaration) {\n        var parsedBackground = backgroundValueParser.parse(declaration.value),\n            externalBackgroundIndices = findExternalBackgroundUrls(parsedBackground),\n            backgroundValue;\n\n        if (externalBackgroundIndices.length > 0) {\n            externalBackgroundIndices.forEach(function (backgroundLayerIndex) {\n                var relativeUrl = parsedBackground[backgroundLayerIndex].url,\n                    url = util.joinUrl(baseUrl, relativeUrl);\n                parsedBackground[backgroundLayerIndex].url = url;\n            });\n\n            backgroundValue = backgroundValueParser.serialize(parsedBackground);\n\n            updateCssPropertyValue(declaration.rule, declaration.property, backgroundValue);\n\n            change = true;\n        }\n    });\n    findFontFaceRules(cssRules).forEach(function (rule) {\n        var fontFaceSrcDeclaration = rule.style.getPropertyValue(\"src\"),\n            parsedFontFaceSources, externalFontFaceUrlIndices;\n\n        try {\n            parsedFontFaceSources = fontFaceSrcValueParser.parse(fontFaceSrcDeclaration);\n        } catch (e) {\n            return;\n        }\n        externalFontFaceUrlIndices = findExternalFontFaceUrls(parsedFontFaceSources);\n\n        if (externalFontFaceUrlIndices.length > 0) {\n            externalFontFaceUrlIndices.forEach(function (fontFaceUrlIndex) {\n                var relativeUrl = parsedFontFaceSources[fontFaceUrlIndex].url,\n                    url = util.joinUrl(baseUrl, relativeUrl);\n\n                parsedFontFaceSources[fontFaceUrlIndex].url = url;\n            });\n\n            cssSupport.changeFontFaceRuleSrc(cssRules, rule, fontFaceSrcValueParser.serialize(parsedFontFaceSources));\n\n            change = true;\n        }\n    });\n    findCSSImportRules(cssRules).forEach(function (rule) {\n        var cssUrl = rule.href,\n            url = util.joinUrl(baseUrl, cssUrl);\n\n        cssSupport.exchangeRule(cssRules, rule, \"@import url(\" + url + \");\");\n\n        change = true;\n    });\n\n    return change;\n};\n\n/* CSS import inlining */\n\nvar substituteRule = function (cssRules, rule, newCssRules) {\n    var position = cssRules.indexOf(rule);\n\n    cssRules.splice(position, 1);\n\n    newCssRules.forEach(function (newRule, i) {\n        cssRules.splice(position + i, 0, newRule);\n    });\n};\n\nvar fulfilledPromise = function (value) {\n    var defer = ayepromise.defer();\n    defer.resolve(value);\n    return defer.promise;\n};\n\nvar loadAndInlineCSSImport = function (cssRules, rule, alreadyLoadedCssUrls, options) {\n    var url = rule.href,\n        cssHrefRelativeToDoc;\n\n    url = cssSupport.unquoteString(url);\n\n    cssHrefRelativeToDoc = util.joinUrl(options.baseUrl, url);\n\n    if (alreadyLoadedCssUrls.indexOf(cssHrefRelativeToDoc) >= 0) {\n        // Remove URL by adding empty string\n        substituteRule(cssRules, rule, []);\n        return fulfilledPromise([]);\n    } else {\n        alreadyLoadedCssUrls.push(cssHrefRelativeToDoc);\n    }\n\n    return util.ajax(url, options)\n        .then(function (cssText) {\n            var externalCssRules = cssSupport.rulesForCssText(cssText);\n\n            // Recursively follow @import statements\n            return exports.loadCSSImportsForRules(externalCssRules, alreadyLoadedCssUrls, options)\n                .then(function (result) {\n                    exports.adjustPathsOfCssResources(url, externalCssRules);\n\n                    substituteRule(cssRules, rule, externalCssRules);\n\n                    return result.errors;\n                });\n        }, function (e) {\n            throw {\n                resourceType: \"stylesheet\",\n                url: e.url,\n                msg: \"Unable to load stylesheet \" + e.url\n            };\n        });\n};\n\nexports.loadCSSImportsForRules = function (cssRules, alreadyLoadedCssUrls, options) {\n    var rulesToInline = findCSSImportRules(cssRules),\n        errors = [],\n        hasChanges = false;\n\n    return util.all(rulesToInline.map(function (rule) {\n        return loadAndInlineCSSImport(cssRules, rule, alreadyLoadedCssUrls, options).then(function (moreErrors) {\n            errors = errors.concat(moreErrors);\n\n            hasChanges = true;\n        }, function (e) {\n            errors.push(e);\n        });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\n/* CSS linked resource inlining */\n\nvar loadAndInlineBackgroundImages = function (backgroundValue, options) {\n    var parsedBackground = backgroundValueParser.parse(backgroundValue),\n        externalBackgroundLayerIndices = findExternalBackgroundUrls(parsedBackground),\n        hasChanges = false;\n\n    return util.collectAndReportErrors(externalBackgroundLayerIndices.map(function (backgroundLayerIndex) {\n        var url = parsedBackground[backgroundLayerIndex].url;\n\n        return util.getDataURIForImageURL(url, options)\n            .then(function (dataURI) {\n                parsedBackground[backgroundLayerIndex].url = dataURI;\n\n                hasChanges = true;\n            }, function (e) {\n                throw {\n                    resourceType: \"backgroundImage\",\n                    url: e.url,\n                    msg: \"Unable to load background-image \" + e.url\n                };\n            });\n    })).then(function (errors) {\n        return {\n            backgroundValue: backgroundValueParser.serialize(parsedBackground),\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar iterateOverRulesAndInlineBackgroundImages = function (cssRules, options) {\n    var rulesToInline = findBackgroundImageRules(cssRules),\n        backgroundDeclarations = findBackgroundDeclarations(rulesToInline),\n        errors = [],\n        cssHasChanges = false;\n\n    return util.all(backgroundDeclarations.map(function (declaration) {\n        return loadAndInlineBackgroundImages(declaration.value, options)\n            .then(function (result) {\n                if (result.hasChanges) {\n                    updateCssPropertyValue(declaration.rule, declaration.property, result.backgroundValue);\n\n                    cssHasChanges = true;\n                }\n\n                errors = errors.concat(result.errors);\n            });\n    })).then(function () {\n        return {\n            hasChanges: cssHasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar loadAndInlineFontFace = function (srcDeclarationValue, options) {\n    var hasChanges = false,\n        parsedFontFaceSources, externalFontFaceUrlIndices;\n\n    try {\n        parsedFontFaceSources = fontFaceSrcValueParser.parse(srcDeclarationValue);\n    } catch (e) {\n        parsedFontFaceSources = [];\n    }\n    externalFontFaceUrlIndices = findExternalFontFaceUrls(parsedFontFaceSources);\n\n    return util.collectAndReportErrors(externalFontFaceUrlIndices.map(function (urlIndex) {\n        var fontSrc = parsedFontFaceSources[urlIndex],\n            format = fontSrc.format || \"woff\";\n\n        return util.binaryAjax(fontSrc.url, options)\n            .then(function (content) {\n                var base64Content = btoa(content);\n                fontSrc.url = 'data:font/' + format + ';base64,' + base64Content;\n\n                hasChanges = true;\n            }, function (e) {\n                throw {\n                    resourceType: \"fontFace\",\n                    url: e.url,\n                    msg: \"Unable to load font-face \" + e.url\n                };\n            });\n    })).then(function (errors) {\n        return {\n            srcDeclarationValue: fontFaceSrcValueParser.serialize(parsedFontFaceSources),\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nvar iterateOverRulesAndInlineFontFace = function (cssRules, options) {\n    var rulesToInline = findFontFaceRules(cssRules),\n        errors = [],\n        hasChanges = false;\n\n    return util.all(rulesToInline.map(function (rule) {\n        var srcDeclarationValue = rule.style.getPropertyValue(\"src\");\n\n        return loadAndInlineFontFace(srcDeclarationValue, options).then(function (result) {\n            if (result.hasChanges) {\n                cssSupport.changeFontFaceRuleSrc(cssRules, rule, result.srcDeclarationValue);\n\n                hasChanges = true;\n            }\n\n            errors = errors.concat(result.errors);\n        });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n\nexports.loadAndInlineCSSResourcesForRules = function (cssRules, options) {\n    var hasChanges = false,\n        errors = [];\n\n    return util.all([iterateOverRulesAndInlineBackgroundImages, iterateOverRulesAndInlineFontFace].map(function (func) {\n        return func(cssRules, options)\n            .then(function (result) {\n                hasChanges = hasChanges || result.hasChanges;\n                errors = errors.concat(result.errors);\n            });\n    })).then(function () {\n        return {\n            hasChanges: hasChanges,\n            errors: errors\n        };\n    });\n};\n","\"use strict\";\n\nvar cssom = require('cssom');\n\n\nexports.unquoteString = function (quotedUrl) {\n    var doubleQuoteRegex = /^\"(.*)\"$/,\n        singleQuoteRegex = /^'(.*)'$/;\n\n    if (doubleQuoteRegex.test(quotedUrl)) {\n        return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n    } else {\n        if (singleQuoteRegex.test(quotedUrl)) {\n            return quotedUrl.replace(singleQuoteRegex, \"$1\");\n        } else {\n            return quotedUrl;\n        }\n    }\n};\n\nvar rulesForCssTextFromBrowser = function (styleContent) {\n    var doc = document.implementation.createHTMLDocument(\"\"),\n        styleElement = document.createElement(\"style\"),\n        rules;\n\n    styleElement.textContent = styleContent;\n    // the style will only be parsed once it is added to a document\n    doc.body.appendChild(styleElement);\n    rules = styleElement.sheet.cssRules;\n\n    return Array.prototype.slice.call(rules);\n};\n\nvar browserHasBackgroundImageUrlIssue = (function () {\n    // Checks for http://code.google.com/p/chromium/issues/detail?id=161644\n    var rules = rulesForCssTextFromBrowser('a{background:url(i)}');\n    return !rules.length || rules[0].cssText.indexOf('url()') >= 0;\n}());\n\nexports.rulesForCssText = function (styleContent) {\n    if (browserHasBackgroundImageUrlIssue && cssom.parse) {\n        return cssom.parse(styleContent).cssRules;\n    } else {\n        return rulesForCssTextFromBrowser(styleContent);\n    }\n};\n\nexports.cssRulesToText = function (cssRules) {\n    return cssRules.reduce(function (cssText, rule) {\n        return cssText + rule.cssText;\n    }, '');\n};\n\nexports.exchangeRule = function (cssRules, rule, newRuleText) {\n    var ruleIdx = cssRules.indexOf(rule),\n        styleSheet = rule.parentStyleSheet;\n\n    // Generate a new rule\n    styleSheet.insertRule(newRuleText, ruleIdx+1);\n    styleSheet.deleteRule(ruleIdx);\n    // Exchange with the new\n    cssRules[ruleIdx] = styleSheet.cssRules[ruleIdx];\n};\n\n// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=443978\nexports.changeFontFaceRuleSrc = function (cssRules, rule, newSrc) {\n    var newRuleText = '@font-face { font-family: ' + rule.style.getPropertyValue(\"font-family\") + '; ';\n\n    if (rule.style.getPropertyValue(\"font-style\")) {\n        newRuleText += 'font-style: ' + rule.style.getPropertyValue(\"font-style\") + '; ';\n    }\n\n    if (rule.style.getPropertyValue(\"font-weight\")) {\n        newRuleText += 'font-weight: ' + rule.style.getPropertyValue(\"font-weight\") + '; ';\n    }\n\n    newRuleText += 'src: ' + newSrc + '}';\n    exports.exchangeRule(cssRules, rule, newRuleText);\n};\n","// Simple, stupid \"background\"/\"background-image\" value parser that just aims at exposing the image URLs\n\"use strict\";\n\nvar cssSupport = require('./cssSupport');\n\n\nvar trimCSSWhitespace = function (url) {\n    var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n    return url.replace(whitespaceRegex, \"$1\");\n};\n\n// TODO exporting this for the sake of unit testing. Should rather test the background value parser explicitly.\nexports.extractCssUrl = function (cssUrl) {\n    var urlRegex = /^url\\(([^\\)]+)\\)/,\n        quotedUrl;\n\n    if (!urlRegex.test(cssUrl)) {\n        throw new Error(\"Invalid url\");\n    }\n\n    quotedUrl = urlRegex.exec(cssUrl)[1];\n    return cssSupport.unquoteString(trimCSSWhitespace(quotedUrl));\n};\n\nvar sliceBackgroundDeclaration = function (backgroundDeclarationText) {\n    var functionParamRegexS = \"\\\\s*(?:\\\"[^\\\"]*\\\"|'[^']*'|[^\\\\(]+)\\\\s*\",\n        valueRegexS = \"(\" + \"url\\\\(\" + functionParamRegexS + \"\\\\)\" + \"|\" + \"[^,\\\\s]+\" + \")\",\n        simpleSingularBackgroundRegexS = \"(?:\\\\s*\" + valueRegexS + \")+\",\n        simpleBackgroundRegexS = \"^\\\\s*(\" + simpleSingularBackgroundRegexS + \")\" +\n                                  \"(?:\\\\s*,\\\\s*(\" + simpleSingularBackgroundRegexS + \"))*\" +\n                                  \"\\\\s*$\",\n        simpleSingularBackgroundRegex = new RegExp(simpleSingularBackgroundRegexS, \"g\"),\n        outerRepeatedMatch,\n        backgroundLayers = [],\n        getValues = function (singularBackgroundDeclaration) {\n            var valueRegex = new RegExp(valueRegexS, \"g\"),\n                backgroundValues = [],\n                repeatedMatch;\n\n            repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n            while (repeatedMatch) {\n                backgroundValues.push(repeatedMatch[1]);\n                repeatedMatch = valueRegex.exec(singularBackgroundDeclaration);\n            }\n            return backgroundValues;\n        };\n\n    if (backgroundDeclarationText.match(new RegExp(simpleBackgroundRegexS))) {\n        outerRepeatedMatch = simpleSingularBackgroundRegex.exec(backgroundDeclarationText);\n        while (outerRepeatedMatch) {\n            backgroundLayers.push(getValues(outerRepeatedMatch[0]));\n            outerRepeatedMatch = simpleSingularBackgroundRegex.exec(backgroundDeclarationText);\n        }\n\n        return backgroundLayers;\n    }\n    return [];\n};\n\nvar findBackgroundImageUrlInValues = function (values) {\n    var i, url;\n\n    for(i = 0; i < values.length; i++) {\n        try {\n            url = exports.extractCssUrl(values[i]);\n            return {\n                url: url,\n                idx: i\n            };\n        } catch (e) {}\n    }\n};\n\nexports.parse = function (backgroundValue) {\n    var backgroundLayers = sliceBackgroundDeclaration(backgroundValue);\n\n    return backgroundLayers.map(function (backgroundLayerValues) {\n        var urlMatch = findBackgroundImageUrlInValues(backgroundLayerValues);\n\n        if (urlMatch) {\n            return {\n                preUrl: backgroundLayerValues.slice(0, urlMatch.idx),\n                url: urlMatch.url,\n                postUrl: backgroundLayerValues.slice(urlMatch.idx+1),\n            };\n        } else {\n            return {\n                preUrl: backgroundLayerValues\n            };\n        }\n    });\n};\n\nexports.serialize = function (parsedBackground) {\n    var backgroundLayers = parsedBackground.map(function (backgroundLayer) {\n        var values = [].concat(backgroundLayer.preUrl);\n\n        if (backgroundLayer.url) {\n            values.push('url(\"' + backgroundLayer.url + '\")');\n        }\n        if (backgroundLayer.postUrl) {\n            values = values.concat(backgroundLayer.postUrl);\n        }\n\n        return values.join(' ');\n    });\n\n    return backgroundLayers.join(', ');\n};\n","var grammar = require('./grammar');\n\n\nexports.SyntaxError = function (message, offset) {\n    this.message  = message;\n    this.offset   = offset;\n};\n\nexports.parse = function (fontFaceSourceValue) {\n    try {\n        return grammar.parse(fontFaceSourceValue);\n    } catch (e) {\n        throw new exports.SyntaxError(e.message, e.offset);\n    }\n};\n\nexports.serialize = function (parsedFontFaceSources) {\n    return parsedFontFaceSources.map(function (sourceItem) {\n        var itemValue;\n\n        if (sourceItem.url) {\n            itemValue = 'url(\"' + sourceItem.url + '\")';\n            if (sourceItem.format) {\n                itemValue += ' format(\"' + sourceItem.format + '\")';\n            }\n        } else {\n            itemValue = 'local(\"' + sourceItem.local + '\")';\n        }\n        return itemValue;\n    }).join(', ');\n};\n","'use strict';\n\nexports.CSSStyleDeclaration = require('./CSSStyleDeclaration').CSSStyleDeclaration;\nexports.CSSRule = require('./CSSRule').CSSRule;\nexports.CSSStyleRule = require('./CSSStyleRule').CSSStyleRule;\nexports.MediaList = require('./MediaList').MediaList;\nexports.CSSMediaRule = require('./CSSMediaRule').CSSMediaRule;\nexports.CSSImportRule = require('./CSSImportRule').CSSImportRule;\nexports.CSSFontFaceRule = require('./CSSFontFaceRule').CSSFontFaceRule;\nexports.StyleSheet = require('./StyleSheet').StyleSheet;\nexports.CSSStyleSheet = require('./CSSStyleSheet').CSSStyleSheet;\nexports.CSSKeyframesRule = require('./CSSKeyframesRule').CSSKeyframesRule;\nexports.CSSKeyframeRule = require('./CSSKeyframeRule').CSSKeyframeRule;\nexports.MatcherList = require('./MatcherList').MatcherList;\nexports.CSSDocumentRule = require('./CSSDocumentRule').CSSDocumentRule;\nexports.CSSValue = require('./CSSValue').CSSValue;\nexports.CSSValueExpression = require('./CSSValueExpression').CSSValueExpression;\nexports.parse = require('./parse').parse;\nexports.clone = require('./clone').clone;\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration\n */\nCSSOM.CSSStyleDeclaration = function CSSStyleDeclaration(){\n\tthis.length = 0;\n\tthis.parentRule = null;\n\n\t// NON-STANDARD\n\tthis._importants = {};\n};\n\n\nCSSOM.CSSStyleDeclaration.prototype = {\n\n\tconstructor: CSSOM.CSSStyleDeclaration,\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-getPropertyValue\n\t * @return {string} the value of the property if it has been explicitly set for this declaration block.\n\t * Returns the empty string if the property has not been set.\n\t */\n\tgetPropertyValue: function(name) {\n\t\treturn this[name] || \"\";\n\t},\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @param {string} value\n\t * @param {string} [priority=null] \"important\" or null\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-setProperty\n\t */\n\tsetProperty: function(name, value, priority) {\n\t\tif (this[name]) {\n\t\t\t// Property already exist. Overwrite it.\n\t\t\tvar index = Array.prototype.indexOf.call(this, name);\n\t\t\tif (index < 0) {\n\t\t\t\tthis[this.length] = name;\n\t\t\t\tthis.length++;\n\t\t\t}\n\t\t} else {\n\t\t\t// New property.\n\t\t\tthis[this.length] = name;\n\t\t\tthis.length++;\n\t\t}\n\t\tthis[name] = value;\n\t\tthis._importants[name] = priority;\n\t},\n\n\t/**\n\t *\n\t * @param {string} name\n\t * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleDeclaration-removeProperty\n\t * @return {string} the value of the property if it has been explicitly set for this declaration block.\n\t * Returns the empty string if the property has not been set or the property name does not correspond to a known CSS property.\n\t */\n\tremoveProperty: function(name) {\n\t\tif (!(name in this)) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar index = Array.prototype.indexOf.call(this, name);\n\t\tif (index < 0) {\n\t\t\treturn \"\";\n\t\t}\n\t\tvar prevValue = this[name];\n\t\tthis[name] = \"\";\n\n\t\t// That's what WebKit and Opera do\n\t\tArray.prototype.splice.call(this, index, 1);\n\n\t\t// That's what Firefox does\n\t\t//this[index] = \"\"\n\n\t\treturn prevValue;\n\t},\n\n\tgetPropertyCSSValue: function() {\n\t\t//FIXME\n\t},\n\n\t/**\n\t *\n\t * @param {String} name\n\t */\n\tgetPropertyPriority: function(name) {\n\t\treturn this._importants[name] || \"\";\n\t},\n\n\n\t/**\n\t *   element.style.overflow = \"auto\"\n\t *   element.style.getPropertyShorthand(\"overflow-x\")\n\t *   -> \"overflow\"\n\t */\n\tgetPropertyShorthand: function() {\n\t\t//FIXME\n\t},\n\n\tisPropertyImplicit: function() {\n\t\t//FIXME\n\t},\n\n\t// Doesn't work in IE < 9\n\tget cssText(){\n\t\tvar properties = [];\n\t\tfor (var i=0, length=this.length; i < length; ++i) {\n\t\t\tvar name = this[i];\n\t\t\tvar value = this.getPropertyValue(name);\n\t\t\tvar priority = this.getPropertyPriority(name);\n\t\t\tif (priority) {\n\t\t\t\tpriority = \" !\" + priority;\n\t\t\t}\n\t\t\tproperties[i] = name + \": \" + value + priority + \";\";\n\t\t}\n\t\treturn properties.join(\" \");\n\t},\n\n\tset cssText(cssText){\n\t\tvar i, name;\n\t\tfor (i = this.length; i--;) {\n\t\t\tname = this[i];\n\t\t\tthis[name] = \"\";\n\t\t}\n\t\tArray.prototype.splice.call(this, 0, this.length);\n\t\tthis._importants = {};\n\n\t\tvar dummyRule = CSSOM.parse('#bogus{' + cssText + '}').cssRules[0].style;\n\t\tvar length = dummyRule.length;\n\t\tfor (i = 0; i < length; ++i) {\n\t\t\tname = dummyRule[i];\n\t\t\tthis.setProperty(dummyRule[i], dummyRule.getPropertyValue(name), dummyRule.getPropertyPriority(name));\n\t\t}\n\t}\n};\n\n\n//.CommonJS\nexports.CSSStyleDeclaration = CSSOM.CSSStyleDeclaration;\nCSSOM.parse = require('./parse').parse; // Cannot be included sooner due to the mutual dependency between parse.js and CSSStyleDeclaration.js\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-cssrule-interface\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSRule\n */\nCSSOM.CSSRule = function CSSRule() {\n\tthis.parentRule = null;\n\tthis.parentStyleSheet = null;\n};\n\nCSSOM.CSSRule.STYLE_RULE = 1;\nCSSOM.CSSRule.IMPORT_RULE = 3;\nCSSOM.CSSRule.MEDIA_RULE = 4;\nCSSOM.CSSRule.FONT_FACE_RULE = 5;\nCSSOM.CSSRule.PAGE_RULE = 6;\nCSSOM.CSSRule.WEBKIT_KEYFRAMES_RULE = 8;\nCSSOM.CSSRule.WEBKIT_KEYFRAME_RULE = 9;\n\n// Obsolete in CSSOM http://dev.w3.org/csswg/cssom/\n//CSSOM.CSSRule.UNKNOWN_RULE = 0;\n//CSSOM.CSSRule.CHARSET_RULE = 2;\n\n// Never implemented\n//CSSOM.CSSRule.VARIABLES_RULE = 7;\n\nCSSOM.CSSRule.prototype = {\n\tconstructor: CSSOM.CSSRule\n\t//FIXME\n};\n\n\n//.CommonJS\nexports.CSSRule = CSSOM.CSSRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssstylerule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleRule\n */\nCSSOM.CSSStyleRule = function CSSStyleRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.selectorText = \"\";\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSStyleRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSStyleRule.prototype.constructor = CSSOM.CSSStyleRule;\nCSSOM.CSSStyleRule.prototype.type = 1;\n\nObject.defineProperty(CSSOM.CSSStyleRule.prototype, \"cssText\", {\n\tget: function() {\n\t\tvar text;\n\t\tif (this.selectorText) {\n\t\t\ttext = this.selectorText + \" {\" + this.style.cssText + \"}\";\n\t\t} else {\n\t\t\ttext = \"\";\n\t\t}\n\t\treturn text;\n\t},\n\tset: function(cssText) {\n\t\tvar rule = CSSOM.CSSStyleRule.parse(cssText);\n\t\tthis.style = rule.style;\n\t\tthis.selectorText = rule.selectorText;\n\t}\n});\n\n\n/**\n * NON-STANDARD\n * lightweight version of parse.js.\n * @param {string} ruleText\n * @return CSSStyleRule\n */\nCSSOM.CSSStyleRule.parse = function(ruleText) {\n\tvar i = 0;\n\tvar state = \"selector\";\n\tvar index;\n\tvar j = i;\n\tvar buffer = \"\";\n\n\tvar SIGNIFICANT_WHITESPACE = {\n\t\t\"selector\": true,\n\t\t\"value\": true\n\t};\n\n\tvar styleRule = new CSSOM.CSSStyleRule;\n\tvar selector, name, value, priority=\"\";\n\n\tfor (var character; character = ruleText.charAt(i); i++) {\n\n\t\tswitch (character) {\n\n\t\tcase \" \":\n\t\tcase \"\\t\":\n\t\tcase \"\\r\":\n\t\tcase \"\\n\":\n\t\tcase \"\\f\":\n\t\t\tif (SIGNIFICANT_WHITESPACE[state]) {\n\t\t\t\t// Squash 2 or more white-spaces in the row into 1\n\t\t\t\tswitch (ruleText.charAt(i - 1)) {\n\t\t\t\t\tcase \" \":\n\t\t\t\t\tcase \"\\t\":\n\t\t\t\t\tcase \"\\r\":\n\t\t\t\t\tcase \"\\n\":\n\t\t\t\t\tcase \"\\f\":\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tbuffer += \" \";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// String\n\t\tcase '\"':\n\t\t\tj = i + 1;\n\t\t\tindex = ruleText.indexOf('\"', j) + 1;\n\t\t\tif (!index) {\n\t\t\t\tthrow '\" is missing';\n\t\t\t}\n\t\t\tbuffer += ruleText.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tbreak;\n\n\t\tcase \"'\":\n\t\t\tj = i + 1;\n\t\t\tindex = ruleText.indexOf(\"'\", j) + 1;\n\t\t\tif (!index) {\n\t\t\t\tthrow \"' is missing\";\n\t\t\t}\n\t\t\tbuffer += ruleText.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tbreak;\n\n\t\t// Comment\n\t\tcase \"/\":\n\t\t\tif (ruleText.charAt(i + 1) === \"*\") {\n\t\t\t\ti += 2;\n\t\t\t\tindex = ruleText.indexOf(\"*/\", i);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tthrow new SyntaxError(\"Missing */\");\n\t\t\t\t} else {\n\t\t\t\t\ti = index + 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"{\":\n\t\t\tif (state === \"selector\") {\n\t\t\t\tstyleRule.selectorText = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"name\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \":\":\n\t\t\tif (state === \"name\") {\n\t\t\t\tname = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"value\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"!\":\n\t\t\tif (state === \"value\" && ruleText.indexOf(\"!important\", i) === i) {\n\t\t\t\tpriority = \"important\";\n\t\t\t\ti += \"important\".length;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \";\":\n\t\t\tif (state === \"value\") {\n\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\tpriority = \"\";\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"name\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"}\":\n\t\t\tif (state === \"value\") {\n\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\tpriority = \"\";\n\t\t\t\tbuffer = \"\";\n\t\t\t} else if (state === \"name\") {\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tstate = \"selector\";\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\n\t\t}\n\t}\n\n\treturn styleRule;\n\n};\n\n\n//.CommonJS\nexports.CSSStyleRule = CSSOM.CSSStyleRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-medialist-interface\n */\nCSSOM.MediaList = function MediaList(){\n\tthis.length = 0;\n};\n\nCSSOM.MediaList.prototype = {\n\n\tconstructor: CSSOM.MediaList,\n\n\t/**\n\t * @return {string}\n\t */\n\tget mediaText() {\n\t\treturn Array.prototype.join.call(this, \", \");\n\t},\n\n\t/**\n\t * @param {string} value\n\t */\n\tset mediaText(value) {\n\t\tvar values = value.split(\",\");\n\t\tvar length = this.length = values.length;\n\t\tfor (var i=0; i<length; i++) {\n\t\t\tthis[i] = values[i].trim();\n\t\t}\n\t},\n\n\t/**\n\t * @param {string} medium\n\t */\n\tappendMedium: function(medium) {\n\t\tif (Array.prototype.indexOf.call(this, medium) === -1) {\n\t\t\tthis[this.length] = medium;\n\t\t\tthis.length++;\n\t\t}\n\t},\n\n\t/**\n\t * @param {string} medium\n\t */\n\tdeleteMedium: function(medium) {\n\t\tvar index = Array.prototype.indexOf.call(this, medium);\n\t\tif (index !== -1) {\n\t\t\tArray.prototype.splice.call(this, index, 1);\n\t\t}\n\t}\n\n};\n\n\n//.CommonJS\nexports.MediaList = CSSOM.MediaList;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tMediaList: require(\"./MediaList\").MediaList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssmediarule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSMediaRule\n */\nCSSOM.CSSMediaRule = function CSSMediaRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.media = new CSSOM.MediaList;\n\tthis.cssRules = [];\n};\n\nCSSOM.CSSMediaRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSMediaRule.prototype.constructor = CSSOM.CSSMediaRule;\nCSSOM.CSSMediaRule.prototype.type = 4;\n//FIXME\n//CSSOM.CSSMediaRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSMediaRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://opensource.apple.com/source/WebCore/WebCore-658.28/css/CSSMediaRule.cpp\nObject.defineProperty(CSSOM.CSSMediaRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n      cssTexts.push(this.cssRules[i].cssText);\n    }\n    return \"@media \" + this.media.mediaText + \" {\" + cssTexts.join(\"\") + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSMediaRule = CSSOM.CSSMediaRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tCSSStyleSheet: require(\"./CSSStyleSheet\").CSSStyleSheet,\n\tMediaList: require(\"./MediaList\").MediaList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#cssimportrule\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSImportRule\n */\nCSSOM.CSSImportRule = function CSSImportRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.href = \"\";\n\tthis.media = new CSSOM.MediaList;\n\tthis.styleSheet = new CSSOM.CSSStyleSheet;\n};\n\nCSSOM.CSSImportRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSImportRule.prototype.constructor = CSSOM.CSSImportRule;\nCSSOM.CSSImportRule.prototype.type = 3;\n\nObject.defineProperty(CSSOM.CSSImportRule.prototype, \"cssText\", {\n  get: function() {\n    var mediaText = this.media.mediaText;\n    return \"@import url(\" + this.href + \")\" + (mediaText ? \" \" + mediaText : \"\") + \";\";\n  },\n  set: function(cssText) {\n    var i = 0;\n\n    /**\n     * @import url(partial.css) screen, handheld;\n     *        ||               |\n     *        after-import     media\n     *         |\n     *         url\n     */\n    var state = '';\n\n    var buffer = '';\n    var index;\n    var mediaText = '';\n    for (var character; character = cssText.charAt(i); i++) {\n\n      switch (character) {\n        case ' ':\n        case '\\t':\n        case '\\r':\n        case '\\n':\n        case '\\f':\n          if (state === 'after-import') {\n            state = 'url';\n          } else {\n            buffer += character;\n          }\n          break;\n\n        case '@':\n          if (!state && cssText.indexOf('@import', i) === i) {\n            state = 'after-import';\n            i += 'import'.length;\n            buffer = '';\n          }\n          break;\n\n        case 'u':\n          if (state === 'url' && cssText.indexOf('url(', i) === i) {\n            index = cssText.indexOf(')', i + 1);\n            if (index === -1) {\n              throw i + ': \")\" not found';\n            }\n            i += 'url('.length;\n            var url = cssText.slice(i, index);\n            if (url[0] === url[url.length - 1]) {\n              if (url[0] === '\"' || url[0] === \"'\") {\n                url = url.slice(1, -1);\n              }\n            }\n            this.href = url;\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case '\"':\n          if (state === 'url') {\n            index = cssText.indexOf('\"', i + 1);\n            if (!index) {\n              throw i + \": '\\\"' not found\";\n            }\n            this.href = cssText.slice(i + 1, index);\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case \"'\":\n          if (state === 'url') {\n            index = cssText.indexOf(\"'\", i + 1);\n            if (!index) {\n              throw i + ': \"\\'\" not found';\n            }\n            this.href = cssText.slice(i + 1, index);\n            i = index;\n            state = 'media';\n          }\n          break;\n\n        case ';':\n          if (state === 'media') {\n            if (buffer) {\n              this.media.mediaText = buffer.trim();\n            }\n          }\n          break;\n\n        default:\n          if (state === 'media') {\n            buffer += character;\n          }\n          break;\n      }\n    }\n  }\n});\n\n\n//.CommonJS\nexports.CSSImportRule = CSSOM.CSSImportRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#css-font-face-rule\n */\nCSSOM.CSSFontFaceRule = function CSSFontFaceRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSFontFaceRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSFontFaceRule.prototype.constructor = CSSOM.CSSFontFaceRule;\nCSSOM.CSSFontFaceRule.prototype.type = 5;\n//FIXME\n//CSSOM.CSSFontFaceRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSFontFaceRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSFontFaceRule.cpp\nObject.defineProperty(CSSOM.CSSFontFaceRule.prototype, \"cssText\", {\n  get: function() {\n    return \"@font-face {\" + this.style.cssText + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSFontFaceRule = CSSOM.CSSFontFaceRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://dev.w3.org/csswg/cssom/#the-stylesheet-interface\n */\nCSSOM.StyleSheet = function StyleSheet() {\n\tthis.parentStyleSheet = null;\n};\n\n\n//.CommonJS\nexports.StyleSheet = CSSOM.StyleSheet;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tStyleSheet: require(\"./StyleSheet\").StyleSheet,\n\tCSSStyleRule: require(\"./CSSStyleRule\").CSSStyleRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet\n */\nCSSOM.CSSStyleSheet = function CSSStyleSheet() {\n\tCSSOM.StyleSheet.call(this);\n\tthis.cssRules = [];\n};\n\n\nCSSOM.CSSStyleSheet.prototype = new CSSOM.StyleSheet;\nCSSOM.CSSStyleSheet.prototype.constructor = CSSOM.CSSStyleSheet;\n\n\n/**\n * Used to insert a new rule into the style sheet. The new rule now becomes part of the cascade.\n *\n *   sheet = new Sheet(\"body {margin: 0}\")\n *   sheet.toString()\n *   -> \"body{margin:0;}\"\n *   sheet.insertRule(\"img {border: none}\", 0)\n *   -> 0\n *   sheet.toString()\n *   -> \"img{border:none;}body{margin:0;}\"\n *\n * @param {string} rule\n * @param {number} index\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-insertRule\n * @return {number} The index within the style sheet's rule collection of the newly inserted rule.\n */\nCSSOM.CSSStyleSheet.prototype.insertRule = function(rule, index) {\n\tif (index < 0 || index > this.cssRules.length) {\n\t\tthrow new RangeError(\"INDEX_SIZE_ERR\");\n\t}\n\tvar cssRule = CSSOM.parse(rule).cssRules[0];\n\tcssRule.parentStyleSheet = this;\n\tthis.cssRules.splice(index, 0, cssRule);\n\treturn index;\n};\n\n\n/**\n * Used to delete a rule from the style sheet.\n *\n *   sheet = new Sheet(\"img{border:none} body{margin:0}\")\n *   sheet.toString()\n *   -> \"img{border:none;}body{margin:0;}\"\n *   sheet.deleteRule(0)\n *   sheet.toString()\n *   -> \"body{margin:0;}\"\n *\n * @param {number} index within the style sheet's rule list of the rule to remove.\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-deleteRule\n */\nCSSOM.CSSStyleSheet.prototype.deleteRule = function(index) {\n\tif (index < 0 || index >= this.cssRules.length) {\n\t\tthrow new RangeError(\"INDEX_SIZE_ERR\");\n\t}\n\tthis.cssRules.splice(index, 1);\n};\n\n\n/**\n * NON-STANDARD\n * @return {string} serialize stylesheet\n */\nCSSOM.CSSStyleSheet.prototype.toString = function() {\n\tvar result = \"\";\n\tvar rules = this.cssRules;\n\tfor (var i=0; i<rules.length; i++) {\n\t\tresult += rules[i].cssText + \"\\n\";\n\t}\n\treturn result;\n};\n\n\n//.CommonJS\nexports.CSSStyleSheet = CSSOM.CSSStyleSheet;\nCSSOM.parse = require('./parse').parse; // Cannot be included sooner due to the mutual dependency between parse.js and CSSStyleSheet.js\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/css3-animations/#DOM-CSSKeyframesRule\n */\nCSSOM.CSSKeyframesRule = function CSSKeyframesRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.name = '';\n\tthis.cssRules = [];\n};\n\nCSSOM.CSSKeyframesRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSKeyframesRule.prototype.constructor = CSSOM.CSSKeyframesRule;\nCSSOM.CSSKeyframesRule.prototype.type = 8;\n//FIXME\n//CSSOM.CSSKeyframesRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSKeyframesRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSKeyframesRule.cpp\nObject.defineProperty(CSSOM.CSSKeyframesRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n      cssTexts.push(\"  \" + this.cssRules[i].cssText);\n    }\n    return \"@\" + (this._vendorPrefix || '') + \"keyframes \" + this.name + \" { \\n\" + cssTexts.join(\"\\n\") + \"\\n}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSKeyframesRule = CSSOM.CSSKeyframesRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSRule: require(\"./CSSRule\").CSSRule,\n\tCSSStyleDeclaration: require('./CSSStyleDeclaration').CSSStyleDeclaration\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/css3-animations/#DOM-CSSKeyframeRule\n */\nCSSOM.CSSKeyframeRule = function CSSKeyframeRule() {\n\tCSSOM.CSSRule.call(this);\n\tthis.keyText = '';\n\tthis.style = new CSSOM.CSSStyleDeclaration;\n\tthis.style.parentRule = this;\n};\n\nCSSOM.CSSKeyframeRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSKeyframeRule.prototype.constructor = CSSOM.CSSKeyframeRule;\nCSSOM.CSSKeyframeRule.prototype.type = 9;\n//FIXME\n//CSSOM.CSSKeyframeRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSKeyframeRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\n// http://www.opensource.apple.com/source/WebCore/WebCore-955.66.1/css/WebKitCSSKeyframeRule.cpp\nObject.defineProperty(CSSOM.CSSKeyframeRule.prototype, \"cssText\", {\n  get: function() {\n    return this.keyText + \" {\" + this.style.cssText + \"} \";\n  }\n});\n\n\n//.CommonJS\nexports.CSSKeyframeRule = CSSOM.CSSKeyframeRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see https://developer.mozilla.org/en/CSS/@-moz-document\n */\nCSSOM.MatcherList = function MatcherList(){\n    this.length = 0;\n};\n\nCSSOM.MatcherList.prototype = {\n\n    constructor: CSSOM.MatcherList,\n\n    /**\n     * @return {string}\n     */\n    get matcherText() {\n        return Array.prototype.join.call(this, \", \");\n    },\n\n    /**\n     * @param {string} value\n     */\n    set matcherText(value) {\n        // just a temporary solution, actually it may be wrong by just split the value with ',', because a url can include ','.\n        var values = value.split(\",\");\n        var length = this.length = values.length;\n        for (var i=0; i<length; i++) {\n            this[i] = values[i].trim();\n        }\n    },\n\n    /**\n     * @param {string} matcher\n     */\n    appendMatcher: function(matcher) {\n        if (Array.prototype.indexOf.call(this, matcher) === -1) {\n            this[this.length] = matcher;\n            this.length++;\n        }\n    },\n\n    /**\n     * @param {string} matcher\n     */\n    deleteMatcher: function(matcher) {\n        var index = Array.prototype.indexOf.call(this, matcher);\n        if (index !== -1) {\n            Array.prototype.splice.call(this, index, 1);\n        }\n    }\n\n};\n\n\n//.CommonJS\nexports.MatcherList = CSSOM.MatcherList;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n    CSSRule: require(\"./CSSRule\").CSSRule,\n    MatcherList: require(\"./MatcherList\").MatcherList\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see https://developer.mozilla.org/en/CSS/@-moz-document\n */\nCSSOM.CSSDocumentRule = function CSSDocumentRule() {\n    CSSOM.CSSRule.call(this);\n    this.matcher = new CSSOM.MatcherList;\n    this.cssRules = [];\n};\n\nCSSOM.CSSDocumentRule.prototype = new CSSOM.CSSRule;\nCSSOM.CSSDocumentRule.prototype.constructor = CSSOM.CSSDocumentRule;\nCSSOM.CSSDocumentRule.prototype.type = 10;\n//FIXME\n//CSSOM.CSSDocumentRule.prototype.insertRule = CSSStyleSheet.prototype.insertRule;\n//CSSOM.CSSDocumentRule.prototype.deleteRule = CSSStyleSheet.prototype.deleteRule;\n\nObject.defineProperty(CSSOM.CSSDocumentRule.prototype, \"cssText\", {\n  get: function() {\n    var cssTexts = [];\n    for (var i=0, length=this.cssRules.length; i < length; i++) {\n        cssTexts.push(this.cssRules[i].cssText);\n    }\n    return \"@-moz-document \" + this.matcher.matcherText + \" {\" + cssTexts.join(\"\") + \"}\";\n  }\n});\n\n\n//.CommonJS\nexports.CSSDocumentRule = CSSOM.CSSDocumentRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSValue\n *\n * TODO: add if needed\n */\nCSSOM.CSSValue = function CSSValue() {\n};\n\nCSSOM.CSSValue.prototype = {\n\tconstructor: CSSOM.CSSValue,\n\n\t// @see: http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSValue\n\tset cssText(text) {\n\t\tvar name = this._getConstructorName();\n\n\t\tthrow new Exception('DOMException: property \"cssText\" of \"' + name + '\" is readonly!');\n\t},\n\n\tget cssText() {\n\t\tvar name = this._getConstructorName();\n\n\t\tthrow new Exception('getter \"cssText\" of \"' + name + '\" is not implemented!');\n\t},\n\n\t_getConstructorName: function() {\n\t\tvar s = this.constructor.toString(),\n\t\t\t\tc = s.match(/function\\s([^\\(]+)/),\n\t\t\t\tname = c[1];\n\n\t\treturn name;\n\t}\n};\n\n\n//.CommonJS\nexports.CSSValue = CSSOM.CSSValue;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSValue: require('./CSSValue').CSSValue\n};\n///CommonJS\n\n\n/**\n * @constructor\n * @see http://msdn.microsoft.com/en-us/library/ms537634(v=vs.85).aspx\n *\n */\nCSSOM.CSSValueExpression = function CSSValueExpression(token, idx) {\n\tthis._token = token;\n\tthis._idx = idx;\n};\n\nCSSOM.CSSValueExpression.prototype = new CSSOM.CSSValue;\nCSSOM.CSSValueExpression.prototype.constructor = CSSOM.CSSValueExpression;\n\n/**\n * parse css expression() value\n *\n * @return {Object}\n *\t\t\t\t - error:\n *\t\t\t\t or\n *\t\t\t\t - idx:\n *\t\t\t\t - expression:\n *\n * Example:\n *\n * .selector {\n *\t\tzoom: expression(documentElement.clientWidth > 1000 ? '1000px' : 'auto');\n * }\n */\nCSSOM.CSSValueExpression.prototype.parse = function() {\n\tvar token = this._token,\n\t\t\tidx = this._idx;\n\n\tvar character = '',\n\t\t\texpression = '',\n\t\t\terror = '',\n\t\t\tinfo,\n\t\t\tparen = [];\n\n\n\tfor (; ; ++idx) {\n\t\tcharacter = token.charAt(idx);\n\n\t\t// end of token\n\t\tif (character == '') {\n\t\t\terror = 'css expression error: unfinished expression!';\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch(character) {\n\t\t\tcase '(':\n\t\t\t\tparen.push(character);\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\n\t\t\tcase ')':\n\t\t\t\tparen.pop(character);\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\n\t\t\tcase '/':\n\t\t\t\tif (info = this._parseJSComment(token, idx)) { // comment?\n\t\t\t\t\tif (info.error) {\n\t\t\t\t\t\terror = 'css expression error: unfinished comment in expression!';\n\t\t\t\t\t} else {\n\t\t\t\t\t\tidx = info.idx;\n\t\t\t\t\t\t// ignore the comment\n\t\t\t\t\t}\n\t\t\t\t} else if (info = this._parseJSRexExp(token, idx)) { // regexp\n\t\t\t\t\tidx = info.idx;\n\t\t\t\t\texpression += info.text;\n\t\t\t\t} else { // other\n\t\t\t\t\texpression += character;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase \"'\":\n\t\t\tcase '\"':\n\t\t\t\tinfo = this._parseJSString(token, idx, character);\n\t\t\t\tif (info) { // string\n\t\t\t\t\tidx = info.idx;\n\t\t\t\t\texpression += info.text;\n\t\t\t\t} else {\n\t\t\t\t\texpression += character;\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\texpression += character;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tif (error) {\n\t\t\tbreak;\n\t\t}\n\n\t\t// end of expression\n\t\tif (paren.length == 0) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tvar ret;\n\tif (error) {\n\t\tret = {\n\t\t\terror: error\n\t\t}\n\t} else {\n\t\tret = {\n\t\t\tidx: idx,\n\t\t\texpression: expression\n\t\t}\n\t}\n\n\treturn ret;\n};\n\n\n/**\n *\n * @return {Object|false}\n *          - idx:\n *          - text:\n *          or\n *          - error:\n *          or\n *          false\n *\n */\nCSSOM.CSSValueExpression.prototype._parseJSComment = function(token, idx) {\n\tvar nextChar = token.charAt(idx + 1),\n\t\t\ttext;\n\n\tif (nextChar == '/' || nextChar == '*') {\n\t\tvar startIdx = idx,\n\t\t\t\tendIdx,\n\t\t\t\tcommentEndChar;\n\n\t\tif (nextChar == '/') { // line comment\n\t\t\tcommentEndChar = '\\n';\n\t\t} else if (nextChar == '*') { // block comment\n\t\t\tcommentEndChar = '*/';\n\t\t}\n\n\t\tendIdx = token.indexOf(commentEndChar, startIdx + 1 + 1);\n\t\tif (endIdx !== -1) {\n\t\t\tendIdx = endIdx + commentEndChar.length - 1;\n\t\t\ttext = token.substring(idx, endIdx + 1);\n\t\t\treturn {\n\t\t\t\tidx: endIdx,\n\t\t\t\ttext: text\n\t\t\t}\n\t\t} else {\n\t\t\terror = 'css expression error: unfinished comment in expression!';\n\t\t\treturn {\n\t\t\t\terror: error\n\t\t\t}\n\t\t}\n\t} else {\n\t\treturn false;\n\t}\n};\n\n\n/**\n *\n * @return {Object|false}\n *\t\t\t\t\t- idx:\n *\t\t\t\t\t- text:\n *\t\t\t\t\tor \n *\t\t\t\t\tfalse\n *\n */\nCSSOM.CSSValueExpression.prototype._parseJSString = function(token, idx, sep) {\n\tvar endIdx = this._findMatchedIdx(token, idx, sep),\n\t\t\ttext;\n\n\tif (endIdx === -1) {\n\t\treturn false;\n\t} else {\n\t\ttext = token.substring(idx, endIdx + sep.length);\n\n\t\treturn {\n\t\t\tidx: endIdx,\n\t\t\ttext: text\n\t\t}\n\t}\n};\n\n\n/**\n * parse regexp in css expression\n *\n * @return {Object|false}\n *\t\t\t\t - idx:\n *\t\t\t\t - regExp:\n *\t\t\t\t or \n *\t\t\t\t false\n */\n\n/*\n\nall legal RegExp\n \n/a/\n(/a/)\n[/a/]\n[12, /a/]\n\n!/a/\n\n+/a/\n-/a/\n* /a/\n/ /a/\n%/a/\n\n===/a/\n!==/a/\n==/a/\n!=/a/\n>/a/\n>=/a/\n</a/\n<=/a/\n\n&/a/\n|/a/\n^/a/\n~/a/\n<</a/\n>>/a/\n>>>/a/\n\n&&/a/\n||/a/\n?/a/\n=/a/\n,/a/\n\n\t\tdelete /a/\n\t\t\t\tin /a/\ninstanceof /a/\n\t\t\t new /a/\n\t\ttypeof /a/\n\t\t\tvoid /a/\n\n*/\nCSSOM.CSSValueExpression.prototype._parseJSRexExp = function(token, idx) {\n\tvar before = token.substring(0, idx).replace(/\\s+$/, \"\"),\n\t\t\tlegalRegx = [\n\t\t\t\t/^$/,\n\t\t\t\t/\\($/,\n\t\t\t\t/\\[$/,\n\t\t\t\t/\\!$/,\n\t\t\t\t/\\+$/,\n\t\t\t\t/\\-$/,\n\t\t\t\t/\\*$/,\n\t\t\t\t/\\/\\s+/,\n\t\t\t\t/\\%$/,\n\t\t\t\t/\\=$/,\n\t\t\t\t/\\>$/,\n\t\t\t\t/\\<$/,\n\t\t\t\t/\\&$/,\n\t\t\t\t/\\|$/,\n\t\t\t\t/\\^$/,\n\t\t\t\t/\\~$/,\n\t\t\t\t/\\?$/,\n\t\t\t\t/\\,$/,\n\t\t\t\t/delete$/,\n\t\t\t\t/in$/,\n\t\t\t\t/instanceof$/,\n\t\t\t\t/new$/,\n\t\t\t\t/typeof$/,\n\t\t\t\t/void$/,\n\t\t\t];\n\n\tvar isLegal = legalRegx.some(function(reg) {\n\t\treturn reg.test(before);\n\t});\n\n\tif (!isLegal) {\n\t\treturn false;\n\t} else {\n\t\tvar sep = '/';\n\n\t\t// same logic as string\n\t\treturn this._parseJSString(token, idx, sep);\n\t}\n};\n\n\n/**\n *\n * find next sep(same line) index in `token`\n *\n * @return {Number}\n *\n */\nCSSOM.CSSValueExpression.prototype._findMatchedIdx = function(token, idx, sep) {\n\tvar startIdx = idx,\n\t\t\tendIdx;\n\n\tvar NOT_FOUND = -1;\n\n\twhile(true) {\n\t\tendIdx = token.indexOf(sep, startIdx + 1);\n\n\t\tif (endIdx === -1) { // not found\n\t\t\tendIdx = NOT_FOUND;\n\t\t\tbreak;\n\t\t} else {\n\t\t\tvar text = token.substring(idx + 1, endIdx),\n\t\t\t\t\tmatched = text.match(/\\\\+$/);\n\t\t\tif (!matched || matched[0] % 2 == 0) { // not escaped\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tstartIdx = endIdx;\n\t\t\t}\n\t\t}\n\t}\n\n\t// boundary must be in the same line(js sting or regexp)\n\tvar nextNewLineIdx = token.indexOf('\\n', idx + 1);\n\tif (nextNewLineIdx < endIdx) {\n\t\tendIdx = NOT_FOUND;\n\t}\n\n\n\treturn endIdx;\n}\n\n\n\n\n//.CommonJS\nexports.CSSValueExpression = CSSOM.CSSValueExpression;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {};\n///CommonJS\n\n\n/**\n * @param {string} token\n */\nCSSOM.parse = function parse(token) {\n\n\tvar i = 0;\n\n\t/**\n\t\t\"before-selector\" or\n\t\t\"selector\" or\n\t\t\"atRule\" or\n\t\t\"atBlock\" or\n\t\t\"before-name\" or\n\t\t\"name\" or\n\t\t\"before-value\" or\n\t\t\"value\"\n\t*/\n\tvar state = \"before-selector\";\n\n\tvar index;\n\tvar buffer = \"\";\n\n\tvar SIGNIFICANT_WHITESPACE = {\n\t\t\"selector\": true,\n\t\t\"value\": true,\n\t\t\"atRule\": true,\n\t\t\"importRule-begin\": true,\n\t\t\"importRule\": true,\n\t\t\"atBlock\": true,\n\t\t'documentRule-begin': true\n\t};\n\n\tvar styleSheet = new CSSOM.CSSStyleSheet;\n\n\t// @type CSSStyleSheet|CSSMediaRule|CSSFontFaceRule|CSSKeyframesRule|CSSDocumentRule\n\tvar currentScope = styleSheet;\n\n\t// @type CSSMediaRule|CSSKeyframesRule|CSSDocumentRule\n\tvar parentRule;\n\n\tvar selector, name, value, priority=\"\", styleRule, mediaRule, importRule, fontFaceRule, keyframesRule, keyframeRule, documentRule;\n\n\tvar atKeyframesRegExp = /@(-(?:\\w+-)+)?keyframes/g;\n\n\tvar parseError = function(message) {\n\t\tvar lines = token.substring(0, i).split('\\n');\n\t\tvar lineCount = lines.length;\n\t\tvar charCount = lines.pop().length + 1;\n\t\tvar error = new Error(message + ' (line ' + lineCount + ', char ' + charCount + ')');\n\t\terror.line = lineCount;\n\t\terror.char = charCount;\n\t\terror.styleSheet = styleSheet;\n\t\tthrow error;\n\t};\n\n\tfor (var character; character = token.charAt(i); i++) {\n\n\t\tswitch (character) {\n\n\t\tcase \" \":\n\t\tcase \"\\t\":\n\t\tcase \"\\r\":\n\t\tcase \"\\n\":\n\t\tcase \"\\f\":\n\t\t\tif (SIGNIFICANT_WHITESPACE[state]) {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// String\n\t\tcase '\"':\n\t\t\tindex = i + 1;\n\t\t\tdo {\n\t\t\t\tindex = token.indexOf('\"', index) + 1;\n\t\t\t\tif (!index) {\n\t\t\t\t\tparseError('Unmatched \"');\n\t\t\t\t}\n\t\t\t} while (token[index - 2] === '\\\\')\n\t\t\tbuffer += token.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tswitch (state) {\n\t\t\t\tcase 'before-value':\n\t\t\t\t\tstate = 'value';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'importRule-begin':\n\t\t\t\t\tstate = 'importRule';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"'\":\n\t\t\tindex = i + 1;\n\t\t\tdo {\n\t\t\t\tindex = token.indexOf(\"'\", index) + 1;\n\t\t\t\tif (!index) {\n\t\t\t\t\tparseError(\"Unmatched '\");\n\t\t\t\t}\n\t\t\t} while (token[index - 2] === '\\\\')\n\t\t\tbuffer += token.slice(i, index);\n\t\t\ti = index - 1;\n\t\t\tswitch (state) {\n\t\t\t\tcase 'before-value':\n\t\t\t\t\tstate = 'value';\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'importRule-begin':\n\t\t\t\t\tstate = 'importRule';\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// Comment\n\t\tcase \"/\":\n\t\t\tif (token.charAt(i + 1) === \"*\") {\n\t\t\t\ti += 2;\n\t\t\t\tindex = token.indexOf(\"*/\", i);\n\t\t\t\tif (index === -1) {\n\t\t\t\t\tparseError(\"Missing */\");\n\t\t\t\t} else {\n\t\t\t\t\ti = index + 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tif (state === \"importRule-begin\") {\n\t\t\t\tbuffer += \" \";\n\t\t\t\tstate = \"importRule\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\t// At-rule\n\t\tcase \"@\":\n\t\t\tif (token.indexOf(\"@-moz-document\", i) === i) {\n\t\t\t\tstate = \"documentRule-begin\";\n\t\t\t\tdocumentRule = new CSSOM.CSSDocumentRule;\n\t\t\t\tdocumentRule.__starts = i;\n\t\t\t\ti += \"-moz-document\".length;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@media\", i) === i) {\n\t\t\t\tstate = \"atBlock\";\n\t\t\t\tmediaRule = new CSSOM.CSSMediaRule;\n\t\t\t\tmediaRule.__starts = i;\n\t\t\t\ti += \"media\".length;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@import\", i) === i) {\n\t\t\t\tstate = \"importRule-begin\";\n\t\t\t\ti += \"import\".length;\n\t\t\t\tbuffer += \"@import\";\n\t\t\t\tbreak;\n\t\t\t} else if (token.indexOf(\"@font-face\", i) === i) {\n\t\t\t\tstate = \"fontFaceRule-begin\";\n\t\t\t\ti += \"font-face\".length;\n\t\t\t\tfontFaceRule = new CSSOM.CSSFontFaceRule;\n\t\t\t\tfontFaceRule.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tbreak;\n\t\t\t} else {\n\t\t\t\tatKeyframesRegExp.lastIndex = i;\n\t\t\t\tvar matchKeyframes = atKeyframesRegExp.exec(token);\n\t\t\t\tif (matchKeyframes && matchKeyframes.index === i) {\n\t\t\t\t\tstate = \"keyframesRule-begin\";\n\t\t\t\t\tkeyframesRule = new CSSOM.CSSKeyframesRule;\n\t\t\t\t\tkeyframesRule.__starts = i;\n\t\t\t\t\tkeyframesRule._vendorPrefix = matchKeyframes[1]; // Will come out as undefined if no prefix was found\n\t\t\t\t\ti += matchKeyframes[0].length - 1;\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\t} else if (state == \"selector\") {\n\t\t\t\t\tstate = \"atRule\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\n\t\tcase \"{\":\n\t\t\tif (state === \"selector\" || state === \"atRule\") {\n\t\t\t\tstyleRule.selectorText = buffer.trim();\n\t\t\t\tstyleRule.style.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"atBlock\") {\n\t\t\t\tmediaRule.media.mediaText = buffer.trim();\n\t\t\t\tcurrentScope = parentRule = mediaRule;\n\t\t\t\tmediaRule.parentStyleSheet = styleSheet;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-selector\";\n\t\t\t} else if (state === \"fontFaceRule-begin\") {\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tfontFaceRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tfontFaceRule.parentStyleSheet = styleSheet;\n\t\t\t\tstyleRule = fontFaceRule;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"keyframesRule-begin\") {\n\t\t\t\tkeyframesRule.name = buffer.trim();\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tkeyframesRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tkeyframesRule.parentStyleSheet = styleSheet;\n\t\t\t\tcurrentScope = parentRule = keyframesRule;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"keyframeRule-begin\";\n\t\t\t} else if (state === \"keyframeRule-begin\") {\n\t\t\t\tstyleRule = new CSSOM.CSSKeyframeRule;\n\t\t\t\tstyleRule.keyText = buffer.trim();\n\t\t\t\tstyleRule.__starts = i;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-name\";\n\t\t\t} else if (state === \"documentRule-begin\") {\n\t\t\t\t// FIXME: what if this '{' is in the url text of the match function?\n\t\t\t\tdocumentRule.matcher.matcherText = buffer.trim();\n\t\t\t\tif (parentRule) {\n\t\t\t\t\tdocumentRule.parentRule = parentRule;\n\t\t\t\t}\n\t\t\t\tcurrentScope = parentRule = documentRule;\n\t\t\t\tdocumentRule.parentStyleSheet = styleSheet;\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-selector\";\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \":\":\n\t\t\tif (state === \"name\") {\n\t\t\t\tname = buffer.trim();\n\t\t\t\tbuffer = \"\";\n\t\t\t\tstate = \"before-value\";\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase '(':\n\t\t\tif (state === 'value') {\n\t\t\t\t// ie css expression mode\n\t\t\t\tif (buffer.trim() == 'expression') {\n\t\t\t\t\tvar info = (new CSSOM.CSSValueExpression(token, i)).parse();\n\n\t\t\t\t\tif (info.error) {\n\t\t\t\t\t\tparseError(info.error);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbuffer += info.expression;\n\t\t\t\t\t\ti = info.idx;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tindex = token.indexOf(')', i + 1);\n\t\t\t\t\tif (index === -1) {\n\t\t\t\t\t\tparseError('Unmatched \"(\"');\n\t\t\t\t\t}\n\t\t\t\t\tbuffer += token.slice(i, index + 1);\n\t\t\t\t\ti = index;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\n\t\t\tbreak;\n\n\t\tcase \"!\":\n\t\t\tif (state === \"value\" && token.indexOf(\"!important\", i) === i) {\n\t\t\t\tpriority = \"important\";\n\t\t\t\ti += \"important\".length;\n\t\t\t} else {\n\t\t\t\tbuffer += character;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \";\":\n\t\t\tswitch (state) {\n\t\t\t\tcase \"value\":\n\t\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\t\tpriority = \"\";\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"atRule\":\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"importRule\":\n\t\t\t\t\timportRule = new CSSOM.CSSImportRule;\n\t\t\t\t\timportRule.parentStyleSheet = importRule.styleSheet.parentStyleSheet = styleSheet;\n\t\t\t\t\timportRule.cssText = buffer + character;\n\t\t\t\t\tstyleSheet.cssRules.push(importRule);\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbuffer += character;\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase \"}\":\n\t\t\tswitch (state) {\n\t\t\t\tcase \"value\":\n\t\t\t\t\tstyleRule.style.setProperty(name, buffer.trim(), priority);\n\t\t\t\t\tpriority = \"\";\n\t\t\t\tcase \"before-name\":\n\t\t\t\tcase \"name\":\n\t\t\t\t\tstyleRule.__ends = i + 1;\n\t\t\t\t\tif (parentRule) {\n\t\t\t\t\t\tstyleRule.parentRule = parentRule;\n\t\t\t\t\t}\n\t\t\t\t\tstyleRule.parentStyleSheet = styleSheet;\n\t\t\t\t\tcurrentScope.cssRules.push(styleRule);\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tif (currentScope.constructor === CSSOM.CSSKeyframesRule) {\n\t\t\t\t\t\tstate = \"keyframeRule-begin\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"keyframeRule-begin\":\n\t\t\t\tcase \"before-selector\":\n\t\t\t\tcase \"selector\":\n\t\t\t\t\t// End of media/document rule.\n\t\t\t\t\tif (!parentRule) {\n\t\t\t\t\t\tparseError(\"Unexpected }\");\n\t\t\t\t\t}\n\t\t\t\t\tcurrentScope.__ends = i + 1;\n\t\t\t\t\t// Nesting rules aren't supported yet\n\t\t\t\t\tstyleSheet.cssRules.push(currentScope);\n\t\t\t\t\tcurrentScope = styleSheet;\n\t\t\t\t\tparentRule = null;\n\t\t\t\t\tbuffer = \"\";\n\t\t\t\t\tstate = \"before-selector\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\tswitch (state) {\n\t\t\t\tcase \"before-selector\":\n\t\t\t\t\tstate = \"selector\";\n\t\t\t\t\tstyleRule = new CSSOM.CSSStyleRule;\n\t\t\t\t\tstyleRule.__starts = i;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"before-name\":\n\t\t\t\t\tstate = \"name\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"before-value\":\n\t\t\t\t\tstate = \"value\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"importRule-begin\":\n\t\t\t\t\tstate = \"importRule\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbuffer += character;\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn styleSheet;\n};\n\n\n//.CommonJS\nexports.parse = CSSOM.parse;\n// The following modules cannot be included sooner due to the mutual dependency with parse.js\nCSSOM.CSSStyleSheet = require(\"./CSSStyleSheet\").CSSStyleSheet;\nCSSOM.CSSStyleRule = require(\"./CSSStyleRule\").CSSStyleRule;\nCSSOM.CSSImportRule = require(\"./CSSImportRule\").CSSImportRule;\nCSSOM.CSSMediaRule = require(\"./CSSMediaRule\").CSSMediaRule;\nCSSOM.CSSFontFaceRule = require(\"./CSSFontFaceRule\").CSSFontFaceRule;\nCSSOM.CSSStyleDeclaration = require('./CSSStyleDeclaration').CSSStyleDeclaration;\nCSSOM.CSSKeyframeRule = require('./CSSKeyframeRule').CSSKeyframeRule;\nCSSOM.CSSKeyframesRule = require('./CSSKeyframesRule').CSSKeyframesRule;\nCSSOM.CSSValueExpression = require('./CSSValueExpression').CSSValueExpression;\nCSSOM.CSSDocumentRule = require('./CSSDocumentRule').CSSDocumentRule;\n///CommonJS\n","//.CommonJS\nvar CSSOM = {\n\tCSSStyleSheet: require(\"./CSSStyleSheet\").CSSStyleSheet,\n\tCSSStyleRule: require(\"./CSSStyleRule\").CSSStyleRule,\n\tCSSMediaRule: require(\"./CSSMediaRule\").CSSMediaRule,\n\tCSSStyleDeclaration: require(\"./CSSStyleDeclaration\").CSSStyleDeclaration,\n\tCSSKeyframeRule: require('./CSSKeyframeRule').CSSKeyframeRule,\n\tCSSKeyframesRule: require('./CSSKeyframesRule').CSSKeyframesRule\n};\n///CommonJS\n\n\n/**\n * Produces a deep copy of stylesheet  the instance variables of stylesheet are copied recursively.\n * @param {CSSStyleSheet|CSSOM.CSSStyleSheet} stylesheet\n * @nosideeffects\n * @return {CSSOM.CSSStyleSheet}\n */\nCSSOM.clone = function clone(stylesheet) {\n\n\tvar cloned = new CSSOM.CSSStyleSheet;\n\n\tvar rules = stylesheet.cssRules;\n\tif (!rules) {\n\t\treturn cloned;\n\t}\n\n\tvar RULE_TYPES = {\n\t\t1: CSSOM.CSSStyleRule,\n\t\t4: CSSOM.CSSMediaRule,\n\t\t//3: CSSOM.CSSImportRule,\n\t\t//5: CSSOM.CSSFontFaceRule,\n\t\t//6: CSSOM.CSSPageRule,\n\t\t8: CSSOM.CSSKeyframesRule,\n\t\t9: CSSOM.CSSKeyframeRule\n\t};\n\n\tfor (var i=0, rulesLength=rules.length; i < rulesLength; i++) {\n\t\tvar rule = rules[i];\n\t\tvar ruleClone = cloned.cssRules[i] = new RULE_TYPES[rule.type];\n\n\t\tvar style = rule.style;\n\t\tif (style) {\n\t\t\tvar styleClone = ruleClone.style = new CSSOM.CSSStyleDeclaration;\n\t\t\tfor (var j=0, styleLength=style.length; j < styleLength; j++) {\n\t\t\t\tvar name = styleClone[j] = style[j];\n\t\t\t\tstyleClone[name] = style[name];\n\t\t\t\tstyleClone._importants[name] = style.getPropertyPriority(name);\n\t\t\t}\n\t\t\tstyleClone.length = style.length;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('keyText')) {\n\t\t\truleClone.keyText = rule.keyText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('selectorText')) {\n\t\t\truleClone.selectorText = rule.selectorText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('mediaText')) {\n\t\t\truleClone.mediaText = rule.mediaText;\n\t\t}\n\n\t\tif (rule.hasOwnProperty('cssRules')) {\n\t\t\truleClone.cssRules = clone(rule).cssRules;\n\t\t}\n\t}\n\n\treturn cloned;\n\n};\n\n//.CommonJS\nexports.clone = CSSOM.clone;\n///CommonJS\n","module.exports = (function() {\n  /*\n   * Generated by PEG.js 0.8.0.\n   *\n   * http://pegjs.majda.cz/\n   */\n\n  function peg$subclass(child, parent) {\n    function ctor() { this.constructor = child; }\n    ctor.prototype = parent.prototype;\n    child.prototype = new ctor();\n  }\n\n  function SyntaxError(message, expected, found, offset, line, column) {\n    this.message  = message;\n    this.expected = expected;\n    this.found    = found;\n    this.offset   = offset;\n    this.line     = line;\n    this.column   = column;\n\n    this.name     = \"SyntaxError\";\n  }\n\n  peg$subclass(SyntaxError, Error);\n\n  function parse(input) {\n    var options = arguments.length > 1 ? arguments[1] : {},\n\n        peg$FAILED = {},\n\n        peg$startRuleFunctions = { start: peg$parsestart },\n        peg$startRuleFunction  = peg$parsestart,\n\n        peg$c0 = [],\n        peg$c1 = function() { return []},\n        peg$c2 = peg$FAILED,\n        peg$c3 = \",\",\n        peg$c4 = { type: \"literal\", value: \",\", description: \"\\\",\\\"\" },\n        peg$c5 = function(x, xs) { return [x].concat(xs); },\n        peg$c6 = function(entry) { return [entry]; },\n        peg$c7 = function(url, format) { return {url: url, format: format}; },\n        peg$c8 = function(url) { return {url: url}; },\n        peg$c9 = \"url(\",\n        peg$c10 = { type: \"literal\", value: \"url(\", description: \"\\\"url(\\\"\" },\n        peg$c11 = \")\",\n        peg$c12 = { type: \"literal\", value: \")\", description: \"\\\")\\\"\" },\n        peg$c13 = function(value) { return value; },\n        peg$c14 = \"format(\",\n        peg$c15 = { type: \"literal\", value: \"format(\", description: \"\\\"format(\\\"\" },\n        peg$c16 = \"local(\",\n        peg$c17 = { type: \"literal\", value: \"local(\", description: \"\\\"local(\\\"\" },\n        peg$c18 = function(value) { return {local: value}; },\n        peg$c19 = /^[^)]/,\n        peg$c20 = { type: \"class\", value: \"[^)]\", description: \"[^)]\" },\n        peg$c21 = function(chars) { return util.extractValue(chars.join(\"\")); },\n        peg$c22 = /^[ \\t\\r\\n\\f]/,\n        peg$c23 = { type: \"class\", value: \"[ \\\\t\\\\r\\\\n\\\\f]\", description: \"[ \\\\t\\\\r\\\\n\\\\f]\" },\n\n        peg$currPos          = 0,\n        peg$reportedPos      = 0,\n        peg$cachedPos        = 0,\n        peg$cachedPosDetails = { line: 1, column: 1, seenCR: false },\n        peg$maxFailPos       = 0,\n        peg$maxFailExpected  = [],\n        peg$silentFails      = 0,\n\n        peg$result;\n\n    if (\"startRule\" in options) {\n      if (!(options.startRule in peg$startRuleFunctions)) {\n        throw new Error(\"Can't start parsing from rule \\\"\" + options.startRule + \"\\\".\");\n      }\n\n      peg$startRuleFunction = peg$startRuleFunctions[options.startRule];\n    }\n\n    function text() {\n      return input.substring(peg$reportedPos, peg$currPos);\n    }\n\n    function offset() {\n      return peg$reportedPos;\n    }\n\n    function line() {\n      return peg$computePosDetails(peg$reportedPos).line;\n    }\n\n    function column() {\n      return peg$computePosDetails(peg$reportedPos).column;\n    }\n\n    function expected(description) {\n      throw peg$buildException(\n        null,\n        [{ type: \"other\", description: description }],\n        peg$reportedPos\n      );\n    }\n\n    function error(message) {\n      throw peg$buildException(message, null, peg$reportedPos);\n    }\n\n    function peg$computePosDetails(pos) {\n      function advance(details, startPos, endPos) {\n        var p, ch;\n\n        for (p = startPos; p < endPos; p++) {\n          ch = input.charAt(p);\n          if (ch === \"\\n\") {\n            if (!details.seenCR) { details.line++; }\n            details.column = 1;\n            details.seenCR = false;\n          } else if (ch === \"\\r\" || ch === \"\\u2028\" || ch === \"\\u2029\") {\n            details.line++;\n            details.column = 1;\n            details.seenCR = true;\n          } else {\n            details.column++;\n            details.seenCR = false;\n          }\n        }\n      }\n\n      if (peg$cachedPos !== pos) {\n        if (peg$cachedPos > pos) {\n          peg$cachedPos = 0;\n          peg$cachedPosDetails = { line: 1, column: 1, seenCR: false };\n        }\n        advance(peg$cachedPosDetails, peg$cachedPos, pos);\n        peg$cachedPos = pos;\n      }\n\n      return peg$cachedPosDetails;\n    }\n\n    function peg$fail(expected) {\n      if (peg$currPos < peg$maxFailPos) { return; }\n\n      if (peg$currPos > peg$maxFailPos) {\n        peg$maxFailPos = peg$currPos;\n        peg$maxFailExpected = [];\n      }\n\n      peg$maxFailExpected.push(expected);\n    }\n\n    function peg$buildException(message, expected, pos) {\n      function cleanupExpected(expected) {\n        var i = 1;\n\n        expected.sort(function(a, b) {\n          if (a.description < b.description) {\n            return -1;\n          } else if (a.description > b.description) {\n            return 1;\n          } else {\n            return 0;\n          }\n        });\n\n        while (i < expected.length) {\n          if (expected[i - 1] === expected[i]) {\n            expected.splice(i, 1);\n          } else {\n            i++;\n          }\n        }\n      }\n\n      function buildMessage(expected, found) {\n        function stringEscape(s) {\n          function hex(ch) { return ch.charCodeAt(0).toString(16).toUpperCase(); }\n\n          return s\n            .replace(/\\\\/g,   '\\\\\\\\')\n            .replace(/\"/g,    '\\\\\"')\n            .replace(/\\x08/g, '\\\\b')\n            .replace(/\\t/g,   '\\\\t')\n            .replace(/\\n/g,   '\\\\n')\n            .replace(/\\f/g,   '\\\\f')\n            .replace(/\\r/g,   '\\\\r')\n            .replace(/[\\x00-\\x07\\x0B\\x0E\\x0F]/g, function(ch) { return '\\\\x0' + hex(ch); })\n            .replace(/[\\x10-\\x1F\\x80-\\xFF]/g,    function(ch) { return '\\\\x'  + hex(ch); })\n            .replace(/[\\u0180-\\u0FFF]/g,         function(ch) { return '\\\\u0' + hex(ch); })\n            .replace(/[\\u1080-\\uFFFF]/g,         function(ch) { return '\\\\u'  + hex(ch); });\n        }\n\n        var expectedDescs = new Array(expected.length),\n            expectedDesc, foundDesc, i;\n\n        for (i = 0; i < expected.length; i++) {\n          expectedDescs[i] = expected[i].description;\n        }\n\n        expectedDesc = expected.length > 1\n          ? expectedDescs.slice(0, -1).join(\", \")\n              + \" or \"\n              + expectedDescs[expected.length - 1]\n          : expectedDescs[0];\n\n        foundDesc = found ? \"\\\"\" + stringEscape(found) + \"\\\"\" : \"end of input\";\n\n        return \"Expected \" + expectedDesc + \" but \" + foundDesc + \" found.\";\n      }\n\n      var posDetails = peg$computePosDetails(pos),\n          found      = pos < input.length ? input.charAt(pos) : null;\n\n      if (expected !== null) {\n        cleanupExpected(expected);\n      }\n\n      return new SyntaxError(\n        message !== null ? message : buildMessage(expected, found),\n        expected,\n        found,\n        pos,\n        posDetails.line,\n        posDetails.column\n      );\n    }\n\n    function peg$parsestart() {\n      var s0, s1;\n\n      s0 = peg$parsesourceEntries();\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = [];\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c1();\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parsesourceEntries() {\n      var s0, s1, s2, s3, s4, s5;\n\n      s0 = peg$currPos;\n      s1 = peg$parsesourceEntry();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$parsewhitespace();\n        while (s3 !== peg$FAILED) {\n          s2.push(s3);\n          s3 = peg$parsewhitespace();\n        }\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 44) {\n            s3 = peg$c3;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c4); }\n          }\n          if (s3 !== peg$FAILED) {\n            s4 = [];\n            s5 = peg$parsewhitespace();\n            while (s5 !== peg$FAILED) {\n              s4.push(s5);\n              s5 = peg$parsewhitespace();\n            }\n            if (s4 !== peg$FAILED) {\n              s5 = peg$parsesourceEntries();\n              if (s5 !== peg$FAILED) {\n                peg$reportedPos = s0;\n                s1 = peg$c5(s1, s5);\n                s0 = s1;\n              } else {\n                peg$currPos = s0;\n                s0 = peg$c2;\n              }\n            } else {\n              peg$currPos = s0;\n              s0 = peg$c2;\n            }\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parsesourceEntry();\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c6(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parsesourceEntry() {\n      var s0;\n\n      s0 = peg$parseurlEntry();\n      if (s0 === peg$FAILED) {\n        s0 = peg$parselocalEntry();\n      }\n\n      return s0;\n    }\n\n    function peg$parseurlEntry() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      s1 = peg$parseurl();\n      if (s1 !== peg$FAILED) {\n        s2 = [];\n        s3 = peg$parsewhitespace();\n        if (s3 !== peg$FAILED) {\n          while (s3 !== peg$FAILED) {\n            s2.push(s3);\n            s3 = peg$parsewhitespace();\n          }\n        } else {\n          s2 = peg$c2;\n        }\n        if (s2 !== peg$FAILED) {\n          s3 = peg$parseformat();\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c7(s1, s3);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n      if (s0 === peg$FAILED) {\n        s0 = peg$currPos;\n        s1 = peg$parseurl();\n        if (s1 !== peg$FAILED) {\n          peg$reportedPos = s0;\n          s1 = peg$c8(s1);\n        }\n        s0 = s1;\n      }\n\n      return s0;\n    }\n\n    function peg$parseurl() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 4) === peg$c9) {\n        s1 = peg$c9;\n        peg$currPos += 4;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c10); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c13(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parseformat() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 7) === peg$c14) {\n        s1 = peg$c14;\n        peg$currPos += 7;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c15); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c13(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parselocalEntry() {\n      var s0, s1, s2, s3;\n\n      s0 = peg$currPos;\n      if (input.substr(peg$currPos, 6) === peg$c16) {\n        s1 = peg$c16;\n        peg$currPos += 6;\n      } else {\n        s1 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c17); }\n      }\n      if (s1 !== peg$FAILED) {\n        s2 = peg$parsevalue();\n        if (s2 !== peg$FAILED) {\n          if (input.charCodeAt(peg$currPos) === 41) {\n            s3 = peg$c11;\n            peg$currPos++;\n          } else {\n            s3 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c12); }\n          }\n          if (s3 !== peg$FAILED) {\n            peg$reportedPos = s0;\n            s1 = peg$c18(s2);\n            s0 = s1;\n          } else {\n            peg$currPos = s0;\n            s0 = peg$c2;\n          }\n        } else {\n          peg$currPos = s0;\n          s0 = peg$c2;\n        }\n      } else {\n        peg$currPos = s0;\n        s0 = peg$c2;\n      }\n\n      return s0;\n    }\n\n    function peg$parsevalue() {\n      var s0, s1, s2;\n\n      s0 = peg$currPos;\n      s1 = [];\n      if (peg$c19.test(input.charAt(peg$currPos))) {\n        s2 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s2 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c20); }\n      }\n      if (s2 !== peg$FAILED) {\n        while (s2 !== peg$FAILED) {\n          s1.push(s2);\n          if (peg$c19.test(input.charAt(peg$currPos))) {\n            s2 = input.charAt(peg$currPos);\n            peg$currPos++;\n          } else {\n            s2 = peg$FAILED;\n            if (peg$silentFails === 0) { peg$fail(peg$c20); }\n          }\n        }\n      } else {\n        s1 = peg$c2;\n      }\n      if (s1 !== peg$FAILED) {\n        peg$reportedPos = s0;\n        s1 = peg$c21(s1);\n      }\n      s0 = s1;\n\n      return s0;\n    }\n\n    function peg$parsewhitespace() {\n      var s0;\n\n      if (peg$c22.test(input.charAt(peg$currPos))) {\n        s0 = input.charAt(peg$currPos);\n        peg$currPos++;\n      } else {\n        s0 = peg$FAILED;\n        if (peg$silentFails === 0) { peg$fail(peg$c23); }\n      }\n\n      return s0;\n    }\n\n\n      var util = require('../util');\n\n\n    peg$result = peg$startRuleFunction();\n\n    if (peg$result !== peg$FAILED && peg$currPos === input.length) {\n      return peg$result;\n    } else {\n      if (peg$result !== peg$FAILED && peg$currPos < input.length) {\n        peg$fail({ type: \"end\", description: \"end of input\" });\n      }\n\n      throw peg$buildException(null, peg$maxFailExpected, peg$maxFailPos);\n    }\n  }\n\n  return {\n    SyntaxError: SyntaxError,\n    parse:       parse\n  };\n})();\n","var trimCSSWhitespace = function (value) {\n    var whitespaceRegex = /^[\\t\\r\\f\\n ]*(.+?)[\\t\\r\\f\\n ]*$/;\n\n    return value.replace(whitespaceRegex, \"$1\");\n};\n\nvar unquoteString = function (quotedUrl) {\n    var doubleQuoteRegex = /^\"(.*)\"$/,\n        singleQuoteRegex = /^'(.*)'$/;\n\n    if (doubleQuoteRegex.test(quotedUrl)) {\n        return quotedUrl.replace(doubleQuoteRegex, \"$1\");\n    } else {\n        if (singleQuoteRegex.test(quotedUrl)) {\n            return quotedUrl.replace(singleQuoteRegex, \"$1\");\n        } else {\n            return quotedUrl;\n        }\n    }\n};\n\nexports.extractValue = function (value) {\n    return unquoteString(trimCSSWhitespace(value));\n};\n"]}